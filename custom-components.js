//::---------------------------------------------------------------------------
/** ---------------------------------------------------------------------------
 * Module Name:  custom-components.js
 * Version    :  R04_18_00
 * Date       :  11/21/2018 16:00:00
 * Build date :
 * Author     :  CHLA eApps Group
 * Copyright  :  2014,2015,2016,2017
 * Description:  eApps mPages Custom Components merged file
 *
 * Depends: custom-components.css
 *
 * modification to correct double quote in pmd   "Primary Medical Doctor" label 04/26/2016 11:38:00 mburling
 * 12/07/2016 01:12:54 mburling Updated NICCU CC's and Removed EXTjs mod to correct css  done for Mpage 6.2 update
 * R04_08_00 02/16/2017 12:08:58 mburling - NiccuNotes CC added
 * R04_09_00 02/20/2017 15:03:32 mburling - chla.dcSummary
 * R04_09_01 02/23/2017 17:32:26 mburling - NICCU ventilator HFOV breakfix
 * R04_09_02 02/24/2017 14:07:21 mburling - dcSummary break-fix for \par
 * R04_10_00 04/04/2017 16:17:21 mburling - dc learning diabetes record form added
 * R04_11_00 06/15/2017 15:49:00 lpant/mburling - amblappt - reschedule section added*
 * R04_11_01 06/26/2017 14:00:00 lpant          -  - amblappt -mod column layout
 * R04_12_00 07/03/2017 10:49:00 mburling       - EDH updates Break-Fix save notes/survey
 *                                              - EappsClass 4.0 deployed
 * R04_13_00 07/26/2017 12:40:00 mburling - EDH updated notes with scrollbar Break-fix
 * R04_14_00 07/31/2017 17:04:00 lpant    - EDH survey question chg
 * R04_15_00 08/07/2017 16:04:00 lpant    - DC patinfo Autofax chg
 * R04_15_01 09/13/2017 10:48:00 mburling - fixed medrec yes/no layout
 * R04_15_02 10/30/2017 17:28:59 mburling - fixed UTC problem after delay for cache server
 * R04_16_00 10/08/2018 17:00:00 mburling - BT Mpage deployed
 * R04_16_01 10/08/2018 17:00:00 mburling - Oncology PTinfo bug fix
 * R04_17_00 10/27/2018 14:00:00 mburling - Anesthesia Components
 * R04_18_00 11/21/2018 16:00:00 mburling - Anesthesia QA indicators
 * ---------------------------------------------------------------------------*/
/* jquery.sparkline 2.1.2 - http://omnipotent.net/jquery.sparkline/
 ** Licensed under the New BSD License - see above site for details */

(function(a,b,c){(function(a){typeof define==="function"&&define.amd?define(["jquery"],a):jQuery&&!jQuery.fn.sparkline&&a(jQuery)})(function(d){"use strict";var e={},f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L=0;f=function(){return{common:{type:"line",lineColor:"#00f",fillColor:"#cdf",defaultPixelsPerValue:3,width:"auto",height:"auto",composite:!1,tagValuesAttribute:"values",tagOptionsPrefix:"spark",enableTagOptions:!1,enableHighlight:!0,highlightLighten:1.4,tooltipSkipNull:!0,tooltipPrefix:"",tooltipSuffix:"",disableHiddenCheck:!1,numberFormatter:!1,numberDigitGroupCount:3,numberDigitGroupSep:",",numberDecimalMark:".",disableTooltips:!1,disableInteraction:!1},line:{spotColor:"#f80",highlightSpotColor:"#5f5",highlightLineColor:"#f22",spotRadius:1.5,minSpotColor:"#f80",maxSpotColor:"#f80",lineWidth:1,normalRangeMin:c,normalRangeMax:c,normalRangeColor:"#ccc",drawNormalOnTop:!1,chartRangeMin:c,chartRangeMax:c,chartRangeMinX:c,chartRangeMaxX:c,tooltipFormat:new h('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{y}}{{suffix}}')},bar:{barColor:"#3366cc",negBarColor:"#f44",stackedBarColor:["#3366cc","#dc3912","#ff9900","#109618","#66aa00","#dd4477","#0099c6","#990099"],zeroColor:c,nullColor:c,zeroAxis:!0,barWidth:4,barSpacing:1,chartRangeMax:c,chartRangeMin:c,chartRangeClip:!1,colorMap:c,tooltipFormat:new h('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{value}}{{suffix}}')},tristate:{barWidth:4,barSpacing:1,posBarColor:"#6f6",negBarColor:"#f44",zeroBarColor:"#999",colorMap:{},tooltipFormat:new h('<span style="color: {{color}}">&#9679;</span> {{value:map}}'),tooltipValueLookups:{map:{"-1":"Loss",0:"Draw",1:"Win"}}},discrete:{lineHeight:"auto",thresholdColor:c,thresholdValue:0,chartRangeMax:c,chartRangeMin:c,chartRangeClip:!1,tooltipFormat:new h("{{prefix}}{{value}}{{suffix}}")},bullet:{targetColor:"#f33",targetWidth:3,performanceColor:"#33f",rangeColors:["#d3dafe","#a8b6ff","#7f94ff"],base:c,tooltipFormat:new h("{{fieldkey:fields}} - {{value}}"),tooltipValueLookups:{fields:{r:"Range",p:"Performance",t:"Target"}}},pie:{offset:0,sliceColors:["#3366cc","#dc3912","#ff9900","#109618","#66aa00","#dd4477","#0099c6","#990099"],borderWidth:0,borderColor:"#000",tooltipFormat:new h('<span style="color: {{color}}">&#9679;</span> {{value}} ({{percent.1}}%)')},box:{raw:!1,boxLineColor:"#000",boxFillColor:"#cdf",whiskerColor:"#000",outlierLineColor:"#333",outlierFillColor:"#fff",medianColor:"#f00",showOutliers:!0,outlierIQR:1.5,spotRadius:1.5,target:c,targetColor:"#4a2",chartRangeMax:c,chartRangeMin:c,tooltipFormat:new h("{{field:fields}}: {{value}}"),tooltipFormatFieldlistKey:"field",tooltipValueLookups:{fields:{lq:"Lower Quartile",med:"Median",uq:"Upper Quartile",lo:"Left Outlier",ro:"Right Outlier",lw:"Left Whisker",rw:"Right Whisker"}}}}},E='.jqstooltip {width:50px;height:30px; position: absolute;left: 0px;top: 0px;visibility: hidden;background: rgb(192, 192, 192) transparent;background-color: rgba(192,192,192,0.6);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000);-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000)";color: blue;font: 10px arial, san serif;text-align: left;white-space: nowrap;padding: 5px;border: 1px solid orange;z-index: 10000;}.jqsfield { color: blue;font: 10px arial, san serif;text-align: left;}',g=function(){var a,b;return a=function(){this.init.apply(this,arguments)},arguments.length>1?(arguments[0]?(a.prototype=d.extend(new arguments[0],arguments[arguments.length-1]),a._super=arguments[0].prototype):a.prototype=arguments[arguments.length-1],arguments.length>2&&(b=Array.prototype.slice.call(arguments,1,-1),b.unshift(a.prototype),d.extend.apply(d,b))):a.prototype=arguments[0],a.prototype.cls=a,a},d.SPFormatClass=h=g({fre:/\{\{([\w.]+?)(:(.+?))?\}\}/g,precre:/(\w+)\.(\d+)/,init:function(a,b){this.format=a,this.fclass=b},render:function(a,b,d){var e=this,f=a,g,h,i,j,k;return this.format.replace(this.fre,function(){var a;return h=arguments[1],i=arguments[3],g=e.precre.exec(h),g?(k=g[2],h=g[1]):k=!1,j=f[h],j===c?"":i&&b&&b[i]?(a=b[i],a.get?b[i].get(j)||j:b[i][j]||j):(n(j)&&(d.get("numberFormatter")?j=d.get("numberFormatter")(j):j=s(j,k,d.get("numberDigitGroupCount"),d.get("numberDigitGroupSep"),d.get("numberDecimalMark"))),j)})}}),d.spformat=function(a,b){return new h(a,b)},i=function(a,b,c){return a<b?b:a>c?c:a},j=function(a,c){var d;return c===2?(d=b.floor(a.length/2),a.length%2?a[d]:(a[d-1]+a[d])/2):a.length%2?(d=(a.length*c+c)/4,d%1?(a[b.floor(d)]+a[b.floor(d)-1])/2:a[d-1]):(d=(a.length*c+2)/4,d%1?(a[b.floor(d)]+a[b.floor(d)-1])/2:a[d-1])},k=function(a){var b;switch(a){case"undefined":a=c;break;case"null":a=null;break;case"true":a=!0;break;case"false":a=!1;break;default:b=parseFloat(a),a==b&&(a=b)}return a},l=function(a){var b,c=[];for(b=a.length;b--;)c[b]=k(a[b]);return c},m=function(a,b){var c,d,e=[];for(c=0,d=a.length;c<d;c++)a[c]!==b&&e.push(a[c]);return e},n=function(a){return!isNaN(parseFloat(a))&&isFinite(a)},s=function(a,b,c,e,f){var g,h;a=(b===!1?parseFloat(a).toString():a.toFixed(b)).split(""),g=(g=d.inArray(".",a))<0?a.length:g,g<a.length&&(a[g]=f);for(h=g-c;h>0;h-=c)a.splice(h,0,e);return a.join("")},o=function(a,b,c){var d;for(d=b.length;d--;){if(c&&b[d]===null)continue;if(b[d]!==a)return!1}return!0},p=function(a){var b=0,c;for(c=a.length;c--;)b+=typeof a[c]=="number"?a[c]:0;return b},r=function(a){return d.isArray(a)?a:[a]},q=function(b){var c;a.createStyleSheet?a.createStyleSheet().cssText=b:(c=a.createElement("style"),c.type="text/css",a.getElementsByTagName("head")[0].appendChild(c),c[typeof a.body.style.WebkitAppearance=="string"?"innerText":"innerHTML"]=b)},d.fn.simpledraw=function(b,e,f,g){var h,i;if(f&&(h=this.data("_jqs_vcanvas")))return h;if(d.fn.sparkline.canvas===!1)return!1;if(d.fn.sparkline.canvas===c){var j=a.createElement("canvas");if(!j.getContext||!j.getContext("2d")){if(!a.namespaces||!!a.namespaces.v)return d.fn.sparkline.canvas=!1,!1;a.namespaces.add("v","urn:schemas-microsoft-com:vml","#default#VML"),d.fn.sparkline.canvas=function(a,b,c,d){return new J(a,b,c)}}else d.fn.sparkline.canvas=function(a,b,c,d){return new I(a,b,c,d)}}return b===c&&(b=d(this).innerWidth()),e===c&&(e=d(this).innerHeight()),h=d.fn.sparkline.canvas(b,e,this,g),i=d(this).data("_jqs_mhandler"),i&&i.registerCanvas(h),h},d.fn.cleardraw=function(){var a=this.data("_jqs_vcanvas");a&&a.reset()},d.RangeMapClass=t=g({init:function(a){var b,c,d=[];for(b in a)a.hasOwnProperty(b)&&typeof b=="string"&&b.indexOf(":")>-1&&(c=b.split(":"),c[0]=c[0].length===0?-Infinity:parseFloat(c[0]),c[1]=c[1].length===0?Infinity:parseFloat(c[1]),c[2]=a[b],d.push(c));this.map=a,this.rangelist=d||!1},get:function(a){var b=this.rangelist,d,e,f;if((f=this.map[a])!==c)return f;if(b)for(d=b.length;d--;){e=b[d];if(e[0]<=a&&e[1]>=a)return e[2]}return c}}),d.range_map=function(a){return new t(a)},u=g({init:function(a,b){var c=d(a);this.$el=c,this.options=b,this.currentPageX=0,this.currentPageY=0,this.el=a,this.splist=[],this.tooltip=null,this.over=!1,this.displayTooltips=!b.get("disableTooltips"),this.highlightEnabled=!b.get("disableHighlight")},registerSparkline:function(a){this.splist.push(a),this.over&&this.updateDisplay()},registerCanvas:function(a){var b=d(a.canvas);this.canvas=a,this.$canvas=b,b.mouseenter(d.proxy(this.mouseenter,this)),b.mouseleave(d.proxy(this.mouseleave,this)),b.click(d.proxy(this.mouseclick,this))},reset:function(a){this.splist=[],this.tooltip&&a&&(this.tooltip.remove(),this.tooltip=c)},mouseclick:function(a){var b=d.Event("sparklineClick");b.originalEvent=a,b.sparklines=this.splist,this.$el.trigger(b)},mouseenter:function(b){d(a.body).unbind("mousemove.jqs"),d(a.body).bind("mousemove.jqs",d.proxy(this.mousemove,this)),this.over=!0,this.currentPageX=b.pageX,this.currentPageY=b.pageY,this.currentEl=b.target,!this.tooltip&&this.displayTooltips&&(this.tooltip=new v(this.options),this.tooltip.updatePosition(b.pageX,b.pageY)),this.updateDisplay()},mouseleave:function(){d(a.body).unbind("mousemove.jqs");var b=this.splist,c=b.length,e=!1,f,g;this.over=!1,this.currentEl=null,this.tooltip&&(this.tooltip.remove(),this.tooltip=null);for(g=0;g<c;g++)f=b[g],f.clearRegionHighlight()&&(e=!0);e&&this.canvas.render()},mousemove:function(a){this.currentPageX=a.pageX,this.currentPageY=a.pageY,this.currentEl=a.target,this.tooltip&&this.tooltip.updatePosition(a.pageX,a.pageY),this.updateDisplay()},updateDisplay:function(){var a=this.splist,b=a.length,c=!1,e=this.$canvas.offset(),f=this.currentPageX-e.left,g=this.currentPageY-e.top,h,i,j,k,l;if(!this.over)return;for(j=0;j<b;j++)i=a[j],k=i.setRegionHighlight(this.currentEl,f,g),k&&(c=!0);if(c){l=d.Event("sparklineRegionChange"),l.sparklines=this.splist,this.$el.trigger(l);if(this.tooltip){h="";for(j=0;j<b;j++)i=a[j],h+=i.getCurrentRegionTooltip();this.tooltip.setContent(h)}this.disableHighlight||this.canvas.render()}k===null&&this.mouseleave()}}),v=g({sizeStyle:"position: static !important;display: block !important;visibility: hidden !important;float: left !important;",init:function(b){var c=b.get("tooltipClassname","jqstooltip"),e=this.sizeStyle,f;this.container=b.get("tooltipContainer")||a.body,this.tooltipOffsetX=b.get("tooltipOffsetX",10),this.tooltipOffsetY=b.get("tooltipOffsetY",12),d("#jqssizetip").remove(),d("#jqstooltip").remove(),this.sizetip=d("<div/>",{id:"jqssizetip",style:e,"class":c}),this.tooltip=d("<div/>",{id:"jqstooltip","class":c}).appendTo(this.container),f=this.tooltip.offset(),this.offsetLeft=f.left,this.offsetTop=f.top,this.hidden=!0,d(window).unbind("resize.jqs scroll.jqs"),d(window).bind("resize.jqs scroll.jqs",d.proxy(this.updateWindowDims,this)),this.updateWindowDims()},updateWindowDims:function(){this.scrollTop=d(window).scrollTop(),this.scrollLeft=d(window).scrollLeft(),this.scrollRight=this.scrollLeft+d(window).width(),this.updatePosition()},getSize:function(a){this.sizetip.html(a).appendTo(this.container),this.width=this.sizetip.width()+1,this.height=this.sizetip.height(),this.sizetip.remove()},setContent:function(a){if(!a){this.tooltip.css("visibility","hidden"),this.hidden=!0;return}this.getSize(a),this.tooltip.html(a).css({width:this.width,height:this.height,visibility:"visible"}),this.hidden&&(this.hidden=!1,this.updatePosition())},updatePosition:function(a,b){if(a===c){if(this.mousex===c)return;a=this.mousex-this.offsetLeft,b=this.mousey-this.offsetTop}else this.mousex=a-=this.offsetLeft,this.mousey=b-=this.offsetTop;if(!this.height||!this.width||this.hidden)return;b-=this.height+this.tooltipOffsetY,a+=this.tooltipOffsetX,b<this.scrollTop&&(b=this.scrollTop),a<this.scrollLeft?a=this.scrollLeft:a+this.width>this.scrollRight&&(a=this.scrollRight-this.width),this.tooltip.css({left:a,top:b})},remove:function(){this.tooltip.remove(),this.sizetip.remove(),this.sizetip=this.tooltip=c,d(window).unbind("resize.jqs scroll.jqs")}}),F=function(){q(E)},d(F),K=[],d.fn.sparkline=function(b,e){return this.each(function(){var f=new d.fn.sparkline.options(this,e),g=d(this),h,i;h=function(){var e,h,i,j,k,l,m;if(b==="html"||b===c){m=this.getAttribute(f.get("tagValuesAttribute"));if(m===c||m===null)m=g.html();e=m.replace(/(^\s*<!--)|(-->\s*$)|\s+/g,"").split(",")}else e=b;h=f.get("width")==="auto"?e.length*f.get("defaultPixelsPerValue"):f.get("width");if(f.get("height")==="auto"){if(!f.get("composite")||!d.data(this,"_jqs_vcanvas"))j=a.createElement("span"),j.innerHTML="a",g.html(j),i=d(j).innerHeight()||d(j).height(),d(j).remove(),j=null}else i=f.get("height");f.get("disableInteraction")?k=!1:(k=d.data(this,"_jqs_mhandler"),k?f.get("composite")||k.reset():(k=new u(this,f),d.data(this,"_jqs_mhandler",k)));if(f.get("composite")&&!d.data(this,"_jqs_vcanvas")){d.data(this,"_jqs_errnotify")||(alert("Attempted to attach a composite sparkline to an element with no existing sparkline"),d.data(this,"_jqs_errnotify",!0));return}l=new(d.fn.sparkline[f.get("type")])(this,e,f,h,i),l.render(),k&&k.registerSparkline(l)};if(d(this).html()&&!f.get("disableHiddenCheck")&&d(this).is(":hidden")||!d(this).parents("body").length){if(!f.get("composite")&&d.data(this,"_jqs_pending"))for(i=K.length;i;i--)K[i-1][0]==this&&K.splice(i-1,1);K.push([this,h]),d.data(this,"_jqs_pending",!0)}else h.call(this)})},d.fn.sparkline.defaults=f(),d.sparkline_display_visible=function(){var a,b,c,e=[];for(b=0,c=K.length;b<c;b++)a=K[b][0],d(a).is(":visible")&&!d(a).parents().is(":hidden")?(K[b][1].call(a),d.data(K[b][0],"_jqs_pending",!1),e.push(b)):!d(a).closest("html").length&&!d.data(a,"_jqs_pending")&&(d.data(K[b][0],"_jqs_pending",!1),e.push(b));for(b=e.length;b;b--)K.splice(e[b-1],1)},d.fn.sparkline.options=g({init:function(a,b){var c,f,g,h;this.userOptions=b=b||{},this.tag=a,this.tagValCache={},f=d.fn.sparkline.defaults,g=f.common,this.tagOptionsPrefix=b.enableTagOptions&&(b.tagOptionsPrefix||g.tagOptionsPrefix),h=this.getTagSetting("type"),h===e?c=f[b.type||g.type]:c=f[h],this.mergedOptions=d.extend({},g,c,b)},getTagSetting:function(a){var b=this.tagOptionsPrefix,d,f,g,h;if(b===!1||b===c)return e;if(this.tagValCache.hasOwnProperty(a))d=this.tagValCache.key;else{d=this.tag.getAttribute(b+a);if(d===c||d===null)d=e;else if(d.substr(0,1)==="["){d=d.substr(1,d.length-2).split(",");for(f=d.length;f--;)d[f]=k(d[f].replace(/(^\s*)|(\s*$)/g,""))}else if(d.substr(0,1)==="{"){g=d.substr(1,d.length-2).split(","),d={};for(f=g.length;f--;)h=g[f].split(":",2),d[h[0].replace(/(^\s*)|(\s*$)/g,"")]=k(h[1].replace(/(^\s*)|(\s*$)/g,""))}else d=k(d);this.tagValCache.key=d}return d},get:function(a,b){var d=this.getTagSetting(a),f;return d!==e?d:(f=this.mergedOptions[a])===c?b:f}}),d.fn.sparkline._base=g({disabled:!1,init:function(a,b,e,f,g){this.el=a,this.$el=d(a),this.values=b,this.options=e,this.width=f,this.height=g,this.currentRegion=c},initTarget:function(){var a=!this.options.get("disableInteraction");(this.target=this.$el.simpledraw(this.width,this.height,this.options.get("composite"),a))?(this.canvasWidth=this.target.pixelWidth,this.canvasHeight=this.target.pixelHeight):this.disabled=!0},render:function(){return this.disabled?(this.el.innerHTML="",!1):!0},getRegion:function(a,b){},setRegionHighlight:function(a,b,d){var e=this.currentRegion,f=!this.options.get("disableHighlight"),g;return b>this.canvasWidth||d>this.canvasHeight||b<0||d<0?null:(g=this.getRegion(a,b,d),e!==g?(e!==c&&f&&this.removeHighlight(),this.currentRegion=g,g!==c&&f&&this.renderHighlight(),!0):!1)},clearRegionHighlight:function(){return this.currentRegion!==c?(this.removeHighlight(),this.currentRegion=c,!0):!1},renderHighlight:function(){this.changeHighlight(!0)},removeHighlight:function(){this.changeHighlight(!1)},changeHighlight:function(a){},getCurrentRegionTooltip:function(){var a=this.options,b="",e=[],f,g,i,j,k,l,m,n,o,p,q,r,s,t;if(this.currentRegion===c)return"";f=this.getCurrentRegionFields(),q=a.get("tooltipFormatter");if(q)return q(this,a,f);a.get("tooltipChartTitle")&&(b+='<div class="jqs jqstitle">'+a.get("tooltipChartTitle")+"</div>\n"),g=this.options.get("tooltipFormat");if(!g)return"";d.isArray(g)||(g=[g]),d.isArray(f)||(f=[f]),m=this.options.get("tooltipFormatFieldlist"),n=this.options.get("tooltipFormatFieldlistKey");if(m&&n){o=[];for(l=f.length;l--;)p=f[l][n],(t=d.inArray(p,m))!=-1&&(o[t]=f[l]);f=o}i=g.length,s=f.length;for(l=0;l<i;l++){r=g[l],typeof r=="string"&&(r=new h(r)),j=r.fclass||"jqsfield";for(t=0;t<s;t++)if(!f[t].isNull||!a.get("tooltipSkipNull"))d.extend(f[t],{prefix:a.get("tooltipPrefix"),suffix:a.get("tooltipSuffix")}),k=r.render(f[t],a.get("tooltipValueLookups"),a),e.push('<div class="'+j+'">'+k+"</div>")}return e.length?b+e.join("\n"):""},getCurrentRegionFields:function(){},calcHighlightColor:function(a,c){var d=c.get("highlightColor"),e=c.get("highlightLighten"),f,g,h,j;if(d)return d;if(e){f=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(a)||/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(a);if(f){h=[],g=a.length===4?16:1;for(j=0;j<3;j++)h[j]=i(b.round(parseInt(f[j+1],16)*g*e),0,255);return"rgb("+h.join(",")+")"}}return a}}),w={changeHighlight:function(a){var b=this.currentRegion,c=this.target,e=this.regionShapes[b],f;e&&(f=this.renderRegion(b,a),d.isArray(f)||d.isArray(e)?(c.replaceWithShapes(e,f),this.regionShapes[b]=d.map(f,function(a){return a.id})):(c.replaceWithShape(e,f),this.regionShapes[b]=f.id))},render:function(){var a=this.values,b=this.target,c=this.regionShapes,e,f,g,h;if(!this.cls._super.render.call(this))return;for(g=a.length;g--;){e=this.renderRegion(g);if(e)if(d.isArray(e)){f=[];for(h=e.length;h--;)e[h].append(),f.push(e[h].id);c[g]=f}else e.append(),c[g]=e.id;else c[g]=null}b.render()}},d.fn.sparkline.line=x=g(d.fn.sparkline._base,{type:"line",init:function(a,b,c,d,e){x._super.init.call(this,a,b,c,d,e),this.vertices=[],this.regionMap=[],this.xvalues=[],this.yvalues=[],this.yminmax=[],this.hightlightSpotId=null,this.lastShapeId=null,this.initTarget()},getRegion:function(a,b,d){var e,f=this.regionMap;for(e=f.length;e--;)if(f[e]!==null&&b>=f[e][0]&&b<=f[e][1])return f[e][2];return c},getCurrentRegionFields:function(){var a=this.currentRegion;return{isNull:this.yvalues[a]===null,x:this.xvalues[a],y:this.yvalues[a],color:this.options.get("lineColor"),fillColor:this.options.get("fillColor"),offset:a}},renderHighlight:function(){var a=this.currentRegion,b=this.target,d=this.vertices[a],e=this.options,f=e.get("spotRadius"),g=e.get("highlightSpotColor"),h=e.get("highlightLineColor"),i,j;if(!d)return;f&&g&&(i=b.drawCircle(d[0],d[1],f,c,g),this.highlightSpotId=i.id,b.insertAfterShape(this.lastShapeId,i)),h&&(j=b.drawLine(d[0],this.canvasTop,d[0],this.canvasTop+this.canvasHeight,h),this.highlightLineId=j.id,b.insertAfterShape(this.lastShapeId,j))},removeHighlight:function(){var a=this.target;this.highlightSpotId&&(a.removeShapeId(this.highlightSpotId),this.highlightSpotId=null),this.highlightLineId&&(a.removeShapeId(this.highlightLineId),this.highlightLineId=null)},scanValues:function(){var a=this.values,c=a.length,d=this.xvalues,e=this.yvalues,f=this.yminmax,g,h,i,j,k;for(g=0;g<c;g++)h=a[g],i=typeof a[g]=="string",j=typeof a[g]=="object"&&a[g]instanceof Array,k=i&&a[g].split(":"),i&&k.length===2?(d.push(Number(k[0])),e.push(Number(k[1])),f.push(Number(k[1]))):j?(d.push(h[0]),e.push(h[1]),f.push(h[1])):(d.push(g),a[g]===null||a[g]==="null"?e.push(null):(e.push(Number(h)),f.push(Number(h))));this.options.get("xvalues")&&(d=this.options.get("xvalues")),this.maxy=this.maxyorg=b.max.apply(b,f),this.miny=this.minyorg=b.min.apply(b,f),this.maxx=b.max.apply(b,d),this.minx=b.min.apply(b,d),this.xvalues=d,this.yvalues=e,this.yminmax=f},processRangeOptions:function(){var a=this.options,b=a.get("normalRangeMin"),d=a.get("normalRangeMax");b!==c&&(b<this.miny&&(this.miny=b),d>this.maxy&&(this.maxy=d)),a.get("chartRangeMin")!==c&&(a.get("chartRangeClip")||a.get("chartRangeMin")<this.miny)&&(this.miny=a.get("chartRangeMin")),a.get("chartRangeMax")!==c&&(a.get("chartRangeClip")||a.get("chartRangeMax")>this.maxy)&&(this.maxy=a.get("chartRangeMax")),a.get("chartRangeMinX")!==c&&(a.get("chartRangeClipX")||a.get("chartRangeMinX")<this.minx)&&(this.minx=a.get("chartRangeMinX")),a.get("chartRangeMaxX")!==c&&(a.get("chartRangeClipX")||a.get("chartRangeMaxX")>this.maxx)&&(this.maxx=a.get("chartRangeMaxX"))},drawNormalRange:function(a,d,e,f,g){var h=this.options.get("normalRangeMin"),i=this.options.get("normalRangeMax"),j=d+b.round(e-e*((i-this.miny)/g)),k=b.round(e*(i-h)/g);this.target.drawRect(a,j,f,k,c,this.options.get("normalRangeColor")).append()},render:function(){var a=this.options,e=this.target,f=this.canvasWidth,g=this.canvasHeight,h=this.vertices,i=a.get("spotRadius"),j=this.regionMap,k,l,m,n,o,p,q,r,s,u,v,w,y,z,A,B,C,D,E,F,G,H,I,J,K;if(!x._super.render.call(this))return;this.scanValues(),this.processRangeOptions(),I=this.xvalues,J=this.yvalues;if(!this.yminmax.length||this.yvalues.length<2)return;n=o=0,k=this.maxx-this.minx===0?1:this.maxx-this.minx,l=this.maxy-this.miny===0?1:this.maxy-this.miny,m=this.yvalues.length-1,i&&(f<i*4||g<i*4)&&(i=0);if(i){G=a.get("highlightSpotColor")&&!a.get("disableInteraction");if(G||a.get("minSpotColor")||a.get("spotColor")&&J[m]===this.miny)g-=b.ceil(i);if(G||a.get("maxSpotColor")||a.get("spotColor")&&J[m]===this.maxy)g-=b.ceil(i),n+=b.ceil(i);if(G||(a.get("minSpotColor")||a.get("maxSpotColor"))&&(J[0]===this.miny||J[0]===this.maxy))o+=b.ceil(i),f-=b.ceil(i);if(G||a.get("spotColor")||a.get("minSpotColor")||a.get("maxSpotColor")&&(J[m]===this.miny||J[m]===this.maxy))f-=b.ceil(i)}g--,a.get("normalRangeMin")!==c&&!a.get("drawNormalOnTop")&&this.drawNormalRange(o,n,g,f,l),q=[],r=[q],z=A=null,B=J.length;for(K=0;K<B;K++)s=I[K],v=I[K+1],u=J[K],w=o+b.round((s-this.minx)*(f/k)),y=K<B-1?o+b.round((v-this.minx)*(f/k)):f,A=w+(y-w)/2,j[K]=[z||0,A,K],z=A,u===null?K&&(J[K-1]!==null&&(q=[],r.push(q)),h.push(null)):(u<this.miny&&(u=this.miny),u>this.maxy&&(u=this.maxy),q.length||q.push([w,n+g]),p=[w,n+b.round(g-g*((u-this.miny)/l))],q.push(p),h.push(p));C=[],D=[],E=r.length;for(K=0;K<E;K++)q=r[K],q.length&&(a.get("fillColor")&&(q.push([q[q.length-1][0],n+g]),D.push(q.slice(0)),q.pop()),q.length>2&&(q[0]=[q[0][0],q[1][1]]),C.push(q));E=D.length;for(K=0;K<E;K++)e.drawShape(D[K],a.get("fillColor"),a.get("fillColor")).append();a.get("normalRangeMin")!==c&&a.get("drawNormalOnTop")&&this.drawNormalRange(o,n,g,f,l),E=C.length;for(K=0;K<E;K++)e.drawShape(C[K],a.get("lineColor"),c,a.get("lineWidth")).append();if(i&&a.get("valueSpots")){F=a.get("valueSpots"),F.get===c&&(F=new t(F));for(K=0;K<B;K++)H=F.get(J[K]),H&&e.drawCircle(o+b.round((I[K]-this.minx)*(f/k)),n+b.round(g-g*((J[K]-this.miny)/l)),i,c,H).append()}i&&a.get("spotColor")&&J[m]!==null&&e.drawCircle(o+b.round((I[I.length-1]-this.minx)*(f/k)),n+b.round(g-g*((J[m]-this.miny)/l)),i,c,a.get("spotColor")).append(),this.maxy!==this.minyorg&&(i&&a.get("minSpotColor")&&(s=I[d.inArray(this.minyorg,J)],e.drawCircle(o+b.round((s-this.minx)*(f/k)),n+b.round(g-g*((this.minyorg-this.miny)/l)),i,c,a.get("minSpotColor")).append()),i&&a.get("maxSpotColor")&&(s=I[d.inArray(this.maxyorg,J)],e.drawCircle(o+b.round((s-this.minx)*(f/k)),n+b.round(g-g*((this.maxyorg-this.miny)/l)),i,c,a.get("maxSpotColor")).append())),this.lastShapeId=e.getLastShapeId(),this.canvasTop=n,e.render()}}),d.fn.sparkline.bar=y=g(d.fn.sparkline._base,w,{type:"bar",init:function(a,e,f,g,h){var j=parseInt(f.get("barWidth"),10),n=parseInt(f.get("barSpacing"),10),o=f.get("chartRangeMin"),p=f.get("chartRangeMax"),q=f.get("chartRangeClip"),r=Infinity,s=-Infinity,u,v,w,x,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R;y._super.init.call(this,a,e,f,g,h);for(A=0,B=e.length;A<B;A++){O=e[A],u=typeof O=="string"&&O.indexOf(":")>-1;if(u||d.isArray(O))J=!0,u&&(O=e[A]=l(O.split(":"))),O=m(O,null),v=b.min.apply(b,O),w=b.max.apply(b,O),v<r&&(r=v),w>s&&(s=w)}this.stacked=J,this.regionShapes={},this.barWidth=j,this.barSpacing=n,this.totalBarWidth=j+n,this.width=g=e.length*j+(e.length-1)*n,this.initTarget(),q&&(H=o===c?-Infinity:o,I=p===c?Infinity:p),z=[],x=J?[]:z;var S=[],T=[];for(A=0,B=e.length;A<B;A++)if(J){K=e[A],e[A]=N=[],S[A]=0,x[A]=T[A]=0;for(L=0,M=K.length;L<M;L++)O=N[L]=q?i(K[L],H,I):K[L],O!==null&&(O>0&&(S[A]+=O),r<0&&s>0?O<0?T[A]+=b.abs(O):x[A]+=O:x[A]+=b.abs(O-(O<0?s:r)),z.push(O))}else O=q?i(e[A],H,I):e[A],O=e[A]=k(O),O!==null&&z.push(O);this.max=G=b.max.apply(b,z),this.min=F=b.min.apply(b,z),this.stackMax=s=J?b.max.apply(b,S):G,this.stackMin=r=J?b.min.apply(b,z):F,f.get("chartRangeMin")!==c&&(f.get("chartRangeClip")||f.get("chartRangeMin")<F)&&(F=f.get("chartRangeMin")),f.get("chartRangeMax")!==c&&(f.get("chartRangeClip")||f.get("chartRangeMax")>G)&&(G=f.get("chartRangeMax")),this.zeroAxis=D=f.get("zeroAxis",!0),F<=0&&G>=0&&D?E=0:D==0?E=F:F>0?E=F:E=G,this.xaxisOffset=E,C=J?b.max.apply(b,x)+b.max.apply(b,T):G-F,this.canvasHeightEf=D&&F<0?this.canvasHeight-2:this.canvasHeight-1,F<E?(Q=J&&G>=0?s:G,P=(Q-E)/C*this.canvasHeight,P!==b.ceil(P)&&(this.canvasHeightEf-=2,P=b.ceil(P))):P=this.canvasHeight,this.yoffset=P,d.isArray(f.get("colorMap"))?(this.colorMapByIndex=f.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=f.get("colorMap"),this.colorMapByValue&&this.colorMapByValue.get===c&&(this.colorMapByValue=new t(this.colorMapByValue))),this.range=C},getRegion:function(a,d,e){var f=b.floor(d/this.totalBarWidth);return f<0||f>=this.values.length?c:f},getCurrentRegionFields:function(){var a=this.currentRegion,b=r(this.values[a]),c=[],d,e;for(e=b.length;e--;)d=b[e],c.push({isNull:d===null,value:d,color:this.calcColor(e,d,a),offset:a});return c},calcColor:function(a,b,e){var f=this.colorMapByIndex,g=this.colorMapByValue,h=this.options,i,j;return this.stacked?i=h.get("stackedBarColor"):i=b<0?h.get("negBarColor"):h.get("barColor"),b===0&&h.get("zeroColor")!==c&&(i=h.get("zeroColor")),g&&(j=g.get(b))?i=j:f&&f.length>e&&(i=f[e]),d.isArray(i)?i[a%i.length]:i},renderRegion:function(a,e){var f=this.values[a],g=this.options,h=this.xaxisOffset,i=[],j=this.range,k=this.stacked,l=this.target,m=a*this.totalBarWidth,n=this.canvasHeightEf,p=this.yoffset,q,r,s,t,u,v,w,x,y,z;f=d.isArray(f)?f:[f],w=f.length,x=f[0],t=o(null,f),z=o(h,f,!0);if(t)return g.get("nullColor")?(s=e?g.get("nullColor"):this.calcHighlightColor(g.get("nullColor"),g),q=p>0?p-1:p,l.drawRect(m,q,this.barWidth-1,0,s,s)):c;u=p;for(v=0;v<w;v++){x=f[v];if(k&&x===h){if(!z||y)continue;y=!0}j>0?r=b.floor(n*(b.abs(x-h)/j))+1:r=1,x<h||x===h&&p===0?(q=u,u+=r):(q=p-r,p-=r),s=this.calcColor(v,x,a),e&&(s=this.calcHighlightColor(s,g)),i.push(l.drawRect(m,q,this.barWidth-1,r-1,s,s))}return i.length===1?i[0]:i}}),d.fn.sparkline.tristate=z=g(d.fn.sparkline._base,w,{type:"tristate",init:function(a,b,e,f,g){var h=parseInt(e.get("barWidth"),10),i=parseInt(e.get("barSpacing"),10);z._super.init.call(this,a,b,e,f,g),this.regionShapes={},this.barWidth=h,this.barSpacing=i,this.totalBarWidth=h+i,this.values=d.map(b,Number),this.width=f=b.length*h+(b.length-1)*i,d.isArray(e.get("colorMap"))?(this.colorMapByIndex=e.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=e.get("colorMap"),this.colorMapByValue&&this.colorMapByValue.get===c&&(this.colorMapByValue=new t(this.colorMapByValue))),this.initTarget()},getRegion:function(a,c,d){return b.floor(c/this.totalBarWidth)},getCurrentRegionFields:function(){var a=this.currentRegion;return{isNull:this.values[a]===c,value:this.values[a],color:this.calcColor(this.values[a],a),offset:a}},calcColor:function(a,b){var c=this.values,d=this.options,e=this.colorMapByIndex,f=this.colorMapByValue,g,h;return f&&(h=f.get(a))?g=h:e&&e.length>b?g=e[b]:c[b]<0?g=d.get("negBarColor"):c[b]>0?g=d.get("posBarColor"):g=d.get("zeroBarColor"),g},renderRegion:function(a,c){var d=this.values,e=this.options,f=this.target,g,h,i,j,k,l;g=f.pixelHeight,i=b.round(g/2),j=a*this.totalBarWidth,d[a]<0?(k=i,h=i-1):d[a]>0?(k=0,h=i-1):(k=i-1,h=2),l=this.calcColor(d[a],a);if(l===null)return;return c&&(l=this.calcHighlightColor(l,e)),f.drawRect(j,k,this.barWidth-1,h-1,l,l)}}),d.fn.sparkline.discrete=A=g(d.fn.sparkline._base,w,{type:"discrete",init:function(a,e,f,g,h){A._super.init.call(this,a,e,f,g,h),this.regionShapes={},this.values=e=d.map(e,Number),this.min=b.min.apply(b,e),this.max=b.max.apply(b,e),this.range=this.max-this.min,this.width=g=f.get("width")==="auto"?e.length*2:this.width,this.interval=b.floor(g/e.length),this.itemWidth=g/e.length,f.get("chartRangeMin")!==c&&(f.get("chartRangeClip")||f.get("chartRangeMin")<this.min)&&(this.min=f.get("chartRangeMin")),f.get("chartRangeMax")!==c&&(f.get("chartRangeClip")||f.get("chartRangeMax")>this.max)&&(this.max=f.get("chartRangeMax")),this.initTarget(),this.target&&(this.lineHeight=f.get("lineHeight")==="auto"?b.round(this.canvasHeight*.3):f.get("lineHeight"))},getRegion:function(a,c,d){return b.floor(c/this.itemWidth)},getCurrentRegionFields:function(){var a=this.currentRegion;return{isNull:this.values[a]===c,value:this.values[a],offset:a}},renderRegion:function(a,c){var d=this.values,e=this.options,f=this.min,g=this.max,h=this.range,j=this.interval,k=this.target,l=this.canvasHeight,m=this.lineHeight,n=l-m,o,p,q,r;return p=i(d[a],f,g),r=a*j,o=b.round(n-n*((p-f)/h)),q=e.get("thresholdColor")&&p<e.get("thresholdValue")?e.get("thresholdColor"):e.get("lineColor"),c&&(q=this.calcHighlightColor(q,e)),k.drawLine(r,o,r,o+m,q)}}),d.fn.sparkline.bullet=B=g(d.fn.sparkline._base,{type:"bullet",init:function(a,d,e,f,g){var h,i,j;B._super.init.call(this,a,d,e,f,g),this.values=d=l(d),j=d.slice(),j[0]=j[0]===null?j[2]:j[0],j[1]=d[1]===null?j[2]:j[1],h=b.min.apply(b,d),i=b.max.apply(b,d),e.get("base")===c?h=h<0?h:0:h=e.get("base"),this.min=h,this.max=i,this.range=i-h,this.shapes={},this.valueShapes={},this.regiondata={},this.width=f=e.get("width")==="auto"?"4.0em":f,this.target=this.$el.simpledraw(f,g,e.get("composite")),d.length||(this.disabled=!0),this.initTarget()},getRegion:function(a,b,d){var e=this.target.getShapeAt(a,b,d);return e!==c&&this.shapes[e]!==c?this.shapes[e]:c},getCurrentRegionFields:function(){var a=this.currentRegion;return{fieldkey:a.substr(0,1),value:this.values[a.substr(1)],region:a}},changeHighlight:function(a){var b=this.currentRegion,c=this.valueShapes[b],d;delete this.shapes[c];switch(b.substr(0,1)){case"r":d=this.renderRange(b.substr(1),a);break;case"p":d=this.renderPerformance(a);break;case"t":d=this.renderTarget(a)}this.valueShapes[b]=d.id,this.shapes[d.id]=b,this.target.replaceWithShape(c,d)},renderRange:function(a,c){var d=this.values[a],e=b.round(this.canvasWidth*((d-this.min)/this.range)),f=this.options.get("rangeColors")[a-2];return c&&(f=this.calcHighlightColor(f,this.options)),this.target.drawRect(0,0,e-1,this.canvasHeight-1,f,f)},renderPerformance:function(a){var c=this.values[1],d=b.round(this.canvasWidth*((c-this.min)/this.range)),e=this.options.get("performanceColor");return a&&(e=this.calcHighlightColor(e,this.options)),this.target.drawRect(0,b.round(this.canvasHeight*.3),d-1,b.round(this.canvasHeight*.4)-1,e,e)},renderTarget:function(a){var c=this.values[0],d=b.round(this.canvasWidth*((c-this.min)/this.range)-this.options.get("targetWidth")/2),e=b.round(this.canvasHeight*.1),f=this.canvasHeight-e*2,g=this.options.get("targetColor");return a&&(g=this.calcHighlightColor(g,this.options)),this.target.drawRect(d,e,this.options.get("targetWidth")-1,f-1,g,g)},render:function(){var a=this.values.length,b=this.target,c,d;if(!B._super.render.call(this))return;for(c=2;c<a;c++)d=this.renderRange(c).append(),this.shapes[d.id]="r"+c,this.valueShapes["r"+c]=d.id;this.values[1]!==null&&(d=this.renderPerformance().append(),this.shapes[d.id]="p1",this.valueShapes.p1=d.id),this.values[0]!==null&&(d=this.renderTarget().append(),this.shapes[d.id]="t0",this.valueShapes.t0=d.id),b.render()}}),d.fn.sparkline.pie=C=g(d.fn.sparkline._base,{type:"pie",init:function(a,c,e,f,g){var h=0,i;C._super.init.call(this,a,c,e,f,g),this.shapes={},this.valueShapes={},this.values=c=d.map(c,Number),e.get("width")==="auto"&&(this.width=this.height);if(c.length>0)for(i=c.length;i--;)h+=c[i];this.total=h,this.initTarget(),this.radius=b.floor(b.min(this.canvasWidth,this.canvasHeight)/2)},getRegion:function(a,b,d){var e=this.target.getShapeAt(a,b,d);return e!==c&&this.shapes[e]!==c?this.shapes[e]:c},getCurrentRegionFields:function(){var a=this.currentRegion;return{isNull:this.values[a]===c,value:this.values[a],percent:this.values[a]/this.total*100,color:this.options.get("sliceColors")[a%this.options.get("sliceColors").length],offset:a}},changeHighlight:function(a){var b=this.currentRegion,c=this.renderSlice(b,a),d=this.valueShapes[b];delete this.shapes[d],this.target.replaceWithShape(d,c),this.valueShapes[b]=c.id,this.shapes[c.id]=b},renderSlice:function(a,d){var e=this.target,f=this.options,g=this.radius,h=f.get("borderWidth"),i=f.get("offset"),j=2*b.PI,k=this.values,l=this.total,m=i?2*b.PI*(i/360):0,n,o,p,q,r;q=k.length;for(p=0;p<q;p++){n=m,o=m,l>0&&(o=m+j*(k[p]/l));if(a===p)return r=f.get("sliceColors")[p%f.get("sliceColors").length],d&&(r=this.calcHighlightColor(r,f)),e.drawPieSlice(g,g,g-h,n,o,c,r);m=o}},render:function(){var a=this.target,d=this.values,e=this.options,f=this.radius,g=e.get("borderWidth"),h,i;if(!C._super.render.call(this))return;g&&a.drawCircle(f,f,b.floor(f-g/2),e.get("borderColor"),c,g).append();for(i=d.length;i--;)d[i]&&(h=this.renderSlice(i).append(),this.valueShapes[i]=h.id,this.shapes[h.id]=i);a.render()}}),d.fn.sparkline.box=D=g(d.fn.sparkline._base,{type:"box",init:function(a,b,c,e,f){D._super.init.call(this,a,b,c,e,f),this.values=d.map(b,Number),this.width=c.get("width")==="auto"?"4.0em":e,this.initTarget(),this.values.length||(this.disabled=1)},getRegion:function(){return 1},getCurrentRegionFields:function(){var a=[{field:"lq",value:this.quartiles[0]},{field:"med",value:this.quartiles
            [1]},{field:"uq",value:this.quartiles[2]}];return this.loutlier!==c&&a.push({field:"lo",value:this.loutlier}),this.routlier!==c&&a.push({field:"ro",value:this.routlier}),this.lwhisker!==c&&a.push({field:"lw",value:this.lwhisker}),this.rwhisker!==c&&a.push({field:"rw",value:this.rwhisker}),a},render:function(){var a=this.target,d=this.values,e=d.length,f=this.options,g=this.canvasWidth,h=this.canvasHeight,i=f.get("chartRangeMin")===c?b.min.apply(b,d):f.get("chartRangeMin"),k=f.get("chartRangeMax")===c?b.max.apply(b,d):f.get("chartRangeMax"),l=0,m,n,o,p,q,r,s,t,u,v,w;if(!D._super.render.call(this))return;if(f.get("raw"))f.get("showOutliers")&&d.length>5?(n=d[0],m=d[1],p=d[2],q=d[3],r=d[4],s=d[5],t=d[6]):(m=d[0],p=d[1],q=d[2],r=d[3],s=d[4]);else{d.sort(function(a,b){return a-b}),p=j(d,1),q=j(d,2),r=j(d,3),o=r-p;if(f.get("showOutliers")){m=s=c;for(u=0;u<e;u++)m===c&&d[u]>p-o*f.get("outlierIQR")&&(m=d[u]),d[u]<r+o*f.get("outlierIQR")&&(s=d[u]);n=d[0],t=d[e-1]}else m=d[0],s=d[e-1]}this.quartiles=[p,q,r],this.lwhisker=m,this.rwhisker=s,this.loutlier=n,this.routlier=t,w=g/(k-i+1),f.get("showOutliers")&&(l=b.ceil(f.get("spotRadius")),g-=2*b.ceil(f.get("spotRadius")),w=g/(k-i+1),n<m&&a.drawCircle((n-i)*w+l,h/2,f.get("spotRadius"),f.get("outlierLineColor"),f.get("outlierFillColor")).append(),t>s&&a.drawCircle((t-i)*w+l,h/2,f.get("spotRadius"),f.get("outlierLineColor"),f.get("outlierFillColor")).append()),a.drawRect(b.round((p-i)*w+l),b.round(h*.1),b.round((r-p)*w),b.round(h*.8),f.get("boxLineColor"),f.get("boxFillColor")).append(),a.drawLine(b.round((m-i)*w+l),b.round(h/2),b.round((p-i)*w+l),b.round(h/2),f.get("lineColor")).append(),a.drawLine(b.round((m-i)*w+l),b.round(h/4),b.round((m-i)*w+l),b.round(h-h/4),f.get("whiskerColor")).append(),a.drawLine(b.round((s-i)*w+l),b.round(h/2),b.round((r-i)*w+l),b.round(h/2),f.get("lineColor")).append(),a.drawLine(b.round((s-i)*w+l),b.round(h/4),b.round((s-i)*w+l),b.round(h-h/4),f.get("whiskerColor")).append(),a.drawLine(b.round((q-i)*w+l),b.round(h*.1),b.round((q-i)*w+l),b.round(h*.9),f.get("medianColor")).append(),f.get("target")&&(v=b.ceil(f.get("spotRadius")),a.drawLine(b.round((f.get("target")-i)*w+l),b.round(h/2-v),b.round((f.get("target")-i)*w+l),b.round(h/2+v),f.get("targetColor")).append(),a.drawLine(b.round((f.get("target")-i)*w+l-v),b.round(h/2),b.round((f.get("target")-i)*w+l+v),b.round(h/2),f.get("targetColor")).append()),a.render()}}),G=g({init:function(a,b,c,d){this.target=a,this.id=b,this.type=c,this.args=d},append:function(){return this.target.appendShape(this),this}}),H=g({_pxregex:/(\d+)(px)?\s*$/i,init:function(a,b,c){if(!a)return;this.width=a,this.height=b,this.target=c,this.lastShapeId=null,c[0]&&(c=c[0]),d.data(c,"_jqs_vcanvas",this)},drawLine:function(a,b,c,d,e,f){return this.drawShape([[a,b],[c,d]],e,f)},drawShape:function(a,b,c,d){return this._genShape("Shape",[a,b,c,d])},drawCircle:function(a,b,c,d,e,f){return this._genShape("Circle",[a,b,c,d,e,f])},drawPieSlice:function(a,b,c,d,e,f,g){return this._genShape("PieSlice",[a,b,c,d,e,f,g])},drawRect:function(a,b,c,d,e,f){return this._genShape("Rect",[a,b,c,d,e,f])},getElement:function(){return this.canvas},getLastShapeId:function(){return this.lastShapeId},reset:function(){alert("reset not implemented")},_insert:function(a,b){d(b).html(a)},_calculatePixelDims:function(a,b,c){var e;e=this._pxregex.exec(b),e?this.pixelHeight=e[1]:this.pixelHeight=d(c).height(),e=this._pxregex.exec(a),e?this.pixelWidth=e[1]:this.pixelWidth=d(c).width()},_genShape:function(a,b){var c=L++;return b.unshift(c),new G(this,c,a,b)},appendShape:function(a){alert("appendShape not implemented")},replaceWithShape:function(a,b){alert("replaceWithShape not implemented")},insertAfterShape:function(a,b){alert("insertAfterShape not implemented")},removeShapeId:function(a){alert("removeShapeId not implemented")},getShapeAt:function(a,b,c){alert("getShapeAt not implemented")},render:function(){alert("render not implemented")}}),I=g(H,{init:function(b,e,f,g){I._super.init.call(this,b,e,f),this.canvas=a.createElement("canvas"),f[0]&&(f=f[0]),d.data(f,"_jqs_vcanvas",this),d(this.canvas).css({display:"inline-block",width:b,height:e,verticalAlign:"top"}),this._insert(this.canvas,f),this._calculatePixelDims(b,e,this.canvas),this.canvas.width=this.pixelWidth,this.canvas.height=this.pixelHeight,this.interact=g,this.shapes={},this.shapeseq=[],this.currentTargetShapeId=c,d(this.canvas).css({width:this.pixelWidth,height:this.pixelHeight})},_getContext:function(a,b,d){var e=this.canvas.getContext("2d");return a!==c&&(e.strokeStyle=a),e.lineWidth=d===c?1:d,b!==c&&(e.fillStyle=b),e},reset:function(){var a=this._getContext();a.clearRect(0,0,this.pixelWidth,this.pixelHeight),this.shapes={},this.shapeseq=[],this.currentTargetShapeId=c},_drawShape:function(a,b,d,e,f){var g=this._getContext(d,e,f),h,i;g.beginPath(),g.moveTo(b[0][0]+.5,b[0][1]+.5);for(h=1,i=b.length;h<i;h++)g.lineTo(b[h][0]+.5,b[h][1]+.5);d!==c&&g.stroke(),e!==c&&g.fill(),this.targetX!==c&&this.targetY!==c&&g.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=a)},_drawCircle:function(a,d,e,f,g,h,i){var j=this._getContext(g,h,i);j.beginPath(),j.arc(d,e,f,0,2*b.PI,!1),this.targetX!==c&&this.targetY!==c&&j.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=a),g!==c&&j.stroke(),h!==c&&j.fill()},_drawPieSlice:function(a,b,d,e,f,g,h,i){var j=this._getContext(h,i);j.beginPath(),j.moveTo(b,d),j.arc(b,d,e,f,g,!1),j.lineTo(b,d),j.closePath(),h!==c&&j.stroke(),i&&j.fill(),this.targetX!==c&&this.targetY!==c&&j.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=a)},_drawRect:function(a,b,c,d,e,f,g){return this._drawShape(a,[[b,c],[b+d,c],[b+d,c+e],[b,c+e],[b,c]],f,g)},appendShape:function(a){return this.shapes[a.id]=a,this.shapeseq.push(a.id),this.lastShapeId=a.id,a.id},replaceWithShape:function(a,b){var c=this.shapeseq,d;this.shapes[b.id]=b;for(d=c.length;d--;)c[d]==a&&(c[d]=b.id);delete this.shapes[a]},replaceWithShapes:function(a,b){var c=this.shapeseq,d={},e,f,g;for(f=a.length;f--;)d[a[f]]=!0;for(f=c.length;f--;)e=c[f],d[e]&&(c.splice(f,1),delete this.shapes[e],g=f);for(f=b.length;f--;)c.splice(g,0,b[f].id),this.shapes[b[f].id]=b[f]},insertAfterShape:function(a,b){var c=this.shapeseq,d;for(d=c.length;d--;)if(c[d]===a){c.splice(d+1,0,b.id),this.shapes[b.id]=b;return}},removeShapeId:function(a){var b=this.shapeseq,c;for(c=b.length;c--;)if(b[c]===a){b.splice(c,1);break}delete this.shapes[a]},getShapeAt:function(a,b,c){return this.targetX=b,this.targetY=c,this.render(),this.currentTargetShapeId},render:function(){var a=this.shapeseq,b=this.shapes,c=a.length,d=this._getContext(),e,f,g;d.clearRect(0,0,this.pixelWidth,this.pixelHeight);for(g=0;g<c;g++)e=a[g],f=b[e],this["_draw"+f.type].apply(this,f.args);this.interact||(this.shapes={},this.shapeseq=[])}}),J=g(H,{init:function(b,c,e){var f;J._super.init.call(this,b,c,e),e[0]&&(e=e[0]),d.data(e,"_jqs_vcanvas",this),this.canvas=a.createElement("span"),d(this.canvas).css({display:"inline-block",position:"relative",overflow:"hidden",width:b,height:c,margin:"0px",padding:"0px",verticalAlign:"top"}),this._insert(this.canvas,e),this._calculatePixelDims(b,c,this.canvas),this.canvas.width=this.pixelWidth,this.canvas.height=this.pixelHeight,f='<v:group coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'"'+' style="position:absolute;top:0;left:0;width:'+this.pixelWidth+"px;height="+this.pixelHeight+'px;"></v:group>',this.canvas.insertAdjacentHTML("beforeEnd",f),this.group=d(this.canvas).children()[0],this.rendered=!1,this.prerender=""},_drawShape:function(a,b,d,e,f){var g=[],h,i,j,k,l,m,n;for(n=0,m=b.length;n<m;n++)g[n]=""+b[n][0]+","+b[n][1];return h=g.splice(0,1),f=f===c?1:f,i=d===c?' stroked="false" ':' strokeWeight="'+f+'px" strokeColor="'+d+'" ',j=e===c?' filled="false"':' fillColor="'+e+'" filled="true" ',k=g[0]===g[g.length-1]?"x ":"",l='<v:shape coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'" '+' id="jqsshape'+a+'" '+i+j+' style="position:absolute;left:0px;top:0px;height:'+this.pixelHeight+"px;width:"+this.pixelWidth+'px;padding:0px;margin:0px;" '+' path="m '+h+" l "+g.join(", ")+" "+k+'e">'+" </v:shape>",l},_drawCircle:function(a,b,d,e,f,g,h){var i,j,k;return b-=e,d-=e,i=f===c?' stroked="false" ':' strokeWeight="'+h+'px" strokeColor="'+f+'" ',j=g===c?' filled="false"':' fillColor="'+g+'" filled="true" ',k='<v:oval  id="jqsshape'+a+'" '+i+j+' style="position:absolute;top:'+d+"px; left:"+b+"px; width:"+e*2+"px; height:"+e*2+'px"></v:oval>',k},_drawPieSlice:function(a,d,e,f,g,h,i,j){var k,l,m,n,o,p,q,r;if(g===h)return"";h-g===2*b.PI&&(g=0,h=2*b.PI),l=d+b.round(b.cos(g)*f),m=e+b.round(b.sin(g)*f),n=d+b.round(b.cos(h)*f),o=e+b.round(b.sin(h)*f);if(l===n&&m===o){if(h-g<b.PI)return"";l=n=d+f,m=o=e}return l===n&&m===o&&h-g<b.PI?"":(k=[d-f,e-f,d+f,e+f,l,m,n,o],p=i===c?' stroked="false" ':' strokeWeight="1px" strokeColor="'+i+'" ',q=j===c?' filled="false"':' fillColor="'+j+'" filled="true" ',r='<v:shape coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'" '+' id="jqsshape'+a+'" '+p+q+' style="position:absolute;left:0px;top:0px;height:'+this.pixelHeight+"px;width:"+this.pixelWidth+'px;padding:0px;margin:0px;" '+' path="m '+d+","+e+" wa "+k.join(", ")+' x e">'+" </v:shape>",r)},_drawRect:function(a,b,c,d,e,f,g){return this._drawShape(a,[[b,c],[b,c+e],[b+d,c+e],[b+d,c],[b,c]],f,g)},reset:function(){this.group.innerHTML=""},appendShape:function(a){var b=this["_draw"+a.type].apply(this,a.args);return this.rendered?this.group.insertAdjacentHTML("beforeEnd",b):this.prerender+=b,this.lastShapeId=a.id,a.id},replaceWithShape:function(a,b){var c=d("#jqsshape"+a),e=this["_draw"+b.type].apply(this,b.args);c[0].outerHTML=e},replaceWithShapes:function(a,b){var c=d("#jqsshape"+a[0]),e="",f=b.length,g;for(g=0;g<f;g++)e+=this["_draw"+b[g].type].apply(this,b[g].args);c[0].outerHTML=e;for(g=1;g<a.length;g++)d("#jqsshape"+a[g]).remove()},insertAfterShape:function(a,b){var c=d("#jqsshape"+a),e=this["_draw"+b.type].apply(this,b.args);c[0].insertAdjacentHTML("afterEnd",e)},removeShapeId:function(a){var b=d("#jqsshape"+a);this.group.removeChild(b[0])},getShapeAt:function(a,b,c){var d=a.id.substr(8);return d},render:function(){this.rendered||(this.group.innerHTML=this.prerender,this.rendered=!0)}})})})(document,Math);

/* jqPlot 1.0.8r1250 | (c) 2009-2013 Chris Leonello | jplot.com
   jsDate | (c) 2010-2013 Chris Leonello
 */(function(a){a.jqplot.CanvasAxisLabelRenderer=function(b){this.angle=0;this.axis;this.show=true;this.showLabel=true;this.label="";this.fontFamily='"Trebuchet MS", Arial, Helvetica, sans-serif';this.fontSize="11pt";this.fontWeight="normal";this.fontStretch=1;this.textColor="#666666";this.enableFontSupport=true;this.pt2px=null;this._elem;this._ctx;this._plotWidth;this._plotHeight;this._plotDimensions={height:null,width:null};a.extend(true,this,b);if(b.angle==null&&this.axis!="xaxis"&&this.axis!="x2axis"){this.angle=-90}var c={fontSize:this.fontSize,fontWeight:this.fontWeight,fontStretch:this.fontStretch,fillStyle:this.textColor,angle:this.getAngleRad(),fontFamily:this.fontFamily};if(this.pt2px){c.pt2px=this.pt2px}if(this.enableFontSupport){if(a.jqplot.support_canvas_text()){this._textRenderer=new a.jqplot.CanvasFontRenderer(c)}else{this._textRenderer=new a.jqplot.CanvasTextRenderer(c)}}else{this._textRenderer=new a.jqplot.CanvasTextRenderer(c)}};a.jqplot.CanvasAxisLabelRenderer.prototype.init=function(b){a.extend(true,this,b);this._textRenderer.init({fontSize:this.fontSize,fontWeight:this.fontWeight,fontStretch:this.fontStretch,fillStyle:this.textColor,angle:this.getAngleRad(),fontFamily:this.fontFamily})};a.jqplot.CanvasAxisLabelRenderer.prototype.getWidth=function(d){if(this._elem){return this._elem.outerWidth(true)}else{var f=this._textRenderer;var c=f.getWidth(d);var e=f.getHeight(d);var b=Math.abs(Math.sin(f.angle)*e)+Math.abs(Math.cos(f.angle)*c);return b}};a.jqplot.CanvasAxisLabelRenderer.prototype.getHeight=function(d){if(this._elem){return this._elem.outerHeight(true)}else{var f=this._textRenderer;var c=f.getWidth(d);var e=f.getHeight(d);var b=Math.abs(Math.cos(f.angle)*e)+Math.abs(Math.sin(f.angle)*c);return b}};a.jqplot.CanvasAxisLabelRenderer.prototype.getAngleRad=function(){var b=this.angle*Math.PI/180;return b};a.jqplot.CanvasAxisLabelRenderer.prototype.draw=function(c,f){if(this._elem){if(a.jqplot.use_excanvas&&window.G_vmlCanvasManager.uninitElement!==undefined){window.G_vmlCanvasManager.uninitElement(this._elem.get(0))}this._elem.emptyForce();this._elem=null}var e=f.canvasManager.getCanvas();this._textRenderer.setText(this.label,c);var b=this.getWidth(c);var d=this.getHeight(c);e.width=b;e.height=d;e.style.width=b;e.style.height=d;e=f.canvasManager.initCanvas(e);this._elem=a(e);this._elem.css({position:"absolute"});this._elem.addClass("jqplot-"+this.axis+"-label");e=null;return this._elem};a.jqplot.CanvasAxisLabelRenderer.prototype.pack=function(){this._textRenderer.draw(this._elem.get(0).getContext("2d"),this.label)}})(jQuery);

 /*
 Highcharts JS v3.0.7 (2013-10-24)
 (c) 2009-2013 Torstein Hønsi
 License: www.highcharts.com/license
*/
(function(){function s(a,b){var c;a||(a={});for(c in b)a[c]=b[c];return a}function x(){var a,b=arguments.length,c={},d=function(a,b){var c,h;typeof a!=="object"&&(a={});for(h in b)b.hasOwnProperty(h)&&(c=b[h],a[h]=c&&typeof c==="object"&&Object.prototype.toString.call(c)!=="[object Array]"&&typeof c.nodeType!=="number"?d(a[h]||{},c):b[h]);return a};for(a=0;a<b;a++)c=d(c,arguments[a]);return c}function y(a,b){return parseInt(a,b||10)}function ea(a){return typeof a==="string"}function T(a){return typeof a==="object"}function Ia(a){return Object.prototype.toString.call(a)==="[object Array]"}function ra(a){return typeof a==="number"}function ma(a){return R.log(a)/R.LN10}function fa(a){return R.pow(10,a)}function ga(a,b){for(var c=a.length;c--;)if(a[c]===b){a.splice(c,1);break}}function u(a){return a!==v&&a!==null}function w(a,b,c){var d,e;if(ea(b))u(c)?a.setAttribute(b,c):a&&a.getAttribute&&(e=a.getAttribute(b));else if(u(b)&&T(b))for(d in b)a.setAttribute(d,b[d]);return e}function ja(a){return Ia(a)?a:[a]}function o(){var a=arguments,b,c,d=a.length;for(b=0;b<d;b++)if(c=a[b],typeof c!=="undefined"&&c!==null)return c}function I(a,b){if(sa&&b&&b.opacity!==v)b.filter="alpha(opacity="+b.opacity*100+")";s(a.style,b)}function U(a,b,c,d,e){a=z.createElement(a);b&&s(a,b);e&&I(a,{padding:0,border:S,margin:0});c&&I(a,c);d&&d.appendChild(a);return a}function ha(a,b){var c=function(){};c.prototype=new a;s(c.prototype,b);return c}function Aa(a,b,c,d){var e=L.lang,a=+a||0,f=b===-1?(a.toString().split(".")[1]||"").length:isNaN(b=M(b))?2:b,b=c===void 0?e.decimalPoint:c,d=d===void 0?e.thousandsSep:d,e=a<0?"-":"",c=String(y(a=M(a).toFixed(f))),g=c.length>3?c.length%3:0;return e+(g?c.substr(0,g)+d:"")+c.substr(g).replace(/(\d{3})(?=\d)/g,"$1"+d)+(f?b+M(a-c).toFixed(f).slice(2):"")}function Ba(a,b){return Array((b||2)+1-String(a).length).join(0)+a}function mb(a,b,c){var d=a[b];a[b]=function(){var a=Array.prototype.slice.call(arguments);a.unshift(d);return c.apply(this,a)}}function Ca(a,b){for(var c="{",d=!1,e,f,g,h,i,j=[];(c=a.indexOf(c))!==-1;){e=a.slice(0,c);if(d){f=e.split(":");g=f.shift().split(".");i=g.length;e=b;for(h=0;h<i;h++)e=e[g[h]];if(f.length)f=f.join(":"),g=/\.([0-9])/,h=L.lang,i=void 0,/f$/.test(f)?(i=(i=f.match(g))?i[1]:-1,e=Aa(e,i,h.decimalPoint,f.indexOf(",")>-1?h.thousandsSep:"")):e=Ya(f,e)}j.push(e);a=a.slice(c+1);c=(d=!d)?"}":"{"}j.push(a);return j.join("")}function nb(a){return R.pow(10,P(R.log(a)/R.LN10))}function ob(a,b,c,d){var e,c=o(c,1);e=a/c;b||(b=[1,2,2.5,5,10],d&&d.allowDecimals===!1&&(c===1?b=[1,2,5,10]:c<=0.1&&(b=[1/c])));for(d=0;d<b.length;d++)if(a=b[d],e<=(b[d]+(b[d+1]||b[d]))/2)break;a*=c;return a}function Cb(a,b){var c=b||[[Db,[1,2,5,10,20,25,50,100,200,500]],[pb,[1,2,5,10,15,30]],[Za,[1,2,5,10,15,30]],[Qa,[1,2,3,4,6,8,12]],[ta,[1,2]],[$a,[1,2]],[Ra,[1,2,3,4,6]],[Da,null]],d=c[c.length-1],e=D[d[0]],f=d[1],g;for(g=0;g<c.length;g++)if(d=c[g],e=D[d[0]],f=d[1],c[g+1]&&a<=(e*f[f.length-1]+D[c[g+1][0]])/2)break;e===D[Da]&&a<5*e&&(f=[1,2,5]);c=ob(a/e,f,d[0]===Da?r(nb(a/e),1):1);return{unitRange:e,count:c,unitName:d[0]}}function Eb(a,b,c,d){var e=[],f={},g=L.global.useUTC,h,i=new Date(b),j=a.unitRange,k=a.count;if(u(b)){j>=D[pb]&&(i.setMilliseconds(0),i.setSeconds(j>=D[Za]?0:k*P(i.getSeconds()/k)));if(j>=D[Za])i[Fb](j>=D[Qa]?0:k*P(i[qb]()/k));if(j>=D[Qa])i[Gb](j>=D[ta]?0:k*P(i[rb]()/k));if(j>=D[ta])i[sb](j>=D[Ra]?1:k*P(i[Sa]()/k));j>=D[Ra]&&(i[Hb](j>=D[Da]?0:k*P(i[ab]()/k)),h=i[bb]());j>=D[Da]&&(h-=h%k,i[Ib](h));if(j===D[$a])i[sb](i[Sa]()-i[tb]()+o(d,1));b=1;h=i[bb]();for(var d=i.getTime(),l=i[ab](),m=i[Sa](),p=g?0:(864E5+i.getTimezoneOffset()*6E4)%864E5;d<c;)e.push(d),j===D[Da]?d=cb(h+b*k,0):j===D[Ra]?d=cb(h,l+b*k):!g&&(j===D[ta]||j===D[$a])?d=cb(h,l,m+b*k*(j===D[ta]?1:7)):d+=j*k,b++;e.push(d);n(ub(e,function(a){return j<=D[Qa]&&a%D[ta]===p}),function(a){f[a]=ta})}e.info=s(a,{higherRanks:f,totalRange:j*k});return e}function Jb(){this.symbol=this.color=0}function Kb(a,b){var c=a.length,d,e;for(e=0;e<c;e++)a[e].ss_i=e;a.sort(function(a,c){d=b(a,c);return d===0?a.ss_i-c.ss_i:d});for(e=0;e<c;e++)delete a[e].ss_i}function Ja(a){for(var b=a.length,c=a[0];b--;)a[b]<c&&(c=a[b]);return c}function ua(a){for(var b=a.length,c=a[0];b--;)a[b]>c&&(c=a[b]);return c}function Ka(a,b){for(var c in a)a[c]&&a[c]!==b&&a[c].destroy&&a[c].destroy(),delete a[c]}function Ta(a){db||(db=U(Ea));a&&db.appendChild(a);db.innerHTML=""}function ka(a,b){var c="Highcharts error #"+a+": www.highcharts.com/errors/"+a;if(b)throw c;else N.console&&console.log(c)}function ia(a){return parseFloat(a.toPrecision(14))}function La(a,b){Fa=o(a,b.animation)}function Lb(){var a=L.global.useUTC,b=a?"getUTC":"get",c=a?"setUTC":"set";cb=a?Date.UTC:function(a,b,c,g,h,i){return(new Date(a,b,o(c,1),o(g,0),o(h,0),o(i,0))).getTime()};qb=b+"Minutes";rb=b+"Hours";tb=b+"Day";Sa=b+"Date";ab=b+"Month";bb=b+"FullYear";Fb=c+"Minutes";Gb=c+"Hours";sb=c+"Date";Hb=c+"Month";Ib=c+"FullYear"}function va(){}function Ma(a,b,c,d){this.axis=a;this.pos=b;this.type=c||"";this.isNew=!0;!c&&!d&&this.addLabel()}function vb(a,b){this.axis=a;if(b)this.options=b,this.id=b.id}function Mb(a,b,c,d,e,f){var g=a.chart.inverted;this.axis=a;this.isNegative=c;this.options=b;this.x=d;this.total=null;this.points={};this.stack=e;this.percent=f==="percent";this.alignOptions={align:b.align||(g?c?"left":"right":"center"),verticalAlign:b.verticalAlign||(g?"middle":c?"bottom":"top"),y:o(b.y,g?4:c?14:-6),x:o(b.x,g?c?-6:6:0)};this.textAlign=b.textAlign||(g?c?"right":"left":"center")}function eb(){this.init.apply(this,arguments)}function wb(){this.init.apply(this,arguments)}function xb(a,b){this.init(a,b)}function fb(a,b){this.init(a,b)}function yb(){this.init.apply(this,arguments)}var v,z=document,N=window,R=Math,t=R.round,P=R.floor,wa=R.ceil,r=R.max,J=R.min,M=R.abs,V=R.cos,ba=R.sin,xa=R.PI,Ua=xa*2/360,na=navigator.userAgent,Nb=N.opera,sa=/msie/i.test(na)&&!Nb,gb=z.documentMode===8,hb=/AppleWebKit/.test(na),ib=/Firefox/.test(na),Ob=/(Mobile|Android|Windows Phone)/.test(na),ya="http://www.w3.org/2000/svg",W=!!z.createElementNS&&!!z.createElementNS(ya,"svg").createSVGRect,Ub=ib&&parseInt(na.split("Firefox/")[1],10)<4,ca=!W&&!sa&&!!z.createElement("canvas").getContext,Va,jb=z.documentElement.ontouchstart!==v,Pb={},zb=0,db,L,Ya,Fa,Ab,D,oa=function(){},Ga=[],Ea="div",S="none",Qb="rgba(192,192,192,"+(W?1.0E-4:0.002)+")",Db="millisecond",pb="second",Za="minute",Qa="hour",ta="day",$a="week",Ra="month",Da="year",Rb="stroke-width",cb,qb,rb,tb,Sa,ab,bb,Fb,Gb,sb,Hb,Ib,X={};N.Highcharts=N.Highcharts?ka(16,!0):{};Ya=function(a,b,c){if(!u(b)||isNaN(b))return"Invalid date";var a=o(a,"%Y-%m-%d %H:%M:%S"),d=new Date(b),e,f=d[rb](),g=d[tb](),h=d[Sa](),i=d[ab](),j=d[bb](),k=L.lang,l=k.weekdays,d=s({a:l[g].substr(0,3),A:l[g],d:Ba(h),e:h,b:k.shortMonths[i],B:k.months[i],m:Ba(i+1),y:j.toString().substr(2,2),Y:j,H:Ba(f),I:Ba(f%12||12),l:f%12||12,M:Ba(d[qb]()),p:f<12?"AM":"PM",P:f<12?"am":"pm",S:Ba(d.getSeconds()),L:Ba(t(b%1E3),3)},Highcharts.dateFormats);for(e in d)for(;a.indexOf("%"+e)!==-1;)a=a.replace("%"+e,typeof d[e]==="function"?d[e](b):d[e]);return c?a.substr(0,1).toUpperCase()+a.substr(1):a};Jb.prototype={wrapColor:function(a){if(this.color>=a)this.color=0},wrapSymbol:function(a){if(this.symbol>=a)this.symbol=0}};D=function(){for(var a=0,b=arguments,c=b.length,d={};a<c;a++)d[b[a++]]=b[a];return d}(Db,1,pb,1E3,Za,6E4,Qa,36E5,ta,864E5,$a,6048E5,Ra,26784E5,Da,31556952E3);Ab={init:function(a,b,c){var b=b||"",d=a.shift,e=b.indexOf("C")>-1,f=e?7:3,g,b=b.split(" "),c=[].concat(c),h,i,j=function(a){for(g=a.length;g--;)a[g]==="M"&&a.splice(g+1,0,a[g+1],a[g+2],a[g+1],a[g+2])};e&&(j(b),j(c));a.isArea&&(h=b.splice(b.length-6,6),i=c.splice(c.length-6,6));if(d<=c.length/f&&b.length===c.length)for(;d--;)c=[].concat(c).splice(0,f).concat(c);a.shift=0;if(b.length)for(a=c.length;b.length<a;)d=[].concat(b).splice(b.length-f,f),e&&(d[f-6]=d[f-2],d[f-5]=d[f-1]),b=b.concat(d);h&&(b=b.concat(h),c=c.concat(i));return[b,c]},step:function(a,b,c,d){var e=[],f=a.length;if(c===1)e=d;else if(f===b.length&&c<1)for(;f--;)d=parseFloat(a[f]),e[f]=isNaN(d)?a[f]:c*parseFloat(b[f]-d)+d;else e=b;return e}};(function(a){N.HighchartsAdapter=N.HighchartsAdapter||a&&{init:function(b){var c=a.fx,d=c.step,e,f=a.Tween,g=f&&f.propHooks;e=a.cssHooks.opacity;a.extend(a.easing,{easeOutQuad:function(a,b,c,d,e){return-d*(b/=e)*(b-2)+c}});a.each(["cur","_default","width","height","opacity"],function(a,b){var e=d,k,l;b==="cur"?e=c.prototype:b==="_default"&&f&&(e=g[b],b="set");(k=e[b])&&(e[b]=function(c){c=a?c:this;if(c.prop!=="align")return l=c.elem,l.attr?l.attr(c.prop,b==="cur"?v:c.now):k.apply(this,arguments)})});mb(e,"get",function(a,b,c){return b.attr?b.opacity||0:a.call(this,b,c)});e=function(a){var c=a.elem,d;if(!a.started)d=b.init(c,c.d,c.toD),a.start=d[0],a.end=d[1],a.started=!0;c.attr("d",b.step(a.start,a.end,a.pos,c.toD))};f?g.d={set:e}:d.d=e;this.each=Array.prototype.forEach?function(a,b){return Array.prototype.forEach.call(a,b)}:function(a,b){for(var c=0,d=a.length;c<d;c++)if(b.call(a[c],a[c],c,a)===!1)return c};a.fn.highcharts=function(){var a="Chart",b=arguments,c,d;ea(b[0])&&(a=b[0],b=Array.prototype.slice.call(b,1));c=b[0];if(c!==v)c.chart=c.chart||{},c.chart.renderTo=this[0],new Highcharts[a](c,b[1]),d=this;c===v&&(d=Ga[w(this[0],"data-highcharts-chart")]);return d}},getScript:a.getScript,inArray:a.inArray,adapterRun:function(b,c){return a(b)[c]()},grep:a.grep,map:function(a,c){for(var d=[],e=0,f=a.length;e<f;e++)d[e]=c.call(a[e],a[e],e,a);return d},offset:function(b){return a(b).offset()},addEvent:function(b,c,d){a(b).bind(c,d)},removeEvent:function(b,c,d){var e=z.removeEventListener?"removeEventListener":"detachEvent";z[e]&&b&&!b[e]&&(b[e]=function(){});a(b).unbind(c,d)},fireEvent:function(b,c,d,e){var f=a.Event(c),g="detached"+c,h;!sa&&d&&(delete d.layerX,delete d.layerY);s(f,d);b[c]&&(b[g]=b[c],b[c]=null);a.each(["preventDefault","stopPropagation"],function(a,b){var c=f[b];f[b]=function(){try{c.call(f)}catch(a){b==="preventDefault"&&(h=!0)}}});a(b).trigger(f);b[g]&&(b[c]=b[g],b[g]=null);e&&!f.isDefaultPrevented()&&!h&&e(f)},washMouseEvent:function(a){var c=a.originalEvent||a;if(c.pageX===v)c.pageX=a.pageX,c.pageY=a.pageY;return c},animate:function(b,c,d){var e=a(b);if(!b.style)b.style={};if(c.d)b.toD=c.d,c.d=1;e.stop();c.opacity!==v&&b.attr&&(c.opacity+="px");e.animate(c,d)},stop:function(b){a(b).stop()}}})(N.jQuery);var Y=N.HighchartsAdapter,G=Y||{};Y&&Y.init.call(Y,Ab);var kb=G.adapterRun,Vb=G.getScript,pa=G.inArray,n=G.each,ub=G.grep,Wb=G.offset,Na=G.map,K=G.addEvent,$=G.removeEvent,A=G.fireEvent,Xb=G.washMouseEvent,Bb=G.animate,Wa=G.stop,G={enabled:!0,x:0,y:15,style:{color:"#666",cursor:"default",fontSize:"11px",lineHeight:"14px"}};L={colors:"#2f7ed8,#0d233a,#8bbc21,#910000,#1aadce,#492970,#f28f43,#77a1e5,#c42525,#a6c96a".split(","),symbols:["circle","diamond","square","triangle","triangle-down"],lang:{loading:"Loading...",months:"January,February,March,April,May,June,July,August,September,October,November,December".split(","),shortMonths:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),weekdays:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),decimalPoint:".",numericSymbols:"k,M,G,T,P,E".split(","),resetZoom:"Reset zoom",resetZoomTitle:"Reset zoom level 1:1",thousandsSep:","},global:{useUTC:false,canvasToolsURL:"http://code.highcharts.com/3.0.7/modules/canvas-tools.js",VMLRadialGradientURL:"http://code.highcharts.com/3.0.7/gfx/vml-radial-gradient.png"},chart:{borderColor:"#4572A7",borderRadius:5,defaultSeriesType:"line",ignoreHiddenSeries:!0,spacing:[10,10,15,10],style:{fontFamily:'"Lucida Grande", "Lucida Sans Unicode", Verdana, Arial, Helvetica, sans-serif',fontSize:"12px"},backgroundColor:"#FFFFFF",plotBorderColor:"#C0C0C0",resetZoomButton:{theme:{zIndex:20},position:{align:"right",x:-10,y:10}}},title:{text:"Chart title",align:"center",margin:15,style:{color:"#274b6d",fontSize:"16px"}},subtitle:{text:"",align:"center",style:{color:"#4d759e"}},plotOptions:{line:{allowPointSelect:!1,showCheckbox:!1,animation:{duration:1E3},events:{},lineWidth:2,marker:{enabled:!0,lineWidth:0,radius:4,lineColor:"#FFFFFF",states:{hover:{enabled:!0},select:{fillColor:"#FFFFFF",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:x(G,{align:"center",enabled:!1,formatter:function(){return this.y===null?"":Aa(this.y,-1)},verticalAlign:"bottom",y:0}),cropThreshold:300,pointRange:0,states:{hover:{marker:{}},select:{marker:{}}},stickyTracking:!0}},labels:{style:{position:"absolute",color:"#3E576F"}},legend:{enabled:!0,align:"center",layout:"horizontal",labelFormatter:function(){return this.name},borderWidth:1,borderColor:"#909090",borderRadius:5,navigation:{activeColor:"#274b6d",inactiveColor:"#CCC"},shadow:!1,itemStyle:{cursor:"pointer",color:"#274b6d",fontSize:"12px"},itemHoverStyle:{color:"#000"},itemHiddenStyle:{color:"#CCC"},itemCheckboxStyle:{position:"absolute",width:"13px",height:"13px"},symbolWidth:16,symbolPadding:5,verticalAlign:"bottom",x:0,y:0,title:{style:{fontWeight:"bold"}}},loading:{labelStyle:{fontWeight:"bold",position:"relative",top:"1em"},style:{position:"absolute",backgroundColor:"white",opacity:0.5,textAlign:"center"}},tooltip:{enabled:!0,animation:W,backgroundColor:"rgba(255, 255, 255, .85)",borderWidth:1,borderRadius:3,dateTimeLabelFormats:{millisecond:"%A, %b %e, %H:%M:%S.%L",second:"%A, %b %e, %H:%M:%S",minute:"%A, %b %e, %H:%M",hour:"%A, %b %e, %H:%M",day:"%A, %b %e, %Y",week:"Week from %A, %b %e, %Y",month:"%B %Y",year:"%Y"},headerFormat:'<span style="font-size: 10px">{point.key}</span><br/>',pointFormat:'<span style="color:{series.color}">{series.name}</span>: <b>{point.y}</b><br/>',shadow:!0,snap:Ob?25:10,style:{color:"#333333",cursor:"default",fontSize:"12px",padding:"8px",whiteSpace:"nowrap"}},credits:{enabled:!0,text:"Highcharts.com",href:"http://www.highcharts.com",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#909090",fontSize:"9px"}}};var Z=L.plotOptions,Y=Z.line;Lb();var Yb=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]?(?:\.[0-9]+)?)\s*\)/,Zb=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,$b=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/,qa=function(a){var b=[],c,d;(function(a){a&&a.stops?d=Na(a.stops,function(a){return qa(a[1])}):(c=Yb.exec(a))?b=[y(c[1]),y(c[2]),y(c[3]),parseFloat(c[4],10)]:(c=Zb.exec(a))?b=[y(c[1],16),y(c[2],16),y(c[3],16),1]:(c=$b.exec(a))&&(b=[y(c[1]),y(c[2]),y(c[3]),1])})(a);return{get:function(c){var f;d?(f=x(a),f.stops=[].concat(f.stops),n(d,function(a,b){f.stops[b]=[f.stops[b][0],a.get(c)]})):f=b&&!isNaN(b[0])?c==="rgb"?"rgb("+b[0]+","+b[1]+","+b[2]+")":c==="a"?b[3]:"rgba("+b.join(",")+")":a;return f},brighten:function(a){if(d)n(d,function(b){b.brighten(a)});else if(ra(a)&&a!==0){var c;for(c=0;c<3;c++)b[c]+=y(a*255),b[c]<0&&(b[c]=0),b[c]>255&&(b[c]=255)}return this},rgba:b,setOpacity:function(a){b[3]=a;return this}}};va.prototype={init:function(a,b){this.element=b==="span"?U(b):z.createElementNS(ya,b);this.renderer=a;this.attrSetters={}},opacity:1,animate:function(a,b,c){b=o(b,Fa,!0);Wa(this);if(b){b=x(b);if(c)b.complete=c;Bb(this,a,b)}else this.attr(a),c&&c()},attr:function(a,b){var c,d,e,f,g=this.element,h=g.nodeName.toLowerCase(),i=this.renderer,j,k=this.attrSetters,l=this.shadows,m,p,q=this;ea(a)&&u(b)&&(c=a,a={},a[c]=b);if(ea(a))c=a,h==="circle"?c={x:"cx",y:"cy"}[c]||c:c==="strokeWidth"&&(c="stroke-width"),q=w(g,c)||this[c]||0,c!=="d"&&c!=="visibility"&&c!=="fill"&&(q=parseFloat(q));else{for(c in a)if(j=!1,d=a[c],e=k[c]&&k[c].call(this,d,c),e!==!1){e!==v&&(d=e);if(c==="d")d&&d.join&&(d=d.join(" ")),/(NaN| {2}|^$)/.test(d)&&(d="M 0 0");else if(c==="x"&&h==="text")for(e=0;e<g.childNodes.length;e++)f=g.childNodes[e],w(f,"x")===w(g,"x")&&w(f,"x",d);else if(this.rotation&&(c==="x"||c==="y"))p=!0;else if(c==="fill")d=i.color(d,g,c);else if(h==="circle"&&(c==="x"||c==="y"))c={x:"cx",y:"cy"}[c]||c;else if(h==="rect"&&c==="r")w(g,{rx:d,ry:d}),j=!0;else if(c==="translateX"||c==="translateY"||c==="rotation"||c==="verticalAlign"||c==="scaleX"||c==="scaleY")j=p=!0;else if(c==="stroke")d=i.color(d,g,c);else if(c==="dashstyle")if(c="stroke-dasharray",d=d&&d.toLowerCase(),d==="solid")d=S;else{if(d){d=d.replace("shortdashdotdot","3,1,1,1,1,1,").replace("shortdashdot","3,1,1,1").replace("shortdot","1,1,").replace("shortdash","3,1,").replace("longdash","8,3,").replace(/dot/g,"1,3,").replace("dash","4,3,").replace(/,$/,"").split(",");for(e=d.length;e--;)d[e]=y(d[e])*o(a["stroke-width"],this["stroke-width"]);d=d.join(",")}}else if(c==="width")d=y(d);else if(c==="align")c="text-anchor",d={left:"start",center:"middle",right:"end"}[d];else if(c==="title")e=g.getElementsByTagName("title")[0],e||(e=z.createElementNS(ya,"title"),g.appendChild(e)),e.textContent=d;c==="strokeWidth"&&(c="stroke-width");if(c==="stroke-width"||c==="stroke"){this[c]=d;if(this.stroke&&this["stroke-width"])w(g,"stroke",this.stroke),w(g,"stroke-width",this["stroke-width"]),this.hasStroke=!0;else if(c==="stroke-width"&&d===0&&this.hasStroke)g.removeAttribute("stroke"),this.hasStroke=!1;j=!0}this.symbolName&&/^(x|y|width|height|r|start|end|innerR|anchorX|anchorY)/.test(c)&&(m||(this.symbolAttr(a),m=!0),j=!0);if(l&&/^(width|height|visibility|x|y|d|transform|cx|cy|r)$/.test(c))for(e=l.length;e--;)w(l[e],c,c==="height"?r(d-(l[e].cutHeight||0),0):d);if((c==="width"||c==="height")&&h==="rect"&&d<0)d=0;this[c]=d;c==="text"?(d!==this.textStr&&delete this.bBox,this.textStr=d,this.added&&i.buildText(this)):j||w(g,c,d)}p&&this.updateTransform()}return q},addClass:function(a){var b=this.element,c=w(b,"class")||"";c.indexOf(a)===-1&&w(b,"class",c+" "+a);return this},symbolAttr:function(a){var b=this;n("x,y,r,start,end,width,height,innerR,anchorX,anchorY".split(","),function(c){b[c]=o(a[c],b[c])});b.attr({d:b.renderer.symbols[b.symbolName](b.x,b.y,b.width,b.height,b)})},clip:function(a){return this.attr("clip-path",a?"url("+this.renderer.url+"#"+a.id+")":S)},crisp:function(a,b,c,d,e){var f,g={},h={},i,a=a||this.strokeWidth||this.attr&&this.attr("stroke-width")||0;i=t(a)%2/2;h.x=P(b||this.x||0)+i;h.y=P(c||this.y||0)+i;h.width=P((d||this.width||0)-2*i);h.height=P((e||this.height||0)-2*i);h.strokeWidth=a;for(f in h)this[f]!==h[f]&&(this[f]=g[f]=h[f]);return g},css:function(a){var b=this.element,c=this.textWidth=a&&a.width&&b.nodeName.toLowerCase()==="text"&&y(a.width),d,e="",f=function(a,b){return"-"+b.toLowerCase()};if(a&&a.color)a.fill=a.color;this.styles=a=s(this.styles,a);c&&delete a.width;if(sa&&!W)I(this.element,a);else{for(d in a)e+=d.replace(/([A-Z])/g,f)+":"+a[d]+";";w(b,"style",e)}c&&this.added&&this.renderer.buildText(this);return this},on:function(a,b){var c=this,d=c.element;jb&&a==="click"?(d.ontouchstart=function(a){c.touchEventFired=Date.now();a.preventDefault();b.call(d,a)},d.onclick=function(a){(na.indexOf("Android")===-1||Date.now()-(c.touchEventFired||0)>1100)&&b.call(d,a)}):d["on"+a]=b;return this},setRadialReference:function(a){this.element.radialReference=a;return this},translate:function(a,b){return this.attr({translateX:a,translateY:b})},invert:function(){this.inverted=!0;this.updateTransform();return this},htmlCss:function(a){var b=this.element;if(b=a&&b.tagName==="SPAN"&&a.width)delete a.width,this.textWidth=b,this.updateTransform();this.styles=s(this.styles,a);I(this.element,a);return this},htmlGetBBox:function(){var a=this.element,b=this.bBox;if(!b){if(a.nodeName==="text")a.style.position="absolute";b=this.bBox={x:a.offsetLeft,y:a.offsetTop,width:a.offsetWidth,height:a.offsetHeight}}return b},htmlUpdateTransform:function(){if(this.added){var a=this.renderer,b=this.element,c=this.translateX||0,d=this.translateY||0,e=this.x||0,f=this.y||0,g=this.textAlign||"left",h={left:0,center:0.5,right:1}[g],i=g&&g!=="left",j=this.shadows;I(b,{marginLeft:c,marginTop:d});j&&n(j,function(a){I(a,{marginLeft:c+1,marginTop:d+1})});this.inverted&&n(b.childNodes,function(c){a.invertChild(c,b)});if(b.tagName==="SPAN"){var k,l,j=this.rotation,m;k=0;var p=1,q=0,aa;m=y(this.textWidth);var B=this.xCorr||0,O=this.yCorr||0,Sb=[j,g,b.innerHTML,this.textWidth].join(",");if(Sb!==this.cTT){u(j)&&(k=j*Ua,p=V(k),q=ba(k),this.setSpanRotation(j,q,p));k=o(this.elemWidth,b.offsetWidth);l=o(this.elemHeight,b.offsetHeight);if(k>m&&/[ \-]/.test(b.textContent||b.innerText))I(b,{width:m+"px",display:"block",whiteSpace:"normal"}),k=m;m=a.fontMetrics(b.style.fontSize).b;B=p<0&&-k;O=q<0&&-l;aa=p*q<0;B+=q*m*(aa?1-h:h);O-=p*m*(j?aa?h:1-h:1);i&&(B-=k*h*(p<0?-1:1),j&&(O-=l*h*(q<0?-1:1)),I(b,{textAlign:g}));this.xCorr=B;this.yCorr=O}I(b,{left:e+B+"px",top:f+O+"px"});if(hb)l=b.offsetHeight;this.cTT=Sb}}else this.alignOnAdd=!0},setSpanRotation:function(a){var b={};b[sa?"-ms-transform":hb?"-webkit-transform":ib?"MozTransform":Nb?"-o-transform":""]=b.transform="rotate("+a+"deg)";I(this.element,b)},updateTransform:function(){var a=this.translateX||0,b=this.translateY||0,c=this.scaleX,d=this.scaleY,e=this.inverted,f=this.rotation;e&&(a+=this.attr("width"),b+=this.attr("height"));a=["translate("+a+","+b+")"];e?a.push("rotate(90) scale(-1,1)"):f&&a.push("rotate("+f+" "+(this.x||0)+" "+(this.y||0)+")");(u(c)||u(d))&&a.push("scale("+o(c,1)+" "+o(d,1)+")");a.length&&w(this.element,"transform",a.join(" "))},toFront:function(){var a=this.element;a.parentNode.appendChild(a);return this},align:function(a,b,c){var d,e,f,g,h={};e=this.renderer;f=e.alignedObjects;if(a){if(this.alignOptions=a,this.alignByTranslate=b,!c||ea(c))this.alignTo=d=c||"renderer",ga(f,this),f.push(this),c=null}else a=this.alignOptions,b=this.alignByTranslate,d=this.alignTo;c=o(c,e[d],e);d=a.align;e=a.verticalAlign;f=(c.x||0)+(a.x||0);g=(c.y||0)+(a.y||0);if(d==="right"||d==="center")f+=(c.width-(a.width||0))/{right:1,center:2}[d];h[b?"translateX":"x"]=t(f);if(e==="bottom"||e==="middle")g+=(c.height-(a.height||0))/({bottom:1,middle:2}[e]||1);h[b?"translateY":"y"]=t(g);this[this.placed?"animate":"attr"](h);this.placed=!0;this.alignAttr=h;return this},getBBox:function(){var a=this.bBox,b=this.renderer,c,d=this.rotation;c=this.element;var e=this.styles,f=d*Ua;if(!a){if(c.namespaceURI===ya||b.forExport){try{a=c.getBBox?s({},c.getBBox()):{width:c.offsetWidth,height:c.offsetHeight}}catch(g){}if(!a||a.width<0)a={width:0,height:0}}else a=this.htmlGetBBox();if(b.isSVG){b=a.width;c=a.height;if(sa&&e&&e.fontSize==="11px"&&c.toPrecision(3)==="22.7")a.height=c=14;if(d)a.width=M(c*ba(f))+M(b*V(f)),a.height=M(c*V(f))+M(b*ba(f))}this.bBox=a}return a},show:function(){return this.attr({visibility:"visible"})},hide:function(){return this.attr({visibility:"hidden"})},fadeOut:function(a){var b=this;b.animate({opacity:0},{duration:a||150,complete:function(){b.hide()}})},add:function(a){var b=this.renderer,c=a||b,d=c.element||b.box,e=d.childNodes,f=this.element,g=w(f,"zIndex"),h;if(a)this.parentGroup=a;this.parentInverted=a&&a.inverted;this.textStr!==void 0&&b.buildText(this);if(g)c.handleZ=!0,g=y(g);if(c.handleZ)for(c=0;c<e.length;c++)if(a=e[c],b=w(a,"zIndex"),a!==f&&(y(b)>g||!u(g)&&u(b))){d.insertBefore(f,a);h=!0;break}h||d.appendChild(f);this.added=!0;A(this,"add");return this},safeRemoveChild:function(a){var b=a.parentNode;b&&b.removeChild(a)},destroy:function(){var a=this,b=a.element||{},c=a.shadows,d=a.renderer.isSVG&&b.nodeName==="SPAN"&&a.parentGroup,e,f;b.onclick=b.onmouseout=b.onmouseover=b.onmousemove=b.point=null;Wa(a);if(a.clipPath)a.clipPath=a.clipPath.destroy();if(a.stops){for(f=0;f<a.stops.length;f++)a.stops[f]=a.stops[f].destroy();a.stops=null}a.safeRemoveChild(b);for(c&&n(c,function(b){a.safeRemoveChild(b)});d&&d.div.childNodes.length===0;)b=d.parentGroup,a.safeRemoveChild(d.div),delete d.div,d=b;a.alignTo&&ga(a.renderer.alignedObjects,a);for(e in a)delete a[e];return null},shadow:function(a,b,c){var d=[],e,f,g=this.element,h,i,j,k;if(a){i=o(a.width,3);j=(a.opacity||0.15)/i;k=this.parentInverted?"(-1,-1)":"("+o(a.offsetX,1)+", "+o(a.offsetY,1)+")";for(e=1;e<=i;e++){f=g.cloneNode(0);h=i*2+1-2*e;w(f,{isShadow:"true",stroke:a.color||"black","stroke-opacity":j*e,"stroke-width":h,transform:"translate"+k,fill:S});if(c)w(f,"height",r(w(f,"height")-h,0)),f.cutHeight=h;b?b.element.appendChild(f):g.parentNode.insertBefore(f,g);d.push(f)}this.shadows=d}return this}};var za=function(){this.init.apply(this,arguments)};za.prototype={Element:va,init:function(a,b,c,d){var e=location,f,g;f=this.createElement("svg").attr({version:"1.1"});g=f.element;a.appendChild(g);a.innerHTML.indexOf("xmlns")===-1&&w(g,"xmlns",ya);this.isSVG=!0;this.box=g;this.boxWrapper=f;this.alignedObjects=[];this.url=(ib||hb)&&z.getElementsByTagName("base").length?e.href.replace(/#.*?$/,"").replace(/([\('\)])/g,"\\$1").replace(/ /g,"%20"):"";this.createElement("desc").add().element.appendChild(z.createTextNode("Created with Highcharts 3.0.7"));this.defs=this.createElement("defs").add();this.forExport=d;this.gradients={};this.setSize(b,c,!1);var h;if(ib&&a.getBoundingClientRect)this.subPixelFix=b=function(){I(a,{left:0,top:0});h=a.getBoundingClientRect();I(a,{left:wa(h.left)-h.left+"px",top:wa(h.top)-h.top+"px"})},b(),K(N,"resize",b)},isHidden:function(){return!this.boxWrapper.getBBox().width},destroy:function(){var a=this.defs;this.box=null;this.boxWrapper=this.boxWrapper.destroy();Ka(this.gradients||{});this.gradients=null;if(a)this.defs=a.destroy();this.subPixelFix&&$(N,"resize",this.subPixelFix);return this.alignedObjects=null},createElement:function(a){var b=new this.Element;b.init(this,a);return b},draw:function(){},buildText:function(a){for(var b=a.element,c=this,d=c.forExport,e=o(a.textStr,"").toString().replace(/<(b|strong)>/g,'<span style="font-weight:bold">').replace(/<(i|em)>/g,'<span style="font-style:italic">').replace(/<a/g,"<span").replace(/<\/(b|strong|i|em|a)>/g,"</span>").split(/<br.*?>/g),f=b.childNodes,g=/style="([^"]+)"/,h=/href="(http[^"]+)"/,i=w(b,"x"),j=a.styles,k=a.textWidth,l=j&&j.lineHeight,m=f.length;m--;)b.removeChild(f[m]);k&&!a.added&&this.box.appendChild(b);e[e.length-1]===""&&e.pop();n(e,function(e,f){var m,o=0,e=e.replace(/<span/g,"|||<span").replace(/<\/span>/g,"</span>|||");m=e.split("|||");n(m,function(e){if(e!==""||m.length===1){var p={},n=z.createElementNS(ya,"tspan"),r;g.test(e)&&(r=e.match(g)[1].replace(/(;| |^)color([ :])/,"$1fill$2"),w(n,"style",r));h.test(e)&&!d&&(w(n,"onclick",'location.href="'+e.match(h)[1]+'"'),I(n,{cursor:"pointer"}));e=(e.replace(/<(.|\n)*?>/g,"")||" ").replace(/&lt;/g,"<").replace(/&gt;/g,">");if(e!==" "&&(n.appendChild(z.createTextNode(e)),o?p.dx=0:p.x=i,w(n,p),!o&&f&&(!W&&d&&I(n,{display:"block"}),w(n,"dy",l||c.fontMetrics(/px$/.test(n.style.fontSize)?n.style.fontSize:j.fontSize).h,hb&&n.offsetHeight)),b.appendChild(n),o++,k))for(var e=e.replace(/([^\^])-/g,"$1- ").split(" "),u,t,p=a._clipHeight,E=[],v=y(l||16),s=1;e.length||E.length;)delete a.bBox,u=a.getBBox(),t=u.width,!W&&c.forExport&&(t=c.measureSpanWidth(n.firstChild.data,a.styles)),u=t>k,!u||e.length===1?(e=E,E=[],e.length&&(s++,p&&s*v>p?(e=["..."],a.attr("title",a.textStr)):(n=z.createElementNS(ya,"tspan"),w(n,{dy:v,x:i}),r&&w(n,"style",r),b.appendChild(n),t>k&&(k=t)))):(n.removeChild(n.firstChild),E.unshift(e.pop())),e.length&&n.appendChild(z.createTextNode(e.join(" ").replace(/- /g,"-")))}})})},button:function(a,b,c,d,e,f,g,h,i){var j=this.label(a,b,c,i,null,null,null,null,"button"),k=0,l,m,p,q,n,o,a={x1:0,y1:0,x2:0,y2:1},e=x({"stroke-width":1,stroke:"#CCCCCC",fill:{linearGradient:a,stops:[[0,"#FEFEFE"],[1,"#F6F6F6"]]},r:2,padding:5,style:{color:"black"}},e);p=e.style;delete e.style;f=x(e,{stroke:"#68A",fill:{linearGradient:a,stops:[[0,"#FFF"],[1,"#ACF"]]}},f);q=f.style;delete f.style;g=x(e,{stroke:"#68A",fill:{linearGradient:a,stops:[[0,"#9BD"],[1,"#CDF"]]}},g);n=g.style;delete g.style;h=x(e,{style:{color:"#CCC"}},h);o=h.style;delete h.style;K(j.element,sa?"mouseover":"mouseenter",function(){k!==3&&j.attr(f).css(q)});K(j.element,sa?"mouseout":"mouseleave",function(){k!==3&&(l=[e,f,g][k],m=[p,q,n][k],j.attr(l).css(m))});j.setState=function(a){(j.state=k=a)?a===2?j.attr(g).css(n):a===3&&j.attr(h).css(o):j.attr(e).css(p)};return j.on("click",function(){k!==3&&d.call(j)}).attr(e).css(s({cursor:"default"},p))},crispLine:function(a,b){a[1]===a[4]&&(a[1]=a[4]=t(a[1])-b%2/2);a[2]===a[5]&&(a[2]=a[5]=t(a[2])+b%2/2);return a},path:function(a){var b={fill:S};Ia(a)?b.d=a:T(a)&&s(b,a);return this.createElement("path").attr(b)},circle:function(a,b,c){a=T(a)?a:{x:a,y:b,r:c};return this.createElement("circle").attr(a)},arc:function(a,b,c,d,e,f){if(T(a))b=a.y,c=a.r,d=a.innerR,e=a.start,f=a.end,a=a.x;a=this.symbol("arc",a||0,b||0,c||0,c||0,{innerR:d||0,start:e||0,end:f||0});a.r=c;return a},rect:function(a,b,c,d,e,f){e=T(a)?a.r:e;e=this.createElement("rect").attr({rx:e,ry:e,fill:S});return e.attr(T(a)?a:e.crisp(f,a,b,r(c,0),r(d,0)))},setSize:function(a,b,c){var d=this.alignedObjects,e=d.length;this.width=a;this.height=b;for(this.boxWrapper[o(c,!0)?"animate":"attr"]({width:a,height:b});e--;)d[e].align()},g:function(a){var b=this.createElement("g");return u(a)?b.attr({"class":"highcharts-"+a}):b},image:function(a,b,c,d,e){var f={preserveAspectRatio:S};arguments.length>1&&s(f,{x:b,y:c,width:d,height:e});f=this.createElement("image").attr(f);f.element.setAttributeNS?f.element.setAttributeNS("http://www.w3.org/1999/xlink","href",a):f.element.setAttribute("hc-svg-href",a);return f},symbol:function(a,b,c,d,e,f){var g,h=this.symbols[a],h=h&&h(t(b),t(c),d,e,f),i=/^url\((.*?)\)$/,j,k;if(h)g=this.path(h),s(g,{symbolName:a,x:b,y:c,width:d,height:e}),f&&s(g,f);else if(i.test(a))k=function(a,b){a.element&&(a.attr({width:b[0],height:b[1]}),a.alignByTranslate||a.translate(t((d-b[0])/2),t((e-b[1])/2)))},j=a.match(i)[1],a=Pb[j],g=this.image(j).attr({x:b,y:c}),g.isImg=!0,a?k(g,a):(g.attr({width:0,height:0}),U("img",{onload:function(){k(g,Pb[j]=[this.width,this.height])},src:j}));return g},symbols:{circle:function(a,b,c,d){var e=0.166*c;return["M",a+c/2,b,"C",a+c+e,b,a+c+e,b+d,a+c/2,b+d,"C",a-e,b+d,a-e,b,a+c/2,b,"Z"]},square:function(a,b,c,d){return["M",a,b,"L",a+c,b,a+c,b+d,a,b+d,"Z"]},triangle:function(a,b,c,d){return["M",a+c/2,b,"L",a+c,b+d,a,b+d,"Z"]},"triangle-down":function(a,b,c,d){return["M",a,b,"L",a+c,b,a+c/2,b+d,"Z"]},diamond:function(a,b,c,d){return["M",a+c/2,b,"L",a+c,b+d/2,a+c/2,b+d,a,b+d/2,"Z"]},arc:function(a,b,c,d,e){var f=e.start,c=e.r||c||d,g=e.end-0.001,d=e.innerR,h=e.open,i=V(f),j=ba(f),k=V(g),g=ba(g),e=e.end-f<xa?0:1;return["M",a+c*i,b+c*j,"A",c,c,0,e,1,a+c*k,b+c*g,h?"M":"L",a+d*k,b+d*g,"A",d,d,0,e,0,a+d*i,b+d*j,h?"":"Z"]}},clipRect:function(a,b,c,d){var e="highcharts-"+zb++,f=this.createElement("clipPath").attr({id:e}).add(this.defs),a=this.rect(a,b,c,d,0).add(f);a.id=e;a.clipPath=f;return a},color:function(a,b,c){var d=this,e,f=/^rgba/,g,h,i,j,k,l,m,p=[];a&&a.linearGradient?g="linearGradient":a&&a.radialGradient&&(g="radialGradient");if(g){c=a[g];h=d.gradients;j=a.stops;b=b.radialReference;Ia(c)&&(a[g]=c={x1:c[0],y1:c[1],x2:c[2],y2:c[3],gradientUnits:"userSpaceOnUse"});g==="radialGradient"&&b&&!u(c.gradientUnits)&&(c=x(c,{cx:b[0]-b[2]/2+c.cx*b[2],cy:b[1]-b[2]/2+c.cy*b[2],r:c.r*b[2],gradientUnits:"userSpaceOnUse"}));for(m in c)m!=="id"&&p.push(m,c[m]);for(m in j)p.push(j[m]);p=p.join(",");h[p]?a=h[p].id:(c.id=a="highcharts-"+zb++,h[p]=i=d.createElement(g).attr(c).add(d.defs),i.stops=[],n(j,function(a){f.test(a[1])?(e=qa(a[1]),k=e.get("rgb"),l=e.get("a")):(k=a[1],l=1);a=d.createElement("stop").attr({offset:a[0],"stop-color":k,"stop-opacity":l}).add(i);i.stops.push(a)}));return"url("+d.url+"#"+a+")"}else return f.test(a)?(e=qa(a),w(b,c+"-opacity",e.get("a")),e.get("rgb")):(b.removeAttribute(c+"-opacity"),a)},text:function(a,b,c,d){var e=L.chart.style,f=ca||!W&&this.forExport;if(d&&!this.forExport)return this.html(a,b,c);b=t(o(b,0));c=t(o(c,0));a=this.createElement("text").attr({x:b,y:c,text:a}).css({fontFamily:e.fontFamily,fontSize:e.fontSize});f&&a.css({position:"absolute"});a.x=b;a.y=c;return a},html:function(a,b,c){var d=L.chart.style,e=this.createElement("span"),f=e.attrSetters,g=e.element,h=e.renderer;f.text=function(a){a!==g.innerHTML&&delete this.bBox;g.innerHTML=a;return!1};f.x=f.y=f.align=function(a,b){b==="align"&&(b="textAlign");e[b]=a;e.htmlUpdateTransform();return!1};e.attr({text:a,x:t(b),y:t(c)}).css({position:"absolute",whiteSpace:"nowrap",fontFamily:d.fontFamily,fontSize:d.fontSize});e.css=e.htmlCss;if(h.isSVG)e.add=function(a){var b,c=h.box.parentNode,d=[];if(this.parentGroup=a){if(b=a.div,!b){for(;a;)d.push(a),a=a.parentGroup;n(d.reverse(),function(a){var d;b=a.div=a.div||U(Ea,{className:w(a.element,"class")},{position:"absolute",left:(a.translateX||0)+"px",top:(a.translateY||0)+"px"},b||c);d=b.style;s(a.attrSetters,{translateX:function(a){d.left=a+"px"},translateY:function(a){d.top=a+"px"},visibility:function(a,b){d[b]=a}})})}}else b=c;b.appendChild(g);e.added=!0;e.alignOnAdd&&e.htmlUpdateTransform();return e};return e},fontMetrics:function(a){var a=y(a||11),a=a<24?a+4:t(a*1.2),b=t(a*0.8);return{h:a,b:b}},label:function(a,b,c,d,e,f,g,h,i){function j(){var a,b;a=o.element.style;O=(Oa===void 0||Ha===void 0||q.styles.textAlign)&&o.getBBox();q.width=(Oa||O.width||0)+2*da+lb;q.height=(Ha||O.height||0)+2*da;w=da+p.fontMetrics(a&&a.fontSize).b;if(y){if(!B)a=t(-r*da),b=h?-w:0,q.box=B=d?p.symbol(d,a,b,q.width,q.height,Xa):p.rect(a,b,q.width,q.height,0,Xa[Rb]),B.add(q);B.isImg||B.attr(x({width:q.width,height:q.height},Xa));Xa=null}}function k(){var a=q.styles,a=a&&a.textAlign,b=lb+da*(1-r),c;c=h?0:w;if(u(Oa)&&(a==="center"||a==="right"))b+={center:0.5,right:1}[a]*(Oa-O.width);(b!==o.x||c!==o.y)&&o.attr({x:b,y:c});o.x=b;o.y=c}function l(a,b){B?B.attr(a,b):Xa[a]=b}function m(){o.add(q);q.attr({text:a,x:b,y:c});B&&u(e)&&q.attr({anchorX:e,anchorY:f})}var p=this,q=p.g(i),o=p.text("",0,0,g).attr({zIndex:1}),B,O,r=0,da=3,lb=0,Oa,Ha,E,H,C=0,Xa={},w,g=q.attrSetters,y;K(q,"add",m);g.width=function(a){Oa=a;return!1};g.height=function(a){Ha=a;return!1};g.padding=function(a){u(a)&&a!==da&&(da=a,k());return!1};g.paddingLeft=function(a){u(a)&&a!==lb&&(lb=a,k());return!1};g.align=function(a){r={left:0,center:0.5,right:1}[a];return!1};g.text=function(a,b){o.attr(b,a);j();k();return!1};g[Rb]=function(a,b){y=!0;C=a%2/2;l(b,a);return!1};g.stroke=g.fill=g.r=function(a,b){b==="fill"&&(y=!0);l(b,a);return!1};g.anchorX=function(a,b){e=a;l(b,a+C-E);return!1};g.anchorY=function(a,b){f=a;l(b,a-H);return!1};g.x=function(a){q.x=a;a-=r*((Oa||O.width)+da);E=t(a);q.attr("translateX",E);return!1};g.y=function(a){H=q.y=t(a);q.attr("translateY",H);return!1};var z=q.css;return s(q,{css:function(a){if(a){var b={},a=x(a);n("fontSize,fontWeight,fontFamily,color,lineHeight,width,textDecoration,textShadow".split(","),function(c){a[c]!==v&&(b[c]=a[c],delete a[c])});o.css(b)}return z.call(q,a)},getBBox:function(){return{width:O.width+2*da,height:O.height+2*da,x:O.x-da,y:O.y-da}},shadow:function(a){B&&B.shadow(a);return q},destroy:function(){$(q,"add",m);$(q.element,"mouseenter");$(q.element,"mouseleave");o&&(o=o.destroy());B&&(B=B.destroy());va.prototype.destroy.call(q);q=p=j=k=l=m=null}})}};Va=za;var F;if(!W&&!ca){Highcharts.VMLElement=F={init:function(a,b){var c=["<",b,' filled="f" stroked="f"'],d=["position: ","absolute",";"],e=b===Ea;(b==="shape"||e)&&d.push("left:0;top:0;width:1px;height:1px;");d.push("visibility: ",e?"hidden":"visible");c.push(' style="',d.join(""),'"/>');if(b)c=e||b==="span"||b==="img"?c.join(""):a.prepVML(c),this.element=U(c);this.renderer=a;this.attrSetters={}},add:function(a){var b=this.renderer,c=this.element,d=b.box,d=a?a.element||a:d;a&&a.inverted&&b.invertChild(c,d);d.appendChild(c);this.added=!0;this.alignOnAdd&&!this.deferUpdateTransform&&this.updateTransform();A(this,"add");return this},updateTransform:va.prototype.htmlUpdateTransform,setSpanRotation:function(a,b,c){I(this.element,{filter:a?["progid:DXImageTransform.Microsoft.Matrix(M11=",c,", M12=",-b,", M21=",b,", M22=",c,", sizingMethod='auto expand')"].join(""):S})},pathToVML:function(a){for(var b=a.length,c=[],d;b--;)if(ra(a[b]))c[b]=t(a[b]*10)-5;else if(a[b]==="Z")c[b]="x";else if(c[b]=a[b],a.isArc&&(a[b]==="wa"||a[b]==="at"))d=a[b]==="wa"?1:-1,c[b+5]===c[b+7]&&(c[b+7]-=d),c[b+6]===c[b+8]&&(c[b+8]-=d);return c.join(" ")||"x"},attr:function(a,b){var c,d,e,f=this.element||{},g=f.style,h=f.nodeName,i=this.renderer,j=this.symbolName,k,l=this.shadows,m,p=this.attrSetters,q=this;ea(a)&&u(b)&&(c=a,a={},a[c]=b);if(ea(a))c=a,q=c==="strokeWidth"||c==="stroke-width"?this.strokeweight:this[c];else for(c in a)if(d=a[c],m=!1,e=p[c]&&p[c].call(this,d,c),e!==!1&&d!==null){e!==v&&(d=e);if(j&&/^(x|y|r|start|end|width|height|innerR|anchorX|anchorY)/.test(c))k||(this.symbolAttr(a),k=!0),m=!0;else if(c==="d"){d=d||[];this.d=d.join(" ");f.path=d=this.pathToVML(d);if(l)for(e=l.length;e--;)l[e].path=l[e].cutOff?this.cutOffPath(d,l[e].cutOff):d;m=!0}else if(c==="visibility"){if(l)for(e=l.length;e--;)l[e].style[c]=d;h==="DIV"&&(d=d==="hidden"?"-999em":0,gb||(g[c]=d?"visible":"hidden"),c="top");g[c]=d;m=!0}else if(c==="zIndex")d&&(g[c]=d),m=!0;else if(pa(c,["x","y","width","height"])!==-1)this[c]=d,c==="x"||c==="y"?c={x:"left",y:"top"}[c]:d=r(0,d),this.updateClipping?(this[c]=d,this.updateClipping()):g[c]=d,m=!0;else if(c==="class"&&h==="DIV")f.className=d;else if(c==="stroke")d=i.color(d,f,c),c="strokecolor";else if(c==="stroke-width"||c==="strokeWidth")f.stroked=d?!0:!1,c="strokeweight",this[c]=d,ra(d)&&(d+="px");else if(c==="dashstyle")(f.getElementsByTagName("stroke")[0]||U(i.prepVML(["<stroke/>"]),null,null,f))[c]=d||"solid",this.dashstyle=d,m=!0;else if(c==="fill")if(h==="SPAN")g.color=d;else{if(h!=="IMG")f.filled=d!==S?!0:!1,d=i.color(d,f,c,this),c="fillcolor"}else if(c==="opacity")m=!0;else if(h==="shape"&&c==="rotation")this[c]=f.style[c]=d,f.style.left=-t(ba(d*Ua)+1)+"px",f.style.top=t(V(d*Ua))+"px";else if(c==="translateX"||c==="translateY"||c==="rotation")this[c]=d,this.updateTransform(),m=!0;else if(c==="text")this.bBox=null,f.innerHTML=d,m=!0;m||(gb?f[c]=d:w(f,c,d))}return q},clip:function(a){var b=this,c;a?(c=a.members,ga(c,b),c.push(b),b.destroyClip=function(){ga(c,b)},a=a.getCSS(b)):(b.destroyClip&&b.destroyClip(),a={clip:gb?"inherit":"rect(auto)"});return b.css(a)},css:va.prototype.htmlCss,safeRemoveChild:function(a){a.parentNode&&Ta(a)},destroy:function(){this.destroyClip&&this.destroyClip();return va.prototype.destroy.apply(this)},on:function(a,b){this.element["on"+a]=function(){var a=N.event;a.target=a.srcElement;b(a)};return this},cutOffPath:function(a,b){var c,a=a.split(/[ ,]/);c=a.length;if(c===9||c===11)a[c-4]=a[c-2]=y(a[c-2])-10*b;return a.join(" ")},shadow:function(a,b,c){var d=[],e,f=this.element,g=this.renderer,h,i=f.style,j,k=f.path,l,m,p,q;k&&typeof k.value!=="string"&&(k="x");m=k;if(a){p=o(a.width,3);q=(a.opacity||0.15)/p;for(e=1;e<=3;e++){l=p*2+1-2*e;c&&(m=this.cutOffPath(k.value,l+0.5));j=['<shape isShadow="true" strokeweight="',l,'" filled="false" path="',m,'" coordsize="10 10" style="',f.style.cssText,'" />'];h=U(g.prepVML(j),null,{left:y(i.left)+o(a.offsetX,1),top:y(i.top)+o(a.offsetY,1)});if(c)h.cutOff=l+1;j=['<stroke color="',a.color||"black",'" opacity="',q*e,'"/>'];U(g.prepVML(j),null,null,h);b?b.element.appendChild(h):f.parentNode.insertBefore(h,f);d.push(h)}this.shadows=d}return this}};F=ha(va,F);var la={Element:F,isIE8:na.indexOf("MSIE 8.0")>-1,init:function(a,b,c){var d,e;this.alignedObjects=[];d=this.createElement(Ea);e=d.element;e.style.position="relative";a.appendChild(d.element);this.isVML=!0;this.box=e;this.boxWrapper=d;this.setSize(b,c,!1);if(!z.namespaces.hcv){z.namespaces.add("hcv","urn:schemas-microsoft-com:vml");try{z.createStyleSheet().cssText="hcv\\:fill, hcv\\:path, hcv\\:shape, hcv\\:stroke{ behavior:url(#default#VML); display: inline-block; } "}catch(f){z.styleSheets[0].cssText+="hcv\\:fill, hcv\\:path, hcv\\:shape, hcv\\:stroke{ behavior:url(#default#VML); display: inline-block; } "}}},isHidden:function(){return!this.box.offsetWidth},clipRect:function(a,b,c,d){var e=this.createElement(),f=T(a);return s(e,{members:[],left:(f?a.x:a)+1,top:(f?a.y:b)+1,width:(f?a.width:c)-1,height:(f?a.height:d)-1,getCSS:function(a){var b=a.element,c=b.nodeName,a=a.inverted,d=this.top-(c==="shape"?b.offsetTop:0),e=this.left,b=e+this.width,f=d+this.height,d={clip:"rect("+t(a?e:d)+"px,"+t(a?f:b)+"px,"+t(a?b:f)+"px,"+t(a?d:e)+"px)"};!a&&gb&&c==="DIV"&&s(d,{width:b+"px",height:f+"px"});return d},updateClipping:function(){n(e.members,function(a){a.css(e.getCSS(a))})}})},color:function(a,b,c,d){var e=this,f,g=/^rgba/,h,i,j=S;a&&a.linearGradient?i="gradient":a&&a.radialGradient&&(i="pattern");if(i){var k,l,m=a.linearGradient||a.radialGradient,p,q,o,B,O,r="",a=a.stops,u,t=[],v=function(){h=['<fill colors="'+t.join(",")+'" opacity="',o,'" o:opacity2="',q,'" type="',i,'" ',r,'focus="100%" method="any" />'];U(e.prepVML(h),null,null,b)};p=a[0];u=a[a.length-1];p[0]>0&&a.unshift([0,p[1]]);u[0]<1&&a.push([1,u[1]]);n(a,function(a,b){g.test(a[1])?(f=qa(a[1]),k=f.get("rgb"),l=f.get("a")):(k=a[1],l=1);t.push(a[0]*100+"% "+k);b?(o=l,B=k):(q=l,O=k)});if(c==="fill")if(i==="gradient")c=m.x1||m[0]||0,a=m.y1||m[1]||0,p=m.x2||m[2]||0,m=m.y2||m[3]||0,r='angle="'+(90-R.atan((m-a)/(p-c))*180/xa)+'"',v();else{var j=m.r,s=j*2,E=j*2,H=m.cx,C=m.cy,x=b.radialReference,w,j=function(){x&&(w=d.getBBox(),H+=(x[0]-w.x)/w.width-0.5,C+=(x[1]-w.y)/w.height-0.5,s*=x[2]/w.width,E*=x[2]/w.height);r='src="'+L.global.VMLRadialGradientURL+'" size="'+s+","+E+'" origin="0.5,0.5" position="'+H+","+C+'" color2="'+O+'" ';v()};d.added?j():K(d,"add",j);j=B}else j=k}else if(g.test(a)&&b.tagName!=="IMG")f=qa(a),h=["<",c,' opacity="',f.get("a"),'"/>'],U(this.prepVML(h),null,null,b),j=f.get("rgb");else{j=b.getElementsByTagName(c);if(j.length)j[0].opacity=1,j[0].type="solid";j=a}return j},prepVML:function(a){var b=this.isIE8,a=a.join("");b?(a=a.replace("/>",' xmlns="urn:schemas-microsoft-com:vml" />'),a=a.indexOf('style="')===-1?a.replace("/>",' style="display:inline-block;behavior:url(#default#VML);" />'):a.replace('style="','style="display:inline-block;behavior:url(#default#VML);')):a=a.replace("<","<hcv:");return a},text:za.prototype.html,path:function(a){var b={coordsize:"10 10"};Ia(a)?b.d=a:T(a)&&s(b,a);return this.createElement("shape").attr(b)},circle:function(a,b,c){var d=this.symbol("circle");if(T(a))c=a.r,b=a.y,a=a.x;d.isCircle=!0;d.r=c;return d.attr({x:a,y:b})},g:function(a){var b;a&&(b={className:"highcharts-"+a,"class":"highcharts-"+a});return this.createElement(Ea).attr(b)},image:function(a,b,c,d,e){var f=this.createElement("img").attr({src:a});arguments.length>1&&f.attr({x:b,y:c,width:d,height:e});return f},rect:function(a,b,c,d,e,f){var g=this.symbol("rect");g.r=T(a)?a.r:e;return g.attr(T(a)?a:g.crisp(f,a,b,r(c,0),r(d,0)))},invertChild:function(a,b){var c=b.style;I(a,{flip:"x",left:y(c.width)-1,top:y(c.height)-1,rotation:-90})},symbols:{arc:function(a,b,c,d,e){var f=e.start,g=e.end,h=e.r||c||d,c=e.innerR,d=V(f),i=ba(f),j=V(g),k=ba(g);if(g-f===0)return["x"];f=["wa",a-h,b-h,a+h,b+h,a+h*d,b+h*i,a+h*j,b+h*k];e.open&&!c&&f.push("e","M",a,b);f.push("at",a-c,b-c,a+c,b+c,a+c*j,b+c*k,a+c*d,b+c*i,"x","e");f.isArc=!0;return f},circle:function(a,b,c,d,e){e&&(c=d=2*e.r);e&&e.isCircle&&(a-=c/2,b-=d/2);return["wa",a,b,a+c,b+d,a+c,b+d/2,a+c,b+d/2,"e"]},rect:function(a,b,c,d,e){var f=a+c,g=b+d,h;!u(e)||!e.r?f=za.prototype.symbols.square.apply(0,arguments):(h=J(e.r,c,d),f=["M",a+h,b,"L",f-h,b,"wa",f-2*h,b,f,b+2*h,f-h,b,f,b+h,"L",f,g-h,"wa",f-2*h,g-2*h,f,g,f,g-h,f-h,g,"L",a+h,g,"wa",a,g-2*h,a+2*h,g,a+h,g,a,g-h,"L",a,b+h,"wa",a,b,a+2*h,b+2*h,a,b+h,a+h,b,"x","e"]);return f}}};Highcharts.VMLRenderer=F=function(){this.init.apply(this,arguments)};F.prototype=x(za.prototype,la);Va=F}za.prototype.measureSpanWidth=function(a,b){var c=z.createElement("span"),d=z.createTextNode(a);c.appendChild(d);I(c,b);this.box.appendChild(c);return c.offsetWidth};var Tb;if(ca)Highcharts.CanVGRenderer=F=function(){ya="http://www.w3.org/1999/xhtml"},F.prototype.symbols={},Tb=function(){function a(){var a=b.length,d;for(d=0;d<a;d++)b[d]();b=[]}var b=[];return{push:function(c,d){b.length===0&&Vb(d,a);b.push(c)}}}(),Va=F;Ma.prototype={addLabel:function(){var a=this.axis,b=a.options,c=a.chart,d=a.horiz,e=a.categories,f=a.names,g=this.pos,h=b.labels,i=a.tickPositions,d=d&&e&&!h.step&&!h.staggerLines&&!h.rotation&&c.plotWidth/i.length||!d&&(c.margin[3]||c.chartWidth*0.33),j=g===i[0],k=g===i[i.length-1],l,f=e?o(e[g],f[g],g):g,e=this.label,m=i.info;a.isDatetimeAxis&&m&&(l=b.dateTimeLabelFormats[m.higherRanks[g]||m.unitName]);this.isFirst=j;this.isLast=k;b=a.labelFormatter.call({axis:a,chart:c,isFirst:j,isLast:k,dateTimeLabelFormat:l,value:a.isLog?ia(fa(f)):f});g=d&&{width:r(1,t(d-2*(h.padding||10)))+"px"};g=s(g,h.style);if(u(e))e&&e.attr({text:b}).css(g);else{l={align:a.labelAlign};if(ra(h.rotation))l.rotation=h.rotation;if(d&&h.ellipsis)l._clipHeight=a.len/i.length;this.label=u(b)&&h.enabled?c.renderer.text(b,0,0,h.useHTML).attr(l).css(g).add(a.labelGroup):null}},getLabelSize:function(){var a=this.label,b=this.axis;return a?(this.labelBBox=a.getBBox())[b.horiz?"height":"width"]:0},getLabelSides:function(){var a=this.axis,b=this.labelBBox.width,a=b*{left:0,center:0.5,right:1}[a.labelAlign]-a.options.labels.x;return[-a,b-a]},handleOverflow:function(a,b){var c=!0,d=this.axis,e=d.chart,f=this.isFirst,g=this.isLast,h=b.x,i=d.reversed,j=d.tickPositions;if(f||g){var k=this.getLabelSides(),l=k[0],k=k[1],e=e.plotLeft,m=e+d.len,j=(d=d.ticks[j[a+(f?1:-1)]])&&d.label.xy&&d.label.xy.x+d.getLabelSides()[f?0:1];f&&!i||g&&i?h+l<e&&(h=e-l,d&&h+k>j&&(c=!1)):h+k>m&&(h=m-k,d&&h+l<j&&(c=!1));b.x=h}return c},getPosition:function(a,b,c,d){var e=this.axis,f=e.chart,g=d&&f.oldChartHeight||f.chartHeight;return{x:a?e.translate(b+c,null,null,d)+e.transB:e.left+e.offset+(e.opposite?(d&&f.oldChartWidth||f.chartWidth)-e.right-e.left:0),y:a?g-e.bottom+e.offset-(e.opposite?e.height:0):g-e.translate(b+c,null,null,d)-e.transB}},getLabelPosition:function(a,b,c,d,e,f,g,h){var i=this.axis,j=i.transA,k=i.reversed,l=i.staggerLines,m=i.chart.renderer.fontMetrics(e.style.fontSize).b,p=e.rotation,a=a+e.x-(f&&d?f*j*(k?-1:1):0),b=b+e.y-(f&&!d?f*j*(k?1:-1):0);p&&i.side===2&&(b-=m-m*V(p*Ua));!u(e.y)&&!p&&(b+=m-c.getBBox().height/2);l&&(b+=g/(h||1)%l*(i.labelOffset/l));return{x:a,y:b}},getMarkPath:function(a,b,c,d,e,f){return f.crispLine(["M",a,b,"L",a+(e?0:-c),b+(e?c:0)],d)},render:function(a,b,c){var d=this.axis,e=d.options,f=d.chart.renderer,g=d.horiz,h=this.type,i=this.label,j=this.pos,k=e.labels,l=this.gridLine,m=h?h+"Grid":"grid",p=h?h+"Tick":"tick",q=e[m+"LineWidth"],n=e[m+"LineColor"],B=e[m+"LineDashStyle"],r=e[p+"Length"],m=e[p+"Width"]||0,u=e[p+"Color"],t=e[p+"Position"],p=this.mark,s=k.step,w=!0,x=d.tickmarkOffset,E=this.getPosition(g,j,x,b),H=E.x,E=E.y,C=g&&H===d.pos+d.len||!g&&E===d.pos?-1:1,y=d.staggerLines;this.isActive=!0;if(q){j=d.getPlotLinePath(j+x,q*C,b,!0);if(l===v){l={stroke:n,"stroke-width":q};if(B)l.dashstyle=B;if(!h)l.zIndex=1;if(b)l.opacity=0;this.gridLine=l=q?f.path(j).attr(l).add(d.gridGroup):null}if(!b&&l&&j)l[this.isNew?"attr":"animate"]({d:j,opacity:c})}if(m&&r)t==="inside"&&(r=-r),d.opposite&&(r=-r),b=this.getMarkPath(H,E,r,m*C,g,f),p?p.animate({d:b,opacity:c}):this.mark=f.path(b).attr({stroke:u,"stroke-width":m,opacity:c}).add(d.axisGroup);if(i&&!isNaN(H))i.xy=E=this.getLabelPosition(H,E,i,g,k,x,a,s),this.isFirst&&!this.isLast&&!o(e.showFirstLabel,1)||this.isLast&&!this.isFirst&&!o(e.showLastLabel,1)?w=!1:!y&&g&&k.overflow==="justify"&&!this.handleOverflow(a,E)&&(w=!1),s&&a%s&&(w=!1),w&&!isNaN(E.y)?(E.opacity=c,i[this.isNew?"attr":"animate"](E),this.isNew=!1):i.attr("y",-9999)},destroy:function(){Ka(this,this.axis)}};vb.prototype={render:function(){var a=this,b=a.axis,c=b.horiz,d=(b.pointRange||0)/2,e=a.options,f=e.label,g=a.label,h=e.width,i=e.to,j=e.from,k=u(j)&&u(i),l=e.value,m=e.dashStyle,p=a.svgElem,q=[],n,B=e.color,O=e.zIndex,t=e.events,v=b.chart.renderer;b.isLog&&(j=ma(j),i=ma(i),l=ma(l));if(h){if(q=b.getPlotLinePath(l,h),d={stroke:B,"stroke-width":h},m)d.dashstyle=m}else if(k){if(j=r(j,b.min-d),i=J(i,b.max+d),q=b.getPlotBandPath(j,i,e),d={fill:B},e.borderWidth)d.stroke=e.borderColor,d["stroke-width"]=e.borderWidth}else return;if(u(O))d.zIndex=O;if(p)if(q)p.animate({d:q},null,p.onGetPath);else{if(p.hide(),p.onGetPath=function(){p.show()},g)a.label=g=g.destroy()}else if(q&&q.length&&(a.svgElem=p=v.path(q).attr(d).add(),t))for(n in e=function(b){p.on(b,function(c){t[b].apply(a,[c])})},t)e(n);if(f&&u(f.text)&&q&&q.length&&b.width>0&&b.height>0){f=x({align:c&&k&&"center",x:c?!k&&4:10,verticalAlign:!c&&k&&"middle",y:c?k?16:10:k?6:-4,rotation:c&&!k&&90},f);if(!g)a.label=g=v.text(f.text,0,0,f.useHTML).attr({align:f.textAlign||f.align,rotation:f.rotation,zIndex:O}).css(f.style).add();b=[q[1],q[4],o(q[6],q[1])];q=[q[2],q[5],o(q[7],q[2])];c=Ja(b);k=Ja(q);g.align(f,!1,{x:c,y:k,width:ua(b)-c,height:ua(q)-k});g.show()}else g&&g.hide();return a},destroy:function(){ga(this.axis.plotLinesAndBands,this);delete this.axis;Ka(this)}};Mb.prototype={destroy:function(){Ka(this,this.axis)},render:function(a){var b=this.options,c=b.format,c=c?Ca(c,this):b.formatter.call(this);this.label?this.label.attr({text:c,visibility:"hidden"}):this.label=this.axis.chart.renderer.text(c,0,0,b.useHTML).css(b.style).attr({align:this.textAlign,rotation:b.rotation,visibility:"hidden"}).add(a)},setOffset:function(a,b){var c=this.axis,d=c.chart,e=d.inverted,f=this.isNegative,g=c.translate(this.percent?100:this.total,0,0,0,1),c=c.translate(0),c=M(g-c),h=d.xAxis[0].translate(this.x)+a,i=d.plotHeight,f={x:e?f?g:g-c:h,y:e?i-h-b:f?i-g-c:i-g,width:e?c:b,height:e?b:c};if(e=this.label)e.align(this.alignOptions,null,f),f=e.alignAttr,e.attr({visibility:this.options.crop===!1||d.isInsidePlot(f.x,f.y)?W?"inherit":"visible":"hidden"})}};eb.prototype={defaultOptions:{dateTimeLabelFormats:{millisecond:"%H:%M:%S.%L",second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%e. %b",week:"%e. %b",month:"%b '%y",year:"%Y"},endOnTick:!1,gridLineColor:"#C0C0C0",labels:G,lineColor:"#C0D0E0",lineWidth:1,minPadding:0.01,maxPadding:0.01,minorGridLineColor:"#E0E0E0",minorGridLineWidth:1,minorTickColor:"#A0A0A0",minorTickLength:2,minorTickPosition:"outside",startOfWeek:1,startOnTick:!1,tickColor:"#C0D0E0",tickLength:5,tickmarkPlacement:"between",tickPixelInterval:100,tickPosition:"outside",tickWidth:1,title:{align:"middle",style:{color:"#4d759e",fontWeight:"bold"}},type:"linear"},defaultYAxisOptions:{endOnTick:!0,gridLineWidth:1,tickPixelInterval:72,showLastLabel:!0,labels:{x:-8,y:3},lineWidth:0,maxPadding:0.05,minPadding:0.05,startOnTick:!0,tickWidth:0,title:{rotation:270,text:"Values"},stackLabels:{enabled:!1,formatter:function(){return Aa(this.total,-1)},style:G.style}},defaultLeftAxisOptions:{labels:{x:-8,y:null},title:{rotation:270}},defaultRightAxisOptions:{labels:{x:8,y:null},title:{rotation:90}},defaultBottomAxisOptions:{labels:{x:0,y:14},title:{rotation:0}},defaultTopAxisOptions:{labels:{x:0,y:-5},title:{rotation:0}},init:function(a,b){var c=b.isX;this.horiz=a.inverted?!c:c;this.xOrY=(this.isXAxis=c)?"x":"y";this.opposite=b.opposite;this.side=this.horiz?this.opposite?0:2:this.opposite?1:3;this.setOptions(b);var d=this.options,e=d.type;this.labelFormatter=d.labels.formatter||this.defaultLabelFormatter;this.userOptions=b;this.minPixelPadding=0;this.chart=a;this.reversed=d.reversed;this.zoomEnabled=d.zoomEnabled!==!1;this.categories=d.categories||e==="category";this.names=[];this.isLog=e==="logarithmic";this.isDatetimeAxis=e==="datetime";this.isLinked=u(d.linkedTo);this.tickmarkOffset=this.categories&&d.tickmarkPlacement==="between"?0.5:0;this.ticks={};this.minorTicks={};this.plotLinesAndBands=[];this.alternateBands={};this.len=0;this.minRange=this.userMinRange=d.minRange||d.maxZoom;this.range=d.range;this.offset=d.offset||0;this.stacks={};this.oldStacks={};this.stackExtremes={};this.min=this.max=null;var f,d=this.options.events;pa(this,a.axes)===-1&&(a.axes.push(this),a[c?"xAxis":"yAxis"].push(this));this.series=this.series||[];if(a.inverted&&c&&this.reversed===v)this.reversed=!0;this.removePlotLine=this.removePlotBand=this.removePlotBandOrLine;for(f in d)K(this,f,d[f]);if(this.isLog)this.val2lin=ma,this.lin2val=fa},setOptions:function(a){this.options=x(this.defaultOptions,this.isXAxis?{}:this.defaultYAxisOptions,[this.defaultTopAxisOptions,this.defaultRightAxisOptions,this.defaultBottomAxisOptions,this.defaultLeftAxisOptions][this.side],x(L[this.isXAxis?"xAxis":"yAxis"],a))},update:function(a,b){var c=this.chart,a=c.options[this.xOrY+"Axis"][this.options.index]=x(this.userOptions,a);this.destroy(!0);this._addedPlotLB=this.userMin=this.userMax=v;this.init(c,s(a,{events:v}));c.isDirtyBox=!0;o(b,!0)&&c.redraw()},remove:function(a){var b=this.chart,c=this.xOrY+"Axis";n(this.series,function(a){a.remove(!1)});ga(b.axes,this);ga(b[c],this);b.options[c].splice(this.options.index,1);n(b[c],function(a,b){a.options.index=b});this.destroy();b.isDirtyBox=!0;o(a,!0)&&b.redraw()},defaultLabelFormatter:function(){var a=this.axis,b=this.value,c=a.categories,d=this.dateTimeLabelFormat,e=L.lang.numericSymbols,f=e&&e.length,g,h=a.options.labels.format,a=a.isLog?b:a.tickInterval;if(h)g=Ca(h,this);else if(c)g=b;else if(d)g=Ya(d,b);else if(f&&a>=1E3)for(;f--&&g===v;)c=Math.pow(1E3,f+1),a>=c&&e[f]!==null&&(g=Aa(b/c,-1)+e[f]);g===v&&(g=b>=1E3?Aa(b,0):Aa(b,-1));return g},getSeriesExtremes:function(){var a=this,b=a.chart;a.hasVisibleSeries=!1;a.dataMin=a.dataMax=null;a.stackExtremes={};a.buildStacks();n(a.series,function(c){if(c.visible||!b.options.chart.ignoreHiddenSeries){var d;d=c.options.threshold;var e;a.hasVisibleSeries=!0;a.isLog&&d<=0&&(d=null);if(a.isXAxis){if(d=c.xData,d.length)a.dataMin=J(o(a.dataMin,d[0]),Ja(d)),a.dataMax=r(o(a.dataMax,d[0]),ua(d))}else{c.getExtremes();e=c.dataMax;c=c.dataMin;if(u(c)&&u(e))a.dataMin=J(o(a.dataMin,c),c),a.dataMax=r(o(a.dataMax,e),e);if(u(d))if(a.dataMin>=d)a.dataMin=d,a.ignoreMinPadding=!0;else if(a.dataMax<d)a.dataMax=d,a.ignoreMaxPadding=!0}}})},translate:function(a,b,c,d,e,f){var g=this.len,h=1,i=0,j=d?this.oldTransA:this.transA,d=d?this.oldMin:this.min,k=this.minPixelPadding,e=(this.options.ordinal||this.isLog&&e)&&this.lin2val;if(!j)j=this.transA;c&&(h*=-1,i=g);this.reversed&&(h*=-1,i-=h*g);b?(a=a*h+i,a-=k,a=a/j+d,e&&(a=this.lin2val(a))):(e&&(a=this.val2lin(a)),f==="between"&&(f=0.5),a=h*(a-d)*j+i+h*k+(ra(f)?j*f*this.pointRange:0));return a},toPixels:function(a,b){return this.translate(a,!1,!this.horiz,null,!0)+(b?0:this.pos)},toValue:function(a,b){return this.translate(a-(b?0:this.pos),!0,!this.horiz,null,!0)},getPlotLinePath:function(a,b,c,d){var e=this.chart,f=this.left,g=this.top,h,i,j,a=this.translate(a,null,null,c),k=c&&e.oldChartHeight||e.chartHeight,l=c&&e.oldChartWidth||e.chartWidth,m;h=this.transB;c=i=t(a+h);h=j=t(k-a-h);if(isNaN(a))m=!0;else if(this.horiz){if(h=g,j=k-this.bottom,c<f||c>f+this.width)m=!0}else if(c=f,i=l-this.right,h<g||h>g+this.height)m=!0;return m&&!d?null:e.renderer.crispLine(["M",c,h,"L",i,j],b||0)},getPlotBandPath:function(a,b){var c=this.getPlotLinePath(b),d=this.getPlotLinePath(a);d&&c?d.push(c[4],c[5],c[1],c[2]):d=null;return d},getLinearTickPositions:function(a,b,c){for(var d,b=ia(P(b/a)*a),c=ia(wa(c/a)*a),e=[];b<=c;){e.push(b);b=ia(b+a);if(b===d)break;d=b}return e},getLogTickPositions:function(a,b,c,d){var e=this.options,f=this.len,g=[];if(!d)this._minorAutoInterval=null;if(a>=0.5)a=t(a),g=this.getLinearTickPositions(a,b,c);else if(a>=0.08)for(var f=P(b),h,i,j,k,l,e=a>0.3?[1,2,4]:a>0.15?[1,2,4,6,8]:[1,2,3,4,5,6,7,8,9];f<c+1&&!l;f++){i=e.length;for(h=0;h<i&&!l;h++)j=ma(fa(f)*e[h]),j>b&&(!d||k<=c)&&g.push(k),k>c&&(l=!0),k=j}else if(b=fa(b),c=fa(c),a=e[d?"minorTickInterval":"tickInterval"],a=o(a==="auto"?null:a,this._minorAutoInterval,(c-b)*(e.tickPixelInterval/(d?5:1))/((d?f/this.tickPositions.length:f)||1)),a=ob(a,null,nb(a)),g=Na(this.getLinearTickPositions(a,b,c),ma),!d)this._minorAutoInterval=a/5;if(!d)this.tickInterval=a;return g},getMinorTickPositions:function(){var a=this.options,b=this.tickPositions,c=this.minorTickInterval,d=[],e;if(this.isLog){e=b.length;for(a=1;a<e;a++)d=d.concat(this.getLogTickPositions(c,b[a-1],b[a],!0))}else if(this.isDatetimeAxis&&a.minorTickInterval==="auto")d=d.concat(Eb(Cb(c),this.min,this.max,a.startOfWeek)),d[0]<this.min&&d.shift();else for(b=this.min+(b[0]-this.min)%c;b<=this.max;b+=c)d.push(b);return d},adjustForMinRange:function(){var a=this.options,b=this.min,c=this.max,d,e=this.dataMax-this.dataMin>=this.minRange,f,g,h,i,j;if(this.isXAxis&&this.minRange===v&&!this.isLog)u(a.min)||u(a.max)?this.minRange=null:(n(this.series,function(a){i=a.xData;for(g=j=a.xIncrement?1:i.length-1;g>0;g--)if(h=i[g]-i[g-1],f===v||h<f)f=h}),this.minRange=J(f*5,this.dataMax-this.dataMin));if(c-b<this.minRange){var k=this.minRange;d=(k-c+b)/2;d=[b-d,o(a.min,b-d)];if(e)d[2]=this.dataMin;b=ua(d);c=[b+k,o(a.max,b+k)];if(e)c[2]=this.dataMax;c=Ja(c);c-b<k&&(d[0]=c-k,d[1]=o(a.min,c-k),b=ua(d))}this.min=b;this.max=c},setAxisTranslation:function(a){var b=this.max-this.min,c=0,d,e=0,f=0,g=this.linkedParent,h=this.transA;if(this.isXAxis)g?(e=g.minPointOffset,f=g.pointRangePadding):n(this.series,function(a){var g=a.pointRange,h=a.options.pointPlacement,l=a.closestPointRange;g>b&&(g=0);c=r(c,g);e=r(e,ea(h)?0:g/2);f=r(f,h==="on"?0:g);!a.noSharedTooltip&&u(l)&&(d=u(d)?J(d,l):l)}),g=this.ordinalSlope&&d?this.ordinalSlope/d:1,this.minPointOffset=e*=g,this.pointRangePadding=f*=g,this.pointRange=J(c,b),this.closestPointRange=d;if(a)this.oldTransA=h;this.translationSlope=this.transA=h=this.len/(b+f||1);this.transB=this.horiz?this.left:this.bottom;this.minPixelPadding=h*e},setTickPositions:function(a){var b=this,c=b.chart,d=b.options,e=b.isLog,f=b.isDatetimeAxis,g=b.isXAxis,h=b.isLinked,i=b.options.tickPositioner,j=d.maxPadding,k=d.minPadding,l=d.tickInterval,m=d.minTickInterval,p=d.tickPixelInterval,q,aa=b.categories;h?(b.linkedParent=c[g?"xAxis":"yAxis"][d.linkedTo],c=b.linkedParent.getExtremes(),b.min=o(c.min,c.dataMin),b.max=o(c.max,c.dataMax),d.type!==b.linkedParent.options.type&&ka(11,1)):(b.min=o(b.userMin,d.min,b.dataMin),b.max=o(b.userMax,d.max,b.dataMax));if(e)!a&&J(b.min,o(b.dataMin,b.min))<=0&&ka(10,1),b.min=ia(ma(b.min)),b.max=ia(ma(b.max));if(b.range&&(b.userMin=b.min=r(b.min,b.max-b.range),b.userMax=b.max,a))b.range=null;b.beforePadding&&b.beforePadding();b.adjustForMinRange();if(!aa&&!b.usePercentage&&!h&&u(b.min)&&u(b.max)&&(c=b.max-b.min)){if(!u(d.min)&&!u(b.userMin)&&k&&(b.dataMin<0||!b.ignoreMinPadding))b.min-=c*k;if(!u(d.max)&&!u(b.userMax)&&j&&(b.dataMax>0||!b.ignoreMaxPadding))b.max+=c*j}b.min===b.max||b.min===void 0||b.max===void 0?b.tickInterval=1:h&&!l&&p===b.linkedParent.options.tickPixelInterval?b.tickInterval=b.linkedParent.tickInterval:(b.tickInterval=o(l,aa?1:(b.max-b.min)*p/r(b.len,p)),!u(l)&&b.len<p&&!this.isRadial&&(q=!0,b.tickInterval/=4));g&&!a&&n(b.series,function(a){a.processData(b.min!==b.oldMin||b.max!==b.oldMax)});b.setAxisTranslation(!0);b.beforeSetTickPositions&&b.beforeSetTickPositions();if(b.postProcessTickInterval)b.tickInterval=b.postProcessTickInterval(b.tickInterval);if(b.pointRange)b.tickInterval=r(b.pointRange,b.tickInterval);if(!l&&b.tickInterval<m)b.tickInterval=m;if(!f&&!e&&!l)b.tickInterval=ob(b.tickInterval,null,nb(b.tickInterval),d);b.minorTickInterval=d.minorTickInterval==="auto"&&b.tickInterval?b.tickInterval/5:d.minorTickInterval;b.tickPositions=a=d.tickPositions?[].concat(d.tickPositions):i&&i.apply(b,[b.min,b.max]);if(!a)!b.ordinalPositions&&(b.max-b.min)/b.tickInterval>r(2*b.len,200)&&ka(19,!0),a=f?(b.getNonLinearTimeTicks||Eb)(Cb(b.tickInterval,d.units),b.min,b.max,d.startOfWeek,b.ordinalPositions,b.closestPointRange,!0):e?b.getLogTickPositions(b.tickInterval,b.min,b.max):b.getLinearTickPositions(b.tickInterval,b.min,b.max),q&&a.splice(1,a.length-2),b.tickPositions=a;if(!h)e=a[0],f=a[a.length-1],h=b.minPointOffset||0,d.startOnTick?b.min=e:b.min-h>e&&a.shift(),d.endOnTick?b.max=f:b.max+h<f&&a.pop(),a.length===1&&(b.min-=0.001,b.max+=0.001)},setMaxTicks:function(){var a=this.chart,b=a.maxTicks||{},c=this.tickPositions,d=this._maxTicksKey=[this.xOrY,this.pos,this.len].join("-");if(!this.isLinked&&!this.isDatetimeAxis&&c&&c.length>(b[d]||0)&&this.options.alignTicks!==!1)b[d]=c.length;a.maxTicks=b},adjustTickAmount:function(){var a=this._maxTicksKey,b=this.tickPositions,c=this.chart.maxTicks;if(c&&c[a]&&!this.isDatetimeAxis&&!this.categories&&!this.isLinked&&this.options.alignTicks!==!1){var d=this.tickAmount,e=b.length;this.tickAmount=a=c[a];if(e<a){for(;b.length<a;)b.push(ia(b[b.length-1]+this.tickInterval));this.transA*=(e-1)/(a-1);this.max=b[b.length-1]}if(u(d)&&a!==d)this.isDirty=!0}},setScale:function(){var a=this.stacks,b,c,d,e;this.oldMin=this.min;this.oldMax=this.max;this.oldAxisLength=this.len;this.setAxisSize();e=this.len!==this.oldAxisLength;n(this.series,function(a){if(a.isDirtyData||a.isDirty||a.xAxis.isDirty)d=!0});if(e||d||this.isLinked||this.forceRedraw||this.userMin!==this.oldUserMin||this.userMax!==this.oldUserMax){if(!this.isXAxis)for(b in a)for(c in a[b])a[b][c].total=null,a[b][c].cum=0;this.forceRedraw=!1;this.getSeriesExtremes();this.setTickPositions();this.oldUserMin=this.userMin;this.oldUserMax=this.userMax;if(!this.isDirty)this.isDirty=e||this.min!==this.oldMin||this.max!==this.oldMax}else if(!this.isXAxis){if(this.oldStacks)a=this.stacks=this.oldStacks;for(b in a)for(c in a[b])a[b][c].cum=a[b][c].total}this.setMaxTicks()},setExtremes:function(a,b,c,d,e){var f=this,g=f.chart,c=o(c,!0),e=s(e,{min:a,max:b});A(f,"setExtremes",e,function(){f.userMin=a;f.userMax=b;f.eventArgs=e;f.isDirtyExtremes=!0;c&&g.redraw(d)})},zoom:function(a,b){this.allowZoomOutside||(u(this.dataMin)&&a<=this.dataMin&&(a=v),u(this.dataMax)&&b>=this.dataMax&&(b=v));this.displayBtn=a!==v||b!==v;this.setExtremes(a,b,!1,v,{trigger:"zoom"});return!0},setAxisSize:function(){var a=this.chart,b=this.options,c=b.offsetLeft||0,d=b.offsetRight||0,e=this.horiz,f,g;this.left=g=o(b.left,a.plotLeft+c);this.top=f=o(b.top,a.plotTop);this.width=c=o(b.width,a.plotWidth-c+d);this.height=b=o(b.height,a.plotHeight);this.bottom=a.chartHeight-b-f;this.right=a.chartWidth-c-g;this.len=r(e?c:b,0);this.pos=e?g:f},getExtremes:function(){var a=this.isLog;return{min:a?ia(fa(this.min)):this.min,max:a?ia(fa(this.max)):this.max,dataMin:this.dataMin,dataMax:this.dataMax,userMin:this.userMin,userMax:this.userMax}},getThreshold:function(a){var b=this.isLog,c=b?fa(this.min):this.min,b=b?fa(this.max):this.max;c>a||a===null?a=c:b<a&&(a=b);return this.translate(a,0,1,0,1)},addPlotBand:function(a){this.addPlotBandOrLine(a,"plotBands")},addPlotLine:function(a){this.addPlotBandOrLine(a,"plotLines")},addPlotBandOrLine:function(a,b){var c=(new vb(this,a)).render(),d=this.userOptions;c&&(b&&(d[b]=d[b]||[],d[b].push(a)),this.plotLinesAndBands.push(c));return c},autoLabelAlign:function(a){a=(o(a,0)-this.side*90+720)%360;return a>15&&a<165?"right":a>195&&a<345?"left":"center"},getOffset:function(){var a=this,b=a.chart,c=b.renderer,d=a.options,e=a.tickPositions,f=a.ticks,g=a.horiz,h=a.side,i=b.inverted?[1,0,3,2][h]:h,j,k=0,l,m=0,p=d.title,q=d.labels,aa=0,B=b.axisOffset,t=b.clipOffset,s=[-1,1,1,-1][h],w,x=1,y=o(q.maxStaggerLines,5),Ha,E,H,C;a.hasData=j=a.hasVisibleSeries||u(a.min)&&u(a.max)&&!!e;a.showAxis=b=j||o(d.showEmpty,!0);a.staggerLines=a.horiz&&q.staggerLines;if(!a.axisGroup)a.gridGroup=c.g("grid").attr({zIndex:d.gridZIndex||1}).add(),a.axisGroup=c.g("axis").attr({zIndex:d.zIndex||2}).add(),a.labelGroup=c.g("axis-labels").attr({zIndex:q.zIndex||7}).add();if(j||a.isLinked){a.labelAlign=o(q.align||a.autoLabelAlign(q.rotation));n(e,function(b){f[b]?f[b].addLabel():f[b]=new Ma(a,b)});if(a.horiz&&!a.staggerLines&&y&&!q.rotation){for(w=a.reversed?[].concat(e).reverse():e;x<y;){j=[];Ha=!1;for(q=0;q<w.length;q++)E=w[q],H=(H=f[E].label&&f[E].label.getBBox())?H.width:0,C=q%x,H&&(E=a.translate(E),j[C]!==v&&E<j[C]&&(Ha=!0),j[C]=E+H);if(Ha)x++;else break}if(x>1)a.staggerLines=x}n(e,function(b){if(h===0||h===2||{1:"left",3:"right"}[h]===a.labelAlign)aa=r(f[b].getLabelSize(),aa)});if(a.staggerLines)aa*=a.staggerLines,a.labelOffset=aa}else for(w in f)f[w].destroy(),delete f[w];if(p&&p.text&&p.enabled!==!1){if(!a.axisTitle)a.axisTitle=c.text(p.text,0,0,p.useHTML).attr({zIndex:7,rotation:p.rotation||0,align:p.textAlign||{low:"left",middle:"center",high:"right"}[p.align]}).css(p.style).add(a.axisGroup),a.axisTitle.isNew=!0;if(b)k=a.axisTitle.getBBox()[g?"height":"width"],m=o(p.margin,g?5:10),l=p.offset;a.axisTitle[b?"show":"hide"]()}a.offset=s*o(d.offset,B[h]);a.axisTitleMargin=o(l,aa+m+(h!==2&&aa&&s*d.labels[g?"y":"x"]));B[h]=r(B[h],a.axisTitleMargin+k+s*a.offset);t[i]=r(t[i],P(d.lineWidth/2)*2)},getLinePath:function(a){var b=this.chart,c=this.opposite,d=this.offset,e=this.horiz,f=this.left+(c?this.width:0)+d,d=b.chartHeight-this.bottom-(c?this.height:0)+d;c&&(a*=-1);return b.renderer.crispLine(["M",e?this.left:f,e?d:this.top,"L",e?b.chartWidth-this.right:f,e?d:b.chartHeight-this.bottom],a)},getTitlePosition:function(){var a=this.horiz,b=this.left,c=this.top,d=this.len,e=this.options.title,f=a?b:c,g=this.opposite,h=this.offset,i=y(e.style.fontSize||12),d={low:f+(a?0:d),middle:f+d/2,high:f+(a?d:0)}[e.align],b=(a?c+this.height:b)+(a?1:-1)*(g?-1:1)*this.axisTitleMargin+(this.side===2?i:0);return{x:a?d:b+(g?this.width:0)+h+(e.x||0),y:a?b-(g?this.height:0)+h:d+(e.y||0)}},render:function(){var a=this,b=a.chart,c=b.renderer,d=a.options,e=a.isLog,f=a.isLinked,g=a.tickPositions,h=a.axisTitle,i=a.stacks,j=a.ticks,k=a.minorTicks,l=a.alternateBands,m=d.stackLabels,p=d.alternateGridColor,q=a.tickmarkOffset,o=d.lineWidth,B,r=b.hasRendered&&u(a.oldMin)&&!isNaN(a.oldMin);B=a.hasData;var t=a.showAxis,s,w;n([j,k,l],function(a){for(var b in a)a[b].isActive=!1});if(B||f)if(a.minorTickInterval&&!a.categories&&n(a.getMinorTickPositions(),function(b){k[b]||(k[b]=new Ma(a,b,"minor"));r&&k[b].isNew&&k[b].render(null,!0);k[b].render(null,!1,1)}),g.length&&(n(g.slice(1).concat([g[0]]),function(b,c){c=c===g.length-1?0:c+1;if(!f||b>=a.min&&b<=a.max)j[b]||(j[b]=new Ma(a,b)),r&&j[b].isNew&&j[b].render(c,!0),j[b].render(c,!1,1)}),q&&a.min===0&&(j[-1]||(j[-1]=new Ma(a,-1,null,!0)),j[-1].render(-1))),p&&n(g,function(b,c){if(c%2===0&&b<a.max)l[b]||(l[b]=new vb(a)),s=b+q,w=g[c+1]!==v?g[c+1]+q:a.max,l[b].options={from:e?fa(s):s,to:e?fa(w):w,color:p},l[b].render(),l[b].isActive=!0}),!a._addedPlotLB)n((d.plotLines||[]).concat(d.plotBands||[]),function(b){a.addPlotBandOrLine(b)}),a._addedPlotLB=!0;n([j,k,l],function(a){var c,d,e=[],f=Fa?Fa.duration||500:0,g=function(){for(d=e.length;d--;)a[e[d]]&&!a[e[d]].isActive&&(a[e[d]].destroy(),delete a[e[d]])};for(c in a)if(!a[c].isActive)a[c].render(c,!1,0),a[c].isActive=!1,e.push(c);a===l||!b.hasRendered||!f?g():f&&setTimeout(g,f)});if(o)B=a.getLinePath(o),a.axisLine?a.axisLine.animate({d:B}):a.axisLine=c.path(B).attr({stroke:d.lineColor,"stroke-width":o,zIndex:7}).add(a.axisGroup),a.axisLine[t?"show":"hide"]();if(h&&t)h[h.isNew?"attr":"animate"](a.getTitlePosition()),h.isNew=!1;if(m&&m.enabled){var x,y,d=a.stackTotalGroup;if(!d)a.stackTotalGroup=d=c.g("stack-labels").attr({visibility:"visible",zIndex:6}).add();d.translate(b.plotLeft,b.plotTop);for(x in i)for(y in c=i[x],c)c[y].render(d)}a.isDirty=!1},removePlotBandOrLine:function(a){for(var b=this.plotLinesAndBands,c=this.options,d=this.userOptions,e=b.length;e--;)b[e].id===a&&b[e].destroy();n([c.plotLines||[],d.plotLines||[],c.plotBands||[],d.plotBands||[]],function(b){for(e=b.length;e--;)b[e].id===a&&ga(b,b[e])})},setTitle:function(a,b){this.update({title:a},b)},redraw:function(){var a=this.chart.pointer;a.reset&&a.reset(!0);this.render();n(this.plotLinesAndBands,function(a){a.render()});n(this.series,function(a){a.isDirty=!0})},buildStacks:function(){var a=this.series,b=a.length;if(!this.isXAxis){for(;b--;)a[b].setStackedPoints();if(this.usePercentage)for(b=0;b<a.length;b++)a[b].setPercentStacks()}},setCategories:function(a,b){this.update({categories:a},b)},destroy:function(a){var b=this,c=b.stacks,d,e=b.plotLinesAndBands;a||$(b);for(d in c)Ka(c[d]),c[d]=null;n([b.ticks,b.minorTicks,b.alternateBands],function(a){Ka(a)});for(a=e.length;a--;)e[a].destroy();n("stackTotalGroup,axisLine,axisGroup,gridGroup,labelGroup,axisTitle".split(","),function(a){b[a]&&(b[a]=b[a].destroy())})}};wb.prototype={init:function(a,b){var c=b.borderWidth,d=b.style,e=y(d.padding);this.chart=a;this.options=b;this.crosshairs=[];this.now={x:0,y:0};this.isHidden=!0;this.label=a.renderer.label("",0,0,b.shape,null,null,b.useHTML,null,"tooltip").attr({padding:e,fill:b.backgroundColor,"stroke-width":c,r:b.borderRadius,zIndex:8}).css(d).css({padding:0}).add().attr({y:-999});ca||this.label.shadow(b.shadow);this.shared=b.shared},destroy:function(){n(this.crosshairs,function(a){a&&a.destroy()});if(this.label)this.label=this.label.destroy();clearTimeout(this.hideTimer);clearTimeout(this.tooltipTimeout)},move:function(a,b,c,d){var e=this,f=e.now,g=e.options.animation!==!1&&!e.isHidden;s(f,{x:g?(2*f.x+a)/3:a,y:g?(f.y+b)/2:b,anchorX:g?(2*f.anchorX+c)/3:c,anchorY:g?(f.anchorY+d)/2:d});e.label.attr(f);if(g&&(M(a-f.x)>1||M(b-f.y)>1))clearTimeout(this.tooltipTimeout),this.tooltipTimeout=setTimeout(function(){e&&e.move(a,b,c,d)},32)},hide:function(){var a=this,b;clearTimeout(this.hideTimer);if(!this.isHidden)b=this.chart.hoverPoints,this.hideTimer=setTimeout(function(){a.label.fadeOut();a.isHidden=!0},o(this.options.hideDelay,500)),b&&n(b,function(a){a.setState()}),this.chart.hoverPoints=null},hideCrosshairs:function(){n(this.crosshairs,function(a){a&&a.hide()})},getAnchor:function(a,b){var c,d=this.chart,e=d.inverted,f=d.plotTop,g=0,h=0,i,a=ja(a);c=a[0].tooltipPos;this.followPointer&&b&&(b.chartX===v&&(b=d.pointer.normalize(b)),c=[b.chartX-d.plotLeft,b.chartY-f]);c||(n(a,function(a){i=a.series.yAxis;g+=a.plotX;h+=(a.plotLow?(a.plotLow+a.plotHigh)/2:a.plotY)+(!e&&i?i.top-f:0)}),g/=a.length,h/=a.length,c=[e?d.plotWidth-h:g,this.shared&&!e&&a.length>1&&b?b.chartY-f:e?d.plotHeight-g:h]);return Na(c,t)},getPosition:function(a,b,c){var d=this.chart,e=d.plotLeft,f=d.plotTop,g=d.plotWidth,h=d.plotHeight,i=o(this.options.distance,12),j=c.plotX,c=c.plotY,d=j+e+(d.inverted?i:-a-i),k=c-b+f+15,l;d<7&&(d=e+r(j,0)+i);d+a>e+g&&(d-=d+a-(e+g),k=c-b+f-i,l=!0);k<f+5&&(k=f+5,l&&c>=k&&c<=k+b&&(k=c+f+i));k+b>f+h&&(k=r(f,f+h-b-i));return{x:d,y:k}},defaultFormatter:function(a){var b=this.points||ja(this),c=b[0].series,d;d=[c.tooltipHeaderFormatter(b[0])];n(b,function(a){c=a.series;d.push(c.tooltipFormatter&&c.tooltipFormatter(a)||a.point.tooltipFormatter(c.tooltipOptions.pointFormat))});d.push(a.options.footerFormat||"");return d.join("")},refresh:function(a,b){var c=this.chart,d=this.label,e=this.options,f,g,h={},i,j=[];i=e.formatter||this.defaultFormatter;var h=c.hoverPoints,k,l=e.crosshairs,m=this.shared;clearTimeout(this.hideTimer);this.followPointer=ja(a)[0].series.tooltipOptions.followPointer;g=this.getAnchor(a,b);f=g[0];g=g[1];m&&(!a.series||!a.series.noSharedTooltip)?(c.hoverPoints=a,h&&n(h,function(a){a.setState()}),n(a,function(a){a.setState("hover");j.push(a.getLabelConfig())}),h={x:a[0].category,y:a[0].y},h.points=j,a=a[0]):h=a.getLabelConfig();i=i.call(h,this);h=a.series;i===!1?this.hide():(this.isHidden&&(Wa(d),d.attr("opacity",1).show()),d.attr({text:i}),k=e.borderColor||a.color||h.color||"#606060",d.attr({stroke:k}),this.updatePosition({plotX:f,plotY:g}),this.isHidden=!1);if(l){l=ja(l);for(d=l.length;d--;)if(m=a.series,e=m[d?"yAxis":"xAxis"],l[d]&&e)if(h=d?o(a.stackY,a.y):a.x,e.isLog&&(h=ma(h)),d===1&&m.modifyValue&&(h=m.modifyValue(h)),e=e.getPlotLinePath(h,1),this.crosshairs[d])this.crosshairs[d].attr({d:e,visibility:"visible"});else{h={"stroke-width":l[d].width||1,stroke:l[d].color||"#C0C0C0",zIndex:l[d].zIndex||2};if(l[d].dashStyle)h.dashstyle=l[d].dashStyle;this.crosshairs[d]=c.renderer.path(e).attr(h).add()}}A(c,"tooltipRefresh",{text:i,x:f+c.plotLeft,y:g+c.plotTop,borderColor:k})},updatePosition:function(a){var b=this.chart,c=this.label,c=(this.options.positioner||this.getPosition).call(this,c.width,c.height,a);this.move(t(c.x),t(c.y),a.plotX+b.plotLeft,a.plotY+b.plotTop)}};xb.prototype={init:function(a,b){var c=b.chart,d=c.events,e=ca?"":c.zoomType,c=a.inverted,f;this.options=b;this.chart=a;this.zoomX=f=/x/.test(e);this.zoomY=e=/y/.test(e);this.zoomHor=f&&!c||e&&c;this.zoomVert=e&&!c||f&&c;this.runChartClick=d&&!!d.click;this.pinchDown=[];this.lastValidTouch={};if(b.tooltip.enabled)a.tooltip=new wb(a,b.tooltip);this.setDOMEvents()},normalize:function(a,b){var c,d,a=a||N.event;if(!a.target)a.target=a.srcElement;a=Xb(a);d=a.touches?a.touches.item(0):a;if(!b)this.chartPosition=b=Wb(this.chart.container);d.pageX===v?(c=r(a.x,a.clientX-b.left),d=a.y):(c=d.pageX-b.left,d=d.pageY-b.top);return s(a,{chartX:t(c),chartY:t(d)})},getCoordinates:function(a){var b={xAxis:[],yAxis:[]};n(this.chart.axes,function(c){b[c.isXAxis?"xAxis":"yAxis"].push({axis:c,value:c.toValue(a[c.horiz?"chartX":"chartY"])})});return b},getIndex:function(a){var b=this.chart;return b.inverted?b.plotHeight+b.plotTop-a.chartY:a.chartX-b.plotLeft},runPointActions:function(a){var b=this.chart,c=b.series,d=b.tooltip,e,f=b.hoverPoint,g=b.hoverSeries,h,i,j=b.chartWidth,k=this.getIndex(a);if(d&&this.options.tooltip.shared&&(!g||!g.noSharedTooltip)){e=[];h=c.length;for(i=0;i<h;i++)if(c[i].visible&&c[i].options.enableMouseTracking!==!1&&!c[i].noSharedTooltip&&c[i].tooltipPoints.length&&(b=c[i].tooltipPoints[k])&&b.series)b._dist=M(k-b.clientX),j=J(j,b._dist),e.push(b);for(h=e.length;h--;)e[h]._dist>j&&e.splice(h,1);if(e.length&&e[0].clientX!==this.hoverX)d.refresh(e,a),this.hoverX=e[0].clientX}if(g&&g.tracker){if((b=g.tooltipPoints[k])&&b!==f)b.onMouseOver(a)}else d&&d.followPointer&&!d.isHidden&&(a=d.getAnchor([{}],a),d.updatePosition({plotX:a[0],plotY:a[1]}))},reset:function(a){var b=this.chart,c=b.hoverSeries,d=b.hoverPoint,e=b.tooltip,b=e&&e.shared?b.hoverPoints:d;(a=a&&e&&b)&&ja(b)[0].plotX===v&&(a=!1);if(a)e.refresh(b);else{if(d)d.onMouseOut();if(c)c.onMouseOut();e&&(e.hide(),e.hideCrosshairs());this.hoverX=null}},scaleGroups:function(a,b){var c=this.chart,d;n(c.series,function(e){d=a||e.getPlotBox();e.xAxis&&e.xAxis.zoomEnabled&&(e.group.attr(d),e.markerGroup&&(e.markerGroup.attr(d),e.markerGroup.clip(b?c.clipRect:null)),e.dataLabelsGroup&&e.dataLabelsGroup.attr(d))});c.clipRect.attr(b||c.clipBox)},pinchTranslate:function(a,b,c,d,e,f,g,h){a&&this.pinchTranslateDirection(!0,c,d,e,f,g,h);b&&this.pinchTranslateDirection(!1,c,d,e,f,g,h)},pinchTranslateDirection:function(a,b,c,d,e,f,g,h){var i=this.chart,j=a?"x":"y",k=a?"X":"Y",l="chart"+k,m=a?"width":"height",p=i["plot"+(a?"Left":"Top")],q,o,n=h||1,r=i.inverted,t=i.bounds[a?"h":"v"],u=b.length===1,s=b[0][l],v=c[0][l],w=!u&&b[1][l],x=!u&&c[1][l],y,c=function(){!u&&M(s-w)>20&&(n=h||M(v-x)/M(s-w));o=(p-v)/n+s;q=i["plot"+(a?"Width":"Height")]/n};c();b=o;b<t.min?(b=t.min,y=!0):b+q>t.max&&(b=t.max-q,y=!0);y?(v-=0.8*(v-g[j][0]),u||(x-=0.8*(x-g[j][1])),c()):g[j]=[v,x];r||(f[j]=o-p,f[m]=q);f=r?1/n:n;e[m]=q;e[j]=b;d[r?a?"scaleY":"scaleX":"scale"+k]=n;d["translate"+k]=f*p+(v-f*s)},pinch:function(a){var b=this,c=b.chart,d=b.pinchDown,e=c.tooltip&&c.tooltip.options.followTouchMove,f=a.touches,g=f.length,h=b.lastValidTouch,i=b.zoomHor||b.pinchHor,j=b.zoomVert||b.pinchVert,k=i||j,l=b.selectionMarker,m={},p=g===1&&(b.inClass(a.target,"highcharts-tracker")&&c.runTrackerClick||c.runChartClick),q={};(k||e)&&!p&&a.preventDefault();Na(f,function(a){return b.normalize(a)});if(a.type==="touchstart")n(f,function(a,b){d[b]={chartX:a.chartX,chartY:a.chartY}}),h.x=[d[0].chartX,d[1]&&d[1].chartX],h.y=[d[0].chartY,d[1]&&d[1].chartY],n(c.axes,function(a){if(a.zoomEnabled){var b=c.bounds[a.horiz?"h":"v"],d=a.minPixelPadding,e=a.toPixels(a.dataMin),f=a.toPixels(a.dataMax),g=J(e,f),e=r(e,f);b.min=J(a.pos,g-d);b.max=r(a.pos+a.len,e+d)}});else if(d.length){if(!l)b.selectionMarker=l=s({destroy:oa},c.plotBox);b.pinchTranslate(i,j,d,f,m,l,q,h);b.hasPinched=k;b.scaleGroups(m,q);!k&&e&&g===1&&this.runPointActions(b.normalize(a))}},dragStart:function(a){var b=this.chart;b.mouseIsDown=a.type;b.cancelClick=!1;b.mouseDownX=this.mouseDownX=a.chartX;b.mouseDownY=this.mouseDownY=a.chartY},drag:function(a){var b=this.chart,c=b.options.chart,d=a.chartX,e=a.chartY,f=this.zoomHor,g=this.zoomVert,h=b.plotLeft,i=b.plotTop,j=b.plotWidth,k=b.plotHeight,l,m=this.mouseDownX,p=this.mouseDownY;d<h?d=h:d>h+j&&(d=h+j);e<i?e=i:e>i+k&&(e=i+k);this.hasDragged=Math.sqrt(Math.pow(m-d,2)+Math.pow(p-e,2));if(this.hasDragged>10){l=b.isInsidePlot(m-h,p-i);if(b.hasCartesianSeries&&(this.zoomX||this.zoomY)&&l&&!this.selectionMarker)this.selectionMarker=b.renderer.rect(h,i,f?1:j,g?1:k,0).attr({fill:c.selectionMarkerFill||"rgba(69,114,167,0.25)",zIndex:7}).add();this.selectionMarker&&f&&(d-=m,this.selectionMarker.attr({width:M(d),x:(d>0?0:d)+m}));this.selectionMarker&&g&&(d=e-p,this.selectionMarker.attr({height:M(d),y:(d>0?0:d)+p}));l&&!this.selectionMarker&&c.panning&&b.pan(a,c.panning)}},drop:function(a){var b=this.chart,c=this.hasPinched;if(this.selectionMarker){var d={xAxis:[],yAxis:[],originalEvent:a.originalEvent||a},e=this.selectionMarker,f=e.x,g=e.y,h;if(this.hasDragged||c)n(b.axes,function(a){if(a.zoomEnabled){var b=a.horiz,c=a.toValue(b?f:g),b=a.toValue(b?f+e.width:g+e.height);!isNaN(c)&&!isNaN(b)&&(d[a.xOrY+"Axis"].push({axis:a,min:J(c,b),max:r(c,b)}),h=!0)}}),h&&A(b,"selection",d,function(a){b.zoom(s(a,c?{animation:!1}:null))});this.selectionMarker=this.selectionMarker.destroy();c&&this.scaleGroups()}if(b)I(b.container,{cursor:b._cursor}),b.cancelClick=this.hasDragged>10,b.mouseIsDown=this.hasDragged=this.hasPinched=!1,this.pinchDown=[]},onContainerMouseDown:function(a){a=this.normalize(a);a.preventDefault&&a.preventDefault();this.dragStart(a)},onDocumentMouseUp:function(a){this.drop(a)},onDocumentMouseMove:function(a){var b=this.chart,c=this.chartPosition,d=b.hoverSeries,a=this.normalize(a,c);c&&d&&!this.inClass(a.target,"highcharts-tracker")&&!b.isInsidePlot(a.chartX-b.plotLeft,a.chartY-b.plotTop)&&this.reset()},onContainerMouseLeave:function(){this.reset();this.chartPosition=null},onContainerMouseMove:function(a){var b=this.chart,a=this.normalize(a);a.returnValue=!1;b.mouseIsDown==="mousedown"&&this.drag(a);(this.inClass(a.target,"highcharts-tracker")||b.isInsidePlot(a.chartX-b.plotLeft,a.chartY-b.plotTop))&&!b.openMenu&&this.runPointActions(a)},inClass:function(a,b){for(var c;a;){if(c=w(a,"class"))if(c.indexOf(b)!==-1)return!0;else if(c.indexOf("highcharts-container")!==-1)return!1;a=a.parentNode}},onTrackerMouseOut:function(a){var b=this.chart.hoverSeries;if(b&&!b.options.stickyTracking&&!this.inClass(a.toElement||a.relatedTarget,"highcharts-tooltip"))b.onMouseOut()},onContainerClick:function(a){var b=this.chart,c=b.hoverPoint,d=b.plotLeft,e=b.plotTop,f=b.inverted,g,h,i,a=this.normalize(a);a.cancelBubble=!0;if(!b.cancelClick)c&&this.inClass(a.target,"highcharts-tracker")?(g=this.chartPosition,h=c.plotX,i=c.plotY,s(c,{pageX:g.left+d+(f?b.plotWidth-i:h),pageY:g.top+e+(f?b.plotHeight-h:i)}),A(c.series,"click",s(a,{point:c})),b.hoverPoint&&c.firePointEvent("click",a)):(s(a,this.getCoordinates(a)),b.isInsidePlot(a.chartX-d,a.chartY-e)&&A(b,"click",a))},onContainerTouchStart:function(a){var b=this.chart;a.touches.length===1?(a=this.normalize(a),b.isInsidePlot(a.chartX-b.plotLeft,a.chartY-b.plotTop)?(this.runPointActions(a),this.pinch(a)):this.reset()):a.touches.length===2&&this.pinch(a)},onContainerTouchMove:function(a){(a.touches.length===1||a.touches.length===2)&&this.pinch(a)},onDocumentTouchEnd:function(a){this.drop(a)},setDOMEvents:function(){var a=this,b=a.chart.container,c;this._events=c=[[b,"onmousedown","onContainerMouseDown"],[b,"onmousemove","onContainerMouseMove"],[b,"onclick","onContainerClick"],[b,"mouseleave","onContainerMouseLeave"],[z,"mousemove","onDocumentMouseMove"],[z,"mouseup","onDocumentMouseUp"]];jb&&c.push([b,"ontouchstart","onContainerTouchStart"],[b,"ontouchmove","onContainerTouchMove"],[z,"touchend","onDocumentTouchEnd"]);n(c,function(b){a["_"+b[2]]=function(c){a[b[2]](c)};b[1].indexOf("on")===0?b[0][b[1]]=a["_"+b[2]]:K(b[0],b[1],a["_"+b[2]])})},destroy:function(){var a=this;n(a._events,function(b){b[1].indexOf("on")===0?b[0][b[1]]=null:$(b[0],b[1],a["_"+b[2]])});delete a._events;clearInterval(a.tooltipTimeout)}};fb.prototype={init:function(a,b){var c=this,d=b.itemStyle,e=o(b.padding,8),f=b.itemMarginTop||0;this.options=b;if(b.enabled)c.baseline=y(d.fontSize)+3+f,c.itemStyle=d,c.itemHiddenStyle=x(d,b.itemHiddenStyle),c.itemMarginTop=f,c.padding=e,c.initialItemX=e,c.initialItemY=e-5,c.maxItemWidth=0,c.chart=a,c.itemHeight=0,c.lastLineHeight=0,c.render(),K(c.chart,"endResize",function(){c.positionCheckboxes()})},colorizeItem:function(a,b){var c=this.options,d=a.legendItem,e=a.legendLine,f=a.legendSymbol,g=this.itemHiddenStyle.color,c=b?c.itemStyle.color:g,h=b?a.color:g,g=a.options&&a.options.marker,i={stroke:h,fill:h},j;d&&d.css({fill:c,color:c});e&&e.attr({stroke:h});if(f){if(g&&f.isMarker)for(j in g=a.convertAttribs(g),g)d=g[j],d!==v&&(i[j]=d);f.attr(i)}},positionItem:function(a){var b=this.options,c=b.symbolPadding,b=!b.rtl,d=a._legendItemPos,e=d[0],d=d[1],f=a.checkbox;a.legendGroup&&a.legendGroup.translate(b?e:this.legendWidth-e-2*c-4,d);if(f)f.x=e,f.y=d},destroyItem:function(a){var b=a.checkbox;n(["legendItem","legendLine","legendSymbol","legendGroup"],function(b){a[b]&&(a[b]=a[b].destroy())});b&&Ta(a.checkbox)},destroy:function(){var a=this.group,b=this.box;if(b)this.box=b.destroy();if(a)this.group=a.destroy()},positionCheckboxes:function(a){var b=this.group.alignAttr,c,d=this.clipHeight||this.legendHeight;if(b)c=b.translateY,n(this.allItems,function(e){var f=e.checkbox,g;f&&(g=c+f.y+(a||0)+3,I(f,{left:b.translateX+e.legendItemWidth+f.x-20+"px",top:g+"px",display:g>c-6&&g<c+d-6?"":S}))})},renderTitle:function(){var a=this.padding,b=this.options.title,c=0;if(b.text){if(!this.title)this.title=this.chart.renderer.label(b.text,a-3,a-4,null,null,null,null,null,"legend-title").attr({zIndex:1}).css(b.style).add(this.group);a=this.title.getBBox();c=a.height;this.offsetWidth=a.width;this.contentGroup.attr({translateY:c})}this.titleHeight=c},renderItem:function(a){var C;var b=this,c=b.chart,d=c.renderer,e=b.options,f=e.layout==="horizontal",g=e.symbolWidth,h=e.symbolPadding,i=b.itemStyle,j=b.itemHiddenStyle,k=b.padding,l=f?o(e.itemDistance,8):0,m=!e.rtl,p=e.width,q=e.itemMarginBottom||0,n=b.itemMarginTop,B=b.initialItemX,t=a.legendItem,u=a.series||a,s=u.options,v=s.showCheckbox,w=e.useHTML;if(!t&&(a.legendGroup=d.g("legend-item").attr({zIndex:1}).add(b.scrollGroup),u.drawLegendSymbol(b,a),a.legendItem=t=d.text(e.labelFormat?Ca(e.labelFormat,a):e.labelFormatter.call(a),m?g+h:-h,b.baseline,w).css(x(a.visible?i:j)).attr({align:m?"left":"right",zIndex:2}).add(a.legendGroup),(w?t:a.legendGroup).on("mouseover",function(){a.setState("hover");t.css(b.options.itemHoverStyle)}).on("mouseout",function(){t.css(a.visible?i:j);a.setState()}).on("click",function(b){var c=function(){a.setVisible()},b={browserEvent:b};a.firePointEvent?a.firePointEvent("legendItemClick",b,c):A(a,"legendItemClick",b,c)}),b.colorizeItem(a,a.visible),s&&v))a.checkbox=U("input",{type:"checkbox",checked:a.selected,defaultChecked:a.selected},e.itemCheckboxStyle,c.container),K(a.checkbox,"click",function(b){A(a,"checkboxClick",{checked:b.target.checked},function(){a.select()})});d=t.getBBox();C=a.legendItemWidth=e.itemWidth||g+h+d.width+l+(v?20:0),e=C;b.itemHeight=g=d.height;if(f&&b.itemX-B+e>(p||c.chartWidth-2*k-B))b.itemX=B,b.itemY+=n+b.lastLineHeight+q,b.lastLineHeight=0;b.maxItemWidth=r(b.maxItemWidth,e);b.lastItemY=n+b.itemY+q;b.lastLineHeight=r(g,b.lastLineHeight);a._legendItemPos=[b.itemX,b.itemY];f?b.itemX+=e:(b.itemY+=n+g+q,b.lastLineHeight=g);b.offsetWidth=p||r((f?b.itemX-B-l:e)+k,b.offsetWidth)},render:function(){var a=this,b=a.chart,c=b.renderer,d=a.group,e,f,g,h,i=a.box,j=a.options,k=a.padding,l=j.borderWidth,m=j.backgroundColor;a.itemX=a.initialItemX;a.itemY=a.initialItemY;a.offsetWidth=0;a.lastItemY=0;if(!d)a.group=d=c.g("legend").attr({zIndex:7}).add(),a.contentGroup=c.g().attr({zIndex:1}).add(d),a.scrollGroup=c.g().add(a.contentGroup);a.renderTitle();e=[];n(b.series,function(a){var b=a.options;if(o(b.showInLegend,b.linkedTo===v?v:!1,!0))e=e.concat(a.legendItems||(b.legendType==="point"?a.data:a))});Kb(e,function(a,b){return(a.options&&a.options.legendIndex||0)-(b.options&&b.options.legendIndex||0)});j.reversed&&e.reverse();a.allItems=e;a.display=f=!!e.length;n(e,function(b){a.renderItem(b)});g=j.width||a.offsetWidth;h=a.lastItemY+a.lastLineHeight+a.titleHeight;h=a.handleOverflow(h);if(l||m){g+=k;h+=k;if(i){if(g>0&&h>0)i[i.isNew?"attr":"animate"](i.crisp(null,null,null,g,h)),i.isNew=!1}else a.box=i=c.rect(0,0,g,h,j.borderRadius,l||0).attr({stroke:j.borderColor,"stroke-width":l||0,fill:m||S}).add(d).shadow(j.shadow),i.isNew=!0;i[f?"show":"hide"]()}a.legendWidth=g;a.legendHeight=h;n(e,function(b){a.positionItem(b)});f&&d.align(s({width:g,height:h},j),!0,"spacingBox");b.isResizing||this.positionCheckboxes()},handleOverflow:function(a){var b=this,c=this.chart,d=c.renderer,e=this.options,f=e.y,f=c.spacingBox.height+(e.verticalAlign==="top"?-f:f)-this.padding,g=e.maxHeight,h=this.clipRect,i=e.navigation,j=o(i.animation,!0),k=i.arrowSize||12,l=this.nav;e.layout==="horizontal"&&(f/=2);g&&(f=J(f,g));if(a>f&&!e.useHTML){this.clipHeight=c=f-20-this.titleHeight;this.pageCount=wa(a/c);this.currentPage=o(this.currentPage,1);this.fullHeight=a;if(!h)h=b.clipRect=d.clipRect(0,0,9999,0),b.contentGroup.clip(h);h.attr({height:c});if(!l)this.nav=l=d.g().attr({zIndex:1}).add(this.group),this.up=d.symbol("triangle",0,0,k,k).on("click",function(){b.scroll(-1,j)}).add(l),this.pager=d.text("",15,10).css(i.style).add(l),this.down=d.symbol("triangle-down",0,0,k,k).on("click",function(){b.scroll(1,j)}).add(l);b.scroll(0);a=f}else if(l)h.attr({height:c.chartHeight}),l.hide(),this.scrollGroup.attr({translateY:1}),this.clipHeight=0;return a},scroll:function(a,b){var c=this.pageCount,d=this.currentPage+a,e=this.clipHeight,f=this.options.navigation,g=f.activeColor,h=f.inactiveColor,f=this.pager,i=this.padding;d>c&&(d=c);if(d>0)b!==v&&La(b,this.chart),this.nav.attr({translateX:i,translateY:e+7+this.titleHeight,visibility:"visible"}),this.up.attr({fill:d===1?h:g}).css({cursor:d===1?"default":"pointer"}),f.attr({text:d+"/"+this.pageCount}),this.down.attr({x:18+this.pager.getBBox().width,fill:d===c?h:g}).css({cursor:d===c?"default":"pointer"}),e=-J(e*(d-1),this.fullHeight-e+i)+1,this.scrollGroup.animate({translateY:e}),f.attr({text:d+"/"+c}),this.currentPage=d,this.positionCheckboxes(e)}};/Trident\/7\.0/.test(na)&&mb(fb.prototype,"positionItem",function(a,b){var c=this,d=function(){a.call(c,b)};c.chart.renderer.forExport?d():setTimeout(d)});yb.prototype={init:function(a,b){var c,d=a.series;a.series=null;c=x(L,a);c.series=a.series=d;d=c.chart;this.margin=this.splashArray("margin",d);this.spacing=this.splashArray("spacing",d);var e=d.events;this.bounds={h:{},v:{}};this.callback=b;this.isResizing=0;this.options=c;this.axes=[];this.series=[];this.hasCartesianSeries=d.showAxes;var f=this,g;f.index=Ga.length;Ga.push(f);d.reflow!==!1&&K(f,"load",function(){f.initReflow()});if(e)for(g in e)K(f,g,e[g]);f.xAxis=[];f.yAxis=[];f.animation=ca?!1:o(d.animation,!0);f.pointCount=0;f.counters=new Jb;f.firstRender()},initSeries:function(a){var b=this.options.chart;(b=X[a.type||b.type||b.defaultSeriesType])||ka(17,!0);b=new b;b.init(this,a);return b},addSeries:function(a,b,c){var d,e=this;a&&(b=o(b,!0),A(e,"addSeries",{options:a},function(){d=e.initSeries(a);e.isDirtyLegend=!0;e.linkSeries();b&&e.redraw(c)}));return d},addAxis:function(a,b,c,d){var e=b?"xAxis":"yAxis",f=this.options;new eb(this,x(a,{index:this[e].length,isX:b}));f[e]=ja(f[e]||{});f[e].push(a);o(c,!0)&&this.redraw(d)},isInsidePlot:function(a,b,c){var d=c?b:a,a=c?a:b;return d>=0&&d<=this.plotWidth&&a>=0&&a<=this.plotHeight},adjustTickAmounts:function(){this.options.chart.alignTicks!==!1&&n(this.axes,function(a){a.adjustTickAmount()});this.maxTicks=null},redraw:function(a){var b=this.axes,c=this.series,d=this.pointer,e=this.legend,f=this.isDirtyLegend,g,h,i=this.isDirtyBox,j=c.length,k=j,l=this.renderer,m=l.isHidden(),p=[];La(a,this);m&&this.cloneRenderTo();for(this.layOutTitles();k--;)if(a=c[k],a.options.stacking&&(g=!0,a.isDirty)){h=!0;break}if(h)for(k=j;k--;)if(a=c[k],a.options.stacking)a.isDirty=!0;n(c,function(a){a.isDirty&&a.options.legendType==="point"&&(f=!0)});if(f&&e.options.enabled)e.render(),this.isDirtyLegend=!1;g&&this.getStacks();if(this.hasCartesianSeries){if(!this.isResizing)this.maxTicks=null,n(b,function(a){a.setScale()});this.adjustTickAmounts();this.getMargins();n(b,function(a){a.isDirty&&(i=!0)});n(b,function(a){if(a.isDirtyExtremes)a.isDirtyExtremes=!1,p.push(function(){A(a,"afterSetExtremes",s(a.eventArgs,a.getExtremes()));delete a.eventArgs});(i||g)&&a.redraw()})}i&&this.drawChartBox();n(c,function(a){a.isDirty&&a.visible&&(!a.isCartesian||a.xAxis)&&a.redraw()});d&&d.reset&&d.reset(!0);l.draw();A(this,"redraw");m&&this.cloneRenderTo(!0);n(p,function(a){a.call()})},showLoading:function(a){var b=this.options,c=this.loadingDiv,d=b.loading;if(!c)this.loadingDiv=c=U(Ea,{className:"highcharts-loading"},s(d.style,{zIndex:10,display:S}),this.container),this.loadingSpan=U("span",null,d.labelStyle,c);this.loadingSpan.innerHTML=a||b.lang.loading;if(!this.loadingShown)I(c,{opacity:0,display:"",left:this.plotLeft+"px",top:this.plotTop+"px",width:this.plotWidth+"px",height:this.plotHeight+"px"}),Bb(c,{opacity:d.style.opacity},{duration:d.showDuration||0}),this.loadingShown=!0},hideLoading:function(){var a=this.options,b=this.loadingDiv;b&&Bb(b,{opacity:0},{duration:a.loading.hideDuration||100,complete:function(){I(b,{display:S})}});this.loadingShown=!1},get:function(a){var b=this.axes,c=this.series,d,e;for(d=0;d<b.length;d++)if(b[d].options.id===a)return b[d];for(d=0;d<c.length;d++)if(c[d].options.id===a)return c[d];for(d=0;d<c.length;d++){e=c[d].points||[];for(b=0;b<e.length;b++)if(e[b].id===a)return e[b]}return null},getAxes:function(){var a=this,b=this.options,c=b.xAxis=ja(b.xAxis||{}),b=b.yAxis=ja(b.yAxis||{});n(c,function(a,b){a.index=b;a.isX=!0});n(b,function(a,b){a.index=b});c=c.concat(b);n(c,function(b){new eb(a,b)});a.adjustTickAmounts()},getSelectedPoints:function(){var a=[];n(this.series,function(b){a=a.concat(ub(b.points||[],function(a){return a.selected}))});return a},getSelectedSeries:function(){return ub(this.series,function(a){return a.selected})},getStacks:function(){var a=this;n(a.yAxis,function(a){if(a.stacks&&a.hasVisibleSeries)a.oldStacks=a.stacks});n(a.series,function(b){if(b.options.stacking&&(b.visible===!0||a.options.chart.ignoreHiddenSeries===!1))b.stackKey=b.type+o(b.options.stack,"")})},showResetZoom:function(){var a=this,b=L.lang,c=a.options.chart.resetZoomButton,d=c.theme,e=d.states,f=c.relativeTo==="chart"?null:"plotBox";this.resetZoomButton=a.renderer.button(b.resetZoom,null,null,function(){a.zoomOut()},d,e&&e.hover).attr({align:c.position.align,title:b.resetZoomTitle}).add().align(c.position,!1,f)},zoomOut:function(){var a=this;A(a,"selection",{resetSelection:!0},function(){a.zoom()})},zoom:function(a){var b,c=this.pointer,d=!1,e;!a||a.resetSelection?n(this.axes,function(a){b=a.zoom()}):n(a.xAxis.concat(a.yAxis),function(a){var e=a.axis,h=e.isXAxis;if(c[h?"zoomX":"zoomY"]||c[h?"pinchX":"pinchY"])b=e.zoom(a.min,a.max),e.displayBtn&&(d=!0)});e=this.resetZoomButton;if(d&&!e)this.showResetZoom();else if(!d&&T(e))this.resetZoomButton=e.destroy();b&&this.redraw(o(this.options.chart.animation,a&&a.animation,this.pointCount<100))},pan:function(a,b){var c=this,d=c.hoverPoints,e;d&&n(d,function(a){a.setState()});n(b==="xy"?[1,0]:[1],function(b){var d=a[b?"chartX":"chartY"],h=c[b?"xAxis":"yAxis"][0],i=c[b?"mouseDownX":"mouseDownY"],j=(h.pointRange||0)/2,k=h.getExtremes(),l=h.toValue(i-d,!0)+j,i=h.toValue(i+c[b?"plotWidth":"plotHeight"]-d,!0)-j;h.series.length&&l>J(k.dataMin,k.min)&&i<r(k.dataMax,k.max)&&(h.setExtremes(l,i,!1,!1,{trigger:"pan"}),e=!0);c[b?"mouseDownX":"mouseDownY"]=d});e&&c.redraw(!1);I(c.container,{cursor:"move"})},setTitle:function(a,b){var f;var c=this,d=c.options,e;e=d.title=x(d.title,a);f=d.subtitle=x(d.subtitle,b),d=f;n([["title",a,e],["subtitle",b,d]],function(a){var b=a[0],d=c[b],e=a[1],a=a[2];d&&e&&(c[b]=d=d.destroy());a&&a.text&&!d&&(c[b]=c.renderer.text(a.text,0,0,a.useHTML).attr({align:a.align,"class":"highcharts-"+b,zIndex:a.zIndex||4}).css(a.style).add())});c.layOutTitles()},layOutTitles:function(){var a=0,b=this.title,c=this.subtitle,d=this.options,e=d.title,d=d.subtitle,f=this.spacingBox.width-44;if(b&&(b.css({width:(e.width||f)+"px"}).align(s({y:15},e),!1,"spacingBox"),!e.floating&&!e.verticalAlign))a=b.getBBox().height,a>=18&&a<=25&&(a=15);c&&(c.css({width:(d.width||f)+"px"}).align(s({y:a+e.margin},d),!1,"spacingBox"),!d.floating&&!d.verticalAlign&&(a=wa(a+c.getBBox().height)));this.titleOffset=a},getChartSize:function(){var a=this.options.chart,b=this.renderToClone||this.renderTo;this.containerWidth=kb(b,"width");this.containerHeight=kb(b,"height");this.chartWidth=r(0,a.width||this.containerWidth||600);this.chartHeight=r(0,o(a.height,this.containerHeight>19?this.containerHeight:400))},cloneRenderTo:function(a){var b=this.renderToClone,c=this.container;a?b&&(this.renderTo.appendChild(c),Ta(b),delete this.renderToClone):(c&&c.parentNode===this.renderTo&&this.renderTo.removeChild(c),this.renderToClone=b=this.renderTo.cloneNode(0),I(b,{position:"absolute",top:"-9999px",display:"block"}),z.body.appendChild(b),c&&b.appendChild(c))},getContainer:function(){var a,b=this.options.chart,c,d,e;this.renderTo=a=b.renderTo;e="highcharts-"+zb++;if(ea(a))this.renderTo=a=z.getElementById(a);a||ka(13,!0);c=y(w(a,"data-highcharts-chart"));!isNaN(c)&&Ga[c]&&Ga[c].destroy();w(a,"data-highcharts-chart",this.index);a.innerHTML="";a.offsetWidth||this.cloneRenderTo();this.getChartSize();c=this.chartWidth;d=this.chartHeight;this.container=a=U(Ea,{className:"highcharts-container"+(b.className?" "+b.className:""),id:e},s({position:"relative",overflow:"hidden",width:c+"px",height:d+"px",textAlign:"left",lineHeight:"normal",zIndex:0,"-webkit-tap-highlight-color":"rgba(0,0,0,0)"},b.style),this.renderToClone||a);this._cursor=a.style.cursor;this.renderer=b.forExport?new za(a,c,d,!0):new Va(a,c,d);ca&&this.renderer.create(this,a,c,d)},getMargins:function(){var a=this.spacing,b,c=this.legend,d=this.margin,e=this.options.legend,f=o(e.margin,10),g=e.x,h=e.y,i=e.align,j=e.verticalAlign,k=this.titleOffset;this.resetMargins();b=this.axisOffset;if(k&&!u(d[0]))this.plotTop=r(this.plotTop,k+this.options.title.margin+a[0]);if(c.display&&!e.floating)if(i==="right"){if(!u(d[1]))this.marginRight=r(this.marginRight,c.legendWidth-g+f+a[1])}else if(i==="left"){if(!u(d[3]))this.plotLeft=r(this.plotLeft,c.legendWidth+g+f+a[3])}else if(j==="top"){if(!u(d[0]))this.plotTop=r(this.plotTop,c.legendHeight+h+f+a[0])}else if(j==="bottom"&&!u(d[2]))this.marginBottom=r(this.marginBottom,c.legendHeight-h+f+a[2]);this.extraBottomMargin&&(this.marginBottom+=this.extraBottomMargin);this.extraTopMargin&&(this.plotTop+=this.extraTopMargin);this.hasCartesianSeries&&n(this.axes,function(a){a.getOffset()});u(d[3])||(this.plotLeft+=b[3]);u(d[0])||(this.plotTop+=b[0]);u(d[2])||(this.marginBottom+=b[2]);u(d[1])||(this.marginRight+=b[1]);this.setChartSize()},initReflow:function(){function a(a){var g=c.width||kb(d,"width"),h=c.height||kb(d,"height"),a=a?a.target:N;if(!b.hasUserSize&&g&&h&&(a===N||a===z)){if(g!==b.containerWidth||h!==b.containerHeight)clearTimeout(e),b.reflowTimeout=e=setTimeout(function(){if(b.container)b.setSize(g,h,!1),b.hasUserSize=null},100);b.containerWidth=g;b.containerHeight=h}}var b=this,c=b.options.chart,d=b.renderTo,e;b.reflow=a;K(N,"resize",a);K(b,"destroy",function(){$(N,"resize",a)})},setSize:function(a,b,c){var d=this,e,f,g;d.isResizing+=1;g=function(){d&&A(d,"endResize",null,function(){d.isResizing-=1})};La(c,d);d.oldChartHeight=d.chartHeight;d.oldChartWidth=d.chartWidth;if(u(a))d.chartWidth=e=r(0,t(a)),d.hasUserSize=!!e;if(u(b))d.chartHeight=f=r(0,t(b));I(d.container,{width:e+"px",height:f+"px"});d.setChartSize(!0);d.renderer.setSize(e,f,c);d.maxTicks=null;n(d.axes,function(a){a.isDirty=!0;a.setScale()});n(d.series,function(a){a.isDirty=!0});d.isDirtyLegend=!0;d.isDirtyBox=!0;d.getMargins();d.redraw(c);d.oldChartHeight=null;A(d,"resize");Fa===!1?g():setTimeout(g,Fa&&Fa.duration||500)},setChartSize:function(a){var b=this.inverted,c=this.renderer,d=this.chartWidth,e=this.chartHeight,f=this.options.chart,g=this.spacing,h=this.clipOffset,i,j,k,l;this.plotLeft=i=t(this.plotLeft);this.plotTop=j=t(this.plotTop);this.plotWidth=k=r(0,t(d-i-this.marginRight));this.plotHeight=l=r(0,t(e-j-this.marginBottom));this.plotSizeX=b?l:k;this.plotSizeY=b?k:l;this.plotBorderWidth=f.plotBorderWidth||0;this.spacingBox=c.spacingBox={x:g[3],y:g[0],width:d-g[3]-g[1],height:e-g[0]-g[2]};this.plotBox=c.plotBox={x:i,y:j,width:k,height:l};d=2*P(this.plotBorderWidth/2);b=wa(r(d,h[3])/2);c=wa(r(d,h[0])/2);this.clipBox={x:b,y:c,width:P(this.plotSizeX-r(d,h[1])/2-b),height:P(this.plotSizeY-r(d,h[2])/2-c)};a||n(this.axes,function(a){a.setAxisSize();a.setAxisTranslation()})},resetMargins:function(){var a=this.spacing,b=this.margin;this.plotTop=o(b[0],a[0]);this.marginRight=o(b[1],a[1]);this.marginBottom=o(b[2],a[2]);this.plotLeft=o(b[3],a[3]);this.axisOffset=[0,0,0,0];this.clipOffset=[0,0,0,0]},drawChartBox:function(){var a=this.options.chart,b=this.renderer,c=this.chartWidth,d=this.chartHeight,e=this.chartBackground,f=this.plotBackground,g=this.plotBorder,h=this.plotBGImage,i=a.borderWidth||0,j=a.backgroundColor,k=a.plotBackgroundColor,l=a.plotBackgroundImage,m=a.plotBorderWidth||0,p,q=this.plotLeft,o=this.plotTop,n=this.plotWidth,r=this.plotHeight,t=this.plotBox,u=this.clipRect,s=this.clipBox;p=i+(a.shadow?8:0);if(i||j)if(e)e.animate(e.crisp(null,null,null,c-p,d-p));else{e={fill:j||S};if(i)e.stroke=a.borderColor,e["stroke-width"]=i;this.chartBackground=b.rect(p/2,p/2,c-p,d-p,a.borderRadius,i).attr(e).add().shadow(a.shadow)}if(k)f?f.animate(t):this.plotBackground=b.rect(q,o,n,r,0).attr({fill:k}).add().shadow(a.plotShadow);if(l)h?h.animate(t):this.plotBGImage=b.image(l,q,o,n,r).add();u?u.animate({width:s.width,height:s.height}):this.clipRect=b.clipRect(s);if(m)g?g.animate(g.crisp(null,q,o,n,r)):this.plotBorder=b.rect(q,o,n,r,0,-m).attr({stroke:a.plotBorderColor,"stroke-width":m,zIndex:1}).add();this.isDirtyBox=!1},propFromSeries:function(){var a=this,b=a.options.chart,c,d=a.options.series,e,f;n(["inverted","angular","polar"],function(g){c=X[b.type||b.defaultSeriesType];f=a[g]||b[g]||c&&c.prototype[g];for(e=d&&d.length;!f&&e--;)(c=X[d[e].type])&&c.prototype[g]&&(f=!0);a[g]=f})},linkSeries:function(){var a=this,b=a.series;n(b,function(a){a.linkedSeries.length=0});n(b,function(b){var d=b.options.linkedTo;if(ea(d)&&(d=d===":previous"?a.series[b.index-1]:a.get(d)))d.linkedSeries.push(b),b.linkedParent=d})},render:function(){var a=this,b=a.axes,c=a.renderer,d=a.options,e=d.labels,f=d.credits,g;a.setTitle();a.legend=new fb(a,d.legend);a.getStacks();n(b,function(a){a.setScale()});a.getMargins();a.maxTicks=null;n(b,function(a){a.setTickPositions(!0);a.setMaxTicks()});a.adjustTickAmounts();a.getMargins();a.drawChartBox();a.hasCartesianSeries&&n(b,function(a){a.render()});if(!a.seriesGroup)a.seriesGroup=c.g("series-group").attr({zIndex:3}).add();n(a.series,function(a){a.translate();a.setTooltipPoints();a.render()});e.items&&n(e.items,function(b){var d=s(e.style,b.style),f=y(d.left)+a.plotLeft,g=y(d.top)+a.plotTop+12;delete d.left;delete d.top;c.text(b.html,f,g).attr({zIndex:2}).css(d).add()});if(f.enabled&&!a.credits)g=f.href,a.credits=c.text(f.text,0,0).on("click",function(){if(g)location.href=g}).attr({align:f.position.align,zIndex:8}).css(f.style).add().align(f.position);a.hasRendered=!0},destroy:function(){var a=this,b=a.axes,c=a.series,d=a.container,e,f=d&&d.parentNode;A(a,"destroy");Ga[a.index]=v;a.renderTo.removeAttribute("data-highcharts-chart");$(a);for(e=b.length;e--;)b[e]=b[e].destroy();for(e=c.length;e--;)c[e]=c[e].destroy();n("title,subtitle,chartBackground,plotBackground,plotBGImage,plotBorder,seriesGroup,clipRect,credits,pointer,scroller,rangeSelector,legend,resetZoomButton,tooltip,renderer".split(","),function(b){var c=a[b];c&&c.destroy&&(a[b]=c.destroy())});if(d)d.innerHTML="",$(d),f&&Ta(d);for(e in a)delete a[e]},isReadyToRender:function(){var a=this;return!W&&N==N.top&&z.readyState!=="complete"||ca&&!N.canvg?(ca?Tb.push(function(){a.firstRender()},a.options.global.canvasToolsURL):z.attachEvent("onreadystatechange",function(){z.detachEvent("onreadystatechange",a.firstRender);z.readyState==="complete"&&a.firstRender()}),!1):!0},firstRender:function(){var a=this,b=a.options,c=a.callback;if(a.isReadyToRender())a.getContainer(),A(a,"init"),a.resetMargins(),a.setChartSize(),a.propFromSeries(),a.getAxes(),n(b.series||[],function(b){a.initSeries(b)}),a.linkSeries(),A(a,"beforeRender"),a.pointer=new xb(a,b),a.render(),a.renderer.draw(),c&&c.apply(a,[a]),n(a.callbacks,function(b){b.apply(a,[a])}),a.cloneRenderTo(!0),A(a,"load")},splashArray:function(a,b){var c=b[a],c=T(c)?c:[c,c,c,c];return[o(b[a+"Top"],c[0]),o(b[a+"Right"],c[1]),o(b[a+"Bottom"],c[2]),o(b[a+"Left"],c[3])]}};yb.prototype.callbacks=[];var Pa=function(){};Pa.prototype={init:function(a,b,c){this.series=a;this.applyOptions(b,c);this.pointAttr={};if(a.options.colorByPoint&&(b=a.options.colors||a.chart.options.colors,this.color=this.color||b[a.colorCounter++],a.colorCounter===b.length))a.colorCounter=0;a.chart.pointCount++;return this},applyOptions:function(a,b){var c=this.series,d=c.pointValKey,a=Pa.prototype.optionsToObject.call(this,a);s(this,a);this.options=this.options?s(this.options,a):a;if(d)this.y=this[d];if(this.x===v&&c)this.x=b===v?c.autoIncrement():b;return this},optionsToObject:function(a){var b={},c=this.series,d=c.pointArrayMap||["y"],e=d.length,f=0,g=0;if(typeof a==="number"||a===null)b[d[0]]=a;else if(Ia(a)){if(a.length>e){c=typeof a[0];if(c==="string")b.name=a[0];else if(c==="number")b.x=a[0];f++}for(;g<e;)b[d[g++]]=a[f++]}else if(typeof a==="object"){b=a;if(a.dataLabels)c._hasPointLabels=!0;if(a.marker)c._hasPointMarkers=!0}return b},destroy:function(){var a=this.series.chart,b=a.hoverPoints,c;a.pointCount--;if(b&&(this.setState(),ga(b,this),!b.length))a.hoverPoints=null;if(this===a.hoverPoint)this.onMouseOut();if(this.graphic||this.dataLabel)$(this),this.destroyElements();this.legendItem&&a.legend.destroyItem(this);for(c in this)this[c]=null},destroyElements:function(){for(var a="graphic,dataLabel,dataLabelUpper,group,connector,shadowGroup".split(","),b,c=6;c--;)b=a[c],this[b]&&(this[b]=this[b].destroy())},getLabelConfig:function(){return{x:this.category,y:this.y,key:this.name||this.category,series:this.series,point:this,percentage:this.percentage,total:this.total||this.stackTotal}},select:function(a,b){var c=this,d=c.series,e=d.chart,a=o(a,!c.selected);c.firePointEvent(a?"select":"unselect",{accumulate:b},function(){c.selected=c.options.selected=a;d.options.data[pa(c,d.data)]=c.options;c.setState(a&&"select");b||n(e.getSelectedPoints(),function(a){if(a.selected&&a!==c)a.selected=a.options.selected=!1,d.options.data[pa(a,d.data)]=a.options,a.setState(""),a.firePointEvent("unselect")})})},onMouseOver:function(a){var b=this.series,c=b.chart,d=c.tooltip,e=c.hoverPoint;if(e&&e!==this)e.onMouseOut();this.firePointEvent("mouseOver");d&&(!d.shared||b.noSharedTooltip)&&d.refresh(this,a);this.setState("hover");c.hoverPoint=this},onMouseOut:function(){var a=this.series.chart,b=a.hoverPoints;if(!b||pa(this,b)===-1)this.firePointEvent("mouseOut"),this.setState(),a.hoverPoint=null},tooltipFormatter:function(a){var b=this.series,c=b.tooltipOptions,d=o(c.valueDecimals,""),e=c.valuePrefix||"",f=c.valueSuffix||"";n(b.pointArrayMap||["y"],function(b){b="{point."+b;if(e||f)a=a.replace(b+"}",e+b+"}"+f);a=a.replace(b+"}",b+":,."+d+"f}")});return Ca(a,{point:this,series:this.series})},update:function(a,b,c){var d=this,e=d.series,f=d.graphic,g,h=e.data,i=e.chart,j=e.options,b=o(b,!0);d.firePointEvent("update",{options:a},function(){d.applyOptions(a);if(T(a)&&(e.getAttribs(),f))a&&a.marker&&a.marker.symbol?d.graphic=f.destroy():f.attr(d.pointAttr[d.state||""]);g=pa(d,h);e.xData[g]=d.x;e.yData[g]=e.toYData?e.toYData(d):d.y;e.zData[g]=d.z;j.data[g]=d.options;e.isDirty=e.isDirtyData=!0;if(!e.fixedBox&&e.hasCartesianSeries)i.isDirtyBox=!0;j.legendType==="point"&&i.legend.destroyItem(d);b&&i.redraw(c)})},remove:function(a,b){var c=this,d=c.series,e=d.points,f=d.chart,g,h=d.data;La(b,f);a=o(a,!0);c.firePointEvent("remove",null,function(){g=pa(c,h);h.length===e.length&&e.splice(g,1);h.splice(g,1);d.options.data.splice(g,1);d.xData.splice(g,1);d.yData.splice(g,1);d.zData.splice(g,1);c.destroy();d.isDirty=!0;d.isDirtyData=!0;a&&f.redraw()})},firePointEvent:function(a,b,c){var d=this,e=this.series.options;(e.point.events[a]||d.options&&d.options.events&&d.options.events[a])&&this.importEvents();a==="click"&&e.allowPointSelect&&(c=function(a){d.select(null,a.ctrlKey||a.metaKey||a.shiftKey)});A(this,a,b,c)},importEvents:function(){if(!this.hasImportedEvents){var a=x(this.series.options.point,this.options).events,b;this.events=a;for(b in a)K(this,b,a[b]);this.hasImportedEvents=!0}},setState:function(a){var b=this.plotX,c=this.plotY,d=this.series,e=d.options.states,f=Z[d.type].marker&&d.options.marker,g=f&&!f.enabled,h=f&&f.states[a],i=h&&h.enabled===!1,j=d.stateMarkerGraphic,k=this.marker||{},l=d.chart,m=this.pointAttr,a=a||"";if(!(a===this.state||this.selected&&a!=="select"||e[a]&&e[a].enabled===!1||a&&(i||g&&!h.enabled)||a&&k.states&&k.states[a]&&k.states[a].enabled===!1)){if(this.graphic)e=f&&this.graphic.symbolName&&m[a].r,this.graphic.attr(x(m[a],e?{x:b-e,y:c-e,width:2*e,height:2*e}:{}));else{if(a&&h)e=h.radius,k=k.symbol||d.symbol,j&&j.currentSymbol!==k&&(j=j.destroy()),j?j.attr({x:b-e,y:c-e}):(d.stateMarkerGraphic=j=l.renderer.symbol(k,b-e,c-e,2*e,2*e).attr(m[a]).add(d.markerGroup),j.currentSymbol=k);if(j)j[a&&l.isInsidePlot(b,c)?"show":"hide"]()}this.state=a}}};var Q=function(){};Q.prototype={isCartesian:!0,type:"line",pointClass:Pa,sorted:!0,requireSorting:!0,pointAttrToOptions:{stroke:"lineColor","stroke-width":"lineWidth",fill:"fillColor",r:"radius"},colorCounter:0,init:function(a,b){var c,d,e=a.series;this.chart=a;this.options=b=this.setOptions(b);this.linkedSeries=[];this.bindAxes();s(this,{name:b.name,state:"",pointAttr:{},visible:b.visible!==!1,selected:b.selected===!0});if(ca)b.animation=!1;d=b.events;for(c in d)K(this,c,d[c]);if(d&&d.click||b.point&&b.point.events&&b.point.events.click||b.allowPointSelect)a.runTrackerClick=!0;this.getColor();this.getSymbol();this.setData(b.data,!1);if(this.isCartesian)a.hasCartesianSeries=!0;e.push(this);this._i=e.length-1;Kb(e,function(a,b){return o(a.options.index,a._i)-o(b.options.index,a._i)});n(e,function(a,b){a.index=b;a.name=a.name||"Series "+(b+1)})},bindAxes:function(){var a=this,b=a.options,c=a.chart,d;a.isCartesian&&n(["xAxis","yAxis"],function(e){n(c[e],function(c){d=c.options;if(b[e]===d.index||b[e]!==v&&b[e]===d.id||b[e]===v&&d.index===0)c.series.push(a),a[e]=c,c.isDirty=!0});a[e]||ka(18,!0)})},autoIncrement:function(){var a=this.options,b=this.xIncrement,b=o(b,a.pointStart,0);this.pointInterval=o(this.pointInterval,a.pointInterval,1);this.xIncrement=b+this.pointInterval;return b},getSegments:function(){var a=-1,b=[],c,d=this.points,e=d.length;if(e)if(this.options.connectNulls){for(c=e;c--;)d[c].y===null&&d.splice(c,1);d.length&&(b=[d])}else n(d,function(c,g){c.y===null?(g>a+1&&b.push(d.slice(a+1,g)),a=g):g===e-1&&b.push(d.slice(a+1,g+1))});this.segments=b},setOptions:function(a){var b=this.chart.options,c=b.plotOptions,d=c[this.type];this.userOptions=a;a=x(d,c.series,a);this.tooltipOptions=x(b.tooltip,a.tooltip);d.marker===null&&delete a.marker;return a},getColor:function(){var a=this.options,b=this.userOptions,c=this.chart.options.colors,d=this.chart.counters,e;e=a.color||Z[this.type].color;if(!e&&!a.colorByPoint)u(b._colorIndex)?a=b._colorIndex:(b._colorIndex=d.color,a=d.color++),e=c[a];this.color=e;d.wrapColor(c.length)},getSymbol:function(){var a=this.userOptions,b=this.options.marker,c=this.chart,d=c.options.symbols,c=c.counters;this.symbol=b.symbol;if(!this.symbol)u(a._symbolIndex)?a=a._symbolIndex:(a._symbolIndex=c.symbol,a=c.symbol++),this.symbol=d[a];if(/^url/.test(this.symbol))b.radius=0;c.wrapSymbol(d.length)},drawLegendSymbol:function(a){var b=this.options,c=b.marker,d=a.options,e;e=d.symbolWidth;var f=this.chart.renderer,g=this.legendGroup,a=a.baseline-t(f.fontMetrics(d.itemStyle.fontSize).b*0.3);if(b.lineWidth){d={"stroke-width":b.lineWidth};if(b.dashStyle)d.dashstyle=b.dashStyle;this.legendLine=f.path(["M",0,a,"L",e,a]).attr(d).add(g)}if(c&&c.enabled)b=c.radius,this.legendSymbol=e=f.symbol(this.symbol,e/2-b,a-b,2*b,2*b).add(g),e.isMarker=!0},addPoint:function(a,b,c,d){var e=this.options,f=this.data,g=this.graph,h=this.area,i=this.chart,j=this.xData,k=this.yData,l=this.zData,m=this.xAxis&&this.xAxis.names,p=g&&g.shift||0,q=e.data,r;La(d,i);c&&n([g,h,this.graphNeg,this.areaNeg],function(a){if(a)a.shift=p+1});if(h)h.isArea=!0;b=o(b,!0);d={series:this};this.pointClass.prototype.applyOptions.apply(d,[a]);g=d.x;h=j.length;if(this.requireSorting&&g<j[h-1])for(r=!0;h&&j[h-1]>g;)h--;j.splice(h,0,g);k.splice(h,0,this.toYData?this.toYData(d):d.y);l.splice(h,0,d.z);if(m)m[g]=d.name;q.splice(h,0,a);r&&(this.data.splice(h,0,null),this.processData());e.legendType==="point"&&this.generatePoints();c&&(f[0]&&f[0].remove?f[0].remove(!1):(f.shift(),j.shift(),k.shift(),l.shift(),q.shift()));this.isDirtyData=this.isDirty=!0;b&&(this.getAttribs(),i.redraw())},setData:function(a,b){var c=this.points,d=this.options,e=this.chart,f=null,g=this.xAxis,h=g&&g.names,i;this.xIncrement=null;this.pointRange=g&&g.categories?1:d.pointRange;this.colorCounter=0;var j=[],k=[],l=[],m=a?a.length:[];i=o(d.turboThreshold,1E3);var p=this.pointArrayMap,p=p&&p.length,q=!!this.toYData;if(i&&m>i){for(i=0;f===null&&i<m;)f=a[i],i++;if(ra(f)){h=o(d.pointStart,0);d=o(d.pointInterval,1);for(i=0;i<m;i++)j[i]=h,k[i]=a[i],h+=d;this.xIncrement=h}else if(Ia(f))if(p)for(i=0;i<m;i++)d=a[i],j[i]=d[0],k[i]=d.slice(1,p+1);else for(i=0;i<m;i++)d=a[i],j[i]=d[0],k[i]=d[1];else ka(12)}else for(i=0;i<m;i++)if(a[i]!==v&&(d={series:this},this.pointClass.prototype.applyOptions.apply(d,[a[i]]),j[i]=d.x,k[i]=q?this.toYData(d):d.y,l[i]=d.z,h&&d.name))h[d.x]=d.name;ea(k[0])&&ka(14,!0);this.data=[];this.options.data=a;this.xData=j;this.yData=k;this.zData=l;for(i=c&&c.length||0;i--;)c[i]&&c[i].destroy&&c[i].destroy();if(g)g.minRange=g.userMinRange;this.isDirty=this.isDirtyData=e.isDirtyBox=!0;o(b,!0)&&e.redraw(!1)},remove:function(a,b){var c=this,d=c.chart,a=o(a,!0);if(!c.isRemoving)c.isRemoving=!0,A(c,"remove",null,function(){c.destroy();d.isDirtyLegend=d.isDirtyBox=!0;d.linkSeries();a&&d.redraw(b)});c.isRemoving=!1},processData:function(a){var b=this.xData,c=this.yData,d=b.length,e;e=0;var f,g,h=this.xAxis,i=this.options,j=i.cropThreshold,k=this.isCartesian;if(k&&!this.isDirty&&!h.isDirty&&!this.yAxis.isDirty&&!a)return!1;if(k&&this.sorted&&(!j||d>j||this.forceCrop))if(a=h.min,h=h.max,b[d-1]<a||b[0]>h)b=[],c=[];else if(b[0]<a||b[d-1]>h)e=this.cropData(this.xData,this.yData,a,h),b=e.xData,c=e.yData,e=e.start,f=!0;for(h=b.length-1;h>=0;h--)d=b[h]-b[h-1],d>0&&(g===v||d<g)?g=d:d<0&&this.requireSorting&&ka(15);this.cropped=f;this.cropStart=e;this.processedXData=b;this.processedYData=c;if(i.pointRange===null)this.pointRange=g||1;this.closestPointRange=g},cropData:function(a,b,c,d){var e=a.length,f=0,g=e,h=o(this.cropShoulder,1),i;for(i=0;i<e;i++)if(a[i]>=c){f=r(0,i-h);break}for(;i<e;i++)if(a[i]>d){g=i+h;break}return{xData:a.slice(f,g),yData:b.slice(f,g),start:f,end:g}},generatePoints:function(){var a=this.options.data,b=this.data,c,d=this.processedXData,e=this.processedYData,f=this.pointClass,g=d.length,h=this.cropStart||0,i,j=this.hasGroupedData,k,l=[],m;if(!b&&!j)b=[],b.length=a.length,b=this.data=b;for(m=0;m<g;m++)i=h+m,j?l[m]=(new f).init(this,[d[m]].concat(ja(e[m]))):(b[i]?k=b[i]:a[i]!==v&&(b[i]=k=(new f).init(this,a[i],d[m])),l[m]=k);if(b&&(g!==(c=b.length)||j))for(m=0;m<c;m++)if(m===h&&!j&&(m+=g),b[m])b[m].destroyElements(),b[m].plotX=v;this.data=b;this.points=l},setStackedPoints:function(){if(this.options.stacking&&!(this.visible!==!0&&this.chart.options.chart.ignoreHiddenSeries!==!1)){var a=this.processedXData,b=this.processedYData,c=[],d=b.length,e=this.options,f=e.threshold,g=e.stack,e=e.stacking,h=this.stackKey,i="-"+h,j=this.negStacks,k=this.yAxis,l=k.stacks,m=k.oldStacks,p,q,o,n,t;for(o=0;o<d;o++){n=a[o];t=b[o];q=(p=j&&t<f)?i:h;l[q]||(l[q]={});if(!l[q][n])m[q]&&m[q][n]?(l[q][n]=m[q][n],l[q][n].total=null):l[q][n]=new Mb(k,k.options.stackLabels,p,n,g,e);q=l[q][n];q.points[this.index]=[q.cum||0];e==="percent"?(p=p?h:i,j&&l[p]&&l[p][n]?(p=l[p][n],q.total=p.total=r(p.total,q.total)+M(t)||0):q.total+=M(t)||0):q.total+=t||0;q.cum=(q.cum||0)+(t||0);q.points[this.index].push(q.cum);c[o]=q.cum}if(e==="percent")k.usePercentage=!0;this.stackedYData=c;k.oldStacks={}}},setPercentStacks:function(){var a=this,b=a.stackKey,c=a.yAxis.stacks;n([b,"-"+b],function(b){var d;for(var e=a.xData.length,f,g;e--;)if(f=a.xData[e],d=(g=c[b]&&c[b][f])&&g.points[a.index],f=d)g=g.total?100/g.total:0,f[0]=ia(f[0]*g),f[1]=ia(f[1]*g),a.stackedYData[e]=f[1]})},getExtremes:function(){var a=this.yAxis,b=this.processedXData,c=this.stackedYData||this.processedYData,d=c.length,e=[],f=0,g=this.xAxis.getExtremes(),h=g.min,g=g.max,i,j,k,l;for(l=0;l<d;l++)if(j=b[l],k=c[l],i=k!==null&&k!==v&&(!a.isLog||k.length||k>0),j=this.getExtremesFromAll||this.cropped||(b[l+1]||j)>=h&&(b[l-1]||j)<=g,i&&j)if(i=k.length)for(;i--;)k[i]!==null&&(e[f++]=k[i]);else e[f++]=k;this.dataMin=o(void 0,Ja(e));this.dataMax=o(void 0,ua(e))},translate:function(){this.processedXData||this.processData();this.generatePoints();for(var a=this.options,b=a.stacking,c=this.xAxis,d=c.categories,e=this.yAxis,f=this.points,g=f.length,h=!!this.modifyValue,i=a.pointPlacement,j=i==="between"||ra(i),k=a.threshold,a=0;a<g;a++){var l=f[a],m=l.x,p=l.y,q=l.low,n=e.stacks[(this.negStacks&&p<k?"-":"")+this.stackKey];if(e.isLog&&p<=0)l.y=p=null;l.plotX=c.translate(m,0,0,0,1,i,this.type==="flags");if(b&&this.visible&&n&&n[m])n=n[m],p=n.points[this.index],q=p[0],p=p[1],q===0&&(q=o(k,e.min)),e.isLog&&q<=0&&(q=null),l.total=l.stackTotal=n.total,l.percentage=b==="percent"&&l.y/n.total*100,l.stackY=p,n.setOffset(this.pointXOffset||0,this.barW||0);l.yBottom=u(q)?e.translate(q,0,1,0,1):null;h&&(p=this.modifyValue(p,l));l.plotY=typeof p==="number"&&p!==Infinity?e.translate(p,0,1,0,1):v;l.clientX=j?c.translate(m,0,0,0,1):l.plotX;l.negative=l.y<(k||0);l.category=d&&d[l.x]!==v?d[l.x]:l.x}this.getSegments()},setTooltipPoints:function(a){var b=[],c,d,e=this.xAxis,f=e&&e.getExtremes(),g=e?e.tooltipLen||e.len:this.chart.plotSizeX,h,i,j=[];if(this.options.enableMouseTracking!==!1){if(a)this.tooltipPoints=null;n(this.segments||this.points,function(a){b=b.concat(a)});e&&e.reversed&&(b=b.reverse());this.orderTooltipPoints&&this.orderTooltipPoints(b);a=b.length;for(i=0;i<a;i++)if(e=b[i],c=e.x,c>=f.min&&c<=f.max){h=b[i+1];c=d===v?0:d+1;for(d=b[i+1]?J(r(0,P((e.clientX+(h?h.wrappedClientX||h.clientX:g))/2)),g):g;c>=0&&c<=d;)j[c++]=e}this.tooltipPoints=j}},tooltipHeaderFormatter:function(a){var b=this.tooltipOptions,c=b.xDateFormat,d=b.dateTimeLabelFormats,e=this.xAxis,f=e&&e.options.type==="datetime",b=b.headerFormat,e=e&&e.closestPointRange,g;if(f&&!c)if(e)for(g in D){if(D[g]>=e){c=d[g];break}}else c=d.day;f&&c&&ra(a.key)&&(b=b.replace("{point.key}","{point.key:"+c+"}"));return Ca(b,{point:a,series:this})},onMouseOver:function(){var a=this.chart,b=a.hoverSeries;if(b&&b!==this)b.onMouseOut();this.options.events.mouseOver&&A(this,"mouseOver");this.setState("hover");a.hoverSeries=this},onMouseOut:function(){var a=this.options,b=this.chart,c=b.tooltip,d=b.hoverPoint;if(d)d.onMouseOut();this&&a.events.mouseOut&&A(this,"mouseOut");c&&!a.stickyTracking&&(!c.shared||this.noSharedTooltip)&&c.hide();this.setState();b.hoverSeries=null},animate:function(a){var b=this,c=b.chart,d=c.renderer,e;e=b.options.animation;var f=c.clipBox,g=c.inverted,h;if(e&&!T(e))e=Z[b.type].animation;h="_sharedClip"+e.duration+e.easing;if(a)a=c[h],e=c[h+"m"],a||(c[h]=a=d.clipRect(s(f,{width:0})),c[h+"m"]=e=d.clipRect(-99,g?-c.plotLeft:-c.plotTop,99,g?c.chartWidth:c.chartHeight)),b.group.clip(a),b.markerGroup.clip(e),b.sharedClipKey=h;else{if(a=c[h])a.animate({width:c.plotSizeX},e),c[h+"m"].animate({width:c.plotSizeX+99},e);b.animate=null;b.animationTimeout=setTimeout(function(){b.afterAnimate()},e.duration)}},afterAnimate:function(){var a=this.chart,b=this.sharedClipKey,c=this.group;c&&this.options.clip!==!1&&(c.clip(a.clipRect),this.markerGroup.clip());setTimeout(function(){b&&a[b]&&(a[b]=a[b].destroy(),a[b+"m"]=a[b+"m"].destroy())},100)},drawPoints:function(){var a,b=this.points,c=this.chart,d,e,f,g,h,i,j,k,l=this.options.marker,m,n=this.markerGroup;if(l.enabled||this._hasPointMarkers)for(f=b.length;f--;)if(g=b[f],d=P(g.plotX),e=g.plotY,k=g.graphic,i=g.marker||{},a=l.enabled&&i.enabled===v||i.enabled,m=c.isInsidePlot(t(d),e,c.inverted),a&&e!==v&&!isNaN(e)&&g.y!==null)if(a=g.pointAttr[g.selected?"select":""],h=a.r,i=o(i.symbol,this.symbol),j=i.indexOf("url")===0,k)k.attr({visibility:m?W?"inherit":"visible":"hidden"}).animate(s({x:d-h,y:e-h},k.symbolName?{width:2*h,height:2*h}:{}));else{if(m&&(h>0||j))g.graphic=c.renderer.symbol(i,d-h,e-h,2*h,2*h).attr(a).add(n)}else if(k)g.graphic=k.destroy()},convertAttribs:function(a,b,c,d){var e=this.pointAttrToOptions,f,g,h={},a=a||{},b=b||{},c=c||{},d=d||{};for(f in e)g=e[f],h[f]=o(a[g],b[f],c[f],d[f]);return h},getAttribs:function(){var a=this,b=a.options,c=Z[a.type].marker?b.marker:b,d=c.states,e=d.hover,f,g=a.color,h={stroke:g,fill:g},i=a.points||[],j=[],k,l=a.pointAttrToOptions,m=b.negativeColor,p=c.lineColor,q;b.marker?(e.radius=e.radius||c.radius+2,e.lineWidth=e.lineWidth||c.lineWidth+1):e.color=e.color||qa(e.color||g).brighten(e.brightness).get();j[""]=a.convertAttribs(c,h);n(["hover","select"],function(b){j[b]=a.convertAttribs(d[b],j[""])});a.pointAttr=j;for(g=i.length;g--;){h=i[g];if((c=h.options&&h.options.marker||h.options)&&c.enabled===!1)c.radius=0;if(h.negative&&m)h.color=h.fillColor=m;f=b.colorByPoint||h.color;if(h.options)for(q in l)u(c[l[q]])&&(f=!0);if(f){c=c||{};k=[];d=c.states||{};f=d.hover=d.hover||{};if(!b.marker)f.color=qa(f.color||h.color).brighten(f.brightness||e.brightness).get();k[""]=a.convertAttribs(s({color:h.color,fillColor:h.color,lineColor:p===null?h.color:v},c),j[""]);k.hover=a.convertAttribs(d.hover,j.hover,k[""]);k.select=a.convertAttribs(d.select,j.select,k[""])}else k=j;h.pointAttr=k}},update:function(a,b){var c=this.chart,d=this.type,e=X[d].prototype,f,a=x(this.userOptions,{animation:!1,index:this.index,pointStart:this.xData[0]},{data:this.options.data},a);this.remove(!1);for(f in e)e.hasOwnProperty(f)&&(this[f]=v);s(this,X[a.type||d].prototype);this.init(c,a);o(b,!0)&&c.redraw(!1)},destroy:function(){var a=this,b=a.chart,c=/AppleWebKit\/533/.test(na),d,e,f=a.data||[],g,h,i;A(a,"destroy");$(a);n(["xAxis","yAxis"],function(b){if(i=a[b])ga(i.series,a),i.isDirty=i.forceRedraw=!0,i.stacks={}});a.legendItem&&a.chart.legend.destroyItem(a);for(e=f.length;e--;)(g=f[e])&&g.destroy&&g.destroy();a.points=null;clearTimeout(a.animationTimeout);n("area,graph,dataLabelsGroup,group,markerGroup,tracker,graphNeg,areaNeg,posClip,negClip".split(","),function(b){a[b]&&(d=c&&b==="group"?"hide":"destroy",a[b][d]())});if(b.hoverSeries===a)b.hoverSeries=null;ga(b.series,a);for(h in a)delete a[h]},drawDataLabels:function(){var a=this,b=a.options,c=b.cursor,d=b.dataLabels,b=a.points,e,f,g,h;if(d.enabled||a._hasPointLabels)a.dlProcessOptions&&a.dlProcessOptions(d),h=a.plotGroup("dataLabelsGroup","data-labels",a.visible?"visible":"hidden",d.zIndex||6),f=d,n(b,function(b){var j,k=b.dataLabel,l,m,n=b.connector,q=!0;e=b.options&&b.options.dataLabels;j=o(e&&e.enabled,f.enabled);if(k&&!j)b.dataLabel=k.destroy();else if(j){d=x(f,e);j=d.rotation;l=b.getLabelConfig();g=d.format?Ca(d.format,l):d.formatter.call(l,d);d.style.color=o(d.color,d.style.color,a.color,"black");if(k)if(u(g))k.attr({text:g}),q=!1;else{if(b.dataLabel=k=k.destroy(),n)b.connector=n.destroy()}else if(u(g)){k={fill:d.backgroundColor,stroke:d.borderColor,"stroke-width":d.borderWidth,r:d.borderRadius||0,rotation:j,padding:d.padding,zIndex:1};for(m in k)k[m]===v&&delete k[m];k=b.dataLabel=a.chart.renderer[j?"text":"label"](g,0,-999,null,null,null,d.useHTML).attr(k).css(s(d.style,c&&{cursor:c})).add(h).shadow(d.shadow)}k&&a.alignDataLabel(b,k,d,null,q)}})},alignDataLabel:function(a,b,c,d,e){var f=this.chart,g=f.inverted,h=o(a.plotX,-999),i=o(a.plotY,-999),j=b.getBBox();if(a=this.visible&&f.isInsidePlot(a.plotX,a.plotY,g))d=s({x:g?f.plotWidth-i:h,y:t(g?f.plotHeight-h:i),width:0,height:0},d),s(c,{width:j.width,height:j.height}),c.rotation?(g={align:c.align,x:d.x+c.x+d.width/2,y:d.y+c.y+d.height/2},b[e?"attr":"animate"](g)):(b.align(c,null,d),g=b.alignAttr,o(c.overflow,"justify")==="justify"?this.justifyDataLabel(b,c,g,j,d,e):o(c.crop,!0)&&(a=f.isInsidePlot(g.x,g.y)&&f.isInsidePlot(g.x+j.width,g.y+j.height)));a||b.attr({y:-999})},justifyDataLabel:function(a,b,c,d,e,f){var g=this.chart,h=b.align,i=b.verticalAlign,j,k;j=c.x;if(j<0)h==="right"?b.align="left":b.x=-j,k=!0;j=c.x+d.width;if(j>g.plotWidth)h==="left"?b.align="right":b.x=g.plotWidth-j,k=!0;j=c.y;if(j<0)i==="bottom"?b.verticalAlign="top":b.y=-j,k=!0;j=c.y+d.height;if(j>g.plotHeight)i==="top"?b.verticalAlign="bottom":b.y=g.plotHeight-j,k=!0;if(k)a.placed=!f,a.align(b,null,e)},getSegmentPath:function(a){var b=this,c=[],d=b.options.step;n(a,function(e,f){var g=e.plotX,h=e.plotY,i;b.getPointSpline?c.push.apply(c,b.getPointSpline(a,e,f)):(c.push(f?"L":"M"),d&&f&&(i=a[f-1],d==="right"?c.push(i.plotX,h):d==="center"?c.push((i.plotX+g)/2,i.plotY,(i.plotX+g)/2,h):c.push(g,i.plotY)),c.push(e.plotX,e.plotY))});return c},getGraphPath:function(){var a=this,b=[],c,d=[];n(a.segments,function(e){c=a.getSegmentPath(e);e.length>1?b=b.concat(c):d.push(e[0])});a.singlePoints=d;return a.graphPath=b},drawGraph:function(){var a=this,b=this.options,c=[["graph",b.lineColor||this.color]],d=b.lineWidth,e=b.dashStyle,f=b.linecap!=="square",g=this.getGraphPath(),h=b.negativeColor;h&&c.push(["graphNeg",h]);n(c,function(c,h){var k=c[0],l=a[k];if(l)Wa(l),l.animate({d:g});else if(d&&g.length)l={stroke:c[1],"stroke-width":d,zIndex:1},e?l.dashstyle=e:f&&(l["stroke-linecap"]=l["stroke-linejoin"]="round"),a[k]=a.chart.renderer.path(g).attr(l).add(a.group).shadow(!h&&b.shadow)})},clipNeg:function(){var a=this.options,b=this.chart,c=b.renderer,d=a.negativeColor||a.negativeFillColor,e,f=this.graph,g=this.area,h=this.posClip,i=this.negClip;e=b.chartWidth;var j=b.chartHeight,k=r(e,j),l=this.yAxis;if(d&&(f||g)){d=t(l.toPixels(a.threshold||0,!0));a={x:0,y:0,width:k,height:d};k={x:0,y:d,width:k,height:k};if(b.inverted)a.height=k.y=b.plotWidth-d,c.isVML&&(a={x:b.plotWidth-d-b.plotLeft,y:0,width:e,height:j},k={x:d+b.plotLeft-e,y:0,width:b.plotLeft+d,height:e});l.reversed?(b=k,e=a):(b=a,e=k);h?(h.animate(b),i.animate(e)):(this.posClip=h=c.clipRect(b),this.negClip=i=c.clipRect(e),f&&this.graphNeg&&(f.clip(h),this.graphNeg.clip(i)),g&&(g.clip(h),this.areaNeg.clip(i)))}},invertGroups:function(){function a(){var a={width:b.yAxis.len,height:b.xAxis.len};n(["group","markerGroup"],function(c){b[c]&&b[c].attr(a).invert()})}var b=this,c=b.chart;if(b.xAxis)K(c,"resize",a),K(b,"destroy",function(){$(c,"resize",a)}),a(),b.invertGroups=a},plotGroup:function(a,b,c,d,e){var f=this[a],g=!f;g&&(this[a]=f=this.chart.renderer.g(b).attr({visibility:c,zIndex:d||0.1}).add(e));f[g?"attr":"animate"](this.getPlotBox());return f},getPlotBox:function(){return{translateX:this.xAxis?this.xAxis.left:this.chart.plotLeft,translateY:this.yAxis?this.yAxis.top:this.chart.plotTop,scaleX:1,scaleY:1}},render:function(){var a=this.chart,b,c=this.options,d=c.animation&&!!this.animate&&a.renderer.isSVG,e=this.visible?"visible":"hidden",f=c.zIndex,g=this.hasRendered,h=a.seriesGroup;b=this.plotGroup("group","series",e,f,h);this.markerGroup=this.plotGroup("markerGroup","markers",e,f,h);d&&this.animate(!0);this.getAttribs();b.inverted=this.isCartesian?a.inverted:!1;this.drawGraph&&(this.drawGraph(),this.clipNeg());this.drawDataLabels();this.drawPoints();this.options.enableMouseTracking!==!1&&this.drawTracker();a.inverted&&this.invertGroups();c.clip!==!1&&!this.sharedClipKey&&!g&&b.clip(a.clipRect);d?this.animate():g||this.afterAnimate();this.isDirty=this.isDirtyData=!1;this.hasRendered=!0},redraw:function(){var a=this.chart,b=this.isDirtyData,c=this.group,d=this.xAxis,e=this.yAxis;c&&(a.inverted&&c.attr({width:a.plotWidth,height:a.plotHeight}),c.animate({translateX:o(d&&d.left,a.plotLeft),translateY:o(e&&e.top,a.plotTop)}));this.translate();this.setTooltipPoints(!0);this.render();b&&A(this,"updatedData")},setState:function(a){var b=this.options,c=this.graph,d=this.graphNeg,e=b.states,b=b.lineWidth,a=a||"";if(this.state!==a)this.state=a,e[a]&&e[a].enabled===!1||(a&&(b=e[a].lineWidth||b+1),c&&!c.dashstyle&&(a={"stroke-width":b},c.attr(a),d&&d.attr(a)))},setVisible:function(a,b){var c=this,d=c.chart,e=c.legendItem,f,g=d.options.chart.ignoreHiddenSeries,h=c.visible;f=(c.visible=a=c.userOptions.visible=a===v?!h:a)?"show":"hide";n(["group","dataLabelsGroup","markerGroup","tracker"],function(a){if(c[a])c[a][f]()});if(d.hoverSeries===c)c.onMouseOut();e&&d.legend.colorizeItem(c,a);c.isDirty=!0;c.options.stacking&&n(d.series,function(a){if(a.options.stacking&&a.visible)a.isDirty=!0});n(c.linkedSeries,function(b){b.setVisible(a,!1)});if(g)d.isDirtyBox=!0;b!==!1&&d.redraw();A(c,f)},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)},select:function(a){this.selected=a=a===v?!this.selected:a;if(this.checkbox)this.checkbox.checked=a;A(this,a?"select":"unselect")},drawTracker:function(){var a=this,b=a.options,c=b.trackByArea,d=[].concat(c?a.areaPath:a.graphPath),e=d.length,f=a.chart,g=f.pointer,h=f.renderer,i=f.options.tooltip.snap,j=a.tracker,k=b.cursor,l=k&&{cursor:k},k=a.singlePoints,m,p=function(){if(f.hoverSeries!==a)a.onMouseOver()};if(e&&!c)for(m=e+1;m--;)d[m]==="M"&&d.splice(m+1,0,d[m+1]-i,d[m+2],"L"),(m&&d[m]==="M"||m===e)&&d.splice(m,0,"L",d[m-2]+i,d[m-1]);for(m=0;m<k.length;m++)e=k[m],d.push("M",e.plotX-i,e.plotY,"L",e.plotX+i,e.plotY);j?j.attr({d:d}):(a.tracker=h.path(d).attr({"stroke-linejoin":"round",visibility:a.visible?"visible":"hidden",stroke:Qb,fill:c?Qb:S,"stroke-width":b.lineWidth+(c?0:2*i),zIndex:2}).add(a.group),n([a.tracker,a.markerGroup],function(a){a.addClass("highcharts-tracker").on("mouseover",p).on("mouseout",function(a){g.onTrackerMouseOut(a)}).css(l);if(jb)a.on("touchstart",p)}))}};G=ha(Q);X.line=G;Z.area=x(Y,{threshold:0});G=ha(Q,{type:"area",getSegments:function(){var a=[],b=[],c=[],d=this.xAxis,e=this.yAxis,f=e.stacks[this.stackKey],g={},h,i,j=this.points,k=this.options.connectNulls,l,m,p;if(this.options.stacking&&!this.cropped){for(m=0;m<j.length;m++)g[j[m].x]=j[m];for(p in f)f[p].total!==null&&c.push(+p);c.sort(function(a,b){return a-b});n(c,function(a){if(!k||g[a]&&g[a].y!==null)g[a]?b.push(g[a]):(h=d.translate(a),l=f[a].percent?f[a].total?f[a].cum*100/f[a].total:0:f[a].cum,i=e.toPixels(l,!0),b.push({y:null,plotX:h,clientX:h,plotY:i,yBottom:i,onMouseOver:oa}))});b.length&&a.push(b)}else Q.prototype.getSegments.call(this),a=this.segments;this.segments=a},getSegmentPath:function(a){var b=Q.prototype.getSegmentPath.call(this,a),c=[].concat(b),d,e=this.options;d=b.length;var f=this.yAxis.getThreshold(e.threshold),g;d===3&&c.push("L",b[1],b[2]);if(e.stacking&&!this.closedStacks)for(d=a.length-1;d>=0;d--)g=o(a[d].yBottom,f),d<a.length-1&&e.step&&c.push(a[d+1].plotX,g),c.push(a[d].plotX,g);else this.closeSegment(c,a,f);this.areaPath=this.areaPath.concat(c);return b},closeSegment:function(a,b,c){a.push("L",b[b.length-1].plotX,c,"L",b[0].plotX,c)},drawGraph:function(){this.areaPath=[];Q.prototype.drawGraph.apply(this);var a=this,b=this.areaPath,c=this.options,d=c.negativeColor,e=c.negativeFillColor,f=[["area",this.color,c.fillColor]];(d||e)&&f.push(["areaNeg",d,e]);n(f,function(d){var e=d[0],f=a[e];f?f.animate({d:b}):a[e]=a.chart.renderer.path(b).attr({fill:o(d[2],qa(d[1]).setOpacity(o(c.fillOpacity,0.75)).get()),zIndex:0}).add(a.group)})},drawLegendSymbol:function(a,b){b.legendSymbol=this.chart.renderer.rect(0,a.baseline-11,a.options.symbolWidth,12,2).attr({zIndex:3}).add(b.legendGroup)}});X.area=G;Z.spline=x(Y);F=ha(Q,{type:"spline",getPointSpline:function(a,b,c){var d=b.plotX,e=b.plotY,f=a[c-1],g=a[c+1],h,i,j,k;if(f&&g){a=f.plotY;j=g.plotX;var g=g.plotY,l;h=(1.5*d+f.plotX)/2.5;i=(1.5*e+a)/2.5;j=(1.5*d+j)/2.5;k=(1.5*e+g)/2.5;l=(k-i)*(j-d)/(j-h)+e-k;i+=l;k+=l;i>a&&i>e?(i=r(a,e),k=2*e-i):i<a&&i<e&&(i=J(a,e),k=2*e-i);k>g&&k>e?(k=r(g,e),i=2*e-k):k<g&&k<e&&(k=J(g,e),i=2*e-k);b.rightContX=j;b.rightContY=k}c?(b=["C",f.rightContX||f.plotX,f.rightContY||f.plotY,h||d,i||e,d,e],f.rightContX=f.rightContY=null):b=["M",d,e];return b}});X.spline=F;Z.areaspline=x(Z.area);la=G.prototype;F=ha(F,{type:"areaspline",closedStacks:!0,getSegmentPath:la.getSegmentPath,closeSegment:la.closeSegment,drawGraph:la.drawGraph,drawLegendSymbol:la.drawLegendSymbol});X.areaspline=F;Z.column=x(Y,{borderColor:"#FFFFFF",borderWidth:1,borderRadius:0,groupPadding:0.2,marker:null,pointPadding:0.1,minPointLength:0,cropThreshold:50,pointRange:null,states:{hover:{brightness:0.1,shadow:!1},select:{color:"#C0C0C0",borderColor:"#000000",shadow:!1}},dataLabels:{align:null,verticalAlign:null,y:null},stickyTracking:!1,threshold:0});F=ha(Q,{type:"column",pointAttrToOptions:{stroke:"borderColor","stroke-width":"borderWidth",fill:"color",r:"borderRadius"},cropShoulder:0,trackerGroups:["group","dataLabelsGroup"],negStacks:!0,init:function(){Q.prototype.init.apply(this,arguments);var a=this,b=a.chart;b.hasRendered&&n(b.series,function(b){if(b.type===a.type)b.isDirty=!0})},getColumnMetrics:function(){var a=this,b=a.options,c=a.xAxis,d=a.yAxis,e=c.reversed,f,g={},h,i=0;b.grouping===!1?i=1:n(a.chart.series,function(b){var c=b.options,e=b.yAxis;if(b.type===a.type&&b.visible&&d.len===e.len&&d.pos===e.pos)c.stacking?(f=b.stackKey,g[f]===v&&(g[f]=i++),h=g[f]):c.grouping!==!1&&(h=i++),b.columnIndex=h});var c=J(M(c.transA)*(c.ordinalSlope||b.pointRange||c.closestPointRange||1),c.len),j=c*b.groupPadding,k=(c-2*j)/i,l=b.pointWidth,b=u(l)?(k-l)/2:k*b.pointPadding,l=o(l,k-2*b);return a.columnMetrics={width:l,offset:b+(j+((e?i-(a.columnIndex||0):a.columnIndex)||0)*k-c/2)*(e?-1:1)}},translate:function(){var a=this.chart,b=this.options,c=b.borderWidth,d=this.yAxis,e=this.translatedThreshold=d.getThreshold(b.threshold),f=o(b.minPointLength,5),b=this.getColumnMetrics(),g=b.width,h=this.barW=wa(r(g,1+2*c)),i=this.pointXOffset=b.offset,j=-(c%2?0.5:0),k=c%2?0.5:1;a.renderer.isVML&&a.inverted&&(k+=1);Q.prototype.translate.apply(this);n(this.points,function(a){var b=o(a.yBottom,e),c=J(r(-999-b,a.plotY),d.len+999+b),n=a.plotX+i,u=h,s=J(c,b),v,c=r(c,b)-s;M(c)<f&&f&&(c=f,s=t(M(s-e)>f?b-f:e-(d.translate(a.y,0,1,0,1)<=e?f:0)));a.barX=n;a.pointWidth=g;b=M(n)<0.5;u=t(n+u)+j;n=t(n)+j;u-=n;v=M(s)<0.5;c=t(s+c)+k;s=t(s)+k;c-=s;b&&(n+=1,u-=1);v&&(s-=1,c+=1);a.shapeType="rect";a.shapeArgs={x:n,y:s,width:u,height:c}})},getSymbol:oa,drawLegendSymbol:G.prototype.drawLegendSymbol,drawGraph:oa,drawPoints:function(){var a=this,b=a.options,c=a.chart.renderer,d;n(a.points,function(e){var f=e.plotY,g=e.graphic;if(f!==v&&!isNaN(f)&&e.y!==null)d=e.shapeArgs,g?(Wa(g),g.animate(x(d))):e.graphic=c[e.shapeType](d).attr(e.pointAttr[e.selected?"select":""]).add(a.group).shadow(b.shadow,null,b.stacking&&!b.borderRadius);else if(g)e.graphic=g.destroy()})},drawTracker:function(){var a=this,b=a.chart,c=b.pointer,d=a.options.cursor,e=d&&{cursor:d},f=function(c){var d=c.target,e;if(b.hoverSeries!==a)a.onMouseOver();for(;d&&!e;)e=d.point,d=d.parentNode;if(e!==v&&e!==b.hoverPoint)e.onMouseOver(c)};n(a.points,function(a){if(a.graphic)a.graphic.element.point=a;if(a.dataLabel)a.dataLabel.element.point=a});if(!a._hasTracking)n(a.trackerGroups,function(b){if(a[b]&&(a[b].addClass("highcharts-tracker").on("mouseover",f).on("mouseout",function(a){c.onTrackerMouseOut(a)}).css(e),jb))a[b].on("touchstart",f)}),a._hasTracking=!0},alignDataLabel:function(a,b,c,d,e){var f=this.chart,g=f.inverted,h=a.dlBox||a.shapeArgs,i=a.below||a.plotY>o(this.translatedThreshold,f.plotSizeY),j=o(c.inside,!!this.options.stacking);if(h&&(d=x(h),g&&(d={x:f.plotWidth-d.y-d.height,y:f.plotHeight-d.x-d.width,width:d.height,height:d.width}),!j))g?(d.x+=i?0:d.width,d.width=0):(d.y+=i?d.height:0,d.height=0);c.align=o(c.align,!g||j?"center":i?"right":"left");c.verticalAlign=o(c.verticalAlign,g||j?"middle":i?"top":"bottom");Q.prototype.alignDataLabel.call(this,a,b,c,d,e)},animate:function(a){var b=this.yAxis,c=this.options,d=this.chart.inverted,e={};if(W)a?(e.scaleY=0.001,a=J(b.pos+b.len,r(b.pos,b.toPixels(c.threshold))),d?e.translateX=a-b.len:e.translateY=a,this.group.attr(e)):(e.scaleY=1,e[d?"translateX":"translateY"]=b.pos,this.group.animate(e,this.options.animation),this.animate=null)},remove:function(){var a=this,b=a.chart;b.hasRendered&&n(b.series,function(b){if(b.type===a.type)b.isDirty=!0});Q.prototype.remove.apply(a,arguments)}});X.column=F;Z.bar=x(Z.column);la=ha(F,{type:"bar",inverted:!0});X.bar=la;Z.scatter=x(Y,{lineWidth:0,tooltip:{headerFormat:'<span style="font-size: 10px; color:{series.color}">{series.name}</span><br/>',pointFormat:"x: <b>{point.x}</b><br/>y: <b>{point.y}</b><br/>",followPointer:!0},stickyTracking:!1});la=ha(Q,{type:"scatter",sorted:!1,requireSorting:!1,noSharedTooltip:!0,trackerGroups:["markerGroup"],takeOrdinalPosition:!1,drawTracker:F.prototype.drawTracker,setTooltipPoints:oa});X.scatter=la;Z.pie=x(Y,{borderColor:"#FFFFFF",borderWidth:1,center:[null,null],clip:!1,colorByPoint:!0,dataLabels:{distance:30,enabled:!0,formatter:function(){return this.point.name}},ignoreHiddenPoint:!0,legendType:"point",marker:null,size:null,showInLegend:!1,slicedOffset:10,states:{hover:{brightness:0.1,shadow:!1}},stickyTracking:!1,tooltip:{followPointer:!0}});Y={type:"pie",isCartesian:!1,pointClass:ha(Pa,{init:function(){Pa.prototype.init.apply(this,arguments);var a=this,b;if(a.y<0)a.y=null;s(a,{visible:a.visible!==!1,name:o(a.name,"Slice")});b=function(b){a.slice(b.type==="select")};K(a,"select",b);K(a,"unselect",b);return a},setVisible:function(a){var b=this,c=b.series,d=c.chart,e;b.visible=b.options.visible=a=a===v?!b.visible:a;c.options.data[pa(b,c.data)]=b.options;e=a?"show":"hide";n(["graphic","dataLabel","connector","shadowGroup"],function(a){if(b[a])b[a][e]()});b.legendItem&&d.legend.colorizeItem(b,a);if(!c.isDirty&&c.options.ignoreHiddenPoint)c.isDirty=!0,d.redraw()},slice:function(a,b,c){var d=this.series;La(c,d.chart);o(b,!0);this.sliced=this.options.sliced=a=u(a)?a:!this.sliced;d.options.data[pa(this,d.data)]=this.options;a=a?this.slicedTranslation:{translateX:0,translateY:0};this.graphic.animate(a);this.shadowGroup&&this.shadowGroup.animate(a)}}),requireSorting:!1,noSharedTooltip:!0,trackerGroups:["group","dataLabelsGroup"],pointAttrToOptions:{stroke:"borderColor","stroke-width":"borderWidth",fill:"color"},getColor:oa,animate:function(a){var b=this,c=b.points,d=b.startAngleRad;if(!a)n(c,function(a){var c=a.graphic,a=a.shapeArgs;c&&(c.attr({r:b.center[3]/2,start:d,end:d}),c.animate({r:a.r,start:a.start,end:a.end},b.options.animation))}),b.animate=null},setData:function(a,b){Q.prototype.setData.call(this,a,!1);this.processData();this.generatePoints();o(b,!0)&&this.chart.redraw()},generatePoints:function(){var a,b=0,c,d,e,f=this.options.ignoreHiddenPoint;Q.prototype.generatePoints.call(this);c=this.points;d=c.length;for(a=0;a<d;a++)e=c[a],b+=f&&!e.visible?0:e.y;this.total=b;for(a=0;a<d;a++)e=c[a],e.percentage=b>0?e.y/b*100:0,e.total=b},getCenter:function(){var a=this.options,b=this.chart,c=2*(a.slicedOffset||0),d,e=b.plotWidth-2*c,f=b.plotHeight-2*c,b=a.center,a=[o(b[0],"50%"),o(b[1],"50%"),a.size||"100%",a.innerSize||0],g=J(e,f),h;return Na(a,function(a,b){h=/%$/.test(a);d=b<2||b===2&&h;return(h?[e,f,g,g][b]*y(a)/100:a)+(d?c:0)})},translate:function(a){this.generatePoints();var b=0,c=this.options,d=c.slicedOffset,e=d+c.borderWidth,f,g,h,i=c.startAngle||0,j=this.startAngleRad=xa/180*(i-90),i=(this.endAngleRad=xa/180*((c.endAngle||i+360)-90))-j,k=this.points,l=c.dataLabels.distance,c=c.ignoreHiddenPoint,m,n=k.length,o;if(!a)this.center=a=this.getCenter();this.getX=function(b,c){h=R.asin((b-a[1])/(a[2]/2+l));return a[0]+(c?-1:1)*V(h)*(a[2]/2+l)};for(m=0;m<n;m++){o=k[m];f=j+b*i;if(!c||o.visible)b+=o.percentage/100;g=j+b*i;o.shapeType="arc";o.shapeArgs={x:a[0],y:a[1],r:a[2]/2,innerR:a[3]/2,start:t(f*1E3)/1E3,end:t(g*1E3)/1E3};h=(g+f)/2;h>0.75*i&&(h-=2*xa);o.slicedTranslation={translateX:t(V(h)*d),translateY:t(ba(h)*d)};f=V(h)*a[2]/2;g=ba(h)*a[2]/2;o.tooltipPos=[a[0]+f*0.7,a[1]+g*0.7];o.half=h<-xa/2||h>xa/2?1:0;o.angle=h;e=J(e,l/2);o.labelPos=[a[0]+f+V(h)*l,a[1]+g+ba(h)*l,a[0]+f+V(h)*e,a[1]+g+ba(h)*e,a[0]+f,a[1]+g,l<0?"center":o.half?"right":"left",h]}},setTooltipPoints:oa,drawGraph:null,drawPoints:function(){var a=this,b=a.chart.renderer,c,d,e=a.options.shadow,f,g;if(e&&!a.shadowGroup)a.shadowGroup=b.g("shadow").add(a.group);n(a.points,function(h){d=h.graphic;g=h.shapeArgs;f=h.shadowGroup;if(e&&!f)f=h.shadowGroup=b.g("shadow").add(a.shadowGroup);c=h.sliced?h.slicedTranslation:{translateX:0,translateY:0};f&&f.attr(c);d?d.animate(s(g,c)):h.graphic=d=b.arc(g).setRadialReference(a.center).attr(h.pointAttr[h.selected?"select":""]).attr({"stroke-linejoin":"round"}).attr(c).add(a.group).shadow(e,f);h.visible===!1&&h.setVisible(!1)})},sortByAngle:function(a,b){a.sort(function(a,d){return a.angle!==void 0&&(d.angle-a.angle)*b})},drawDataLabels:function(){var a=this,b=a.data,c,d=a.chart,e=a.options.dataLabels,f=o(e.connectorPadding,10),g=o(e.connectorWidth,1),h=d.plotWidth,d=d.plotHeight,i,j,k=o(e.softConnector,!0),l=e.distance,m=a.center,p=m[2]/2,q=m[1],u=l>0,s,v,w,x,y=[[],[]],z,A,E,H,C,D=[0,0,0,0],J=function(a,b){return b.y-a.y};if(a.visible&&(e.enabled||a._hasPointLabels)){Q.prototype.drawDataLabels.apply(a);n(b,function(a){a.dataLabel&&y[a.half].push(a)});for(H=0;!x&&b[H];)x=b[H]&&b[H].dataLabel&&(b[H].dataLabel.getBBox().height||21),H++;for(H=2;H--;){var b=[],I=[],G=y[H],K=G.length,F;a.sortByAngle(G,H-0.5);if(l>0){for(C=q-p-l;C<=q+p+l;C+=x)b.push(C);v=b.length;if(K>v){c=[].concat(G);c.sort(J);for(C=K;C--;)c[C].rank=C;for(C=K;C--;)G[C].rank>=v&&G.splice(C,1);K=G.length}for(C=0;C<K;C++){c=G[C];w=c.labelPos;c=9999;var N,L;for(L=0;L<v;L++)N=M(b[L]-w[1]),N<c&&(c=N,F=L);if(F<C&&b[C]!==null)F=C;else for(v<K-C+F&&b[C]!==null&&(F=v-K+C);b[F]===null;)F++;I.push({i:F,y:b[F]});b[F]=null}I.sort(J)}for(C=0;C<K;C++){c=G[C];w=c.labelPos;s=c.dataLabel;E=c.visible===!1?"hidden":"visible";c=w[1];if(l>0){if(v=I.pop(),F=v.i,A=v.y,c>A&&b[F+1]!==null||c<A&&b[F-1]!==null)A=c}else A=c;z=e.justify?m[0]+(H?-1:1)*(p+l):a.getX(F===0||F===b.length-1?c:A,H);s._attr={visibility:E,align:w[6]};s._pos={x:z+e.x+({left:f,right:-f}[w[6]]||0),y:A+e.y-10};s.connX=z;s.connY=A;if(this.options.size===null)v=s.width,z-v<f?D[3]=r(t(v-z+f),D[3]):z+v>h-f&&(D[1]=r(t(z+v-h+f),D[1])),A-x/2<0?D[0]=r(t(-A+x/2),D[0]):A+x/2>d&&(D[2]=r(t(A+x/2-d),D[2]))}}if(ua(D)===0||this.verifyDataLabelOverflow(D))this.placeDataLabels(),u&&g&&n(this.points,function(b){i=b.connector;w=b.labelPos;if((s=b.dataLabel)&&s._pos)E=s._attr.visibility,z=s.connX,A=s.connY,j=k?["M",z+(w[6]==="left"?5:-5),A,"C",z,A,2*w[2]-w[4],2*w[3]-w[5],w[2],w[3],"L",w[4],w[5]]:["M",z+(w[6]==="left"?5:-5),A,"L",w[2],w[3],"L",w[4],w[5]],i?(i.animate({d:j}),i.attr("visibility",E)):b.connector=i=a.chart.renderer.path(j).attr({"stroke-width":g,stroke:e.connectorColor||b.color||"#606060",visibility:E}).add(a.group);else if(i)b.connector=i.destroy()})}},verifyDataLabelOverflow:function(a){var b=this.center,c=this.options,d=c.center,e=c=c.minSize||80,f;d[0]!==null?e=r(b[2]-r(a[1],a[3]),c):(e=r(b[2]-a[1]-a[3],c),b[0]+=(a[3]-a[1])/2);d[1]!==null?e=r(J(e,b[2]-r(a[0],a[2])),c):(e=r(J(e,b[2]-a[0]-a[2]),c),b[1]+=(a[0]-a[2])/2);e<b[2]?(b[2]=e,this.translate(b),n(this.points,function(a){if(a.dataLabel)a.dataLabel._pos=null}),this.drawDataLabels()):f=!0;return f},placeDataLabels:function(){n(this.points,function(a){var a=a.dataLabel,b;if(a)(b=a._pos)?(a.attr(a._attr),a[a.moved?"animate":"attr"](b),a.moved=!0):a&&a.attr({y:-999})})},alignDataLabel:oa,drawTracker:F.prototype.drawTracker,drawLegendSymbol:G.prototype.drawLegendSymbol,getSymbol:oa};Y=ha(Q,Y);X.pie=Y;s(Highcharts,{Axis:eb,Chart:yb,Color:qa,Legend:fb,Pointer:xb,Point:Pa,Tick:Ma,Tooltip:wb,Renderer:Va,Series:Q,SVGElement:va,SVGRenderer:za,arrayMin:Ja,arrayMax:ua,charts:Ga,dateFormat:Ya,format:Ca,pathAnim:Ab,getOptions:function(){return L},hasBidiBug:Ub,isTouchDevice:Ob,numberFormat:Aa,seriesTypes:X,setOptions:function(a){L=x(L,a);Lb();return L},addEvent:K,removeEvent:$,createElement:U,discardElement:Ta,css:I,each:n,extend:s,map:Na,merge:x,pick:o,splat:ja,extendClass:ha,pInt:y,wrap:mb,svg:W,canvas:ca,vml:!W&&!ca,product:"Highcharts",version:"3.0.7"})})();

/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */

(function defineMustache(global,factory){if(typeof exports==="object"&&exports&&typeof exports.nodeName!=="string"){factory(exports)}else if(typeof define==="function"&&define.amd){define(["exports"],factory)}else{global.Mustache={};factory(global.Mustache)}})(this,function mustacheFactory(mustache){var objectToString=Object.prototype.toString;var isArray=Array.isArray||function isArrayPolyfill(object){return objectToString.call(object)==="[object Array]"};function isFunction(object){return typeof object==="function"}function typeStr(obj){return isArray(obj)?"array":typeof obj}function escapeRegExp(string){return string.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function hasProperty(obj,propName){return obj!=null&&typeof obj==="object"&&propName in obj}function primitiveHasOwnProperty(primitive,propName){return primitive!=null&&typeof primitive!=="object"&&primitive.hasOwnProperty&&primitive.hasOwnProperty(propName)}var regExpTest=RegExp.prototype.test;function testRegExp(re,string){return regExpTest.call(re,string)}var nonSpaceRe=/\S/;function isWhitespace(string){return!testRegExp(nonSpaceRe,string)}var entityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function escapeHtml(string){return String(string).replace(/[&<>"'`=\/]/g,function fromEntityMap(s){return entityMap[s]})}var whiteRe=/\s*/;var spaceRe=/\s+/;var equalsRe=/\s*=/;var curlyRe=/\s*\}/;var tagRe=/#|\^|\/|>|\{|&|=|!/;function parseTemplate(template,tags){if(!template)return[];var sections=[];var tokens=[];var spaces=[];var hasTag=false;var nonSpace=false;function stripSpace(){if(hasTag&&!nonSpace){while(spaces.length)delete tokens[spaces.pop()]}else{spaces=[]}hasTag=false;nonSpace=false}var openingTagRe,closingTagRe,closingCurlyRe;function compileTags(tagsToCompile){if(typeof tagsToCompile==="string")tagsToCompile=tagsToCompile.split(spaceRe,2);if(!isArray(tagsToCompile)||tagsToCompile.length!==2)throw new Error("Invalid tags: "+tagsToCompile);openingTagRe=new RegExp(escapeRegExp(tagsToCompile[0])+"\\s*");closingTagRe=new RegExp("\\s*"+escapeRegExp(tagsToCompile[1]));closingCurlyRe=new RegExp("\\s*"+escapeRegExp("}"+tagsToCompile[1]))}compileTags(tags||mustache.tags);var scanner=new Scanner(template);var start,type,value,chr,token,openSection;while(!scanner.eos()){start=scanner.pos;value=scanner.scanUntil(openingTagRe);if(value){for(var i=0,valueLength=value.length;i<valueLength;++i){chr=value.charAt(i);if(isWhitespace(chr)){spaces.push(tokens.length)}else{nonSpace=true}tokens.push(["text",chr,start,start+1]);start+=1;if(chr==="\n")stripSpace()}}if(!scanner.scan(openingTagRe))break;hasTag=true;type=scanner.scan(tagRe)||"name";scanner.scan(whiteRe);if(type==="="){value=scanner.scanUntil(equalsRe);scanner.scan(equalsRe);scanner.scanUntil(closingTagRe)}else if(type==="{"){value=scanner.scanUntil(closingCurlyRe);scanner.scan(curlyRe);scanner.scanUntil(closingTagRe);type="&"}else{value=scanner.scanUntil(closingTagRe)}if(!scanner.scan(closingTagRe))throw new Error("Unclosed tag at "+scanner.pos);token=[type,value,start,scanner.pos];tokens.push(token);if(type==="#"||type==="^"){sections.push(token)}else if(type==="/"){openSection=sections.pop();if(!openSection)throw new Error('Unopened section "'+value+'" at '+start);if(openSection[1]!==value)throw new Error('Unclosed section "'+openSection[1]+'" at '+start)}else if(type==="name"||type==="{"||type==="&"){nonSpace=true}else if(type==="="){compileTags(value)}}openSection=sections.pop();if(openSection)throw new Error('Unclosed section "'+openSection[1]+'" at '+scanner.pos);return nestTokens(squashTokens(tokens))}function squashTokens(tokens){var squashedTokens=[];var token,lastToken;for(var i=0,numTokens=tokens.length;i<numTokens;++i){token=tokens[i];if(token){if(token[0]==="text"&&lastToken&&lastToken[0]==="text"){lastToken[1]+=token[1];lastToken[3]=token[3]}else{squashedTokens.push(token);lastToken=token}}}return squashedTokens}function nestTokens(tokens){var nestedTokens=[];var collector=nestedTokens;var sections=[];var token,section;for(var i=0,numTokens=tokens.length;i<numTokens;++i){token=tokens[i];switch(token[0]){case"#":case"^":collector.push(token);sections.push(token);collector=token[4]=[];break;case"/":section=sections.pop();section[5]=token[2];collector=sections.length>0?sections[sections.length-1][4]:nestedTokens;break;default:collector.push(token)}}return nestedTokens}function Scanner(string){this.string=string;this.tail=string;this.pos=0}Scanner.prototype.eos=function eos(){return this.tail===""};Scanner.prototype.scan=function scan(re){var match=this.tail.match(re);if(!match||match.index!==0)return"";var string=match[0];this.tail=this.tail.substring(string.length);this.pos+=string.length;return string};Scanner.prototype.scanUntil=function scanUntil(re){var index=this.tail.search(re),match;switch(index){case-1:match=this.tail;this.tail="";break;case 0:match="";break;default:match=this.tail.substring(0,index);this.tail=this.tail.substring(index)}this.pos+=match.length;return match};function Context(view,parentContext){this.view=view;this.cache={".":this.view};this.parent=parentContext}Context.prototype.push=function push(view){return new Context(view,this)};Context.prototype.lookup=function lookup(name){var cache=this.cache;var value;if(cache.hasOwnProperty(name)){value=cache[name]}else{var context=this,intermediateValue,names,index,lookupHit=false;while(context){if(name.indexOf(".")>0){intermediateValue=context.view;names=name.split(".");index=0;while(intermediateValue!=null&&index<names.length){if(index===names.length-1)lookupHit=hasProperty(intermediateValue,names[index])||primitiveHasOwnProperty(intermediateValue,names[index]);intermediateValue=intermediateValue[names[index++]]}}else{intermediateValue=context.view[name];lookupHit=hasProperty(context.view,name)}if(lookupHit){value=intermediateValue;break}context=context.parent}cache[name]=value}if(isFunction(value))value=value.call(this.view);return value};function Writer(){this.cache={}}Writer.prototype.clearCache=function clearCache(){this.cache={}};Writer.prototype.parse=function parse(template,tags){var cache=this.cache;var cacheKey=template+":"+(tags||mustache.tags).join(":");var tokens=cache[cacheKey];if(tokens==null)tokens=cache[cacheKey]=parseTemplate(template,tags);return tokens};Writer.prototype.render=function render(template,view,partials,tags){var tokens=this.parse(template,tags);var context=view instanceof Context?view:new Context(view);return this.renderTokens(tokens,context,partials,template)};Writer.prototype.renderTokens=function renderTokens(tokens,context,partials,originalTemplate){var buffer="";var token,symbol,value;for(var i=0,numTokens=tokens.length;i<numTokens;++i){value=undefined;token=tokens[i];symbol=token[0];if(symbol==="#")value=this.renderSection(token,context,partials,originalTemplate);else if(symbol==="^")value=this.renderInverted(token,context,partials,originalTemplate);else if(symbol===">")value=this.renderPartial(token,context,partials,originalTemplate);else if(symbol==="&")value=this.unescapedValue(token,context);else if(symbol==="name")value=this.escapedValue(token,context);else if(symbol==="text")value=this.rawValue(token);if(value!==undefined)buffer+=value}return buffer};Writer.prototype.renderSection=function renderSection(token,context,partials,originalTemplate){var self=this;var buffer="";var value=context.lookup(token[1]);function subRender(template){return self.render(template,context,partials)}if(!value)return;if(isArray(value)){for(var j=0,valueLength=value.length;j<valueLength;++j){buffer+=this.renderTokens(token[4],context.push(value[j]),partials,originalTemplate)}}else if(typeof value==="object"||typeof value==="string"||typeof value==="number"){buffer+=this.renderTokens(token[4],context.push(value),partials,originalTemplate)}else if(isFunction(value)){if(typeof originalTemplate!=="string")throw new Error("Cannot use higher-order sections without the original template");value=value.call(context.view,originalTemplate.slice(token[3],token[5]),subRender);if(value!=null)buffer+=value}else{buffer+=this.renderTokens(token[4],context,partials,originalTemplate)}return buffer};Writer.prototype.renderInverted=function renderInverted(token,context,partials,originalTemplate){var value=context.lookup(token[1]);if(!value||isArray(value)&&value.length===0)return this.renderTokens(token[4],context,partials,originalTemplate)};Writer.prototype.renderPartial=function renderPartial(token,context,partials){if(!partials)return;var value=isFunction(partials)?partials(token[1]):partials[token[1]];if(value!=null)return this.renderTokens(this.parse(value),context,partials,value)};Writer.prototype.unescapedValue=function unescapedValue(token,context){var value=context.lookup(token[1]);if(value!=null)return value};Writer.prototype.escapedValue=function escapedValue(token,context){var value=context.lookup(token[1]);if(value!=null)return mustache.escape(value)};Writer.prototype.rawValue=function rawValue(token){return token[1]};mustache.name="mustache.js";mustache.version="3.0.0";mustache.tags=["{{","}}"];var defaultWriter=new Writer;mustache.clearCache=function clearCache(){return defaultWriter.clearCache()};mustache.parse=function parse(template,tags){return defaultWriter.parse(template,tags)};mustache.render=function render(template,view,partials,tags){if(typeof template!=="string"){throw new TypeError('Invalid template! Template should be a "string" '+'but "'+typeStr(template)+'" was given as the first '+"argument for mustache#render(template, view, partials)")}return defaultWriter.render(template,view,partials,tags)};mustache.to_html=function to_html(template,view,partials,send){var result=mustache.render(template,view,partials);if(isFunction(send)){send(result)}else{return result}};mustache.escape=escapeHtml;mustache.Scanner=Scanner;mustache.Context=Context;mustache.Writer=Writer;return mustache});


//::===========================================================================
//:: Namespaces setup
//::---------------------------------------------------------------------------

if (typeof MPage !== 'undefined') {
    if (typeof chla === 'undefined')
        MPage.namespace("chla");
}
if (typeof chla.eApps == 'undefined') {
    chla.eApps = {};
}

MPage.namespace("Child");
if (Child == undefined){ var Child = new Object();}

var DOMAIN_NAME = '';

//::===========================================================================
//:: CC - ChlaStdClass Section  -----------------------------------------------
//::===========================================================================
if(typeof ChlaStdClass == 'undefined' ){
    (function() {
        "use strict";
        var arrayPrototype = Array.prototype,
            supportsIndexOf = 'indexOf' in arrayPrototype,
            i,
            enumerables,
            enumTest = {
                toString: 1
            };
        for (i in enumTest) {
            enumerables = null;
        }
        if (enumerables) {
            enumerables = [
                'hasOwnProperty',
                'valueOf',
                'isPrototypeOf',
                'propertyIsEnumerable',
                'toLocaleString',
                'toString',
                'constructor'];
        }
        function ChlaStdClass() {}
        ChlaStdClass.emptyFn = function () {};
        ChlaStdClass.extend  = function( Instance ) {
            if ( typeof Instance === 'undefined' ) {
                var SuperConstructor = this;
                Instance = function()
                {
                    return SuperConstructor.apply( this, arguments );
                };
            }
            else if ( !ChlaStdClass.isCallable( Instance ) ){
                throw new Error( "Expecting function (constructor)" );
            }
            Instance.OriginalPrototype = this.prototype;
            function Parent() {}
            Parent.prototype   = Instance.OriginalPrototype;
            Instance.prototype = new Parent();
            Instance.prototype.constructor = Instance;
            if ( ChlaStdClass.isCallable( this.mixin ) ){
                this.mixin( Instance );
            } else {
                ChlaStdClass.mixin( Instance );
            }
            return Instance;
        };
        ChlaStdClass.implement = function( /* ... */ ) {
            var i = 0,
                i_max = arguments.length,
                prop;
            for ( ; i < i_max; ++i ) {
                if ( !( arguments[i] instanceof Object ) )
                    continue;
                for ( prop in arguments[i] ){
                    if ( arguments[i][prop] == null ) {
                        continue;
                    }
                    this.prototype[prop] = arguments[i][prop];
                }
            }
            return this;
        };
        ChlaStdClass.applyProperties = function(object, config, defaults) {
            var i,
                j,
                k;
            if (object && defaults && typeof defaults === 'object') {
                for (i in defaults) {
                    object[i] = defaults[i];
                }
                if (enumerables) {
                    for (j = enumerables.length; j--;) {
                        k = enumerables[j];
                        if (defaults.hasOwnProperty(k)) {
                            object[k] = defaults[k];
                        }
                    }
                }
            }
            if (object && config && typeof config === 'object') {
                for (i in config) {
                    object[i] = config[i];
                }
                if (enumerables) {
                    for (j = enumerables.length; j--;) {
                        k = enumerables[j];
                        if (config.hasOwnProperty(k)) {
                            object[k] = config[k];
                        }
                    }
                }
            }
            return object;
        };
        ChlaStdClass.mergeArray = function() {
            var args = [].slice.call(arguments),
                array = [],
                i,
                ln;
            for (i = 0, ln = args.length; i < ln; i++) {
                array = array.concat(args[i]);
            }
            return ChlaStdClass.uniqueArray(array);
        };
        ChlaStdClass.uniqueArray = function(array) {
            var clone = [],
                i = 0,
                ln = array.length,
                item;
            for (; i < ln; i++) {
                item = array[i];
                if (ChlaStdClass.indexOfArray(clone, item) === -1) {
                    clone.push(item);
                }
            }
            return clone;
        };
        ChlaStdClass.indexOfArray = supportsIndexOf ? function(array, item, from) {
            return arrayPrototype.indexOf.call(array, item, from);
        } : function(array, item, from) {
            var i, length = array.length;

            for (i = (from < 0) ? Math.max(0, length + from) : from || 0; i < length; i++) {
                if (array[i] === item) {
                    return i;
                }
            }
            return -1;
        };
        ChlaStdClass.neo = function() {
            function Instance() {}
            Instance.prototype = this.prototype;
            var instance = new Instance();
            this.apply( instance, arguments );
            return instance;
        };
        ChlaStdClass.mixin = function( ctor ){
            if ( !ChlaStdClass.isCallable( ctor ) ){
                throw new Error( "Expecting function" );
            }
            ctor.extend = this.extend;
            ctor.implement = this.implement;
            ctor.neo = this.neo;
            ctor.applyProperties = this.applyProperties;
            return ctor;
        };
        ChlaStdClass.cleanup = function( ctor )	{
            if ( !ChlaStdClass.isCallable( ctor ) )	{
                throw new Error( "Expecting function" );
            }
            if ( ctor.extend === this.extend ){
                delete ctor.extend;
            }
            if ( ctor.implement === this.implement ){
                delete ctor.implement;
            }
            if ( ctor.neo === this.neo ){
                delete ctor.neo;
            }
            if ( ctor.applyProperties === this.applyProperties ){
                delete ctor.applyProperties;
            }
            return ctor;
        };
        ChlaStdClass.isCallable = function( thing )	{
            return !!( thing && thing.constructor && thing.call && thing.apply );
        };
        ChlaStdClass.prototype.toString = function()	{
            return "[object ChlaStdClass]";
        };
        ChlaStdClass.isEmpty = function(value, allowEmptyString) {
            return (arguments[0] === undefined) ||
                (value === null) ||
                (!allowEmptyString ? value === '' : false) ||
                (ChlaStdClass.isArray(value) && value.length === 0);
        };
        ChlaStdClass.isArray = ('isArray' in Array) ? Array.isArray : function(value) {
            return [].toString.call(value) === '[object Array]';
        };
        ChlaStdClass.isDefined = function(value) {
            return typeof arguments[0] !== 'undefined';
        };
        ChlaStdClass.safeRead = function() {
            var current,
                getIt,
                obj,
                prop,
                props,
                val,
                i,
                len,
                dftVal = '';
            if (typeof arguments[0].obj == 'undefined'){
                obj = arguments[0];
            }else {
                // arguments { {obj:'',defaultvalue:''},'x','y',....}
                obj = arguments[0].obj;
                dftVal = arguments[0].defaultvalue;
            }
            props = (2 <= arguments.length ? [].slice.call(arguments, 1) : [] ) ;
            getIt = function(pObj, pProp) {
                if ((pObj != null ? pObj[pProp] : void 0) == null) {
                    return;
                }
                return pObj[pProp];
            };
            current = obj;
            for (i = 0, len = props.length; i < len; i++) {
                prop = props[i];
                val = getIt(current, prop);

                if ( null == val) {
                    return dftVal;
                } else {
                    current = val;
                }
            }
            return current;
        };
        ChlaStdClass.chlaNS = function (strVal, obj) {
            var parts = strVal.split('.'),
                current = null,
                container = window;
            while(parts.length > 0) {
                current = parts.shift();
                if (parts.length === 0) {
                    container[current] = obj || container[current] || {};
                    return container[current];
                } else {
                    container[current] = container[current] || {};
                }
                container = container[current];
            }
            return obj;
        };
        if ( typeof module !== 'undefined' ) {
            module.exports = ChlaStdClass;
        } else if ( typeof window !== 'undefined' ) {
            window.ChlaStdClass = ChlaStdClass;
        } else {
            return ChlaStdClass;
        }
    }());
}

(function (global) {
    if(typeof global !== "undefined") {
        if (ChlaStdClass.isDefined(global.chlaNs) === false) {
            global.chlaNs = ChlaStdClass.chlaNS;
        }
        if (ChlaStdClass.isDefined(global.chlaNsMgr) === false) {
            global.chlaNsMgr = {
                chlaNs: window.chlaNs,
                aliasDirector: function (namespace_label) {
                    return this.chlaNs(namespace_label);
                }
            };
        }
    }
}(this));

// Variables
var cleanuplist = {};
var imgPath ='I:\\WININTEL\\static_content\\ChlaEapps\\static_content\\custom_mpage_content\\custom-components\\eAppsResources\\images\\';
//I:\\WININTEL\\static_content\\ChlaEapps\\static_content\\custom_mpage_content\\custom-components\\eAppsResources\\
var imgPathExtJS  = 'I:\\WININTEL\\static_content\\ChlaEapps\\static_content\\custom_mpage_content\\custom-components\\eAppsResources\\ext-4.2.0\\resources\\themes\\images\\default/';
var g_iosColumns = null;
var g_iosGrid = null;
var aryIntakeRate = [];
var aryUrineRate = [];
var aryMixedStool = [];
var last_stool = null;

//::===========================================================================
//:: CC - Variables Section Start - eApps Lib 1.0
//::---------------------------------------------------------------------------
chla.eApps.Vars = {
    // These values must be altered to match the hosting environment
    cleanuplist: {},
    imgPath : 'I:\\custom_mpage_content\\custom-components\\FrameWorks\\images\\',
    imgPathExtJS : 'I:\\custom_mpage_content\\custom-components\\FrameWorks\\ext-4.2.0\\resources\\themes\\images\\default\\',
//    ServerURL : 'http://tchlaeappsdev01',
//    RLWebserviceURL : '/Dev_RLWebService_CK',
    ServerURL : 'http://Chlampageservice.cernerasp.com',
    RLWebserviceURL : '/RLWebService2',
//    ServerURL : 'http://10.100.30.76',
//    RLWebserviceURL : '/RLWebServiceCC',
    transparentSpacer : 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAH0lEQVQ4y2P8//8/AzUAEwOVwKhBowaNGjRq0GAxCACzBwMhgtH1aQAAAABJRU5ErkJggg==',
    _tmplCache : {},
    _profiler : {},
    LearningAndCareNeedsAssessmentPowerForm_ID: '397861197',
    DischargeCriteriaPowerForm_ID: '421650037',
    educationnote_cd: 367287082,
    admissioneducationnote_cd: 324386751 ,
    niccueducationpnote_cd: 272789335 ,
    cardiologyeducationnote_cd: 329716968 ,
    H2_Tmpl : [
        '<div id="<#=idLabel#>',
        '_DivSection" class="section"><h2 class="sec-hd h2a-marker">',
        '<span class="sec-hd-tgl h2b-marker" title="icon toggle open">-</span>',
        '<span class="sec-title "><#=TLabel1#></span></h2><div id="',
        //'<span id="mainCompMenu_<#=idLabel#>" class="opts-menu menu-hide">&nbsp;</span>',
        '<#=idLabel#>_DivSecContent" class="sec-content">',
        '<div id="<#=idLabel#>" class="content-body"><#=ContentBody#></div></div></div>'
    ],
    H5_Tmpl : [
        '<div id="',
        '<#=idLabel#>',
        '_DivSubSec" class="sub-sec"><h2 class="fo-sub-sec-hd fo-cat-type h5a-marker">',
        '<span class="sub-sec-hd-tgl h5b-marker <#=SectionClosed#>"',
        ' style="<#=CustIcon#>" title="icon toggle open">-</span>',
        '<span class="sub-sec-title  <#=Disabled_Lbl#> " style="background-image: none;">',
        '<#=TLabel1#>',
        '<#=SectionCnt#>',
        '</span></h2><div id="',
        '<#=idLabel#>',
        '_DivSubSecContent" class="sub-sec-content <#=SectionClosed#>">',
        '<div id="',
        '<#=idLabel#>',
        '" class="content-body">',
        '<#=ContentBody#>',
        '</div></div></div>'
    ],
    H6_Tmpl : [
        '<div id="',
        '<#=idLabel#>',
        '_DivSubSec1" class="sub-sec"><h2 class="fo-sub-sec-hd h6a-marker">',
        '<span class="sub-sec-hd-tgl h6b-marker <#=SectionClosed#>"',
        ' style="<#=CustIcon#> <#=CustMargin#>" title="icon toggle open">-</span>',
        '<span class="sub-sec-title  <#=Disabled_Lbl#>" style="background-image: none;">',
        '<#=TLabel1#>',
        '<#=SectionCnt#>',
        '</span></h2><div id="',
        '<#=idLabel#>',
        '_DivSubSecContent" class="sub-sec-content <#=SectionClosed#>">',
        '<div id="',
        '<#=idLabel#>',
        '" class="content-body">',
        '<#=ContentBody#>',
        '</div></div></div>'
    ]
};
//::===========================================================================
//:: CC - Functions  General    ---------------
//::---------------------------------------------------------------------------
chla.eApps.Funcs = {
    /**
     * Convert a date to a fixed format with detail time.
     * @param {String} data The date will be converted  /Date(2014-02-11T14:59:00.000-07:00)\/
     * @return The result of the fixed format   mm/DD/YYYY HH:MM
     * @type String
     */
    convertDate :  function (data){
        if (data == undefined) return '--';
        if (data == '') return '--';
        var year = data.substring(6, 10);
        if (year == '0000') {
            return '--';
        }
        var month = data.substring(11, 13);
        var date = data.substring(14, 16);
        var time = data.substring(17, 22);
        return month + "/" + date + "/" + year + " " + time;
    },

    /**
     * Convert a date to a fixed format .
     * @param {String} data The date will be converted  \/Date(2014-02-11T14:59:00.000-07:00)\/
     * @return The result of the fixed format    MM/DD/YYYY
     * @type String
     */
    convertDate2 :  function (data){
        if (data == '')
            return '';
        var year = data.substring(6, 10);
        if (year == '0000') {
            return '';
        }
        var month = data.substring(11, 13);
        var date = data.substring(14, 16);
        return month + "/" + date + "/" + year;
    },

    /* Convert a date to a fixed format.
     *  @param {String} data The date will be converted   0:2013071612300000:0.000000:0:0
     * @return The result of the fixed format    MM/DD/YYYY HH:mm
     * @type String
     */
    convertDate3 :  function (data){
        if (data == '')
            return '';
        var year = data.substring(2, 6);
        if (year == '0000') {
            return '';
        }
        var month = data.substring(6, 8);
        var date = data.substring(8, 10);
        var hour = data.substring(10, 12);
        var minute = data.substring(12, 14);
        return month + "/" + date + "/" + year + " " + hour + ":" + minute;
    },
    PowerNoteMPageUtils: function (x,y,z) {
        var P = window.external.DiscernObjectFactory("POWERNOTE");
        P.ModifyExistingNoteByEventId(x,y,z);
    },
    LaunchRDO: function () {
        APPLINK(0, "Powerchart.exe", "/ORGANIZERTAB=^Resource Directory Organizer^")
    },
//::===========================================================================
//:: <summary>
//:: Client side template parser that uses <#= #>; and <# code #> expressions.
//:: and # # code blocks for template expansion.
//:: NOTE: FIXED chokes on single quotes in the document in some situations
//::       use &amp;rsquo; for literals in text and avoid any single quote
//::       attribute delimiters.
//:: </summary>
//:: <param name="str" type="string">The text of the template to expand</param>
//:: <param name="data" type="var">
//:: Any data that is to be merged. Pass an object and
//:: that object's properties are visible as variables.
//:: </param>
//:: <returns type="string" />
//::===========================================================================
    parseTemplate : function(str, obj) {
        var err = "";
        try {
            var func =  chla.eApps.Vars._tmplCache[str];
            if (!func) {
                var strFunc =
                        "var p=[],print=function(){p.push.apply(p,arguments);};" +
                        "with(obj){p.push('" +
                        str.replace(/[\r\t\n]/g, " ")
                        .replace(/'(?=[^#]*#>)/g, "\t")
                        .split("'").join("\\'")
                        .split("\t").join("'")
                        .replace(/<#=(.+?)#>/g, "',$1,'")
                        .split("<#").join("');")
                        .split("#>").join("p.push('")
                        + "');}return p.join('');";
                //alert('strFunc <br/> ' + strFunc);
                //chla.eAppsUtil.Logger.LogInfo( 'strFunc' + strFunc.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;'));
                func = new Function("obj", strFunc);
                chla.eApps.Vars._tmplCache[str] = func;
            }
            return func(obj);
        } catch (e) { err = e.message;
            alert('err - parseTemplate: ' + err);
            chla.eAppsUtil.Logger.LogError(err);
        }
        return "< # ERROR: " + err.htmlEncode() + " # >";
    },
    LogProfile :
        function (label) {
            var currentTime = new Date(); //record the current time when profile() is executed
            if (label == undefined || label == '') {
                chla.eAppsUtil.Logger.LogError('<b>ERROR:</b> Please specify a label for your eApps profile statement');
            } else if (chla.eApps.Vars._profiler[label]) {
                chla.eAppsUtil.Logger.LogInfo('profile[ ' + label + '] :END   ' + (currentTime - chla.eApps.Vars._profiler[label]) + 'ms');
                delete chla.eApps.Vars._profiler[label];
            } else {
                chla.eApps.Vars._profiler[label] = currentTime;
                chla.eAppsUtil.Logger.LogInfo('profile[ ' + label + '] :START');
            }
            return currentTime;
        },
    HtmlLogFormatter: function(HtmlStr) {
        return HtmlStr.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
//     },
//    djb2Code: function(str){
// 	  var hash = 5381;
//         var i;
// 	  for (i = 0; i < str.length; i++) {
// 	    char = str.charCodeAt(i);
// 	    hash = ((hash << 5) + hash) + char; /* hash * 33 + c */
// 	  }
// 	  return hash;
    }



};
chla.eApps.SectionHeader = function(){
    this.idLabel =  '';
    this.TLabel1 =  '';
    this.SectionCnt =  0;
    this.SectionCntVal =  0;
    this.SectionClosed = '';
    this.Disabled_Lbl = '';
    this.CustIcon = '';
    this.CustMargin = 'margin-left:15px;'
    this.HideIfEmpty = 'false';
    this.ContentBody = '';
    this.UnformatBodyVal = '';
};

chla.eApps.SectionHeaderCtl = function(){
    this.idLabel =  '';
    this.TLabel1 =  '';
    this.SectionCnt = 'auto';
    this.SectionDivID =  '';
    this.SectionCntVal =  0;
    this.SectionClosed = 'auto';
    this.Disabled_Lbl = 'auto';
    this.CustIcon = 'none';
    this.CustMargin = 'margin-left:15px;'
    this.HideIfEmpty = 'false';
    this.ContentBody = '';
    this.UnformatBodyVal = '';
    this.TemplateType = 'H5';
};
chla.eApps.SectionHeaderCtl.prototype.generateHTML = function (){
    var secObj = this;
    var resultVal ;
    var sectionTemplate = chla.eApps.Vars.H2_Tmpl.join('');

    secObj.SectionDivID = 'div#' + secObj.idLabel + '_DivSection H2.h2a-marker';
    if (secObj.TemplateType == 'H6') {
        sectionTemplate = chla.eApps.Vars.H6_Tmpl.join('');
        secObj.SectionDivID = 'div#' + secObj.idLabel +  '_DivSubSec1 H2.h6a-marker';
    }else if ( secObj.TemplateType == 'H5') {
        sectionTemplate = chla.eApps.Vars.H5_Tmpl.join('');
        secObj.SectionDivID = 'div#' + secObj.idLabel +  '_DivSubSec H2.h5a-marker';
    }
    if (secObj.SectionCnt == 'auto'  ){
        secObj.SectionCnt = ' (' + secObj.SectionCntVal + ')';
    } else {
        secObj.SectionCnt = ''
    }
    if (secObj.SectionClosed == 'auto' ){
        secObj.SectionClosed = (secObj.SectionCntVal == 0 )? 'closed' : '';
    } else if (secObj.SectionClosed != 'closed') {
        secObj.SectionClosed = ''
    }
    if (secObj.Disabled_Lbl == 'auto'){
        secObj.Disabled_Lbl = (secObj.SectionCntVal == 0 ) ? 'grey': '';
    } else {
        secObj.Disabled_Lbl = '';
    }
    if (secObj.CustIcon != 'none'){
        secObj.CustIcon = 'background-image:none;'
    } else {
        secObj.CustIcon = '';
    }
    if (secObj.HideIfEmpty != 'false'){
        resultVal = '';
    } else {
        resultVal =   chla.eApps.Funcs.parseTemplate(sectionTemplate,secObj);
    }
    return  resultVal ;
};
chla.eApps.SectionHeaderCtl.prototype.initValues = function (o){
    var secObj = this;
    for (var m in o) {
        if (!o.hasOwnProperty(m)) {
            continue;
        }
        secObj[m] = o[m];
    }
};
//::===========================================================================
//:: CC - Functionality  CSSBehaviors    ---------------
//::---------------------------------------------------------------------------
chla.eApps.CSSBehaviors =  function() {
    this.CCSBehaviorObj = null ;
    this.BtnSaveLbl ='';
    this.bFinished = false;
    ;
};

chla.eApps.CSSBehaviors.prototype = {
    SingleH2H5H6SectionToggle : function(){
        $(this).find('span.sub-sec-hd-tgl').toggleClass('closed');
        $(this).next().toggleClass('closed');
        return false;
    },
    SingleH2SectionToggle : function(){
        $(this).find('span.h2b-marker').toggleClass('closed');
        $(this).next().toggleClass('closed');
        return false;
    },
    SingleH5SectionToggle : function(){
        $(this).find('span.h5b-marker').toggleClass('closed');
        $(this).next().toggleClass('closed');
        return false;
    },
    SingleH6SectionToggle : function(){
        $(this).find('span.h6b-marker').toggleClass('closed');
        $(this).next().toggleClass('closed');
        return false;
    },
    InitPopUpsDiv :  function (dataResponse,  argHoverelement, alignPos) {
        var Parent = this ;
        var alignPostion = 0 ;
        var alignPostion2 = 0 ;
        Parent.hoverContent = dataResponse;
        if (alignPos != null){
            if (alignPos == "L") alignPostion = -320;
        }
        if (alignPos != null){
            if (alignPos == "T") alignPostion2 = -50;
        }
        // add the class of hover to all elements  id:hoverelement'
        $(argHoverelement).hover( function (args) {
            // Hover over code
            $('<div class="eapps-tooltip"></div>')
            .html(Parent.hoverContent)
            .appendTo('body')
            .fadeIn('slow');
        }, function() {
            // Hover out code
            $('.eapps-tooltip').remove();
        }).mousemove(function(e) {
            var mousex = e.pageX + (20  + alignPostion); //Get X coordinates
            var mousey = e.pageY + (10  + alignPostion2); //Get Y coordinates
            $('.eapps-tooltip')
            .css({ top: mousey, left: mousex })
        }) ;
    }
};
//::===========================================================================
//:: CC - Functionality  SaveButtonBehaviors    ---------------
//::---------------------------------------------------------------------------
chla.eApps.SaveButtonBehavior  = {
    enable_disable_status_reset : function(SaveBtnID, SavedStatus) {
        var input_pseudoclass = SaveBtnID;
        if (SavedStatus == 'ENABLE' ) {
            $(input_pseudoclass).text('  Save   ');
            $(input_pseudoclass).attr('class','eappsBtnGrey');
            $(input_pseudoclass).attr('disabled',false);
        } else if (SavedStatus == 'OK') {
            $(input_pseudoclass).text('  Saved ');
            $(input_pseudoclass).attr('class','eappsBtnGreyDisabled');
            //$(input_pseudoclass).attr('disabled',true);
        } else if (SavedStatus == 'FAIL') {
            $(input_pseudoclass).text('Not Saved');
            $(input_pseudoclass).attr('class','eappsBtnRed');
        } else if (SavedStatus == 'RESET') {
            $(input_pseudoclass).text('  Save   ');
            $(input_pseudoclass).attr('class','eappsBtnGreyDisabled');
            //$(input_pseudoclass).attr('disabled',true);
        } else   {
            chla.eAppsUtil.Logger.LogError('Unknown Save button function:  ' + SavedStatus);
        }
    },
    grey_yellow_green_red_reset : function(SaveBtnID, SavedStatus) {
        var input_pseudoclass = SaveBtnID;
        if (SavedStatus == 'OK' ) {
            $(input_pseudoclass).text('Saved  ');
            $(input_pseudoclass).attr('class','eappsBtnLightGreen');
        } else if (SavedStatus == 'RESET') {
            $(input_pseudoclass).text('  Save  ');
            $(input_pseudoclass).attr('class','eappsBtnGrey');
        } else if (SavedStatus == 'CHANGED') {
            $(input_pseudoclass).text(' Changed ');
            $(input_pseudoclass).attr('class','eappsBtnYellow');
        } else if (SavedStatus == 'FAIL') {
            $(input_pseudoclass).text('Not Saved');
            $(input_pseudoclass).attr('class','eappsBtnRed');
        } else   {
            chla.eAppsUtil.Logger.LogError('Unknown Save button function:  ' + SavedStatus);
        }
    }
};
//::===========================================================================
//:: CC - Functionality  CCLRequest    ---------------
//::---------------------------------------------------------------------------
chla.eApps.CCLRequest = {
    BtnSaveBehavior :  function() {
        this.CCLreqObj = null ;
        this.BtnSaveLbl ='';
        this.bFinished = false;
        this.ObjectName = '';
        this.XmtCycleCnt = 0;
    }
};
//::===========================================================================

chla.eApps.CCLRequest.BtnSaveBehavior.prototype  = {
    CallBackOperation : { notImplemented: true},
    BtnSaveBehaviorFunc : { notImplemented: true},
    DataTransfer :  function  ( Parent, CCLreport,CCLparms,BtnSaveLbl){
        var Parent = this;
        try {
            if (this.CCLreqObj == null){
                this.CCLreqObj = new XMLCclRequest();
            }
            chla.eAppsUtil.Logger.LogInfo(BtnSaveLbl + ': Save button function');
            if (this.XmtCycleCnt == 0) {
                this.CCLreqObj.onreadystatechange = function() {
                    var fName = 'CCLreqObj.onreadystatechange'  ;
                    var BtnSaveState = '';
                    var LogMsg ='';
                    var bFinished = false;
                    var msgData = '';
                    var jsonData = '';
                    chla.eAppsUtil.Logger.LogInfo('Parent fn onreadystatechange: ' + Parent.ObjectName );
                    BtnSaveState = 'OK';
                    LogMsg ='';
                    bFinished = false;
                    msgData = '';
                    jsonData = '';
                    // Set the response CallBack Function
                    switch(Parent.CCLreqObj.readyState){
                        //0: request not initialized
                        case 0:
                            break;
                        //1: server connection established
                        case 1:
                            break;
                        //2: request received
                        case 2:
                            break;
                        //3: processing request
                        case 3:
                            break;
                        //4: request finished and response is ready
                        case 4:
                            if (Parent.CCLreqObj.status == 200) {
                                msgData = Parent.CCLreqObj.responseText;

                                if (msgData != null) {
                                    jsonData = eval('(' + msgData + ')');
                                }
                                if (jsonData) {
                                    var temp = jsonData.RPTDATA;
                                    if (temp.ERR_STAT = 'FALSE') {
                                        BtnSaveState = 'OK';
                                        LogMsg = Parent.BtnSaveLbl + ': save OK ';
                                    }else  {
                                        BtnSaveState = 'FAIL';
                                        LogMsg = Parent.BtnSaveLbl + ': save FAIL ' + msgData ;
                                    }
                                }
                            } else {
                                BtnSaveState = 'FAIL';
                                LogMsg = this.BtnSaveLbl + ': save FAIL : readyState/status = ' +
                                    this.CCLreqObj.readyState.toString() + '/' + this.CCLreqObj.status.toString()  ;
                            }
                            try
                            {
                                Parent.BtnSaveBehaviorFunc(Parent.BtnSaveLbl, BtnSaveState);
                            } catch(err) {
                                chla.eAppsUtil.Logger.LogError(err.message);
                            }
                            chla.eAppsUtil.Logger.LogInfo(LogMsg);
                            chla.eAppsUtil.Logger.LogInfo(msgData);
                            Parent.XmtCycleCnt += 1;
                            if (Parent.CallBackOperation.notImplemented == undefined && BtnSaveState == 'OK'){
                                Parent.CallBackOperation(jsonData.RPTDATA);
                            }
                            break;
                        //0: request not initialized
                        default:
                    }
                };
            }
            this.BtnSaveLbl = BtnSaveLbl;
            // Call the ccl program and send the parameter string
            this.CCLreqObj.open('GET', CCLreport);
            chla.eAppsUtil.Logger.LogInfo(' Params: ' + CCLparms );
            this.CCLreqObj.send(CCLparms);
        }
        catch(err) {
            chla.eAppsUtil.Logger.LogError(err.message + ' Params: ' + CCLparms );
        }
    }
};


//::===========================================================================
//:: CC - HANDOFF  Sections ---------------------------------------
//::===========================================================================
//Patient Information
chla.ptinfo = function () { };
chla.ptinfo.prototype = new MPage.Component();
chla.ptinfo.prototype.constructor = MPage.Component;
chla.ptinfo.prototype.base = MPage.Component.prototype;
chla.ptinfo.prototype.name = "chla.ptinfo";
chla.ptinfo.prototype.cclProgram = "CHLA_CA_MP_MD_PT_INFO_JSON";
chla.ptinfo.prototype.cclParams = [];
chla.ptinfo.prototype.cclDataType = "JSON";
chla.ptinfo.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("encounterId");
    this.cclParams[2] = this.getProperty("userId");
};


chla.ptinfo.prototype.render = function () {

    var component = this;
    var elementObj;
    var recordCount;
    var subHeaderDisplay = recordCount;
    var target = this.getTarget();
    var compContent;
    var hoverContent;
    var encounterId = this.getProperty("encounterId");
    var personId = this.getProperty("personId");

    this.setProperty("headerSubTitle", subHeaderDisplay);

    elementObj = component.data.RPTDATA;
    compContent = "<div id='chla_ptinfo'>";
    compContent += "<table>";

    //Age
    var age = elementObj.AGE;
    var newAge = age.replace("Years", "<span class='units'>Years</span>").replace("Months", "<span class='units'>Months</span>").replace("Days", "<span class='units'>Days</span>");
    compContent += "<tr class='rowPopup'><td class='col-1'>Age:</td><td class='col-2'>" + newAge + "</td></tr>";

    //Admission date

    //Calculate Day Number value
    var regTime = new Date(chla.eApps.gFuncs.convertDate(elementObj.REG_DT_TM));
    var today = new Date();
    var t1 = regTime.getTime();
    var t2 = today.getTime();
    var dayNo = parseInt((t2 - t1) / (24 * 3600 * 1000)) + 1;

    compContent += "<tr class='rowPopup'><td class='col-1'>Admission Date:</td><td class='col-2'>" + chla.eApps.gFuncs.convertDate(elementObj.REG_DT_TM) + " <span class='units'>Day " + dayNo + "</span></td></tr>";

    //Med Calc Weight
    if (elementObj.MEDCALC_WT > 0) {
        var pFormLinkParams = "\"POWERFORM\",\"" + personId + "|" + encounterId + "|1170425|0|0\"";
        compContent += "<tr class='rowPopup'><td class='col-1'><a href='javascript:MPAGES_EVENT(" + pFormLinkParams + ")'>Med Calc Wt:</a></td><td class='col-2'>" + elementObj.MEDCALC_WT + " <span class='units'>as of " + chla.eApps.gFuncs.convertDate(elementObj.MEDCALC_WT_DT_TM) + "</td></tr>";
    } else {
        compContent += "<tr class='rowPopup'><td class='col-1'><a href='javascript:MPAGES_EVENT(" + pFormLinkParams + ")'>Med Calc Wt:</a></td><td class='col-2'>--</td></tr>";
    }

    //Routine Weight
    if (elementObj.ROUTINE_WT > 0) {
        var pFormLinkParams = "\"POWERFORM\",\"" + personId + "|" + encounterId + "|1170425|0|0\"";
        compContent += "<tr class='rowPopup'><td class='col-1'><a href='javascript:MPAGES_EVENT(" + pFormLinkParams + ")'>Routine Wt:</a></td><td class='col-2'>" + elementObj.ROUTINE_WT + " <span class='units'>as of " + chla.eApps.gFuncs.convertDate(elementObj.ROUTINE_WT_DT_TM) + "</span><br/><span class='units'>" + elementObj.ROUTINE_WT_CHANGE + " since " + chla.eApps.gFuncs.convertDate(elementObj.ROUTINE_WT_PREVIOUS_DT_TM) + "</span></td></tr>";
    } else {
        compContent += "<tr class='rowPopup'><td class='col-1'><a href='javascript:MPAGES_EVENT(" + pFormLinkParams + ")'>Routine Wt:</a></td><td class='col-2'>--</td></tr>";
    }

    //Height
    if (elementObj.HEIGHT > 0) {
        var pFormLinkParams = "\"POWERFORM\",\"" + personId + "|" + encounterId + "|1170425|0|0\"";
        compContent += "<tr class='rowPopup'><td class='col-1'><a href='javascript:MPAGES_EVENT(" + pFormLinkParams + ")'>Height:</a></td><td class='col-2'>" + elementObj.HEIGHT + " <span class='units'> " + elementObj.HEIGHT_UNITS + " as of " + chla.eApps.gFuncs.convertDate(elementObj.HEIGHT_DT_TM) + "</td></tr>";
    } else {
        compContent += "<tr class='rowPopup'><td class='col-1'><a href='javascript:MPAGES_EVENT(" + pFormLinkParams + ")'>Height:</a></td><td class='col-2'>--</td></tr>";
    }

    //Allergies
    compContent += "<tr class='rowPopup'><td class='col-1'>Allergies:</td>";
    if (elementObj.ALLERGY_CNT > 0) {
        compContent += "<td class='col-2'>";
        for (i = 0; i < elementObj.ALLERGY.length; i++) {
            compContent += "<span class='alert'>" + elementObj.ALLERGY[i].DESC + "</span>";

            if (i < (elementObj.ALLERGY.length - 1)) {
                compContent += "; ";
            } else {
                compContent += " ";
            }
        }
        compContent += "</td>";
    } else {
        compContent += "<td class='col-2'>--</td>";
    }
    compContent += "</tr>";

    //Resistant
    if (elementObj.PRECAUTIONS !== "") {
        compContent += "<tr class='rowPopup'><td class='col-1'>Resistant:</td><td class='col-2'>" + elementObj.PRECAUTIONS + "</td></tr>";
    } else {
        compContent += "<tr class='rowPopup'><td class='col-1'>Resistant:</td><td class='col-2'>--</td></tr>";
    }
    //Isolation
    if (elementObj.ISOLATION !== "") {
        compContent += "<tr class='rowPopup'><td class='col-1'>Isolation:</td><td class='col-2'>" + elementObj.ISOLATION + "</td></tr>";
    } else {
        compContent += "<tr class='rowPopup'><td class='col-1'>Isolation:</td><td class='col-2'>--</td></tr>";
    }

    //ICU
    compContent += "<tr class='rowPopup'><td class='col-1'>ICU:</td>";
    if (elementObj.ICU_CNT > 0) {
        compContent += "<td class='col-2'>";
        for (i = 0; i < elementObj.ICU.length; i++) {
            compContent += elementObj.ICU[i].UNIT + ": ";
            compContent += "<span class='units'>" + chla.eApps.gFuncs.convertDate(elementObj.ICU[i].ARRIVE_DT_TM) + " to ";
            //alert(chla.eApps.gFuncs.convertDate(elementObj.ICU[i].DEPART_DT_TM));
            if (chla.eApps.gFuncs.convertDate(elementObj.ICU[i].DEPART_DT_TM) == "12/31/2100 00:00") {
                compContent += "Present";
            } else {
                compContent += chla.eApps.gFuncs.convertDate(elementObj.ICU[i].DEPART_DT_TM) + "; ";
            }
            compContent += "</span>";
        }
        compContent += "</td>";
    } else {
        compContent += "<td class='col-2'>--</td>";
    }
    compContent += "</tr>";

    //Medical Devices
    if (elementObj.MED_DEVICES > 0) {
        compContent += "<tr class='rowPopup'><td class='col-1'>Medical Devices:</td><td class='col-2'>" + elementObj.MED_DEVICES + "</td></tr>";
    } else {
        compContent += "<tr class='rowPopup'><td class='col-1'>Medical Devices:</td><td class='col-2'>--</td></tr>";
    }

    //Falls Risk Score
    var pFormLinkParams = "\"POWERFORM\",\"" + personId + "|" + encounterId + "|92046070|0|0\"";
    compContent += "<tr class='rowPopup'><td class='col-1'><a href='javascript:MPAGES_EVENT(" + pFormLinkParams + ")'>Falls Risk Score:</a></td>";
    if (elementObj.FALLSCORE > 0) {
        if (elementObj.FALLSCORE > 11) {
            compContent += "<td class='col-2'><span class='alert'>" + elementObj.FALLSCORE + "</span></td></tr>";
        } else {
            compContent += "<td class='col-2'>" + elementObj.FALLSCORE + "</td></tr>";
        }
    } else {
        compContent += "<td class='col-2'>--</td></tr>";
    }

    //Date of Last Fall
    var pFormLinkParams = "\"POWERFORM\",\"" + personId + "|" + encounterId + "|92046070|0|0\"";
    compContent += "<tr class='rowPopup'><td class='col-1'><a href='javascript:MPAGES_EVENT(" + pFormLinkParams + ")'>Date of Last Fall:</a></td>";
    if (elementObj.FALLDATE !== "") {
        compContent += "<td class='col-2'>" + chla.eApps.gFuncs.convertDate3(elementObj.FALLDATE) + "</td></tr>";
    } else {
        compContent += "<td class='col-2'>--</td></tr>";
    }

    //1st Call
    var pFormLinkParams = "\"POWERFORM\",\"" + personId + "|" + encounterId + "|252066972|0|0\"";
    compContent += "<tr class='rowPopup'><td class='col-1'><a href='javascript:MPAGES_EVENT(" + pFormLinkParams + ")'>1st Call:</a></td>";
    if (elementObj.CURRENT_CNT > 0) {
        compContent += "<td class='col-2'>";
        for (i = 0; i < elementObj.CURRENT.length; i++) {
            compContent += elementObj.CURRENT[i].NAME_FULL_FORMATTED;
        }
        compContent += "</td>";
    } else {
        compContent += "<td class='col-2'>--</td>";
    }
    compContent += "</tr>";

    //Attending
    compContent += "<tr class='rowPopup'><td class='col-1'>Attending:</td>";
    if (elementObj.ATTEND_CNT > 0) {
        compContent += "<td class='col-2'>";
        for (i = 0; i < elementObj.ATTEND.length; i++) {
            compContent += elementObj.ATTEND[i].NAME_FULL_FORMATTED;
        }
        compContent += "</td>";
    } else {
        compContent += "<td class='col-2'>--</td>";
    }
    compContent += "</tr>";

    //Referring
    compContent += "<tr class='rowPopup'><td class='col-1'>Referring:</td>";
    if (elementObj.REFER_CNT > 0) {
        compContent += "<td class='col-2'>";
        for (i = 0; i < elementObj.REFER.length; i++) {
            compContent += elementObj.REFER[i].NAME_FULL_FORMATTED;
        }
        compContent += "</td>";
    } else {
        compContent += "<td class='col-2'>--</td>";
    }
    compContent += "</tr>";

    //Care Team Update
    var pFormLinkParams = "\"POWERFORM\",\"" + personId + "|" + encounterId + "|252066972|0|0\"";
    compContent += "<tr class='rowPopup'><td class='col-1'><a href='javascript:MPAGES_EVENT(" + pFormLinkParams + ")'>Care Team:</a></td>"
    if (elementObj.CARETEAM !== "") {
        compContent += "<td class='col-2'>" + elementObj.CARETEAM + "</td></tr>";
    } else {
        compContent += "<td class='col-2'>--</td></tr>";
    }

    //Parent/Guardian
    compContent += "<tr class='rowPopup'><td class='col-1'>Patient's Parent/Guardian:</td>";
    if (elementObj.GUARDIAN_CNT > 0) {
        compContent += "<td class='col-2'>";
        for (i = 0; i < elementObj.GUARDIAN.length; i++) {
            //compContent += elementObj.GUARDIAN[i].NAME_FULL_FORMATTED;
            if (i == 0) {
                compContent += elementObj.GUARDIAN[i]['NAME_FULL_FORMATTED'] + ' (' + elementObj.GUARDIAN[i]['PERSON_RELTN'] + ')';
            } else {
                compContent += ', ' + elementObj.GUARDIAN[i]['NAME_FULL_FORMATTED'] + ' (' + elementObj.GUARDIAN[i]['PERSON_RELTN'] + ')';
            }


        }
        compContent += "</td>";
    } else {
        compContent += "<td class='col-2'>--</td>";
    }
    compContent += "</tr>";

    //Phone number
    if (elementObj.PHONE_CNT > 0) {
        compContent += "<tr class='rowPopup'><td class='col-1'>Phone Number:</td><td class='col-2'>";
        for (i = 0; i < elementObj.PHONE.length; i++) {
            var phone = elementObj.PHONE[i].PHONE_NUM;
            compContent += phone;
            if (i < (elementObj.PHONE.length - 1)) {
                compContent += "; ";
            } else {
                compContent += " ";
            }
        }
        compContent += "</td></tr>";
    } else {
        compContent += "<tr class='rowPopup'><td class='col-1'>Phone Number:</td><td class='col-2'>--</td></tr>";
    }

    //Insurance
    if (elementObj.FINANCIAL_CLASS !== "") {
        compContent += "<tr class='rowPopup'><td class='col-1'>Insurance:</td><td class='col-2'>" + elementObj.FINANCIAL_CLASS + "</td></tr>";
    } else {
        compContent += "<tr class='rowPopup'><td class='col-1'>Insurance:</td><td class='col-2'>--</td></tr>";
    }

    //Blood Type
    if (elementObj.BLOOD_TYPE !== "") {
        compContent += "<tr class='rowPopup'><td class='col-1'>Blood Type:</td><td class='col-2'><span class='blood'>" + elementObj.BLOOD_TYPE + '</span>' + " <span class='units'>as of " + chla.eApps.gFuncs.convertDate(elementObj.BLOOD_TYPE_DT_TM) + "</span></td></tr>";
    } else {
        compContent += "<tr class='rowPopup'><td class='col-1'>Blood Type:</td><td class='col-2'><span class='blood'>--</span></td></tr>";
    }

    //Blood Type Confirmation
    if (chla.eApps.gFuncs.convertDate2(elementObj.BLOOD_TYPE_CONFIRMATION) !== "") {
        compContent += "<tr class='rowPopup'><td class='col-1'>Blood Type Confirmation:</td><td class='col-2'><span class='blood'>" + elementObj.BLOOD_TYPE_CONFIRMATION + " </span><span class='units'>as of " + chla.eApps.gFuncs.convertDate(elementObj.BLOOD_TYPE_CONFIRMATION_DT_TM) + "</span></td></tr>";
    } else {
        compContent += "<tr class='rowPopup'><td class='col-1'>Blood Type Confirmation:</td><td class='col-2'><span class='blood'>--</span></td></tr>";
    }

    //Ab Screen 1
    if (elementObj.AB_SCREEN1 !== "") {
        compContent += "<tr class='rowPopup'><td class='col-1'>AB Screen 1:</td><td class='col-2'><span class='blood'>" + elementObj.AB_SCREEN1 + " </span><span class='units'>as of " + chla.eApps.gFuncs.convertDate(elementObj.AB_SCREEN1_DT_TM) + "</span></td></tr>";
    } else {
        compContent += "<tr class='rowPopup'><td class='col-1'>AB Screen 1:</td><td class='col-2'><span class='blood'>--</span></td></tr>";
    }

    //Ab Screen 2
    if (elementObj.AB_SCREEN2 !== "") {
        compContent += "<tr class='rowPopup'><td class='col-1'>AB Screen 2:</td><td class='col-2'><span class='blood'>" + elementObj.AB_SCREEN2 + " </span><span class='units'>as of " + chla.eApps.gFuncs.convertDate(elementObj.AB_SCREEN2_DT_TM) + "</span></td></tr>";
    } else {
        compContent += "<tr class='rowPopup'><td class='col-1'>AB Screen 2:</td><td class='col-2'><span class='blood'>--</span></td></tr>";
    }

    //Blood Type Confirmation
    if (elementObj.BLOOD_CONSENT_DT_TM !== "") {
        compContent += "<tr class='rowPopup'><td class='col-1'>Blood Consent Date:</td><td class='col-2'><span class='blood'>" + chla.eApps.gFuncs.convertDate2(elementObj.BLOOD_CONSENT_DT_TM) + "</span></td></tr>";
    } else {
        compContent += "<tr class='rowPopup'><td class='col-1'>Blood Type Confirmation:</td><td class='col-2'><span class='blood'>--</span></td></tr>";
    }

    compContent += "</table>";
    compContent += "</div>";
    target.innerHTML = compContent;
    chla.eAppsUtil.Logger.LogWarn("<textarea>" + compContent + "</textarea>");
};


//Surgeries
chla.surgeries = function () { };
chla.surgeries.prototype = new MPage.Component();
chla.surgeries.prototype.constructor = MPage.Component;
chla.surgeries.prototype.base = MPage.Component.prototype;
chla.surgeries.prototype.name = "chla.surgeries";
chla.surgeries.prototype.cclProgram = "CHLA_CA_MP_CC_SURGERIES_JSON";
chla.surgeries.prototype.cclParams = [];
chla.surgeries.prototype.cclDataType = "JSON";
chla.surgeries.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("personId");
};


chla.surgeries.prototype.render = function () {

    var component = this;
    var elementObj;
    var recordCount = "(" + component.data.RPTDATA.PROC_CNT + ")";
    var subHeaderDisplay = recordCount;
    var target = this.getTarget();
    var compContent;
    var hoverContent;

    this.setProperty("headerSubTitle", subHeaderDisplay);

    elementObj = component.data.RPTDATA;
    compContent = "<div id='chla_surgeries'>";

    if (elementObj.PROC_CNT > 0) {
        var p, procedure, f, future, c, completed, o, outside;

        compContent += "<table class='header'><tr><th class='col-a'>Date</th><th class='col-b'>Name of Surgery</th><th class='col-c'>Surgeon</th></table>";

        for (p = 0; p < elementObj.PROCEDURES.length; p++) {
            var completedProcedures = elementObj.PROCEDURES[p].COMPLETED;
            var futureProcedures = elementObj.PROCEDURES[p].FUTURE;
            var outsideProcedures = elementObj.PROCEDURES[p].OUTSIDE;
            var compProcCnt = elementObj.PROCEDURES[p].COMP_PROC_CNT;
            var futProcCnt = elementObj.PROCEDURES[p].FUTURE_PROC_CNT;
            var outProcCnt = elementObj.PROCEDURES[p].OUTSIDE_PROC_CNT;

            compContent += "<div class='surgeries_sectionDiv'><h2 class='surgeries_sectionHead' id='surgeries_futureHead'>Future (" + futProcCnt + ")</h2><div><table>";

            for (f = 0; f < futureProcedures.length; f++) {
                var fprocedure = futureProcedures[f];
                compContent += "<tr class='rowPopup' tip=\""
                    + "<ul>"
                    + "<li><strong>Start Date:</strong> " + fprocedure.SCHED_START_DT_TM + "</li>"
                    + "<li><strong>Procedure:</strong> " + fprocedure.PROC_DISP + "</li>"
                    + "<li><strong>State:</strong> " + fprocedure.APPT_STATE + "</li>"
                    + "<li><strong>Surgery Area:</strong> " + fprocedure.SURG_AREA + "</li>"
                    + "<li><strong>OR:</strong> " + fprocedure.SCHED_OR + "</li>"
                    + "<li><strong>Scheduled Duration:</strong> " + fprocedure.SCHED_DURATION + " minutes</li>"
                    //+ "<li><strong>Duration:</strong> " + fprocedure.PROC_DURATION + " minutes</li>"
                    + "<li><strong>Surgeon:</strong> " + fprocedure.SURGEON + "</li>"
                    + "<li><strong>Case Number:</strong> " + fprocedure.SURG_CASE_NBR + "</li>"
                    + "<li><strong>Procedure Text:</strong> " + fprocedure.PROC_TEXT + "</li>"
                    //+ "<li><strong>End Date/Time:</strong> " + fprocedure.PROC_END_DT_TM + "</li>"
                    + "</ul>"
                    + "\">";
                compContent += "<td class='col-a'>" + fprocedure.SCHED_START_DT_TM + "</td>";
                compContent += "<td class='col-b'>" + fprocedure.PROC_DISP + "</td>";
                compContent += "<td class='col-c'>" + fprocedure.SURGEON + "</td>";
                compContent += "</tr>";
            }

            compContent += "</table></div></div>";
            compContent += "<div class='surgeries_sectionDiv'><h2 class='surgeries_sectionHead'>Completed (" + compProcCnt + ")</h2><div><table>";

            for (c = 0; c < completedProcedures.length; c++) {
                var cprocedure = completedProcedures[c];

                compContent += "<tr class='rowPopup' tip=\""
                    + "<ul>"
                    + "<li><strong>Start Date:</strong> " + cprocedure.SCHED_START_DT_TM + "</li>"
                    + "<li><strong>Procedure:</strong> " + cprocedure.PROC_DISP + "</li>"
                    + "<li><strong>State:</strong> " + cprocedure.APPT_STATE + "</li>"
                    + "<li><strong>Surgery Area:</strong> " + cprocedure.SURG_AREA + "</li>"
                    + "<li><strong>OR:</strong> " + cprocedure.SCHED_OR + "</li>"
                    //+ "<li><strong>Scheduled Duration:</strong> " + cprocedure.SCHED_DURATION + "</li>"
                    + "<li><strong>Duration:</strong> " + cprocedure.PROC_DURATION + " minutes</li>"
                    + "<li><strong>Surgeon:</strong> " + cprocedure.SURGEON + "</li>"
                    + "<li><strong>Case Number:</strong> " + cprocedure.SURG_CASE_NBR + "</li>"
                    + "<li><strong>Procedure Text:</strong> " + cprocedure.PROC_TEXT + "</li>"
                    + "<li><strong>End Date/Time:</strong> " + cprocedure.PROC_END_DT_TM + "</li>"
                    + "</ul>"
                    + "\">";

                compContent += "<td class='col-a'>" + cprocedure.SCHED_START_DT_TM + "</td>";
                compContent += "<td class='col-b'>" + cprocedure.PROC_DISP + "</td>";
                compContent += "<td class='col-c'>" + cprocedure.SURGEON + "</td>";
                compContent += "</tr>";

            }
            compContent += "</table></div></div>";

            compContent += "<div class='surgeries_sectionDiv'><h2 class='surgeries_sectionHead'>Outside (" + outProcCnt + ")</h2><div><table>";

            for (o = 0; o < outsideProcedures.length; o++) {
                var oprocedure = outsideProcedures[o];
                compContent += "<tr class='rowPopup'>";
                compContent += "<td class='col-a'>" + oprocedure.PROC_DT_TM_DISP + " " + oprocedure.PROC_DT_TM + "</td>";
                compContent += "<td class='col-b' colspan=2>" + oprocedure.PROC_TEXT + "</td>";
                //compContent += "<td class='col-c'> </td>";
                compContent += "</tr>";

            }
            compContent += "</table></div></div>";

        }
    } else {
        compContent = "<p>There are no scheduled surgeries at this time.</p>";
    }
    compContent += "</div>";
    target.innerHTML = compContent;
    //chla.eAppsUtil.Logger.LogWarn("<textarea>" + compContent + "</textarea>");
    reInitPopUps();

    //Initialize hovers to display additional surgery detail
    function reInitPopUps() {
        //add the class of hover to all elements with the class of rowPopup
        $(".rowPopup").hover(
            function (event) {
                if (this.tip > " ") {
                    $('<div id="tooltip">' + this.tip + '</div>').css({
                        position: 'absolute',
                        width: '250px',
                        top: event.pageY + 20,
                        left: event.pageX + 10,
                        border: '1px solid #BDBDBD',
                        padding: '10px 10px 10px 10px',
                        'background-color': '#FFFCE1',
                        opacity: 1.00
                    }).appendTo("body").fadeIn(0);
                }
            },
            function () {
                $("#tooltip").remove();
            }
        )
    };

    //Function to expand/contract future/completed sections
    $('.surgeries_sectionHead').click(function () {
        $(this).toggleClass('surgeries_expanded');
        $(this).next().toggle();
        return false;
    }).next().hide();

    //Open future section by default
    $('#surgeries_futureHead').click();

};

//IOs
chla.ios = function () {};
chla.ios.prototype = new MPage.Component();
chla.ios.prototype.constructor = MPage.Component;
chla.ios.prototype.base = MPage.Component.prototype;
chla.ios.prototype.name = "chla.ios";
chla.ios.prototype.cclProgram = "chla_ca_mp_md_io_json2";
chla.ios.prototype.cclParams = [];
chla.ios.prototype.cclDataType = "JSON";
chla.ios.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("encounterId");
};
chla['ios'].prototype.render = function () {
    var component = this,
        elementObj,
        target,
        compContent;

    var gFuncs,
        ios = {
            initOnly: false,
            cc_id: 'x',
            personId: 0,
            encounterId: 0,
            prsnlId: 0,
            transparentSpacer: '',
            CC_SectionManagement: {},
            mainSection: '',
            CC_Tmpls: {
                mainDiv: [
                    '<div id="<#=cc_id#>" class="eapps_CC">',
                    '<#=mainSection#>',
                    '</div>'
                ]
            }
        },
        last_stool;

    elementObj = component.data.RPTDATA;
    target = component.getTarget();
    component.eApps = {
        cc_id: component.name.replace('.', '_'),
        TestSAP: null
    };

    ios.initOnly = '';
    ios.cc_id = component.eApps.cc_id;
    ios.personId = component.getProperty("personId");
    ios.encounterId = component.getProperty("encounterId");
    ios.prsnlId = component.getProperty("userId");
    gFuncs = chlaNsMgr.aliasDirector('chla.eApps.gFuncs');

    compContent = '<div id="ios_div" style="position: relative; border: 1px solid #EDEDED;" > </div>';

    target.innerHTML = compContent;
//::===================================================================================


    if (elementObj && elementObj['OUTPUT'] && elementObj['OUTPUT'][0] &&
        elementObj['OUTPUT'][0]['PERIOD'] && elementObj['INTAKE'] &&
        elementObj['INTAKE'][0] && elementObj['INTAKE'][0]['PERIOD']) {
        if (elementObj.INTAKE[0].PERIOD_CNT > 0 || elementObj.OUTPUT[0].PERIOD_CNT  > 0 )  {
            last_stool = chla.eApps.gFuncs.convertDate(elementObj['LAST_STOOL_DT_TM']);
            CombineUrineAndMixedStool(elementObj['OUTPUT'][0], elementObj.MEDCALC_WT);
            createIosDisplay(elementObj['OUTPUT'][0], elementObj['INTAKE'][0]);
            compContent = $('div#ios_div').html();
            chla.eApps.gFuncs.Log_CC({eApps:{cc_id:'chla_ios'}},compContent);
        }else {
            compContent = '<div id="ios_div" style="position: relative; border: 1px solid #EDEDED;" > No data available  </div>';
            target.innerHTML = compContent;
        }
    }

    //noinspection JSUnusedLocalSymbols
    /**
     * Create the IOs Display Component
     * @param outputData
     * @param intakeData
     */
    function createIosDisplay(outputData, intakeData) {
        var aryDataItems = [],
            aryPeriod,
            strPeriodOutput = '',
            strPeriodIntake,
            strPeriodBalance,
            periodIdx,
            jsonPeriod,
            groupIdx,
            jsonGroup,
            displayTemp,
            itemIdx,
            jsonItem,
            index, i,
            strGrpItem,
            cgTitleDiv1Name,
            cgTitleDiv1,
            tempDivElt,
            PBalance,
            iobalData,
            newTitleTable,
            iosD = document.getElementById('ios_div'),
            iosHtml = '<div id="iobal_div"></div>';


        iosHtml += '<div id="inio_div"></div>';
        iosHtml += '<div id="outio_div"></div>';
        iosHtml += '<div class="eapps-unitsHO" id="iolabel_div"> *Indicates data from midnight to now</div>';
        // item display line construction
        strPeriodIntake = '';
        for (periodIdx = 0; periodIdx < intakeData.PERIOD_CNT; periodIdx++) {
            jsonPeriod = intakeData.PERIOD[periodIdx];
            chla.global.aryIntakeRate.push((Math.round(jsonPeriod.INTAKE_RATE * 10) / 10).toFixed(1));
            if (periodIdx === 0) {
                strPeriodIntake = chla.eApps.gFuncs.convertDate2(jsonPeriod.BEG_DT_TM) + '*|' + jsonPeriod.T_TOTAL;
            } else {
                strPeriodIntake += '|' + chla.eApps.gFuncs.convertDate2(jsonPeriod.BEG_DT_TM) + '|' + jsonPeriod.T_TOTAL;
            }

            for (groupIdx = 0; groupIdx < jsonPeriod.EVENT_SET_CNT; groupIdx++) {
                jsonGroup = jsonPeriod.EVENT_SET[groupIdx];
                displayTemp = {};

                for (itemIdx = 0; itemIdx < jsonGroup.EVENT_CNT; itemIdx++) {
                    jsonItem = jsonGroup.EVENT[itemIdx];
                    if (displayTemp[jsonItem.DISPLAY] === undefined) {
                        displayTemp[jsonItem.DISPLAY] = jsonItem.TOTAL;
                    } else {
                        displayTemp[jsonItem.DISPLAY] += jsonItem.TOTAL;
                    }
                }

                index = 0;
                for (i in displayTemp) {
                    strGrpItem = jsonGroup.DISPLAY + '!' + i + '|' + displayTemp[i] + '|' + jsonGroup.TOTAL + '|' + periodIdx + '|' + groupIdx + '|' + index;
                    index++;
                    aryDataItems.push(strGrpItem);
                }
            }
        }
        if (intakeData.PERIOD_CNT === 2) {
            strPeriodIntake += '|  |0';
        }
        aryDataItems.sort();
        aryDataItems.unshift(strPeriodIntake);
        strPeriodIntake= ( typeof strPeriodIntake === 'undefined' ? '': strPeriodIntake );
        strPeriodBalance =  strPeriodIntake ;
        aryPeriod = strPeriodIntake.split('|');
        iosHtml = '<div style="padding-top: 0;padding-bottom: 0;" class="SegFieldLftTitle textRight"><table width="100%" style="border-bottom-width: 0; border-collapse: collapse;" class="SegFieldLftTitle textRight">' +
            '<tr style="width:100%;" ><td style="width:55%;">' + aryPeriod[0] + '</td><td width="13%">' + aryPeriod[2] + '</td><td width="13%">' + aryPeriod[4] + '</td></tr></table></div>' + iosHtml;
        iosD.innerHTML = iosHtml;

        loadIOsInfoEx1('inio_div', 1, aryDataItems, 'Intake');
        aryDataItems = [];
        for (periodIdx = 0; periodIdx < outputData.PERIOD_CNT; periodIdx++) {
            jsonPeriod = outputData.PERIOD[periodIdx];
            chla.global.aryUrineRate.push((Math.round(jsonPeriod.OUTPUT_RATE * 10) / 10).toFixed(1));
            chla.global.aryMixedStool.push(jsonPeriod.MIXED_URINE_STOOL);
            if (periodIdx === 0) {
                strPeriodOutput = chla.eApps.gFuncs.convertDate2(jsonPeriod.BEG_DT_TM) + '*|' + jsonPeriod.T_TOTAL;
            } else {
                strPeriodOutput += '|' + chla.eApps.gFuncs.convertDate2(jsonPeriod.BEG_DT_TM) + '|' + jsonPeriod.T_TOTAL;
            }
            for (groupIdx = 0; groupIdx < jsonPeriod.EVENT_SET_CNT; groupIdx++) {
                jsonGroup = jsonPeriod.EVENT_SET[groupIdx];
                displayTemp = {};

                for (itemIdx = 0; itemIdx < jsonGroup.EVENT_CNT; itemIdx++) {
                    jsonItem = jsonGroup.EVENT[itemIdx];
                    if (displayTemp[jsonItem.DISPLAY] === undefined) {
                        displayTemp[jsonItem.DISPLAY] = jsonItem.TOTAL;
                    } else {
                        displayTemp[jsonItem.DISPLAY] += jsonItem.TOTAL;
                    }
                }

                index = 0;
                for (i in displayTemp) {
                    strGrpItem = jsonGroup.DISPLAY + '!' + i + '|' + displayTemp[i] + '|' + jsonGroup.TOTAL + '|' + periodIdx + '|' + groupIdx + '|' + index;
                    index++;
                    aryDataItems.push(strGrpItem);
                }
            }
            if (chla.global.aryMixedStool[periodIdx] > 0) {
                strGrpItem = 'Mixed Urine Stool' + '!' + 'Mixed Urine Stool' + '|' + chla.global.aryMixedStool[periodIdx] + '|' + chla.global.aryMixedStool[periodIdx] + '|' + periodIdx + '|' + 999 + '|' + 999;
                aryDataItems.push(strGrpItem);
            }
        }
        if (outputData.PERIOD_CNT === 2) {
            strPeriodOutput += '|  |0';
        }
        aryDataItems.sort();
        aryDataItems.unshift(strPeriodOutput);
        strPeriodBalance += '|' + strPeriodOutput;

        loadIOsInfoEx1('outio_div', 1, aryDataItems, 'Output');

        cgTitleDiv1Name = "iobalD1_div";
        // cgDetailDiv1Name = cgTitleDiv1Name + "_dl";

        cgTitleDiv1 = document.getElementById('iobal_div');
        tempDivElt = document.createElement('div');
        tempDivElt.id = cgTitleDiv1Name;
        tempDivElt.setAttribute("style", "background-color: white;");
        tempDivElt.setAttribute("name", cgTitleDiv1Name);
        cgTitleDiv1.appendChild(tempDivElt);


        //Create title table
        PBalance = strPeriodBalance.split('|');
        iobalData = 'Balance |' + (Math.round((PBalance[1] - PBalance[7]) * 100) / 100) + '|' + (Math.round((PBalance[3] - PBalance[9]) * 100) / 100) + '|' + (Math.round((PBalance[5] - PBalance[11]) * 100) / 100);

        newTitleTable = createIOsTableEx('iobal_tbl', '100%');
        cgTitleDiv1.appendChild(newTitleTable);
        createIOsBalCGTitle(newTitleTable, iobalData, 'Balance');

    }

    /**
     * Construct the collapsible display section for IOs detail data
     * @param cgDiv
     * @param unqID
     * @param data
     * @param cgTitle
     */
    //var cgDetailDiv1Name_major;
    function loadIOsInfoEx1(cgDiv, unqID, data, cgTitle) {
        var cgTitleDiv1Name ,
            cgDetailDiv1Name ,
            cgTitleDiv1 ,
            newTitleTable,
            tempDivElmt,
            div_cgTitleDiv1Name;

        cgTitleDiv1Name = cgDiv + '_L1_' + unqID;
        cgDetailDiv1Name = cgTitleDiv1Name + "_dl";


        cgTitleDiv1 = document.getElementById(cgDiv);
        tempDivElmt = document.createElement('div');
        tempDivElmt.id = cgTitleDiv1Name;
        tempDivElmt.setAttribute("style", "background-color: white;");
        tempDivElmt.setAttribute("name", cgTitleDiv1Name);
        cgTitleDiv1.appendChild(tempDivElmt);

        //Create title table
        newTitleTable = createIOsTableEx(cgTitleDiv1Name, '100%');

        document.getElementById(cgTitleDiv1Name).appendChild(newTitleTable);
        createIOsCGTotTitle(newTitleTable, data, cgTitleDiv1Name, cgTitle);

        // cgDetailDiv = document.getElementById(cgDiv);
        tempDivElmt = document.createElement('div');
        tempDivElmt.id = cgDetailDiv1Name;
        tempDivElmt.setAttribute("style", "display: none");
        tempDivElmt.setAttribute("name", cgDetailDiv1Name);
        cgTitleDiv1.appendChild(tempDivElmt);
        div_cgTitleDiv1Name = $('#' + cgTitleDiv1Name);

        div_cgTitleDiv1Name.on('click', function (event) {
            var theDiv2 ,
                oldTable ,
                strPeriod ,
                newTable ,
                aryPeriod,
                tstrTitle ,
                tstrItem ,
                tstrData ,
                tstrGroup ,
                tstrGroupTot ,
                tstrGroupTotLabel,
                aryData ,
                itemNum = 0,
                itemData;
            event.stopPropagation();
            theDiv2 = document.getElementById(cgDetailDiv1Name);

            if (theDiv2.style.display === "none") {

                oldTable = document.getElementById('table_' + cgDetailDiv1Name + '_L2_0');
                if (oldTable) {
                    document.getElementById("expand_" + cgTitleDiv1Name).innerHTML = '<img src="' +  chla.global.imgPath + 'group-collapse.gif" alt="group-collapse"/>';
                    theDiv2.style.display = "block";
                } else {
                    strPeriod = "";
                    if (data.length === 0) {
                        strPeriod = '<tr><td class="greyline" align="center"> -- </td></tr>';
                        newTable = '<table width="100%" class="ApSegDataTbl1" border="0" cellspacing="0" cellpadding="0" id="table_' + cgDetailDiv1Name + '_L2_0">' + strPeriod + '</table>';
                        theDiv2.innerHTML = newTable;
                        //cleanuplist.add('table_' + cgDetailDiv1Name + '_L2_0');
                    } else {
                        tstrTitle = '';
                        tstrItem = '';
                        tstrData = '';
                        tstrGroup = '';
                        tstrGroupTot = ['--', '--', '--'];
                        aryData = ['--', '--', '--'];
                        itemNum = 0;

                        for (itemData = 0; itemData < data.length; itemData++) {
                            tstrData = data[itemData];
                            aryPeriod = tstrData.split('|');
                            tstrGroup = aryPeriod[0].split('!');
                            if (tstrItem !== tstrGroup[1]) {
                                if (itemData > 0) {
                                    strPeriod +=      '<tr style="line-height: .5em;">'+
                                                          '<td class="greyline" style="width:5%; text-align:right;padding-left:15px;">&nbsp;</td>'+
                                                          '<td class="FieldLabelLft greyline" style="width:28%;padding: 0;">&nbsp;&nbsp;&nbsp;' +
                                        tstrItem +   '</td><td class="FieldLabelLft textRight greyline cellPad" style="width:5%;padding: 0;">&nbsp;</td>' +
                                                          '<td class="FieldLabelLft textRight greyline cellPad" style="width:12%;padding: 0;">' + aryData[0] +
                                                     '</td><td class="FieldLabelLft textRight greyline cellPad" style="width:12%;padding: 0;">' +
                                        aryData[1] + '</td><td class="FieldLabelLft textRight greyline cellPad" style="width:12%;padding: 0;">' + aryData[2] +
                                                     '</td><td class="FieldLabelLft textRight greyline" style="width:3%;padding: 0;">&nbsp;</td></tr>';
                                    aryData[0] = '--';
                                    aryData[1] = '--';
                                    aryData[2] = '--';
                                }
                                tstrItem = tstrGroup[1];
                            }
                            if (tstrTitle !== tstrGroup[0]) {

                                if (itemData > 0) {
                                    tstrGroupTotLabel = tstrTitle + '|' + tstrGroupTot[0] + '|' + tstrGroupTot[1] + '|' + tstrGroupTot[2];
                                    loadIOsInfoEx2(cgDetailDiv1Name, itemNum++, strPeriod, tstrGroupTotLabel);
                                    strPeriod = "";
                                    tstrGroupTot[0] = '--';
                                    tstrGroupTot[1] = '--';
                                    tstrGroupTot[2] = '--';
                                }
                                tstrTitle = tstrGroup[0];
                            }

                            aryData[aryPeriod[3]] = aryPeriod[1];
                            tstrGroupTot[aryPeriod[3]] = aryPeriod[2];
                        }
                        tstrGroupTotLabel = tstrTitle + '|' + tstrGroupTot[0] + '|' + tstrGroupTot[1] + '|' + tstrGroupTot[2];
                        strPeriod += '<tr style="line-height: .5em;">'+
                                         '<td class="greyline" style="text-align: right;padding-left:15px;width:5%;" >&nbsp;</td>'+
                                         '<td class="FieldLabelLft greyline" style="padding: 0;width:28%;">&nbsp;&nbsp;&nbsp;' + tstrItem +
                                    '</td><td class="FieldLabelLft textRight greyline cellPad" style="width:5%;padding: 0;">&nbsp;</td>' +
                                         '<td class="FieldLabelLft textRight greyline cellPad" style="width:12%;padding: 0;">' + aryData[0] +
                                    '</td><td class="FieldLabelLft textRight greyline cellPad" style="width:12%;padding: 0;">' + aryData[1] + '' +
                                    '</td><td class="FieldLabelLft textRight greyline cellPad" style="width:12%;padding: 0;">' + aryData[2] +
                                    '</td><td class="FieldLabelLft textRight greyline" style="width:3%;padding: 0;">&nbsp;</td></tr>';
                        loadIOsInfoEx2(cgDetailDiv1Name, itemNum++, strPeriod, tstrGroupTotLabel);
                    }
                    document.getElementById("expand_" + cgTitleDiv1Name).innerHTML = '<img src="' +   chla.global.imgPath + 'group-collapse.gif" alt="group-collapse"/>';
                    theDiv2.style.display = "block";
                }
            } else {
                theDiv2.style.display = "none";
                document.getElementById("expand_" + cgTitleDiv1Name).innerHTML = '<img src="' + chla.global.imgPath + 'group-expand.gif" alt="group-expand"/>';
            }
        });
        div_cgTitleDiv1Name.click();
    }

    /**
     * Construct the collapsible display section for IOs detail data level 2
     * @param cgDiv
     * @param unqID
     * @param data
     * @param cgTitle
     */
    function loadIOsInfoEx2(cgDiv, unqID, data, cgTitle) {
        var cgTitleDiv1Name,
            cgDetailDiv1Name,
            cgTitleDiv1,
            newTitleTable,
            tempDivElmt,
            div_cgTitleDiv1Name;

        cgTitleDiv1Name = cgDiv + '_L2_' + unqID;
        cgDetailDiv1Name = cgTitleDiv1Name + "_dl";

        cgTitleDiv1 = document.getElementById(cgDiv);
        tempDivElmt = document.createElement('div');
        tempDivElmt.id = cgTitleDiv1Name;
        tempDivElmt.setAttribute("style", "background-color: white;");
        tempDivElmt.setAttribute("name", cgTitleDiv1Name);
        cgTitleDiv1.appendChild(tempDivElmt);

        //Create title table
        newTitleTable = createIOsTableEx(cgTitleDiv1Name, '100%');

        document.getElementById(cgTitleDiv1Name).appendChild(newTitleTable);
        createIOsCGTitle(newTitleTable, cgTitle, cgTitleDiv1Name);

        // cgDetailDiv = document.getElementById(cgDiv);
        tempDivElmt = document.createElement('div');
        tempDivElmt.id = cgDetailDiv1Name;
        tempDivElmt.setAttribute("style", "display: none");
        tempDivElmt.setAttribute("name", cgDetailDiv1Name);
        cgTitleDiv1.appendChild(tempDivElmt);

        div_cgTitleDiv1Name = $('#' + cgTitleDiv1Name);
        div_cgTitleDiv1Name.on('click',  function (event) {
            var theDiv2,
                oldTable,
                newTable;
            event.stopPropagation();
            theDiv2 = document.getElementById(cgDetailDiv1Name);

            if (theDiv2.style.display === "none") {
                oldTable = document.getElementById('table_' + cgDetailDiv1Name);
                if (oldTable) {
                    document.getElementById("expand_" + cgTitleDiv1Name).innerHTML = '<img src="' +  chla.global.imgPath + 'group-collapse.gif" alt="group-collapse" style="padding-left:15px;"/>';
                    theDiv2.style.display = "block";
                } else {
                    //Create table and load data
                    newTable = '<table width="100%" class="ApSegDataTbl1" border="0" cellspacing="0" cellpadding="0" id="table_' + cgDetailDiv1Name + '">' + data + '</table>';
                    theDiv2.innerHTML = newTable;
                    //cleanuplist.add('table_' + cgDetailDiv1Name);
                    document.getElementById("expand_" + cgTitleDiv1Name).innerHTML = '<img src="' +  chla.global.imgPath + 'group-collapse.gif" alt="group-collapse"/>';
                    theDiv2.style.display = "block";
                }
            } else {
                theDiv2.style.display = "none";
                document.getElementById("expand_" + cgTitleDiv1Name).innerHTML = '<img src="' + chla.global.imgPath + 'group-expand.gif" alt="group-expand" style="padding-left:15px;"/>';
            }
        });
        div_cgTitleDiv1Name.click(); //load subitems
        div_cgTitleDiv1Name.click(); //collapse
    }

    /**
     * Create the base table component for collapsible
     * @param divId
     * @param width
     */
    function createIOsTableEx(divId, width) {
        var tempstr,
            newtable =  document.createElement('table');
        newtable.id = 'table_' + divId;
        tempstr =  "border:0 ; width:" + width;
        newtable.setAttribute("style",tempstr);
        newtable.setAttribute("class",'ApSegDataTbl1');

        return newtable;
    }

    /**
     * Create the IOs collapsible component title table row/cell
     * @param newtable
     * @param data
     * @param cgTitleDiv1Name
     */
    function createIOsCGTitle(newtable, data, cgTitleDiv1Name) {
        var aryPeriod ,
            field ,
            row1 ,
            cell13 ,
            cell14 ,
            cell14a ,
            cell15 ,
            cell16 ,
            cell17 ;

        // Graphic Cell
        aryPeriod = data.split('|');
        field = [];
        if (aryPeriod[0] === 'Stool Output') {
            field.push(aryPeriod[0] + '<br/><span class="eapps-unitsHO"> Last stool (' + last_stool + ')</span>');
            field.push(aryPeriod[1] + '<br/>&nbsp;');
            field.push(aryPeriod[2] + '<br/>&nbsp;');
            field.push(aryPeriod[3] + '<br/>&nbsp;');
        } else if (aryPeriod[0] === 'Urine Output') {
            field.push(aryPeriod[0] + '<br/><span class="eapps-unitsHO">Rate (ml/kg/hr)<span>');
            field.push(aryPeriod[1] + '<br/><span class="eapps-unitsHO">(' + chla.global.aryUrineRate[0] + ')</span>');
            field.push(aryPeriod[2] + '<br/><span class="eapps-unitsHO">(' + chla.global.aryUrineRate[1] + ')</span>');
            field.push(aryPeriod[3] + '<br/><span class="eapps-unitsHO">(' + chla.global.aryUrineRate[2] + ')</span>');
        } else {
            field.push(aryPeriod[0]);
            field.push(aryPeriod[1]);
            field.push(aryPeriod[2]);
            field.push(aryPeriod[3]);
        }
        row1 = newtable.insertRow(0);

        cell15 = row1.insertCell(0);
        cell15.style.textAlign = 'right';
        //cell15.setAttribute('text-align', 'right');
        cell15.style.width = '5%';
        // cell15.setAttribute('width', '5%');
        cell15.setAttribute('class', 'AplSegGenLabel2 level2 textRight');
        cell15.setAttribute('id', 'expand_' + cgTitleDiv1Name);

        cell15.innerHTML = '<img src="' + chla.global.imgPath + 'group-expand.gif" alt="group-expand"/>'; //tree ioc
        // Section Title
        cell13 = row1.insertCell(1);
        // cell13.setAttribute('align', 'left');
        cell13.style.textAlign = 'left';
        // cell13.setAttribute('width', '28%');
        cell13.style.width = '28%';
        cell13.setAttribute('class', 'AplSegGenLabel2 level2');
        cell13.innerHTML = field[0];
        // spacer
        cell14a = row1.insertCell(2);
        cell14a.style.textAlign = 'right';
        //cell14a.setAttribute('align', 'right');
        // cell14a.setAttribute('width', '12%');
        cell14a.style.width = '5%';
        cell14a.setAttribute('class', 'AplSegGenLabel2 level2 textRight cellPad');
        cell14a.innerHTML = '&nbsp;';
        // MN-now
        cell14 = row1.insertCell(3);
        cell14.style.textAlign = 'right';
        //cell14.setAttribute('align', 'right');
        // cell14.setAttribute('width', '12%');
        cell14.style.width = '12%';
        cell14.setAttribute('class', 'AplSegGenLabel2 level2 textRight cellPad');
        cell14.innerHTML = field[1];
        // Day1
        cell15 = row1.insertCell(4);
        cell15.style.textAlign = 'right';
        //cell15.setAttribute('align', 'right');
        // cell15.setAttribute('width', '12%');
        cell15.style.width = '12%';
        cell15.setAttribute('class', 'AplSegGenLabel2 level2 textRight cellPad');
        cell15.innerHTML = field[2];
        // Day2
        cell16 = row1.insertCell(5);
        cell16.style.textAlign = 'right';
        // cell16.setAttribute('align', 'right');
        // cell16.setAttribute('width', '12%');
        cell16.style.width = '12%';
        cell16.setAttribute('class', 'AplSegGenLabel2 level2 textRight cellPad');
        cell16.innerHTML = field[3];
        // spacer
        cell17 = row1.insertCell(6);
        cell17.style.textAlign = 'right';
        // cell17.setAttribute('align', 'right');
        // cell17.setAttribute('width', '3%');
        cell17.style.width = '3%';
        cell17.setAttribute('class', 'AplSegGenLabel2 level2 textRight');
        cell17.innerHTML = '&nbsp;';
    }

    /**
     * Create the IOs collapsible component balance title table row/cell
     * @param newtable
     * @param data
     * @param cgTitleDiv1Name
     */
    function createIOsBalCGTitle(newtable, data, cgTitleDiv1Name) {
        var aryPeriod ,
            row1 ,
            cell13 ,
            cell13a ,
            cell14 ,
            cell15 ,
            cell16 ,
            cell17;
        // Graphic Cell
        aryPeriod = data.split('|');
        row1 = newtable.insertRow(0);

        cell15 = row1.insertCell(0);
        // cell15.setAttribute('align', 'right');
        cell15.style.textAlign = 'right';
        // cell15.setAttribute('width', '5%');
        cell15.style.width = '5%';
        cell15.setAttribute('class', 'AplSegGenLabel2  textRight');
        cell15.setAttribute('id', 'expand_' + cgTitleDiv1Name);
        cell15.innerHTML = '&nbsp;'; //tree ioc
        // Section Title
        cell13 = row1.insertCell(1);
        // cell13.setAttribute('align', 'left');
        cell13.style.textAlign = 'left';
        cell13.style.width = '28%';
        // cell13.setAttribute('width', '28%');
        cell13.setAttribute('class', 'AplSegGenLabel2 txtBold');
        cell13.innerHTML = aryPeriod[0];
        // Section spaccer
        cell13a = row1.insertCell(2);
        // cell13a.setAttribute('align', 'left');
        cell13a.style.textAlign = 'right';
        cell13a.style.width = '5%';
        // cell13a.setAttribute('width', '12%');
        cell13a.setAttribute('class', 'AplSegGenLabel2');
        cell13a.innerHTML = '&nbsp;';
        // MN-now
        cell14 = row1.insertCell(3);
        // cell14.setAttribute('align', 'right');
        cell14.style.textAlign = 'right';
        cell14.style.width = '12%';
        // cell14.setAttribute('width', '12%');
        cell14.setAttribute('class', 'AplSegGenLabel2  textRight cellPad txtBold');
        cell14.innerHTML = aryPeriod[1];
        // Day1
        cell15 = row1.insertCell(4);
        // cell15.setAttribute('align', 'right');
        cell15.style.textAlign = 'right';
        cell15.style.width = '12%';
        // cell15.setAttribute('width', '12%');
        cell15.setAttribute('class', 'AplSegGenLabel2  textRight cellPad txtBold');
        cell15.innerHTML = aryPeriod[2];
        // Day2
        cell16 = row1.insertCell(5);
        // cell16.setAttribute('align', 'right');
        cell16.style.textAlign = 'right';
        cell16.style.width = '12%';
        // cell16.setAttribute('width', '12%');
        cell16.setAttribute('class', 'AplSegGenLabel2  textRight cellPad txtBold');
        cell16.innerHTML = aryPeriod[3];
        // spacer
        cell17 = row1.insertCell(6);
        // cell17.setAttribute('align', 'right');
        cell17.style.textAlign = 'right';
        cell17.style.width = '3%';
        // cell17.setAttribute('width', '3%');
        cell17.setAttribute('class', 'AplSegGenLabel2  textRight txtBold');
        cell17.innerHTML = '&nbsp;';
    }

    /**
     * Create the IOs collapsible component title table row/cell
     * @param newTable
     * @param data
     * @param cgTitleDiv1Name
     * @param cgTitle
     */
    function createIOsCGTotTitle(newTable, data, cgTitleDiv1Name, cgTitle) {
        var strPeriod,
            aryPeriod ,
            row1 ,
            cell13 ,
            cell14 ,
            cell15 ,
            cell16 ,
            cell17 ;

        // Graphic Cell
        strPeriod = data.shift();
        aryPeriod = strPeriod.split('|');

        row1 = newTable.insertRow(0);
        cell15 = row1.insertCell(0);
        // cell15.setAttribute('width', '5%');
        cell15.style.width = '5%';
        cell15.style.textAlign = 'right';
        cell15.setAttribute('class', 'AplSegGenLabel2');
        cell15.setAttribute('id', 'expand_' + cgTitleDiv1Name);
        cell15.innerHTML = '<img src="' + chla.global.imgPath + 'group-expand.gif" alt="group-expand"/>'; //tree ioc
        // Section Title
        cell13 = row1.insertCell(1);
        // cell13.setAttribute('align', 'left');
        // cell13.setAttribute('width', '28%');
        cell13.style.width = '28%';
        cell13.style.textAlign = 'left';
        cell13.setAttribute('class', 'AplSegGenLabel2 ');
        cell13.innerHTML = cgTitle === 'Intake' ? 'Intake<br/><span class="eapps-unitsHO">Rate (ml/kg/day)</span>' : cgTitle;
        // Section spaccer
        cell13 = row1.insertCell(2);
        // cell13.setAttribute('align', 'left');
        // cell13.setAttribute('width', '12%');
        cell13.style.width = '5%';
        cell13.style.textAlign = 'right';
        cell13.setAttribute('class', 'AplSegGenLabel2');
        cell13.innerHTML = '&nbsp;';
        // MN-now
        cell14 = row1.insertCell(3);
        // cell14.setAttribute('align', 'right');
        // cell14.setAttribute('width', '12%');
        cell14.style.width = '12%';
        cell14.style.textAlign = 'right';
        cell14.setAttribute('class', 'AplSegGenLabel2 textRight cellPad');
        cell14.innerHTML = cgTitle === 'Intake' ? aryPeriod[1] + '<br><span class="eapps-unitsHO">(' + chla.global.aryIntakeRate[0] + ')</span>' : aryPeriod[1];
        // Day1
        cell15 = row1.insertCell(4);
        // cell15.setAttribute('align', 'right');
        // cell15.setAttribute('width', '12%');
        cell15.style.width = '12%';
        cell15.style.textAlign = 'right';
        cell15.setAttribute('class', 'AplSegGenLabel2 textRight cellPad');
        cell15.innerHTML = cgTitle === 'Intake' ? aryPeriod[3] + '<br><span class="eapps-unitsHO">(' + chla.global.aryIntakeRate[1] + ')</span>' : aryPeriod[3];
        // Day2
        cell16 = row1.insertCell(5);
        // cell16.setAttribute('align', 'right');
        // cell16.setAttribute('width', '12%');
        cell16.style.width = '12%';
        cell16.style.textAlign = 'right';
        cell16.setAttribute('class', 'AplSegGenLabel2 textRight cellPad');
        cell16.innerHTML = cgTitle === 'Intake' ? aryPeriod[5] + '<br><span class="eapps-unitsHO">(' + chla.global.aryIntakeRate[2] + ')</span>' : aryPeriod[5];
        // spacer
        cell17 = row1.insertCell(6);
        // cell17.setAttribute('align', 'right');
        // cell17.setAttribute('width', '3%');
        cell17.style.width = '3%';
        cell17.style.textAlign = 'right';
        cell17.setAttribute('class', 'AplSegGenLabel2 textRight ');
        cell17.innerHTML = '&nbsp;';
    }

    function CombineUrineAndMixedStool(data, kg) {
        var p, mixed,total, e;
        for ( p = 0; p < data.PERIOD.length; p++) {
            if (data.PERIOD[p].MIXED_URINE_STOOL > 0) {
                mixed = 0;
                total = 0;
                for (e = 0; e < data.PERIOD[p].EVENT_SET.length; e++) {
                    if (data.PERIOD[p].EVENT_SET[e].DISPLAY === "Urine Output") {
                        data.PERIOD[p].EVENT_SET[e].EVENT_CNT += 1;
                        data.PERIOD[p].EVENT_SET[e].TOTAL += data.PERIOD[p].MIXED_URINE_STOOL;
                        data.PERIOD[p].EVENT_SET[e].EVENT.push({
                            EVENT_ID : 0,
                            DISPLAY : "Mixed Urine Stool",
                            TOTAL : data.PERIOD[p].MIXED_URINE_STOOL
                        });
                        mixed = data.PERIOD[p].MIXED_URINE_STOOL;
                        total = data.PERIOD[p].EVENT_SET[e].TOTAL;
                        data.PERIOD[p].MIXED_URINE_STOOL = 0;
                    }
                }
                data.PERIOD[p].OUTPUT_RATE = total / kg / (
                    new Date(chla.eApps.gFuncs.convertDate(data.PERIOD[p].BEG_DT_TM)).getDate() === new Date().getDate() ? (new Date().getHours() + new Date().getMinutes() / 60) : 24);
            }
        }
        return data;
    }
};
// chla.ios.prototype.render = function () {
//     var component = this,
//         elementObj,
//         target,
//         compContent;
//
//     var CC_SectMgt = null,
//         CC_CssBehavior = null,
//         gFuncs = null,
//         htmlSecCtl = null,
//         htmlSecCtlObj = null,
//         ios = {
//             initOnly: false,
//             cc_id: 'x',
//             personId: 0,
//             encounterId: 0,
//             prsnlId: 0,
//             transparentSpacer: '',
//             CC_SectionManagement: {},
//             mainSection: '',
//             CC_Tmpls: {
//                 mainDiv: [
//                     '<div id="<#=cc_id#>" class="eapps_CC">',
//                     '<#=mainSection#>',
//                     '</div>'
//                 ]
//             }
//         },
//         last_stool;
//
//     elementObj = component.data.RPTDATA;
//     target = component.getTarget();
//     component.eApps = {
//         cc_id: component.name.replace('.', '_'),
//         TestSAP: null
//     };
//
//     ios.initOnly = '';
//     ios.cc_id = component.eApps.cc_id;
//     ios.personId = component.getProperty("personId");
//     ios.encounterId = component.getProperty("encounterId");
//     ios.prsnlId = component.getProperty("userId");
//     gFuncs = chlaNsMgr.aliasDirector('chla.eApps.gFuncs');
//
//     compContent = '<div id="ios_div" style="position: relative; border: 1px solid #EDEDED;" > </div>';
//
//     target.innerHTML = compContent;
// //::===================================================================================
//
//
//     if (elementObj && elementObj['OUTPUT'] && elementObj['OUTPUT'][0] &&
//         elementObj['OUTPUT'][0]['PERIOD'] && elementObj['INTAKE'] &&
//         elementObj['INTAKE'][0] && elementObj['INTAKE'][0]['PERIOD']) {
//         if (elementObj.INTAKE[0].PERIOD_CNT > 0 || elementObj.OUTPUT[0].PERIOD_CNT  > 0 )  {
//             last_stool = chla.eApps.gFuncs.convertDate(elementObj['LAST_STOOL_DT_TM']);
//             CombineUrineAndMixedStool(elementObj['OUTPUT'][0], elementObj.MEDCALC_WT);
//             createIosDisplay(elementObj['OUTPUT'][0], elementObj['INTAKE'][0]);
//             compContent = $('div#ios_div').html();
//             chla.eApps.gFuncs.Log_CC({eApps:{cc_id:'chla_ios'}},compContent);
//         }else {
//             compContent = '<div id="ios_div" style="position: relative; border: 1px solid #EDEDED;" > No data available  </div>';
//             target.innerHTML = compContent;
//         }
//     }
//
//     /**
//      * Create the IOs Display Component
//      * @param outputdata
//      * @param intakedata
//      */
//     function createIosDisplay(outputdata, intakedata) {
//         var aryDataItems = new Array(),
//             aryPeriod,
//             strPeriodOutput,
//             strPeriodIntake,
//             strPeriodBalance,
//             periodIdx,
//             jsonPeriod,
//             groupIdx,
//             jsonGroup,
//             displayTemp,
//             itemIdx,
//             jsonItem,
//             index, i,
//             strGrpItem,
//             cgTitleDiv1Name,
//             cgDetailDiv1Name,
//             cgTitleDiv1,
//             tempDivElmt,
//             PBalance,
//             iobaldata,
//             newTitleTable,
//             iosD = document.getElementById('ios_div'),
//             iosHtml = '<div id="iobal_div"></div>';
//
//
//         iosHtml += '<div id="inio_div"></div>';
//         iosHtml += '<div id="outio_div"></div>';
//         iosHtml += '<div class="eapps-unitsHO" id="iolabel_div"> *Indicates data from midnight to now</div>';
//         // item display line construction
//
//         for (periodIdx = 0; periodIdx < intakedata.PERIOD_CNT; periodIdx++) {
//             jsonPeriod = intakedata.PERIOD[periodIdx];
//             chla.global.aryIntakeRate.push((Math.round(jsonPeriod.INTAKE_RATE * 10) / 10).toFixed(1));
//             if (periodIdx == 0) {
//                 strPeriodIntake = chla.eApps.gFuncs.convertDate2(jsonPeriod.BEG_DT_TM) + '*|' + jsonPeriod.T_TOTAL;
//             } else {
//                 strPeriodIntake += '|' + chla.eApps.gFuncs.convertDate2(jsonPeriod.BEG_DT_TM) + '|' + jsonPeriod.T_TOTAL;
//             }
//
//             for (groupIdx = 0; groupIdx < jsonPeriod.EVENT_SET_CNT; groupIdx++) {
//                 jsonGroup = jsonPeriod.EVENT_SET[groupIdx];
//                 displayTemp = {};
//
//                 for (itemIdx = 0; itemIdx < jsonGroup.EVENT_CNT; itemIdx++) {
//                     jsonItem = jsonGroup.EVENT[itemIdx];
//                     if (displayTemp[jsonItem.DISPLAY] === undefined) {
//                         displayTemp[jsonItem.DISPLAY] = jsonItem.TOTAL;
//                     } else {
//                         displayTemp[jsonItem.DISPLAY] += jsonItem.TOTAL;
//                     }
//                 }
//
//                 index = 0;
//                 for (i in displayTemp) {
//                     strGrpItem = jsonGroup.DISPLAY + '!' + i + '|' + displayTemp[i] + '|' + jsonGroup.TOTAL + '|' + periodIdx + '|' + groupIdx + '|' + index;
//                     index++;
//                     aryDataItems.push(strGrpItem);
//                 }
//             }
//         };
//         if (intakedata.PERIOD_CNT == 2) {
//             strPeriodIntake += '|  |0';
//         }
//         aryDataItems.sort();
//         aryDataItems.unshift(strPeriodIntake);
//         strPeriodIntake= ( typeof strPeriodIntake == 'undefined' ? '': strPeriodIntake );
//         strPeriodBalance =  strPeriodIntake ;
//         aryPeriod = strPeriodIntake.split('|');
//         iosHtml = '<div style="padding-top: 0px;padding-bottom: 0px;" class="SegFieldLftTitle textRight"><table width="100%" style="border-bottom-width: 0; border-collapse: collapse;" class="SegFieldLftTitle textRight"><tr width="100%" ><td width="55%">' + aryPeriod[0] + '</td><td width="13%">' + aryPeriod[2] + '</td><td width="13%">' + aryPeriod[4] + '</td></tr></table></div>' + iosHtml;
//         iosD.innerHTML = iosHtml;
//
//         loadIOsInfoEx1('inio_div', 1, aryDataItems, 'Intake');
//         aryDataItems = [];
//         for (periodIdx = 0; periodIdx < outputdata.PERIOD_CNT; periodIdx++) {
//             jsonPeriod = outputdata.PERIOD[periodIdx];
//             chla.global.aryUrineRate.push((Math.round(jsonPeriod.OUTPUT_RATE * 10) / 10).toFixed(1));
//             chla.global.aryMixedStool.push(jsonPeriod.MIXED_URINE_STOOL);
//             if (periodIdx == 0) {
//                 strPeriodOutput = chla.eApps.gFuncs.convertDate2(jsonPeriod.BEG_DT_TM) + '*|' + jsonPeriod.T_TOTAL;
//             } else {
//                 strPeriodOutput += '|' + chla.eApps.gFuncs.convertDate2(jsonPeriod.BEG_DT_TM) + '|' + jsonPeriod.T_TOTAL;
//             }
//             for (groupIdx = 0; groupIdx < jsonPeriod.EVENT_SET_CNT; groupIdx++) {
//                 jsonGroup = jsonPeriod.EVENT_SET[groupIdx];
//                 displayTemp = {};
//
//                 for (itemIdx = 0; itemIdx < jsonGroup.EVENT_CNT; itemIdx++) {
//                     jsonItem = jsonGroup.EVENT[itemIdx];
//                     if (displayTemp[jsonItem.DISPLAY] === undefined) {
//                         displayTemp[jsonItem.DISPLAY] = jsonItem.TOTAL;
//                     } else {
//                         displayTemp[jsonItem.DISPLAY] += jsonItem.TOTAL;
//                     }
//                 }
//
//                 index = 0;
//                 for (i in displayTemp) {
//                     strGrpItem = jsonGroup.DISPLAY + '!' + i + '|' + displayTemp[i] + '|' + jsonGroup.TOTAL + '|' + periodIdx + '|' + groupIdx + '|' + index;
//                     index++;
//                     aryDataItems.push(strGrpItem);
//                 }
//             }
//             if (chla.global.aryMixedStool[periodIdx] > 0) {
//                 strGrpItem = 'Mixed Urine Stool' + '!' + 'Mixed Urine Stool' + '|' + chla.global.aryMixedStool[periodIdx] + '|' + chla.global.aryMixedStool[periodIdx] + '|' + periodIdx + '|' + 999 + '|' + 999;
//                 aryDataItems.push(strGrpItem);
//             }
//         }
//         if (outputdata.PERIOD_CNT == 2) {
//             strPeriodOutput += '|  |0';
//         }
//         aryDataItems.sort();
//         aryDataItems.unshift(strPeriodOutput);
//         strPeriodBalance += '|' + strPeriodOutput;
//
//         loadIOsInfoEx1('outio_div', 1, aryDataItems, 'Output');
//
//         cgTitleDiv1Name = "iobalD1_div";
//         cgDetailDiv1Name = cgTitleDiv1Name + "_dl";
//
//         //cleanuplist.add(cgTitleDiv1Name);
//         //cleanuplist.add(cgDetailDiv1Name);
//         cgTitleDiv1 = document.getElementById('iobal_div');
//         tempDivElmt = document.createElement('div');
//         tempDivElmt.id = cgTitleDiv1Name;
//         tempDivElmt.setAttribute("style", "background-color: white;");
//         tempDivElmt.setAttribute("name", cgTitleDiv1Name);
//         cgTitleDiv1.appendChild(tempDivElmt);
//
// //      cgTitleDiv1 = senchaExt.DomHelper.append('iobal_div', {
// //              tag : 'div',
// //              style : 'background-color: white',
// //              id : cgTitleDiv1Name,
// //              name : cgTitleDiv1Name
// //          });
//
//         //Create title table
//         PBalance = strPeriodBalance.split('|');
//         iobaldata = 'Balance |' + (Math.round((PBalance[1] - PBalance[7]) * 100) / 100) + '|' + (Math.round((PBalance[3] - PBalance[9]) * 100) / 100) + '|' + (Math.round((PBalance[5] - PBalance[11]) * 100) / 100);
//
//         newTitleTable = createIOsTableEx('iobal_tbl', '100%');
//         cgTitleDiv1.appendChild(newTitleTable);
//         createIOsBalCGTitle(newTitleTable, iobaldata, 'Balance');
//
//     }
//
//     /**
//      * Construct the collapsible display section for IOs detail data
//      * @param cgDiv
//      * @param unqID
//      * @param data
//      * @param cgTitle
//      */
//     //var cgDetailDiv1Name_major;
//     function loadIOsInfoEx1(cgDiv, unqID, data, cgTitle) {
//         var cgTitleDiv1Name ,
//             cgDetailDiv1Name ,
//             cgTitleDiv1 ,
//             cgDetailDiv,
//             newTitleTable,
//             tempDivElmt;
//
//         cgTitleDiv1Name = cgDiv + '_L1_' + unqID;
//         cgDetailDiv1Name = cgTitleDiv1Name + "_dl";
//
//         //cleanuplist.add(cgTitleDiv1Name);
//         //cleanuplist.add(cgDetailDiv1Name);
//
//         cgTitleDiv1 = document.getElementById(cgDiv);
//         tempDivElmt = document.createElement('div');
//         tempDivElmt.id = cgTitleDiv1Name;
//         tempDivElmt.setAttribute("style", "background-color: white;");
//         tempDivElmt.setAttribute("name", cgTitleDiv1Name);
//         cgTitleDiv1.appendChild(tempDivElmt);
//
// //      var cgTitleDiv1 = senchaExt.DomHelper.append(cgDiv, {
// //              tag : 'div',
// //              style : 'background-color: white',
// //              id : cgTitleDiv1Name,
// //              name : cgTitleDiv1Name
// //          });
//         //Create title table
//         newTitleTable = createIOsTableEx(cgTitleDiv1Name, '100%');
//
//         document.getElementById(cgTitleDiv1Name).appendChild(newTitleTable);
//         createIOsCGTotTitle(newTitleTable, data, cgTitleDiv1Name, cgTitle);
//
//         cgDetailDiv = document.getElementById(cgDiv);
//         tempDivElmt = document.createElement('div');
//         tempDivElmt.id = cgDetailDiv1Name;
//         tempDivElmt.setAttribute("style", "display: none");
//         tempDivElmt.setAttribute("name", cgDetailDiv1Name);
//         cgTitleDiv1.appendChild(tempDivElmt);
//
// //      var cgDetailDiv = senchaExt.DomHelper.append(cgDiv, {
// //              tag : 'div',
// //              id : cgDetailDiv1Name,
// //              name : cgDetailDiv1Name,
// //              style : 'display:none'
// //          });
//         $('#' + cgTitleDiv1Name).on('click', function (event) {
//             var theDiv2 ,
//                 oldTable ,
//                 strPeriod ,
//                 newTable ,
//                 aryPeriod,
//                 tstrTitle ,
//                 tstrItem ,
//                 tstrData ,
//                 tstrGroup ,
//                 tstrGroupTot ,
//                 tstrGroupTotLabel,
//                 aryData ,
//                 itemNum ,
//                 itemData ;
//             event.stopPropagation();
//             theDiv2 = document.getElementById(cgDetailDiv1Name);
//
//             if (theDiv2.style.display == "none") {
//
//                 oldTable = document.getElementById('table_' + cgDetailDiv1Name + '_L2_0');
//                 if (oldTable) {
//                     document.getElementById("expand_" + cgTitleDiv1Name).innerHTML = '<img src="' +  chla.global.imgPath + 'group-collapse.gif" alt="group-collapse"/>';
//                     theDiv2.style.display = "block";
//                 } else {
//                     strPeriod = "";
//                     if (data.length == 0) {
//                         strPeriod = '<tr><td class="greyline" align="center"> -- </td></tr>'
//                         var newTable = '<table width="100%" class="ApSegDataTbl1" border="0" cellspacing="0" cellpadding="0" id="table_' + cgDetailDiv1Name + '_L2_0">' + strPeriod + '</table>';
//                         theDiv2.innerHTML = newTable;
//                         //cleanuplist.add('table_' + cgDetailDiv1Name + '_L2_0');
//                     } else {
//                         aryPeriod;
//                         tstrTitle = '';
//                         tstrItem = '';
//                         tstrData = '';
//                         tstrGroup = '';
//                         tstrGroupTot = ['--', '--', '--'];
//                         aryData = ['--', '--', '--'];
//                         itemNum = 0;
//
//                         for (itemData = 0; itemData < data.length; itemData++) {
//                             tstrData = data[itemData];
//                             aryPeriod = tstrData.split('|');
//                             tstrGroup = aryPeriod[0].split('!');
//                             if (tstrItem != tstrGroup[1]) {
//                                 if (itemData > 0) {
//                                     strPeriod += '<tr><td width="2%" class="greyline" style="padding-left:15px;">&nbsp;</td><td width="33%" class="FieldLabelLft greyline" style="padding-left:10px;">' + tstrItem + '</td><td width="15%" class="FieldLabelLft textRight greyline cellPad">' + aryData[0] + '</td><td width="15%" class="FieldLabelLft textRight greyline cellPad">' + aryData[1] + '</td><td width="15%" class="FieldLabelLft textRight greyline cellPad">' + aryData[2] + '</td><td width="3%" class="FieldLabelLft textRight greyline">&nbsp;</td></tr>';
//                                     aryData[0] = '--';
//                                     aryData[1] = '--';
//                                     aryData[2] = '--';
//                                 }
//                                 tstrItem = tstrGroup[1];
//                             }
//                             if (tstrTitle != tstrGroup[0]) {
//
//                                 if (itemData > 0) {
//                                     tstrGroupTotLabel = tstrTitle + '|' + tstrGroupTot[0] + '|' + tstrGroupTot[1] + '|' + tstrGroupTot[2];
//                                     loadIOsInfoEx2(cgDetailDiv1Name, itemNum++, strPeriod, tstrGroupTotLabel);
//                                     strPeriod = "";
//                                     tstrGroupTot[0] = '--';
//                                     tstrGroupTot[1] = '--';
//                                     tstrGroupTot[2] = '--';
//                                 }
//                                 tstrTitle = tstrGroup[0];
//                             }
//
//                             aryData[aryPeriod[3]] = aryPeriod[1];
//                             tstrGroupTot[aryPeriod[3]] = aryPeriod[2];
//                         }
//                         tstrGroupTotLabel = tstrTitle + '|' + tstrGroupTot[0] + '|' + tstrGroupTot[1] + '|' + tstrGroupTot[2];
//                         strPeriod += '<tr><td width="2%" class="greyline"  style="padding-left:15px;" >&nbsp;</td><td width="33%" class="FieldLabelLft greyline" style="padding-left:10px;">' + tstrItem + '</td><td width="15%" class="FieldLabelLft textRight greyline cellPad">' + aryData[0] + '</td><td width="15%" class="FieldLabelLft textRight greyline cellPad">' + aryData[1] + '</td><td width="15%" class="FieldLabelLft textRight greyline cellPad">' + aryData[2] + '</td><td width="3%" class="FieldLabelLft textRight greyline">&nbsp;</td></tr>';
//                         loadIOsInfoEx2(cgDetailDiv1Name, itemNum++, strPeriod, tstrGroupTotLabel);
//                     }
//                     document.getElementById("expand_" + cgTitleDiv1Name).innerHTML = '<img src="' +   chla.global.imgPath + 'group-collapse.gif" alt="group-collapse"/>';
//                     theDiv2.style.display = "block";
//                 }
//             } else {
//                 theDiv2.style.display = "none";
//                 document.getElementById("expand_" + cgTitleDiv1Name).innerHTML = '<img src="' + chla.global.imgPath + 'group-expand.gif" alt="group-expand"/>';
//             }
//         });
//         $('#' + cgTitleDiv1Name).click();
//     }
//
//     /**
//      * Construct the collapsible display section for IOs detail data level 2
//      * @param cgDiv
//      * @param unqID
//      * @param data
//      * @param cgTitle
//      */
//     function loadIOsInfoEx2(cgDiv, unqID, data, cgTitle) {
//         var cgTitleDiv1Name,
//             cgDetailDiv1Name,
//             cgDetailDiv,
//             cgTitleDiv1,
//             newTitleTable,
//             tempDivElmt;
//
//         cgTitleDiv1Name = cgDiv + '_L2_' + unqID;
//         cgDetailDiv1Name = cgTitleDiv1Name + "_dl";
//
//         //cleanuplist.add(cgTitleDiv1Name);
//         //cleanuplist.add(cgDetailDiv1Name);
//
//         cgTitleDiv1 = document.getElementById(cgDiv);
//         tempDivElmt = document.createElement('div');
//         tempDivElmt.id = cgTitleDiv1Name;
//         tempDivElmt.setAttribute("style", "background-color: white;");
//         tempDivElmt.setAttribute("name", cgTitleDiv1Name);
//         cgTitleDiv1.appendChild(tempDivElmt);
//
// //      var cgTitleDiv1 = senchaExt.DomHelper.append(cgDiv, {
// //              tag : 'div',
// //              style : 'background-color: white',
// //              id : cgTitleDiv1Name,
// //              name : cgTitleDiv1Name
// //          });
//         //Create title table
//         newTitleTable = createIOsTableEx(cgTitleDiv1Name, '100%');
//
//         document.getElementById(cgTitleDiv1Name).appendChild(newTitleTable);
//         createIOsCGTitle(newTitleTable, cgTitle, cgTitleDiv1Name);
//
//         cgDetailDiv = document.getElementById(cgDiv);
//         tempDivElmt = document.createElement('div');
//         tempDivElmt.id = cgDetailDiv1Name;
//         tempDivElmt.setAttribute("style", "display: none");
//         tempDivElmt.setAttribute("name", cgDetailDiv1Name);
//         cgTitleDiv1.appendChild(tempDivElmt);
//
// //      var cgDetailDiv = senchaExt.DomHelper.append(cgDiv, {
// //              tag : 'div',
// //              id : cgDetailDiv1Name,
// //              name : cgDetailDiv1Name,
// //              style : 'display:none'
// //          });
//         $('#' + cgTitleDiv1Name).on('click',  function (event) {
//             var theDiv2,
//                 oldTable,
//                 newTable;
//             event.stopPropagation();
//             theDiv2 = document.getElementById(cgDetailDiv1Name);
//
//             if (theDiv2.style.display == "none") {
//                 oldTable = document.getElementById('table_' + cgDetailDiv1Name);
//                 if (oldTable) {
//                     document.getElementById("expand_" + cgTitleDiv1Name).innerHTML = '<img src="' +  chla.global.imgPath + 'group-collapse.gif" alt="group-collapse" style="padding-left:15px;"/>';
//                     theDiv2.style.display = "block";
//                 } else {
//                     //Create table and load data
//                     newTable = '<table width="100%" class="ApSegDataTbl1" border="0" cellspacing="0" cellpadding="0" id="table_' + cgDetailDiv1Name + '">' + data + '</table>';
//                     theDiv2.innerHTML = newTable;
//                     //cleanuplist.add('table_' + cgDetailDiv1Name);
//                     document.getElementById("expand_" + cgTitleDiv1Name).innerHTML = '<img src="' +  chla.global.imgPath + 'group-collapse.gif" alt="group-collapse"/>';
//                     theDiv2.style.display = "block";
//                 }
//             } else {
//                 theDiv2.style.display = "none";
//                 document.getElementById("expand_" + cgTitleDiv1Name).innerHTML = '<img src="' + chla.global.imgPath + 'group-expand.gif" alt="group-expand" style="padding-left:15px;"/>';
//             }
//         });
//         $('#' + cgTitleDiv1Name).click(); //load subitems
//         $('#' + cgTitleDiv1Name).click(); //collapse
//     }
//
//     /**
//      * Create the base table component for collapsible
//      * @param divId
//      * @param width
//      */
//     function createIOsTableEx(divId, width) {
// //      var newtable = senchaExt.DomHelper.createDom({
// //              tag : 'table',
// //              id : 'table_' + divId,
// //              cls : 'ApSegDataTbl1',
// //              border : '0',
// //              width : width
// //          });
//         var tempstr,
//             newtable =  document.createElement('table');
//         newtable.id = 'table_' + divId;
//         tempstr =  "border:0 ; width:" + width;
//         newtable.setAttribute("style",tempstr);
//         newtable.setAttribute("class",'ApSegDataTbl1');
//
//         return newtable;
//     }
//
//     /**
//      * Create the IOs collapsible component title table row/cell
//      * @param newtable
//      * @param data
//      * @param cgTitleDiv1Name
//      */
//     function createIOsCGTitle(newtable, data, cgTitleDiv1Name) {
//         var aryPeriod ,
//             field ,
//             row1 ,
//             cell15 ,
//             cell13 ,
//             cell14 ,
//             cell15 ,
//             cell16 ,
//             cell17 ;
//
//         // Graphic Cell
//         aryPeriod = data.split('|');
//         field = [];
//         if (aryPeriod[0] == 'Stool Output') {
//             field.push(aryPeriod[0] + '<br/><span class="eapps-unitsHO"> Last stool (' + last_stool + ')</span>');
//             field.push(aryPeriod[1] + '<br/>&nbsp;');
//             field.push(aryPeriod[2] + '<br/>&nbsp;');
//             field.push(aryPeriod[3] + '<br/>&nbsp;');
//         } else if (aryPeriod[0] == 'Urine Output') {
//             field.push(aryPeriod[0] + '<br/><span class="eapps-unitsHO">Rate (ml/kg/hr)<span>');
//             field.push(aryPeriod[1] + '<br/><span class="eapps-unitsHO">(' + chla.global.aryUrineRate[0] + ')</span>');
//             field.push(aryPeriod[2] + '<br/><span class="eapps-unitsHO">(' + chla.global.aryUrineRate[1] + ')</span>');
//             field.push(aryPeriod[3] + '<br/><span class="eapps-unitsHO">(' + chla.global.aryUrineRate[2] + ')</span>');
//         } else {
//             field.push(aryPeriod[0]);
//             field.push(aryPeriod[1]);
//             field.push(aryPeriod[2]);
//             field.push(aryPeriod[3]);
//         }
//         row1 = newtable.insertRow(0);
//
//         cell15 = row1.insertCell(0);
//         cell15.setAttribute('width', '2%');
//         cell15.setAttribute('class', 'AplSegGenLabel2 level2 textRight');
//         cell15.setAttribute('id', 'expand_' + cgTitleDiv1Name);
//
//         cell15.innerHTML = '<img src="' + chla.global.imgPath + 'group-expand.gif" alt="group-expand"/>'; //tree ioc
//         // Section Title
//         cell13 = row1.insertCell(1);
//         cell13.setAttribute('align', 'left');
//         cell13.setAttribute('width', '30%');
//         cell13.setAttribute('class', 'AplSegGenLabel2 level2');
//         cell13.innerHTML = field[0];
//         // MN-now
//         cell14 = row1.insertCell(2);
//         cell14.setAttribute('align', 'right');
//         cell14.setAttribute('width', '15%');
//         cell14.setAttribute('class', 'AplSegGenLabel2 level2 textRight cellPad');
//         cell14.innerHTML = field[1];
//         // Day1
//         cell15 = row1.insertCell(3);
//         cell15.setAttribute('align', 'right');
//         cell15.setAttribute('width', '15%');
//         cell15.setAttribute('class', 'AplSegGenLabel2 level2 textRight cellPad');
//         cell15.innerHTML = field[2];
//         // Day2
//         cell16 = row1.insertCell(4);
//         cell16.setAttribute('align', 'right');
//         cell16.setAttribute('width', '15%');
//         cell16.setAttribute('class', 'AplSegGenLabel2 level2 textRight cellPad');
//         cell16.innerHTML = field[3];
//         // spacer
//         cell17 = row1.insertCell(5);
//         cell17.setAttribute('align', 'right');
//         cell17.setAttribute('width', '3%');
//         cell17.setAttribute('class', 'AplSegGenLabel2 level2 textRight');
//         cell17.innerHTML = '&nbsp;';
//     }
//
//     /**
//      * Create the IOs collapsible component balance title table row/cell
//      * @param newtable
//      * @param data
//      * @param cgTitleDiv1Name
//      */
//     function createIOsBalCGTitle(newtable, data, cgTitleDiv1Name) {
//         var aryPeriod ,
//             row1 ,
//             cell15 ,
//             cell13 ,
//             cell13a ,
//             cell14 ,
//             cell15 ,
//             cell16 ,
//             cell17;
//         // Graphic Cell
//         aryPeriod = data.split('|');
//         row1 = newtable.insertRow(0);
//
//         cell15 = row1.insertCell(0);
//         cell15.setAttribute('width', '2%');
//         cell15.setAttribute('class', 'AplSegGenLabel2  textRight');
//         cell15.setAttribute('id', 'expand_' + cgTitleDiv1Name);
//
//         cell15.innerHTML = '&nbsp;'; //tree ioc
//         // Section Title
//         cell13 = row1.insertCell(1);
//         cell13.setAttribute('align', 'left');
//         cell13.setAttribute('width', '30%');
//         cell13.setAttribute('class', 'AplSegGenLabel2 txtBold');
//         cell13.innerHTML = aryPeriod[0];
//         // Section spaccer
//         cell13a = row1.insertCell(2);
//         cell13a.setAttribute('align', 'left');
//         cell13a.setAttribute('width', '10%');
//         cell13a.setAttribute('class', 'AplSegGenLabel2');
//         cell13a.innerHTML = '&nbsp;';
//         // MN-now
//         cell14 = row1.insertCell(3);
//         cell14.setAttribute('align', 'right');
//         cell14.setAttribute('width', '15%');
//         cell14.setAttribute('class', 'AplSegGenLabel2  textRight cellPad txtBold');
//         cell14.innerHTML = aryPeriod[1];
//         // Day1
//         cell15 = row1.insertCell(4);
//         cell15.setAttribute('align', 'right');
//         cell15.setAttribute('width', '15%');
//         cell15.setAttribute('class', 'AplSegGenLabel2  textRight cellPad txtBold');
//         cell15.innerHTML = aryPeriod[2];
//         // Day2
//         cell16 = row1.insertCell(5);
//         cell16.setAttribute('align', 'right');
//         cell16.setAttribute('width', '15%');
//         cell16.setAttribute('class', 'AplSegGenLabel2  textRight cellPad txtBold');
//         cell16.innerHTML = aryPeriod[3];
//         // spacer
//         cell17 = row1.insertCell(6);
//         cell17.setAttribute('align', 'right');
//         cell17.setAttribute('width', '3%');
//         cell17.setAttribute('class', 'AplSegGenLabel2  textRight txtBold');
//         cell17.innerHTML = '&nbsp;';
//     }
//
//     /**
//      * Create the IOs collapsible component title table row/cell
//      * @param newtable
//      * @param data
//      * @param cgTitleDiv1Name
//      */
//     function createIOsCGTotTitle(newtable, data, cgTitleDiv1Name, cgTitle) {
//         var strPeriod,
//             aryPeriod ,
//             row1 ,
//             cell15 ,
//             cell13 ,
//             cell13 ,
//             cell14 ,
//             cell15 ,
//             cell16 ,
//             cell17 ;
//
//         // Graphic Cell
//         strPeriod;
//         strPeriod = data.shift();
//         aryPeriod = strPeriod.split('|');
//
//         row1 = newtable.insertRow(0);
//         cell15 = row1.insertCell(0);
//         cell15.setAttribute('width', '2%');
//         cell15.setAttribute('class', 'AplSegGenLabel2');
//         cell15.setAttribute('id', 'expand_' + cgTitleDiv1Name);
//         cell15.innerHTML = '<img src="' + chla.global.imgPath + 'group-expand.gif" alt="group-expand"/>'; //tree ioc
//         // Section Title
//         cell13 = row1.insertCell(1);
//         cell13.setAttribute('align', 'left');
//         cell13.setAttribute('width', '30%');
//         cell13.setAttribute('class', 'AplSegGenLabel2 ');
//         cell13.innerHTML = cgTitle == 'Intake' ? 'Intake<br/><span class="eapps-unitsHO">Rate (ml/kg/day)</span>' : cgTitle;
//         // Section spaccer
//         cell13 = row1.insertCell(2);
//         cell13.setAttribute('align', 'left');
//         cell13.setAttribute('width', '4%');
//         cell13.setAttribute('class', 'AplSegGenLabel2');
//         cell13.innerHTML = '&nbsp;';
//         // MN-now
//         cell14 = row1.insertCell(3);
//         cell14.setAttribute('align', 'right');
//         cell14.setAttribute('width', '15%');
//         cell14.setAttribute('class', 'AplSegGenLabel2 textRight cellPad');
//         cell14.innerHTML = cgTitle == 'Intake' ? aryPeriod[1] + '<br><span class="eapps-unitsHO">(' + chla.global.aryIntakeRate[0] + ')</span>' : aryPeriod[1];
//         // Day1
//         cell15 = row1.insertCell(4);
//         cell15.setAttribute('align', 'right');
//         cell15.setAttribute('width', '15%');
//         cell15.setAttribute('class', 'AplSegGenLabel2 textRight cellPad');
//         cell15.innerHTML = cgTitle == 'Intake' ? aryPeriod[3] + '<br><span class="eapps-unitsHO">(' + chla.global.aryIntakeRate[1] + ')</span>' : aryPeriod[3];
//         // Day2
//         cell16 = row1.insertCell(5);
//         cell16.setAttribute('align', 'right');
//         cell16.setAttribute('width', '15%');
//         cell16.setAttribute('class', 'AplSegGenLabel2 textRight cellPad');
//         cell16.innerHTML = cgTitle == 'Intake' ? aryPeriod[5] + '<br><span class="eapps-unitsHO">(' + chla.global.aryIntakeRate[2] + ')</span>' : aryPeriod[5];
//         // spacer
//         cell17 = row1.insertCell(6);
//         cell17.setAttribute('align', 'right');
//         cell17.setAttribute('width', '3%');
//         cell17.setAttribute('class', 'AplSegGenLabel2 textRight ');
//         cell17.innerHTML = '&nbsp;';
//     }
//
//     function CombineUrineAndMixedStool(data, kg) {
//         var p, mixed,total, e;
//         for ( p = 0; p < data.PERIOD.length; p++) {
//             if (data.PERIOD[p].MIXED_URINE_STOOL > 0) {
//                 mixed = 0,
//                     total = 0;
//                 for (e = 0; e < data.PERIOD[p].EVENT_SET.length; e++) {
//                     if (data.PERIOD[p].EVENT_SET[e].DISPLAY == "Urine Output") {
//                         data.PERIOD[p].EVENT_SET[e].EVENT_CNT += 1;
//                         data.PERIOD[p].EVENT_SET[e].TOTAL += data.PERIOD[p].MIXED_URINE_STOOL;
//                         data.PERIOD[p].EVENT_SET[e].EVENT.push({
//                             EVENT_ID : 0,
//                             DISPLAY : "Mixed Urine Stool",
//                             TOTAL : data.PERIOD[p].MIXED_URINE_STOOL
//                         });
//                         mixed = data.PERIOD[p].MIXED_URINE_STOOL;
//                         total = data.PERIOD[p].EVENT_SET[e].TOTAL;
//                         data.PERIOD[p].MIXED_URINE_STOOL = 0;
//                     }
//                 }
//                 data.PERIOD[p].OUTPUT_RATE = total / kg / (
//                         new Date(chla.eApps.gFuncs.convertDate(data.PERIOD[p].BEG_DT_TM)).getDate() == new Date().getDate() ? (new Date().getHours() + new Date().getMinutes() / 60) : 24);
//             }
//         }
//         return data;
//     }
// };


//Lab Results
chla.labs = function () {};
chla.labs.prototype = new MPage.Component();
chla.labs.prototype.constructor = MPage.Component;
chla.labs.prototype.base = MPage.Component.prototype;
chla.labs.prototype.name = "chla.labs";
chla.labs.prototype.cclProgram = "chla_ca_mp_md_labs_json";
chla.labs.prototype.cclParams = [];
chla.labs.prototype.cclDataType = "JSON";
chla.labs.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("encounterId");
};

chla.labs.prototype.render = function () {
    var compContent = [],
        component   = this,
        compContentDiv,
        elementObj,
        dataDef     = {
            LABS: [{LAB_CNT: 0}]
        },
        appLAB      = chla.eAppsClass.neo(),
        sectionBodyHdr = [
            '<table class="ApSegDataTbl1" style="border:0 ; width:100%" id="table_<#=secTableId#>_dl"><tbody><tr><td width="15%">',
            '<table class="SegDataTbl" align="left" border="0" cellpadding="0" cellspacing="0" width="100%"><tbody>'
        ],
        sectionBodyFtr = [
            '</tbody></table></td></tr></tbody></table>'
        ],
        sectionBodyHdr1 = [
            '<table class="ApSegDataTbl1" style="border:0 ; width:100%" id="table_<#=secTableId#>_dl"><tbody><tr><td width="15%">',
            '<table class="SegDataTbl" align="left" border="0" cellpadding="0" cellspacing="0" width="100%"><tbody>'
        ],
        sectionBodyFtr1 = [
            '</tbody></table></td></tr></tbody></table>'
        ];
    elementObj      = component.data.RPTDATA;
    component.eApps = {
        cc_id               : component.name.replace('.', '_'),
        CSSBehaviors        : appLAB.gCSSBehaviorCls.neo(),
        SaveButtonAction    : null,
        TestSAP             : null,
        CC_SectionManagement: {
            sectionlist: []
        },
        encounterId         : component.getProperty('encounterId'),
        personId            : component.getProperty('personId'),
        userId              : component.getProperty('userId'),
        appNS               : appLAB

    };
    if (elementObj.LABS[0].LAB_CNT != 'undefined') {
        createLabs24Rpt(elementObj['LABS']);
    } else {
        createNoLab24RecordRows("lab24_div");
    }
    compContentDiv = appLAB.gFuncs.parseTemplate(appLAB.gTmplts.gCcMainDiv.join(''), {
        cc_id      : component.eApps.cc_id,
        mainSection: compContent.join('')
    });
    appLAB.gFuncs.Log_CC(component, compContentDiv);
    component.getTarget().innerHTML = compContentDiv;
    component.eApps.CC_SectionManagement.sectionlist.forEach(
        function(strSectID) {
            var htmlSecCtlObj = appLAB.gSectionHeaderCtlCls.neo();
            component.eApps.CC_SectionManagement[strSectID].Count =(component.name === 'chla.labs'?'':0);
            htmlSecCtlObj.initToggle(
                component.eApps.CSSBehaviors,
                component.eApps.CC_SectionManagement[strSectID] );
        }
    );
    function processH5_Section(sectionData) {
        var sectionObj = appLAB.gSectionHeaderCtlCls.neo(),
            strRetValue;
        sectionObj.resetValues(sectionObj);
        sectionObj.initValues({
            idLabel      : sectionData.SectionID,
            TLabel1      : sectionData.TLabel1,
            SectionClosed: sectionData.SectionClosed,
            SectionCnt   : '',
            SectionCntVal: (component.name === 'chla.labs'? 1: ''),
            ContentBody  : sectionData.Body,
            TemplateType : sectionData.TemplateType,
            CustIcon     : (component.name === 'chla.labs'? 'auto': 'Ignore')
        });
        strRetValue              = sectionObj.generateHTML(component.eApps.CSSBehaviors);
        sectionData.SectionDivID = sectionObj.SectionDivID;
        return strRetValue;
    }

    /**
     * Process the Labs 24 data for different reporting methods
     * @param data {Array} elementObj['LABS']
     */
    function createLabs24Rpt(data) {
        var noDataFlag   = 0,
            vLabData,
            dataDef      = {
                "LABS": [{
                    "LAB_CNT"          : 0,
                    "LAB"              : [],
                    "CHEM_PANEL_SORTED": [],
                    "CBC_SORTED"       : [],
                    "OTHER_SORTED"     : [],
                    "CHEM_PANEL_CNT"   : 0,
                    "CBC_CNT"          : 0,
                    "OTHER_CNT"        : 0
                }]
            },
            Labs24Layout = [
                '<div id="<#=cc_id#>lab24_cbc_div"  style="text-align:left"><#=CBC#></div>',
                '<div id="<#=cc_id#>lab24_chem_div" style="text-align:left"><#=ChemPanel#></div>',
                '<div id="<#=cc_id#>lab24_oth_div"  style="text-align:left"><#=LabsOther#></div>'
            ];
        // document.getElementById("lab24_div").innerHTML = Labs24Layout.join('');
        vLabData         = data[0];
        if (vLabData.CBC_CNT > 0) {
            noDataFlag = 1;
            compContent.push(
                appLAB.gFuncs.parseTemplate(Labs24Layout[0], {
                        cc_id: component.eApps.cc_id,
                        CBC: createLabsCBC(vLabData)
                    }
                )
            );
        }
        if (vLabData.CHEM_PANEL_CNT > 0) {
            noDataFlag = 1;
            compContent.push(
                appLAB.gFuncs.parseTemplate(Labs24Layout[1], {
                        cc_id: component.eApps.cc_id,
                        ChemPanel: createLabsChemPanel(vLabData)
                    }
                )
            )
        }
        if (vLabData.OTHER_CNT > 0) {
            noDataFlag = 1;
            compContent.push(
                appLAB.gFuncs.parseTemplate(Labs24Layout[2], {
                        cc_id: component.eApps.cc_id,
                        LabsOther: createLabsOther(vLabData)
                    }
                )
            )
        }
        if (noDataFlag == 0) {
            compContent.push(createNoLab24RecordRows("lab24_div"));
        }
    }

    /**
     *
     * @param dataSrc {Array} elementObj['LABS']
     * @returns {string}
     */
    function processChemPnlevent(dataSrc) {
        var eventStates = {
                "ABN" : true,
                "HI"  : true,
                "LOW" : true,
                "CRIT": true
            },
            data     = {
                NORMALCY  : '',
                RESULT_VAL: ''
            },
            arrRet      = [];
        data = dataSrc;
        if (eventStates.hasOwnProperty(data.NORMALCY)) {
            arrRet.push(
                '&nbsp;<span class="abnormal">',
                data.RESULT_VAL,
                '</span>');
        } else {
            arrRet.push(
                '&nbsp;<span>',
                data.RESULT_VAL,
                '</span>');
        }
        return arrRet.join('');
    }
    /**
     *
     * @param dataSrc
     * @returns {string}
     */
    function processCBCevent(dataSrc) {
        var eventStates = {
                "ABN" : true,
                "HI"  : true,
                "LOW" : true,
                "CRIT": true
            },
            data     = {
                NORMALCY  : '',
                RESULT_VAL: ''
            },
            arrRet      = [];
        data = dataSrc;
        if (eventStates.hasOwnProperty(data.NORMALCY)) {
            arrRet.push('&nbsp;<span class="abnormal">',
                data.RESULT_VAL,
                '</span>');
        } else {
            arrRet.push('&nbsp;<span>',
                data.RESULT_VAL,
                '</span>');
        }
        return arrRet.join('');
    }

    /**
     * Creates the format display string for the LabsCBC data
     * @param dataSrc {Array} elementObj['LABS']
     * @returns {string}
     */
    function createLabsCBC(dataSrc) {
        var CBC_HtmlContent = [],
            eventStates     = {
                "ABN" : true,
                "HI"  : true,
                "LOW" : true,
                "CRIT": true
            },
            sectionDataCfg,
            strSectID,
            dataStore       = {
                items: ['', '']
            },
            vIdxA           = 0,
            vLabsTempRowCnt = 0,
            vLabRow         = [],
            vCbcWbc         = "~~~~~",
            vCbcHgb         = "~~~~~",
            vCbcPlt         = "~~~~~",
            vCbcHct         = "~~~~~",
            vCbcWbcEventCd  = '743377.0',
            vCbcHgbEventCd  = '743407.0',
            vCbcPltEventCd  = '743409.0',
            vCbcHctEventCd  = '743408.0',
            vMsgText        = [],
            vCbcIdx,
            vEventIdx,
            vDisplayLine    = [],
            lenCnt,
            arrWrk          = [],
            evtItemGrp,
            evtItem,
            data         = {
                LAB       : [{
                    EVENT_CNT      : 0,
                    EVENT          : [{
                        EVENT_CD  : 0,
                        DISPLAY   : '',
                        RESULT_VAL: '',
                        NORMALCY  : ''
                    }
                    ],
                    EVENT_END_DT_TM: ''
                }
                ],
                CBC_CNT   : 0,
                CBC_SORTED: [
                    {UNSORTED_IDX: 0}
                ]
            };
        data = dataSrc;
        for (vCbcIdx = data.CBC_CNT - 1; vCbcIdx >= 0; vCbcIdx--) {
            vIdxA         = data.CBC_SORTED[vCbcIdx].UNSORTED_IDX - 1;
            evtItemGrp    = data.LAB[vIdxA];
            arrWrk.length = 0;
            arrWrk.push('Blood Cell Count&nbsp;<span class="eapps-unitsHO">(',
                chla.eApps.gFuncs.convertDate(evtItemGrp.EVENT_END_DT_TM),
                ')</span>');
            dataStore.items[0] = arrWrk.join('');
            vLabRow.length     = 0;
            vLabsTempRowCnt    = 0;
            for (vEventIdx = 0, lenCnt = evtItemGrp.EVENT_CNT; vEventIdx < lenCnt; vEventIdx++) {
                evtItem = evtItemGrp.EVENT[vEventIdx];
                if (evtItem.EVENT_CD == vCbcWbcEventCd) {
                    vCbcWbc = processCBCevent(evtItem);

                } else if (evtItem.EVENT_CD == vCbcHgbEventCd) {
                    vCbcHgb = processCBCevent(evtItem);

                } else if (evtItem.EVENT_CD == vCbcPltEventCd) {
                    vCbcPlt = processCBCevent(evtItem);

                } else if (evtItem.EVENT_CD == vCbcHctEventCd) {
                    vCbcHct = processCBCevent(evtItem);

                } else {
                    vLabsTempRowCnt     = vLabsTempRowCnt + 1;
                    vDisplayLine.length = 0;
                    vDisplayLine.push(
                        '&nbsp;<span class="grayLabel">',                 //0
                        evtItem.DISPLAY,                            //1
                        '</span>:&nbsp;<span>',                     //2
                        evtItem.RESULT_VAL,                         //3
                        '</span>');                                 //4
                    if (eventStates.hasOwnProperty(evtItem.NORMALCY)) {
                        vDisplayLine[2] = '</span>:&nbsp;<span class="abnormal">';
                    }
                    vLabRow.push('&nbsp;<span class="grayLabel">',
                        vDisplayLine.join('').replace(' ', '&nbsp;'),
                        '&nbsp;&nbsp; ');
                }
            }
            vMsgText.push(
                '<span class="fishbone">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\',
                formatLabs24Element(vCbcHgb),//vCbcHgb,
                '/',
                '<br/>');
            vMsgText.push(
                formatLabs24Element(vCbcWbc),//vCbcWbc,
                '&nbsp;------&nbsp;',
                formatLabs24Element(vCbcPlt),//vCbcPlt,
                '<br/>');
            vMsgText.push(
                '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/',
                formatLabs24Element(vCbcHct),//vCbcHct,
                '\\</span>',
                '<br/><br/>');
            arrWrk.length = 0;
            strSectID     = component.eApps.cc_id + 'CBC' + vCbcIdx;
            arrWrk.push(
                appLAB.gFuncs.parseTemplate(sectionBodyHdr.join(''), {
                    secTableId: strSectID
                }));
            arrWrk.push(
                vMsgText.join(''));
            arrWrk.push(
                vLabsTempRowCnt > 0 ? vLabRow.join('') : '<br/>');
            arrWrk.push(
                sectionBodyFtr.join(''));
            dataStore.items[1] = arrWrk.join('');
            component.eApps.CC_SectionManagement.sectionlist.push(strSectID);
            sectionDataCfg                                  = appLAB.gSectionDataCls.neo(
                'H5',     //T_type,
                strSectID,// SecId,
                dataStore.items[0],  // TLblId,
                'auto',   // secClsd,
                'H5',     // SecLvl,
                'auto'    // SecTgl);
            );
            sectionDataCfg.Body                             = dataStore.items[1];
            sectionDataCfg.SectionCnt                       = '';
            sectionDataCfg.SectionCntVal                    = '';
            component.eApps.CC_SectionManagement[strSectID] = sectionDataCfg;
            CBC_HtmlContent.push(processH5_Section(sectionDataCfg));
        }
        return CBC_HtmlContent.join('');
    }
    /**
     * Format the data value strings for the Labs 24 numerical data for 5 digit with 1 possible decimal value
     * @param labItem
     * @return string - retItem
     */
    function formatLabs24Element(labItem) {
        var retItem = '';
        if (labItem.indexOf('.') < 1) {
            // no decimal point present
            switch (labItem.length) {
                case 1:
                    retItem = "&nbsp;&nbsp;&nbsp;" + labItem + '&nbsp;';
                    break;
                case 2:
                    retItem = "&nbsp;&nbsp;" + labItem + '&nbsp;';
                    break;
                case 3:
                    retItem = "&nbsp;" + labItem + '&nbsp;';
                    break;
                case (1 + 13):
                    retItem = "&nbsp;&nbsp;&nbsp;" + labItem + '&nbsp;';
                    break;
                case (2 + 13):
                    retItem = "&nbsp;&nbsp;" + labItem + '&nbsp;';
                    break;
                case (3 + 13):
                    retItem = "&nbsp;" + labItem + '&nbsp;';
                    break;
                case (1 + 30):
                    retItem = "&nbsp;&nbsp;&nbsp;" + labItem + '&nbsp;';
                    break;
                case (2 + 30):
                    retItem = "&nbsp;&nbsp;" + labItem + '&nbsp;';
                    break;
                case (3 + 30):
                    retItem = "&nbsp;" + labItem + '&nbsp;';
                    break;
                default:
                    retItem = labItem + '&nbsp;';
                    break;
            }
        } else {
            // decimal point present
            switch (labItem.length) {
                case 1:
                    retItem = "&nbsp;&nbsp;&nbsp;&nbsp;" + labItem;
                    break;
                case 2:
                    retItem = "&nbsp;&nbsp;&nbsp;" + labItem;
                    break;
                case 3:
                    retItem = "&nbsp;&nbsp;" + labItem;
                    break;
                case 4:
                    retItem = '&nbsp;' + labItem;
                    break;
                case (1 + 13): //13 is the amount of characters added in tags <span></span>
                    retItem = "&nbsp;&nbsp;&nbsp;" + labItem + '&nbsp;';
                    break;
                case (2 + 13):
                    retItem = "&nbsp;&nbsp;" + labItem + '&nbsp;';
                    break;
                case (3 + 13):
                    retItem = "&nbsp;&nbsp;" + labItem;
                    break;
                case (4 + 13):
                    retItem = "&nbsp;" + labItem;
                    break;
                case (1 + 30): //30 is the amount of characters added in tags <span class="abnormal"></span>
                    retItem = " &nbsp;&nbsp;&nbsp;" + labItem + '&nbsp;';
                    break;
                case (2 + 30):
                    retItem = "&nbsp;&nbsp;" + labItem + '&nbsp;';
                    break;
                case (3 + 30):
                    retItem = "&nbsp;&nbsp;" + labItem;
                    break;
                case (4 + 30):
                    retItem = "&nbsp;" + labItem;
                    break;
                default:
                    retItem = labItem;
                    break;
            }
        }
        return retItem;
    }
    /**
     * Creates the format display string for the LabsChemPanel data
     * @param dataSrc {Array} elementObj['LABS']
     * @returns {string}
     */
    function createLabsChemPanel(dataSrc) {
        var ChemPnlHtmlContent       = [],
            eventStates              = {
                "ABN" : true,
                "HI"  : true,
                "LOW" : true,
                "CRIT": true
            },
            msgText                  = [],
            dataStore                = {items: ['', '']},
            idxA                     = 0,
            LABS_TEMP_ROW_CNT        = 0,
            LAB_ROW                  = [],
            CHEM_PANEL_NA            = "~~~~~",
            CHEM_PANEL_CL            = "~~~~~",
            CHEM_PANEL_BUN           = "~~~~~",
            CHEM_PANEL_K             = "~~~~~",
            CHEM_PANEL_CO2           = "~~~~~",
            CHEM_PANEL_CR            = "~~~~~",
            CHEM_PANEL_CA            = "~~~~~",
            CHEM_PANEL_GLUC          = "~~~~~",
            CHEM_PANEL_NA_EVENT_CD   = '743234.0',
            CHEM_PANEL_CL_EVENT_CD   = '743033.0',
            CHEM_PANEL_BUN_EVENT_CD  = '743023.0',
            CHEM_PANEL_K_EVENT_CD    = '743200.0',
            CHEM_PANEL_CO2_EVENT_CD  = '743522.0',
            CHEM_PANEL_CR_EVENT_CD   = '1230211.0',
            CHEM_PANEL_CA_EVENT_CD   = '743026.0',
            CHEM_PANEL_GLUC_EVENT_CD = '743083.0',
            CHEM_PANEL_IDX,
            EVENT_IDX,
            vDisplayLine             = [],
            data                  = {
                LAB              : [{
                    EVENT_CNT      : 0,
                    EVENT          : [{
                        EVENT_CD  : 0,
                        DISPLAY   : '',
                        RESULT_VAL: '',
                        NORMALCY  : ''
                    }
                    ],
                    EVENT_END_DT_TM: ''
                }
                ],
                CHEM_PANEL_CNT   : 0,
                CHEM_PANEL_SORTED: [
                    {UNSORTED_IDX: 0}
                ]
            },
            lenCnt,
            evtItemGrp,
            evtItem,
            arrWrk                   = [],
            strSectID,
            sectionDataCfg;
        data = dataSrc;
        for (CHEM_PANEL_IDX = data.CHEM_PANEL_CNT - 1; CHEM_PANEL_IDX >= 0; CHEM_PANEL_IDX--) {
            LAB_ROW.length = 0;
            msgText.length = 0;
            idxA           = data.CHEM_PANEL_SORTED[CHEM_PANEL_IDX].UNSORTED_IDX - 1;
            evtItemGrp     = data.LAB[idxA];
            arrWrk.length  = 0;
            arrWrk.push(
                "Chem Panel&nbsp;<span class='eapps-unitsHO'>(",
                chla.eApps.gFuncs.convertDate(evtItemGrp.EVENT_END_DT_TM),
                ')</span>');
            dataStore.items[0] = arrWrk.join('');
            for (EVENT_IDX = 0, lenCnt = evtItemGrp.EVENT_CNT; EVENT_IDX < lenCnt; EVENT_IDX++) {
                evtItem = data.LAB[idxA].EVENT[EVENT_IDX];
                if (evtItem.EVENT_CD == CHEM_PANEL_NA_EVENT_CD) {
                    CHEM_PANEL_NA = processChemPnlevent(evtItem);

                } else if (evtItem.EVENT_CD == CHEM_PANEL_CL_EVENT_CD) {
                    CHEM_PANEL_CL = processChemPnlevent(evtItem);

                } else if (evtItem.EVENT_CD == CHEM_PANEL_BUN_EVENT_CD) {
                    CHEM_PANEL_BUN = processChemPnlevent(evtItem);

                } else if (evtItem.EVENT_CD == CHEM_PANEL_K_EVENT_CD) {
                    CHEM_PANEL_K = processChemPnlevent(evtItem);

                } else if (evtItem.EVENT_CD == CHEM_PANEL_CO2_EVENT_CD) {
                    CHEM_PANEL_CO2 = processChemPnlevent(evtItem);

                } else if (evtItem.EVENT_CD == CHEM_PANEL_CR_EVENT_CD) {
                    CHEM_PANEL_CR = processChemPnlevent(evtItem);

                } else if (evtItem.EVENT_CD == CHEM_PANEL_CA_EVENT_CD) {
                    CHEM_PANEL_CA = processChemPnlevent(evtItem);

                } else if (evtItem.EVENT_CD == CHEM_PANEL_GLUC_EVENT_CD) {
                    CHEM_PANEL_GLUC = processChemPnlevent(evtItem);

                } else {
                    LABS_TEMP_ROW_CNT += 1;
                    vDisplayLine.length = 0;
                    vDisplayLine.push(
                        '<span class="grayLabel">',     //0
                        evtItem.DISPLAY,                //1
                        "</span>:&nbsp;<span>",         //2
                        evtItem.RESULT_VAL,             //3
                        "</span>");
                    if (eventStates.hasOwnProperty(evtItem.NORMALCY)) {
                        vDisplayLine[2] = "</span>:&nbsp;<span class='abnormal'>";
                    }
                    vDisplayLine[1].replace(' ', '&nbsp;');
                    LAB_ROW.push(
                        '<span style="color:#666666">',
                        vDisplayLine.join(''),
                        '&nbsp;&nbsp; ','</span>');
                }
            }
            msgText.push(
                '<span class="fishbone">&nbsp;',
                formatLabs24Element(CHEM_PANEL_NA),
                "|",
                formatLabs24Element(CHEM_PANEL_CL),
                "|",
                formatLabs24Element(CHEM_PANEL_BUN),
                "/");
            if (CHEM_PANEL_CA != "~~~~~") {
                msgText.push(
                    " Ca:",
                    formatLabs24Element(CHEM_PANEL_CA),
                    " ");
            }
            msgText.push('<br/>');
            msgText.push(
                '&nbsp;-----+-----+-----&nbsp;',
                formatLabs24Element(CHEM_PANEL_GLUC),
                ' <br/>');
            msgText.push(
                "&nbsp;",
                formatLabs24Element(CHEM_PANEL_K),
                "|",
                formatLabs24Element(CHEM_PANEL_CO2),
                "|",
                formatLabs24Element(CHEM_PANEL_CR),
                "\\</span>");
            msgText.push('<br/><br/>');
            strSectID     = component.eApps.cc_id + 'ChemPnl' + CHEM_PANEL_IDX;
            arrWrk.length = 0;
            arrWrk.push(
                appLAB.gFuncs.parseTemplate(sectionBodyHdr.join(''), {
                    secTableId: strSectID
                }));
            arrWrk.push(msgText.join(''));
            if (LABS_TEMP_ROW_CNT > 0) {
                arrWrk.push(LAB_ROW.join(''));
            }
            arrWrk.push(
                sectionBodyFtr.join(''));
            dataStore.items[1] = arrWrk.join('');
            component.eApps.CC_SectionManagement.sectionlist.push(strSectID);
            sectionDataCfg = appLAB.gSectionDataCls.neo(
                'H5',               // T_type,
                strSectID,          // SecId,
                dataStore.items[0], // TLblId,
                'auto',             // secClsd,
                'H5',               // SecLvl,
                'auto'              // SecTgl);
            );
            arrWrk.push(
                appLAB.gFuncs.parseTemplate(sectionBodyHdr1.join(''), {
                    secTableId: strSectID
                }));
            sectionDataCfg.Body                             = dataStore.items[1];
            sectionDataCfg.SectionCnt                       = '';
            sectionDataCfg.SectionCntVal                    = '';
            component.eApps.CC_SectionManagement[strSectID] = sectionDataCfg;
            ChemPnlHtmlContent.push(processH5_Section(sectionDataCfg));
        }
        return ChemPnlHtmlContent.join('');
    }
    /**
     * Creates the format display string for the LabsOther data
     * @param dataSrc {Array} elementObj['LABS']
     * @returns {string}
     */
    function createLabsOther(dataSrc) {
        var LabsOtherHtml     = [],
            msgText           = [],
            dataStore         = {items: ['', '']},
            LABS_TEMP_ROW_CNT = 0,
            LAB_ROW           = [],
            TEMP_DT_TM,
            OTHER_IDX,
            LAB_IDX,
            EVENT_IDX,
            data           = {
                LAB         : [{
                    EVENT_CNT      : 0,
                    EVENT          : [{
                        EVENT_CD    : 0,
                        DISPLAY     : '',
                        RESULT_VAL  : '',
                        NORMALCY    : '',
                        RESULT_UNITS: ''
                    }
                    ],
                    EVENT_END_DT_TM: ''
                }
                ],
                OTHER_CNT   : 0,
                OTHER_SORTED: [
                    {UNSORTED_IDX: 0}
                ]
            },
            lenCnt,
            evtItemGrp,
            evtItem,
            arrWrk            = [],
            strWrk,
            strSectID,
            sectionDataCfg,
            OthersLab         = [
                '<#=rowStart#>',
                '<td class="SegFieldLftAlt" width="25%">',
                '<#=DISPLAY#>',
                '</td><td class="SegValLft" style="width:6em; min-width:6em;" ><#=HtmlClass#>',
                '<#=RESULT_VAL#>',
                '</span>&nbsp;<span class="eapps-unitsHO">',
                '<#=RESULT_UNITS#>',
                '</td>',
                '<#=rowEnd#>'
            ],
            rowStart,
            rowEnd;
        data = dataSrc;
        for (OTHER_IDX = data.OTHER_CNT - 1; OTHER_IDX >= 0; OTHER_IDX--) {
            LAB_IDX       = data.OTHER_SORTED[OTHER_IDX].UNSORTED_IDX - 1;
            evtItemGrp    = data.LAB[LAB_IDX];
            arrWrk.length = 0;
            arrWrk.push(
                "Labs:&nbsp;",
                evtItemGrp.DISPLAY,
                '&nbsp;<span class="eapps-unitsHO">(',
                chla.eApps.gFuncs.convertDate(evtItemGrp.EVENT_END_DT_TM),
                ')');
            dataStore.items[0] = arrWrk.join('');
            if (evtItemGrp.EVENT_END_DT_TM > TEMP_DT_TM) {
                msgText.push(
                    '(',
                    chla.eApps.gFuncs.convertDate(data.LAB[LAB_IDX].EVENT_END_DT_TM),
                    ')');
                TEMP_DT_TM = evtItemGrp.EVENT_END_DT_TM;
            }
            msgText.push('<br/>');
            LAB_ROW.length = 0;
            lenCnt         = evtItemGrp.EVENT_CNT;
            if ((lenCnt % 2) != 0) {
                lenCnt += 1;
            }
            for (EVENT_IDX = 0; EVENT_IDX < lenCnt; EVENT_IDX++) {
                LABS_TEMP_ROW_CNT += 1;
                evtItem = data.LAB[LAB_IDX].EVENT[EVENT_IDX];
                if (ChlaStdClass.isEmpty(evtItem)) {
                    rowStart = '';
                    rowEnd   = '</tr>';
                    strWrk   = '<span>';
                    evtItem  = {
                        'DISPLAY'     : '&nbsp;',
                        'RESULT_VAL'  : '&nbsp;',
                        'RESULT_UNITS': '<span style="color:transparent;">Negative</span>'
                    };
                } else {
                    if ((LABS_TEMP_ROW_CNT % 2) != 0) {
                        rowStart = '<tr>';
                        rowEnd   = '';
                    } else {
                        rowStart = '';
                        rowEnd   = '</tr>';
                    }
                    if (evtItem.NORMALCY == "ABN") {
                        strWrk = '<span class="abnormal">A ';
                    } else if (evtItem.NORMALCY == "CRIT") {
                        strWrk = '<span class="abnormal">C ';
                    } else if (evtItem.NORMALCY == "LOW") {
                        strWrk = '<span class="abnormal">L ';
                    } else if (evtItem.NORMALCY == "HI") {
                        strWrk = '<span class="abnormal">H ';
                    } else {
                        strWrk = '<span>';
                    }
                }
                LAB_ROW.push(
                    appLAB.gFuncs.parseTemplate(OthersLab.join(''), {
                        'rowStart'    : rowStart,
                        'DISPLAY'     : evtItem.DISPLAY,
                        'HtmlClass'   : strWrk,
                        'RESULT_VAL'  : evtItem.RESULT_VAL,
                        'RESULT_UNITS': evtItem.RESULT_UNITS,
                        'rowEnd'      : rowEnd
                    }));
            }
            strSectID     = [
                component.eApps.cc_id,
                'OtherLabs',
                OTHER_IDX].join('');
            arrWrk.length = 0;
            arrWrk.push(
                appLAB.gFuncs.parseTemplate(sectionBodyHdr1.join(''), {
                    secTableId: strSectID
                }));
            arrWrk.push(
                LABS_TEMP_ROW_CNT > 0 ? LAB_ROW.join('') : ' ');
            LABS_TEMP_ROW_CNT = 0;
            arrWrk.push(sectionBodyFtr1);
            dataStore.items[1] = arrWrk.join('');
            component.eApps.CC_SectionManagement.sectionlist.push(strSectID);
            sectionDataCfg = appLAB.gSectionDataCls.neo(
                'H5',               // T_type,
                strSectID,          // SecId,
                dataStore.items[0], // TLblId,
                'auto',             // secClsd,
                'H5',               // SecLvl,
                'true'              // SecTgl);
            );
            sectionDataCfg.Body                             = dataStore.items[1];
            component.eApps.CC_SectionManagement[strSectID] = sectionDataCfg;
            sectionDataCfg.SectionCnt                       = '';
            sectionDataCfg.SectionCntVal                    = '';
            LabsOtherHtml.push(processH5_Section(sectionDataCfg));
        }
        return LabsOtherHtml.join('');
    }
    /**
     * Formats a display message that no data present
     */
    function createNoLab24RecordRows() {
        return 'No lab results found';
        // document.getElementById(elemId).innerHTML = 'No lab results found';
    }

};


//Micros
chla.micros = function () { };
chla.micros.prototype = new MPage.Component();
chla.micros.prototype.constructor = MPage.Component;
chla.micros.prototype.base = MPage.Component.prototype;
chla.micros.prototype.name = "chla.micros";
chla.micros.prototype.cclProgram = "CHLA_CA_MP_MD_MICRO_JSON";
chla.micros.prototype.cclParams = [];
chla.micros.prototype.cclDataType = "JSON";
chla.micros.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("encounterId");
};

chla.micros.prototype.render = function () {
    var component = this,
        elementObj,
        target,
        compContent;
    var appMICRO = chla.eAppsClass.neo(),
        CC_SectMgt = null,
        CC_CssBehavior = null,
        gFuncs = null,
        htmlSecCtlData = null,
        micros = {
            cc_id: 'x',
            personId: 0,
            encounterId: 0,
            prsnlId: 0,
            transparentSpacer: '',
            totalMicros: 0,
            microResults: null,
            mainSection: '',
            PenMicroH5Section: '',
            PosMicroH5Section: '',
            NegMicroH5Section: '',
            CC_Tmpls: {
                mainDiv: [
                    '<div id="<#=cc_id#>" class="eapps_CC">',
                    '<#=mainSection#>',
                    '<#=PenMicroH5Section#>',
                    '<#=PosMicroH5Section#>',
                    '<#=NegMicroH5Section#>',
                    '</div>'
                ],
                MicroResults: [
                    '<tr class=<#=zstripe#>><td class="col-1">',
                    '<a href="javascript:MPAGES_EVENT(&quot;CLINICALNOTE&quot;,&quot;',
                    '<#=mPersonId#>|',
                    '<#=mEncounterId#>|[',
                    '<#=mEVENT_ID#>]|Microbiology Result|30||||&quot;)">',
                    '<#=mDISPLAY#></a><br /><span class="eapps-unitsHO">Pre: ',
                    '<#=mTASK_DT_TM#></span><br/><span class="eapps-unitsHO">Drawn: ',
                    '<#=mDRAWN_DT_TM#></span></td><td class="col-2">',
                    '<#=mRESPONSE_TEXT#><br /></td></tr>'
                ]
            },
            processRPTDATA: function () {
                if ( micros.totalMicros < 1) {
                    micros.mainSection = "<p>No micros found</p>";
                }
            },
            processMicrosResults: function(microsToProcess,MicroCnt) {
                var i,
                    m_idx,
                    microResultSet,
                    wrkResult,
                    wrkValue,
                    wrkCnt2;
                //Preliminary, Positive or Negative Micros
                wrkResult = '';
                for (m_idx = 0; m_idx < MicroCnt; m_idx++) {
                    microResultSet = microsToProcess[m_idx];
                    wrkValue = '';
                    for (i = 0, wrkCnt2 = microResultSet.RESPONSE.length; i < wrkCnt2; i++) {
                        wrkValue += microResultSet.RESPONSE[i].RESPONSE_TEXT + "<br />";
                    }
                    wrkResult += chla.eApps.gFuncs.parseTemplate(micros.CC_Tmpls.MicroResults.join(''),
                        {
                            mDRAWN_DT_TM: appMICRO.gFuncs.convertDate(microResultSet.DRAWN_DT_TM),
                            mPersonId: micros.personId,
                            mEncounterId: micros.encounterId,
                            mDISPLAY: microResultSet.DISPLAY,
                            mTASK_DT_TM: appMICRO.gFuncs.convertDate(microResultSet.TASK_DT_TM),
                            mRESPONSE_TEXT: wrkValue,
                            mEVENT_ID: microResultSet.EVENT_ID,
                            zstripe: ((m_idx % 2 == 0 )? '' : 'even')
                        });
                }
                return wrkResult;
            },
            processPenMicros: function() {
                var penMicroCnt;
                if ( micros.totalMicros > 0 ) {
                    penMicroCnt = ChlaStdClass.safeRead(micros.microResults,'PENDING_CNT');
                    penMicroCnt = penMicroCnt != '' ? penMicroCnt: 0;
                    //Preliminary Micros
                    component.eApps.CC_SectionManagement['H5_Sec_PenMicro'].Count = penMicroCnt;
                    component.eApps.CC_SectionManagement['H5_Sec_PenMicro'].Body =
                        micros.processMicrosResults( micros.microResults.PENDING,penMicroCnt);
                }
            },
            processPosMicros: function() {
                var posMicroCnt;
                if ( micros.totalMicros > 0) {
                    posMicroCnt = ChlaStdClass.safeRead(micros.microResults,'POS_CNT');
                    posMicroCnt = posMicroCnt != '' ? posMicroCnt: 0;
                    //Positive Micros
                    component.eApps.CC_SectionManagement['H5_Sec_PosMicro'].Count = posMicroCnt;
                    component.eApps.CC_SectionManagement['H5_Sec_PosMicro'].Body =
                        micros.processMicrosResults( micros.microResults.POS, posMicroCnt);
                }
            },
            processNegMicros: function() {
                var negMicroCnt;
                if ( micros.totalMicros > 0) {
                    negMicroCnt = ChlaStdClass.safeRead(micros.microResults,'NEG_CNT');
                    negMicroCnt = negMicroCnt != '' ? negMicroCnt: 0;
                    // Negative Micros
                    component.eApps.CC_SectionManagement['H5_Sec_NegMicro'].Count = negMicroCnt;
                    component.eApps.CC_SectionManagement['H5_Sec_NegMicro'].Body =
                        micros.processMicrosResults( micros.microResults.NEG, negMicroCnt);
                }
            },
            processH5SectionPenMicros: function () {
                var sectionObj  = appMICRO.gSectionHeaderCtlCls.neo(),
                    sectionData =  component.eApps.CC_SectionManagement['H5_Sec_PenMicro'],
                    defaultHeight;
                defaultHeight   = sectionData.Count < 5?  '' : 'style="height:200px; overflow-y:auto"';
                sectionObj.initValues(
                    {
                        idLabel:        component.eApps.cc_id + sectionData.SectionID,
                        TLabel1:        sectionData.TLabel1,
                        SectionClosed:  sectionData.SectionClosed,
                        SectionCntVal:  sectionData.Count,
                        ContentBody: '<div ' + defaultHeight + '><table>' +
                        sectionData.Body + '</table></div>',
                        TemplateType: 'H5'
                    });
                micros.PenMicroH5Section =
                    sectionObj.generateHTML(CC_CssBehavior);
                sectionData.SectionDivID = sectionObj.SectionDivID;
            },
            processH5SectionPosMicros: function () {
                var sectionObj = appMICRO.gSectionHeaderCtlCls.neo(),
                    sectionData =  component.eApps.CC_SectionManagement['H5_Sec_PosMicro'],
                    defaultHeight;
                defaultHeight = sectionData.Count < 5?  '' : 'style="height:200px; overflow-y:auto"';
                sectionObj.initValues(
                    {
                        idLabel:        component.eApps.cc_id + sectionData.SectionID,
                        TLabel1:        sectionData.TLabel1,
                        SectionClosed:  sectionData.SectionClosed,
                        SectionCntVal:  sectionData.Count,
                        ContentBody: '<div ' + defaultHeight + '><table>' +
                        sectionData.Body + '</table></div>',
                        TemplateType: 'H5'
                    });
                micros.PosMicroH5Section =
                    sectionObj.generateHTML(CC_CssBehavior);
                sectionData.SectionDivID = sectionObj.SectionDivID;
            },
            processH5SectionNegMicros: function () {
                var sectionObj = appMICRO.gSectionHeaderCtlCls.neo(),
                    sectionData = component.eApps.CC_SectionManagement['H5_Sec_NegMicro'],
                    defaultHeight;
                defaultHeight = sectionData.Count < 5?  '' : 'style="height:200px; overflow-y:auto"';
                sectionObj.initValues(
                    {
                        idLabel:        component.eApps.cc_id + sectionData.SectionID,
                        TLabel1:        sectionData.TLabel1,
                        SectionClosed:  sectionData.SectionClosed,
                        SectionCntVal:  sectionData.Count,
                        ContentBody: '<div ' + defaultHeight + '><table>' +
                        sectionData.Body + '</table></div>',
                        TemplateType: 'H5'
                    });
                micros.NegMicroH5Section =
                    sectionObj.generateHTML(CC_CssBehavior);
                sectionData.SectionDivID = sectionObj.SectionDivID;

            },
            processCcInstance: function () {
                micros.mainSection = '<table class="header"><tr><th class="col-1">Display</th><th class="col-2">Responses</th></tr></table>';
                compContent =
                    chla.eApps.gFuncs.parseTemplate(micros.CC_Tmpls.mainDiv.join(''),
                        {
                            cc_id: micros.cc_id,
                            mainSection: micros.mainSection,
                            PenMicroH5Section: micros.PenMicroH5Section,
                            PosMicroH5Section: micros.PosMicroH5Section,
                            NegMicroH5Section: micros.NegMicroH5Section
                        });

                gFuncs.Log_CC( component, compContent);
                target.innerHTML = compContent;
            },
            processPostCcInstance: function () {
            },
            processCcCssSectionBehavior: function () {
                var htmlSecCtlObj = appMICRO.gSectionHeaderCtlCls.neo();
                htmlSecCtlObj.initToggle(component.eApps.CSSBehaviors,component.eApps.CC_SectionManagement['H5_Sec_PenMicro']);
            },
            processCcCssSectionBehavior2: function () {
                var htmlSecCtlObj = appMICRO.gSectionHeaderCtlCls.neo();
                htmlSecCtlObj.initToggle(component.eApps.CSSBehaviors,component.eApps.CC_SectionManagement['H5_Sec_PosMicro']);
            },
            processCcCssSectionBehavior3: function () {
                var htmlSecCtlObj = appMICRO.gSectionHeaderCtlCls.neo();
                htmlSecCtlObj.initToggle(component.eApps.CSSBehaviors,component.eApps.CC_SectionManagement['H5_Sec_NegMicro']);
            },
            init: function () {
                var subHeaderDisplay,
                    SectionCfg;

                elementObj = component.data.RPTDATA;
                target = component.getTarget();

                component.eApps = {
                    initOnly            : false,
                    cc_id               : component.name.replace('.', '_'),
                    CSSBehaviors        : appMICRO.gCSSBehaviorCls.neo(),
                    SaveButtonAction    : null,
                    TestSAP             :  micros.TestServiceAccessPoint,
                    CC_SectionManagement: {
                        sectionlist: []
                    },
                    elementObj          : component.data.RPTDATA,
                    target              : component.getTarget(),
                    encounterId         : component.getProperty('encounterId'),
                    personId            : component.getProperty('personId'),
                    userId              : component.getProperty('userId'),
                    appNS               : appMICRO

                };
                component.eApps.initOnly = ChlaStdClass.safeRead( chla,'eApps','operationMode') == 'test' ||
                                           ChlaStdClass.safeRead( chla,'eApps','micros','operationMode') == 'microsTest' ;
                micros.cc_id        = component.eApps.cc_id;
                micros.personId     = component.eApps.personId;
                micros.encounterId  = component.eApps.encounterId;
                micros.prsnlId      = component.eApps.userId;
                htmlSecCtlData      = appMICRO.gSectionDataCls.neo();
                CC_SectMgt = component.eApps.CC_SectionManagement;
                SectionCfg = [
                    // H5 Sections
                    {T_type: 'H5',SecId: 'PenMicro' , TLblId: 'Preliminary' , SecClsd: 'auto',SecLvl:'H5'},
                    {T_type: 'H5',SecId: 'PosMicro' ,TLblId: 'Positive'     , SecClsd: 'auto',SecLvl:'H5'},
                    {T_type: 'H5',SecId: 'NegMicro' ,TLblId: 'Negative'     , SecClsd: 'auto',SecLvl:'H5'}
                ];
                CC_SectMgt.sectionlist = htmlSecCtlData.Section_config(SectionCfg, CC_SectMgt);

                micros.microResults = elementObj.MICRO[0];

                micros.totalMicros  = micros.microResults.PENDING_CNT;
                micros.totalMicros += micros.microResults.POS_CNT;
                micros.totalMicros += micros.microResults.NEG_CNT;

                if( component.name === 'chla.micros') {
                    subHeaderDisplay = "(" + micros.totalMicros + ")";
                    component.setProperty("headerSubTitle", subHeaderDisplay);
                }
                CC_CssBehavior = component.eApps.CSSBehaviors;

                gFuncs = chlaNsMgr.aliasDirector('chla.eApps.gFuncs');

            },
            TestServiceAccessPoint: function () {
                return {
                    TestProcessRPTDATA : micros.processRPTDATA,
                    TestProcessPenMicros: micros.processPenMicros,
                    TestProcessPosMicros: micros.processPosMicros,
                    TestProcessNegMicros: micros.processNegMicros,
                    TestProcessH5SectionPenMicros: micros.processH5SectionPenMicros,
                    TestProcessH5SectionPosMicros: micros.processH5SectionPosMicros,
                    TestProcessH5SectionNegMicros: micros.processH5SectionNegMicros,
                    TestProcessCcInstance: micros.processCcInstance,
                    TestProcessCcCssSectionBehavior1 : micros.processCcCssSectionBehavior,
                    TestProcessCcCssSectionBehavior2 : micros.processCcCssSectionBehavior2,
                    TestProcessCcCssSectionBehavior3 : micros.processCcCssSectionBehavior3
                };
            }
        };
    micros.init();
    if (component.eApps.initOnly == false) {
        micros.processRPTDATA();
        micros.processPenMicros();
        micros.processPosMicros();
        micros.processNegMicros();
        micros.processH5SectionPenMicros();
        micros.processH5SectionPosMicros();
        micros.processH5SectionNegMicros();
        micros.processCcInstance();
        micros.processCcCssSectionBehavior();
        micros.processCcCssSectionBehavior2();
        micros.processCcCssSectionBehavior3();
    }
};


//Lab Orders
chla.laborders = function () { };
chla.laborders.prototype = new MPage.Component();
chla.laborders.prototype.constructor = MPage.Component;
chla.laborders.prototype.base = MPage.Component.prototype;
chla.laborders.prototype.name = "chla.laborders";
chla.laborders.prototype.cclProgram = "CHLA_CA_MP_MD_LAB_ORD_JSON";
chla.laborders.prototype.cclParams = [];
chla.laborders.prototype.cclDataType = "JSON";
chla.laborders.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("encounterId");
};

chla.laborders.prototype.render = function () {

    var component = this,
        elementObj,
        target,
        compContent;
    var
        laborders = {
            cc_id: 'x',
            personId: 0,
            encounterId: 0,
            prsnlId: 0,
            transparentSpacer: '',
            mainSection: '',
            defaultHeight: '',
            CC_Tmpls: {
                mainDiv: [
                    '<div id="<#=cc_id#>" class="eapps_CC"',
                     '<#=defaultHeight#>',
                     '><#=mainSection#>',
                    '</div>'
                ],
               mainHdr: [
                    '<table class="header"><tr><th class="col-1">Order Name</th>',
                    '<th class="col-2">Specimen</th><th class="col-3">Priority</th>',
                    '<th class="col-4">Requested</th><th class="col-5">Collector</th>',
                    '<th class="col-6">Status</th></tr></table>'
               ]
            },
            processRPTDATA_data: function () {
                var orderCnt = 0 ,
                    orderIdx,
                    order;
                if (elementObj.ORDERS_CNT > 0) {
                    orderCnt = elementObj.ORDERS.length;
                    compContent = "<table>";

                    for (orderIdx = 0; orderIdx < orderCnt ; orderIdx++) {
                        order = elementObj.ORDERS[orderIdx];
                        compContent += "<tr";
                        compContent +=  (orderIdx % 2 == 0 ? '>': ' class="odd">')
                        compContent += "<td class='col-1'>" + order.ORDER_MNEMONIC + "</td>";
                        compContent += "<td class='col-2'>" + order.SPECIMEN_TYPE + "</td>";
            	        compContent += "<td class='col-3'>" + order.COLLPRI +
                                        "<br/><span class='eapps-unitsHO'>" + order.FREQ + "</span></td>";
                        compContent += '<td class="col-4 eapps-units" style="font-size: 9px;">' + order.REQSTARTDTTM + "</td>";

                        if (order.NURSECOLLECT_IND == 1 && order.LABCOLLECT_IND == 0) {
                            compContent += "<td class='col-5'>Nurse Collect</td>";
                        } else if (order.NURSECOLLECT_IND == 0 && order.LABCOLLECT_IND == 1) {
                            compContent += "<td class='col-5'>Lab Collect</td>";
                        } else {
                            compContent += "<td class='col-5'>--</td>";
                        }

                        compContent += "<td class='col-6'>" + order.ORDER_STATUS + " (" + order.DEPT_STATUS + ")" + "</td>";
                        compContent += "</tr>";
                    }
                    compContent += "</table>";
                } else {
                    compContent = "<p>No lab orders found</p>";
                    }
               laborders.mainSection = laborders.CC_Tmpls.mainHdr.join('');
               laborders.defaultHeight = orderCnt < 5?  '' : 'style="height:200px; overflow-y:auto"';
               laborders.mainSection +=  compContent;
               component.setProperty("headerSubTitle", '(' + orderCnt + ')');
            },
            processCcInstance: function () {
                compContent = chla.eApps.gFuncs.parseTemplate(laborders.CC_Tmpls.mainDiv.join(''), {
                    cc_id: laborders.cc_id,
                    mainSection: laborders.mainSection,
                    defaultHeight: laborders.defaultHeight
                    });

                chla.eApps.gFuncs.Log_CC( component, compContent);
                target.innerHTML = compContent;
            },
            init: function () {
                elementObj = component.data.RPTDATA;
                target = component.getTarget();

                component.eApps = {
                    cc_id: component.name.replace('.', '_'),
                    CSSBehaviors: chla.eApps.gCSSBehaviors.neo(),
                    TestSAP: null,
                    initOnly: false
                };
                component.eApps.TestSap = laborders.TestServiceAccessPoint;
                component.eApps.initOnly = ChlaStdClass.safeRead( chla,'eApps','operationMode') == 'test';

                laborders.cc_id = component.eApps.cc_id;
                laborders.personId = component.getProperty("personId");
                laborders.encounterId = component.getProperty("encounterId");
                laborders.prsnlId = component.getProperty("userId");
            },
            TestServiceAccessPoint: function (){
                return {
                    TestProcessRPTDATA: laborders.processRPTDATA_data,
                    TestProcessCcInstance: laborders.processCcInstance
                };
            }
        };

    laborders.init();
    if (component.eApps.initOnly == false) {
        laborders.processRPTDATA_data();
        laborders.processCcInstance();
    }
};

//Meds
chla.meds = function () { };
chla.meds.prototype = new MPage.Component();
chla.meds.prototype.constructor = MPage.Component;
chla.meds.prototype.base = MPage.Component.prototype;
chla.meds.prototype.name = "chla.meds";
chla.meds.prototype.cclProgram = "CHLA_CA_MP_MD_MEDS_JSON";
chla.meds.prototype.cclParams = [];
chla.meds.prototype.cclDataType = "JSON";
chla.meds.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("encounterId");
};

chla.meds.prototype.render = function () {
    var component = this,
        elementObj,
        target,
        compContent;
    var appMEDS = chla.eAppsClass.neo(),
        CC_SectMgt = null,
        CC_CssBehavior = null,
        htmlSecCtlObj = null,
        meds = {
            initOnly: false,
            cc_id: 'x',
            personId: 0,
            encounterId: 0,
            prsnlId: 0,
            transparentSpacer: '',
            mainSection: '',
            mainSectionEnd:'',
            H5_Section_MedsIV : '',
            H5_Section_Scheduled:'',
            H5_Section_PRN:'',
            CC_Tmpls: {
                mainDiv: [
                    '<div id="<#=cc_id#>" class="eapps_CC">',
                    '<#=mainSection#>',
                    '<#=H5_Section_MedsIV#>',
                    '<#=H5_Section_Scheduled#>',
                    '<#=H5_Section_PRN#>',
                    '<#=mainSectionEnd#>',
                    '</div>'
                ],
                rowResultsHdr: ['<div <#=defaultHeight#> ><table>',
                    '<#=Body#></table></div>'],
                rowResults: ['<tr <#=zstripe#>><td class="medName"><#=medName#></td><td class="medDesc"><#=medDesc#></td></tr>'],
                Additional_Template1: []
            },
            // Section Data processing to H5_H6_Sec_UID.
            processH5_Sec_MedsIV_data: function (dataObj, sectObj) {
                var sectionObj = component.eApps.CC_SectionManagement['H5_Sec_MedsIV'],
                    m, med, listCnt,
                    med_cd = 10577.000,
                    ivCnt = dataObj.IP_MED[0].DRIP_CNT;
                sectionObj.Count = 0;
                if (ivCnt > 0 ){
                    for (m = 0, listCnt = dataObj.IP_MED[0].QUAL.length; m < listCnt ; m++) {
                        med = dataObj.IP_MED[0].QUAL[m];
                        //IV Meds
                        if ( med.DCP_CLIN_CAT_CD !== med_cd)  {
                            sectionObj.Body += appMEDS.gFuncs.parseTemplate(meds.CC_Tmpls.rowResults.join(''), {
                                medName: med.ORDER_MNEMONIC,
                                medDesc: med.CLINICAL_DISPLAY_LINE,
                                zstripe: ((sectionObj.Count % 2 == 0)? '': ' class="even"')
                            });
                            sectionObj.Count += 1;
                        }
                    }
                }
            },
            processH5_Sec_Scheduled_data: function (dataObj, sectObj) {
                var sectionObj = component.eApps.CC_SectionManagement['H5_Sec_Scheduled'],
                    m, med, listcnt,
                    med_cd = 10577.000,
                    schedCnt = dataObj.IP_MED[0].SCHED_CNT;
                sectionObj.Count = 0;
                if (schedCnt > 0 ){
                    for (m = 0, listcnt = dataObj.IP_MED[0].QUAL.length; m < listcnt ; m++) {
                        med = dataObj.IP_MED[0].QUAL[m];
                        //Scheduled Meds
                        if (med.DCP_CLIN_CAT_CD == med_cd && med.PRN_IND == 0) {
                            sectionObj.Body += appMEDS.gFuncs.parseTemplate(meds.CC_Tmpls.rowResults.join(''), {
                                medName: med.ORDER_MNEMONIC,
                                medDesc: med.CLINICAL_DISPLAY_LINE,
                                zstripe: ((sectionObj.Count % 2 == 0)? '': ' class="even"')
                            });
                            sectionObj.Count += 1;
                        }
                    }
                }
            },
            processH5_Sec_PRN_data: function (dataObj, sectObj) {
                var sectionObj = component.eApps.CC_SectionManagement['H5_Sec_PRN'],
                    m, med, listcnt, wrkValue,wrkValue2,
                    med_cd = 10577.000,
                    prnCnt = dataObj.IP_MED[0].PRN_CNT;
                sectionObj.Count = 0;
                if (prnCnt > 0 ) {
                    for (m = 0, listcnt = dataObj.IP_MED[0].QUAL.length; m < listcnt ; m++) {
                        med = dataObj.IP_MED[0].QUAL[m];
                        //PRN Meds
                        if ( med.DCP_CLIN_CAT_CD == med_cd && med.PRN_IND == 1) {
                            wrkValue =  med.CLINICAL_DISPLAY_LINE;
                            wrkValue2 = appMEDS.gFuncs.convertDate(med.LAST_DOSE_DT_TM);
                            if ( wrkValue2 !== "--") {
                                wrkValue +=	' (' + med.DOSE_CNT + 'x, ';
                                wrkValue =	wrkValue + wrkValue2 + ')';
                            } else {
                                wrkValue +=	' (not given)';
                            }
                            sectionObj.Body += appMEDS.gFuncs.parseTemplate(meds.CC_Tmpls.rowResults.join(''), {
                                medName: med.ORDER_MNEMONIC,
                                medDesc: wrkValue,
                                zstripe: ((sectionObj.Count % 2 == 0)? '': ' class="even"')
                            });
                            sectionObj.Count += 1;
                        }
                    }
                }
            },
            processRPTDATA_main_data: function () {
                meds.mainSection= '<table><tr><th class="col-1">Name</th><th class="col-2">Dosage</th></tr></table>';
            },
            //  Section Formatting processing to H5_H6_Sec_UID.
            processH5_Section_MedsIV: function () {
                var sectionObj = appMEDS.gSectionHeaderCtlCls.neo(),
                    sectionData = component.eApps.CC_SectionManagement['H5_Sec_MedsIV'],
                    defaultHeight;
                defaultHeight = sectionData.Count > 5? 'style="height:200px; overflow-y:auto"' : '';
                sectionObj.initValues(
                    {
                        idLabel:        component.eApps.cc_id + sectionData.SectionID,
                        TLabel1:        sectionData.TLabel1,
                        SectionClosed:  sectionData.SectionClosed,
                        SectionCntVal:  sectionData.Count,
                        ContentBody:    appMEDS.gFuncs.parseTemplate(meds.CC_Tmpls.rowResultsHdr.join(''), {
                            defaultHeight: defaultHeight,
                            Body: sectionData.Body
                        }),
                        TemplateType: 'H5'
                    });
                meds.H5_Section_MedsIV =
                    sectionObj.generateHTML(CC_CssBehavior);
                sectionData.SectionDivID = sectionObj.SectionDivID;
            },
            processH5_Section_Scheduled: function () {
                var sectionObj = appMEDS.gSectionHeaderCtlCls.neo(),
                    sectionData = component.eApps.CC_SectionManagement['H5_Sec_Scheduled'],
                    defaultHeight;
                defaultHeight = sectionData.Count > 5? 'style="height:200px; overflow-y:auto"' : '';
                sectionObj.initValues(
                    {
                        idLabel:        component.eApps.cc_id + sectionData.SectionID,
                        TLabel1:        sectionData.TLabel1,
                        SectionClosed:  sectionData.SectionClosed,
                        SectionCntVal:  sectionData.Count,
                        ContentBody:    appMEDS.gFuncs.parseTemplate(meds.CC_Tmpls.rowResultsHdr.join(''), {
                            defaultHeight: defaultHeight,
                            Body: sectionData.Body
                        }),
                        TemplateType: 'H5'
                    });
                meds.H5_Section_Scheduled =
                    sectionObj.generateHTML(CC_CssBehavior);
                sectionData.SectionDivID = sectionObj.SectionDivID;
            },
            processH5_Section_PRN: function () {
                var sectionObj = appMEDS.gSectionHeaderCtlCls.neo(),
                    sectionData = component.eApps.CC_SectionManagement['H5_Sec_PRN'],
                    defaultHeight;
                defaultHeight = sectionData.Count > 5? 'style="height:200px; overflow-y:auto"' : '';
                sectionObj.initValues(
                    {
                        idLabel:        component.eApps.cc_id + sectionData.SectionID,
                        TLabel1:        sectionData.TLabel1,
                        SectionClosed:  sectionData.SectionClosed,
                        SectionCntVal:  sectionData.Count,
                        ContentBody:    appMEDS.gFuncs.parseTemplate(meds.CC_Tmpls.rowResultsHdr.join(''), {
                            defaultHeight: defaultHeight,
                            Body: sectionData.Body
                        }),
                        TemplateType: 'H5'
                    });
                meds.H5_Section_PRN =
                    sectionObj.generateHTML(CC_CssBehavior);
                sectionData.SectionDivID = sectionObj.SectionDivID;
            },
            processCcInstance: function () {

                if (component.name === 'chla.meds'){
                   component.setProperty("headerSubTitle", '(' + elementObj.IP_MED[0].CNT + ')');
                 }

                compContent = appMEDS.gFuncs.parseTemplate(meds.CC_Tmpls.mainDiv.join(''), {
                    cc_id:                  meds.cc_id,
                    mainSection:            meds.mainSection,
                    mainSectionEnd:         meds.mainSectionEnd,
                    H5_Section_MedsIV:      meds.H5_Section_MedsIV,
                    H5_Section_Scheduled:   meds.H5_Section_Scheduled,
                    H5_Section_PRN:         meds.H5_Section_PRN
                });
                appMEDS.gFuncs.Log_CC( component, compContent);
                component.eApps.target.innerHTML = compContent;
            },
            processCcCssSectionBehavior1: function () {
                var htmlSecCtlObj =  appMEDS.gSectionHeaderCtlCls.neo();
                htmlSecCtlObj.initToggle(component.eApps.CSSBehaviors,component.eApps.CC_SectionManagement['H5_Sec_MedsIV']);
            },
            processCcCssSectionBehavior2: function () {
                var htmlSecCtlObj =  appMEDS.gSectionHeaderCtlCls.neo();
                htmlSecCtlObj.initToggle(component.eApps.CSSBehaviors,component.eApps.CC_SectionManagement['H5_Sec_Scheduled']);
            },
            processCcCssSectionBehavior3: function () {
                var htmlSecCtlObj =  appMEDS.gSectionHeaderCtlCls.neo();
                htmlSecCtlObj.initToggle(component.eApps.CSSBehaviors,component.eApps.CC_SectionManagement['H5_Sec_PRN']);
            },
            init: function () {
                var initSecData,
                    SectionCfg;
                component.eApps = {
                    cc_id               : component.name.replace('.', '_'),
                    CSSBehaviors        : appMEDS.gCSSBehaviorCls.neo(),
                    SaveButtonAction    : null,
                    TestSAP             : null,
                    CC_SectionManagement: {
                        sectionlist: []
                    },
                    elementObj          : component.data.RPTDATA,
                    target              : component.getTarget(),
                    encounterId         : component.getProperty('encounterId'),
                    personId            : component.getProperty('personId'),
                    userId              : component.getProperty('userId'),
                    appNS               : appMEDS

                };
                elementObj              = component.eApps.elementObj;
                target                  = component.eApps.target;
                meds.initOnly = ChlaStdClass.safeRead( chla,'eApps','operationMode') == 'test' ||
                                ChlaStdClass.safeRead( chla,'eApps','meds','operationMode') == 'medsTest' ;
                meds.cc_id              = component.eApps.cc_id;
                meds.personId           = component.eApps.personId;
                meds.encounterId        = component.eApps.encounterId;
                meds.prsnlId            = component.eApps.userId;
                component.eApps.TestSAP = meds.TestServiceAccessPoint;
                initSecData             =  appMEDS.gSectionDataCls.neo();
                CC_SectMgt = component.eApps.CC_SectionManagement;
                SectionCfg = [
                    // H5 Sections
                    {T_type: 'H5',SecId: 'MedsIV'    , TLblId: 'IVs'     , SecClsd: 'auto',SecLvl:'H5'},
                    {T_type: 'H5',SecId: 'Scheduled' ,TLblId: 'Scheduled', SecClsd: 'auto',SecLvl:'H5'},
                    {T_type: 'H6',SecId: 'PRN'       ,TLblId: 'PRN'      , SecClsd: 'auto',SecLvl:'H5'}
                ];
                CC_SectMgt.sectionlist = initSecData.Section_config(SectionCfg, CC_SectMgt);
            },
            TestServiceAccessPoint: function (){
                return {
                    TestProcessRPTDATA_main_data: meds.processRPTDATA_main_data,
                    TestProcessH5_Sec_MedsIV_data: meds.processH5_Sec_MedsIV_data,
                    TestProcessH5_Sec_Scheduled_data: meds.processH5_Sec_Scheduled_data,
                    TestProcessH5_Sec_PRN_data: meds.processH5_Sec_PRN_data,
                    TestProcessH5_Section_MedsIV: meds.processH5_Section_MedsIV,
                    TestProcessH5_Section_Scheduled: meds.processH5_Section_Scheduled,
                    TestProcessH5_Section_PRN: meds.processH5_Section_PRN,
                    TestProcessCcInstance: meds.processCcInstance,
                    TestProcessCcCssH5_Section_MedsIVBehavior:  meds.processCcCssSectionBehavior1,
                    TestProcessCcCssH5_Section_ScheduledBehavior: meds.processCcCssSectionBehavior2,
                    TestProcessCcCssH5_Section_PRNBehavior: meds.processCcCssSectionBehavior3
                };
            }
        };
    meds.init();
    if (meds.initOnly == false) {
        meds.processRPTDATA_main_data();
        meds.processH5_Sec_MedsIV_data(elementObj);
        meds.processH5_Sec_Scheduled_data(elementObj);
        meds.processH5_Sec_PRN_data(elementObj);
        meds.processH5_Section_MedsIV();
        meds.processH5_Section_Scheduled();
        meds.processH5_Section_PRN();
        meds.processCcInstance();
        meds.processCcCssSectionBehavior1();
        meds.processCcCssSectionBehavior2();
        meds.processCcCssSectionBehavior3();
    }
};



//Radiology
chla.radiology = function () { };
chla.radiology.prototype = new MPage.Component();
chla.radiology.prototype.constructor = MPage.Component;
chla.radiology.prototype.base = MPage.Component.prototype;
chla.radiology.prototype.name = "chla.radiology";
chla.radiology.prototype.cclProgram = "CHLA_CA_MP_RAD_EVENTS_JSON";
chla.radiology.prototype.cclParams = [];
chla.radiology.prototype.cclDataType = "JSON";
chla.radiology.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("encounterId");
};

chla.radiology.prototype.render = function () {
    var component = this,
        elementObj,
        target,
        compContent;
    var appRAD,
        radiology = {
            cc_id: 'x',
            personId: 0,
            encounterId: 0,
            prsnlId: 0,
            transparentSpacer: '',
            subHeaderDisplay:0 ,
            mainSection: '',
            CC_Tmpls: {
                mainDiv: [
                    '<div id="<#=cc_id#>" class="eapps_CC">',
                    '<#=mainSection#>',
                    '</div>'
                ],
                mainHdr: [
                    '<table class="header"><tr><th class="col-1">Event Date</th>',
                    '<th class="col-2">Procedure</th><th class="col-3">Status</th></tr></table>'
                ]
            },
            processRPTDATA_data: function () {
                var recCnt,
                    recIdx,
                    radOrder,
                    arrWrk=[],
                    hLink =[];

                if (elementObj) {
                    compContent = '<div style="height:200px; overflow-y:auto"><table>';
                    recCnt = elementObj.EVENTS.length;
                    if (recCnt > 0 ){
                        for (recIdx = 0; recIdx < recCnt; recIdx++) {
                            hLink.length = 0;
                            if (ChlaStdClass.isEmpty(elementObj.EVENTS[recIdx]) === false) {
                                radOrder = elementObj.EVENTS[recIdx];
                                arrWrk.push("<tr");
                                arrWrk.push( (recIdx % 2 == 0 ? '>' : ' class="odd">'));
                                hLink.push( '<a href="javascript:MPAGES_EVENT(&quot;CLINICALNOTE&quot;,&quot;');
                                hLink.push(radiology.personId );
                                hLink.push( '|');
                                hLink.push(radiology.encounterId);
                                hLink.push('|[');
                                hLink.push( radOrder.EVENT_ID);
                                hLink.push( ']|' );
                                hLink.push( radOrder.CATALOG );
                                hLink.push( '|30||||&quot;)">');
                                arrWrk.push('<td class="col-1">' );
                                arrWrk.push( hLink.join(''));
                                arrWrk.push( radOrder.EVENT_DATE);
                                arrWrk.push('</a></td>');
                                arrWrk.push('<td class="col-2">');
                                arrWrk.push( radOrder.CATALOG );
                                arrWrk.push('</td>');
                                arrWrk.push('<td class="col-3">');
                                arrWrk.push(radOrder.STATUS );
                                arrWrk.push( '</td></tr>');
                            } else {
                                //TODO  - error  condition notification
                            }
                        }
                        compContent += arrWrk.join('');
                        compContent += '</table></div>';

                        radiology.mainSection= radiology.CC_Tmpls.mainHdr.join('');
                        radiology.mainSection += compContent;

                        if (component.name === 'chla.radiology') {
                            component.setProperty("headerSubTitle", '(' + recCnt + ')');
                        }
                    }else {
                        radiology.mainSection = ' No data available ';
                    }
                } else {
                    radiology.mainSection = ' No data available ';
                }
            },
            processCcInstance: function () {
                compContent = appRAD.gFuncs.parseTemplate(radiology.CC_Tmpls.mainDiv.join(''), {
                    cc_id:          radiology.cc_id,
                    mainSection:    radiology.mainSection
                });
                appRAD.gFuncs.Log_CC( component, compContent);

                target.innerHTML = compContent;
            },
            init: function () {
                var CcInit = chla.eApps.gCcModuleCls.neo();
                appRAD = chla.eAppsClass.neo();
                CcInit.CommonCcInit( appRAD, component);
                component.eApps.TestSap = radiology.TestServiceAccessPoint;
                elementObj              = component.eApps.elementObj;
                target                  = component.eApps.target;
                radiology.cc_id         = component.eApps.cc_id;
                radiology.personId      = component.eApps.personId;
                radiology.encounterId   = component.eApps.encounterId;
                radiology.prsnlId       = component.eApps.userId;
            },
            TestServiceAccessPoint: function (){
                return {
                    TestProcessRPTDATA: radiology.processRPTDATA,
                    TestProcessCcInstance: radiology.processCcInstance
                };
            }
        };
    radiology.init();
    if (component.eApps.initOnly == false) {
        radiology.processRPTDATA_data();
        radiology.processCcInstance();
    }
};

//vitalsigns
chla.vitalsigns                       = function () { };
chla.vitalsigns.prototype             = new MPage.Component();
chla.vitalsigns.prototype.constructor = MPage.Component;
chla.vitalsigns.prototype.base        = MPage.Component.prototype;
chla.vitalsigns.prototype.name        = "chla.vitalsigns";
chla.vitalsigns.prototype.cclProgram  = "CHLA_CA_MP_CC_VITALS_JSON";
chla.vitalsigns.prototype.cclParams   = [];
chla.vitalsigns.prototype.cclDataType = "JSON";
chla.vitalsigns.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("encounterId");
};

chla.vitalsigns.prototype.render = function () {
    var component = this,
        elementObj,
        compContent,
        arrCompContent = [];

    var appVITAL,
        vitalsigns = {
            processRPTDATA: function (){
                var v,
                    vVitalsign,
                    temp =[]  ,
                    hr   =[] ,
                    bp   =[] ,
                    abp  =[] ,
                    map  =[] ,
                    map1  =[] ,
                    map2  =[] ,
                    map3 =[] ,
                    rr   =[] ,
                    o2sat=[] ,
                    misc =[] ,
                    oddflag = '';
                compContent = "";
                if (elementObj.VITALS_CNT > 0) {
                    arrCompContent.push( '<table class="header"><tr><th class = "col-1">Display</th>');
                    arrCompContent.push( '<th class="col-2">Range</th><th class="col-3">Last</th>');
                    arrCompContent.push( '<th class="col-4">Date</th></tr></table><table>');

                    if (elementObj.BP_CURRENT_SYSTOLIC !== "" || elementObj.BP_CURRENT_DIASTOLIC !== "") {
                        //bp.push(  '<tr class="' + oddflag +'">');
                        bp.push( "<td class='col-1'>Blood Pressure</td>");
                        bp.push( "<td class='col-2'>" + elementObj.BP_LOW_SYSTOLIC + "/" + elementObj.BP_LOW_DIASTOLIC + "-" + elementObj.BP_HIGH_SYSTOLIC + "/" + elementObj.BP_HIGH_DIASTOLIC + "</td>");
                        bp.push( "<td class='col-3'>" + elementObj.BP_CURRENT_SYSTOLIC + "/" + elementObj.BP_CURRENT_DIASTOLIC);
                        bp.push( " <span class='units'>mm HG</td>");
                        for (v = 0; v < elementObj.VITALS.length; v++) {
                            vVitalsign = elementObj.VITALS[v];
                            if (vVitalsign.EVENT_CD == 671596 || vVitalsign.EVENT_CD == 671597) {
                                var bp_dt_tm = chla.eApps.gFuncs.convertDate(vVitalsign.DT_TM);
                            }
                        }
                        bp.push(  "<td class='col-4'>" + bp_dt_tm + "</td>","</tr>");
                    }

                    if (elementObj.ART_BP_CURRENT_SYSTOLIC !== "" || elementObj.ART_BP_CURRENT_DIASTOLIC !== "") {
                        //abp = '<tr class="' + oddflag +'">';
                        abp.push( "<td class='col-1'>Arterial Blood Pressure</td>");
                        abp.push( "<td class='col-2'>" + elementObj.ART_BP_LOW_SYSTOLIC + "/" + elementObj.ART_BP_LOW_DIASTOLIC + "-" + elementObj.ART_BP_HIGH_SYSTOLIC + "/" + elementObj.ART_BP_HIGH_DIASTOLIC + "</td>");
                        abp.push( "<td class='col-3'>" + elementObj.ART_BP_CURRENT_SYSTOLIC + "/" + elementObj.ART_BP_CURRENT_DIASTOLIC);
                        abp.push( " <span class='units'>mm HG</td>");
                        for (v = 0; v < elementObj.VITALS.length; v++) {
                            var vVitalsign = elementObj.VITALS[v];
                            if (vVitalsign.EVENT_CD == 824485 || vVitalsign.EVENT_CD == 824481) {
                                var art_bp_dt_tm = chla.eApps.gFuncs.convertDate(vVitalsign.DT_TM);
                            }
                        }
                        abp.push( "<td class='col-4'>" + art_bp_dt_tm + "</td>");
                        abp.push(  "</tr>");

                    }

                    for (v = 0; v < elementObj.VITALS.length; v++) {
                        vVitalsign = elementObj.VITALS[v];
                        if (vVitalsign.EVENT_CD !== 671596 && vVitalsign.EVENT_CD !== 671597 && vVitalsign.EVENT_CD !== 824485 && vVitalsign.EVENT_CD !== 824481) {
                            var eventCode = vVitalsign.EVENT_CD;

                            switch (eventCode) {
                                //Temperature
                                case 688867:
                                    //temp.push('<tr class="' + oddflag +'">';;
                                    temp.push("<td class='col-1'>" + vVitalsign.TEST + "</td>");
                                    temp.push("<td class='col-2'>" + vVitalsign.RESULT_LOW + "-" + vVitalsign.RESULT_HIGH + "</td>");
                                    temp.push("<td class='col-3'>" + vVitalsign.RESULT);
                                    temp.push("<span class='units'> " + vVitalsign.UNITS + "</td>");
                                    temp.push("<td class='col-4'>" + chla.eApps.gFuncs.convertDate(vVitalsign.DT_TM) + "</td>");
                                    temp.push("</tr>");
                                    break;

                                //Heart rate
                                case 688367:
                                    //hr.push('<tr class="' + oddflag +'">');
                                    hr.push("<td class='col-1'>" + vVitalsign.TEST + "</td>");
                                    hr.push("<td class='col-2'>" + vVitalsign.RESULT_LOW + "-" + vVitalsign.RESULT_HIGH + "</td>");
                                    hr.push("<td class='col-3'>" + vVitalsign.RESULT);
                                    hr.push("<span class='units'> " + vVitalsign.UNITS + "</td>");
                                    hr.push("<td class='col-4'>" + chla.eApps.gFuncs.convertDate(vVitalsign.DT_TM) + "</td>");
                                    hr.push("</tr>");
                                    break;

                                //Mean arterial pressure
                                case 688860:
                                   // map.push( '<tr class="' + oddflag +'">');
                                    map.push("<td class='col-1'>" + vVitalsign.TEST + "</td>");
                                    map.push("<td class='col-2'>" + vVitalsign.RESULT_LOW + "-" + vVitalsign.RESULT_HIGH + "</td>");
                                    map.push("<td class='col-3'>" + vVitalsign.RESULT);
                                    map.push("<span class='units'> " + vVitalsign.UNITS + "</td>");
                                    map.push("<td class='col-4'>" + chla.eApps.gFuncs.convertDate(vVitalsign.DT_TM) + "</td>");
                                    map.push("</tr>");
                                    break;

                                // Cuff MAP
                                case 88180382:
                                   // map1.push( '<tr class="' + oddflag +'">');
                                    map1.push("<td class='col-1'>" + vVitalsign.TEST + "</td>");
                                    map1.push("<td class='col-2'>" + vVitalsign.RESULT_LOW + "-" + vVitalsign.RESULT_HIGH + "</td>");
                                    map1.push("<td class='col-3'>" + vVitalsign.RESULT);
                                    map1.push("<span class='units'> " + vVitalsign.UNITS + "</td>");
                                    map1.push("<td class='col-4'>" + chla.eApps.gFuncs.convertDate(vVitalsign.DT_TM) + "</td>");
                                    map1.push("</tr>");
                                    break;

                                //Cuff MAP ICU
                                case 818087:
                                   // map2.push( '<tr class="' + oddflag +'">');
                                    map2.push("<td class='col-1'>" + vVitalsign.TEST + "</td>");
                                    map2.push("<td class='col-2'>" + vVitalsign.RESULT_LOW + "-" + vVitalsign.RESULT_HIGH + "</td>");
                                    map2.push("<td class='col-3'>" + vVitalsign.RESULT);
                                    map2.push("<span class='units'> " + vVitalsign.UNITS + "</td>");
                                    map2.push("<td class='col-4'>" + chla.eApps.gFuncs.convertDate(vVitalsign.DT_TM) + "</td>");
                                    map2.push("</tr>");
                                    break;

                                //Art line MAP
                                case 825739:
                                   // map3.push( '<tr class="' + oddflag +'">');
                                    map3.push("<td class='col-1'>" + vVitalsign.TEST + "</td>");
                                    map3.push("<td class='col-2'>" + vVitalsign.RESULT_LOW + "-" + vVitalsign.RESULT_HIGH + "</td>");
                                    map3.push("<td class='col-3'>" + vVitalsign.RESULT);
                                    map3.push("<span class='units'> " + vVitalsign.UNITS + "</td>");
                                    map3.push("<td class='col-4'>" + chla.eApps.gFuncs.convertDate(vVitalsign.DT_TM) + "</td>");
                                    map3.push("</tr>");
                                    break;

                                //Respiratory rate
                                case 671599:
                                    //rr.push('<tr class="' + oddflag +'">');
                                    rr.push("<td class='col-1'>" + vVitalsign.TEST + "</td>");
                                    rr.push("<td class='col-2'>" + vVitalsign.RESULT_LOW + "-" + vVitalsign.RESULT_HIGH + "</td>");
                                    rr.push("<td class='col-3'>" + vVitalsign.RESULT);
                                    rr.push("<span class='units'> " + vVitalsign.UNITS + "</td>");
                                    rr.push("<td class='col-4'>" + chla.eApps.gFuncs.convertDate(vVitalsign.DT_TM) + "</td>");
                                    rr.push("</tr>");
                                    break;

                                //O2Sat
                                case 688374:
                                    //o2sat.push('<tr class="' + oddflag +'">');
                                    o2sat.push("<td class='col-1'>" + vVitalsign.TEST + "</td>");
                                    o2sat.push("<td class='col-2'>" + vVitalsign.RESULT_LOW + "-" + vVitalsign.RESULT_HIGH + "</td>");
                                    o2sat.push("<td class='col-3'>" + vVitalsign.RESULT);
                                    o2sat.push("<span class='units'> " + vVitalsign.UNITS + "</td>");
                                    o2sat.push("<td class='col-4'>" + chla.eApps.gFuncs.convertDate(vVitalsign.DT_TM) + "</td>");
                                    o2sat.push("</tr>");
                                    break;

                                //All others
                                default:
                                   // misc.push( '<tr class="' + oddflag +'">');
                                    misc.push("<td class='col-1'>" + vVitalsign.TEST + "</td>");
                                    misc.push("<td class='col-2'>" + vVitalsign.RESULT_LOW + "-" + vVitalsign.RESULT_HIGH + "</td>");
                                    misc.push("<td class='col-3'>" + vVitalsign.RESULT);
                                    misc.push("<span class='units'> " + vVitalsign.UNITS + "</td>");
                                    misc.push("<td class='col-4'>" + chla.eApps.gFuncs.convertDate(vVitalsign.DT_TM) + "</td>");
                                    misc.push("</tr>");
                                    break;

                            }
                        }
                    }
                    oddflag = '';
                    if (temp.join('')  !== ''){
                        arrCompContent.push(  '<tr class="' + oddflag +'">');
                        arrCompContent.push(  temp.join('') );
                       oddflag = (oddflag === 'odd'? '': 'odd');
                    }
                    if (hr.join('') !== ''){
                        arrCompContent.push(  '<tr class="' + oddflag +'">');
                        arrCompContent.push( hr.join('') );
                       oddflag = (oddflag === 'odd'? '': 'odd');
                    }
                    if ( bp.join('')  !== ''){
                        arrCompContent.push(  '<tr class="' + oddflag +'">');
                        arrCompContent.push( bp.join('') )
                       oddflag = (oddflag === 'odd'? '': 'odd');
                    }
                    if (abp.join('')  !== ''){
                        arrCompContent.push(  '<tr class="' + oddflag +'">');
                        arrCompContent.push( abp.join('') )
                       oddflag = (oddflag === 'odd'? '': 'odd');
                    }
                    if ( map.join('') !== ''){
                        arrCompContent.push(  '<tr class="' + oddflag +'">');
                        arrCompContent.push( map.join(''))
                       oddflag = (oddflag === 'odd'? '': 'odd');
                    }
                    if ( map1.join('') !== ''){
                        arrCompContent.push(  '<tr class="' + oddflag +'">');
                        arrCompContent.push( map1.join(''))
                       oddflag = (oddflag === 'odd'? '': 'odd');
                    }
                    if (map2.join('') !== ''){
                        arrCompContent.push(  '<tr class="' + oddflag +'">');
                        arrCompContent.push( map2.join(''))
                       oddflag = (oddflag === 'odd'? '': 'odd');
                    }
                    if (map3.join('') !== ''){
                        arrCompContent.push(  '<tr class="' + oddflag +'">');
                        arrCompContent.push( map3.join(''))
                       oddflag = (oddflag === 'odd'? '': 'odd');
                    }
                    if (rr.join('')  !== ''){
                        arrCompContent.push(  '<tr class="' + oddflag +'">');
                        arrCompContent.push( rr.join('') );
                       oddflag = (oddflag === 'odd'? '': 'odd');
                    }
                    if (o2sat.join('') !== ''){
                        arrCompContent.push(  '<tr class="' + oddflag +'">');
                        arrCompContent.push( o2sat.join(''));
                       oddflag = (oddflag === 'odd'? '': 'odd');
                    }
                    if (misc.join('') !== ''){
                        arrCompContent.push(  '<tr class="' + oddflag +'">');
                        arrCompContent.push( misc.join(''));
                       oddflag = (oddflag === 'odd'? '': 'odd');
                    }
                    arrCompContent.push( "</table>");
                } else {
                    arrCompContent.push(  "<p>No results found</p>");
                }
            },
            processCcInstance     : function (contentBody) {
                var recordCount = [],
                    compContent = appVITAL.gFuncs.parseTemplate(appVITAL.gTmplts.gCcMainDiv.join(''), {
                        cc_id      : vitalsigns.cc_id,
                        mainSection: contentBody
                    });
                recordCount.push("(", component.eApps.elementObj.VITALS_CNT, ")");
                if (component.name === 'chla.vitalsigns') {
                    component.setProperty("headerSubTitle", recordCount.join(''));
                }
                appVITAL.Logger.LogWarn('component.name: ' + component.name )
                appVITAL.gFuncs.Log_CC(component, compContent);
                component.eApps.target.innerHTML = compContent;
            },
            TestServiceAccessPoint: function () {

            },
            init: function () {
                var CcInit = chla.eApps.gCcModuleCls.neo();
                appVITAL   = chla.eAppsClass.neo();
                CcInit.CommonCcInit(appVITAL, component);
                component.eApps.TestSap = vitalsigns.TestServiceAccessPoint;
                elementObj              = component.eApps.elementObj;
                vitalsigns.cc_id        = component.eApps.cc_id;
                vitalsigns.personId     = component.eApps.personId;
                vitalsigns.encounterId  = component.eApps.encounterId;
                vitalsigns.prsnlId      = component.eApps.userId;

            }
    };
    vitalsigns.init();
    if (component.eApps.initOnly === false) {
        vitalsigns.processRPTDATA();
        vitalsigns.processCcInstance(arrCompContent.join(''));
    }
};


chla.note = function () { };
chla.note.prototype = new MPage.Component();
chla.note.prototype.constructor = MPage.Component;
chla.note.prototype.base = MPage.Component.prototype;
chla.note.prototype.name = "chla.note";
chla.note.prototype.cclProgram = "CHLA_CA_MP_MD_VITALS_JSON";
chla.note.prototype.cclParams = [];
chla.note.prototype.cclDataType = "JSON";
chla.note.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("encounterId");
};

chla.note.prototype.render = function () {
    var component = this;
    var elementObj;
    var recordCount;
    var subHeaderDisplay = recordCount;
    var target = this.getTarget();
    var compContent;
    var hoverContent;
    var dEncounterId = this.getProperty("encounterId");
    var dPersonId = this.getProperty("personId");

    this.setProperty("headerSubTitle", subHeaderDisplay);

    elementObj = component.data.RPTDATA;
    compContent = "<div id='note'>";

    compContent = '<a id = "newNote" href="#">New Inpatient Progress Note</a>';
    compContent += "</div>";
    target.innerHTML = compContent;


    $('#newNote').click(function (evt) {
        evt.preventDefault();
        //alert(dPersonId);
        //alert(dEncounterId);
        var bstrEPCKISource = "CHLA";
        var bstrEPCKIIdentifier = "EP INPATIENT PROGRESS NOTE";
        var PowerNoteMPageUtils = window.external.DiscernObjectFactory("POWERNOTE");
        PowerNoteMPageUtils.BeginNoteFromEncounterPathway(dPersonId, dEncounterId, bstrEPCKISource, bstrEPCKIIdentifier);
    });
};


//Diet Orders
chla.gastroorders = function () { };
chla.gastroorders.prototype = new MPage.Component();
chla.gastroorders.prototype.constructor = MPage.Component;
chla.gastroorders.prototype.base = MPage.Component.prototype;
chla.gastroorders.prototype.name = "chla.gastroorders";
chla.gastroorders.prototype.cclProgram = "CHLA_CA_MP_CC_DIET_ORDERS_JSON";
chla.gastroorders.prototype.cclParams = [];
chla.gastroorders.prototype.cclDataType = "JSON";
chla.gastroorders.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("encounterId");
};

chla.gastroorders.prototype.render = function () {

    var component = this;
    var elementObj;
    var target = this.getTarget();
    var compContent;

    var recordCount;
    var dietOrderCount;
    var photoOrderCount;
    var subHeaderDisplay;
    var hoverContent;
    var gFuncs,
        oddEvenFlag,
        gastroorders = {
            initOnly: false,
            cc_id: 'x',
            personId: 0,
            encounterId: 0,
            prsnlId: 0,
            transparentSpacer: '',
            CC_SectionManagement: {
                sectionlist: []
            }
        }

    component.eApps = {
        cc_id: component.name.replace('.', '_'),
        CSSBehaviors: chla.eApps.gCSSBehavior.neo(),
        TestSAP: null
    };

    gFuncs = chlaNsMgr.aliasDirector('chla.eApps.gFuncs');
    compContent = '<div id="' + component.eApps.cc_id + '">';

    elementObj = component.data.RPTDATA;
    recordCount = "(" + elementObj.ORDER_CNT + ")";
    dietOrderCount = elementObj.DIET_ORDER_CNT;
    photoOrderCount = elementObj.PHOTO_ORDER_CNT;
    subHeaderDisplay = recordCount;
    this.setProperty("headerSubTitle", subHeaderDisplay);

    if (elementObj.ORDER_CNT > 0) {
        var d, dietOrders, p, photoOrders;

        compContent += "<table class='header'><tr><th class='col-1'>Name</th><th class='col-2'>Detail</th></tr></table>";
        if (elementObj.DIET_ORDERS.length == 0){
            compContent += "<div class='sectionDiv'><h2 id='dietOrdersHead' class='gastroorders_sectionHead' " +
                            'style="color: grey; background-image: none;">Diet Orders (' +
                            dietOrderCount + ")</h2><div><table>";
        } else {
            compContent += "<div class='sectionDiv'><h2 id='dietOrdersHead' class='gastroorders_sectionHead sectEnable'>Diet Orders (" +
                            dietOrderCount + ")</h2><div><table>";
        }

        for (d = 0; d < elementObj.DIET_ORDERS.length; d++) {
            var dietOrder = elementObj.DIET_ORDERS[d];
                compContent += '<tr class="rowPopup ';
                compContent += (oddEvenFlag == 1? ' odd" ': '"');
                oddEvenFlag = (oddEvenFlag == 1?0:1);
                compContent += " tip=\""
                + "<ul>"
				+ "<li><span style=&quot;font-weight:800;&quot;>Original Order Date:</span> " + dietOrder.ORIG_ORDER_DT_TM + "</li>"
				+ "<li><span style=&quot;font-weight:800;&quot;>Current Start Date:</span> " + dietOrder.CURRENT_START_DT_TM + "</li>"
				+ "<li><span style=&quot;font-weight:800;&quot;>Projected Stop Date:</span> " + dietOrder.PROJECTED_STOP_DT_TM + "</li>"
				+ "<li><span style=&quot;font-weight:800;&quot;>Clinical Display Line:</span> " + dietOrder.CLINICAL_DISPLAY_LINE + "</li>"
                + "</ul>"
			+ "\">";
            compContent += "<td class='medName'>" + dietOrder.ORDER_MNEMONIC + "</td>";
            compContent += "<td class='medDesc'>" + dietOrder.CLINICAL_DISPLAY_LINE + "</td>";
            compContent += "</tr>";
        }
        compContent += "</table></div></div>";
        if (elementObj.PHOTO_ORDERS.length == 0){
           compContent += '<div class="sectionDiv"><h2 class="gastroorders_sectionHead" style="color: grey; background-image: none;">Photo Orders (' + photoOrderCount + ')</h2><div><table>';
        } else {
            compContent += "<div class='sectionDiv'><h2 class='gastroorders_sectionHead sectEnable'>Photo Orders (" + photoOrderCount + ")</h2><div><table>";
        }
        for (p = 0; p < elementObj.PHOTO_ORDERS.length; p++) {
            var photoOrder = elementObj.PHOTO_ORDERS[p];
            compContent += "<tr class='rowPopup' tip=\""
                + "<ul>"
				+ "<li><span style=&quot;font-weight:800;&quot;>Original Order Date:</span> " + photoOrder.ORIG_ORDER_DT_TM + "</li>"
				+ "<li><span style=&quot;font-weight:800;&quot;>Current Start Date:</span> " + photoOrder.CURRENT_START_DT_TM + "</li>"
				+ "<li><span style=&quot;font-weight:800;&quot;>Projected Stop Date:</span> " + photoOrder.PROJECTED_STOP_DT_TM + "</li>"
				+ "<li><span style=&quot;font-weight:800;&quot;>Clinical Display Line:</span> " + photoOrder.CLINICAL_DISPLAY_LINE + "</li>"
                + "</ul>"
			+ "\">";
            compContent += "<td class='medName'>" + photoOrder.ORDER_MNEMONIC + "</td>";
            compContent += "<td class='medDesc'>" + photoOrder.CLINICAL_DISPLAY_LINE + "</td>";
            compContent += "</tr>";
        }

        compContent += "</table></div></div>";
    } else {
        compContent = "<p>No gastrointestinal orders found</p>";
    }
    compContent += "</div>";
    gFuncs.Log_CC( component, compContent);
    target.innerHTML = compContent;
    component.eApps.CSSBehaviors.InitPopUpsZstripe('div#' + component.eApps.cc_id + ' .rowPopup');

    //Function to expand/contract future/completed sections
    $('.sectEnable').click(function () {
        $(this).toggleClass('gastroorders_expanded');
        $(this).next().toggle();
        return false;
    }).next().hide();

    //Initialize hovers to display additional surgery detail

    //Open future section by default
    $('#dietOrdersHead').click();
};


//Levels
chla.levels = function () { };
chla.levels.prototype = new MPage.Component();
chla.levels.prototype.constructor = MPage.Component;
chla.levels.prototype.base = MPage.Component.prototype;
chla.levels.prototype.name = "chla.levels";
chla.levels.prototype.cclProgram = "CHLA_CA_MP_CC_MIC_DRG_LVL_JSON";
chla.levels.prototype.cclParams = [];
chla.levels.prototype.cclDataType = "JSON";
chla.levels.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("encounterId");
};


chla.levels.prototype.render = function () {
    var component = this;
    var elementObj;
    var target = this.getTarget();
    var compContent;

    var amikacin_cnt,
        gentamicin_cnt,
        tobramycin_cnt,
        vancomycin_cnt,
        voriconazole_cnt,
        totalCount,
        recordCount,
        subHeaderDisplay,
        hoverContent;

    var pos, positive, neg, negative, pen, pending,
        i,
        amikacinEvent,
        gentamicinEvent,
        tobramycinEvent,
        vancomycinEvent,
        voriconazoleEvent;

    var gFuncs,
        oddEvenFlag,
        levels = {
            initOnly: false,
            cc_id: 'x',
            personId: 0,
            encounterId: 0,
            prsnlId: 0,
            transparentSpacer: '',
            CC_SectionManagement: {
                sectionlist: []
            }
        }

    component.eApps = {
        cc_id: component.name.replace('.', '_'),
        CSSBehaviors: chla.eApps.gCSSBehavior.neo(),
        TestSAP: null
    };

    gFuncs = chlaNsMgr.aliasDirector('chla.eApps.gFuncs');
    compContent = '<div id="' + component.eApps.cc_id + '">';

    elementObj = component.data.RPTDATA;
    amikacin_cnt = elementObj.AMIKACIN_CNT;
    gentamicin_cnt = elementObj.GENTAMICIN_CNT;
    tobramycin_cnt = elementObj.TOBRAMYCIN_CNT;
    vancomycin_cnt = elementObj.VANCOMYCIN_CNT;
    voriconazole_cnt = elementObj.VORICONAZOLE_CNT;
    totalCount = amikacin_cnt + gentamicin_cnt + tobramycin_cnt + vancomycin_cnt + voriconazole_cnt;
    recordCount = "(" + totalCount + ")";
    subHeaderDisplay = recordCount;

    this.setProperty("headerSubTitle", "(" + totalCount + ")");

    if (totalCount > 0) {
        compContent += "<table class='header'><tr><th class='col-1'>Date</th><th class='col-2'>Event</th><th class='col-3'>Value</th></table>";

        compContent += '<div class="sectionDiv"><h2 class="levels_sectionHead';
        compContent += (elementObj.AMIKACIN.length == 0 ? '"': ' sectEnable"');
        compContent += (elementObj.AMIKACIN.length == 0 ? '" style="color:grey; background-image: none;"': '"');
        compContent += "'>Amikacin (" + amikacin_cnt + ")</h2><div><table>";
        oddEvenFlag  =  0;

        for ( i = 0; i < elementObj.AMIKACIN.length; i++) {
            amikacinEvent = elementObj.AMIKACIN[i];
            compContent += "<tr";
            compContent += (oddEvenFlag == 1? " class='odd' >": ">");
            oddEvenFlag = (oddEvenFlag == 1?0:1);

            compContent += "<td class='col-1'>" + amikacinEvent.EVENT_END_DT_TM + "</td>";
            compContent += "<td class='col-2'>" + amikacinEvent.EVENT + "</td>";
            compContent += "<td class='col-3'>" + amikacinEvent.RESULT_VAL + " <span class='eapps-unitsHO'>" + amikacinEvent.RESULT_UNITS + "</span></td>";
            compContent += "</tr>";
        }
        compContent += "</table></div></div>";

        compContent += '<div class="sectionDiv"><h2 class="levels_sectionHead';
        compContent += (elementObj.GENTAMICIN.length == 0 ? '"': ' sectEnable"');
        compContent += (elementObj.GENTAMICIN.length == 0 ? '" style="color:grey; background-image: none;"': '"');
        compContent += "'>Gentamicin (" + gentamicin_cnt + ")</h2><div><table>";
        oddEvenFlag  =  0;

        for ( i = 0; i < elementObj.GENTAMICIN.length; i++) {
            gentamicinEvent = elementObj.GENTAMICIN[i];
            compContent += "<tr";
            compContent += (oddEvenFlag == 1? " class='odd' >": ">");
            oddEvenFlag = (oddEvenFlag == 1?0:1);

            compContent += "<td class='col-1'>" + gentamicinEvent.EVENT_END_DT_TM + "</td>";
            compContent += "<td class='col-2'>" + gentamicinEvent.EVENT + "</td>";
            compContent += "<td class='col-3'>" + gentamicinEvent.RESULT_VAL + " <span class='eapps-unitsHO'>" + gentamicinEvent.RESULT_UNITS + "</span></td>";
            compContent += "</tr>";
        }
        compContent += "</table></div></div>";

        compContent += '<div class="sectionDiv"><h2 class="levels_sectionHead';
        compContent += (elementObj.TOBRAMYCIN.length == 0 ? '"': ' sectEnable"');
        compContent += (elementObj.TOBRAMYCIN.length == 0 ? '" style="color:grey; background-image: none;"': '"');
        compContent += "'>Tobramycin (" + tobramycin_cnt + ")</h2><div><table>";
        oddEvenFlag  =  0;

        for (i = 0; i < elementObj.TOBRAMYCIN.length; i++) {
            tobramycinEvent = elementObj.TOBRAMYCIN[i];
            compContent += "<tr";
            compContent += (oddEvenFlag == 1? " class='odd' >": ">");
            oddEvenFlag = (oddEvenFlag == 1?0:1);

            compContent += "<td class='col-1'>" + tobramycinEvent.EVENT_END_DT_TM + "</td>";
            compContent += "<td class='col-2'>" + tobramycinEvent.EVENT + "</td>";
            compContent += "<td class='col-3'>" + tobramycinEvent.RESULT_VAL + " <span class='eapps-unitsHO'>" + tobramycinEvent.RESULT_UNITS + "</span></td>";
            compContent += "</tr>";
        }
        compContent += "</table></div></div>";

        compContent += '<div class="sectionDiv"><h2 class="levels_sectionHead';
        compContent += (elementObj.VANCOMYCIN.length == 0 ? '"': ' sectEnable"');
        compContent += (elementObj.VANCOMYCIN.length == 0 ? '" style="color:grey; background-image: none;"': '"');
        compContent += '>Vancomycin (' + vancomycin_cnt + ")</h2><div><table>";
        oddEvenFlag  =  0;

        for (i = 0; i < elementObj.VANCOMYCIN.length; i++) {
            vancomycinEvent = elementObj.VANCOMYCIN[i];
            compContent += "<tr";
            compContent += (oddEvenFlag == 1? " class='odd' >": ">");
            oddEvenFlag = (oddEvenFlag == 1?0:1);

            compContent += "<td class='col-1'>" + vancomycinEvent.EVENT_END_DT_TM + "</td>";
            compContent += "<td class='col-2'>" + vancomycinEvent.EVENT + "</td>";
            compContent += "<td class='col-3'>" + vancomycinEvent.RESULT_VAL + " <span class='eapps-unitsHO'>" + vancomycinEvent.RESULT_UNITS + "</span></td>";
            compContent += "</tr>";
        }
        compContent += "</table></div></div>";

        compContent += '<div class="sectionDiv"><h2 class="levels_sectionHead';
        compContent += (elementObj.VORICONAZOLE.length == 0 ? '"': ' sectEnable"');
        compContent += (elementObj.VORICONAZOLE.length == 0 ? '" style="color:grey; background-image: none;"': '"');
        compContent += ">Voriconazole (" + voriconazole_cnt + ")</h2><div><table>";
        oddEvenFlag  =  0;

        for (i = 0; i < elementObj.VORICONAZOLE.length; i++) {
            voriconazoleEvent = elementObj.VORICONAZOLE[i];
            compContent += "<tr";
            compContent += (oddEvenFlag == 1? " class='odd' >": ">");
            oddEvenFlag = (oddEvenFlag == 1?0:1);

            compContent += "<td class='col-1'>" + voriconazoleEvent.EVENT_END_DT_TM + "</td>";
            compContent += "<td class='col-2'>" + voriconazoleEvent.EVENT + "</td>";
            compContent += "<td class='col-3'>" + voriconazoleEvent.RESULT_VAL + " <span class='eapps-unitsHO'>" + voriconazoleEvent.RESULT_UNITS + "</span></td>";
            compContent += "</tr>";
        }
        compContent += "</table></div></div>";

    } else {
        compContent = "<p>No micro levels found</p>";
    }
    compContent += "</div>";
    gFuncs.Log_CC( component, compContent);
    target.innerHTML = compContent;

    //Function to expand/contract future/completed sections
    $('.levels_sectionHead').click(function () {
        $(this).toggleClass('levels_expanded');
        $(this).next().toggle();
        return false;
    }).next().hide();
};

//Blood Gas Results
chla.bloodgas = function () { };
chla.bloodgas.prototype = new MPage.Component();
chla.bloodgas.prototype.constructor = MPage.Component;
chla.bloodgas.prototype.base = MPage.Component.prototype;
chla.bloodgas.prototype.name = "chla.bloodgas";
chla.bloodgas.prototype.cclProgram = "chla_ca_mp_cc_blood_gas_json";
chla.bloodgas.prototype.cclParams = [];
chla.bloodgas.prototype.cclDataType = "JSON";
chla.bloodgas.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("encounterId");
    this.cclParams[2] = "10";
    this.cclParams[3] = "D";
};

chla.bloodgas.prototype.render = function () {
    var component = this,
        elementObj,
        target = this.getTarget(),
        compContent;
    var abgResultCount,
        cbgResultCount,
        vbgResultCount,
        totalResultCount,
        recordCount,
        subHeaderDisplay,
        i, a, c, v,
        vDetail,
        aResults, cResults, vResults, aResult,
        aDetail, cDetail, cResult, vResult, event,
        pH, pCO2, p02, HCO3, BE, TCO2;
    var gFuncs,
        wrkArr = [],
        oddEvenFlag,
        bloodgas = {
            initOnly: false,
            cc_id: 'x',
            personId: 0,
            encounterId: 0,
            prsnlId: 0,
            transparentSpacer: '',
            CC_SectionManagement: {
                sectionlist: []
            }
        };
    component.eApps = {
        cc_id: component.name.replace('.', '_'),
        CSSBehaviors: chla.eApps.gCSSBehavior.neo(),
        TestSAP: null
    };
    gFuncs = chlaNsMgr.aliasDirector('chla.eApps.gFuncs');
    wrkArr.push('<div id="');
    wrkArr.push(component.eApps.cc_id);
    wrkArr.push('">');
    elementObj = component.data.RPTDATA;
    abgResultCount = elementObj.ABG_RESULT_CNT;
    cbgResultCount = elementObj.CBG_RESULT_CNT;
    vbgResultCount = elementObj.VBG_RESULT_CNT;
    totalResultCount = abgResultCount + cbgResultCount + vbgResultCount;
    recordCount = "(" + totalResultCount + ")";
    subHeaderDisplay = recordCount;
    this.setProperty("headerSubTitle", subHeaderDisplay);
    wrkArr.push('<div id="bloodgas">');
    if (elementObj.ABG_RESULT_CNT > 0 || elementObj.CBG_RESULT_CNT > 0 || elementObj.VBG_RESULT_CNT > 0) {
        wrkArr.push("<table class='header'><tr><th class='col-1'>Date</th><th class='col-2'>Result</th></tr></table>");
        oddEvenFlag = 0;
        //ABG
        wrkArr.push('<div class="sectionDiv"><h2 class="bloodgas_sectionHead"');
        wrkArr.push((abgResultCount == 0 ? ' style="color: grey; background-image: none;"' : ''));
        wrkArr.push('>ABG (');
        wrkArr.push(abgResultCount);
        wrkArr.push(')</h2><div><table>');
        for (a = 0; a < abgResultCount; a++) {
            aResult = elementObj.ABG_RESULTS[a];
            wrkArr.push('<tr class="rowPopup ');
            wrkArr.push((oddEvenFlag == 1 ? ' odd" ' : '"'));
            oddEvenFlag = (oddEvenFlag == 1 ? 0 : 1);
            wrkArr.push(' tip="');
            wrkArr.push('<ul>');
            wrkArr.push('<li>pH / pCO2 / pO2 / HCO3 / BE, Transcutaneous CO2</li>');
            wrkArr.push('</ul>');
            wrkArr.push('">');
            wrkArr.push('<td class="col-1">');
            wrkArr.push(aResult.EVENT_DATE);
            wrkArr.push('</td>');
            pH = "--";
            pCO2 = "--";
            p02 = "--";
            HCO3 = "--";
            BE = "--";
            TCO2 = "--";
            for (i = 0, aResults = aResult.ABG_DETAILS.length; i < aResults; i++) {
                aDetail = aResult.ABG_DETAILS[i];
                event = aDetail.EVENT;
                switch (event) {
                    case "ABG pH":
                        pH = aDetail.RESULT;
                        break;
                    case "ABG pCO2":
                        pCO2 = aDetail.RESULT;
                        break;
                    case "ABG pO2":
                        p02 = aDetail.RESULT;
                        break;
                    case "ABG HCO3":
                        HCO3 = aDetail.RESULT;
                        break;
                    case "ABG BE":
                        BE = aDetail.RESULT;
                        break;
                    case "ABG TCO2":
                        TCO2 = aDetail.RESULT;
                        break;
                }
            }
            wrkArr.push('<td class="col-2">');
            wrkArr.push(pH);
            wrkArr.push('/');
            wrkArr.push(pCO2);
            wrkArr.push('/');
            wrkArr.push(p02);
            wrkArr.push('/');
            wrkArr.push(HCO3);
            wrkArr.push('/');
            wrkArr.push(BE);
            wrkArr.push(', ');
            wrkArr.push(TCO2);
            wrkArr.push('</td>');
            wrkArr.push('</tr>');
        }
        wrkArr.push('</table></div></div>');
        oddEvenFlag = 0;
        //CBG
        wrkArr.push('<div class="sectionDiv"><h2 class="bloodgas_sectionHead"');
        wrkArr.push((cbgResultCount == 0 ? ' style="color: grey; background-image: none;"' : ""));
        wrkArr.push('>CBG (');
        wrkArr.push(cbgResultCount);
        wrkArr.push(')</h2><div><table>');
        for (c = 0; c < cbgResultCount; c++) {
            cResult = elementObj.CBG_RESULTS[c];
            wrkArr.push('<tr class="rowPopup ');
            wrkArr.push((oddEvenFlag == 1 ? ' odd" ' : '"'));
            oddEvenFlag = (oddEvenFlag == 1 ? 0 : 1);
            wrkArr.push(' tip="');
            wrkArr.push('<ul>');
            wrkArr.push('<li>pH / pCO2 / pO2 / HCO3 / BE, Transcutaneous CO2</li>');
            wrkArr.push('</ul>');
            wrkArr.push('">');
            wrkArr.push('<td class="col-1">');
            wrkArr.push(cResult.EVENT_DATE);
            wrkArr.push('</td>');
            for (i = 0, cResults = cResult.CBG_DETAILS.length; i < cResults; i++) {
                cDetail = cResult.CBG_DETAILS[i];
                event = cDetail.EVENT;
                switch (event) {
                    case "CBG pH":
                        pH = cDetail.RESULT;
                        break;
                    case "CBG pCO2":
                        pCO2 = cDetail.RESULT;
                        break;
                    case "CBG pO2":
                        p02 = cDetail.RESULT;
                        break;
                    case "CBG HCO3":
                        HCO3 = cDetail.RESULT;
                        break;
                    case "CBG BE":
                        BE = cDetail.RESULT;
                        break;
                    case "CBG TCO2":
                        TCO2 = cDetail.RESULT;
                        break;
                }
            }
            wrkArr.push('<td class="col-2">');
            wrkArr.push(pH);
            wrkArr.push('/');
            wrkArr.push(pCO2);
            wrkArr.push('/');
            wrkArr.push(p02);
            wrkArr.push('/');
            wrkArr.push(HCO3);
            wrkArr.push('/');
            wrkArr.push(BE);
            wrkArr.push(', ');
            wrkArr.push(TCO2);
            wrkArr.push('</td>');
            wrkArr.push('</tr>');
        }
        wrkArr.push('</table></div></div>');
        oddEvenFlag = 0;
        //VBG
        wrkArr.push('<div class="sectionDiv"><h2 class="bloodgas_sectionHead"');
        wrkArr.push((vbgResultCount == 0 ? ' style="color: grey; background-image: none;"' : ""));
        wrkArr.push('>VBG (');
        wrkArr.push(vbgResultCount);
        wrkArr.push(')</h2><div><table>');
        for (v = 0; v < vbgResultCount; v++) {
            vResult = elementObj.VBG_RESULTS[v];
            wrkArr.push('<tr class="rowPopup ');
            wrkArr.push((oddEvenFlag == 1 ? ' odd" ' : '"'));
            oddEvenFlag = (oddEvenFlag == 1 ? 0 : 1);
            wrkArr.push(' tip="');
            wrkArr.push('<ul>');
            wrkArr.push('<li>pH / pCO2 / pO2 / HCO3 / BE, Transcutaneous CO2</li>');
            wrkArr.push('</ul>');
            wrkArr.push('">');
            wrkArr.push('<td class="col-1">');
            wrkArr.push(vResult.EVENT_DATE);
            wrkArr.push('</td>');
            for (i = 0, vResults = vResult.VBG_DETAILS.length; i < vResults; i++) {
                vDetail = vResult.VBG_DETAILS[i];
                event = vDetail.EVENT;
                switch (event) {
                    case "VBG pH":
                        pH = vDetail.RESULT;
                        break;
                    case "VBG pCO2":
                        pCO2 = vDetail.RESULT;
                        break;
                    case "VBG pO2":
                        p02 = vDetail.RESULT;
                        break;
                    case "VBG HCO3":
                        HCO3 = vDetail.RESULT;
                        break;
                    case "VBG BE":
                        BE = vDetail.RESULT;
                        break;
                    case "VBG TCO2":
                        TCO2 = vDetail.RESULT;
                        break;
                }
            }
            wrkArr.push('<td class="col-2">');
            wrkArr.push(pH);
            wrkArr.push('/');
            wrkArr.push(pCO2);
            wrkArr.push('/');
            wrkArr.push(p02);
            wrkArr.push('/');
            wrkArr.push(HCO3);
            wrkArr.push('/');
            wrkArr.push(BE);
            wrkArr.push(', ');
            wrkArr.push(TCO2);
            wrkArr.push('</td>');
            wrkArr.push('</tr>');
        }
        wrkArr.push('</table></div></div>');
    } else {
        wrkArr.push('<p>No blood gas results found</p>');
    }
    wrkArr.push('</div>');
    compContent = wrkArr.join('');
    gFuncs.Log_CC(component, compContent);
    target.innerHTML = compContent;
    component.eApps.CSSBehaviors.InitPopUpsZstripe('div#' + component.eApps.cc_id + ' .rowPopup');
    //Function to expand/contract sections
    $('.bloodgas_sectionHead').click(function () {
        $(this).toggleClass('bloodgas_expanded');
        $(this).next().toggle();
        return false;
    }).next().hide();
};

//Ventilator Results
chla.ventilator = function () { };
chla.ventilator.prototype = new MPage.Component();
chla.ventilator.prototype.constructor = MPage.Component;
chla.ventilator.prototype.base = MPage.Component.prototype;
chla.ventilator.prototype.name = "chla.ventilator";
chla.ventilator.prototype.cclProgram = "chla_ca_mp_cc_ventilator_json";
chla.ventilator.prototype.cclParams = [];
chla.ventilator.prototype.cclDataType = "JSON";
chla.ventilator.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("encounterId");
};

chla.ventilator.prototype.render = function () {


    var component = this,
        elementObj,
        target = this.getTarget(),
        compContent;

    var ventResultCnt,
        ventO2ResultCnt,
        hfovVentResultCnt,
        nivVentResultCnt,
        respResultCnt,
        totalResultCnt,
        recordCount,
        subHeaderDisplay,
        hoverContent,
        r,d;

    var result,
        literFlowPerMinute,
        FiO2,
        detail,
        event,
        result,
        ventMode,
        ventRate,
        PIP,
        PEEP,
        pressureSupport,
        volumeTidal,
        setTidalVolume,
        detail,
        event,
        result,
        HFOVMap,
        amplitude,
        frequency,
        detail,
        event,
        result,
        ventSetRateNIV,
        IPAPPIP,
        EPAPPEEP,
        detail,
        event,
        result,
        transCO2,
        NOGas,
        detail,
        event,
        oddEvenFlag,
        wrkValueHdr= '',
        wrkValueFtr= '',
        wrkResult,
        arrWork=[],
        gFuncs;

    var ventilator = {
            initOnly: false,
            cc_id: 'x',
            personId: 0,
            encounterId: 0,
            prsnlId: 0,
            transparentSpacer: '',
            CC_SectionManagement: {
                sectionlist: []
            }
        }

    component.eApps = {
        cc_id: component.name.replace('.', '_'),
        CSSBehaviors: chla.eApps.gCSSBehavior.neo(),
        TestSAP: null
    };
    gFuncs = chlaNsMgr.aliasDirector('chla.eApps.gFuncs');
    compContent = '<div id="' + component.eApps.cc_id + '">';

    elementObj = component.data.RPTDATA;
    ventResultCnt = elementObj.VENT_RESULT_CNT;
    ventO2ResultCnt = elementObj.VENT_O2_RESULT_CNT;
    hfovVentResultCnt = elementObj.HFOV_VENT_RESULT_CNT;
    nivVentResultCnt = elementObj.NON_INVASIVE_VENT_RESULT_CNT;
    respResultCnt = elementObj.RESP_RESULT_CNT;
    totalResultCnt = ventResultCnt + ventO2ResultCnt + hfovVentResultCnt + nivVentResultCnt + respResultCnt;
    recordCount = "(" + totalResultCnt + ")";
    subHeaderDisplay = recordCount;

    this.setProperty("headerSubTitle", subHeaderDisplay);

    oddEvenFlag = 0;

    if (totalResultCnt > 0) {
        compContent += "<table class='header'><tr><th class='col-1'>Date</th><th class='col-2'>Result</th></tr></table>";

        //Vent O2
        compContent += "<div class='sectionDiv'><h2 class='ventilator_sectionHead'" ;
        compContent += (elementObj.VENT_O2_RESULTS.length == 0?  'style="color: grey; background-image: none;"' : "");
        compContent += " id = 'ventO2Head'>NC/Vent O2 (" + ventO2ResultCnt + ")</h2><div>";

        wrkValueHdr = (elementObj.VENT_O2_RESULTS.length > 20?  '<div style="height: 25em; overflow-y: scroll;">' : "");
        wrkValueFtr = (wrkValueHdr == ""? "": "</div>");
        wrkValueHdr += "<table>";
        wrkResult = '';
        for (r = 0; r < elementObj.VENT_O2_RESULTS.length; r++) {
            result = elementObj.VENT_O2_RESULTS[r];
            wrkResult += '<tr class="rowPopup ';
            wrkResult += (oddEvenFlag == 1? ' odd"': '"');
            oddEvenFlag = (oddEvenFlag == 1?0:1);
            wrkResult += ' tip=\"'
                + "<ul>"
                + "<li>Liter flow per minute / FiO2</li>"
                + "</ul>"
                + "\">";
            wrkResult += "<td class = 'col-1'>" + result.EVENT_DATE + "</td>";
            //	Liter flow per minute / Fi02 (with eapps-unitsHO)

            literFlowPerMinute = "--";
            FiO2 = "--";

            for (d = 0; d < result.VENT_O2_DETAILS.length; d++) {
                detail = result.VENT_O2_DETAILS[d];
                event = detail.EVENT;
                switch (event) {
                    case "Liter Flow Per Minute":
                        literFlowPerMinute = detail.RESULT + " <span class='eapps-unitsHO'>" + detail.RESULT_UNITS + "</span>";
                        break;
                    case "FiO2":
                        FiO2 = detail.RESULT + " <span class='eapps-unitsHO'>" + detail.RESULT_UNITS + "</span>";
                        break;
                }

            }
            wrkResult += "<td>" + literFlowPerMinute + "/" + FiO2 + "</td>";
            wrkResult += "</tr>";
        }
        compContent += wrkValueHdr + wrkResult + '</table>' + wrkValueFtr;
        compContent += "</div></div>";

        //Ventilator
        compContent += "<div class='sectionDiv'><h2 class='ventilator_sectionHead'";
        compContent += (elementObj.VENT_RESULTS.length == 0?  ' style="color: grey; background-image: none;"' : "");
        compContent += " id = 'ventHead'>Ventilator (" + ventResultCnt + ")</h2><div>";

        wrkValueHdr = (elementObj.VENT_RESULTS.length > 20?  '<div style="height: 25em; overflow-y: scroll;">' : "");
        wrkValueFtr = (wrkValueHdr == ""? "": "</div>");
        wrkValueHdr += "<table>";
        wrkResult = '';
        for (r = 0; r < elementObj.VENT_RESULTS.length; r++) {
            result = elementObj.VENT_RESULTS[r];

            ventMode = "--";
            ventRate = "--";
            PIP = "--";
            PEEP = "--";
            pressureSupport = "--";
            volumeTidal = "--";
            setTidalVolume = "--";

            for (d = 0; d < result.VENT_DETAILS.length; d++) {
                detail = result.VENT_DETAILS[d];
                event = detail.EVENT;
                switch (event) {
                    case "Ventilator Modes":
                        ventMode = detail.RESULT;
                        break;
                    case "Ventilator Set Rate":
                        ventRate = detail.RESULT + " <span class='eapps-unitsHO'>" + detail.RESULT_UNITS + "</span>";
                        break;
                    case "Peak Inspiratory Pressure":
                        PIP = detail.RESULT + " <span class='eapps-unitsHO'>" + detail.RESULT_UNITS + "</span>";
                        break;
                    case "PEEP":
                        PEEP = detail.RESULT + " <span class='eapps-unitsHO'>" + detail.RESULT_UNITS + "</span>";
                        break;
                    case "Pressure Support":
                        pressureSupport = detail.RESULT + " <span class='eapps-unitsHO'>" + detail.RESULT_UNITS + "</span>";
                        break;
                    case "Set Tidal Volume":
                        setTidalVolume = detail.RESULT + " <span class='eapps-unitsHO'>" + detail.RESULT_UNITS + "</span>";
                        break;
                    case "Volume Tidal":
                        volumeTidal = detail.RESULT + " <span class='eapps-unitsHO'>" + detail.RESULT_UNITS + "</span>";
                        break;
                }

            }
            if (ventMode.match(/Volume Guarantee/)) {
                wrkResult += '<tr class="rowPopup ';
                wrkResult += (oddEvenFlag == 1? ' odd"': '"');
                oddEvenFlag = (oddEvenFlag == 1?0:1);
                wrkResult += ' tip=\"'
					+ "<ul>"
					+ "<li>Vent Mode: Rate, Volume Tidal, Set Tidal Volume, PIP/PEEP</li>"
					+ "</ul>"
				+ "\">";
                wrkResult += "<td class = 'col-1'>" + result.EVENT_DATE + "</td>";
                wrkResult += "<td>" + ventMode + ": " + ventRate + ", " + volumeTidal + ", " + setTidalVolume + ", " + PIP + "/" + PEEP + "</td>";
                //Vent Mode: Rate, Volume Tidal, Set Tidal volume, PIP/PEEP
            } else {
                wrkResult += '<tr class="rowPopup ';
                wrkResult += (oddEvenFlag == 1? ' odd"': '"');
                oddEvenFlag = (oddEvenFlag == 1?0:1);
                wrkResult += ' tip=\"'
					+ "<ul>"
					+ "<li>Vent Mode: Rate, PIP/PEEP, Pressure Support</li>"
					+ "</ul>"
				+ "\">";
                wrkResult += "<td class = 'col-1'>" + result.EVENT_DATE + "</td>";
                wrkResult += "<td>" + ventMode + ": " + ventRate + ", " + PIP + "/" + PEEP + ", " + pressureSupport + "</td>";
                //Vent Mode: Rate, PIP/PEEP, Pressure Support
            }


            wrkResult += "</tr>";
        }
        compContent += wrkValueHdr + wrkResult + '</table>' + wrkValueFtr;
        compContent += "</div></div>";

        //HFOV Ventilator
        compContent += "<div class='sectionDiv'><h2 class='ventilator_sectionHead'";
        compContent += (elementObj.HFOV_VENT_RESULTS.length == 0?  ' style="color: grey; background-image: none;"' : "");
        compContent += " id = 'HFOVVentHead'>HFOV Vent (" + hfovVentResultCnt + ")</h2><div>";

        wrkValueHdr = (elementObj.HFOV_VENT_RESULTS.length > 20?  '<div style="height: 25em; overflow-y: scroll;">' : "");
        wrkValueFtr = (wrkValueHdr == ""? "": "</div>");
        wrkValueHdr += "<table>";
        arrWork.length = 0;
        for (r = 0; r < elementObj.HFOV_VENT_RESULTS.length; r++) {
            result = elementObj.HFOV_VENT_RESULTS[r];

            arrWork.push('<tr class="rowPopup ');
            arrWork.push((oddEvenFlag == 1? ' odd"': '"'));
            oddEvenFlag = (oddEvenFlag == 1?0:1);
            arrWork.push( ' tip=\"');
            arrWork.push( "<ul>");
            arrWork.push( "<li>HFOV MAP, Amplitude, Frequency</li>");
            arrWork.push( "</ul>");
            arrWork.push( "\">");
            arrWork.push( "<td class = 'col-1'>");
            arrWork.push( result.EVENT_DATE);
            arrWork.push( "</td>");
            //	HFOV Map, amplitude, Frequency

            HFOVMap = "--";
            amplitude = "--";
            frequency = "--";

            for (d = 0; d < result.HFOV_VENT_DETAILS.length; d++) {
                detail = result.HFOV_VENT_DETAILS[d];
                event = detail.EVENT;
                switch (event) {
                    case "HFOV MAP":
                        HFOVMap = detail.RESULT + " <span class='eapps-unitsHO'>" + detail.RESULT_UNITS + "</span>";
                        break;
                    case "Amplitude":
                        amplitude = detail.RESULT + " <span class='eapps-unitsHO'>" + detail.RESULT_UNITS + "</span>";
                        break;
                    case "Frequency":
                        frequency = detail.RESULT + " <span class='eapps-unitsHO'>Hz</span>";
                        break;
                }
            }
            arrWork.push( "<td>" );
            arrWork.push( HFOVMap);
            arrWork.push( ", " );
            arrWork.push( amplitude);
            arrWork.push( ", ");
            arrWork.push( frequency );
            arrWork.push( "</td>");
            arrWork.push( "</tr>");
        }

        compContent += wrkValueHdr + arrWork.join('') + '</table>' + wrkValueFtr;
        compContent += "</div></div>";

        //NIV
        compContent += "<div class='sectionDiv'><h2 class='ventilator_sectionHead'";
        compContent += (elementObj.NON_INVASIVE_VENT_RESULTS.length == 0?  ' style="color: grey; background-image: none;"' : "");
        compContent +=  " id = 'NIVHead'>Non-Invasive Ventilator (" + nivVentResultCnt + ")</h2><div>";

        wrkValueHdr = (elementObj.NON_INVASIVE_VENT_RESULTS.length > 20?  '<div style="height: 25em; overflow-y: scroll;">' : "");
        wrkValueFtr = (wrkValueHdr == ""? "": "</div>");
        wrkValueHdr += "<table>";
        wrkResult = '';
        for (r = 0; r < elementObj.NON_INVASIVE_VENT_RESULTS.length; r++) {
            result = elementObj.NON_INVASIVE_VENT_RESULTS[r];

            wrkResult += '<tr class="rowPopup ';
            wrkResult += (oddEvenFlag == 1? ' odd"': '"');
            oddEvenFlag = (oddEvenFlag == 1?0:1);
            wrkResult += ' tip=\"'
            + "<ul>"
            + "<li>Ventilator Set Rate NIV, IPAP/PIP, EPAP/PEEP</li>"
            + "</ul>"
            + "\">";
            wrkResult += "<td class = 'col-1'>" + result.EVENT_DATE + "</td>";
            //Ventilator Set Rate NIV, IPAP/PIP, EPAP/PEEP


            ventSetRateNIV = "--";
            IPAPPIP = "--";
            EPAPPEEP = "--";

            for (d = 0; d < result.NON_INVASIVE_VENT_DETAILS.length; d++) {
                detail = result.NON_INVASIVE_VENT_DETAILS[d];
                event = detail.EVENT;
                switch (event) {
                    case "Ventilator Set Rate NIV":
                        ventSetRateNIV = detail.RESULT + " <span class='eapps-unitsHO'>" + detail.RESULT_UNITS + "</span>";
                        break;
                    case "IPAP/PIP":
                        IPAPPIP = detail.RESULT + " <span class='eapps-unitsHO'>" + detail.RESULT_UNITS + "</span>";
                        break;
                    case "EPAP/PEEP":
                        EPAPPEEP = detail.RESULT + " <span class='eapps-unitsHO'>" + detail.RESULT_UNITS + "</span>";
                        break;
                }

            }
            wrkResult += "<td>" + ventSetRateNIV + ", " + IPAPPIP + ", " + EPAPPEEP + "</td>";
            wrkResult += "</tr>";
        }
        compContent += wrkValueHdr + wrkResult + '</table>' + wrkValueFtr;
        compContent += "</div></div>";

        //Resp
        compContent += "<div class='sectionDiv'><h2 class='ventilator_sectionHead'";
        compContent += (elementObj.RESP_RESULTS.length == 0?  ' style="color: grey; background-image: none;"' : "");
        compContent += " id = 'respHead'>Resp (" + respResultCnt + ")</h2><div>";

        wrkValueHdr = (elementObj.RESP_RESULTS.length > 20?  '<div style="height: 25em; overflow-y: scroll;">' : "");
        wrkValueFtr = (wrkValueHdr == ""? "": "</div>");
        wrkValueHdr += "<table>";
        wrkResult = '';
        for (r = 0; r < elementObj.RESP_RESULTS.length; r++) {
            result = elementObj.RESP_RESULTS[r];

            wrkResult += '<tr class="rowPopup ';
            wrkResult += (oddEvenFlag == 1? ' odd"': '"');
            oddEvenFlag = (oddEvenFlag == 1?0:1);
            wrkResult += ' tip=\"'
            + "<ul>"
            + "<li>Trans CO2, NO Gas</li>"
            + "</ul>"
            + "\">";
            wrkResult += "<td class = 'col-1'>" + result.EVENT_DATE + "</td>";
            //Trans CO2, NO Gas

            transCO2 = "--";
            NOGas = "--";

            for (d = 0; d < result.RESP_DETAILS.length; d++) {
                detail = result.RESP_DETAILS[d];
                event = detail.EVENT;
                switch (event) {
                    case "Transcutaneous CO2":
                        transCO2 = detail.RESULT + " <span class='eapps-unitsHO'>" + detail.RESULT_UNITS + "</span>";
                        break;
                    case "Nitric Oxide Gas":
                        NOGas = detail.RESULT + " <span class='eapps-unitsHO'>" + detail.RESULT_UNITS + "</span>";
                        break;
                }

            }
            wrkResult += "<td>" + transCO2 + ", " + NOGas + "</td>";
            wrkResult += "</tr>";
        }
        compContent += wrkValueHdr + wrkResult + '</table>' + wrkValueFtr;
        compContent += "</div></div>";


    } else {
        compContent = "<p>No ventilator results found</p></div>";
    }
    compContent += "</div>";
    gFuncs.Log_CC( component, compContent);
    target.innerHTML = compContent;

    component.eApps.CSSBehaviors.InitPopUpsZstripe('div#' + component.eApps.cc_id + ' .rowPopup');

    //Function to expand/contract sections
    $('.ventilator_sectionHead').click(function () {
        $(this).toggleClass('ventilator_expanded');
        $(this).next().toggle();
        return false;
    }).next().hide();

};

// Dialysis Results
chla.dialysis = function () { };
chla.dialysis.prototype = new MPage.Component();
chla.dialysis.prototype.constructor = MPage.Component;
chla.dialysis.prototype.base = MPage.Component.prototype;
chla.dialysis.prototype.name = "chla.dialysis";
chla.dialysis.prototype.cclProgram = "chla_ca_mp_cc_dialysis_json";
chla.dialysis.prototype.cclParams = [];
chla.dialysis.prototype.cclDataType = "JSON";
chla.dialysis.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("encounterId");
};

chla.dialysis.prototype.render = function () {

    var component = this;
    var elementObj;
    var recordCount = "(" + component.data.RPTDATA.RESULT_CNT + ")";
    var subHeaderDisplay = recordCount;
    var target = this.getTarget();
    var compContent;
    var hoverContent;

    this.setProperty("headerSubTitle", subHeaderDisplay);

    elementObj = component.data.RPTDATA;
    compContent = "<div id='dialysis'>";

    if (elementObj.RESULT_CNT > 0) {
        var r, results;

        compContent += "<table class='header'><tr><th class='col-1'>Date</th><th class='col-2'>Event</th><th class='col-3'>Result</th></tr></table>";
        compContent += "<table>";

        for (r = 0; r < elementObj.RESULTS.length; r++) {
            var result = elementObj.RESULTS[r];

            compContent += "<tr class='rowPopup' tip=\""
                //+ "<ul>"
                // + "<li><strong>PD (Retained) Intake Date/Time:</strong> " + pdIntakeDateTime + "</li>"
                // + "<li><strong>PD (Pulled Off) Output:</strong> " + pdOutputDateTime + "</li>"
                // + "<li><strong>PD 24hr Net Balance:</strong> " + pdBalanceDateTime + "</li>"
                //+ "</ul>"
                + "\">";
            compContent += "<td class='col-1'>" + result.EVENT_DATE + "</td>";
            compContent += "<td class='col-2'>" + result.EVENT + "</td>";
            compContent += "<td class='col-1'>" + result.RESULT + " <span class='units'>" + result.RESULT_UNITS + "</span></td>";
            compContent += "</tr>";
        }

        // compContent += "<tr class='rowPopup'>";
        // if (result.EVENT_CD == 103759086.0) {
        // var pdBalance = result.RESULT;
        // var pdBalanceUnits = result.RESULT_UNITS;
        // var pdBalanceDateTime = result.EVENT_DATE;
        // }

        // if (result.EVENT_CD == 103759009.0) {
        // var pdIntake = result.RESULT;
        // var pdIntakeUnits = result.RESULT_UNITS;
        // var pdIntakeDateTime = result.EVENT_DATE;
        // }

        // if (result.EVENT_CD == 103759028.0) {
        // var pdOutput = result.RESULT;
        // var pdOutputUnits = result.RESULT_UNITS;
        // var pdOutputDateTime = result.EVENT_DATE;
        // }
        // }
        // compContent += "<tr class='rowPopup' tip=\""
        // + "<ul>"
        // + "<li><strong>PD (Retained) Intake Date/Time:</strong> " + pdIntakeDateTime + "</li>"
        // + "<li><strong>PD (Pulled Off) Output:</strong> " + pdOutputDateTime + "</li>"
        // + "<li><strong>PD 24hr Net Balance:</strong> " + pdBalanceDateTime + "</li>"
        // + "</ul>"
        // + "\">";
        // compContent += "<td class='col-1'>" + pdIntake + " <span class='units'>" + pdIntakeUnits + "</span></td>";
        // compContent += "<td class='col-2'>" + pdOutput + " <span class='units'>" + pdOutputUnits + "</span></td>";
        // compContent += "<td class='col-3'>" + pdBalance + " <span class='units'>" + pdBalanceUnits + "</span></td>";
        // compContent += "</tr>";
        compContent += "</table>";
    } else {
        compContent = "<p>No dialysis results found</p>";
    }
    compContent += "</div>";
    chla.eAppsUtil.Logger.LogWarn("<textarea>" + compContent + "</textarea>");
    target.innerHTML = compContent;
    //reInitPopUps();

    // Initialize hovers to display additional  detail
    function reInitPopUps() {
        // add the class of hover to all elements with the class of rowPopup
        $(".rowPopup").hover(
            function (event) {
                if (this.tip > " ") {
                    // e = window.event;
                    $('<div id="tooltip">' + this.tip + '</div>').css({
                        position: 'absolute',
                        width: '250px',
                        top: event.pageY + 20,
                        left: event.pageX + 10,
                        border: '1px solid #BDBDBD',
                        padding: '10px 10px 10px 10px',
                        'background-color': '#FFFCE1',
                        opacity: 1.00
                    }).appendTo("body").fadeIn(0);
                }
            },
            function () {
                $("#tooltip").remove();
            }
        )
    };

};

//Lines/tubes/drains Results
chla.linestubesdrains = function () { };
chla.linestubesdrains.prototype = new MPage.Component();
chla.linestubesdrains.prototype.constructor = MPage.Component;
chla.linestubesdrains.prototype.base = MPage.Component.prototype;
chla.linestubesdrains.prototype.name = "chla.linestubesdrains";
chla.linestubesdrains.prototype.cclProgram = "chla_ca_mp_cc_ltd_json";
chla.linestubesdrains.prototype.cclParams = [];
chla.linestubesdrains.prototype.cclDataType = "JSON";
chla.linestubesdrains.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("encounterId");
};

chla.linestubesdrains.prototype.render = function () {

    var component = this;
    var elementObj;
    var recordCount;
    var linesCount = component.data.RPTDATA.LINES_CNT;
    var tubesCount = component.data.RPTDATA.TUBES_CNT;
    var subHeaderDisplay = recordCount;
    var target = this.getTarget();
    var compContent;
    var hoverContent;

    this.setProperty("headerSubTitle", subHeaderDisplay);

    elementObj = component.data.RPTDATA;
    compContent = "<div id='linestubesdrains'>";
    var tempStr = '<a href="javascript:APPLINK(' +
        '0,&quot;Powerchart.exe&quot;,&quot;' +
        ' /PERSONID=' +  elementObj.PERSON_ID +
        ' /ENCNTRID=' +  elementObj.ENCNTR_ID +
        ' /FIRSTTAB=^IView^&quot;)">Refer to iView</a><br/>'

    compContent += tempStr;

    /*if ((elementObj.DRAIN1TYPESIZE !== "") ||
     (elementObj.DRAIN2TYPESIZE !== "") ||
     (elementObj.DRAIN3TYPESIZE !== "") ||
     (elementObj.DRAIN4TYPESIZE !== "") ||
     (elementObj.OSTOMY1TYPELOCATION !== "") ||
     (elementObj.OSTOMY2TYPELOCATION !== "") ||
     (elementObj.OSTOMY3TYPELOCATION !== "") ||
     (elementObj.GITUBE1TYPESIZE !== "") ||
     (elementObj.GITUBE2TYPESIZE !== "") ||
     (elementObj.GITUBE3TYPESIZE !== "") ||
     (elementObj.GITUBE4TYPESIZE !== "") ||
     (elementObj.GUTUBE1TYPESIZE !== "") ||
     (elementObj.GUTUBE2TYPESIZE !== "") ||
     (elementObj.GUTUBE3TYPESIZE !== "") ||
     (elementObj.GUTUBE4TYPESIZE !== "") ||
     (elementObj.TRACHTUBETYPE !== "") ||
     (elementObj.CHESTTUBE1LOCATIONSIZE !== "") ||
     (elementObj.CHESTTUBE2LOCATIONSIZE !== "") ||
     (elementObj.CHESTTUBE3LOCATIONSIZE !== "") ||
     (elementObj.CHESTTUBE4LOCATIONSIZE !== "") ||
     (elementObj.CHESTTUBE5LOCATIONSIZE !== "") ||
     (elementObj.CVC_CNT > 0)) {
     var l, lines, t, tubes;

     compContent += "<table class='header'><tr><th class='col-1'>Date</th><th class='col-2'>Event</th></tr></table>";
     compContent += "<div class='sectionDiv'><h2 class='linestubesdrains_sectionHead'>Medical Devices</h2><div><table>";

     if (elementObj.DRAIN1TYPESIZE !== "") {
     compContent += "<tr class='rowPopup'>";
     compContent += "<td class='col-1'>" + chla.eApps.gFuncs.convertDate(elementObj.DRAIN1_DT_TM) + "</td>";
     compContent += "<td class='col-2'>Drain #1: " + elementObj.DRAIN1TYPESIZE + " " + elementObj.DRAIN1LOCATION + "</td>";
     compContent += "</tr>";
     }

     if (elementObj.DRAIN2TYPESIZE !== "") {
     compContent += "<tr class='rowPopup'>";
     compContent += "<td class='col-1'>" + chla.eApps.gFuncs.convertDate(elementObj.DRAIN2_DT_TM) + "</td>";
     compContent += "<td class='col-2'>Drain #2: " + elementObj.DRAIN2TYPESIZE + " " + elementObj.DRAIN2LOCATION + "</td>";
     compContent += "</tr>";
     }

     if (elementObj.DRAIN3TYPESIZE !== "") {
     compContent += "<tr class='rowPopup'>";
     compContent += "<td class='col-1'>" + chla.eApps.gFuncs.convertDate(elementObj.DRAIN3_DT_TM) + "</td>";
     compContent += "<td class='col-2'>Drain #3: " + elementObj.DRAIN3TYPESIZE + " " + elementObj.DRAIN3LOCATION + "</td>";
     compContent += "</tr>";
     }

     if (elementObj.DRAIN4TYPESIZE !== "") {
     compContent += "<tr class='rowPopup'>";
     compContent += "<td class='col-1'>" + chla.eApps.gFuncs.convertDate(elementObj.DRAIN4_DT_TM) + "</td>";
     compContent += "<td class='col-2'>Drain #4: " + elementObj.DRAIN4TYPESIZE + " " + elementObj.DRAIN4LOCATION + "</td>";
     compContent += "</tr>";
     }

     if (elementObj.OSTOMY1TYPELOCATION !== "") {
     compContent += "<tr class='rowPopup'>";
     compContent += "<td class='col-1'>" + chla.eApps.gFuncs.convertDate(elementObj.OSTOMY1_DT_TM) + "</td>";
     compContent += "<td class='col-2'>Ostomy #1: " + elementObj.OSTOMY1TYPELOCATION + "</td>";
     compContent += "</tr>";
     }

     if (elementObj.OSTOMY2TYPELOCATION !== "") {
     compContent += "<tr class='rowPopup'>";
     compContent += "<td class='col-1'>" + chla.eApps.gFuncs.convertDate(elementObj.OSTOMY2_DT_TM) + "</td>";
     compContent += "<td class='col-2'>Ostomy #2: " + elementObj.OSTOMY2TYPELOCATION + "</td>";
     compContent += "</tr>";
     }

     if (elementObj.OSTOMY3TYPELOCATION !== "") {
     compContent += "<tr class='rowPopup'>";
     compContent += "<td class='col-1'>" + chla.eApps.gFuncs.convertDate(elementObj.OSTOMY3_DT_TM) + "</td>";
     compContent += "<td class='col-2'>Ostomy #3: " + elementObj.OSTOMY3TYPELOCATION + "</td>";
     compContent += "</tr>";
     }

     if (elementObj.GITUBE1TYPESIZE !== "") {
     compContent += "<tr class='rowPopup'>";
     compContent += "<td class='col-1'>" + chla.eApps.gFuncs.convertDate(elementObj.GITUBE1_DT_TM) + "</td>";
     compContent += "<td class='col-2'>GI Tube #1: " + elementObj.GITUBE1TYPESIZE + " " + elementObj.GITUBE1LOCATION + "</td>";
     compContent += "</tr>";
     }

     if (elementObj.GITUBE2TYPESIZE !== "") {
     compContent += "<tr class='rowPopup'>";
     compContent += "<td class='col-1'>" + chla.eApps.gFuncs.convertDate(elementObj.GITUBE2_DT_TM) + "</td>";
     compContent += "<td class='col-2'>GI Tube #2: " + elementObj.GITUBE2TYPESIZE + " " + elementObj.GITUBE2LOCATION + "</td>";
     compContent += "</tr>";
     }

     if (elementObj.GITUBE3TYPESIZE !== "") {
     compContent += "<tr class='rowPopup'>";
     compContent += "<td class='col-1'>" + chla.eApps.gFuncs.convertDate(elementObj.GITUBE3_DT_TM) + "</td>";
     compContent += "<td class='col-2'>GI Tube #3: " + elementObj.GITUBE3TYPESIZE + " " + elementObj.GITUBE3LOCATION + "</td>";
     compContent += "</tr>";
     }

     if (elementObj.GITUBE4TYPESIZE !== "") {
     compContent += "<tr class='rowPopup'>";
     compContent += "<td class='col-1'>" + chla.eApps.gFuncs.convertDate(elementObj.GITUBE4_DT_TM) + "</td>";
     compContent += "<td class='col-2'>GI Tube #4: " + elementObj.GITUBE4TYPESIZE + " " + elementObj.GITUBE4LOCATION + "</td>";
     compContent += "</tr>";
     }

     if (elementObj.GUTUBE1TYPESIZE !== "") {
     compContent += "<tr class='rowPopup'>";
     compContent += "<td class='col-1'>" + chla.eApps.gFuncs.convertDate(elementObj.GUTUBE1_DT_TM) + "</td>";
     compContent += "<td class='col-2'>GU Tube #1: " + elementObj.GUTUBE1TYPESIZE + " " + elementObj.GUTUBE1LOCATION + "</td>";
     compContent += "</tr>";
     }

     if (elementObj.GUTUBE2TYPESIZE !== "") {
     compContent += "<tr class='rowPopup'>";
     compContent += "<td class='col-1'>" + chla.eApps.gFuncs.convertDate(elementObj.GUTUBE2_DT_TM) + "</td>";
     compContent += "<td class='col-2'>GU Tube #2: " + elementObj.GUTUBE2TYPESIZE + " " + elementObj.GUTUBE2LOCATION + "</td>";
     compContent += "</tr>";
     }

     if (elementObj.GUTUBE3TYPESIZE !== "") {
     compContent += "<tr class='rowPopup'>";
     compContent += "<td class='col-1'>" + chla.eApps.gFuncs.convertDate(elementObj.GUTUBE3_DT_TM) + "</td>";
     compContent += "<td class='col-2'>GU Tube #3: " + elementObj.GUTUBE3TYPESIZE + " " + elementObj.GUTUBE3LOCATION + "</td>";
     compContent += "</tr>";
     }

     if (elementObj.GUTUBE4TYPESIZE !== "") {
     compContent += "<tr class='rowPopup'>";
     compContent += "<td class='col-1'>" + chla.eApps.gFuncs.convertDate(elementObj.GUTUBE4_DT_TM) + "</td>";
     compContent += "<td class='col-2'>GU Tube #4: " + elementObj.GUTUBE4TYPESIZE + " " + elementObj.GUTUBE4LOCATION + "</td>";
     compContent += "</tr>";
     }

     if (elementObj.TRACHTUBETYPE !== "") {
     compContent += "<tr class='rowPopup'>";
     compContent += "<td class='col-1'>" + chla.eApps.gFuncs.convertDate(elementObj.TRACHTUBE_DT_TM) + "</td>";
     compContent += "<td class='col-2'>Trach Tube: " + elementObj.TRACHTUBETYPE + " " + elementObj.TRACHTUBESIZE + "</td>";
     compContent += "</tr>";
     }

     if (elementObj.CHESTTUBE1LOCATIONSIZE !== "") {
     compContent += "<tr class='rowPopup'>";
     compContent += "<td class='col-1'>" + chla.eApps.gFuncs.convertDate(elementObj.CHESTTUBE1_DT_TM) + "</td>";
     compContent += "<td class='col-2'>Chest Tube #1: " + elementObj.CHESTTUBE1LOCATIONSIZE + "</td>";
     compContent += "</tr>";
     }

     if (elementObj.CHESTTUBE2LOCATIONSIZE !== "") {
     compContent += "<tr class='rowPopup'>";
     compContent += "<td class='col-1'>" + chla.eApps.gFuncs.convertDate(elementObj.CHESTTUBE2_DT_TM) + "</td>";
     compContent += "<td class='col-2'>Chest Tube #2: " + elementObj.CHESTTUBE2LOCATIONSIZE + "</td>";
     compContent += "</tr>";
     }

     if (elementObj.CHESTTUBE3LOCATIONSIZE !== "") {
     compContent += "<tr class='rowPopup'>";
     compContent += "<td class='col-1'>" + chla.eApps.gFuncs.convertDate(elementObj.CHESTTUBE3_DT_TM) + "</td>";
     compContent += "<td class='col-2'>Chest Tube #3: " + elementObj.CHESTTUBE3LOCATIONSIZE + "</td>";
     compContent += "</tr>";
     }

     if (elementObj.CHESTTUBE4LOCATIONSIZE !== "") {
     compContent += "<tr class='rowPopup'>";
     compContent += "<td class='col-1'>" + chla.eApps.gFuncs.convertDate(elementObj.CHESTTUBE4_DT_TM) + "</td>";
     compContent += "<td class='col-2'>Chest Tube #4: " + elementObj.CHESTTUBE4LOCATIONSIZE + "</td>";
     compContent += "</tr>";
     }

     if (elementObj.CHESTTUBE5LOCATIONSIZE !== "") {
     compContent += "<tr class='rowPopup'>";
     compContent += "<td class='col-1'>" + chla.eApps.gFuncs.convertDate(elementObj.CHESTTUBE5_DT_TM) + "</td>";
     compContent += "<td class='col-2'>Chest Tube #5: " + elementObj.CHESTTUBE5LOCATIONSIZE + "</td>";
     compContent += "</tr>";
     }

     compContent += "</table></div></div>";

     if (elementObj.CVC_CNT > 0) {
     compContent += "<div class='sectionDiv'><h2 class='linestubesdrains_sectionHead'>Catheter Days&nbsp;&nbsp;<span class='units'>CVC total line days this encounter: " + parseFloat((elementObj.TOTAL_LINE_DAYS).toFixed(1)) + "</span></h2><div><table>";

     var c;
     var lineCnt = 0;

     for (c = 0; c < elementObj.CVC.length; c++) {
     var cvc = elementObj.CVC[c];
     if (chla.eApps.gFuncs.(cvc.REMOVAL_DT_TM) == "--") {

     compContent += "<tr class='rowPopup' tip=\""
     + "<ul>"
     + "<li><strong>Type:</strong> " + cvc.TYPE + "</li>"
     + "<li><strong>Size:</strong> " + cvc.SIZE + "</li>"
     + "<li><strong>Site:</strong> " + cvc.SITE + "</li>"
     + "<li><strong>Date/Time:</strong> " + chla.eApps.gFuncs.(cvc.EVENT_END_DT_TM) + "</li>"
     + "<li><strong>Last Date/Time:</strong> " + chla.eApps.gFuncs.convertDate(cvc.LAST_EVENT_DT_TM) + "</li>"
     //+ "<li><strong>Removal Date/Time:</strong> " + chla.eApps.gFuncs.convertDate(cvc.REMOVAL_DT_TM) + "</li>"
     + "</ul>"
     + "\">";
     compContent += "<td class='col-1'>CVC Type #" + cvc.NUMBER + " " + cvc.TYPE + "</td>";
     compContent += "<td class='col-2'>" + parseFloat((cvc.LINE_DAYS).toFixed(1)) + " <span class='units'>days</span></td>";
     compContent += "</tr>";
     } else lineCnt++;

     }
     if (elementObj.CVC_CNT == lineCnt) compContent += "<tr><td>No line(s) currently inserted</td></tr>";


     compContent += "</table></div></div>";
     }
     } else {
     compContent = "<p>No lines or tubes found</p>";
     } */
    compContent += "</div>";
    chla.eAppsUtil.Logger.LogWarn("<textarea>" + compContent + "</textarea>");
    target.innerHTML = compContent;
    reInitPopUps();

    //Function to expand/contract sections
    $('.linestubesdrains_sectionHead').click(function () {
        $(this).toggleClass('linestubesdrains_expanded');
        $(this).next().toggle();
        return false;
    }).next().hide();

    //Initialize hovers to display additional  detail
    function reInitPopUps() {
        //add the class of hover to all elements with the class of rowPopup
        $(".rowPopup").hover(
            function (event) {
                if (this.tip > " ") {
                    //e = window.event;
                    $('<div id="tooltip">' + this.tip + '</div>').css({
                        position: 'absolute',
                        width: '250px',
                        top: event.pageY + 20,
                        left: event.pageX + 10,
                        border: '1px solid #BDBDBD',
                        padding: '10px 10px 10px 10px',
                        'background-color': '#FFFCE1',
                        opacity: 1.00
                    }).appendTo("body").fadeIn(0);
                }
            },
            function () {
                $("#tooltip").remove();
            }
        )
    };

};
//Neuro
chla.neuro = function () { };
chla.neuro.prototype = new MPage.Component();
chla.neuro.prototype.constructor = MPage.Component;
chla.neuro.prototype.base = MPage.Component.prototype;
chla.neuro.prototype.name = "chla.neuro";
chla.neuro.prototype.cclProgram = "chla_ca_mp_cc_neuro_json";
chla.neuro.prototype.cclParams = [];
chla.neuro.prototype.cclDataType = "JSON";
chla.neuro.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("encounterId");
};

chla.neuro.prototype.render = function () {
    var component = this,
        elementObj,
        target = this.getTarget(),
        compContent;

    var recordCount,
        subHeaderDisplay,
        hoverContent;

    var gFuncs,
        oddEvenFlag,
        ventilator = {
            initOnly: false,
            cc_id: 'x',
            personId: 0,
            encounterId: 0,
            prsnlId: 0,
            transparentSpacer: '',
            CC_SectionManagement: {
                sectionlist: []
            }
        }

    component.eApps = {
        cc_id: component.name.replace('.', '_'),
        CSSBehaviors: chla.eApps.gCSSBehavior.neo(),
        TestSAP: null
    };

    gFuncs = chlaNsMgr.aliasDirector('chla.eApps.gFuncs');
    compContent = '<div id="' + component.eApps.cc_id + '">';


    elementObj = component.data.RPTDATA;
    subHeaderDisplay = recordCount

    this.setProperty("headerSubTitle", subHeaderDisplay);


    if (elementObj.WAT_RESULT_CNT !== "" || elementObj.NPASS_RESULT_CNT !== "") {
        var r, results, d, details;
        compContent += "<table class='header'><tr><th class='col-1'>Event</th><th class='col-2'>Result</th></tr></table>";

        compContent += "<div class='sectionDiv'><h2 class='neuro_sectionHead'";
        compContent += (elementObj.NPASS_RESULT_CNT  == 0?  ' style="color: grey; background-image: none;"' : "");
        compContent += ">N-PASS (" + elementObj.NPASS_RESULT_CNT + ")</h2><div><table>";
        oddEvenFlag = 0;
        for (r = 0; r < elementObj.NPASS_RESULTS.length; r++) {
            var result = elementObj.NPASS_RESULTS[r];

            compContent += '<tr class="rowPopup ';
            compContent += (oddEvenFlag == 1? ' odd" ': '"');
            oddEvenFlag = (oddEvenFlag == 1?0:1);
            compContent += " tip=\"" ;

            for (d = 0; d < result.NPASS_DETAILS.length; d++) {
                var detail = result.NPASS_DETAILS[d];

                compContent += "<ul>";
                compContent += '<li><span style=&quot;font-weight:800;&quot;>' + detail.EVENT + ":</span> " + detail.RESULT + "</li>";
                compContent += "</ul>";

            }
            compContent += "\">";

            compContent += "<td class='col-1'>" + result.NPASS_EVENT_DATE + "</td>";

            for (d = 0; d < result.NPASS_DETAILS.length; d++) {
                var detail = result.NPASS_DETAILS[d];
                if (detail.EVENT_CD == 731042) {
                       compContent += "<td class='col-2'>" + detail.EVENT + ": " + detail.RESULT + "</td>";
                }
             }
            compContent += "</tr>";
        }
        compContent += "</table></div></div>";
        compContent += "<div class='sectionDiv'><h2 class='neuro_sectionHead'";
        compContent += (elementObj.NPASS_RESULT_CNT  == 0?  ' style="color: grey; background-image: none;"' : "");
        compContent += ">WAT1 (" + elementObj.WAT_RESULT_CNT + ")</h2><div><table>";

        for (r = 0; r < elementObj.WAT_RESULTS.length; r++) {
            var result = elementObj.WAT_RESULTS[r];

            compContent += '<tr class="rowPopup ';
            compContent += (oddEvenFlag == 1? ' odd" ': '"');
            oddEvenFlag = (oddEvenFlag == 1?0:1);
            compContent += " tip=\"" ;

            for (d = 0; d < result.WAT_DETAILS.length; d++) {
                var detail = result.WAT_DETAILS[d];
                compContent += "<ul>";
                compContent += "<li><span style=&quot;font-weight:800;&quot;>" + detail.EVENT + ": </span>" + detail.RESULT + "</li>";
                compContent += "</ul>";
            }
            compContent += "\">";

            compContent += "<td class='col-1'>" + result.WAT_EVENT_DATE + "</td>";

            for (d = 0; d < result.WAT_DETAILS.length; d++) {
                var detail = result.WAT_DETAILS[d];
                if (detail.EVENT_CD == 238653977) {
                    compContent += "<td class='col-2'>" + detail.EVENT + ": " + detail.RESULT + "</td>";
                }
            }
            compContent += "</tr>";
        }
        compContent += "</table></div></div>";
    } else {
        compContent = "<p>No neuro results found</p>";
    }
    compContent += "</div>";
    gFuncs.Log_CC( component, compContent);
    target.innerHTML = compContent;

    component.eApps.CSSBehaviors.InitPopUpsZstripe('div#' + component.eApps.cc_id + ' .rowPopup');
    //Function to expand/contract sections
    $('.neuro_sectionHead').click(function () {
        $(this).toggleClass('neuro_expanded');
        $(this).next().toggle();
        return false;
    }).next().hide();

};

//Apnea/Brady/Desats Results
chla.apneabradydesats = function () { };
chla.apneabradydesats.prototype = new MPage.Component();
chla.apneabradydesats.prototype.constructor = MPage.Component;
chla.apneabradydesats.prototype.base = MPage.Component.prototype;
chla.apneabradydesats.prototype.name = "chla.apneabradydesats";
chla.apneabradydesats.prototype.cclProgram = "chla_ca_mp_cc_abd_json2";
chla.apneabradydesats.prototype.cclParams = [];
chla.apneabradydesats.prototype.cclDataType = "JSON";
chla.apneabradydesats.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("encounterId");
};

chla.apneabradydesats.prototype.render = function () {
    var component = this,
        elementObj,
        target = this.getTarget(),
        compContent;
    var apneaRecordCount,
        bradyRecordCount,
        desatRecordCount,
        totalRecords,
        recordCount,
        subHeaderDisplay,
        r,
        results,
        result,
        wrkArr = [];
    var gFuncs,
        oddEvenFlag,
        apneabradydesats = {
            initOnly: false,
            cc_id: 'x',
            personId: 0,
            encounterId: 0,
            prsnlId: 0,
            transparentSpacer: '',
            CC_SectionManagement: {
                sectionlist: []
            }
        };
    component.eApps = {
        cc_id: component.name.replace('.', '_'),
        CSSBehaviors: chla.eApps.gCSSBehavior.neo(),
        TestSAP: null
    };
    gFuncs = chlaNsMgr.aliasDirector('chla.eApps.gFuncs');
    compContent = '<div id="' + component.eApps.cc_id + '">';
    elementObj = component.data.RPTDATA;
    apneaRecordCount = elementObj.APNEA_RESULT_CNT;
    bradyRecordCount = elementObj.BRADY_RESULT_CNT;
    desatRecordCount = elementObj.DESAT_RESULT_CNT;
    totalRecords = apneaRecordCount + bradyRecordCount + desatRecordCount;
    recordCount = "(" + totalRecords + ")";
    subHeaderDisplay = recordCount;
    this.setProperty("headerSubTitle", subHeaderDisplay);
    if (totalRecords > 0) {
        compContent += "<table class='header'><tr><th class='col-1'>Date</th><th class='col-2'>Event</th><th class='col-3'>Result</th></tr></table>";
        oddEvenFlag = 0;
        //Apnea
        //compContent += '<div class="sectionDiv">' +
        // '<h2 class='abd_sectionHead' id = 'apneaHead'>Apnea (" +
        //elementObj.APNEA_RESULT_CNT +
        //")</h2><div><table>";
        wrkArr.length= 0;
        wrkArr.push('<div class="sectionDiv"><h2 class="abd_sectionHead"  id ="apneaHead"');
        wrkArr.push((elementObj.APNEA_RESULT_CNT == 0 ? ' style="color: grey; background-image: none;"' : ''));
        wrkArr.push('>Apnea (');
        wrkArr.push(elementObj.APNEA_RESULT_CNT);
        wrkArr.push(')</h2><div><table>');
        compContent += wrkArr.join('');
        for (r = 0; r < elementObj.APNEA_RESULTS.length; r++) {
            result = elementObj.APNEA_RESULTS[r];
            compContent += '<tr class="rowPopup ';
            compContent += (oddEvenFlag == 1 ? ' odd" ' : '"');
            oddEvenFlag = (oddEvenFlag == 1 ? 0 : 1);
            compContent += " tip=\""
                + "<ul><li><span style=&quot;font-weight:800;&quot;>Apnea event:</span> RR < 20</li></ul>"
                + "\">";
            compContent += "<td class='col-1'>" + result.EVENT_DATE + "</td>";
            compContent += "<td class='col-2'>" + result.EVENT + "</td>";
            compContent += "<td class='col-3'>" + result.RESULT + " <span class='eapps-unitsHO'>" + result.RESULT_UNITS + "</span></td>";
            compContent += "</tr>";
        }
        compContent += "</table></div></div>";
        oddEvenFlag = 0;
        //Brady
        //compContent += "<div class='sectionDiv'><h2 class='abd_sectionHead' id = 'bradyHead'>Bradycardia (" +
        //elementObj.BRADY_RESULT_CNT +
        //")</h2><div><table>";
        wrkArr.length= 0;
        wrkArr.push('<div class="sectionDiv"><h2 class="abd_sectionHead"  id ="bradyHead"');
        wrkArr.push((elementObj.BRADY_RESULT_CNT == 0 ? ' style="color: grey; background-image: none;"' : ''));
        wrkArr.push('>Bradycardia (');
        wrkArr.push(elementObj.BRADY_RESULT_CNT);
        wrkArr.push(')</h2><div><table>');
        compContent += wrkArr.join('');

        for (r = 0; r < elementObj.BRADY_RESULTS.length; r++) {
            result = elementObj.BRADY_RESULTS[r];
            compContent += '<tr class="rowPopup ';
            compContent += (oddEvenFlag == 1 ? ' odd" ' : '"');
            oddEvenFlag = (oddEvenFlag == 1 ? 0 : 1);
            compContent += " tip=\""
                + "<ul><li><span style=&quot;font-weight:800;&quot;>Bradycardia event:</span> HR < 90</li></ul>"
                + "\">";
            compContent += "<td class='col-1'>" + result.EVENT_DATE + "</td>";
            compContent += "<td class='col-2'>" + result.EVENT + "</td>";
            compContent += "<td class='col-3'>" + result.RESULT + " <span class='eapps-unitsHO'>" + result.RESULT_UNITS + "</span></td>";
            compContent += "</tr>";
        }
        compContent += "</table></div></div>";
        oddEvenFlag = 0;
        //Desat
        //compContent += "<div class='sectionDiv'><h2 class='abd_sectionHead' id = 'desatHead'>Desaturation (" +
        //elementObj.DESAT_RESULT_CNT +
        //")</h2><div><table>";
        wrkArr.length= 0;
        wrkArr.push('<div class="sectionDiv"><h2 class="abd_sectionHead"  id ="desatHead"');
        wrkArr.push((elementObj.DESAT_RESULT_CNT == 0 ? ' style="color: grey; background-image: none;"' : ''));
        wrkArr.push('>Desaturation (');
        wrkArr.push(elementObj.DESAT_RESULT_CNT);
        wrkArr.push(')</h2><div><table>');
        compContent += wrkArr.join('');
        for (r = 0; r < elementObj.DESAT_RESULTS.length; r++) {
            result = elementObj.DESAT_RESULTS[r];
            compContent += '<tr class="rowPopup ';
            compContent += (oddEvenFlag == 1 ? ' odd" ' : '"');
            oddEvenFlag = (oddEvenFlag == 1 ? 0 : 1);
            compContent += " tip=\""
                + "<ul><li><span style=&quot;font-weight:800;&quot;>Detsat event:</span> Pulse Oximetry < 70</li></ul>"
                + "\">";
            compContent += "<td class='col-1'>" + result.EVENT_DATE + "</td>";
            compContent += "<td class='col-2'>" + result.EVENT + "</td>";
            compContent += "<td class='col-3'>" + result.RESULT + " <span class='eapps-unitsHO'>" + result.RESULT_UNITS + "</span></td>";
            compContent += "</tr>";
        }
        compContent += "</table></div></div>";
    } else {
        compContent = "<p>No apnea results found</p>";
    }
    compContent += "</div>";
    gFuncs.Log_CC(component, compContent);
    target.innerHTML = compContent;
    component.eApps.CSSBehaviors.InitPopUpsZstripe('div#' + component.eApps.cc_id + ' .rowPopup');
    //Function to expand/contract future/completed sections
    $('.abd_sectionHead').click(function () {
        $(this).toggleClass('abd_expanded');
        $(this).next().toggle();
        return false;
    }).next().hide();
};

//Environment Results
chla.environment = function () { };
chla.environment.prototype = new MPage.Component();
chla.environment.prototype.constructor = MPage.Component;
chla.environment.prototype.base = MPage.Component.prototype;
chla.environment.prototype.name = "chla.environment";
chla.environment.prototype.cclProgram = "chla_ca_mp_cc_environment_json";
chla.environment.prototype.cclParams = [];
chla.environment.prototype.cclDataType = "JSON";
chla.environment.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("encounterId");
};

chla.environment.prototype.render = function () {

    var component = this,
        elementObj,
        target = this.getTarget(),
        compContent,
        hoverContent;

    var recordCount,
        subHeaderDisplay;

    var r, d, results,
        ambientTemp,
        humidity,
        result,
        detail,
        oddEvenFlag;

    var gFuncs,
        environment = {
            initOnly: false,
            cc_id: 'x',
            personId: 0,
            encounterId: 0,
            prsnlId: 0,
            transparentSpacer: '',
            CC_SectionManagement: {
                sectionlist: []
            }
        }

    component.eApps = {
        cc_id: component.name.replace('.', '_'),
        CSSBehaviors: chla.eApps.gCSSBehavior.neo(),
        TestSAP: null
    };
    gFuncs = chlaNsMgr.aliasDirector('chla.eApps.gFuncs');
    compContent = '<div id="' + component.eApps.cc_id + '">';

    elementObj = component.data.RPTDATA;
    recordCount = "(" + elementObj.RESULT_CNT + ")";
    subHeaderDisplay = recordCount;

    this.setProperty("headerSubTitle", subHeaderDisplay);

    ambientTemp = "<td class='col-2'>--</td>";
    humidity = "<td class='col-3'>--</td>";
    oddEvenFlag
    if (elementObj.RESULT_CNT > 0) {
        compContent += "<table class='header'><tr><th class='col-1'>Date</th><th class='col-2'>Isolette<br/>Ambient Temp</th><th class='col-3'>Isolette<br/>Humidity</th></tr>";
        for (r = 0; r < elementObj.RESULTS.length; r++) {
            result = elementObj.RESULTS[r];
            compContent += "<tr";
            compContent += (oddEvenFlag == 1? " class='odd' >": ">");
            oddEvenFlag = (oddEvenFlag == 1?0:1);

            compContent += "<td class='col-1'>" + result.EVENT_DATE + "</td>";
            for (d = 0; d < result.DETAILS.length; d++) {
                detail = result.DETAILS[d];
                if (detail.EVENT_CD == 98983498) {
                    ambientTemp = "<td class='col-2' >" + detail.RESULT + " <span class = 'eapps-unitsHO'>" + detail.RESULT_UNITS + "</span></td>";
                } else if (detail.EVENT_CD == 98980876) {
                    humidity = "<td class='col-3'>" + detail.RESULT + " <span class = 'eapps-unitsHO'>" + detail.RESULT_UNITS + "</span></td>";
                }
            }
            compContent += ambientTemp + humidity;
            compContent += "</tr>";
        }
        compContent += "</table>";
    } else {
        compContent = "<p>No environment results found</p></div>";
    }
    compContent += "</div>";
    gFuncs.Log_CC( component, compContent);
    target.innerHTML = compContent;

};

//General Overview

function convertDaysToWeeks(days) {
    var weeks;
    var remainderDays;
    var weeksDays;

    weeks = Math.floor(days / 7);
    remainderDays = days % 7;
    weeksDays = weeks + " <span class='units'>weeks</span> ";

    if (remainderDays == 1) {
        weeksDays += remainderDays + " <span class='units'>day</span>";
    } else {
        weeksDays += remainderDays + " <span class='units'>days</span>";
    }

    return weeksDays;
}

chla.overview = function () { };
chla.overview.prototype = new MPage.Component();
chla.overview.prototype.constructor = MPage.Component;
chla.overview.prototype.base = MPage.Component.prototype;
chla.overview.prototype.name = "chla.overview";
chla.overview.prototype.cclProgram = "chla_ca_mp_cc_gen_info_json";
chla.overview.prototype.cclParams = [];
chla.overview.prototype.cclDataType = "JSON";
chla.overview.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("encounterId");
};

chla.overview.prototype.render = function () {

    var component = this,
        elementObj,
        target = this.getTarget(),
        compContent;

    var recordCount,
        subHeaderDisplay,
        hoverContent,
        positionCode,
        encounterId,
        personId;

    var pFormLinkParams,
        anchor,
        r, results, s, seizures,result;

    var gFuncs,
        oddEventFlag,
        overview = {
            initOnly: false,
            cc_id: 'x',
            personId: 0,
            encounterId: 0,
            prsnlId: 0,
            transparentSpacer: '',
            CC_SectionManagement: {
                sectionlist: []
            },
            CC_Tmpls: {
                mainDiv: [
                    '<div id="<#=cc_id#>" class="eapps_CC">',
                    '<#=mainSection#>',
                    '<#=mainSectionEnd#>',
                    '</div>'
                ],
                 rowStart: [
                         '<tr><td style="background: #F6F6F6;">',
                         '<tr><td style="background: #F6F6F6; width:160px;">',
                         '<td style="background: #FFFFFF;">'
                 ]
            }
        };


    component.eApps = {
        cc_id: component.name.replace('.', '_'),
        CSSBehaviors: chla.eApps.gCSSBehavior.neo(),
        TestSAP: null
    };

    gFuncs = chlaNsMgr.aliasDirector('chla.eApps.gFuncs');
    compContent = '<div id="' + component.eApps.cc_id + '">';
    elementObj = component.data.RPTDATA;

    resultCount = (elementObj.RESULT_CNT > 0 ? elementObj.RESULT_CNT : 0 );
    //recordCount = "(" + resultCount + ")";
    //subHeaderDisplay = recordCount;
    positionCode = this.getProperty("positionCd");
    encounterId = this.getProperty("encounterId");
    personId = this.getProperty("personId");

    function convertDaysToWeeks(days) {
        var weeks,
            remainderDays,
            weeksDays,
            dcCriteriaPowerFormLinkParams,
            adodUpdate;

        weeks = Math.floor(days / 7);
        remainderDays = days % 7;
        weeksDays = weeks + " <span class='eapps-unitsHO'>weeks</span> ";

        if (remainderDays == 1) {
            weeksDays += remainderDays + " <span class='eapps-unitsHO'>day</span>";
        } else {
            weeksDays += remainderDays + " <span class='eapps-unitsHO'>days</span>";
        }
        return weeksDays;
    }
//     if (component.data.RPTDATA.RESULT_CNT > 0) {
//         resultCount = component.data.RPTDATA.RESULT_CNT;
//     } else {
//         resultCount = 0;
//     }

    if (elementObj) {
        compContent += "<table>";
        compContent += overview.CC_Tmpls.rowStart[1] +"Name:</td>" + overview.CC_Tmpls.rowStart[2] + elementObj.NAME + "</td></tr>";
        compContent += overview.CC_Tmpls.rowStart[0] +"Age:</td>" + overview.CC_Tmpls.rowStart[2] + elementObj.AGE + "</td></tr>";
        compContent += overview.CC_Tmpls.rowStart[0] +"Day of Life:</td>" + overview.CC_Tmpls.rowStart[2] + elementObj.ACTUAL_AGE_DAYS + "</td></tr>";

        var pFormLinkParams = "\"POWERFORM\",\"" + personId + "|" + encounterId + "|137334386|0|0\"";
        var anchor = "<a href='javascript:MPAGES_EVENT(" + pFormLinkParams + ")'>Gestational Age at Birth:</a>";

        if (elementObj.GESTAGE !== 0) {
            compContent += overview.CC_Tmpls.rowStart[0]  + anchor + "</td>" + overview.CC_Tmpls.rowStart[2] + convertDaysToWeeks(elementObj.GESTAGE) + "</td></tr>";
            compContent += overview.CC_Tmpls.rowStart[0] +"PMA:</td>" + overview.CC_Tmpls.rowStart[2] + convertDaysToWeeks(elementObj.CORRECTEDAGE) + "</td></tr>";
        } else {
            compContent += overview.CC_Tmpls.rowStart[0] + anchor + "</td>" + overview.CC_Tmpls.rowStart[2] + "--</td></tr>";
            compContent += overview.CC_Tmpls.rowStart[0] +"PMA:</td>" + overview.CC_Tmpls.rowStart[2] + "--</td></tr>";
        }

        if (elementObj.AND_CATALOG_DISPLAY !== "") {
            compContent += overview.CC_Tmpls.rowStart[0] +"AND/ACP Order:</td>" + overview.CC_Tmpls.rowStart[2] + elementObj.AND_CATALOG_DISPLAY + "<br/><span class='eapps-unitsHO'>" + elementObj.AND_CLIN_DISPLAY_LINE + "</span><br/><span class='eapps-unitsHO'>" + elementObj.AND_DT_TM + " " + elementObj.AND_STATUS + "</span></td></tr>";
        } else {
            compContent += overview.CC_Tmpls.rowStart[0] +"AND/ACP Order:</td>" + overview.CC_Tmpls.rowStart[2] + "--</td></tr>";
        }

        if (positionCode == 204082235) {
            compContent += overview.CC_Tmpls.rowStart[0] +"Encounter ID:</td>" + overview.CC_Tmpls.rowStart[2] + elementObj.ENCNTR_ID + "</td></tr>";
            compContent += overview.CC_Tmpls.rowStart[0] +"Person ID:</td>" + overview.CC_Tmpls.rowStart[2] + elementObj.PERSON_ID + "</td></tr>";
        }
        compContent += "</table>";
        //dcCriteriaPowerFormLinkParams = '&quot;POWERFORM&quot;,&quot;' + personId + '|' + encounterId + '|421650037|0|0\&quot;';
        //adodUpdate = '<a href="javascript:MPAGES_EVENT(' + dcCriteriaPowerFormLinkParams + ')">Update Anticipated D/C Date and Time</a>';
        //compContent += '<div style="background: #F6F6F6;" >' + adodUpdate + '</div>';

    } else {
        compContent += '<p style="background: #FFFFFF;">No overview results found</p>';
    }

    //Significant Events begin
    compContent += "<div class='sectionDiv'><h2 class='overview_sectionHead'";
    compContent += (elementObj.RESULT_CNT == 0?  'style="color: grey; background-image: none;"' : "");
    compContent += " id='sigEventsHead'>Significant Events (" + resultCount + ")</h2><div>";
    if (elementObj.RESULT_CNT > 0) {
        var r, results, s, seizures;
        oddEvenFlag = 0;
        compContent += "<table class='header'><tr><th class='col-1'>Date</th><th class='col-2'>Event</th></tr></table>";
        compContent += "<table>";
        for (r = 0; r < elementObj.RESULT.length; r++) {
            var result = elementObj.RESULT[r];

            if (result.EVENT_CD == 55025659) {	//seizure
                compContent += "<tr";
                compContent += (oddEvenFlag == 1? " class='odd' >": ">");
                oddEvenFlag = (oddEvenFlag == 1?0:1);
                compContent += "<td class='col-1'>" + result.EVENT_END_DT_TM + "</td>";
                compContent += "<td class='col-2'>" + result.EVENT_CD_DISP + ": " + result.TYPE + "<br />";
                compContent += "Duration: ";
                if (result.DUR_MIN !== "") {
                    compContent += result.DUR_MIN + " <span class='eapps-unitsHO'>min</span>";
                } else {
                    compContent += " 0 <span class='eapps-unitsHO'>min</span>";
                }

                if (result.DUR_SEC !== "") {
                    compContent += " " + result.DUR_SEC + " <span class='eapps-unitsHO'>sec</span>";
                } else {
                    compContent += " 0 <span class='eapps-unitsHO'>sec</span>";
                }

                compContent += "</td></tr>";
            } else if (result.EVENT_CD == 86736189) { //blood product intake
                compContent += "<tr";
                compContent += (oddEvenFlag == 1? " class='odd' >": ">");
                oddEvenFlag = (oddEvenFlag == 1?0:1);
                compContent += "<td class='col-1'>" + result.EVENT_END_DT_TM + "</td>";
                compContent += "<td class='col-2'>" + result.EVENT_TAG + " <span class='eapps-unitsHO'>mL</span> " + result.EVENT_CD_DISP + "</td>";
                compContent += "</tr>";
            } else if (result.EVENT_CD == 671599) { //Respiratory Rate
                compContent += "<tr";
                compContent += (oddEvenFlag == 1? " class='odd' >": ">");
                oddEvenFlag = (oddEvenFlag == 1?0:1);
                compContent += "<td class='col-1'>" + result.EVENT_END_DT_TM + "</td>";
                compContent += "<td class='col-2'>Apnea: " + result.EVENT_CD_DISP + " " + result.RESULT_VAL + " <span class='eapps-unitsHO'>" + result.RESULT_UNITS + " </span> " + "</td>";
                compContent += "</tr>";
            } else if (result.EVENT_CD == 688367) { //Heart Rate
                compContent += "<tr";
                compContent += (oddEvenFlag == 1? " class='odd' >": ">");
                oddEvenFlag = (oddEvenFlag == 1?0:1);
                compContent += "<td class='col-1'>" + result.EVENT_END_DT_TM + "</td>";
                compContent += "<td class='col-2'>Bradycardia: " + result.EVENT_CD_DISP + " " + result.RESULT_VAL + " <span class='eapps-unitsHO'>" + result.RESULT_UNITS + " </span> " + "</td>";
                compContent += "</tr>";
            } else if (result.EVENT_CD == 688374) { //Pulse Ox
                compContent += "<tr";
                compContent += (oddEvenFlag == 1? " class='odd' >": ">");
                oddEvenFlag = (oddEvenFlag == 1?0:1);
                compContent += "<td class='col-1'>" + result.EVENT_END_DT_TM + "</td>";
                compContent += "<td class='col-2'>Desat: " + result.EVENT_CD_DISP + " " + result.RESULT_VAL + " <span class='eapps-unitsHO'>" + result.RESULT_UNITS + " </span> " + "</td>";
                compContent += "</tr>";
            } else {
                compContent += "<tr";
                compContent += (oddEvenFlag == 1? " class='odd' >": ">");
                oddEvenFlag = (oddEvenFlag == 1?0:1);
                compContent += "<td class='col-1'>" + result.EVENT_END_DT_TM + "</td>";
                compContent += "<td class='col-2'>" + result.EVENT_CD_DISP + " " + result.DOSE + " " + result.ROUTE + "</td>";
                compContent += "</tr>";
            }
        }

        compContent += "</table></div></div>";
    } else {
        compContent += "<p>No significant events found</p></div></div>";
    }
    //Significant Events end

    compContent += "</div>";
    chla.eAppsUtil.Logger.LogWarn("<textarea>" + compContent + "</textarea>");
    target.innerHTML = compContent;
    //alert(compContent);

    //Function to expand/contract sections
    $('.overview_sectionHead').click(function () {
        $(this).toggleClass('overview_expanded');
        $(this).next().toggle();
        return false;
    }).next().hide();

   //Open future section by default
    $('#sigEventsHead').click();
};


//Inhaled Treatments
chla.inhaledtreatments = function () { };
chla.inhaledtreatments.prototype = new MPage.Component();
chla.inhaledtreatments.prototype.constructor = MPage.Component;
chla.inhaledtreatments.prototype.base = MPage.Component.prototype;
chla.inhaledtreatments.prototype.name = "chla.inhaledtreatments";
chla.inhaledtreatments.prototype.cclProgram = "chla_ca_mp_cc_inh_med_ord_json";
chla.inhaledtreatments.prototype.cclParams = [];
chla.inhaledtreatments.prototype.cclDataType = "JSON";
chla.inhaledtreatments.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("encounterId");
};

chla.inhaledtreatments.prototype.render = function () {
    var component = this,
        elementObj,
        recordCount,
        subHeaderDisplay,
        target = this.getTarget(),
        compContent,
        hoverContent;

    var gFuncs,
        oddEvenFlag,
        inhaledtreatments = {
            initOnly: false,
            cc_id: 'x',
            personId: 0,
            encounterId: 0,
            prsnlId: 0,
            transparentSpacer: '',
            CC_SectionManagement: {
                sectionlist: []
            }
        }

    component.eApps = {
        cc_id: component.name.replace('.', '_'),
        CSSBehaviors: chla.eApps.gCSSBehavior.neo(),
        TestSAP: null
    };

    gFuncs = chlaNsMgr.aliasDirector('chla.eApps.gFuncs');
    compContent = '<div id="' + component.eApps.cc_id + '">';

    elementObj = component.data.RPTDATA;
    recordCount = "(" + elementObj.ORDER_CNT + ")";
    subHeaderDisplay = recordCount
    this.setProperty("headerSubTitle", subHeaderDisplay);

    if (elementObj.ORDER_CNT > 0) {
        var o, orders;
        oddEvenFlag = 0;
        compContent += "<table class='header'><tr><th class='col-1'>Name</th><th class='col-2'>Dosage</th></tr></table>";
        compContent += "<table>";
        for (o = 0; o < elementObj.ORDERS.length; o++) {
            var order = elementObj.ORDERS[o];
            compContent += '<tr class="rowPopup ';
            compContent += (oddEvenFlag == 1? ' odd" ': '"');
            oddEvenFlag = (oddEvenFlag == 1?0:1);
            compContent += " tip=\""
                + "<ul>"
				+ "<li><span style=&quot;font-weight:800;&quot;>Original Order Date:</span> " + order.ORIG_ORDER_DT_TM + "</li>"
				+ "<li><span style=&quot;font-weight:800;&quot;>Current Start:</span> " + order.CURRENT_START_DT_TM + "</li>"
				+ "<li><span style=&quot;font-weight:800;&quot;>Projected Stop:</span> " + order.PROJECTED_STOP_DT_TM + "</li>"
				+ "<li><span style=&quot;font-weight:800;&quot;>Clinical Display Line:</span> " + order.CLINICAL_DISPLAY_LINE + "</li>"
                + "</ul>"
			+ "\">";
            compContent += "<td class='medName'>" + order.ORDER_MNEMONIC + "</td>";
            compContent += "<td class='medDesc'>" + order.CLINICAL_DISPLAY_LINE + "</td>";
            compContent += "</tr>";
        }
        compContent += "</table>";
    } else {
        compContent = "<p>No orders for inhaled treatments found</p>";
    }
    compContent += "</div>";
    gFuncs.Log_CC( component, compContent);
    target.innerHTML = compContent;
   component.eApps.CSSBehaviors.InitPopUpsZstripe('div#' + component.eApps.cc_id + ' .rowPopup');

};

//Analgesics
chla.analgesics = function () { };
chla.analgesics.prototype = new MPage.Component();
chla.analgesics.prototype.constructor = MPage.Component;
chla.analgesics.prototype.base = MPage.Component.prototype;
chla.analgesics.prototype.name = "chla.analgesics";
chla.analgesics.prototype.cclProgram = "chla_ca_mp_cc_analgesics_json";
chla.analgesics.prototype.cclParams = [];
chla.analgesics.prototype.cclDataType = "JSON";
chla.analgesics.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("encounterId");
};

chla.analgesics.prototype.render = function () {
    var component = this,
        elementObj,
        recordCount,
        subHeaderDisplay,
        target = this.getTarget(),
        compContent,
        o,
        orders,
        order,
        gFuncs,
        oddEvenFlag,
        analgesics = {
            initOnly: false,
            cc_id: 'x',
            personId: 0,
            encounterId: 0,
            prsnlId: 0,
            transparentSpacer: '',
            CC_SectionManagement: {
                sectionlist: []
            }
        };
    component.eApps = {
        cc_id: component.name.replace('.', '_'),
        CSSBehaviors: chla.eApps.gCSSBehavior.neo(),
        TestSAP: null
    };
    gFuncs = chlaNsMgr.aliasDirector('chla.eApps.gFuncs');
    compContent = '<div id="' + component.eApps.cc_id + '">';
    elementObj = component.data.RPTDATA;
    recordCount = "(" + elementObj.ORDER_CNT + ")";
    subHeaderDisplay = recordCount;
    this.setProperty("headerSubTitle", subHeaderDisplay);
    if (elementObj.ORDER_CNT > 0) {
        oddEvenFlag = 0;
        compContent += "<table class='header'><tr><th class='col-1'>Name</th><th class='col-2'>Dosage</th></tr></table>";
        compContent += "<table>";
        for (o = 0; o < elementObj.ORDERS.length; o++) {
            order = elementObj.ORDERS[o];
            compContent += '<tr class="rowPopup ';
            compContent += (oddEvenFlag == 1 ? ' odd" ' : '"');
            oddEvenFlag = (oddEvenFlag == 1 ? 0 : 1);
            compContent += " tip=\""
                + "<ul>"
                + "<li><span style=&quot;font-weight:800;&quot;>Original Order Date:</span> " + order.ORIG_ORDER_DT_TM + "</li>"
                + "<li><span style=&quot;font-weight:800;&quot;>Current Start:</span> " + order.CURRENT_START_DT_TM + "</li>"
                + "<li><span style=&quot;font-weight:800;&quot;>Projected Stop:</span> " + order.PROJECTED_STOP_DT_TM + "</li>"
                + "<li><span style=&quot;font-weight:800;&quot;>Clinical Display Line:</span> " + order.CLINICAL_DISPLAY_LINE + "</li>"
                + "</ul>"
                + "\">";
            compContent += "<td class='medName'>" + order.ORDER_MNEMONIC + "</td>";
            compContent += "<td class='medDesc'>" + order.CLINICAL_DISPLAY_LINE + "</td>";
            compContent += "</tr>";
        }
        compContent += "</table>";
    } else {
        compContent = "<p>No orders for analgesics found</p>";
    }
    compContent += "</div>";
    gFuncs.Log_CC(component, compContent);
    target.innerHTML = compContent;
    component.eApps.CSSBehaviors.InitPopUpsZstripe('div#' + component.eApps.cc_id + ' .rowPopup');
};

//Resource Directory

//::===========================================================================
//:: CC - DC Menu Sections ---------------------------------------
//::===========================================================================
//::===========================================================================
//:: CC - Discharge Instructions
//::---------------------------------------------------------------------------
chla.dc_instructions = function () { };
chla.dc_instructions.prototype = new MPage.Component();
chla.dc_instructions.prototype.constructor = MPage.Component;
chla.dc_instructions.prototype.base = MPage.Component.prototype;
chla.dc_instructions.prototype.name = "chla.dc_instructions";
chla.dc_instructions.prototype.cclProgram = "chla_ca_mp_cc_dc_instr_json";
chla.dc_instructions.prototype.cclParams = [];
chla.dc_instructions.prototype.cclDataType = "JSON";
chla.dc_instructions.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("encounterId");
    this.cclParams[2] = this.getProperty("personId");
};
chla.dc_instructions.prototype.render = function () {
    var component = this;
    var elementObj = component.data.RPTDATA;
    var target = this.getTarget();
    var compContent;

    var SectionObj,
        wrkRPTDATA_cnt,
        wrkRPTDATA,
        wrkRPTDATA_idx,
        wrkValue,
        wrkCriteria,
        wrkCriteriaArray ,
        wrkCriteriaSize,
        wrkPrevOrder,
        wrkResults;
    var listLen, listLen2 , i ;

    var CC_SectionManagement ={};
    CC_SectionManagement.dccriteriaH5Sec        = new  chla.eApps.SectionHeader();
    CC_SectionManagement.dcinstrH5Sec           = new  chla.eApps.SectionHeader();
    CC_SectionManagement.actyorderH6Sec         = new  chla.eApps.SectionHeader();
    CC_SectionManagement.hygorderH6Sec          = new  chla.eApps.SectionHeader();
    CC_SectionManagement.resporderH6Sec         = new  chla.eApps.SectionHeader();
    CC_SectionManagement.othorderH6Sec          = new  chla.eApps.SectionHeader();
    CC_SectionManagement.laborderH6Sec          = new  chla.eApps.SectionHeader();
    CC_SectionManagement.notify_md_orderH6Sec   = new  chla.eApps.SectionHeader();

    var dcinstructions = {
        cc_id: 'x',
        personId: 0,
        encounterId: 0,
        transparentSpacer:'',
        dcCriteriaActivityId: 0,
        dcInstrActivityId: 0,
        antDischargeDt:'(Date not entered)',
        antDischargeTm:'(Time not entered)',
        dcCriteriaPowerFormLinkParams:'&quot;dummy&quot;',
        dcInstrPowerFormLinkParams:'&quot;dummy&quot;',
        default_criteria:'',
        default_instructions:'',
        dccriteriaH5Section: '<p>This is where DC Criteria section will go</p>',
        dcinstrH5Section:'<p>This is where DC Instruction section will go</p>',
        dischargeDiagnosesValue: 'Not entered',
        dcdiagnosesVal:'',
        actyorderH6Section:'',
        hygorderH6Section: '',
        resporderH6Section: '',
        othorderH6Section: '',
        laborderH6Section: '',
        notify_md_orderH6Section: '',

        actyorder_cnt: 0,
        hygorder_cnt: 0,
        resporder_cnt: 0,
        othorder_cnt: 0,
        laborder_cnt: 0,
        notify_md_order_cnt:0
    } ;

    var dcinstructions_Tmpl = [
        '<div id="<#=cc_id#>" class="eapps_CC">',
        '<a href="javascript:MPAGES_EVENT(<#=dcCriteriaPowerFormLinkParams#>)">',
        'Click here to modify Anticipated D/C Date and D/C Criteria</a><br/>',
        '<a href="javascript:MPAGES_EVENT(<#=dcInstrPowerFormLinkParams#>)">',
        'Click here to launch D/C Instructions PowerForm</a><br/>',
        '<table class="header"><tr><td class="col-a">Anticipated D/C Date</td>',
        '<td class="col-b"><#=antDischargeDt#></td></tr>',
        '<tr><td class="col-a">Anticipated D/C Time</td><td class="col-b"><#=antDischargeTm#></td></tr></table>',
        '<#=dccriteriaH5Section#><#=dcinstrH5Section#></div>'
    ]
    var details_Tmpl = {
        transparentSpacer:    '<img src="' + chla.eApps.Vars.transparentSpacer + '" height="5px" width="17px">',
        transparentSpacer1:    '<img src="' + chla.eApps.Vars.transparentSpacer + '" height="5px" width="10px">',
        default_criteria :    '<tr><td><#=transparentSpacer#>No Discharge Criteria Established</td></tr>',
        default_instructions: '<tr><td><#=transparentSpacer#>No Discharge Instructions Established</td></tr>',
        stable_room_air_val:  '<tr><td>Stable on room air for <#=wrkValue#> hours</td></tr>',
        afebrile_val:         '<tr><td>Afebrile for <#=wrkValue#> hours</td></tr>',
        culture_negative_val: '<tr><td>Cultures negative for  <#=wrkValue#> hours</td></tr>',
        services_cleared_val: '<tr><td>Cleared by the following services - <#=wrkValue#></td></tr>',
        discharge_criteria:   '<tr><td class="eapps_TDH6"><#=wrkValue#></td></tr>'
    }
    //------------------------------------------------------------------------------------------------------------------------------
    // <*RPTDATA_Item*> = Discharge Instruction Orders : DC_Order

    var DC_OrderItms = {
        SectionObj: null,
        DC_Order_cnt: 0,
        DC_Order:null,
        DescLbl: '',
        ValueLbl: ''
    }

    var Dc_OrdersProcessing = function (DC_OrderItmsByRef){
        var k ;
        var DC_OrderwrkList,
            DC_OrderwrkValue,
            DC_OrderwrkDesc,
            DC_OrderwrkResults,
            DC_OrderwrkPrevDesc,           // ie Previous DC_Order desc
            DC_RPTDATA;
        var listLenDC_Order;
        var detailLine = [];

        listLenDC_Order = DC_OrderItmsByRef.DC_Order_cnt;
        DC_OrderwrkPrevValue = "";
        DC_OrderwrkResults = '';
        for (k = 0; k < listLenDC_Order; k++) {
            DC_RPTDATA = DC_OrderItmsByRef.DC_Order[k];
            //chla.eAppsUtil.Logger.LogInfo('DC_RPTDATA' + DC_RPTDATA[0]);
            DC_OrderwrkDesc = DC_RPTDATA[DC_OrderItmsByRef.DescLbl];
            //chla.eAppsUtil.Logger.LogInfo('DC_RPTDATA2' + DC_RPTDATA[DC_OrderItmsByRef.DescLb]);
            DC_OrderwrkValue = DC_RPTDATA[DC_OrderItmsByRef.ValueLbl];
            //chla.eAppsUtil.Logger.LogInfo('DC_RPTDATA3' + DC_RPTDATA[DC_OrderItmsByRef.ValueLbl]);
            detailLine.length = 0;
            detailLine.push('');
            detailLine.push('');
            detailLine.push('<span class="detail-line"> ' + DC_OrderwrkValue + '</span>');

            if (DC_OrderwrkDesc != DC_OrderwrkPrevValue) {
                if (DC_OrderwrkPrevValue != "")
                    detailLine[0] = '</td></tr>';
                detailLine[1] = '<tr><td class="eapps_TDH6" >' + dcinstructions.transparentSpacer + DC_OrderwrkDesc + ':';
            } else {
                detailLine[0] = ',' ;
            }
            DC_OrderwrkResults += detailLine.join('');
            DC_OrderwrkPrevValue = DC_OrderwrkDesc;
        }
        DC_OrderItmsByRef.SectionObj.UnformatBodyVal  += (DC_OrderwrkResults == '') ? '': DC_OrderwrkResults;
        DC_OrderItmsByRef.SectionObj.SectionCntVal  += listLenDC_Order ;
    }

//-------------------------------------
    chla.dc_instructions.eApps = {};
    chla.dc_instructions.eApps.cc_id = chla.dc_instructions.prototype.name.replace('.','_');
    chla.dc_instructions.eApps.SaveButtonAction = chla.eApps.SaveButtonBehavior.enable_disable_status_reset;
    chla.dc_instructions.eApps.CSSBehaviors = new chla.eApps.CSSBehaviors();

    for (i = 0; i < elementObj.PFORMS.length; i++) {
        var pformActivityId = elementObj.PFORMS[i].PFORM_ACTIVITY_ID;
        var pformDesc = elementObj.PFORMS[i].PFORM_DESCRIPTION;
        if (pformDesc.indexOf("Discharge Instruction") > -1)
            dcinstructions.dcInstrActivityId = pformActivityId;
        else
            dcinstructions.dcCriteriaActivityId = pformActivityId;
    }

    //dcinstructions.activityId = elementObj.CARE_PROG_ACTIVITY_ID;

    dcinstructions.cc_id = chla.dc_instructions.eApps.cc_id;
    dcinstructions.personId = this.getProperty("personId");
    dcinstructions.encounterId = this.getProperty("encounterId");
    dcinstructions.transparentSpacer =  details_Tmpl.transparentSpacer;

    dcinstructions.default_criteria = chla.eApps.Funcs.parseTemplate(details_Tmpl.default_criteria, dcinstructions);
    dcinstructions.default_instructions = chla.eApps.Funcs.parseTemplate( details_Tmpl.default_instructions, dcinstructions);
    //dcinstructions.dcCriteriaPowerFormLinkParams = '&quot;POWERFORM&quot;,&quot;' +
    //                             dcinstructions.personId  + '|' +
    //                           dcinstructions.encounterId  + '|421650037|'+
    //                         dcinstructions.dcCriteriaActivityId + '|0&quot;';

    dcinstructions.dcCriteriaPowerFormLinkParams = '&quot;POWERFORM&quot;,&quot;' +
        dcinstructions.personId  + '|' +
        dcinstructions.encounterId  + '|421650037|0' +
        '|0&quot;';

    dcinstructions.dcInstrPowerFormLinkParams = '&quot;POWERFORM&quot;,&quot;' +
        dcinstructions.personId  + '|' +
        dcinstructions.encounterId  + '|2462021|'+
        dcinstructions.dcInstrActivityId + '|0&quot;';


//------------------------------------------------------------------------------
    if (elementObj.ANT_DISCHARGE_DATE.length > 0) {
        ;
        dcinstructions.antDischargeDt = elementObj.ANT_DISCHARGE_DATE.substring(6,7)=="0" ?
            elementObj.ANT_DISCHARGE_DATE.substring(7, 8):
            elementObj.ANT_DISCHARGE_DATE.substring(6, 8)
        dcinstructions.antDischargeDt +=  "/" +
            elementObj.ANT_DISCHARGE_DATE.substring(8, 10) + "/" +
            elementObj.ANT_DISCHARGE_DATE.substring(2, 6) ;
    }

    if (elementObj.ANT_DISCHARGE_TIME.length > 0) {
        dcinstructions.antDischargeTm = elementObj.ANT_DISCHARGE_TIME;
    }
    //--------------------------------------------------------------------------
    var stableRoomVal =  elementObj.STABLE_ROOM_AIR_VAL;
    var afebrileVal =  elementObj.AFEBRILE_VAL;
    var cultureVal =  elementObj.CULTURE_NEGATIVE_VAL;
    var clearServicesVal =  elementObj.SERVICES_CLEARED_VAL;

    dcinstructions.otherCriteria = "";
    wrkCriteria = elementObj.DISCHARGE_CRITERIA;
    wrkCriteriaSize = 0;
    if (wrkCriteria != ''){
        wrkCriteriaArray = wrkCriteria.split(',');
        wrkCriteriaSize = wrkCriteriaArray.length;
    }
    wrkValue = '';
    for (var i = 0; i < wrkCriteriaSize; i++)
    {
        if (wrkCriteriaArray[i].indexOf("Other:") > -1) {
            for (var j = i; j < wrkCriteriaSize; j++) {
                wrkValue +=  (j== (wrkCriteriaSize-1))? wrkCriteriaArray[j].replace(/^\s+|\s+$/g,''): (wrkCriteriaArray[j] + ",");
                i++;
            }
            CC_SectionManagement.dccriteriaH5Sec.UnformatBodyVal +='<tr><td>'+ wrkValue + "</td></tr>\n";

        } else {
            if ((wrkCriteriaArray[i].indexOf("Stable on room air") > -1) && stableRoomVal != "" && stableRoomVal.length > 0) {
                CC_SectionManagement.dccriteriaH5Sec.UnformatBodyVal +='<tr><td>' +
                    'Stable on room air for ' + stableRoomVal + " hours</td></tr>\n"; }

            else if ((wrkCriteriaArray[i].indexOf("Afebrile") > -1) && afebrileVal != "" && afebrileVal.length > 0)
                CC_SectionManagement.dccriteriaH5Sec.UnformatBodyVal +='<tr><td>' +
                    'Afebrile for ' + afebrileVal + " hours</td></tr>\n";

            else if ((wrkCriteriaArray[i].indexOf("Cultures negative") > -1) && cultureVal != "" && cultureVal.length > 0)
                CC_SectionManagement.dccriteriaH5Sec.UnformatBodyVal +='<tr><td>' +
                    'Cultures negative for ' + cultureVal + " hours</td></tr>\n";

            else if ((wrkCriteriaArray[i].indexOf("Cleared by the following") > -1) && clearServicesVal != "" && clearServicesVal.length > 0)
                CC_SectionManagement.dccriteriaH5Sec.UnformatBodyVal +='<tr><td>' +
                    'Cleared by the following services - ' + clearServicesVal + "</td></tr>\n";

            else
                CC_SectionManagement.dccriteriaH5Sec.UnformatBodyVal +='<tr><td>'+ wrkCriteriaArray[i] + "</td></tr>";

        }
    }

    if (CC_SectionManagement.dccriteriaH5Sec.UnformatBodyVal == ''){
        CC_SectionManagement.dccriteriaH5Sec.UnformatBodyVal = dcinstructions.default_criteria;
    }
    //-------------------------------------------------------------------------
    wrkRPTDATA_cnt = elementObj.RESULT_CNT;
    for (wrkRPTDATA_idx = 0; wrkRPTDATA_idx < wrkRPTDATA_cnt; wrkRPTDATA_idx++) {
        wrkRPTDATA = elementObj.RESULTS[wrkRPTDATA_idx];
        listLen2 = wrkRPTDATA.DISCHARGE_DIAGNOSESORDER_CNT;
        wrkResults = '';
        for (i = 0; i < listLen2; i++) {
            wrkDesc = wrkRPTDATA.DISCHARGE_DIAGNOSES_ORDERS[i].DISCHARGE_DIAGNOSES_ORDERDESC;
            wrkValue = wrkRPTDATA.DISCHARGE_DIAGNOSES_ORDERS[i].DISCHARGE_DIAGNOSES_ORDERVALUE;
            if (wrkDesc == "Diagnosis") {
                wrkResults   += wrkValue + "</br>";
            }
        }
        dcinstructions.dcdiagnosesVal = wrkResults == '' ?  '' : wrkResults;
//-------------------------------------------------------------------------

        DC_OrderItms.SectionObj = CC_SectionManagement.actyorderH6Sec;
        DC_OrderItms.DC_Order_cnt = wrkRPTDATA.ACTYORDER_CNT;
        DC_OrderItms.DC_Order = wrkRPTDATA.ACTYORDERS
        DC_OrderItms.DescLbl = 'ACTYORDERDESC';
        DC_OrderItms.ValueLbl = 'ACTYORDERVALUE';
        Dc_OrdersProcessing(DC_OrderItms);

        //-------------------------------------------------------------------------

        DC_OrderItms.SectionObj = CC_SectionManagement.hygorderH6Sec;
        DC_OrderItms.DC_Order_cnt = wrkRPTDATA.HYGORDER_CNT;
        DC_OrderItms.DC_Order = wrkRPTDATA.HYGORDERS;
        DC_OrderItms.DescLbl = 'HYGORDERDESC';
        DC_OrderItms.ValueLbl = 'HYGORDERVALUE';
        Dc_OrdersProcessing(DC_OrderItms);

        //-------------------------------------------------------------------------

        DC_OrderItms.SectionObj = CC_SectionManagement.resporderH6Sec;
        DC_OrderItms.DC_Order_cnt = wrkRPTDATA.RESPORDER_CNT;
        DC_OrderItms.DC_Order = wrkRPTDATA.RESPORDERS;
        DC_OrderItms.DescLbl = 'RESPORDERDESC';
        DC_OrderItms.ValueLbl = 'RESPORDERVALUE';
        Dc_OrdersProcessing(DC_OrderItms);

        //-------------------------------------------------------------------------

        DC_OrderItms.SectionObj = CC_SectionManagement.othorderH6Sec;
        DC_OrderItms.DC_Order_cnt = wrkRPTDATA.OTHORDER_CNT;
        DC_OrderItms.DC_Order = wrkRPTDATA.OTHORDERS;
        DC_OrderItms.DescLbl = 'OTHORDERDESC';
        DC_OrderItms.ValueLbl = 'OTHORDERVALUE';
        Dc_OrdersProcessing(DC_OrderItms);

        //-------------------------------------------------------------------------

        DC_OrderItms.SectionObj = CC_SectionManagement.laborderH6Sec;
        DC_OrderItms.DC_Order_cnt = wrkRPTDATA.LABORDER_CNT;
        DC_OrderItms.DC_Order = wrkRPTDATA.LABORDERS;
        DC_OrderItms.DescLbl = 'LABORDERDESC';
        DC_OrderItms.ValueLbl = 'LABORDERVALUE';
        Dc_OrdersProcessing(DC_OrderItms);
        //-------------------------------------------------------------------------

        DC_OrderItms.SectionObj = CC_SectionManagement.notify_md_orderH6Sec;
        DC_OrderItms.DC_Order_cnt =  wrkRPTDATA.NOTIFY_MD_ORDER_CNT;
        DC_OrderItms.DC_Order = wrkRPTDATA.NOTIFY_MDORDERS;
        DC_OrderItms.DescLbl = 'NOTIFY_MDORDERDESC';
        DC_OrderItms.ValueLbl = 'NOTIFY_MDORDERVALUE';
        Dc_OrdersProcessing(DC_OrderItms);
    }

//-------------------------------------------------------------------------------------------------------------
    SectionObj = CC_SectionManagement.actyorderH6Sec ;
    SectionObj.idLabel =  'actyorderH6Sec';
    SectionObj.TLabel1 =  'Activity';
    SectionObj.SectionCnt = ' (' + SectionObj.SectionCntVal + ')';
    SectionObj.SectionClosed = 'closed';
    SectionObj.Disabled_Lbl = (SectionObj.SectionCntVal  == 0) ? 'grey': '';
    SectionObj.CustIcon = (SectionObj.SectionCntVal == 0) ? 'background-image:none;': '';
    SectionObj.ContentBody =
        chla.eApps.Funcs.parseTemplate( '<table><#=actyorder#></table>', {actyorder: SectionObj.UnformatBodyVal });
    CC_SectionManagement.dcinstrH5Sec.UnformatBodyVal = chla.eApps.Funcs.parseTemplate( chla.eApps.Vars.H6_Tmpl.join('') ,SectionObj);

// -------------------------------------------------------------------------------------------------------------
    SectionObj = CC_SectionManagement.hygorderH6Sec ;
    SectionObj.idLabel =  'hygorderH6Sec';
    SectionObj.TLabel1 =  'Hygiene';
    SectionObj.SectionCnt = ' (' + SectionObj.SectionCntVal + ')';
    SectionObj.SectionClosed = 'closed';
    SectionObj.Disabled_Lbl = (SectionObj.SectionCntVal  == 0) ? 'grey': '';
    SectionObj.CustIcon = (SectionObj.SectionCntVal == 0) ? 'background-image:none;': '';
    SectionObj.ContentBody =
        chla.eApps.Funcs.parseTemplate( '<table><#=hygorder#></table>', {hygorder: SectionObj.UnformatBodyVal });
    CC_SectionManagement.dcinstrH5Sec.UnformatBodyVal += chla.eApps.Funcs.parseTemplate( chla.eApps.Vars.H6_Tmpl.join('') ,SectionObj);
// -------------------------------------------------------------------------------------------------------------
    SectionObj = CC_SectionManagement.resporderH6Sec ;
    SectionObj.idLabel =  'resporderH6Sec';
    SectionObj.TLabel1 =  'Respiratory Treatment';
    SectionObj.SectionCnt = ' (' + SectionObj.SectionCntVal + ')';
    SectionObj.SectionClosed = 'closed';
    SectionObj.Disabled_Lbl = (SectionObj.SectionCntVal  == 0) ? 'grey': '';
    SectionObj.CustIcon = (SectionObj.SectionCntVal == 0) ? 'background-image:none;': '';
    SectionObj.ContentBody =
        chla.eApps.Funcs.parseTemplate( '<table><#=resporder#></table>', {resporder: SectionObj.UnformatBodyVal });
    CC_SectionManagement.dcinstrH5Sec.UnformatBodyVal += chla.eApps.Funcs.parseTemplate( chla.eApps.Vars.H6_Tmpl.join('') ,SectionObj);
// -------------------------------------------------------------------------------------------------------------
    SectionObj = CC_SectionManagement.othorderH6Sec ;
    SectionObj.idLabel =  'othorderH6Sec';
    SectionObj.TLabel1 =  'Other Treatment';
    SectionObj.SectionCnt = ' (' + SectionObj.SectionCntVal + ')';
    SectionObj.SectionClosed = 'closed';
    SectionObj.Disabled_Lbl = (SectionObj.SectionCntVal  == 0) ? 'grey': '';
    SectionObj.CustIcon = (SectionObj.SectionCntVal == 0) ? 'background-image:none;': '';
    SectionObj.ContentBody =
        chla.eApps.Funcs.parseTemplate( '<table><#=othorder#></table>', {othorder: SectionObj.UnformatBodyVal });
    CC_SectionManagement.dcinstrH5Sec.UnformatBodyVal += chla.eApps.Funcs.parseTemplate( chla.eApps.Vars.H6_Tmpl.join('') ,SectionObj);
// -------------------------------------------------------------------------------------------------------------
    SectionObj = CC_SectionManagement.laborderH6Sec ;
    SectionObj.idLabel =  'laborderH6Sec';
    SectionObj.TLabel1 =  'Lab and Diagnostics ';
    SectionObj.SectionCnt = ' (' + SectionObj.SectionCntVal + ')';
    SectionObj.SectionClosed = 'closed';
    SectionObj.Disabled_Lbl = (SectionObj.SectionCntVal  == 0) ? 'grey': '';
    SectionObj.CustIcon = (SectionObj.SectionCntVal == 0) ? 'background-image:none;': '';
    SectionObj.ContentBody =
        chla.eApps.Funcs.parseTemplate( '<table><#=laborder#></table>', {laborder: SectionObj.UnformatBodyVal });
    CC_SectionManagement.dcinstrH5Sec.UnformatBodyVal += chla.eApps.Funcs.parseTemplate( chla.eApps.Vars.H6_Tmpl.join('') ,SectionObj);

// -------------------------------------------------------------------------------------------------------------
    SectionObj = CC_SectionManagement.notify_md_orderH6Sec ;
    SectionObj.idLabel =  'notify_md_orderH6Sec';
    SectionObj.TLabel1 =  'Notify MD ';
    SectionObj.SectionCnt = ' (' + SectionObj.SectionCntVal + ')';
    SectionObj.SectionClosed = 'closed';
    SectionObj.Disabled_Lbl = (SectionObj.SectionCntVal  == 0) ? 'grey': '';
    SectionObj.CustIcon = (SectionObj.SectionCntVal == 0) ? 'background-image:none;': '';
    SectionObj.ContentBody =
        chla.eApps.Funcs.parseTemplate( '<table><#=notify_md_order#></table>', {notify_md_order: SectionObj.UnformatBodyVal });
    CC_SectionManagement.dcinstrH5Sec.UnformatBodyVal += chla.eApps.Funcs.parseTemplate( chla.eApps.Vars.H6_Tmpl.join('') ,SectionObj);

//-------------------------------------------------------------------------------------------------------------
    SectionObj = CC_SectionManagement.dccriteriaH5Sec ;
    SectionObj.idLabel =  'dccriteriaH5Sec';
    SectionObj.TLabel1 =  'Discharge Criteria';
    SectionObj.SectionCnt =  '';
    SectionObj.CustIcon = 'background-image:none;';
    SectionObj.HideIfEmpty = 'false';
    SectionObj.ContentBody =  '<table>' +  SectionObj.UnformatBodyVal  + '</table>';
    dcinstructions.dccriteriaH5Section = chla.eApps.Funcs.parseTemplate( chla.eApps.Vars.H5_Tmpl.join('') ,SectionObj);

//-------------------------------------------------------------------------------------------------------------
    dcinstructions.dcdiagnosesVal = (dcinstructions.dcdiagnosesVal == '')? 'Not entered': dcinstructions.dcdiagnosesVal;
    dcinstructions.dischargeDiagnosesValue =
        chla.eApps.Funcs.parseTemplate( '<div><table><tr><td class="eapps_TDH6">' +  details_Tmpl.transparentSpacer
            + 'Discharge Diagnoses</td><td><span class="detail-line"><#=dischargeDiagnosesValue#></span></td></tr></table></div>',
            { dischargeDiagnosesValue: dcinstructions.dcdiagnosesVal  }  );

    SectionObj = CC_SectionManagement.dcinstrH5Sec;
    SectionObj.idLabel =  'dcinstrH5Sec';
    SectionObj.TLabel1 =  'Discharge Instructions';
    SectionObj.SectionCnt =  '';
    SectionObj.SectionCntVal =  1;
    SectionObj.SectionClosed = 'closed';
    SectionObj.ContentBody = dcinstructions.dischargeDiagnosesValue  +
        CC_SectionManagement.dcinstrH5Sec.UnformatBodyVal ;
    dcinstructions.dcinstrH5Section = chla.eApps.Funcs.parseTemplate( chla.eApps.Vars.H5_Tmpl.join('') ,SectionObj);

//-------------------------------------------------------------------------------------------------------------

    compContent = chla.eApps.Funcs.parseTemplate( dcinstructions_Tmpl.join('') ,dcinstructions);
    chla.eAppsUtil.Logger.LogWarn('<textarea rows="4" style="width:99%;">dc_instructions </br>' +
        chla.eApps.Funcs.HtmlLogFormatter(compContent) + "</textarea>");
    target.innerHTML = compContent;

    $('div#dcinstrH5Sec_DivSubSec H2.h5a-marker').on( "click",chla.dc_instructions.eApps.CSSBehaviors.SingleH5SectionToggle) ;

    if(CC_SectionManagement.actyorderH6Sec.SectionCntVal > 0)
        $('#actyorderH6Sec_DivSubSec1 H2.h6a-marker').on( "click",chla.dc_instructions.eApps.CSSBehaviors.SingleH6SectionToggle) ;

    if(CC_SectionManagement.hygorderH6Sec.SectionCntVal > 0)
        $('div#hygorderH6Sec_DivSubSec1 H2.h6a-marker').on( "click",chla.dc_instructions.eApps.CSSBehaviors.SingleH6SectionToggle) ;

    if(CC_SectionManagement.resporderH6Sec.SectionCntVal > 0)
        $('div#resporderH6Sec_DivSubSec1 H2.h6a-marker').on( "click",chla.dc_instructions.eApps.CSSBehaviors.SingleH6SectionToggle) ;

    if(CC_SectionManagement.othorderH6Sec.SectionCntVal > 0)
        $('div#othorderH6Sec_DivSubSec1 H2.h6a-marker').on( "click",chla.dc_instructions.eApps.CSSBehaviors.SingleH6SectionToggle) ;

    if(CC_SectionManagement.laborderH6Sec.SectionCntVal > 0)
        $('div#laborderH6Sec_DivSubSec1.sub-sec H2.h6a-marker').on( "click",chla.dc_instructions.eApps.CSSBehaviors.SingleH6SectionToggle) ;

    if(CC_SectionManagement.notify_md_orderH6Sec.SectionCntVal > 0)
        $('div#notify_md_orderH6Sec_DivSubSec1.sub-sec H2.h6a-marker').on( "click",chla.dc_instructions.eApps.CSSBehaviors.SingleH6SectionToggle) ;

};

//::===========================================================================
//:: CC - Diet/Feeding
//::---------------------------------------------------------------------------
chla.diet_feeding = function () { };
chla.diet_feeding.prototype = new MPage.Component();
chla.diet_feeding.prototype.constructor = MPage.Component;
chla.diet_feeding.prototype.base = MPage.Component.prototype;
chla.diet_feeding.prototype.name = "chla.diet_feeding";
chla.diet_feeding.prototype.cclProgram = "chla_ca_mp_cc_dc_diet_json";
chla.diet_feeding.prototype.cclParams = [];
chla.diet_feeding.prototype.cclDataType = "JSON";
chla.diet_feeding.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("encounterId");
};

chla.diet_feeding.prototype.render = function () {

    var component = this;
    var elementObj = component.data.RPTDATA;
    var target = this.getTarget();
    var compContent;

    var totalDietOrders;
    var wrkRPTDATA_cnt,
        wrkRPTDATA,
        wrkRPTDATA_idx,
        wrkValue,
        wrkDate;
    //-------------------------------------
    //  CC - H5/H6  Management Section
    //-------------------------------------
    var CC_SectionManagement ={};

    CC_SectionManagement.dietorderH5Sec = new  chla.eApps.SectionHeader();
    CC_SectionManagement.ipdietorderH5Sec = new  chla.eApps.SectionHeader();

    //-------------------------------------
    // CC - DIV Template Data Object
    //-------------------------------------
    var dietFeeding = {
        cc_id: 'x',
        personId: 0,
        encounterId: 0,
        transparentSpacer:'',
        dietorderH5Section: '',
        ipdietorderH5Section: ''
    } ;

    //-------------------------------------
    // Main CC - DIV Template
    //-------------------------------------
    var dietFeeding_Tmpl = [
        '<div id="<#=cc_id#>" class="eapps_CC">',
        '<table class="header"><tr><th class="col-1">Date</th><th class="col-2">Diet Instruction</th></tr></table>',
        '<#=ipdietorderH5Section#>',
        '<#=dietorderH5Section#>',
        '</div>'
    ]
//-------------------------------------
//  Stanadard Common initializations
//-------------------------------------
    chla.diet_feeding.eApps = {};
    chla.diet_feeding.eApps.cc_id = chla.diet_feeding.prototype.name.replace('.','_');
    chla.diet_feeding.eApps.CSSBehaviors = new chla.eApps.CSSBehaviors();


    dietFeeding.cc_id = chla.diet_feeding.eApps.cc_id;
    dietFeeding.personId = this.getProperty("personId");
    dietFeeding.encounterId = this.getProperty("encounterId");
    dietFeeding.transparentSpacer = '<img src="' + chla.eApps.Vars.transparentSpacer + '" height="5px" width="17px"  >'

    totalDietOrders = elementObj.TOTAL_DIET_ORDER_CNT;
    CC_SectionManagement.dietorderH5Sec.SectionCntVal = elementObj.DIETORDER_CNT;
    CC_SectionManagement.ipdietorderH5Sec.SectionCntVal = elementObj.IP_DIET_ORDER_CNT;
    CC_SectionManagement.ipdietorderH5Sec.UnformatBodyVal= '';
    CC_SectionManagement.dietorderH5Sec.UnformatBodyVal= '';

    if (totalDietOrders > 0) {
        //Inpatient Diet orders
        wrkRPTDATA_cnt  =CC_SectionManagement.ipdietorderH5Sec.SectionCntVal;
        for (wrkRPTDATA_idx = 0; wrkRPTDATA_idx < wrkRPTDATA_cnt ; wrkRPTDATA_idx++) {
            wrkRPTDATA = elementObj.IP_DIET_ORDERS[wrkRPTDATA_idx];
            CC_SectionManagement.ipdietorderH5Sec.UnformatBodyVal += '<tr class="rowPopup" tip="'
                + '<ul>'
                + '<li><strong>Original Order Date:</strong> '   + wrkRPTDATA.ORIG_ORDER_DT_TM + '</li>'
                + '<li><strong>Current Start Date:</strong> '    + wrkRPTDATA.CURRENT_START_DT_TM + '</li>'
                + '<li><strong>Projected Stop Date:</strong> '   + wrkRPTDATA.PROJECTED_STOP_DT_TM + '</li>'
                + '<li><strong>Clinical Display Line:</strong> ' + wrkRPTDATA.CLINICAL_DISPLAY_LINE + '</li>'
                + '</ul>'
                + '">';
            CC_SectionManagement.ipdietorderH5Sec.UnformatBodyVal += '<td class="col-1">' + wrkRPTDATA.CLINICAL_DISPLAY_LINE + '</td>';
            CC_SectionManagement.ipdietorderH5Sec.UnformatBodyVal += '<td class="col-2">' + wrkRPTDATA.ORDER_MNEMONIC + '</td>';

            CC_SectionManagement.ipdietorderH5Sec.UnformatBodyVal += '</tr>';
        }

        //wrkDate = elementObj.DIETORDERS[0].ORDER_DATE;
        wrkRPTDATA_cnt  =CC_SectionManagement.dietorderH5Sec.SectionCntVal;
        var wrkDietArray='';
        //Discharge diet orders
        for (wrkRPTDATA_idx = 0; wrkRPTDATA_idx < wrkRPTDATA_cnt; wrkRPTDATA_idx++) {
            wrkRPTDATA = elementObj.DIETORDERS[wrkRPTDATA_idx];

            if (wrkRPTDATA.CLINICAL_DISPLAY_LINE != '') {
                wrkDietArray = wrkRPTDATA.CLINICAL_DISPLAY_LINE.split(',');
                wrkCriteriaSize = wrkDietArray.length;
            }
            var wrkDietValue = '';
            for (var i = 1; i < (wrkCriteriaSize); i++) {
                if (i==(wrkCriteriaSize-1))
                    wrkDietValue += wrkDietArray[i];
                else
                    wrkDietValue += wrkDietArray[i] + ", ";
            }

            CC_SectionManagement.dietorderH5Sec.UnformatBodyVal += '<tr>';
            CC_SectionManagement.dietorderH5Sec.UnformatBodyVal += '<td class="col-1">' + wrkRPTDATA.ORDER_DATE + '</td>';
            //CC_SectionManagement.dietorderH5Sec.UnformatBodyVal += '<td class="col-2">' + wrkDietValue + "Projected Stop Date" + wrkDietArray[wrkCriteriaSize-1] + '</td>';
            CC_SectionManagement.dietorderH5Sec.UnformatBodyVal += '<td class="col-2">' + wrkDietValue + '</td>';
            CC_SectionManagement.dietorderH5Sec.UnformatBodyVal += '</tr>';
        }
    }

    //-------------------------------------
    //  H5 sections HTML generations ( TEMPLATE MERGE )
    //compContent += "<div class='sectionDiv'><h2 id='dietOrdersHead' class='dcDietOrders_sectionHead'>Inpatient (" + ipDietOrders + ")</h2><table>";
    SectionObj = CC_SectionManagement.ipdietorderH5Sec  ;
    SectionObj.idLabel =  'ipdietorderH5Sec';
    SectionObj.TLabel1 =  'Inpatient';
    SectionObj.SectionCnt = ' (' + SectionObj.SectionCntVal + ')';
    SectionObj.SectionClosed = 'closed';
    SectionObj.Disabled_Lbl = (SectionObj.SectionCntVal  == 0) ? 'grey': '';
    SectionObj.CustIcon = (SectionObj.SectionCntVal == 0) ? 'background-image:none;': '';
    SectionObj.HideIfEmpty = 'false';
    //SectionObj.ContentBody ='<table class="header"><tr><th class="col-1">Date</th><th class="col-2">Diet Instruction</th></tr>';
    SectionObj.ContentBody += '<table>' + SectionObj.UnformatBodyVal  + '</table>';
    dietFeeding.ipdietorderH5Section = chla.eApps.Funcs.parseTemplate( chla.eApps.Vars.H5_Tmpl.join('') ,SectionObj);

    //-------------------------------------
    //compContent += "<h2 class='dcDietOrders_sectionHead'>Discharge (" + dischargeDietOrders + ")</h2>";
    SectionObj = CC_SectionManagement.dietorderH5Sec  ;
    SectionObj.idLabel =  'dietorderH5Sec';
    SectionObj.TLabel1 =  'Discharge';
    SectionObj.SectionCnt = ' (' + SectionObj.SectionCntVal + ')';
    SectionObj.SectionClosed = 'closed';
    SectionObj.Disabled_Lbl = (SectionObj.SectionCntVal  == 0) ? 'grey': '';
    SectionObj.CustIcon = (SectionObj.SectionCntVal == 0) ? 'background-image:none;': '';
    SectionObj.HideIfEmpty = 'false';
    //SectionObj.ContentBody ='<table class="header"><tr><th class="col-1">Date</th><th class="col-2">Diet Instruction</th></tr>';
    SectionObj.ContentBody += '<table>' + SectionObj.UnformatBodyVal  + '</table>';
    dietFeeding.dietorderH5Section = chla.eApps.Funcs.parseTemplate( chla.eApps.Vars.H5_Tmpl.join('') ,SectionObj);

    //-------------------------------------
    //  CC DIV sections HTML generations ( TEMPLATE MERGE )
    //-------------------------------------
    compContent = chla.eApps.Funcs.parseTemplate( dietFeeding_Tmpl.join('') ,dietFeeding);

    //-------------------------------------
    //  CC DIV Rendering
    //-------------------------------------
    chla.eAppsUtil.Logger.LogWarn('<textarea rows="4" style="width:99%;">diet_feeding </br>' + chla.eApps.Funcs.HtmlLogFormatter(compContent) + "</textarea>");
    target.innerHTML = compContent;

    //-------------------------------------
    //Section Collapse and Expand CSS behavior handles
    //-------------------------------------
    if(CC_SectionManagement.dietorderH5Sec.SectionCntVal > 0)
        $('div#dietorderH5Sec_DivSubSec H2.h5a-marker').on( "click",chla.diet_feeding.eApps.CSSBehaviors.SingleH5SectionToggle) ;

    if(CC_SectionManagement.ipdietorderH5Sec.SectionCntVal > 0)
        $('div#ipdietorderH5Sec_DivSubSec H2.h5a-marker').on( "click",chla.diet_feeding.eApps.CSSBehaviors.SingleH5SectionToggle) ;


    reInitPopUps();

    //Initialize hovers to display additional surgery detail
    function reInitPopUps() {
        //add the class of hover to all elements with the class of rowPopup
        $(".rowPopup").hover (
            function() {
                if (this.tip > " ")
                {
                    $('<div id="tooltip">' + this.tip+ '</div>').css( {
                        position: 'absolute',
                        width: '250px',
                        top: event.clientY+20,
                        left: event.clientX+10,
                        border: '1px solid #BDBDBD',
                        padding: '10px 10px 10px 10px',
                        'background-color': '#FFFCE1',
                        opacity: 1.00
                    }).appendTo("body").fadeIn(0);
                }
            },
            function(){
                $("#tooltip").remove();
            }
        )
    };

};

//::===========================================================================
//:: CC - Appointments
//::---------------------------------------------------------------------------
chla.appt = function () { };
chla.appt.prototype = new MPage.Component();
chla.appt.prototype.constructor = MPage.Component;
chla.appt.prototype.base = MPage.Component.prototype;
chla.appt.prototype.name = "chla.appt";
chla.appt.prototype.cclProgram = "chla_ca_mp_cc_dc_appt_json";
chla.appt.prototype.cclParams = [];
chla.appt.prototype.cclDataType = "JSON";
chla.appt.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("encounterId");
};

chla.appt.prototype.render = function () {
    var component = this;
    var elementObj = component.data.RPTDATA;
    var target = this.getTarget();
    var compContent;

    //-------------------------------------
    //  Common Used Variable Names for RPTDATA processing
    //-------------------------------------
    var i, j , k ;             // common for loop values
    var SectionObj,            // CC_SectionManagement
        // variables to hold RPTData values
        wrkRPTDATA_cnt,
        wrkRPTDATA,
        wrkRPTDATA_idx,
        wrkCnt,
        wrkValue,
        wrkDesc,
        wrkList,
        wrkPrevValue,
        wrkResults;

    var listLen,
        listLen2;
    //NOTE:: numbers used to denote the code hierarchy depth variable is used at.
    //NOTE:: i.e. inside for, while, if command statement

    //-------------------------------------
    //  CC - H5/H6  Management Section
    //-------------------------------------
    var CC_SectionManagement ={};

    CC_SectionManagement.requestedVisitH5Sec = new  chla.eApps.SectionHeader();
    CC_SectionManagement.futureVisitH5Sec = new  chla.eApps.SectionHeader();
    CC_SectionManagement.previousVisitH5Sec = new  chla.eApps.SectionHeader();

    //-------------------------------------
    // CC - DIV Template Data Object
    //-------------------------------------
    var appt = {
        cc_id: 'x',
        personId: 0,
        encounterId: 0,
        transparentSpacer:'',
        CC_default_content: '<p>No Appointments Found</p>',
        requestedVisitH5Section:'',
        futureVisitH5Section:'',
        previousVisitH5Section:''

    } ;

    //-------------------------------------
    // Main CC - DIV Template
    //-------------------------------------
    var appt_Tmpl = [
        '<div id="<#=cc_id#>" class="eapps_CC">',
        '<#=requestedVisitH5Section#>',
        '<#=futureVisitH5Section#>',
        '<#=previousVisitH5Section#>',
        '</div>'
    ]

    var totalApptData;

//-------------------------------------
//  Stanadard Common initializations
//-------------------------------------
    chla.appt.eApps = {};
    chla.appt.eApps.cc_id = chla.appt.prototype.name.replace('.','_');
    chla.appt.eApps.CSSBehaviors = new chla.eApps.CSSBehaviors();

    appt.cc_id = chla.appt.eApps.cc_id;
    appt.personId = this.getProperty("personId");
    appt.encounterId = this.getProperty("encounterId");
    appt.transparentSpacer = '<img src="' + chla.eApps.Vars.transparentSpacer + '" height="5px" width="17px"  >'

//-------------------------------------
//  RPTDATA processing
//-------------------------------------

    CC_SectionManagement.requestedVisitH5Sec.SectionCntVal =  elementObj.APPTORDER_CNT;

    CC_SectionManagement.previousVisitH5Sec.SectionCntVal =  elementObj.PREVIOUS_VISIT_CNT;

    CC_SectionManagement.requestedVisitH5Sec.UnformatBodyVal = '';
    CC_SectionManagement.futureVisitH5Sec.UnformatBodyVal = '';
    CC_SectionManagement.previousVisitH5Sec.UnformatBodyVal = '';

    for (wrkRPTDATA_idx = 0; wrkRPTDATA_idx < elementObj.APPTORDER_CNT; wrkRPTDATA_idx++) {
        wrkRPTDATA = elementObj.APPTORDERS[wrkRPTDATA_idx];

        CC_SectionManagement.requestedVisitH5Sec.UnformatBodyVal += '<tr>';
        CC_SectionManagement.requestedVisitH5Sec.UnformatBodyVal += '<td class="col-1">' + wrkRPTDATA.APPT_DOCTOR + '</td>';
        CC_SectionManagement.requestedVisitH5Sec.UnformatBodyVal += '<td class="col-2">';
        CC_SectionManagement.requestedVisitH5Sec.UnformatBodyVal += (wrkRPTDATA.APPT_DATE)? wrkRPTDATA.APPT_DATE : '&nbsp;';
        CC_SectionManagement.requestedVisitH5Sec.UnformatBodyVal += '</td><td class="col-3">';
        CC_SectionManagement.requestedVisitH5Sec.UnformatBodyVal += (wrkRPTDATA.APPT_CLINIC) ? wrkRPTDATA.APPT_CLINIC : 'Outside CHLA';
        CC_SectionManagement.requestedVisitH5Sec.UnformatBodyVal += '</td></tr>';
    }
    wrkCnt = 0;
    for (wrkRPTDATA_idx = 0; wrkRPTDATA_idx < elementObj.FUTURE_VISIT_CNT; wrkRPTDATA_idx++) {
        wrkRPTDATA = elementObj.FUTURE_VISITS[wrkRPTDATA_idx];

        if (wrkRPTDATA.TYPE != ''){
            if (wrkCnt < 10) {
                CC_SectionManagement.futureVisitH5Sec.UnformatBodyVal += '<tr>';
                CC_SectionManagement.futureVisitH5Sec.UnformatBodyVal += '<td class="col-1">';
                CC_SectionManagement.futureVisitH5Sec.UnformatBodyVal += (wrkRPTDATA.TYPE)? wrkRPTDATA.TYPE : '&nbsp;';
                CC_SectionManagement.futureVisitH5Sec.UnformatBodyVal += '</td><td class="col-2">';
                CC_SectionManagement.futureVisitH5Sec.UnformatBodyVal += (wrkRPTDATA.STATE) ? wrkRPTDATA.STATE : '&nbsp;';
                CC_SectionManagement.futureVisitH5Sec.UnformatBodyVal += '</td><td class="col-3">';
                CC_SectionManagement.futureVisitH5Sec.UnformatBodyVal += (wrkRPTDATA.BEG_DT_TM)? wrkRPTDATA.BEG_DT_TM : '&nbsp;';
                CC_SectionManagement.futureVisitH5Sec.UnformatBodyVal += '</td><td class="col-4">';
                CC_SectionManagement.futureVisitH5Sec.UnformatBodyVal += (wrkRPTDATA.LOCATION) ? wrkRPTDATA.LOCATION : '&nbsp;';
                CC_SectionManagement.futureVisitH5Sec.UnformatBodyVal += '</td></tr>';
                wrkCnt  += 1 ;
            }
        }
    }
    CC_SectionManagement.futureVisitH5Sec.SectionCntVal = wrkCnt;

    wrkRPTDATA_cnt = elementObj.PREVIOUS_VISIT_CNT ;
    if (elementObj.PREVIOUS_VISIT_CNT > 10)
        wrkRPTDATA_cnt = 10;

    for (wrkRPTDATA_idx = 0; wrkRPTDATA_idx < wrkRPTDATA_cnt ; wrkRPTDATA_idx++) {
        wrkRPTDATA = elementObj.PREVIOUS_VISITS[wrkRPTDATA_idx];

        CC_SectionManagement.previousVisitH5Sec.UnformatBodyVal += '<tr>';
        CC_SectionManagement.previousVisitH5Sec.UnformatBodyVal += '<td class="col-1">' +
            wrkRPTDATA.ENCNTR_TYPE + '</td>';
        CC_SectionManagement.previousVisitH5Sec.UnformatBodyVal += '<td class="col-2">';
        CC_SectionManagement.previousVisitH5Sec.UnformatBodyVal +=
            (wrkRPTDATA.BEG_EFFECTIVE_DT_TM) ? wrkRPTDATA.BEG_EFFECTIVE_DT_TM : '&nbsp;';
        wrkValue = '&nbsp;';
        if (wrkRPTDATA.FACILITY) {
            wrkValue = wrkRPTDATA.FACILITY;
            wrkValue +=  (wrkRPTDATA.NURSE_UNIT)? (" | " + wrkRPTDATA.NURSE_UNIT): '';
            wrkValue +=  (wrkRPTDATA.ROOM) ? (" | " + wrkRPTDATA.ROOM): '';
            wrkValue +=  (wrkRPTDATA.LOCATION) ? (" | " + wrkRPTDATA.LOCATION) : '';
        }
        CC_SectionManagement.previousVisitH5Sec.UnformatBodyVal += '</td><td class="col-3">' + wrkValue + '</td>';
        CC_SectionManagement.previousVisitH5Sec.UnformatBodyVal += '</tr>';
    }
    //chla.eAppsUtil.Logger.LogInfo('CC_SectionManagement.previousVisitH5Sec.UnformatBodyVal: ' + chla.eApps.Funcs.HtmlLogFormatter(CC_SectionManagement.previousVisitH5Sec.UnformatBodyVal) );
    //--------------------------------------------------------------------------

    SectionObj = CC_SectionManagement.requestedVisitH5Sec;
    SectionObj.idLabel =  'requestedVisitH5Sec';
    SectionObj.TLabel1 =  'Requested';
    SectionObj.SectionCnt = ' (' + SectionObj.SectionCntVal + ')';
    SectionObj.SectionClosed = 'closed';
    SectionObj.Disabled_Lbl = (SectionObj.SectionCntVal  == 0) ? 'grey': '';
    SectionObj.CustIcon = (SectionObj.SectionCntVal == 0) ? 'background-image:none;': '';
    SectionObj.HideIfEmpty = 'false';
    SectionObj.ContentBody =  '<table class="header"><tr><th class="col-1">Appointment With</th><th class="col-2">Date</th><th class="col-3">Clinic</th></tr>';
    SectionObj.ContentBody +=  SectionObj.UnformatBodyVal  + '</table>';
    appt.requestedVisitH5Section = chla.eApps.Funcs.parseTemplate( chla.eApps.Vars.H5_Tmpl.join('') ,SectionObj);

    //--------------------------------------------------------------------------

    SectionObj = CC_SectionManagement.futureVisitH5Sec;
    SectionObj.idLabel =  'futureVisitH5Sec';
    SectionObj.TLabel1 =  'Future Visits';
    SectionObj.SectionCnt = ' (' + SectionObj.SectionCntVal + ')';
    SectionObj.SectionClosed = 'closed';
    SectionObj.Disabled_Lbl = (SectionObj.SectionCntVal  == 0) ? 'grey': '';
    SectionObj.CustIcon = (SectionObj.SectionCntVal == 0) ? 'background-image:none;': '';
    SectionObj.HideIfEmpty = 'false';
    SectionObj.ContentBody ='<table class="header"><tr><th class="col-1">Type</th><th class="col-2">State</th><th class="col-3">Date</th><th class="col-4">Location</th></tr>';
    SectionObj.ContentBody += SectionObj.UnformatBodyVal  + '</table>';
    appt.futureVisitH5Section = chla.eApps.Funcs.parseTemplate( chla.eApps.Vars.H5_Tmpl.join('') ,SectionObj);

    //--------------------------------------------------------------------------

    SectionObj = CC_SectionManagement.previousVisitH5Sec;
    SectionObj.idLabel =  'previousVisitH5Sec';
    SectionObj.TLabel1 =  'Previous Visits';
    SectionObj.SectionCnt = ' (' + SectionObj.SectionCntVal + ')';
    SectionObj.SectionClosed = 'closed';
    SectionObj.Disabled_Lbl = (SectionObj.SectionCntVal  == 0) ? 'grey': '';
    SectionObj.CustIcon = (SectionObj.SectionCntVal == 0) ? 'background-image:none;': '';
    SectionObj.HideIfEmpty = 'false';
    SectionObj.ContentBody =  '<table class="header"><tr><th class="col-1">Type</th><th class="col-2">Date</th><th class="col-3">Clinic</th></tr>';
    SectionObj.ContentBody +=  SectionObj.UnformatBodyVal  + '</table>';
    appt.previousVisitH5Section = chla.eApps.Funcs.parseTemplate( chla.eApps.Vars.H5_Tmpl.join('') ,SectionObj);

    //-------------------------------------
    //  CC DIV sections HTML generations ( TEMPLATE MERGE )
    //-------------------------------------
    compContent = chla.eApps.Funcs.parseTemplate( appt_Tmpl.join('') ,appt);

    //-------------------------------------
    //  CC DIV Rendering
    //-------------------------------------
    chla.eAppsUtil.Logger.LogWarn('<textarea rows="4" style="width:99%;">appts </br>' + chla.eApps.Funcs.HtmlLogFormatter(compContent) + "</textarea>");
    target.innerHTML = compContent;

//-------------------------------------
//  CC HTML/CSS behaviours
//-------------------------------------
    //-------------------------------------
    //Section Collapse and Expand CSS behavior handles
    //-------------------------------------

    if(CC_SectionManagement.requestedVisitH5Sec.SectionCntVal > 0)
        $('#requestedVisitH5Sec_DivSubSec H2.h5a-marker').on( "click",chla.appt.eApps.CSSBehaviors.SingleH5SectionToggle) ;

    if(CC_SectionManagement.futureVisitH5Sec.SectionCntVal > 0)
        $('#futureVisitH5Sec_DivSubSec H2.h5a-marker').on( "click",chla.appt.eApps.CSSBehaviors.SingleH5SectionToggle) ;

    if(CC_SectionManagement.previousVisitH5Sec.SectionCntVal > 0)
        $('#previousVisitH5Sec_DivSubSec H2.h5a-marker').on( "click",chla.appt.eApps.CSSBehaviors.SingleH5SectionToggle) ;

};
//::===========================================================================
//:: CC - Med Rec
//::---------------------------------------------------------------------------
chla.medrec = function () { };
chla.medrec.prototype = new MPage.Component();
chla.medrec.prototype.constructor = MPage.Component;
chla.medrec.prototype.base = MPage.Component.prototype;
chla.medrec.prototype.name = "chla.medrec";
chla.medrec.prototype.cclProgram = "chla_ca_mp_cc_dc_medrec_json";
chla.medrec.prototype.cclParams = [];
chla.medrec.prototype.cclDataType = "JSON";
chla.medrec.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("encounterId");
};

chla.medrec.prototype.render = function () {
    var component = this;
    var elementObj = component.data.RPTDATA;
    var target = this.getTarget();
    var compContent;

    //-------------------------------------
    //  Common Used Variable Names for RPTDATA processing
    //-------------------------------------
    var i, j , k ;             // common for loop values
    var SectionObj,            // CC_SectionManagement
        // variables to hold RPTData values
        wrkRPTDATA_cnt,
        wrkRPTDATA,
        wrkRPTDATA_idx,
        wrkCnt,
        wrkValue,
        wrkDesc,
        wrkList,
        wrkPrevValue,
        wrkResults;

    var listLen,
        listLen2;

    var medrecCnt;
    var medrecOrder;


    //-------------------------------------
    // CC - DIV Template Data Object
    //-------------------------------------
    var medRec = {
        cc_id: 'x',
        personId: 0,
        encounterId: 0,
        transparentSpacer:'',
        default_medOrder_content: '<p>No Discharge Medication Reconciliations Found</p>',
        MedrecRadNoChecked:'checked',
        MedrecRadYesChecked:'',
        reconorder: '',
        medrecTAval:''

    } ;

    //-------------------------------------
    // Main CC - DIV Template
    //-------------------------------------
    var medRec_Tmpl = [
        '<div id="<#=cc_id#>" class="eapps_CC">',
        '<table class="header"><tr><th class="col-1">Reconciliation Date</th><th class="col-2">Person Responsible</th></tr>',
        '<#=reconorder#>',
        '</table>',
        '<div id="medrecformat" style="margin-top: 5px;">',
        '<dl><dt style="float: left;clear:left;">Are discharge prescriptions written prior to day of discharge?&nbsp;&nbsp;</dt>',
        '<dd style="float: left;width:90px; "><input type="Radio" id="MedrecRadyes" name="radio1" <#=MedrecRadYesChecked#> />&nbsp;Yes&nbsp;',
        '<input type="Radio" id="MedrecRadno"  name="radio1"  <#=MedrecRadNoChecked#> />&nbsp;No&nbsp;</dd></dl>',
        '<p style="clear:left;"/><br/><p >Prescriptions or med authorizations needed:</p>',
        '<textarea rows="4" cols="40" id="medrecTA" style="margin-bottom: 3px;width: 97%;"><#=medrecTAval#></textarea>'  ,
        '<br/><button id="medrecBtnSave" class="eappsBtnGrey">Save</button></div>',
        '</div>'
    ]

//-------------------------------------
//  Stanadard Common initializations
//-------------------------------------
    chla.medrec.eApps = {};
    chla.medrec.eApps.cc_id = chla.medrec.prototype.name.replace('.','_');
    chla.medrec.eApps.SaveButtonAction = chla.eApps.SaveButtonBehavior.enable_disable_status_reset;
    chla.medrec.eApps.CSSBehaviors = new chla.eApps.CSSBehaviors();

    medRec.cc_id = chla.medrec.eApps.cc_id;
    medRec.personId = this.getProperty("personId");
    medRec.encounterId = this.getProperty("encounterId");
    medRec.transparentSpacer = '<img src="' + chla.eApps.Vars.transparentSpacer + '" height="5px" width="17px"  >'

//-------------------------------------
//  RPTDATA processing
//-------------------------------------
    wrkRPTDATA_cnt = elementObj.RECONORDER_CNT;
    medRec.reconorder = '';
    for (wrkRPTDATA_idx = 0; wrkRPTDATA_idx < wrkRPTDATA_cnt; wrkRPTDATA_idx++) {
        wrkRPTDATA = elementObj.RECONORDERS[wrkRPTDATA_idx];

        medRec.reconorder += '<tr>';
        medRec.reconorder += '<td class="col-1">';
        medRec.reconorder += (wrkRPTDATA.RECON_DT) ? wrkRPTDATA.RECON_DT :'&nbsp;';
        medRec.reconorder += '</td><td class="col-2">';
        medRec.reconorder += (wrkRPTDATA.RECON_NAME) ? wrkRPTDATA.RECON_NAME :'&nbsp;';
        medRec.reconorder += '</td></tr>';
    }

    medRec.medrecTAval = elementObj.ADDTL_MEDS;
    if (elementObj.MEDREADY == 1) {
        medRec.MedrecRadNoChecked = '';
        medRec.MedrecRadYesChecked = 'checked';
    }



    //-------------------------------------
    //  CC DIV sections HTML generations ( TEMPLATE MERGE )
    //-------------------------------------
    compContent = chla.eApps.Funcs.parseTemplate( medRec_Tmpl.join('') ,medRec);

    //-------------------------------------
    //  CC DIV Rendering
    //-------------------------------------
    chla.eAppsUtil.Logger.LogWarn('<textarea rows="4" style="width:99%;">medrec </br>' + chla.eApps.Funcs.HtmlLogFormatter(compContent) + "</textarea>");
    target.innerHTML = compContent;

    //-------------------------------------
    //  CC HTML/CSS behaviours
    //-------------------------------------

    chla.medrec.eApps.SaveButtonAction('#medrecBtnSave', 'RESET') ;

    //=========================================================
    // Medrec  behaviours
    //=========================================================
    $('#MedrecRadyes').on( "click", function () {
        chla.medrec.eApps.SaveButtonAction('#medrecBtnSave', 'ENABLE') ;
    });

    $('#MedrecRadno').on( "click", function () {
        chla.medrec.eApps.SaveButtonAction('#medrecBtnSave', 'ENABLE') ;
    });

    $('#medrecTA').on( "click", function () {
        chla.medrec.eApps.SaveButtonAction('#medrecBtnSave', 'ENABLE') ;
    });

    chla.medrec.eApps.CSSBehaviors = new chla.eApps.CSSBehaviors();

    chla.medrec.eApps.HoverDataFormater =  function (sourceData) {
        var tempstr = '<span style="font-weight:bold;">Update History</span></br>';
        var tempstr1 = '', UMED_READY, UADDTL_MED_DETAILS;
        var dirty,dirty2, lencnt;
        lencnt = sourceData.UPDT_CNT ;
        for (var i = 0; i < lencnt; i ++) {
            dirty = false;
            dirty2 = true;
            tempstr1 = '';
            UMED_READY = sourceData.UPDT_LIST[i].UMED_READY ||'';
            UADDTL_MED_DETAILS = sourceData.UPDT_LIST[i].UADDTL_MED_DETAILS ||'';
            if( i ==(lencnt - 1)  ){
                if ( lencnt < 11){
                    if (UMED_READY!= null ){
                        tempstr1 =  '&nbsp;&nbsp; Discharge Prescriptions Written Update -' + (UMED_READY == 1 ? 'Yes' : 'No');
                        dirty = true;
                    }
                    if (UADDTL_MED_DETAILS.length > 0 ){
                        tempstr1 += '&nbsp;&nbsp; Medication Reconciliation Comments Update  -'  ;
                        dirty = true;
                    }
                }
                dirty2= false;
            }
            if (dirty2 == true){
                if (UMED_READY != sourceData.UPDT_LIST[i+1].UMED_READY ){
                    tempstr1 =  '&nbsp;&nbsp; Discharge Prescriptions Written Update -' + (UMED_READY == 1 ? 'Yes' : 'No');
                    dirty = true;
                }
                if (UADDTL_MED_DETAILS != sourceData.UPDT_LIST[i+1].UADDTL_MED_DETAILS ){
                    tempstr1 += '&nbsp;&nbsp; Medication Reconciliation Comments  Update  -'  ;
                    dirty = true;
                }
            }
            if (dirty == true){
                tempstr += sourceData.UPDT_LIST[i].UUPDT_MODBY_ID ;
                tempstr += ' on ';
                tempstr += sourceData.UPDT_LIST[i].UUPDTDATETIME ;
                tempstr += tempstr1;
                tempstr +=  "</br>" ;
            }
        };
        return tempstr ;
    };

    chla.medrec.eApps.CSSBehaviors.InitPopUpsDiv(
        chla.medrec.eApps.HoverDataFormater( elementObj), 'button#medrecBtnSave', 'T');

    chla.medrec.eApps.CCLreqObjSave = null;
    $("#medrecBtnSave").on( "click", function () {
        var medReady = 0,
            addtlMedDetails = "",
            wrkArr =[];
        medReady = ($('div#medrecformat input#MedrecRadyes').prop('checked')== true )? 1 : 0 ;
        //addtlMedDetails = ($("#medrecTA").val()!== "" )? $("#medrecTA").val(): '';
        wrkArr.push('^MINE^, value($VIS_Encntrid$),');
        wrkArr.push(medReady);
        wrkArr.push(',^');
        wrkArr.push($("#medrecTA").val());
        wrkArr.push('^, value($USR_PersonID$),^^');
        chla.medrec.eApps.CCLparmsSave = wrkArr.join('');
        if (chla.medrec.eApps.CCLreqObjSave == null){
            chla.medrec.eApps.CCLreqObjSave = new chla.eApps.CCLRequest.BtnSaveBehavior();
            chla.medrec.eApps.CCLreqObjSave.ObjectName='OBJ_chla.medrec.eApps.CCLreqObjSave';
            chla.medrec.eApps.CCLreqObjSave.BtnSaveBehaviorFunc = chla.medrec.eApps.SaveButtonAction ;

            chla.medrec.eApps.CCLreqObjSave.CallBackOperation = function(responseData){
                chla.medrec.eApps.CSSBehaviors.hoverContent =
                    chla.medrec.eApps.HoverDataFormater(responseData);
            };
        };
        chla.eAppsUtil.Logger.LogInfo('chla.medrec.eApps.CCLparmsSave: ' + chla.medrec.eApps.CCLparmsSave);
        chla.medrec.eApps.CCLreqObjSave.DataTransfer( chla.medrec.eApps.CCLreqObjSave,
            'chla_ca_mp_cc_ins_mdrec_json',
            chla.medrec.eApps.CCLparmsSave  ,
            'button#medrecBtnSave');
    });
};

//::===========================================================================
//:: CC - DC Patient Info
//::---------------------------------------------------------------------------
chla.dcptinfo = function () { };
chla.dcptinfo.prototype = new MPage.Component();
chla.dcptinfo.prototype.constructor = MPage.Component;
chla.dcptinfo.prototype.base = MPage.Component.prototype;
chla.dcptinfo.prototype.name = "chla.dcptinfo";
chla.dcptinfo.prototype.cclProgram = "chla_ca_mp_cc_dc_ptinfo_json";
chla.dcptinfo.prototype.cclParams = [];
chla.dcptinfo.prototype.cclDataType = "JSON";
chla.dcptinfo.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("encounterId");
};

chla.dcptinfo.prototype.render = function () {
    var component = this;
    var elementObj = component.data.RPTDATA;;
    var target = this.getTarget();
    var compContent;

    var pt_info = elementObj.PATIENT_INFO;
    var pmd_info = elementObj.PMD_INFO;
    var stories = elementObj.STORIES;
    var Reg_DT_TM_string, workDate;
    var ccc_polycom = "Not available";
    var wrkValue;
    var wrkTemp;
    var wrkResults = [];
    var wrkPrevValue;
    var wrkCnt, i,j ;
    //-------------------------------------
    //  CC - H5/H6  Management Section
    //-------------------------------------
    var CC_SectionManagement ={};

    CC_SectionManagement.pmdDetailH5Sec = new  chla.eApps.SectionHeader();
    CC_SectionManagement.pmdNotifyH5Sec = new  chla.eApps.SectionHeader();
    CC_SectionManagement.pmdOtherH5Sec  = new  chla.eApps.SectionHeader();

    //-------------------------------------
    // CC - DIV Template Data Object
    //-------------------------------------
    var dcptinfo = {
        cc_id: 'x',
        personId: 0,
        encounterId: 0,
        transparentSpacer:'',
        pmdDetailH5Section:'',
        pmdNotifyH5Section:'',
        pmdOtherH5Section:''
    } ;

    //-------------------------------------
    // Main CC - DIV Template
    //-------------------------------------
    var dcptinfo_Tmpl = [
        '<div id="<#=cc_id#>" class="eapps_CC">',
        '<#=pmdDetailH5Section#>',
        '<#=pmdNotifyH5Section#>',
        '<#=pmdOtherH5Section#>',
        '</div>'
    ]

    var pmdDetailSecData = {
        address: '' ,
        ptPHONE_NBR:'',
        ptLanguages: '' ,
        ptfamilyLanguages: '' ,
        attd_name: '' ,
        disch_attnd: '' ,
        ccc_Name: '' ,
        pmdNAME: '',
        pmdaddress: '',
        pmdPHONE_NBR: '' ,
        pmdFAX_NBR: '',
        pmdUpdt:''
    };

    var pmdNotifySecData = {
        'idLabel': 'pmdNotify',
        UPDT_ADMHSP_DTTM: '',
        UPDT_DISC_DTTM: '' ,
        UPDT_MODIF_BY: ''
    };


    var pmdNotifyOther = {
        'idLabel': 'pmdOther',
        pmdothertxt: '',
        closed: ''
    };

    var pmdDetailSecTmpl = [
        '<table id="pmdDetailSecData"><tr><td style="width:50%">Address</td>',
        '<td ><#=address#></td></tr><tr><td >Phone Number</td><td ><#=ptPHONE_NBR#></td>',
        '</tr><tr ><td >Patient Languages Spoken</td><td><#=ptLanguages#></td></tr><tr>',
        '<td >Primary Care Giver Languages Spoken</td><td><#=familyLanguages#></td>',
        '</tr><tr ><td >Attending Physician</td><td id="attd_name"><#=attd_name#></td></tr><tr ><td >Attending Physician at Discharge</td><td id="disch_attnd"><#=disch_attnd#></td></tr><tr ><td>CCC</td>',
        '<td id="cccNameNumber"><#=ccc_Name#></td></tr><tr ><td >Primary Medical Doctor (PMD)</td><td>',
        '<#=pmdNAME#><#=pmdaddress#><#=pmdPHONE_NBR#><#=pmdFAX_NBR#><#=pmdUpdt#><br/></td></tr></table><br/>',
        '<span class="unitsDC">Attending physician and PMD information can be updated in PM Conversation</span><br/>',
        '<span class="unitsDC">To add a PMD to PM Conversation or edit their info,',
        ' email details to &quot;HIMrequest&quot; in Outlook</span><br/>'
    ];
    var pmdNotifySecTmpl = [
        '<table><tr><td width="60%">Updated about admission/hospitalization on:</td><td>',
        '<input type="text" id="DC_PMD_datepicker1" value="<#=UPDT_ADMHSP_DTTM#>" > </td>',
        '</tr><tr><td width="60%"> Updated about discharge on: </td><td>',
        '<input type="text" id="DC_PMD_datepicker2" value="<#=UPDT_DISC_DTTM#>" ></td>',
        '</tr><tr><td width="60%">Last modified by:</td><td><span id="DC_PMD_Updtmod_By">',
        '<#=UPDT_MODIF_BY#></span></td></tr></table>',
        '<button id="PmdBtnSave" class="eappsBtnGrey">  Save</button></p><br>',
        '<p class="unitsDC">Auto-faxing of the H&P, OP reports, and DC summary is currently not available.</p>'
    ];


    var pmdNotifySecTmpl2 = [
        '<textarea id="PMDTA2" rows="5" style="width:95% ;margin-top:5px;margin-bottom:5px ;"><#=pmdothertxt#></textarea><br/>',
        '<button id="PmdBtnSave2" class="eappsBtnGrey">  Save</button>'
    ];

//-------------------------------------
//  Stanadard Common initializations
//-------------------------------------
    chla.dcptinfo.eApps = {};
    chla.dcptinfo.eApps.cc_id = chla.dcptinfo.prototype.name.replace('.','_');
    chla.dcptinfo.eApps.SaveButtonAction = chla.eApps.SaveButtonBehavior.enable_disable_status_reset;
    chla.dcptinfo.eApps.CSSBehaviors = new chla.eApps.CSSBehaviors();

    dcptinfo.cc_id = chla.dcptinfo.eApps.cc_id;
    dcptinfo.personId = this.getProperty("personId");
    dcptinfo.encounterId = this.getProperty("encounterId");
    dcptinfo.transparentSpacer = '<img src="' + chla.eApps.Vars.transparentSpacer + '" height="5px" width="17px"  >'

//-------------------------------------
//  RPTDATA processing
//-------------------------------------

    //Languages
    var patientLanguages = [];
    var pcgLanguages = [];

    for (i = 0; i < stories.length; i++) {
        var story = stories[i];
        var sentences = story.SENTENCES;

        for (j = 0; j < sentences.length; j++) {
            var sentence = sentences[j];
            var terms = sentence.TERMS;
            var sentenceArray = [];
            for (k = 0; k < terms.length; k++) {
                var term = sentence.TERMS[k].TERM_TEXT;
                sentenceArray.push(term);
            }
            if (sentenceArray.indexOf("**PCG Languages") !== -1) {
                pcgLanguages.push.apply(pcgLanguages, sentenceArray);
            } else if (sentenceArray.indexOf("**What is this language?") !== -1) {
                patientLanguages.push.apply(patientLanguages, sentenceArray);
            }
        }
    }
    //Remove questions
    var removeItem = "**PCG Languages";
    for (var i = pcgLanguages.length; i--;) {
        if (pcgLanguages[i] === removeItem) pcgLanguages.splice(i, 1);
    }

    var removeItem = "What is this language?";
    for (var i = pcgLanguages.length; i--;) {
        if (pcgLanguages[i] === removeItem) pcgLanguages.splice(i, 1);
    }

    var removeItem = "**What is this language?";
    for (var i = patientLanguages.length; i--;) {
        if (patientLanguages[i] === removeItem) patientLanguages.splice(i, 1);
    }

    var removeItem = "What is this language?";
    for (var i = patientLanguages.length; i--;) {
        if (patientLanguages[i] === removeItem) patientLanguages.splice(i, 1);
    }

    //Remove duplicates from the arrays
    function unique(list) {
        var result = [];
        $.each(list, function (i, e) {
            if ($.inArray(e, result) == -1) result.push(e);
        });
        return result;
    }

    patientLanguages = unique(patientLanguages);
    pcgLanguages = unique(pcgLanguages);

    //Convert to string and add spaces after commas
    patientLanguages = patientLanguages.toString();
    patientLanguages = patientLanguages.replace(/,/g, ", ");

    pcgLanguages = pcgLanguages.toString();
    pcgLanguages = pcgLanguages.replace(/,/g, ", ");


    pmdDetailSecData.cc_id = chla.dcptinfo.eApps.cc_id;
    pmdDetailSecData.attd_name = elementObj.ATTD_NAME;
    if (elementObj.ATTD_EXP_FLAG ==1)
        pmdDetailSecData.attd_name = "<span class='unitsDC'>" + elementObj.ATTD_NAME + "</span>";
    else
        pmdDetailSecData.attd_name = elementObj.ATTD_NAME;
    pmdDetailSecData.disch_attnd = elementObj.DISCH_ATTND;
    pmdDetailSecData.ccc_Name = elementObj.CCC_NAME;

    if ((pt_info.STREET_ADR).length > 0)
        pmdDetailSecData.address = pt_info.STREET_ADR;

    if ((pt_info.STREET_ADR2).length > 0)
        pmdDetailSecData.address += (", " + pt_info.STREET_ADR2);

    if ((pt_info.STREET_ADR3).length > 0)
        pmdDetailSecData.address += (", " + pt_info.STREET_ADR3);

    if ((pt_info.STREET_ADR4).length > 0)
        pmdDetailSecData.address += (", " + pt_info.STREET_ADR4);

    if ((pt_info.CITY).length > 0)
        pmdDetailSecData.address += (", " + pt_info.CITY);

    if ((pt_info.STATE).length > 0)
        pmdDetailSecData.address += (", " + pt_info.STATE);

    if ((pt_info.ZIP).length > 0)
        pmdDetailSecData.address += (" " + pt_info.ZIP);

    wrkCnt = elementObj.PATIENT_PHONE_CNT;
    if ( wrkCnt > 0 ){
        wrkPrevValue = '';
        wrkList = elementObj.PATIENT_PHONE;
        for (i = 0; i < wrkCnt; i++)
            if (wrkList[i].PHONE_TYPE == 'Home'){
                wrkValue = wrkList[i].PHONE_NBR.replace(/[ \-\(\)]/g,'');
                if(wrkValue.length == 10 && wrkValue != wrkPrevValue){
                    pmdDetailSecData.ptPHONE_NBR += wrkList[i].PHONE_TYPE + ': ' +
                        wrkValue.substring(0,3) + "-" +
                        wrkValue.substring(3,6) + "-" +
                        wrkValue.substring(6,10) + '<br/>'  ;
                }
                wrkPrevValue = wrkValue;
            }
    }
    pmdDetailSecData.ptLanguages = elementObj.PATIENT_LANG_CD;
    pmdDetailSecData.familyLanguages = elementObj.FAMILY_LANG_CD;

    pmdDetailSecData.pmdNAME = pmd_info.PMD_NAME + '<br/>';

    if ((pmd_info.STREET_ADR).length > 0)
        pmdDetailSecData.pmdaddress = pmd_info.STREET_ADR;

    if ((pmd_info.STREET_ADR2).length > 0)  {
        pmdDetailSecData.pmdaddress += ", ";
        pmdDetailSecData.pmdaddress +=  pmd_info.STREET_ADR2;
    }

    if ((pmd_info.STREET_ADR3).length > 0){
        pmdDetailSecData.pmdaddress += ", ";
        pmdDetailSecData.pmdaddress += pmd_info.STREET_ADR3;
    }

    if ((pmd_info.STREET_ADR4).length > 0){
        pmdDetailSecData.pmdaddress += ", ";
        pmdDetailSecData.pmdaddress += pmd_info.STREET_ADR4;
    }

    if ((pmd_info.CITY).length > 0){
        pmdDetailSecData.pmdaddress += ", ";
        pmdDetailSecData.pmdaddress += pmd_info.CITY;
    }

    if ((pmd_info.STATE).length > 0){
        pmdDetailSecData.pmdaddress += ", ";
        pmdDetailSecData.pmdaddress += pmd_info.STATE;
    }

    if ((pmd_info.ZIP).length > 0){
        pmdDetailSecData.pmdaddress += " ";
        pmdDetailSecData.pmdaddress += pmd_info.ZIP;
    }


    if (pmdDetailSecData.pmdaddress.length > 0){
        pmdDetailSecData.pmdaddress += "<br/>";
    }

    //",Business: (323)336-1211,Fax Business: 323-336-1800"
    if ((pmd_info.PHONE_NBR).length > 0){
        wrkList = pmd_info.PHONE_NBR.split(',');
        wrkList.shift();
        wrkResults.push('Business: ');
        wrkResults.push('0');
        wrkPrevValue = '';
        for (i=0,wrkCnt= wrkList.length; i < wrkCnt; i++){
            wrkValue = wrkList[i].split(':');
            wrkTemp = wrkValue[0] + ': ';
            wrkValue[0] = wrkTemp;
            wrkTemp = wrkValue[1].replace(/[ \-\(\)]/g,'');
            if(wrkTemp.length == 10 && wrkTemp != wrkPrevValue){
                wrkValue[1] = wrkTemp.substring(0,3) + "-" +
                    wrkTemp.substring(3,6) + "-" +
                    wrkTemp.substring(6,10) + '<br/>';
                //wrkList[0] = wrkValue.join('');
            }
            wrkPrevValue = wrkTemp;

            if (wrkValue[0] == 'Business: ' && wrkResults[1] == 0){
                wrkResults[1]= wrkValue[1];
            }
            else if (wrkValue[0] == 'Business: ' && wrkResults[1] != 0){
                wrkResults.push('Business Alt: ');
                wrkResults.push(wrkValue[1]);
            }
            else {
                wrkResults.push(wrkValue[0]);
                wrkResults.push(wrkValue[1]);
            }
        }
        if (wrkResults[1] == 0){
            wrkResults[0] = '';
            wrkResults[1] = '';
        }
        pmdDetailSecData.pmdPHONE_NBR = wrkResults.join('');
    }

    //----------------------------------
    //PMD Detail Section
    //PMD Notification Section

    if (elementObj.UPDT_CNT > 0 ) {
        if  (elementObj.UPDT_LIST[0].UPDT_ADMHSP_DTTM != undefined){
            pmdNotifySecData.UPDT_ADMHSP_DTTM = elementObj.UPDT_LIST[0].UPDT_ADMHSP_DTTM
        }
        if  (elementObj.UPDT_LIST[0].UPDT_DISC_DTTM != undefined){
            pmdNotifySecData.UPDT_DISC_DTTM = elementObj.UPDT_LIST[0].UPDT_DISC_DTTM
        }
        if  (elementObj.UPDT_LIST[0].UPDT_MODIF_BY!= undefined){
            pmdNotifySecData.UPDT_MODIF_BY = elementObj.UPDT_LIST[0].UPDT_MODIF_BY
        }
    }

	var faxData = "", edFax, edFaxDate, edFaxStatus, hpFax, hpFaxDate, hpFaxStatus, dcSummaryFax, dcSummaryFaxDate, dcSummaryFaxStatus, oprReportFax, oprReportFaxDate, oprReportFaxStatus ;
	var edTransmitStatus, hpTransmitStatus, dcTransmitStatus, oprTransmitStatus;

			hpFax = pmd_info.HP_NOTE_FAX.NAME;
			hpFaxDate = pmd_info.HP_NOTE_FAX.DATE;
			hpFaxStatus = pmd_info.HP_NOTE_FAX.STATUS;
			dcSummaryFax = pmd_info.DC_SUMMARY_FAX.NAME;
			dcSummaryFaxDate = pmd_info.DC_SUMMARY_FAX.DATE;
			dcSummaryFaxStatus = pmd_info.DC_SUMMARY_FAX.STATUS;
			oprReportFax = pmd_info.OPR_REPORT_FAX.NAME;
			oprReportFaxDate = pmd_info.OPR_REPORT_FAX.DATE;
			oprReportFaxStatus = pmd_info.OPR_REPORT_FAX.STATUS;

			// HP Fax
			faxData += '<tr>' ;
			faxData += '<td style="padding-left:3px; width:50px;"><img src="';
			faxData += chla.eApps.Vars.transparentSpacer;
			if (hpFaxStatus =="Autofax Successful")  {
				hpTransmitStatus = 'report_transmitted';
			} else if (hpFaxStatus =="Autofax Attempted and Failed") {
				hpTransmitStatus = 'report_error';
			} else {
				hpTransmitStatus = 'report_not_available';
				hpFaxDate = "N/A";
			}
			faxData += '" height="5px" width="20px" ><span class="'  ;
			faxData += hpTransmitStatus + '">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td>';
			faxData += hpFax + '</td><td >';
			faxData += hpFaxDate;
			faxData += '</td></tr>' ;

			// OP Report Fax
			faxData += '<tr>' ;
			faxData += '<td style="padding-left:3px; width:50px;"><img src="';
			faxData += chla.eApps.Vars.transparentSpacer;
			if (oprReportFaxStatus =="Autofax Successful")  {
				oprTransmitStatus = 'report_transmitted';
			} else if (oprReportFaxStatus =="Autofax Attempted and Failed") {
				oprTransmitStatus = 'report_error';
			} else {
				oprTransmitStatus = 'report_not_available';
				oprReportFaxDate = "N/A";
			}
			faxData += '" height="5px" width="20px" ><span class="'  ;
			faxData += oprTransmitStatus + '">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td>';
			faxData += oprReportFax + '</td><td >';
			faxData += oprReportFaxDate;
			faxData += '</td></tr>' ;


			// DC Summary Fax
			faxData += '<tr>' ;
			faxData += '<td style="padding-left:3px; width:50px;"><img src="';
			faxData += chla.eApps.Vars.transparentSpacer;
			if (dcSummaryFaxStatus =="Autofax Successful")  {
				dcTransmitStatus = 'report_transmitted';
			} else if (dcSummaryFaxStatus =="Autofax Attempted and Failed") {
				dcTransmitStatus = 'report_error';
			} else {
				dcTransmitStatus = 'report_not_available';
				dcSummaryFaxDate = "N/A";
			}
			faxData += '" height="5px" width="20px" ><span class="'  ;
			faxData += dcTransmitStatus + '">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td>';
			faxData += dcSummaryFax + '</td><td >';
			faxData += dcSummaryFaxDate;
			faxData += '</td></tr>' ;

    //PMD Other Notification Section
    pmdNotifyOther.pmdothertxt = elementObj.NOTEOTHER;

    //-------------------------------------
    dcptinfo.pmdDetailH5Section = chla.eApps.Funcs.parseTemplate( pmdDetailSecTmpl.join(''), pmdDetailSecData );


    //-------------------------------------
    SectionObj = CC_SectionManagement.pmdNotifyH5Sec;
    SectionObj.idLabel =  'pmdNotifyH5Sec';
    SectionObj.TLabel1 =  'PMD Notification & Autofax Status';
    SectionObj.SectionCnt = '';
    SectionObj.SectionClosed = '';
    SectionObj.Disabled_Lbl =  '';
    SectionObj.CustIcon = '';
    SectionObj.HideIfEmpty = 'false';
    SectionObj.ContentBody = chla.eApps.Funcs.parseTemplate( pmdNotifySecTmpl.join(''), pmdNotifySecData );
    /*SectionObj.ContentBody += '<br><table class="header"><tbody><thead><tr><th style="width:30%;color:grey"><img src="';
    SectionObj.ContentBody +=  chla.eApps.Vars.transparentSpacer
    SectionObj.ContentBody += '" height="5px" width="17px"  >';
    SectionObj.ContentBody += 'Autofax Status</th><th style="width:50%;color:grey">Report</th><th style="color:grey">Last Updated</th></thead></tr>';
	SectionObj.ContentBody +=  faxData  + '</tbody></table>';

	SectionObj.ContentBody += '<div style="text-align:left;"><img style="width: 350px;"  src="' + chla.global.imgPath +  'Autofax_Legend.jpg"/></div>';*/
	SectionObj.ContentBody += '<br><p class="unitsDC">HIM will manually fax these note types to the Primary MD (PMD) and Referring MD (RMD)';
	SectionObj.ContentBody += ' if there is a completed/signed Confirmation of PMD and Referring MD� form in the notes� section of the';
	SectionObj.ContentBody += ' patient\'s medical record. </p><br>';
    //SectionObj.ContentBody +=  SectionObj.UnformatBodyVal  + '</tbody></table>';
    dcptinfo.pmdNotifyH5Section = chla.eApps.Funcs.parseTemplate( chla.eApps.Vars.H5_Tmpl.join('') ,SectionObj);

    //-------------------------------------
    SectionObj = CC_SectionManagement.pmdOtherH5Sec;
    SectionObj.idLabel =  'pmdOtherH5Sec';
    SectionObj.TLabel1 =  'Other Physicians or Clinics Notified';
    SectionObj.SectionCnt = '';
    SectionObj.SectionClosed = '';
    if (elementObj.NOTEOTHER == "") {
        SectionObj.SectionClosed ="closed";
    }
    SectionObj.Disabled_Lbl = '';
    SectionObj.CustIcon = '';
    SectionObj.HideIfEmpty = 'false';
    SectionObj.ContentBody = chla.eApps.Funcs.parseTemplate( pmdNotifySecTmpl2.join(''), pmdNotifyOther);
    dcptinfo.pmdOtherH5Section = chla.eApps.Funcs.parseTemplate( chla.eApps.Vars.H5_Tmpl.join('') ,SectionObj);
    //chla.eAppsUtil.Logger.LogInfo('dcptinfo.pmdOtherH5Section: ' + chla.eApps.Funcs.HtmlLogFormatter(dcptinfo.pmdOtherH5Section ));
    //-------------------------------------
    compContent = chla.eApps.Funcs.parseTemplate( dcptinfo_Tmpl.join('') ,dcptinfo);

    //-------------------------------------
    //  CC DIV Rendering
    //-------------------------------------
    chla.eAppsUtil.Logger.LogWarn('<textarea rows="4" style="width:99%;">dcptinfo </br>' + chla.eApps.Funcs.HtmlLogFormatter(compContent) + "</textarea>");
    target.innerHTML = compContent;

    //-------------------------------------
    //  CC HTML/CSS behaviours
    //-------------------------------------
    chla.eAppsUtil.Logger.LogWarn( chla.eApps.Vars.ServerURL + chla.eApps.Vars.RLWebserviceURL +'/mPageService.svc/getContacts2ByNameFullFormattedJson_GET');
    //Look up contact numbers
    jQuery.support.cors = true;
    $.ajax({
        crossDomain: true,
        url:  chla.eApps.Vars.ServerURL + chla.eApps.Vars.RLWebserviceURL +'/mPageService.svc/getContacts2ByNameFullFormattedJson_GET',
        data: { 'namefullformatted': pmdDetailSecData.ccc_Name },
        success: function (result) {
            for (i = 0; i < result.length; i++) {
                var contacts = result[0].contacts;
                for (j = 0; j < contacts.length; j++) {
                    var contact = contacts[j];
                    var wrkStr;
                    if (contact.contact_type_code == 'PHONE') {
                        if (contact.contact_value != null) {
                            contact_num = "" ;
                            //chla.eAppsUtil.Logger.LogInfo('contact.contact_value: ' + contact.contact_value);
                            wrkStr = contact.contact_value.replace(/[ \-\(\)]/g,'');
                            if (wrkStr.length == 10){
                                contact_num += wrkStr.substring(0,3) ;
                                contact_num += "-";
                                contact_num += wrkStr.substring(3,6);
                                contact_num += "-";
                                contact_num += wrkStr.substring(6,10);

                            } else {
                                contact_num = wrkStr;
                            };
                            contact_desc = contact.contact_type_desc;
                            if (contact_desc!=null)
                                wrkStr = contact_desc;
                            contact_desc = wrkStr.substring(0,1).toUpperCase(); //  contact_desc.substring(0,1);
                            contact_desc += (wrkStr.substring(1)).toLowerCase();
                            contact_desc += ": ";

                        }
                        $('#cccNameNumber').append("<br/>" + contact_desc + contact_num );
                    }
                }
            }
        },
        error: function (xhr) {
            alert("An error occured: " + xhr.status + " " + xhr.statusText);
            chla.eAppsUtil.Logger.LogError("An error occured: " + xhr.status + " " + xhr.statusText);
        },
        dataType: "json"
    });


    Reg_DT_TM_string = chla.eApps.Funcs.convertDate(elementObj.REG_DT_TM);
    //chla.eAppsUtil.Logger.LogWarn('Reg_DT_TM_string ' + Reg_DT_TM_string);
    workDate = new Date();

    try
    {
        $('#DC_PMD_datepicker1').datepicker({
            minDate: new Date(Reg_DT_TM_string),
            maxDate: new Date(workDate.getFullYear(), workDate.getMonth() , workDate.getDate()),
            constrainInput: true,
            onSelect: function(){ chla.dcptinfo.eApps.SaveButtonAction('#PmdBtnSave', 'ENABLE') ;}
        });
        $('#DC_PMD_datepicker2').datepicker({
            minDate: new Date(Reg_DT_TM_string),
            maxDate: new Date(workDate.getFullYear(), workDate.getMonth() , workDate.getDate()),
            constrainInput: true,
            onSelect: function(){ chla.dcptinfo.eApps.SaveButtonAction('#PmdBtnSave', 'ENABLE') ;}
        });
    }
    catch(err)
    {
        chla.eAppsUtil.Logger.LogError(err.message);
    }

    chla.dcptinfo.eApps.HoverDataFormater =  function (sourceData) {
        var tempstr = '<span style="font-weight:bold;">Update History</span></br>';
        var tempstr1 ,admtdate , ddate;
        var dirty,dirty2,lencnt;
        lencnt = sourceData.UPDT_CNT > 10 ? sourceData.UPDT_CNT - 1 : sourceData.UPDT_CNT;
        for (var i = 0; i < lencnt; i ++) {
            dirty = false;
            dirty2 = true;
            tempstr1 = '';
            admtdate = sourceData.UPDT_LIST[i].UPDT_ADMHSP_DTTM || '';
            ddate = sourceData.UPDT_LIST[i].UPDT_DISC_DTTM || '';
            if( i ==(lencnt - 1)  ){
                if ( lencnt > 10){
                    dirty2 = false;
                } else {
                    dirty2 = false;
                    tempstr1 =  '&nbsp;&nbsp; Admission/Hospitalization Update -' + admtdate ;
                    tempstr1 += '&nbsp;&nbsp; Discharge Update  -' + ddate;
                    dirty = true;
                }
            }
            if (dirty2 == true){
                if (admtdate != sourceData.UPDT_LIST[i+1].UPDT_ADMHSP_DTTM ) {
                    if (admtdate.length > 0 ){
                        tempstr1 =  '&nbsp;&nbsp; Admission/Hospitalization Update -' + admtdate ;
                        dirty = true;
                    }
                }
                if (ddate != sourceData.UPDT_LIST[i+1].UPDT_DISC_DTTM ) {
                    if (ddate.length > 0 ){
                        tempstr1 += '&nbsp;&nbsp; Discharge Update  -' + ddate;
                        dirty = true;
                    }
                }
            }
            if (dirty == true){
                tempstr += sourceData.UPDT_LIST[i].UPDT_MODIF_BY ;
                tempstr += ' on ';
                tempstr += sourceData.UPDT_LIST[i].UPDT_DTTDM ;
                tempstr += tempstr1;
                tempstr +=  "</br>" ;
            }
        };
        return tempstr ;
    };

    chla.dcptinfo.eApps.CSSBehaviors.InitPopUpsDiv(chla.dcptinfo.eApps.HoverDataFormater(elementObj),
        'button#PmdBtnSave', 'R');

    chla.dcptinfo.eApps.CCLreqObjSave = null;
    $("#PmdBtnSave").on( "click", function () {
        chla.dcptinfo.eApps.CCLparmsSave = "^MINE^, value($VIS_Encntrid$),^^,^" ;
        chla.dcptinfo.eApps.CCLparmsSave += $("#DC_PMD_datepicker1").val() +"^,^^,^" ;
        chla.dcptinfo.eApps.CCLparmsSave += $("#DC_PMD_datepicker2").val() + "^,value($USR_PersonID$),1,^N^";

        if (chla.dcptinfo.eApps.CCLreqObjSave == null){
            chla.dcptinfo.eApps.CCLreqObjSave = new chla.eApps.CCLRequest.BtnSaveBehavior();
            chla.dcptinfo.eApps.CCLreqObjSave.ObjectName='OBJ_chla.dcptinfo.eApps.CCLreqObjSave';
            chla.dcptinfo.eApps.CCLreqObjSave.BtnSaveBehaviorFunc = chla.dcptinfo.eApps.SaveButtonAction ;

            chla.dcptinfo.eApps.CCLreqObjSave.CallBackOperation = function(responseData){
                $('#DC_PMD_Updtmod_By').text(' ');
                $('#DC_PMD_Updtmod_By').text(responseData.UPDT_LIST[0].UPDT_MODIF_BY);
                chla.dcptinfo.eApps.CSSBehaviors.hoverContent =
                    chla.dcptinfo.eApps.HoverDataFormater(responseData);
            };
        };
        chla.dcptinfo.eApps.CCLreqObjSave.DataTransfer( chla.dcptinfo.eApps.CCLreqObjSave,
            'CHLA_CA_MP_CC_DC_PMDINFO_JSON',
            chla.dcptinfo.eApps.CCLparmsSave  ,
            '#PmdBtnSave');
    });

    chla.dcptinfo.eApps.CSSBehaviors2 = new chla.eApps.CSSBehaviors();

    chla.dcptinfo.eApps.HoverDataFormater2 =  function (sourceData) {
        var tempstr = '<span style="font-weight:bold;">Update History</span></br>';
        var lencnt;
        lencnt = sourceData.UPDT_CNT2;
        for (var i = 0; i < lencnt; i ++) {
            tempstr += sourceData.UPDT_LIST2[i].UPDT_MODBY_ID ;
            tempstr += ' on ';
            tempstr += sourceData.UPDT_LIST2[i].UPDT_DTTDM ;
            tempstr +=  "</br>"
        }
        return tempstr;
    } ;

    chla.dcptinfo.eApps.CSSBehaviors2.InitPopUpsDiv(chla.dcptinfo.eApps.HoverDataFormater2(elementObj),
        'button#PmdBtnSave2', 'R');

    chla.dcptinfo.eApps.CSSBehaviors3 = new chla.eApps.CSSBehaviors();

    chla.dcptinfo.eApps.HoverDataFormater3 =  function (sourceData) {
        var tempstr = '<span style="font-weight:bold;">Patient<->Attending relationship expired on ' + sourceData.ATTD_END_EFFECTIVE_DT + '</span></br>';
        return tempstr;
    } ;

    var attdExprInd = elementObj.ATTD_EXP_FLAG
    if (attdExprInd == 1)
        chla.dcptinfo.eApps.CSSBehaviors3.InitPopUpsDiv(chla.dcptinfo.eApps.HoverDataFormater3(elementObj),
            'table#pmdDetailSecData tr td#attd_name', 'R');

    chla.dcptinfo.eApps.CCLreqObjSave2 = null;

    $("#PmdBtnSave2").on( "click", function () {
        chla.dcptinfo.eApps.CCLparmsSave2 = "^MINE^, value($VIS_Encntrid$),^" ;
        chla.dcptinfo.eApps.CCLparmsSave2 += $("#PMDTA2").val() +"^,value($USR_PersonID$)";

        if (chla.dcptinfo.eApps.CCLreqObjSave2 == null){
            chla.dcptinfo.eApps.CCLreqObjSave2 = new chla.eApps.CCLRequest.BtnSaveBehavior();
            chla.dcptinfo.eApps.CCLreqObjSave2.ObjectName='OBJ_chla.dcptinfo.eApps.CCLreqObjSave2';
            chla.dcptinfo.eApps.CCLreqObjSave2.BtnSaveBehaviorFunc = chla.dcptinfo.eApps.SaveButtonAction ;

//           chla.dcptinfo.eApps.CCLreqObjSave2.CallBackOperation = function(responseData){
//                                                    chla.dcptinfo.eApps.CSSBehaviors.hoverContent =
//                                                                              chla.dcptinfo.eApps.HoverDataFormater(responseData);
//                                                   };
        };
        chla.dcptinfo.eApps.CCLreqObjSave2.DataTransfer( chla.dcptinfo.eApps.CCLreqObjSave2,
            'chla_ca_mp_cc_insrt_pmdo_json',
            chla.dcptinfo.eApps.CCLparmsSave2  ,
            '#PmdBtnSave2');
    });


    chla.dcptinfo.eApps.SaveButtonAction('#PmdBtnSave', 'RESET') ;
    chla.dcptinfo.eApps.SaveButtonAction('#PmdBtnSave2', 'RESET') ;

    $('#PMDTA2').on( "click", function () {
        chla.dcptinfo.eApps.SaveButtonAction('#PmdBtnSave2', 'ENABLE') ;
    });


    //-------------------------------------
    //Section Collapse and Expand CSS behavior handles
    //-------------------------------------
    $('div#pmdNotifyH5Sec_DivSubSec H2.h5a-marker').on( "click",chla.dcptinfo.eApps.CSSBehaviors.SingleH5SectionToggle) ;


    $('div#pmdOtherH5Sec_DivSubSec H2.h5a-marker').on( "click",chla.dcptinfo.eApps.CSSBehaviors.SingleH5SectionToggle) ;

};

//::===========================================================================
//:: CC - Learning
//::---------------------------------------------------------------------------
chla.learning = function () { };
chla.learning.prototype = new MPage.Component();
chla.learning.prototype.constructor = MPage.Component;
chla.learning.prototype.base = MPage.Component.prototype;
chla.learning.prototype.name = "chla.learning";
chla.learning.prototype.cclProgram = "chla_ca_mp_cc_learning_json";
chla.learning.prototype.cclParams = [];
chla.learning.prototype.cclDataType = "JSON";
chla.learning.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("encounterId");
    this.cclParams[2] = this.getProperty("personId");
};
chla.learning.prototype.render = function () {
    var component = this;
    var elementObj  =  component.data.RPTDATA;
    var target = this.getTarget();
    var compContent;
    var arrWrk;
    var eventId, learningComplete,learningTitle, sentence;
    //-------------------------------------
    //  Common Used Variable Names for RPTDATA processing
    //-------------------------------------
    var i, j , k ;             // common for loop values
    var SectionObj,            // CC_SectionManagement
        // variables to hold RPTData values
        wrkRPTDATA_cnt,
        wrkRPTDATA,
        wrkRPTDATA_idx,
        wrkCnt,
        wrkValue,
        wrkDesc,
        wrkList,
        wrkPrevValue,
        wrkResults,
        wrkResults_cnt;

    var listLen,
        listLen2;
    //NOTE:: numbers used to denote the code hierarchy depth variable is used at.
    //NOTE:: i.e. inside for, while, if command statement

    //-------------------------------------
    //  CC - H5/H6  Management Section
    //-------------------------------------
    var CC_SectionManagement ={};

    CC_SectionManagement.ordersH5Sec = new  chla.eApps.SectionHeader();
    CC_SectionManagement.powerNtsH5Sec = new  chla.eApps.SectionHeader();

    CC_SectionManagement.ordersH5Sec.UnformatBodyVal = '';
    CC_SectionManagement.powerNtsH5Sec.UnformatBodyVal = '';

    //-------------------------------------
    // CC - DIV Template Data Object
    //-------------------------------------

    var learning = {
        cc_id : '',
        personId :0,
        encounterId : 0,
        powerFormLinkParams : '',
        notes : 0 ,
        orders : 0,
        ordersH5Section: '',
        powerNtsH5Section: ''
    }
    var learning_Tmpl = [
        '<div id="<#=cc_id#>" class="eapps_CC">',
        '<p><a href="javascript:MPAGES_EVENT(<#=powerFormLinkParams#>)">Click to launch Learning Care Needs Assessment PowerForm</a></p>',
        '<#=ordersH5Section#><#=powerNtsH5Section#></div>'
    ]

//-------------------------------------
//  Stanadard Common initializations
//-------------------------------------

    chla.learning.eApps = {};
    chla.learning.eApps.cc_id = chla.learning.prototype.name.replace('.','_');
    chla.learning.eApps.SaveButtonAction = chla.eApps.SaveButtonBehavior.enable_disable_status_reset;
    chla.learning.eApps.CSSBehaviors = new chla.eApps.CSSBehaviors();
    chla.learning.eApps.CSSBehaviors.name = "chla.learning.eApps.CSSBehaviors";

    learning.cc_id = chla.learning.eApps.cc_id;
    learning.personId = this.getProperty("personId");
    learning.encounterId = this.getProperty("encounterId");
    learning.transparentSpacer = '<img src="' + chla.eApps.Vars.transparentSpacer + '" height="5px" width="17px"  >'
    //learning.powerFormLinkParams = '&quot;POWERFORM&quot;,&quot;' +
    //    learning.personId  + '|' + learning.encounterId  +
    //    '|397861197|0|0&quot;';

	learning.powerFormLinkParams = '&quot;POWERFORM&quot;,&quot;' +
       learning.personId  + '|' + learning.encounterId  +
       '|500756967|0|0&quot;';

//-------------------------------------
//  RPTDATA processing
//-------------------------------------

    //-------------------------------------------------------------------------
    //Orders
    //-------------------------------------------------------------------------

    CC_SectionManagement.ordersH5Sec.SectionCntVal = elementObj.ORDER_CNT ;
    wrkRPTDATA_cnt = elementObj.ORDER_CNT;
    if (wrkRPTDATA_cnt > 0) {
        wrkResults = '';
        for ( wrkRPTDATA_idx = 0; wrkRPTDATA_idx < wrkRPTDATA_cnt; wrkRPTDATA_idx++) {
            wrkRPTDATA = elementObj.ORDERS[wrkRPTDATA_idx];
            arrWrk = wrkRPTDATA.CLINICAL_DISPLAY_LINE.split(':');
            arrWrk.pop();
            wrkResults  += '<tr>';
            wrkResults  += '<td style="width:60%"><img src="';
            wrkResults  += chla.eApps.Vars.transparentSpacer;
            wrkResults  += '" height="5px" width="20px"  >';
            wrkResults  += wrkRPTDATA.ORDER_MNEMONIC;
            wrkResults  += '</td><td style="width:25%">';
            wrkResults  +=  arrWrk.join(':');     //wrkRPTDATA.CLINICAL_DISPLAY_LINE;
            wrkResults  += '</td><td>';
            wrkResults  += wrkRPTDATA.ORDER_STATUS;
            wrkResults  += '</td></tr>' ;
        }
        CC_SectionManagement.ordersH5Sec.UnformatBodyVal =  wrkResults;
    }
    //-------------------------------------------------------------------------
    //PowerNotes
    //-------------------------------------------------------------------------
    wrkResults_cnt = elementObj.EDUCATION_FORMS_CNT;
    var eduPFormLinkParams;
    wrkResults = '';
    var eventTag;

    wrkRPTDATA_cnt =  elementObj.STORY_CNT ;

    if (wrkRPTDATA_cnt > 0) {
        wrkResults = '';
        for ( wrkRPTDATA_idx = 0; wrkRPTDATA_idx < wrkRPTDATA_cnt ; wrkRPTDATA_idx++) {

            wrkRPTDATA = elementObj.STORIES[wrkRPTDATA_idx];
            eventId = wrkRPTDATA.EVENT_ID;
            eventTag = wrkRPTDATA.STORY_EVENT_TAG;

            if (eventTag != "In Error") {
                learningComplete = 'learning_incomplete';
                learningTitle = 'Undefined';
                listLen =   wrkRPTDATA.SENTENCE_CNT;

                if (wrkRPTDATA.NOTETYPE_CD == chla.eApps.Vars.educationnote_cd ) {

                    for (i = 0 ; i < listLen ; i++)     {
                        sentence = wrkRPTDATA.SENTENCES[i];
                        if (sentence.TERM_CNT == 3 && sentence.TERMS[2].TERM_ID == 4622778){
                            if(sentence.TERMS[2].TERM_TEXT.length > 0){
                                learningTitle = sentence.TERMS[2].TERM_TEXT;
                                learning.notes += 1;
                            }
                        }

                        if (sentence.TERM_CNT == 3 && sentence.TERMS[2].TERM_ID == 4622803){
                            learningComplete = 'learning_complete';
                        }

                    }

                    wrkResults += '<tr>' ;
                    wrkResults += '<td style="padding-left:3px; width:50px;"><img src="';
                    wrkResults += chla.eApps.Vars.transparentSpacer;
                    wrkResults += '" height="5px" width="20px" ><span class="'  ;
                    wrkResults += learningComplete + '" style="color: transparent; font-size: 14px;">MM</span></td><td>';

                    wrkResults += '<a href="javascript:APPLINK(' +
                        '0,&quot;Powerchart.exe&quot;,&quot;' +
                        ' /PERSONID=' +  learning.personId +
                        ' /ENCNTRID=' +  learning.encounterId +
                        ' /FIRSTTAB=^PowerNote^&quot;)">';

                    wrkResults += learningTitle ;
                    wrkResults += '</a>';
                    wrkResults += '</td><td >';
                    wrkResults += wrkRPTDATA.STORY_UPDT_DT_TM;
                    wrkResults += '</td></tr>' ;
                    wrkResults_cnt += 1;

                }


                if (wrkRPTDATA.TITLE == "Admission Education Note")    {
                    learningTitle =  "Admission Education Note";
                    for (i = 0 ; i < listLen ; i++)     {
                        sentence = wrkRPTDATA.SENTENCES[i];
                        for (j=0; j<sentence.TERM_CNT; j++ )      {
                            if (sentence.TERMS[j].TERM_ID == 3721501.00){
                                learningComplete = 'learning_complete';
                            }
                        } //for
                    } //for


                    wrkResults += '<tr>' ;
                    wrkResults += '<td style="padding-left:3px; width:50px;"><img src="';
                    wrkResults += chla.eApps.Vars.transparentSpacer;
                    wrkResults += '" height="5px" width="20px" ><span class="'  ;
                    wrkResults += learningComplete + '" style="color: transparent; font-size: 14px;">MM</span></td><td>';

                    wrkResults += '<a href="javascript:APPLINK(' +
                        '0,&quot;Powerchart.exe&quot;,&quot;' +
                        ' /PERSONID=' +  learning.personId +
                        ' /ENCNTRID=' +  learning.encounterId +
                        ' /FIRSTTAB=^PowerNote^&quot;)">';

                    wrkResults += learningTitle ;
                    wrkResults += '</a>';
                    wrkResults += '</td><td >';
                    wrkResults += wrkRPTDATA.STORY_UPDT_DT_TM;
                    wrkResults += '</td></tr>' ;
                    wrkResults_cnt += 1;

                }


                if (wrkRPTDATA.TITLE == "Alternate Education Note")    {
                    learningTitle =  "Alternate Education Note";
                    var skillEvaluation = '';
                    var knowEvaluation = '';
                    for (i = 0 ; i < listLen ; i++)     {
                        sentence = wrkRPTDATA.SENTENCES[i];
                        knowEvaluation = '';
                        skillEvaluation = '';
                        knowSatisfactory = '';
                        skillSatisfactory = '';

                        for (j=0; j<sentence.TERM_CNT; j++ )      {

                            if (sentence.TERMS[j].TERM_ID ==  6887185.00) {
                                knowEvaluation="Y";
                            }
                            if (sentence.TERMS[j].TERM_ID ==  6887188.00) {
                                skillEvaluation="Y";
                            }
                            if (sentence.TERMS[j].TERM_ID ==  6887186.00) {
                                knowSatisfactory="Y";
                            }
                            if (sentence.TERMS[j].TERM_ID ==  6887189.00) {
                                skillSatisfactory="Y";
                            }
                        }

                        if ( knowSatisfactory && skillEvaluation!="Y") {
                            learningComplete = 'learning_complete';
                        } else if (skillSatisfactory && knowEvaluation!="Y"){
                            learningComplete = 'learning_complete';
                        } else if ( knowSatisfactory && skillSatisfactory) {
                            learningComplete = 'learning_complete';
                        }

                    } //for


                    wrkResults += '<tr>' ;
                    wrkResults += '<td style="padding-left:3px; width:50px;"><img src="';
                    wrkResults += chla.eApps.Vars.transparentSpacer;
                    wrkResults += '" height="5px" width="20px" ><span class="'  ;
                    wrkResults += learningComplete + '" style="color: transparent; font-size: 14px;">MM</span></td><td>';

                    wrkResults += '<a href="javascript:APPLINK(' +
                        '0,&quot;Powerchart.exe&quot;,&quot;' +
                        ' /PERSONID=' +  learning.personId +
                        ' /ENCNTRID=' +  learning.encounterId +
                        ' /FIRSTTAB=^PowerNote^&quot;)">';

                    wrkResults += learningTitle ;
                    wrkResults += '</a>';
                    wrkResults += '</td><td >';
                    wrkResults += wrkRPTDATA.STORY_UPDT_DT_TM;
                    wrkResults += '</td></tr>' ;
                    wrkResults_cnt += 1;

                }
            }
        }

        CC_SectionManagement.powerNtsH5Sec.SectionCntVal = wrkResults_cnt;
        CC_SectionManagement.powerNtsH5Sec.UnformatBodyVal =  wrkResults;
    }

    var asthmaEducation = elementObj.ASTHMA_EDUCATION;
    var asthmaLearnerReady = asthmaEducation.LEARNER_READY;

    if (asthmaEducation.ASTHMA_EDUCATION_DT_TM !="") {
        learningComplete = 'learning_incomplete';
        if (asthmaLearnerReady!="" ) {
            if (asthmaLearnerReady.indexOf("Yes") > -1){
                learningComplete = 'learning_complete';
            }
        }

        wrkResults += '<tr>' ;
        wrkResults += '<td style="padding-left:3px; width:50px;"><img src="';
        wrkResults += chla.eApps.Vars.transparentSpacer;
        wrkResults += '" height="5px" width="20px" ><span class="'  ;
        wrkResults += learningComplete + '" style="color: transparent; font-size: 14px;">MM</span></td><td>';

        eduPFormLinkParams = '&quot;POWERFORM&quot;,&quot;' +
            learning.personId  + '|' + asthmaEducation.PFORM_ENCNTR_ID  +
            '|416589437|' + asthmaEducation.PFORM_ACTIVITY_ID + '|0&quot;';
        wrkResults +='<a href="javascript:MPAGES_EVENT(' + eduPFormLinkParams + ')">' + asthmaEducation.PFORM_DESCRIPTION + ' </a>';
        wrkResults += '</td><td >';
        wrkResults += asthmaEducation.PFORM_SIGNED_DATE;
        wrkResults += '</td></tr>' ;
    }

	var bodyImageEducation = elementObj.BODY_IMAGE_EDUCATION;
    var bodyImageLearnerReady = bodyImageEducation.LEARNER_READY;

    if (bodyImageEducation.EDUCATION_DT_TM !="") {
        learningComplete = 'learning_incomplete';
        if (bodyImageLearnerReady!="" ) {
            if (bodyImageLearnerReady.indexOf("Yes") > -1){
                learningComplete = 'learning_complete';
            }
        }

        wrkResults += '<tr>' ;
        wrkResults += '<td style="padding-left:3px; width:50px;"><img src="';
        wrkResults += chla.eApps.Vars.transparentSpacer;
        wrkResults += '" height="5px" width="20px" ><span class="'  ;
        wrkResults += learningComplete + '" style="color: transparent; font-size: 14px;">MM</span></td><td>';;

        eduPFormLinkParams = '&quot;POWERFORM&quot;,&quot;' +
            learning.personId  + '|' + bodyImageEducation.PFORM_ENCNTR_ID  +
            '|1021164461.00|' + bodyImageEducation.PFORM_ACTIVITY_ID + '|0&quot;';
        wrkResults +='<a href="javascript:MPAGES_EVENT(' + eduPFormLinkParams + ')">' + bodyImageEducation.PFORM_DESCRIPTION + ' </a>';
        wrkResults += '</td><td >';
        wrkResults += bodyImageEducation.PFORM_SIGNED_DATE;
        wrkResults += '</td></tr>' ;
    }

	var brainInjuryEducation = elementObj.BRAIN_INJURY_EDUCATION;
    var brainInjuryLearnerReady = brainInjuryEducation.LEARNER_READY;

    if (brainInjuryEducation.EDUCATION_DT_TM !="") {
        learningComplete = 'learning_incomplete';
        if (brainInjuryLearnerReady!="" ) {
            if (brainInjuryLearnerReady.indexOf("Yes") > -1){
                learningComplete = 'learning_complete';
            }
        }

        wrkResults += '<tr>' ;
        wrkResults += '<td style="padding-left:3px; width:50px;"><img src="';
        wrkResults += chla.eApps.Vars.transparentSpacer;
        wrkResults += '" height="5px" width="20px" ><span class="'  ;
        wrkResults += learningComplete + '" style="color: transparent; font-size: 14px;">MM</span></td><td>';

        eduPFormLinkParams = '&quot;POWERFORM&quot;,&quot;' +
            learning.personId  + '|' + brainInjuryEducation.PFORM_ENCNTR_ID  +
            '|1021179537|' + brainInjuryEducation.PFORM_ACTIVITY_ID + '|0&quot;';
        wrkResults +='<a href="javascript:MPAGES_EVENT(' + eduPFormLinkParams + ')">' + brainInjuryEducation.PFORM_DESCRIPTION + ' </a>';
        wrkResults += '</td><td >';
        wrkResults += brainInjuryEducation.PFORM_SIGNED_DATE;
        wrkResults += '</td></tr>' ;
    }

    var cardiacChildEducation = elementObj.CARDIAC_CHILD_EDUCATION;
    var cardiacChildLearnerReady = cardiacChildEducation.LEARNER_READY;

    if (cardiacChildEducation.CARDIAC_CHILD_EDUCATION_DT_TM !="") {
        learningComplete = 'learning_incomplete';
        if (cardiacChildLearnerReady!="" ) {
            if (cardiacChildLearnerReady.indexOf("Yes") > -1){
                learningComplete = 'learning_complete';
            }
        }

        wrkResults += '<tr>' ;
        wrkResults += '<td style="padding-left:3px; width:50px;"><img src="';
        wrkResults += chla.eApps.Vars.transparentSpacer;
        wrkResults += '" height="5px" width="20px" ><span class="'  ;
        wrkResults += learningComplete + '" style="color: transparent; font-size: 14px;">MM</span></td><td>';

        eduPFormLinkParams = '&quot;POWERFORM&quot;,&quot;' +
            learning.personId  + '|' + cardiacChildEducation.PFORM_ENCNTR_ID  +
            '|638011583|' + cardiacChildEducation.PFORM_ACTIVITY_ID + '|0&quot;';
        wrkResults +='<a href="javascript:MPAGES_EVENT(' + eduPFormLinkParams + ')">' + cardiacChildEducation.PFORM_DESCRIPTION + ' </a>';
        wrkResults += '</td><td >';
        wrkResults += cardiacChildEducation.PFORM_SIGNED_DATE;
        wrkResults += '</td></tr>' ;
    }

    var cardiacInfantEducation = elementObj.CARDIAC_INFANT_EDUCATION;
    var cardiacInfantLearnerReady = cardiacInfantEducation.LEARNER_READY;

    if (cardiacInfantEducation.CARDIAC_INFANT_EDUCATION_DT_TM !="") {
        learningComplete = 'learning_incomplete';
        if (cardiacInfantLearnerReady!="" ) {
            if (cardiacInfantLearnerReady.indexOf("Yes") > -1){
                learningComplete = 'learning_complete';
            }
        }

        wrkResults += '<tr>' ;
        wrkResults += '<td style="padding-left:3px; width:50px;"><img src="';
        wrkResults += chla.eApps.Vars.transparentSpacer;
        wrkResults += '" height="5px" width="20px" ><span class="'  ;
        wrkResults += learningComplete + '" style="color: transparent; font-size: 14px;">MM</span></td><td>';

        eduPFormLinkParams = '&quot;POWERFORM&quot;,&quot;' +
            learning.personId  + '|' + cardiacInfantEducation.PFORM_ENCNTR_ID  +
            '|638009065|' + cardiacInfantEducation.PFORM_ACTIVITY_ID + '|0&quot;';
        wrkResults +='<a href="javascript:MPAGES_EVENT(' + eduPFormLinkParams + ')">' + cardiacInfantEducation.PFORM_DESCRIPTION + ' </a>';
        wrkResults += '</td><td >';
        wrkResults += cardiacInfantEducation.PFORM_SIGNED_DATE;
        wrkResults += '</td></tr>' ;
    }


    var castSplintEducation = elementObj.CAST_SPLINT_EDUCATION;
    var castSplintLearnerReady = castSplintEducation.LEARNER_READY;

    if (castSplintEducation.CAST_SPLINT_EDUCATION_DT_TM !="") {
        learningComplete = 'learning_incomplete';
        if (castSplintLearnerReady!="" ) {
            if (castSplintLearnerReady.indexOf("Yes") > -1){
                learningComplete = 'learning_complete';
            }
        }

        wrkResults += '<tr>' ;
        wrkResults += '<td style="padding-left:3px; width:50px;"><img src="';
        wrkResults += chla.eApps.Vars.transparentSpacer;
        wrkResults += '" height="5px" width="20px" ><span class="'  ;
        wrkResults += learningComplete + '" style="color: transparent; font-size: 14px;">MM</span></td><td>';

        eduPFormLinkParams = '&quot;POWERFORM&quot;,&quot;' +
            learning.personId  + '|' + castSplintEducation.PFORM_ENCNTR_ID  +
            '|417095609|' + castSplintEducation.PFORM_ACTIVITY_ID + '|0&quot;';
        wrkResults +='<a href="javascript:MPAGES_EVENT(' + eduPFormLinkParams + ')">' + castSplintEducation.PFORM_DESCRIPTION + ' </a>';
        wrkResults += '</td><td >';
        wrkResults += castSplintEducation.PFORM_SIGNED_DATE;
        wrkResults += '</td></tr>' ;
    }

    var centralLineEducation = elementObj.CENTRAL_LINE_EDUCATION;
    var centralLineLearnerReady = centralLineEducation.LEARNER_READY;

    if (centralLineEducation.CENTRAL_LINE_EDUCATION_DT_TM !="") {
        learningComplete = 'learning_incomplete';
        if (centralLineLearnerReady!="" ) {
            if (centralLineLearnerReady.indexOf("Yes") > -1){
                learningComplete = 'learning_complete';
            }
        }

        wrkResults += '<tr>' ;
        wrkResults += '<td style="padding-left:3px; width:50px;"><img src="';
        wrkResults += chla.eApps.Vars.transparentSpacer;
        wrkResults += '" height="5px" width="20px" ><span class="'  ;
        wrkResults += learningComplete + '" style="color: transparent; font-size: 14px;">MM</span></td><td>';

        eduPFormLinkParams = '&quot;POWERFORM&quot;,&quot;' +
            learning.personId  + '|' + centralLineEducation.PFORM_ENCNTR_ID  +
            '|415630465|' + centralLineEducation.PFORM_ACTIVITY_ID + '|0&quot;';
        wrkResults +='<a href="javascript:MPAGES_EVENT(' + eduPFormLinkParams + ')">' + centralLineEducation.PFORM_DESCRIPTION + ' </a>';
        wrkResults += '</td><td >';
        wrkResults += centralLineEducation.PFORM_SIGNED_DATE;
        wrkResults += '</td></tr>' ;
    }

    var cprEducation = elementObj.CPR_EDUCATION;
    var cprLearnerReady = cprEducation.LEARNER_READY;

    if (cprEducation.CPR_EDUCATION_DT_TM !="") {
        learningComplete = 'learning_incomplete';
        if (cprLearnerReady!="" ) {
            if (cprLearnerReady.indexOf("Yes") > -1){
                learningComplete = 'learning_complete';
            }
        }

        wrkResults += '<tr>' ;
        wrkResults += '<td style="padding-left:3px; width:50px;"><img src="';
        wrkResults += chla.eApps.Vars.transparentSpacer;
        wrkResults += '" height="5px" width="20px" ><span class="'  ;
        wrkResults += learningComplete + '" style="color: transparent; font-size: 14px;">MM</span></td><td>';

        eduPFormLinkParams = '&quot;POWERFORM&quot;,&quot;' +
            learning.personId  + '|' + cprEducation.PFORM_ENCNTR_ID  +
            '|414366201|' + cprEducation.PFORM_ACTIVITY_ID + '|0&quot;';
        wrkResults +='<a href="javascript:MPAGES_EVENT(' + eduPFormLinkParams + ')">' + cprEducation.PFORM_DESCRIPTION + ' </a>';
        wrkResults += '</td><td >';
        wrkResults += cprEducation.PFORM_SIGNED_DATE;
        wrkResults += '</td></tr>' ;
    }

	var diabetesClassEducation = elementObj.DIABETES_CLASS_EDUCATION;
    var diabetesClassLearnerReady = diabetesClassEducation.LEARNER_READY;

    if (diabetesClassEducation.EDUCATION_DT_TM !="") {
        learningComplete = 'learning_incomplete';
        if (diabetesClassLearnerReady!="" ) {
            if (diabetesClassLearnerReady.indexOf("Yes") > -1){
                learningComplete = 'learning_complete';
            }
        }

        wrkResults += '<tr>' ;
        wrkResults += '<td style="padding-left:3px; width:50px;"><img src="';
        wrkResults += chla.eApps.Vars.transparentSpacer;
        wrkResults += '" height="5px" width="20px" ><span class="'  ;
        wrkResults += learningComplete + '" style="color: transparent; font-size: 14px;">MM</span></td><td>';

        eduPFormLinkParams = '&quot;POWERFORM&quot;,&quot;' +
            learning.personId  + '|' + diabetesClassEducation.PFORM_ENCNTR_ID  +
            '|386306669|' + diabetesClassEducation.PFORM_ACTIVITY_ID + '|0&quot;';
        wrkResults +='<a href="javascript:MPAGES_EVENT(' + eduPFormLinkParams + ')">' + diabetesClassEducation.PFORM_DESCRIPTION + ' </a>';
        wrkResults += '</td><td >';
        wrkResults += diabetesClassEducation.PFORM_SIGNED_DATE;
        wrkResults += '</td></tr>' ;
    }

    var diabetesHomecareEducation = elementObj.DIABETES_HC_EDUCATION;
    var diabetesHomeCareLearnerReady = diabetesHomecareEducation.LEARNER_READY;

    if (diabetesHomecareEducation.DIABETES_HC_EDUCATION_DT_TM !="") {
        learningComplete = 'learning_incomplete';
        if (diabetesHomeCareLearnerReady!="" ) {
            if (diabetesHomeCareLearnerReady.indexOf("Yes") > -1){
                learningComplete = 'learning_complete';
            }
        }

        wrkResults += '<tr>' ;
        wrkResults += '<td style="padding-left:3px; width:50px;"><img src="';
        wrkResults += chla.eApps.Vars.transparentSpacer;
        wrkResults += '" height="5px" width="20px" ><span class="'  ;
        wrkResults += learningComplete + '" style="color: transparent; font-size: 14px;">MM</span></td><td>';

        eduPFormLinkParams = '&quot;POWERFORM&quot;,&quot;' +
            learning.personId  + '|' + diabetesHomecareEducation.PFORM_ENCNTR_ID  +
            '|668831001|' + diabetesHomecareEducation.PFORM_ACTIVITY_ID + '|0&quot;';
        wrkResults +='<a href="javascript:MPAGES_EVENT(' + eduPFormLinkParams + ')">' + diabetesHomecareEducation.PFORM_DESCRIPTION + ' </a>';
        wrkResults += '</td><td >';
        wrkResults += diabetesHomecareEducation.PFORM_SIGNED_DATE;
        wrkResults += '</td></tr>' ;
    }

    var  feedSwallowEducation = elementObj.FEEDING_SWALLOWING_SAFETY_EDUCATION;
    var feedSwallowLearnerReady = feedSwallowEducation.LEARNER_READY;

    if (feedSwallowEducation.FEEDING_SWALLOWING_SAFETY_EDUCATION_DT_TM !="") {
        learningComplete = 'learning_incomplete';
        if (feedSwallowLearnerReady!="" ) {
            if (feedSwallowLearnerReady.indexOf("Yes") > -1){
                learningComplete = 'learning_complete';
            }
        }

        wrkResults += '<tr>' ;
        wrkResults += '<td style="padding-left:3px; width:50px;"><img src="';
        wrkResults += chla.eApps.Vars.transparentSpacer;
        wrkResults += '" height="5px" width="20px" ><span class="'  ;
        wrkResults += learningComplete + '" style="color: transparent; font-size: 14px;">MM</span></td><td>';

        eduPFormLinkParams = '&quot;POWERFORM&quot;,&quot;' +
            learning.personId  + '|' + feedSwallowEducation.PFORM_ENCNTR_ID  +
            '|417112193|' + feedSwallowEducation.PFORM_ACTIVITY_ID + '|0&quot;';
        wrkResults +='<a href="javascript:MPAGES_EVENT(' + eduPFormLinkParams + ')">' + feedSwallowEducation.PFORM_DESCRIPTION + ' </a>';
        wrkResults += '</td><td >';
        wrkResults += feedSwallowEducation.PFORM_SIGNED_DATE;
        wrkResults += '</td></tr>' ;
    }

	var gaitEducation = elementObj.GAIT_EDUCATION;
    var gaitLearnerReady = gaitEducation.LEARNER_READY;

    if (gaitEducation.EDUCATION_DT_TM !="") {
        learningComplete = 'learning_incomplete';
        if (gaitLearnerReady!="" ) {
            if (gaitLearnerReady.indexOf("Yes") > -1){
                learningComplete = 'learning_complete';
            }
        }

        wrkResults += '<tr>' ;
        wrkResults += '<td style="padding-left:3px; width:50px;"><img src="';
        wrkResults += chla.eApps.Vars.transparentSpacer;
        wrkResults += '" height="5px" width="20px" ><span class="'  ;
        wrkResults += learningComplete + '" style="color: transparent; font-size: 14px;">MM</span></td><td>';

        eduPFormLinkParams = '&quot;POWERFORM&quot;,&quot;' +
            learning.personId  + '|' + gaitEducation.PFORM_ENCNTR_ID  +
            '|1091737569|' + gaitEducation.PFORM_ACTIVITY_ID + '|0&quot;';
        wrkResults +='<a href="javascript:MPAGES_EVENT(' + eduPFormLinkParams + ')">' + gaitEducation.PFORM_DESCRIPTION + ' </a>';
        wrkResults += '</td><td >';
        wrkResults += gaitEducation.PFORM_SIGNED_DATE;
        wrkResults += '</td></tr>' ;
    }

    var gtTubeEducation = elementObj.GT_GJ_JT_TUBE_EDUCATION;
    var gtTubeLearnerReady = gtTubeEducation.LEARNER_READY;

    if (gtTubeEducation.GT_GJ_JT_TUBE_EDUCATION_DT_TM !="") {
        learningComplete = 'learning_incomplete';
        if (gtTubeLearnerReady!="" ) {
            if (gtTubeLearnerReady.indexOf("Yes") > -1){
                learningComplete = 'learning_complete';
            }
        }

        wrkResults += '<tr>' ;
        wrkResults += '<td style="padding-left:3px; width:50px;"><img src="';
        wrkResults += chla.eApps.Vars.transparentSpacer;
        wrkResults += '" height="5px" width="20px" ><span class="'  ;
        wrkResults += learningComplete + '" style="color: transparent; font-size: 14px;">MM</span></td><td>';

        eduPFormLinkParams = '&quot;POWERFORM&quot;,&quot;' +
            learning.personId  + '|' + gtTubeEducation.PFORM_ENCNTR_ID  +
            '|415551881|' + gtTubeEducation.PFORM_ACTIVITY_ID + '|0&quot;';
        wrkResults +='<a href="javascript:MPAGES_EVENT(' + eduPFormLinkParams + ')">' + gtTubeEducation.PFORM_DESCRIPTION + ' </a>';
        wrkResults += '</td><td >';
        wrkResults += gtTubeEducation.PFORM_SIGNED_DATE;
        wrkResults += '</td></tr>' ;
    }

	var heartInsEducation = elementObj.HEART_INSTITUTE_EDUCATION;
    var heartInsLearnerReady = heartInsEducation.LEARNER_READY;

    if (heartInsEducation.EDUCATION_DT_TM !="") {
        learningComplete = 'learning_incomplete';
        if (heartInsLearnerReady!="" ) {
            if (heartInsLearnerReady.indexOf("Yes") > -1){
                learningComplete = 'learning_complete';
            }
        }

        wrkResults += '<tr>' ;
        wrkResults += '<td style="padding-left:3px; width:50px;"><img src="';
        wrkResults += chla.eApps.Vars.transparentSpacer;
        wrkResults += '" height="5px" width="20px" ><span class="'  ;
        wrkResults += learningComplete + '" style="color: transparent; font-size: 14px;">MM</span></td><td>';

        eduPFormLinkParams = '&quot;POWERFORM&quot;,&quot;' +
            learning.personId  + '|' + heartInsEducation.PFORM_ENCNTR_ID  +
            '|355208649|' + heartInsEducation.PFORM_ACTIVITY_ID + '|0&quot;';
        wrkResults +='<a href="javascript:MPAGES_EVENT(' + eduPFormLinkParams + ')">' + heartInsEducation.PFORM_DESCRIPTION + ' </a>';
        wrkResults += '</td><td >';
        wrkResults += heartInsEducation.PFORM_SIGNED_DATE;
        wrkResults += '</td></tr>' ;
    }


    var homecareEducation = elementObj.HOMECARE_EDUCATION;
    var homecareLearnerReady = homecareEducation.LEARNER_READY;

    if (homecareEducation.HOMECARE_EDUCATION_DT_TM !="") {
        learningComplete = 'learning_incomplete';
        if (homecareLearnerReady!="" ) {
            if (homecareLearnerReady.indexOf("Yes") > -1){
                learningComplete = 'learning_complete';
            }
        }

        wrkResults += '<tr>' ;
        wrkResults += '<td style="padding-left:3px; width:50px;"><img src="';
        wrkResults += chla.eApps.Vars.transparentSpacer;
        wrkResults += '" height="5px" width="20px" ><span class="'  ;
        wrkResults += learningComplete + '" style="color: transparent; font-size: 14px;">MM</span></td><td>';

        eduPFormLinkParams = '&quot;POWERFORM&quot;,&quot;' +
            learning.personId  + '|' + homecareEducation.PFORM_ENCNTR_ID  +
            '|560380755|' + homecareEducation.PFORM_ACTIVITY_ID + '|0&quot;';
        wrkResults +='<a href="javascript:MPAGES_EVENT(' + eduPFormLinkParams + ')">' + homecareEducation.PFORM_DESCRIPTION + ' </a>';
        wrkResults += '</td><td >';
        wrkResults += homecareEducation.PFORM_SIGNED_DATE;
        wrkResults += '</td></tr>' ;
    }

    var hmvEducation = elementObj.HOME_MECH_VENT_EDUCATION;
    var hmvLearnerReady = hmvEducation.LEARNER_READY;

    if (hmvEducation.EDUCATION_DT_TM !="") {
        learningComplete = 'learning_incomplete';
        if (hmvLearnerReady!="" ) {
            if (hmvLearnerReady.indexOf("Yes") > -1){
                learningComplete = 'learning_complete';
            }
        }

        wrkResults += '<tr>' ;
        wrkResults += '<td style="padding-left:3px; width:50px;"><img src="';
        wrkResults += chla.eApps.Vars.transparentSpacer;
        wrkResults += '" height="5px" width="20px" ><span class="'  ;
        wrkResults += learningComplete + '" style="color: transparent; font-size: 14px;">MM</span></td><td>';

        eduPFormLinkParams = '&quot;POWERFORM&quot;,&quot;' +
            learning.personId  + '|' + hmvEducation.PFORM_ENCNTR_ID  +
            '|615656805|' + hmvEducation.PFORM_ACTIVITY_ID + '|0&quot;';
        wrkResults +='<a href="javascript:MPAGES_EVENT(' + eduPFormLinkParams + ')">' + hmvEducation.PFORM_DESCRIPTION + ' </a>';
        wrkResults += '</td><td >';
        wrkResults += hmvEducation.PFORM_SIGNED_DATE;
        wrkResults += '</td></tr>' ;
    }

	var kawaEducation = elementObj.KAWASAKI_EDUCATION;
    var kawaLearnerReady = kawaEducation.LEARNER_READY;

    if (kawaEducation.EDUCATION_DT_TM !="") {
        learningComplete = 'learning_incomplete';
        if (kawaLearnerReady!="" ) {
            if (kawaLearnerReady.indexOf("Yes") > -1){
                learningComplete = 'learning_complete';
            }
        }

        wrkResults += '<tr>' ;
        wrkResults += '<td style="padding-left:3px; width:50px;"><img src="';
        wrkResults += chla.eApps.Vars.transparentSpacer;
        wrkResults += '" height="5px" width="20px" ><span class="'  ;
        wrkResults += learningComplete +'" style="color: transparent; font-size: 14px;">MM</span></td><td>';

        eduPFormLinkParams = '&quot;POWERFORM&quot;,&quot;' +
            learning.personId  + '|' + kawaEducation.PFORM_ENCNTR_ID  +
            '|1041786715|' + kawaEducation.PFORM_ACTIVITY_ID + '|0&quot;';
        wrkResults +='<a href="javascript:MPAGES_EVENT(' + eduPFormLinkParams + ')">' + kawaEducation.PFORM_DESCRIPTION + ' </a>';
        wrkResults += '</td><td >';
        wrkResults += kawaEducation.PFORM_SIGNED_DATE;
        wrkResults += '</td></tr>' ;
    }

	var limbLossEducation = elementObj.LIMB_LOSS_EDUCATION;
    var limbLearnerReady = kawaEducation.LEARNER_READY;

    if (limbLossEducation.EDUCATION_DT_TM !="") {
        learningComplete = 'learning_incomplete';
        if (limbLearnerReady!="" ) {
            if (limbLearnerReady.indexOf("Yes") > -1){
                learningComplete = 'learning_complete';
            }
        }

        wrkResults += '<tr>' ;
        wrkResults += '<td style="padding-left:3px; width:50px;"><img src="';
        wrkResults += chla.eApps.Vars.transparentSpacer;
        wrkResults += '" height="5px" width="20px" ><span class="'  ;
        wrkResults += learningComplete +'" style="color: transparent; font-size: 14px;">MM</span></td><td>';

        eduPFormLinkParams = '&quot;POWERFORM&quot;,&quot;' +
            learning.personId  + '|' + limbLossEducation.PFORM_ENCNTR_ID  +
            '|1021177791|' + limbLossEducation.PFORM_ACTIVITY_ID + '|0&quot;';
        wrkResults +='<a href="javascript:MPAGES_EVENT(' + eduPFormLinkParams + ')">' + limbLossEducation.PFORM_DESCRIPTION + ' </a>';
        wrkResults += '</td><td >';
        wrkResults += limbLossEducation.PFORM_SIGNED_DATE;
        wrkResults += '</td></tr>' ;
    }

	var medEducation = elementObj.MEDICATION_EDUCATION;
    var medLearnerReady = medEducation.LEARNER_READY;

    if (medEducation.MEDICATION_EDUCATION_DT_TM !="") {
        learningComplete = 'learning_incomplete';
        if (medLearnerReady!="" ) {
            if (medLearnerReady.indexOf("Yes") > -1){
                learningComplete = 'learning_complete';
            }
        }

        wrkResults += '<tr>' ;
        wrkResults += '<td style="padding-left:3px; width:50px;"><img src="';
        wrkResults += chla.eApps.Vars.transparentSpacer;
        wrkResults += '" height="5px" width="20px" ><span class="'  ;
        wrkResults += learningComplete +'" style="color: transparent; font-size: 14px;">MM</span></td><td>';

        eduPFormLinkParams = '&quot;POWERFORM&quot;,&quot;' +
            learning.personId  + '|' + medEducation.PFORM_ENCNTR_ID  +
            '|416589449|' + medEducation.PFORM_ACTIVITY_ID + '|0&quot;';
        wrkResults +='<a href="javascript:MPAGES_EVENT(' + eduPFormLinkParams + ')">' + medEducation.PFORM_DESCRIPTION + ' </a>';
        wrkResults += '</td><td >';
        wrkResults += medEducation.PFORM_SIGNED_DATE;
        wrkResults += '</td></tr>' ;
    }

	var meningitisEducation = elementObj.MENINGITIS_EDUCATION;
    var meningitisLearnerReady = meningitisEducation.LEARNER_READY;

    if (meningitisEducation.EDUCATION_DT_TM !="") {
        learningComplete = 'learning_incomplete';
        if (meningitisLearnerReady!="" ) {
            if (meningitisLearnerReady.indexOf("Yes") > -1){
                learningComplete = 'learning_complete';
            }
        }

        wrkResults += '<tr>' ;
        wrkResults += '<td style="padding-left:3px; width:50px;"><img src="';
        wrkResults += chla.eApps.Vars.transparentSpacer;
        wrkResults += '" height="5px" width="20px" ><span class="'  ;
        wrkResults += learningComplete +'" style="color: transparent; font-size: 14px;">MM</span></td><td>';

        eduPFormLinkParams = '&quot;POWERFORM&quot;,&quot;' +
            learning.personId  + '|' + meningitisEducation.PFORM_ENCNTR_ID  +
            '|1041786359|' + meningitisEducation.PFORM_ACTIVITY_ID + '|0&quot;';
        wrkResults +='<a href="javascript:MPAGES_EVENT(' + eduPFormLinkParams + ')">' + meningitisEducation.PFORM_DESCRIPTION + ' </a>';
        wrkResults += '</td><td >';
        wrkResults += meningitisEducation.PFORM_SIGNED_DATE;
        wrkResults += '</td></tr>' ;
    }

    var NgNjEducation = elementObj.NG_NJ_EDUCATION;
    var NgNjLearnerReady = NgNjEducation.LEARNER_READY;

    if (NgNjEducation.NG_NJ_EDUCATION_DT_TM !="") {
        learningComplete = 'learning_incomplete';
        if (NgNjLearnerReady!="" ) {
            if (NgNjLearnerReady.indexOf("Yes") > -1){
                learningComplete = 'learning_complete';
            }
        }

        wrkResults += '<tr>' ;
        wrkResults += '<td style="padding-left:3px; width:50px;"><img src="';
        wrkResults += chla.eApps.Vars.transparentSpacer;
        wrkResults += '" height="5px" width="20px" ><span class="'  ;
        wrkResults += learningComplete +'" style="color: transparent; font-size: 14px;">MM</span></td><td>';

        eduPFormLinkParams = '&quot;POWERFORM&quot;,&quot;' +
            learning.personId  + '|' + NgNjEducation.PFORM_ENCNTR_ID  +
            '|637995547|' + NgNjEducation.PFORM_ACTIVITY_ID + '|0&quot;';
        wrkResults +='<a href="javascript:MPAGES_EVENT(' + eduPFormLinkParams + ')">' + NgNjEducation.PFORM_DESCRIPTION + ' </a>';
        wrkResults += '</td><td >';
        wrkResults += NgNjEducation.PFORM_SIGNED_DATE;
        wrkResults += '</td></tr>' ;
    }

    var ostomyEducation = elementObj.OSTOMY_EDUCATION;
    var ostomyLearnerReady = ostomyEducation.LEARNER_READY;

    if (ostomyEducation.OSTOMY_EDUCATION_DT_TM !="") {
        learningComplete = 'learning_incomplete';
        if (ostomyLearnerReady!="" ) {
            if (ostomyLearnerReady.indexOf("Yes") > -1){
                learningComplete = 'learning_complete';
            }
        }

        wrkResults += '<tr>' ;
        wrkResults += '<td style="padding-left:3px; width:50px;"><img src="';
        wrkResults += chla.eApps.Vars.transparentSpacer;
        wrkResults += '" height="5px" width="20px" ><span class="'  ;
        wrkResults += learningComplete +'" style="color: transparent; font-size: 14px;">MM</span></td><td>';

        eduPFormLinkParams = '&quot;POWERFORM&quot;,&quot;' +
            learning.personId  + '|' + ostomyEducation.PFORM_ENCNTR_ID  +
            '|416589425|' + ostomyEducation.PFORM_ACTIVITY_ID + '|0&quot;';
        wrkResults +='<a href="javascript:MPAGES_EVENT(' + eduPFormLinkParams + ')">' + ostomyEducation.PFORM_DESCRIPTION + ' </a>';
        wrkResults += '</td><td >';
        wrkResults += ostomyEducation.PFORM_SIGNED_DATE;
        wrkResults += '</td></tr>' ;
    }
var periDialysisEducation = elementObj.PERI_DIALYSIS_EDUCATION;
    var periDialysisLearnerReady = periDialysisEducation.LEARNER_READY;

    if (periDialysisEducation.EDUCATION_DT_TM !="") {
        learningComplete = 'learning_incomplete';
        if (periDialysisLearnerReady!="" ) {
            if (periDialysisLearnerReady.indexOf("Yes") > -1){
                learningComplete = 'learning_complete';
            }
        }

        wrkResults += '<tr>' ;
        wrkResults += '<td style="padding-left:3px; width:50px;"><img src="';
        wrkResults += chla.eApps.Vars.transparentSpacer;
        wrkResults += '" height="5px" width="20px" ><span class="'  ;
        wrkResults += learningComplete +'" style="color: transparent; font-size: 14px;">MM</span></td><td>';

        eduPFormLinkParams = '&quot;POWERFORM&quot;,&quot;' +
            learning.personId  + '|' + periDialysisEducation.PFORM_ENCNTR_ID  +
            '|1044114045|' + periDialysisEducation.PFORM_ACTIVITY_ID + '|0&quot;';
        wrkResults +='<a href="javascript:MPAGES_EVENT(' + eduPFormLinkParams + ')">' + periDialysisEducation.PFORM_DESCRIPTION + ' </a>';
        wrkResults += '</td><td >';
        wrkResults += periDialysisEducation.PFORM_SIGNED_DATE;
        wrkResults += '</td></tr>' ;
    }

	var pneumoniaEducation = elementObj.PNEUMONIA_EDUCATION;
    var pneumoniaLearnerReady = pneumoniaEducation.LEARNER_READY;

    if (pneumoniaEducation.EDUCATION_DT_TM !="") {
        learningComplete = 'learning_incomplete';
        if (pneumoniaLearnerReady!="" ) {
            if (pneumoniaLearnerReady.indexOf("Yes") > -1){
                learningComplete = 'learning_complete';
            }
        }

        wrkResults += '<tr>' ;
        wrkResults += '<td style="padding-left:3px; width:50px;"><img src="';
        wrkResults += chla.eApps.Vars.transparentSpacer;
        wrkResults += '" height="5px" width="20px" ><span class="'  ;
        wrkResults += learningComplete +'" style="color: transparent; font-size: 14px;">MM</span></td><td>';

        eduPFormLinkParams = '&quot;POWERFORM&quot;,&quot;' +
            learning.personId  + '|' + pneumoniaEducation.PFORM_ENCNTR_ID  +
            '|1041655453|' + pneumoniaEducation.PFORM_ACTIVITY_ID + '|0&quot;';
        wrkResults +='<a href="javascript:MPAGES_EVENT(' + eduPFormLinkParams + ')">' + pneumoniaEducation.PFORM_DESCRIPTION + ' </a>';
        wrkResults += '</td><td >';
        wrkResults += pneumoniaEducation.PFORM_SIGNED_DATE;
        wrkResults += '</td></tr>' ;
    }

    var ptSafetyEducation = elementObj.PATIENT_SAFETY_EDUCATION;
    var ptSafetyLearnerReady = ptSafetyEducation.LEARNER_READY;

    if (ptSafetyEducation.PATIENT_SAFETY_EDUCATION_DT_TM !="") {
        learningComplete = 'learning_incomplete';
        if (ptSafetyLearnerReady!="" ) {
            if (ptSafetyLearnerReady.indexOf("Yes") > -1){
                learningComplete = 'learning_complete';
            }
        }

        wrkResults += '<tr>' ;
        wrkResults += '<td style="padding-left:3px; width:50px;"><img src="';
        wrkResults += chla.eApps.Vars.transparentSpacer;
        wrkResults += '" height="5px" width="20px" ><span class="'  ;
        wrkResults += learningComplete +'" style="color: transparent; font-size: 14px;">MM</span></td><td>';

        eduPFormLinkParams = '&quot;POWERFORM&quot;,&quot;' +
            learning.personId  + '|' + ptSafetyEducation.PFORM_ENCNTR_ID  +
            '|417586521|' + ptSafetyEducation.PFORM_ACTIVITY_ID + '|0&quot;';
        wrkResults +='<a href="javascript:MPAGES_EVENT(' + eduPFormLinkParams + ')">' + ptSafetyEducation.PFORM_DESCRIPTION + ' </a>';
        wrkResults += '</td><td >';
        wrkResults += ptSafetyEducation.PFORM_SIGNED_DATE;
        wrkResults += '</td></tr>' ;
    }

    var prePostOpEducation = elementObj.PRE_POST_OP_EDUCATION;
    var prePostOpLearnerReady = prePostOpEducation.LEARNER_READY;

    if (prePostOpEducation.PRE_POST_OP_EDUCATION_DT_TM !="") {
        learningComplete = 'learning_incomplete';
        if (prePostOpLearnerReady!="" ) {
            if (prePostOpLearnerReady.indexOf("Yes") > -1){
                learningComplete = 'learning_complete';
            }
        }

        wrkResults += '<tr>' ;
        wrkResults += '<td style="padding-left:3px; width:50px;"><img src="';
        wrkResults += chla.eApps.Vars.transparentSpacer;
        wrkResults += '" height="5px" width="20px" ><span class="'  ;
        wrkResults += learningComplete +'" style="color: transparent; font-size: 14px;">MM</span></td><td>';

        eduPFormLinkParams = '&quot;POWERFORM&quot;,&quot;' +
            learning.personId  + '|' + prePostOpEducation.PFORM_ENCNTR_ID  +
            '|637999531|' + prePostOpEducation.PFORM_ACTIVITY_ID + '|0&quot;';
        wrkResults +='<a href="javascript:MPAGES_EVENT(' + eduPFormLinkParams + ')">' + prePostOpEducation.PFORM_DESCRIPTION + ' </a>';
        wrkResults += '</td><td >';
        wrkResults += prePostOpEducation.PFORM_SIGNED_DATE;
        wrkResults += '</td></tr>' ;
    }

    var rsvEducation = elementObj.RSV_EDUCATION;
    var rsvLearnerReady = rsvEducation.LEARNER_READY;

    if (rsvEducation.RSV_EDUCATION_DT_TM !="") {
        learningComplete = 'learning_incomplete';
        if (rsvLearnerReady!="" ) {
            if (rsvLearnerReady.indexOf("Yes") > -1){
                learningComplete = 'learning_complete';
            }
        }

        wrkResults += '<tr>' ;
        wrkResults += '<td style="padding-left:3px; width:50px;"><img src="';
        wrkResults += chla.eApps.Vars.transparentSpacer;
        wrkResults += '" height="5px" width="20px" ><span class="'  ;
        wrkResults += learningComplete +'" style="color: transparent; font-size: 14px;">MM</span></td><td>';

        eduPFormLinkParams = '&quot;POWERFORM&quot;,&quot;' +
            learning.personId  + '|' + rsvEducation.PFORM_ENCNTR_ID  +
            '|688954381|' + rsvEducation.PFORM_ACTIVITY_ID + '|0&quot;';
        wrkResults +='<a href="javascript:MPAGES_EVENT(' + eduPFormLinkParams + ')">' + rsvEducation.PFORM_DESCRIPTION + ' </a>';
        wrkResults += '</td><td >';
        wrkResults += rsvEducation.PFORM_SIGNED_DATE;
        wrkResults += '</td></tr>' ;
    }

	var sdEducation = elementObj.SD_EDUCATION;
    var sdLearnerReady = sdEducation.LEARNER_READY;

    if (sdEducation.EDUCATION_DT_TM !="") {
        learningComplete = 'learning_incomplete';
        if (sdLearnerReady!="" ) {
            if (sdLearnerReady.indexOf("Yes") > -1){
                learningComplete = 'learning_complete';
            }
        }

        wrkResults += '<tr>' ;
        wrkResults += '<td style="padding-left:3px; width:50px;"><img src="';
        wrkResults += chla.eApps.Vars.transparentSpacer;
        wrkResults += '" height="5px" width="20px" ><span class="'  ;
        wrkResults += learningComplete +'" style="color: transparent; font-size: 14px;">MM</span></td><td>';

        eduPFormLinkParams = '&quot;POWERFORM&quot;,&quot;' +
            learning.personId  + '|' + sdEducation.PFORM_ENCNTR_ID  +
            '|1095921747|' + sdEducation.PFORM_ACTIVITY_ID + '|0&quot;';
        wrkResults +='<a href="javascript:MPAGES_EVENT(' + eduPFormLinkParams + ')">' + sdEducation.PFORM_DESCRIPTION + ' </a>';
        wrkResults += '</td><td >';
        wrkResults += sdEducation.PFORM_SIGNED_DATE;
        wrkResults += '</td></tr>' ;
    }
    var splFormulaEducation = elementObj.SPL_FORMULA_PREP_EDUCATION;
    var splFormulaLearnerReady = splFormulaEducation.LEARNER_READY;

    if (splFormulaEducation.EDUCATION_DT_TM !="") {
        learningComplete = 'learning_incomplete';
        if (splFormulaLearnerReady!="" ) {
            if (splFormulaLearnerReady.indexOf("Yes") > -1){
                learningComplete = 'learning_complete';
            }
        }

        wrkResults += '<tr>' ;
        wrkResults += '<td style="padding-left:3px; width:50px;"><img src="';
        wrkResults += chla.eApps.Vars.transparentSpacer;
        wrkResults += '" height="5px" width="20px" ><span class="'  ;
        wrkResults += learningComplete +'" style="color: transparent; font-size: 14px;">MM</span></td><td>';

        eduPFormLinkParams = '&quot;POWERFORM&quot;,&quot;' +
            learning.personId  + '|' + splFormulaEducation.PFORM_ENCNTR_ID  +
            '|757956903|' + splFormulaEducation.PFORM_ACTIVITY_ID + '|0&quot;';
        wrkResults +='<a href="javascript:MPAGES_EVENT(' + eduPFormLinkParams + ')">' + splFormulaEducation.PFORM_DESCRIPTION + ' </a>';
        wrkResults += '</td><td >';
        wrkResults += splFormulaEducation.PFORM_SIGNED_DATE;
        wrkResults += '</td></tr>' ;
    }

	var spinalCordEducation = elementObj.SPINAL_CORD_EDUCATION;
    var sCordLearnerReady = spinalCordEducation.LEARNER_READY;

    if (spinalCordEducation.EDUCATION_DT_TM !="") {
        learningComplete = 'learning_incomplete';
        if (sCordLearnerReady!="" ) {
            if (sCordLearnerReady.indexOf("Yes") > -1){
                learningComplete = 'learning_complete';
            }
        }

        wrkResults += '<tr>' ;
        wrkResults += '<td style="padding-left:3px; width:50px;"><img src="';
        wrkResults += chla.eApps.Vars.transparentSpacer;
        wrkResults += '" height="5px" width="20px" ><span class="'  ;
        wrkResults += learningComplete +'" style="color: transparent; font-size: 14px;">MM</span></td><td>';

        eduPFormLinkParams = '&quot;POWERFORM&quot;,&quot;' +
            learning.personId  + '|' + spinalCordEducation.PFORM_ENCNTR_ID  +
            '|1021162653|' + spinalCordEducation.PFORM_ACTIVITY_ID + '|0&quot;';
        wrkResults +='<a href="javascript:MPAGES_EVENT(' + eduPFormLinkParams + ')">' + spinalCordEducation.PFORM_DESCRIPTION + ' </a>';
        wrkResults += '</td><td >';
        wrkResults += spinalCordEducation.PFORM_SIGNED_DATE;
        wrkResults += '</td></tr>' ;
    }


    var spinalFusionEducation = elementObj.SPINAL_FUSION_EDUCATION;
    var spinalFusionLearnerReady = spinalFusionEducation.LEARNER_READY;

    if (spinalFusionEducation.SPINAL_FUSION_EDUCATION_DT_TM !="") {
        learningComplete = 'learning_incomplete';
        if (spinalFusionLearnerReady!="" ) {
            if (spinalFusionLearnerReady.indexOf("Yes") > -1){
                learningComplete = 'learning_complete';
            }
        }

        wrkResults += '<tr>' ;
        wrkResults += '<td style="padding-left:3px; width:50px;"><img src="';
        wrkResults += chla.eApps.Vars.transparentSpacer;
        wrkResults += '" height="5px" width="20px" ><span class="'  ;
        wrkResults += learningComplete +'" style="color: transparent; font-size: 14px;">MM</span></td><td>';

        eduPFormLinkParams = '&quot;POWERFORM&quot;,&quot;' +
            learning.personId  + '|' + spinalFusionEducation.PFORM_ENCNTR_ID  +
            '|638005729|' + spinalFusionEducation.PFORM_ACTIVITY_ID + '|0&quot;';
        wrkResults +='<a href="javascript:MPAGES_EVENT(' + eduPFormLinkParams + ')">' + spinalFusionEducation.PFORM_DESCRIPTION + ' </a>';
        wrkResults += '</td><td >';
        wrkResults += spinalFusionEducation.PFORM_SIGNED_DATE;
        wrkResults += '</td></tr>' ;
    }

    var tracheostomyEducation = elementObj.TRACHEOSTOMY_EDUCATION;
    var tracheostomyLearnerReady = tracheostomyEducation.LEARNER_READY;

    if (tracheostomyEducation.TRACHEOSTOMY_EDUCATION_DT_TM !="") {
        learningComplete = 'learning_incomplete';
        if (tracheostomyLearnerReady!="" ) {
            if (tracheostomyLearnerReady.indexOf("Yes") > -1){
                learningComplete = 'learning_complete';
            }
        }

        wrkResults += '<tr>' ;
        wrkResults += '<td style="padding-left:3px; width:50px;"><img src="';
        wrkResults += chla.eApps.Vars.transparentSpacer;
        wrkResults += '" height="5px" width="20px" ><span class="'  ;
        wrkResults += learningComplete +'" style="color: transparent; font-size: 14px;">MM</span></td><td>';

        eduPFormLinkParams = '&quot;POWERFORM&quot;,&quot;' +
            learning.personId  + '|' + tracheostomyEducation.PFORM_ENCNTR_ID  +
            '|416259181|' + tracheostomyEducation.PFORM_ACTIVITY_ID + '|0&quot;';
        wrkResults +='<a href="javascript:MPAGES_EVENT(' + eduPFormLinkParams + ')">' + tracheostomyEducation.PFORM_DESCRIPTION + ' </a>';
        wrkResults += '</td><td >';
        wrkResults += tracheostomyEducation.PFORM_SIGNED_DATE;
        wrkResults += '</td></tr>' ;
    }

	var transferEducation = elementObj.TRANSFER_AMB_EDUCATION;
    var transferLearnerReady = transferEducation.LEARNER_READY;

    if (transferEducation.EDUCATION_DT_TM !="") {
        learningComplete = 'learning_incomplete';
        if (transferLearnerReady!="" ) {
            if (transferLearnerReady.indexOf("Yes") > -1){
                learningComplete = 'learning_complete';
            }
        }

        wrkResults += '<tr>' ;
        wrkResults += '<td style="padding-left:3px; width:50px;"><img src="';
        wrkResults += chla.eApps.Vars.transparentSpacer;
        wrkResults += '" height="5px" width="20px" ><span class="'  ;
        wrkResults += learningComplete +'" style="color: transparent; font-size: 14px;">MM</span></td><td>';

        eduPFormLinkParams = '&quot;POWERFORM&quot;,&quot;' +
            learning.personId  + '|' + transferEducation.PFORM_ENCNTR_ID  +
            '|1021155395|' + transferEducation.PFORM_ACTIVITY_ID + '|0&quot;';
        wrkResults +='<a href="javascript:MPAGES_EVENT(' + eduPFormLinkParams + ')">' + transferEducation.PFORM_DESCRIPTION + ' </a>';
        wrkResults += '</td><td >';
        wrkResults += transferEducation.PFORM_SIGNED_DATE;
        wrkResults += '</td></tr>' ;
    }

    var urineCathEducation = elementObj.URINECATH_EDUCATION;
    var urineCathLearnerReady = urineCathEducation.LEARNER_READY;

    if (urineCathEducation.URINECATH_EDUCATION_DT_TM !="") {
        learningComplete = 'learning_incomplete';
        if (urineCathLearnerReady!="" ) {
            if (urineCathLearnerReady.indexOf("Yes") > -1){
                learningComplete = 'learning_complete';
            }
        }

        wrkResults += '<tr>' ;
        wrkResults += '<td style="padding-left:3px; width:50px;"><img src="';
        wrkResults += chla.eApps.Vars.transparentSpacer;
        wrkResults += '" height="5px" width="20px" ><span class="'  ;
        wrkResults += learningComplete +'" style="color: transparent; font-size: 14px;">MM</span></td><td>';

        eduPFormLinkParams = '&quot;POWERFORM&quot;,&quot;' +
            learning.personId  + '|' + urineCathEducation.PFORM_ENCNTR_ID  +
            '|614132135|' + urineCathEducation.PFORM_ACTIVITY_ID + '|0&quot;';
        wrkResults +='<a href="javascript:MPAGES_EVENT(' + eduPFormLinkParams + ')">' + urineCathEducation.PFORM_DESCRIPTION + ' </a>';
        wrkResults += '</td><td >';
        wrkResults += urineCathEducation.PFORM_SIGNED_DATE;
        wrkResults += '</td></tr>' ;
    }

    var wicEducation = elementObj.WIC_EDUCATION;
    var wicLearnerReady = wicEducation.LEARNER_READY;
    if (wicEducation.WIC_EDUCATION_DT_TM !="") {
        learningComplete = 'learning_incomplete';
        if (wicLearnerReady!="" ) {
            if (wicLearnerReady.indexOf("Yes") > -1){
                learningComplete = 'learning_complete';
            }
        }

        wrkResults += '<tr>' ;
        wrkResults += '<td style="padding-left:3px; width:50px;"><img src="';
        wrkResults += chla.eApps.Vars.transparentSpacer;
        wrkResults += '" height="5px" width="20px" ><span class="'  ;
        wrkResults += learningComplete +'" style="color: transparent; font-size: 14px;">MM</span></td><td>';

        eduPFormLinkParams = '&quot;POWERFORM&quot;,&quot;' +
            learning.personId  + '|' + wicEducation.PFORM_ENCNTR_ID  +
            '|417726811|' + wicEducation.PFORM_ACTIVITY_ID + '|0&quot;';
        wrkResults +='<a href="javascript:MPAGES_EVENT(' + eduPFormLinkParams + ')">' + wicEducation.PFORM_DESCRIPTION + ' </a>';
        wrkResults += '</td><td >';
        wrkResults += wicEducation.PFORM_SIGNED_DATE;
        wrkResults += '</td></tr>' ;
    }

    //CC_SectionManagement.powerNtsH5Sec.SectionCntVal = wrkResults_cnt;
    //CC_SectionManagement.powerNtsH5Sec.UnformatBodyVal =  wrkResults;

    CC_SectionManagement.powerNtsH5Sec.SectionCntVal = wrkResults_cnt;
    CC_SectionManagement.powerNtsH5Sec.UnformatBodyVal =  wrkResults;


    //-------------------------------------
    SectionObj = CC_SectionManagement.ordersH5Sec ;
    SectionObj.idLabel =  'ordersH5Sec';
    SectionObj.TLabel1 =  'Education Orders';
    SectionObj.SectionCnt = ' (' + SectionObj.SectionCntVal + ')';
    SectionObj.SectionClosed = (SectionObj.SectionCntVal  == 0) ? 'closed' : '';
    SectionObj.Disabled_Lbl = (SectionObj.SectionCntVal  == 0) ? 'grey': '';
    SectionObj.CustIcon = (SectionObj.SectionCntVal == 0) ? 'background-image:none;': '';
    SectionObj.HideIfEmpty = 'false';
    SectionObj.ContentBody = '<table><tbody><thead><tr><th style="width:60%"><img src="';
    SectionObj.ContentBody +=  chla.eApps.Vars.transparentSpacer ;
    SectionObj.ContentBody +=  '" height="5px" width="17px"  >' ;
    SectionObj.ContentBody += 'Name</th><th style="width:25%">Detail</th><th>Order Status</th></tr></thead>';
    SectionObj.ContentBody +=  SectionObj.UnformatBodyVal  + '</tbody></table>';
    learning.ordersH5Section = chla.eApps.Funcs.parseTemplate( chla.eApps.Vars.H5_Tmpl.join('') ,SectionObj);

    //-------------------------------------
    SectionObj = CC_SectionManagement.powerNtsH5Sec ;
    SectionObj.idLabel =  'powerNtsH5Sec';
    SectionObj.TLabel1 =  'Education Notes';
    SectionObj.SectionCnt = ' (' + SectionObj.SectionCntVal + ')';
    SectionObj.SectionClosed = (SectionObj.SectionCntVal  == 0) ? 'closed': '';
    SectionObj.Disabled_Lbl = (SectionObj.SectionCntVal  == 0) ? 'grey': '';
    SectionObj.CustIcon = (SectionObj.SectionCntVal == 0) ? 'background-image:none;': '';
    SectionObj.HideIfEmpty = 'false';
    SectionObj.ContentBody = '<table class="header"><tbody><thead><tr><th width="50px"><img src="';
    SectionObj.ContentBody +=  chla.eApps.Vars.transparentSpacer
    SectionObj.ContentBody += '" height="5px" width="17px"  >';
    SectionObj.ContentBody += 'Status</th><th>Learning</th><th>Last Updated</th></tr></thead>';
    SectionObj.ContentBody +=  SectionObj.UnformatBodyVal  + '</tbody></table>';
    learning.powerNtsH5Section = chla.eApps.Funcs.parseTemplate( chla.eApps.Vars.H5_Tmpl.join('') ,SectionObj);

    //-------------------------------------
    compContent = chla.eApps.Funcs.parseTemplate( learning_Tmpl.join('') ,learning);

    //-------------------------------------
    //  CC DIV Rendering
    //-------------------------------------
    chla.eAppsUtil.Logger.LogWarn('<textarea rows="4" style="width:99%;">Education Needs </br>' + chla.eApps.Funcs.HtmlLogFormatter(compContent) + "</textarea>");
    target.innerHTML = compContent;

//-------------------------------------
//  CC HTML/CSS behaviours
//-------------------------------------
    //-------------------------------------
    //Section Collapse and Expand CSS behavior handles
    //-------------------------------------
    if(CC_SectionManagement.ordersH5Sec.SectionCntVal > 0)
        $('div#ordersH5Sec_DivSubSec H2.h5a-marker').on( "click",chla.learning.eApps.CSSBehaviors.SingleH5SectionToggle) ;

    if(CC_SectionManagement.powerNtsH5Sec.SectionCntVal > 0)
        $('div#powerNtsH5Sec_DivSubSec H2.h5a-marker').on( "click",chla.learning.eApps.CSSBehaviors.SingleH5SectionToggle) ;
//

};




//::===========================================================================
//:: CC - Supplies/Home Health
//::---------------------------------------------------------------------------
chla.hm_supplies = function () { };
chla.hm_supplies.prototype = new MPage.Component();
chla.hm_supplies.prototype.constructor = MPage.Component;
chla.hm_supplies.prototype.base = MPage.Component.prototype;
chla.hm_supplies.prototype.name = "chla.hm_supplies";
chla.hm_supplies.prototype.cclProgram = "chla_ca_mp_cc_hm_health_json";
chla.hm_supplies.prototype.cclParams = [];
chla.hm_supplies.prototype.cclDataType = "JSON";
chla.hm_supplies.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("encounterId");
    this.cclParams[2] = this.getProperty("personId");
};

chla.hm_supplies.prototype.render = function(){
    var component = this;
    var elementObj = component.data.RPTDATA;
    var target = this.getTarget();
    var compContent;

    var SectionObj,wrkList,resultsItem, wrkResults,wrkResultsCnt,
        wrkDate,wrkCnt,wrkDesc,wrkValue,wrkValuesList,
        listLen, listLen2,h, i , j , wrkSpltCnt;

    var OutItems = {
        wrkResults: '',
        wrkResultsCnt: 0,
        SectionObj: null,
        DMEOrder:null
    }
    var ResultItms = {
        SectionObj: null,
        DMEOrder:null
    }

    var DME_OrdersProcessing0 = function (pwrkCnt,ResultItmsByRef){
        var DMEwrkResults = '';
        var DMEwrkResultsCnt = 0;
        var OutItemsVals = {
            wrkResults: '',
            wrkResultsCnt: 0
        };

        if (pwrkCnt> 0) {
            OutItemsVals.wrkResults = '';
            OutItemsVals.wrkResultsCnt = 0;

            for (i=0; i < wrkCnt; i++) {
                if (ResultItmsByRef.DMEOrder[i].ITEM_EVENTVAL.length > 0){
                    DME_OrdersProcessing(ResultItmsByRef.DMEOrder[i].ITEM_EVENTVAL,
                        ResultItmsByRef.DMEOrder[i].ITEM_EVENT_DATE,
                        ResultItmsByRef.DMEOrder[i].ITEM_CE_ID,
                        OutItemsVals) ;
                    DMEwrkResults  +=  OutItemsVals.wrkResults ;
                    DMEwrkResultsCnt += OutItemsVals.wrkResultsCnt;
                }
            }
            ResultItmsByRef.SectionObj.UnformatBodyVal +=  DMEwrkResults ;
            ResultItmsByRef.SectionObj.SectionCntVal += DMEwrkResultsCnt;
        }
        return ;
    };
    var DME_OrdersProcessing = function (pWrkValue, pWrkDate, pWrkID, RetItems){
        var listLenDME_orders, k , wrklist ;
        RetItems.wrkResults = '';
        RetItems.wrkResultsCnt = 0;
        if (pWrkValue.length > 0) {
            if (pWrkValue.indexOf(',') > -1){
                wrkList = pWrkValue.split(',');
            } else {
                wrkList = [];
                wrkList.push(pWrkValue);
            }
            listLenDME_orders = wrkList.length;
            for (k=0; k < listLenDME_orders; k++) {
                if (wrkList[k] != null) {
                    RetItems.wrkResults += '<tr><td class="col-1">' + pWrkDate + '</td>';
                    RetItems.wrkResults += '<td class="col-2">' + wrkList[k].replace(/^\s+|\s+$/g,'') + '</td>';
                    RetItems.wrkResults += '<td class="col-3">&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox"';
                    RetItems.wrkResults += ' id="' +  pWrkID + wrkList[k].replace(/[ \/()-:]/g,'') + '"';
                    RetItems.wrkResults += '/>&nbsp;&nbsp;</td></tr>';
                    RetItems.wrkResultsCnt +=1;
                }
            }
        }
        return ;
    };

    var DME_checkbox_processing = function(ResultItmsByRef){
        var i,
            DME_chbx_wrkList,
            DME_chbx_listLen,
            DME_chbx_wrkDesc,
            DME_chbx_wrkValue,
            DME_chbx_wrkValuesList;
        DME_chbx_wrkList = ResultItmsByRef.DMEOrder.substring(3).split('%');
        DME_chbx_listLen = DME_chbx_wrkList.length;
        if ( DME_chbx_listLen > 0 && DME_chbx_wrkList[0] != '') {
            for (i = 0 ; i < DME_chbx_listLen ; i++ ) {
                DME_chbx_wrkValuesList = DME_chbx_wrkList[i].split(':');
                DME_chbx_wrkDesc =  DME_chbx_wrkValuesList[0] + '\"';
                DME_chbx_wrkValue = DME_chbx_wrkValuesList[0] + '\" '  ;
                DME_chbx_wrkValue += (DME_chbx_wrkValuesList[1] == 'true')? ' checked ':'';
                DME_chbx_wrkResults = ResultItmsByRef.SectionObj.UnformatBodyVal.replace(DME_chbx_wrkDesc, DME_chbx_wrkValue);
                ResultItmsByRef.SectionObj.UnformatBodyVal =  DME_chbx_wrkResults;
            }
        }
        return;
    }

    var CC_SectionManagement ={};

    var hmSupplies = {
        cc_id: 'hmSupplies',
        personId: 0,
        encounterId: 0,
        transparentSpacer:'',
        DME_NeededH5Section: ' ',
        DME_NeededH5Section_cnt: ' ',
        DME_OrderedH5Section: ' ',
        DME_OrderedH5Section_cnt: ' ',
        vendorH5Section_cnt :' ',
        SR_REQSH5Section_cnt: ' ',
        vendorH5Section :' ',
        vndrEquipH6Section:'',
        vndrHomeHealthH6Section: '',
        SR_REQSH5Section: ' ',
        serviceReqH6Section:'',
        entNutrH6Section: '',
        ivH6Section: '',
        mobH6Section: '',
        respH6Section: '',
        woundH6Section: '',
        uroH6Section: '',
        ostomyH6Section: '',
        EN_DATA_chgd: 'O::',
        IV_DATA_chgd: 'O::',
        MOBILITY_DATA_chgd: 'O::',
        RESPIRATORY_DATA_chgd: 'O::',
        UROLOGY_DATA_chgd: 'O::',
        WOUND_DATA_chgd: 'O::',
        OSTOMY_DATA_chgd: 'O::'
    } ;

    var hmSupplies_Tmpl = [
        '<div id="<#=cc_id#>" class="eapps_CC">  ',
        '<#=DME_OrderedH5Section#>  ',
        '<#=vendorH5Section#>  ',
        '<#=SR_REQSH5Section#>  ',
        '</div>'
    ] ;

    chla.hm_supplies.eApps = {};
    chla.hm_supplies.eApps.cc_id = chla.hm_supplies.prototype.name.replace('.','_');
    chla.hm_supplies.eApps.SaveButtonAction = chla.eApps.SaveButtonBehavior.enable_disable_status_reset;
    chla.hm_supplies.eApps.CSSBehaviors = new chla.eApps.CSSBehaviors();

    hmSupplies.cc_id = chla.hm_supplies.eApps.cc_id;
    hmSupplies.personId = this.getProperty("personId");
    hmSupplies.encounterId = this.getProperty("encounterId");

    //-------------------------------------------------------------------------------
    CC_SectionManagement.DME_OrderedH5Sec   = new  chla.eApps.SectionHeader();
    CC_SectionManagement.vendorH5Sec        = new  chla.eApps.SectionHeader();
    CC_SectionManagement.SR_REQSH5Sec       = new  chla.eApps.SectionHeader();

    CC_SectionManagement.entNutrH6Sec       = new  chla.eApps.SectionHeader();
    CC_SectionManagement.ivH6Sec            = new  chla.eApps.SectionHeader();
    CC_SectionManagement.mobH6Sec           = new  chla.eApps.SectionHeader();
    CC_SectionManagement.respH6Sec          = new  chla.eApps.SectionHeader();
    CC_SectionManagement.woundH6Sec         = new  chla.eApps.SectionHeader();
    CC_SectionManagement.uroH6Sec           = new  chla.eApps.SectionHeader();
    CC_SectionManagement.ostomyH6Sec        = new  chla.eApps.SectionHeader();

    CC_SectionManagement.vndrHomeHealthH6Sec = new  chla.eApps.SectionHeader();
    CC_SectionManagement.vndrEquipH6Sec     = new  chla.eApps.SectionHeader();
    CC_SectionManagement.serviceReqH6Sec     = new  chla.eApps.SectionHeader();

//     wrkValue = elementObj.ANTICIPATED_HOME_EQUIPMENTS;
//     SectionObj = CC_SectionManagement.antHomeEqmntsH6Sec;
//     listLen = 0 ;
//     wrkResultsCnt = 0;
//     wrkResults = '';
//     if (wrkValue != null && wrkValue.length > 0 ) {
//         if (wrkValue.indexOf(',') == -1 ){
//               wrkList = [];
//               wrkList.push(wrkValue);
//         }else {
//               wrkList = wrkValue.split(',');
//         }
//         listLen = wrkList.length;
//         for (j=0; j<listLen; j++) {
//             if (wrkList[j] != null){
//                  wrkResults += "<tr><td>&nbsp;&nbsp;&nbsp;&nbsp;" + wrkList[j].replace(/^\s+|\s+$/g,'') + "</td></tr>";
//                  wrkResultsCnt += 1;
//             }
//         }
//     }
//     SectionObj.UnformatBodyVal = (wrkResults ==  '') ?  "&nbsp;&nbsp;No Home Equipments Needed": wrkResults ;
//     SectionObj.SectionCntVal = wrkResultsCnt;
//
//     wrkValue = elementObj.ANTICIPATED_HOME_TREATMENTS;
//     SectionObj = CC_SectionManagement.antHomeTrmntsH6Sec;
//     listLen = 0 ;
//     wrkResultsCnt = 0;
//     wrkResults = '';
//     if (wrkValue != null && wrkValue.length > 0 ) {
//         if (wrkValue.indexOf(',') == -1 ){
//               wrkList = [];
//               wrkList.push(wrkValue);
//         }else {
//               wrkList = wrkValue.split(',');
//         }
//         listLen = wrkList.length;
//         for (j=0; j<listLen; j++) {
//             if (wrkList[j] != null){
//                  wrkResults += "<tr><td>&nbsp;&nbsp;&nbsp;&nbsp;" + wrkList[j].replace(/^\s+|\s+$/g,'') + "</td></tr>";
//                  wrkResultsCnt += 1;
//             }
//         }
//     }
//     SectionObj.UnformatBodyVal = (wrkResults ==  '') ?  "&nbsp;&nbsp;No Home Treatments Needed": wrkResults ;
//     SectionObj.SectionCntVal = wrkResultsCnt;

    // DME Order Processing
    listLen = elementObj.RESULT_CNT;
    if (listLen > 0) {
        for (h = 0; h < listLen; h++) {
            resultsItem = elementObj.RESULTS[h];
            wrkCnt = resultsItem.ENT_NUTRN_CNT;
            if (wrkCnt> 0) {
                ResultItms.SectionObj = CC_SectionManagement.entNutrH6Sec;
                ResultItms.DMEOrder = resultsItem.ENT_NUTRN_EVENTS ;
                DME_OrdersProcessing0(wrkCnt,ResultItms );
            }

            wrkCnt = resultsItem.IV_CNT;
            if (wrkCnt> 0) {
                ResultItms.SectionObj = CC_SectionManagement.ivH6Sec;
                ResultItms.DMEOrder = resultsItem.IV_EVENTS ;
                DME_OrdersProcessing0(wrkCnt,ResultItms );
            }

            wrkCnt = resultsItem.MOBILITY_CNT;
            if (wrkCnt> 0) {
                ResultItms.SectionObj = CC_SectionManagement.mobH6Sec;
                ResultItms.DMEOrder = resultsItem.MOBILITY_EVENTS ;
                DME_OrdersProcessing0(wrkCnt,ResultItms );
            }


            wrkCnt = resultsItem.RESPIRATORY_CNT;
            if (wrkCnt> 0) {
                ResultItms.SectionObj = CC_SectionManagement.respH6Sec;
                ResultItms.DMEOrder = resultsItem.RESPIRATORY_EVENTS ;
                DME_OrdersProcessing0(wrkCnt,ResultItms );
            }

            wrkCnt = resultsItem.UROLOGY_CNT;
            if (wrkCnt> 0) {
                ResultItms.SectionObj = CC_SectionManagement.uroH6Sec;
                ResultItms.DMEOrder = resultsItem.UROLOGY_EVENTS ;
                DME_OrdersProcessing0(wrkCnt,ResultItms );

            }

            wrkCnt = resultsItem.OSTOMY_CNT;
            if (wrkCnt> 0) {
                ResultItms.SectionObj = CC_SectionManagement.ostomyH6Sec;
                ResultItms.DMEOrder = resultsItem.OSTOMY_EVENTS ;
                DME_OrdersProcessing0(wrkCnt,ResultItms );

            }

            wrkCnt = resultsItem.WOUND_PIN_CNT;
            if (wrkCnt> 0) {
                ResultItms.SectionObj = CC_SectionManagement.woundH6Sec;
                ResultItms.DMEOrder = resultsItem.WOUND_PIN_EVENTS ;
                DME_OrdersProcessing0(wrkCnt,ResultItms );

            }
        }
    }
    //"EN_DATA":
    ResultItms.SectionObj = CC_SectionManagement.entNutrH6Sec;
    ResultItms.DMEOrder = elementObj.EN_DATA;
    DME_checkbox_processing(ResultItms);


    //"IV_DATA":
    ResultItms.SectionObj = CC_SectionManagement.ivH6Sec;
    ResultItms.DMEOrder = elementObj.IV_DATA;
    DME_checkbox_processing(ResultItms);

    //"MOBILITY_DATA":
    ResultItms.SectionObj = CC_SectionManagement.mobH6Sec;
    ResultItms.DMEOrder = elementObj.MOBILITY_DATA;
    DME_checkbox_processing(ResultItms);

    //"RESPIRATORY_DATA":
    ResultItms.SectionObj = CC_SectionManagement.respH6Sec;
    ResultItms.DMEOrder = elementObj.RESPIRATORY_DATA;
    DME_checkbox_processing(ResultItms);

    //"UROLOGY_DATA": "O::",
    ResultItms.SectionObj = CC_SectionManagement.uroH6Sec;
    ResultItms.DMEOrder = elementObj.UROLOGY_DATA;
    DME_checkbox_processing(ResultItms);

    //"OSTOMY_DATA": "O::",
    ResultItms.SectionObj = CC_SectionManagement.ostomyH6Sec;
    ResultItms.DMEOrder = elementObj.OSTOMY_DATA;
    DME_checkbox_processing(ResultItms);

    //"WOUND_DATA": "O::"
    ResultItms.SectionObj = CC_SectionManagement.woundH6Sec;
    ResultItms.DMEOrder = elementObj.WOUND_DATA;
    DME_checkbox_processing(ResultItms);

    //Vendors

    /* var vendorList = [];
     vendorList = elementObj.VENDORS ;
     listLen = elementObj.VENDORS_CNT;
     wrkResults = '';
     for (i = 0 ; i < listLen; i++) {
     wrkResults += '&nbsp&nbsp&nbsp&nbsp' + vendorList[i].VENDORS_VAL + '<br/>';
     }
     SectionObj = CC_SectionManagement.vndrEquipH6Sec;
     SectionObj.UnformatBodyVal = (wrkResults ==  '') ?  "": wrkResults ;
     SectionObj.SectionCntVal = listLen; */

    wrkCnt = 0;
    wrkResults = '';

    if (elementObj.EQUIP_VENDOR1 !== "" && elementObj.EQUIP_VENDOR1 != "In Error") {
        wrkResults += '&nbsp&nbsp&nbsp&nbsp' + elementObj.EQUIP_VENDOR1 + '<br>';
        wrkCnt +=1;
    }
    if (elementObj.EQUIP_VENDOR2 !== "" && elementObj.EQUIP_VENDOR2 != "In Error") {
        wrkResults += '&nbsp&nbsp&nbsp&nbsp' + elementObj.EQUIP_VENDOR2 + '<br>';
        wrkCnt +=1;
    }
    if (elementObj.EQUIP_VENDOR3 !== "" && elementObj.EQUIP_VENDOR3 != "In Error") {
        wrkResults += '&nbsp&nbsp&nbsp&nbsp' + (elementObj.EQUIP_VENDOR3) + '<br>';
        wrkCnt +=1;
    }
    if (elementObj.EQUIP_VENDOR4 !== "" && elementObj.EQUIP_VENDOR1 != "In Error") {
        wrkResults += '&nbsp&nbsp&nbsp&nbsp' + elementObj.EQUIP_VENDOR4 + '<br>';
        wrkCnt +=1;
    }

    SectionObj = CC_SectionManagement.vndrEquipH6Sec;
    SectionObj.UnformatBodyVal = (wrkResults ==  '') ?  "": wrkResults ;
    SectionObj.SectionCntVal = wrkCnt;


    wrkCnt = 0;
    wrkResults = '';

    if (elementObj.HM_HEALTH_VENDOR1 !== "" && elementObj.HM_HEALTH_VENDOR1 != "In Error") {
        wrkResults += '&nbsp&nbsp&nbsp&nbsp' + elementObj.HM_HEALTH_VENDOR1 + '<br>';
        wrkCnt +=1;
    }
    if (elementObj.HM_HEALTH_VENDOR2 !== "" && elementObj.HM_HEALTH_VENDOR2 != "In Error") {
        wrkResults += '&nbsp&nbsp&nbsp&nbsp' + elementObj.HM_HEALTH_VENDOR2 + '<br>';
        wrkCnt +=1;
    }
    if (elementObj.HM_HEALTH_VENDOR3 !== "" && elementObj.HM_HEALTH_VENDOR3 != "In Error") {
        wrkResults += '&nbsp&nbsp&nbsp&nbsp' + (elementObj.HM_HEALTH_VENDOR3) + '<br>';
        wrkCnt +=1;
    }


    SectionObj = CC_SectionManagement.vndrHomeHealthH6Sec;
    SectionObj.UnformatBodyVal = (wrkResults ==  '') ?  "": wrkResults ;
    SectionObj.SectionCntVal = wrkCnt;

    /*var wrkList1 = [];
     wrkList1 = elementObj.SR_REQS ;
     listLen = elementObj.SR_REQS_CNT;

     wrkResults = '';
     for (i = 0 ; i < listLen; i++) {
     wrkResults += '&nbsp&nbsp&nbsp&nbsp' + wrkList1[i].SR_REQVAL + '<br/>';
     }*/

    wrkCnt = 0;
    wrkResults = '';

    if (elementObj.NURS_EVAL_STAT !== "" && elementObj.NURS_EVAL_STAT != "In Error") {
        wrkResults += '&nbsp&nbsp&nbsp&nbsp' + elementObj.NURS_EVAL_STAT + '<br>';
        wrkCnt +=1;
    }
    if (elementObj.HOS_EVAL_STAT !== "" && elementObj.HOS_EVAL_STAT != "In Error") {
        wrkResults += '&nbsp&nbsp&nbsp&nbsp' + elementObj.HOS_EVAL_STAT + '<br>';
        wrkCnt +=1;
    }
    if (elementObj.NURS_VISITS_STAT !== "" && elementObj.NURS_VISITS_STAT != "In Error") {
        wrkResults += '&nbsp&nbsp&nbsp&nbsp' + elementObj.NURS_VISITS_STAT + '<br>';
        wrkCnt +=1;
    }
    SectionObj = CC_SectionManagement.serviceReqH6Sec;
    SectionObj.UnformatBodyVal = (wrkResults ==  '') ?  "": wrkResults ;
    SectionObj.SectionCntVal = wrkCnt;

//-----------------------------------------------------------------------------

    SectionObj = CC_SectionManagement.entNutrH6Sec;
    SectionObj.idLabel =  'entNutrH6Sec';
    SectionObj.TLabel1 =  'Nutrition DME';
    SectionObj.SectionCnt =   ' (' + SectionObj.SectionCntVal + ')';
    SectionObj.SectionClosed = 'closed';
    SectionObj.Disabled_Lbl = (SectionObj.SectionCntVal == 0 ) ? 'grey': '';
    SectionObj.CustIcon =  (SectionObj.SectionCntVal == 0 ) ? 'background-image:none;' : '';
    SectionObj.HideIfEmpty = 'false';
    SectionObj.ContentBody = '<table id="EN_DME" class="header"><th class="col-1">Order Date</th><th class="col-2">DME</th><th class="col-3">Complete</th></tr>' +
        SectionObj.UnformatBodyVal + '</table>';
    hmSupplies.entNutrH6Section =
        chla.eApps.Funcs.parseTemplate( chla.eApps.Vars.H6_Tmpl.join('') ,SectionObj);

    SectionObj = CC_SectionManagement.ivH6Sec;
    SectionObj.idLabel =  'ivH6Sec';
    SectionObj.TLabel1 =  'IV DME';
    SectionObj.SectionCnt =   ' (' + SectionObj.SectionCntVal + ')';
    SectionObj.SectionClosed = 'closed';
    SectionObj.Disabled_Lbl = (SectionObj.SectionCntVal == 0 ) ? 'grey': '';
    SectionObj.CustIcon =  (SectionObj.SectionCntVal == 0 ) ? 'background-image:none;' : '';
    SectionObj.HideIfEmpty = 'false'
    SectionObj.ContentBody = '<table id="IV_DME" class="header"><th class="col-1">Order Date</th><th class="col-2">DME</th><th class="col-3">Complete</th></tr>' +
        SectionObj.UnformatBodyVal + '</table>';
    hmSupplies.ivH6Section =
        chla.eApps.Funcs.parseTemplate( chla.eApps.Vars.H6_Tmpl.join('') ,SectionObj);

    SectionObj = CC_SectionManagement.mobH6Sec;
    SectionObj.idLabel =  'mobH6Sec';
    SectionObj.TLabel1 =  'Mobility DME';
    SectionObj.SectionCnt =   ' (' + SectionObj.SectionCntVal + ')';
    SectionObj.SectionClosed = 'closed';
    SectionObj.Disabled_Lbl = (SectionObj.SectionCntVal == 0 ) ? 'grey': '';
    SectionObj.CustIcon =  (SectionObj.SectionCntVal == 0 ) ? 'background-image:none;' : '';
    SectionObj.HideIfEmpty = 'false'
    SectionObj.ContentBody = '<table id="MOB_DME" class="header"><th class="col-1">Order Date</th><th class="col-2">DME</th><th class="col-3">Complete</th></tr>' +
        SectionObj.UnformatBodyVal + '</table>';
    hmSupplies.mobH6Section =
        chla.eApps.Funcs.parseTemplate( chla.eApps.Vars.H6_Tmpl.join('') ,SectionObj);

    SectionObj = CC_SectionManagement.respH6Sec;
    SectionObj.idLabel =  'respH6Sec';
    SectionObj.TLabel1 =  'Respiratory DME';
    SectionObj.SectionCnt =   ' (' + SectionObj.SectionCntVal + ')';
    SectionObj.SectionClosed = 'closed';
    SectionObj.Disabled_Lbl = (SectionObj.SectionCntVal == 0 ) ? 'grey': '';
    SectionObj.CustIcon = (SectionObj.SectionCntVal == 0 ) ? 'background-image:none;' : '';
    SectionObj.HideIfEmpty = 'false';
    SectionObj.ContentBody = '<table id="RES_DME" class="header"><th class="col-1">Order Date</th><th class="col-2">DME</th><th class="col-3">Complete</th></tr>' +
        SectionObj.UnformatBodyVal + '</table>';
    hmSupplies.respH6Section =
        chla.eApps.Funcs.parseTemplate( chla.eApps.Vars.H6_Tmpl.join('') ,SectionObj);

    SectionObj = CC_SectionManagement.uroH6Sec;
    SectionObj.idLabel =  'uroH6Sec';
    SectionObj.TLabel1 =  'Urology DME';
    SectionObj.SectionCnt =   ' (' + SectionObj.SectionCntVal + ')';
    SectionObj.SectionClosed = 'closed';
    SectionObj.Disabled_Lbl = (SectionObj.SectionCntVal == 0 ) ? 'grey': '';
    SectionObj.CustIcon = (SectionObj.SectionCntVal == 0 ) ? 'background-image:none;' : '';
    SectionObj.HideIfEmpty = 'false';
    SectionObj.ContentBody = '<table id="URO_DME" class="header"><th class="col-1">Order Date</th><th class="col-2">DME</th><th class="col-3">Complete</th></tr>' +
        SectionObj.UnformatBodyVal + '</table>';
    hmSupplies.uroH6Section =
        chla.eApps.Funcs.parseTemplate( chla.eApps.Vars.H6_Tmpl.join('') ,SectionObj);

    SectionObj = CC_SectionManagement.ostomyH6Sec;
    SectionObj.idLabel =  'ostomyH6Sec';
    SectionObj.TLabel1 =  'Ostomy DME';
    SectionObj.SectionCnt =   ' (' + SectionObj.SectionCntVal + ')';
    SectionObj.SectionClosed = 'closed';
    SectionObj.Disabled_Lbl = (SectionObj.SectionCntVal == 0 ) ? 'grey': '';
    SectionObj.CustIcon = (SectionObj.SectionCntVal == 0 ) ? 'background-image:none;' : '';
    SectionObj.HideIfEmpty = 'false';
    SectionObj.ContentBody = '<table id="OST_DME" class="header"><th class="col-1">Order Date</th><th class="col-2">DME</th><th class="col-3">Complete</th></tr>' +
        SectionObj.UnformatBodyVal + '</table>';
    hmSupplies.ostomyH6Section =
        chla.eApps.Funcs.parseTemplate( chla.eApps.Vars.H6_Tmpl.join('') ,SectionObj);

    SectionObj = CC_SectionManagement.woundH6Sec;
    SectionObj.idLabel =  'woundH6Sec';
    SectionObj.TLabel1 =  'Wound and Pin DME';
    SectionObj.SectionCnt =   ' (' + SectionObj.SectionCntVal + ')';
    SectionObj.SectionClosed = 'closed';
    SectionObj.Disabled_Lbl = (SectionObj.SectionCntVal == 0 ) ? 'grey': '';
    SectionObj.CustIcon = (SectionObj.SectionCntVal == 0 ) ? 'background-image:none;' : '';
    SectionObj.HideIfEmpty = 'false';
    SectionObj.ContentBody = '<table id="WPN_DME" class="header"><th class="col-1">Order Date</th><th class="col-2">DME</th><th class="col-3">Complete</th></tr>' +
        SectionObj.UnformatBodyVal + '</table>';
    hmSupplies.woundH6Section =
        chla.eApps.Funcs.parseTemplate( chla.eApps.Vars.H6_Tmpl.join('') ,SectionObj);

    SectionObj = CC_SectionManagement.vndrHomeHealthH6Sec;
    SectionObj.idLabel =  'vndrHomeHealthH6Sec';
    SectionObj.TLabel1 =  'Home Health';
    SectionObj.SectionCnt =   ' (' + SectionObj.SectionCntVal + ')';
    SectionObj.SectionClosed = 'closed';
    SectionObj.Disabled_Lbl = (SectionObj.SectionCntVal == 0 ) ? 'grey': '';
    SectionObj.CustIcon =  (SectionObj.SectionCntVal == 0 ) ? 'background-image:none;' : '';
    SectionObj.HideIfEmpty = 'false'
    SectionObj.ContentBody = '<table>' + SectionObj.UnformatBodyVal + '</table>';
    hmSupplies.vndrHomeHealthH6Section =
        chla.eApps.Funcs.parseTemplate( chla.eApps.Vars.H6_Tmpl.join('') ,SectionObj);

    SectionObj = CC_SectionManagement.vndrEquipH6Sec;
    SectionObj.idLabel =  'vndrEquipH6Sec';
    SectionObj.TLabel1 =  'Equipment';
    SectionObj.SectionCnt =   ' (' + SectionObj.SectionCntVal + ')';
    SectionObj.SectionClosed = 'closed';
    SectionObj.Disabled_Lbl = (SectionObj.SectionCntVal == 0 ) ? 'grey': '';
    SectionObj.CustIcon =  (SectionObj.SectionCntVal == 0 ) ? 'background-image:none;' : '';
    SectionObj.HideIfEmpty = 'false'
    SectionObj.ContentBody = '<table>' + SectionObj.UnformatBodyVal + '</table>';
    hmSupplies.vndrEquipH6Section =
        chla.eApps.Funcs.parseTemplate( chla.eApps.Vars.H6_Tmpl.join('') ,SectionObj);

    SectionObj = CC_SectionManagement.vendorH5Sec;
    SectionObj.idLabel =  'vendorH5Sec';
    hmSupplies.vendorH5Section_cnt = CC_SectionManagement.vndrEquipH6Sec.SectionCntVal +
        CC_SectionManagement.vndrHomeHealthH6Sec.SectionCntVal;
    SectionObj.TLabel1 =  'Vendors';
    SectionObj.SectionCnt =   '';
    SectionObj.SectionClosed = (hmSupplies.vendorH5Section_cnt  == 0 ) ? 'closed': '';
    SectionObj.Disabled_Lbl = '';
    SectionObj.CustIcon =  '';
    SectionObj.HideIfEmpty = 'false';
    SectionObj.ContentBody = hmSupplies.vndrEquipH6Section + hmSupplies.vndrHomeHealthH6Section  ;
    hmSupplies.vendorH5Section =
        chla.eApps.Funcs.parseTemplate( chla.eApps.Vars.H5_Tmpl.join('') ,SectionObj);

    SectionObj = CC_SectionManagement.serviceReqH6Sec;
    SectionObj.idLabel =  'serviceReqH6Sec';
    SectionObj.TLabel1 =  'Service Requests';
    SectionObj.SectionCnt =   ' (' + SectionObj.SectionCntVal + ')';
    SectionObj.SectionClosed = 'closed';
    SectionObj.Disabled_Lbl = (SectionObj.SectionCntVal == 0 ) ? 'grey': '';
    SectionObj.CustIcon =  (SectionObj.SectionCntVal == 0 ) ? 'background-image:none;' : '';
    SectionObj.HideIfEmpty = 'false'
    SectionObj.ContentBody = '<table>' + SectionObj.UnformatBodyVal + '</table>';
    hmSupplies.serviceReqH6Section =
        chla.eApps.Funcs.parseTemplate( chla.eApps.Vars.H6_Tmpl.join('') ,SectionObj);

    SectionObj = CC_SectionManagement.SR_REQSH5Sec;
    SectionObj.idLabel =  'SR_REQSH5Sec';
    SectionObj.TLabel1 =  'Home Health Nursing Referrals';
    hmSupplies.SR_REQSH5Section_cnt = CC_SectionManagement.serviceReqH6Sec.SectionCntVal;
    SectionObj.SectionCnt =   ' ';
    SectionObj.SectionClosed = (hmSupplies.SR_REQSH5Section_cnt  == 0 ) ? 'closed': '';
    SectionObj.Disabled_Lbl = '';
    SectionObj.CustIcon =  '';
    SectionObj.HideIfEmpty = 'false';
    SectionObj.ContentBody = hmSupplies.serviceReqH6Section;
    hmSupplies.SR_REQSH5Section =
        chla.eApps.Funcs.parseTemplate( chla.eApps.Vars.H5_Tmpl.join('') ,SectionObj);

    SectionObj = CC_SectionManagement.DME_OrderedH5Sec;
    hmSupplies.DME_OrderedH5Section_cnt =
        CC_SectionManagement.entNutrH6Sec.SectionCntVal +
        CC_SectionManagement.ivH6Sec.SectionCntVal +
        CC_SectionManagement.mobH6Sec.SectionCntVal +
        CC_SectionManagement.respH6Sec.SectionCntVal +
        CC_SectionManagement.woundH6Sec.SectionCntVal +
        CC_SectionManagement.uroH6Sec.SectionCntVal +
        CC_SectionManagement.ostomyH6Sec.SectionCntVal ;

    SectionObj.idLabel =  'DME_OrderedH5Sec';
    SectionObj.TLabel1 =  'DME Ordered';
    SectionObj.SectionCnt =   '';
    SectionObj.SectionClosed = (hmSupplies.DME_OrderedH5Section_cnt == 0 ) ? 'closed': '';
    SectionObj.Disabled_Lbl =  '';
    SectionObj.CustIcon = '';
    SectionObj.HideIfEmpty = 'false';
    SectionObj.ContentBody =  hmSupplies.entNutrH6Section +
        hmSupplies.ivH6Section +
        hmSupplies.mobH6Section +
        hmSupplies.respH6Section +
        hmSupplies.woundH6Section +
        hmSupplies.uroH6Section +
        hmSupplies.ostomyH6Section;
    SectionObj.ContentBody +=  (hmSupplies.DME_OrderedH5Section_cnt > 0 ) ?'<button id="dmeBtnSave" class="eappsBtnGrey">Save</button>': '';
    hmSupplies.DME_OrderedH5Section =
        chla.eApps.Funcs.parseTemplate(chla.eApps.Vars.H5_Tmpl.join('') ,SectionObj);

    compContent =  chla.eApps.Funcs.parseTemplate( hmSupplies_Tmpl.join('')  ,hmSupplies);

    //-------------------------------------
    //  CC DIV Rendering
    //-------------------------------------
    chla.eAppsUtil.Logger.LogWarn('<textarea rows="4" style="width:99%;">hm_supplies </br>' + chla.eApps.Funcs.HtmlLogFormatter(compContent) + "</textarea>");
    target.innerHTML = compContent;

    if (hmSupplies.DME_OrderedH5Section_cnt > 0 ) {
        $("table#EN_DME tbody tr td ").children("input[type='checkbox']").on("click",
            function(){
                hmSupplies.EN_DATA_chgd = 'X::';
                chla.hm_supplies.eApps.SaveButtonAction('#dmeBtnSave', 'ENABLE')
            }
        );

        $("table#IV_DME tbody tr td ").children("input[type='checkbox']").on("click",
            function(){
                hmSupplies.IV_DATA_chgd = 'X::';
                chla.hm_supplies.eApps.SaveButtonAction('#dmeBtnSave', 'ENABLE')
            }
        );

        $("table#MOB_DME tbody tr td ").children("input[type='checkbox']").on("click",
            function(){
                hmSupplies.MOBILITY_DATA_chgd = 'X::';
                chla.hm_supplies.eApps.SaveButtonAction('#dmeBtnSave', 'ENABLE')
            }
        );

        $("table#RES_DME tbody tr td ").children("input[type='checkbox']").on("click",
            function(){
                hmSupplies.RESPIRATORY_DATA_chgd = 'X::';
                chla.hm_supplies.eApps.SaveButtonAction('#dmeBtnSave', 'ENABLE')
            }
        );

        $("table#URO_DME tbody tr td ").children("input[type='checkbox']").on("click",
            function(){
                hmSupplies.UROLOGY_DATA_chgd = 'X::';
                chla.hm_supplies.eApps.SaveButtonAction('#dmeBtnSave', 'ENABLE')
            }
        );

        $("table#WDP_DME tbody tr td ").children("input[type='checkbox']").on("click",
            function(){
                hmSupplies.WOUND_DATA_chgd = 'X::';
                chla.hm_supplies.eApps.SaveButtonAction('#dmeBtnSave', 'ENABLE')
            }
        );
        $("table#OST_DME tbody tr td ").children("input[type='checkbox']").on("click",
            function(){
                hmSupplies.OSTOMY_DATA_chgd = 'X::';
                chla.hm_supplies.eApps.SaveButtonAction('#dmeBtnSave', 'ENABLE')
            }
        );


        chla.hm_supplies.eApps.HoverDataFormater =  function (sourceData) {
            var tempstr = '<span style="font-weight:bold;">Update History</span></br>';
            for (var i = 0, len = sourceData.UPDT_CNT; i < len; i ++) {
                tempstr += (sourceData.UPDT_LIST[i].UENTNUTR_DATA ==  'X::') ? 'Nutrition data changed  '   : '' ;
                tempstr += (sourceData.UPDT_LIST[i].UIV_DATA ==  'X::') ? 'IV data changed  '  : '' ;
                tempstr += (sourceData.UPDT_LIST[i].UMOBILITY_DATA ==  'X::') ? 'Mobility data changed  '   : '' ;
                tempstr += (sourceData.UPDT_LIST[i].URESPIRATORY_DATA ==  'X::') ? 'Respiratory data changed  '   : '' ;
                tempstr += (sourceData.UPDT_LIST[i].UUROLOGY_DATA ==  'X::') ? 'Urology data changed  '   : '' ;
                tempstr += (sourceData.UPDT_LIST[i].UWOUND_DATA ==  'X::') ? 'Wound/Pin data changed  '   : '' ;
                tempstr += (sourceData.UPDT_LIST[i].UOSTOMY_DATA ==  'X::') ? 'Ostomy data changed  '   : '' ;
                tempstr += sourceData.UPDT_LIST[i].UPDT_MODBY ;
                tempstr += ' on ';
                tempstr += sourceData.UPDT_LIST[i].UPDT_TM ;
                tempstr +=  "</br>" ;
            };
            //chla.eAppsUtil.Logger.LogInfo('chla.hm_supplies.eApps.HoverDataFormater: ' + chla.eApps.Funcs.HtmlLogFormatter(tempstr));
            return tempstr ;
        };

        chla.hm_supplies.eApps.CSSBehaviors.InitPopUpsDiv(
            chla.hm_supplies.eApps.HoverDataFormater(elementObj), 'button#dmeBtnSave', 'R');



        chla.hm_supplies.eApps.CCLreqObjSave = null;
        $("#dmeBtnSave").on( "click", function () {
            var EN_DATA = '';
            var IV_DATA = '';
            var MOBILITY_DATA = '';
            var RESPIRATORY_DATA = '';
            var UROLOGY_DATA = '';
            var WOUND_DATA = '';
            var OSTOMY_DATA = '';
            chla.hm_supplies.eApps.SaveButtonAction('#dmeBtnSave', 'OK');

            EN_DATA = $("table#EN_DME tbody tr td ").children("input[type='checkbox']").map(function(){
                return (this.id + ':' +$(this).prop('checked'));
            }).get().join('%');

            IV_DATA = $("table#IV_DME tbody tr td ").children("input[type='checkbox']").map(function(){
                return (this.id + ':' +$(this).prop('checked'));
            }).get().join('%');

            MOBILITY_DATA = $("table#MOB_DME tbody tr td ").children("input[type='checkbox']").map(function(){
                return (this.id + ':' +$(this).prop('checked'));
            }).get().join('%');

            RESPIRATORY_DATA = $("table#RES_DME tbody tr td ").children("input[type='checkbox']").map(function(){
                return (this.id + ':' +$(this).prop('checked'));
            }).get().join('%');

            UROLOGY_DATA = $("table#URO_DME tbody tr td ").children("input[type='checkbox']").map(function(){
                return (this.id + ':' +$(this).prop('checked'));
            }).get().join('%');

            WOUND_DATA =  $("table#WDP_DME tbody tr td ").children("input[type='checkbox']").map(function(){
                return (this.id + ':' +$(this).prop('checked'));
            }).get().join('%');

            OSTOMY_DATA =  $("table#OST_DME tbody tr td ").children("input[type='checkbox']").map(function(){
                return (this.id + ':' +$(this).prop('checked'));
            }).get().join('%');

            chla.hm_supplies.eApps.CCLparmsSave = '^MINE^, value($VIS_Encntrid$),"' +
                hmSupplies.EN_DATA_chgd + EN_DATA  + '","' +
                hmSupplies.IV_DATA_chgd + IV_DATA  + '","' +
                hmSupplies.MOBILITY_DATA_chgd + MOBILITY_DATA + '","' +
                hmSupplies.RESPIRATORY_DATA_chgd + RESPIRATORY_DATA + '","' +
                hmSupplies.UROLOGY_DATA_chgd + UROLOGY_DATA + '","' +
                hmSupplies.WOUND_DATA_chgd + WOUND_DATA + '","' +
                hmSupplies.OSTOMY_DATA_chgd + OSTOMY_DATA + '",' +
                'value($USR_PersonID$)';
            if (chla.hm_supplies.eApps.CCLreqObjSave == null){
                chla.hm_supplies.eApps.CCLreqObjSave = new chla.eApps.CCLRequest.BtnSaveBehavior();
                chla.hm_supplies.eApps.CCLreqObjSave.ObjectName='OBJ_chla.hm_supplies.eApps.CCLreqObjSave';
                chla.hm_supplies.eApps.CCLreqObjSave.BtnSaveBehaviorFunc = chla.hm_supplies.eApps.SaveButtonAction ;
            };
            chla.hm_supplies.eApps.CCLreqObjSave.DataTransfer( chla.hm_supplies.eApps.CCLreqObjSave,
                'CHLA_CA_MP_CC_DC_INS_DME_JSON',
                chla.hm_supplies.eApps.CCLparmsSave  ,
                '#DC_tbtnSave');

        });


        chla.hm_supplies.eApps.SaveButtonAction('#dmeBtnSave', 'RESET');
    }

    $('div#DME_OrderedH5Sec_DivSubSec H2.h5a-marker').on( "click",chla.hm_supplies.eApps.CSSBehaviors.SingleH5SectionToggle) ;

    $('div#vendorH5Sec_DivSubSec H2.h5a-marker').on( "click",chla.hm_supplies.eApps.CSSBehaviors.SingleH5SectionToggle) ;

    $('div#SR_REQSH5Sec_DivSubSec H2.h5a-marker').on( "click",chla.hm_supplies.eApps.CSSBehaviors.SingleH5SectionToggle) ;

    if (CC_SectionManagement.entNutrH6Sec.SectionCntVal  >0 ){
        $('div#entNutrH6Sec_DivSubSec1.sub-sec h2.fo-sub-sec-hd').on( "click",chla.hm_supplies.eApps.CSSBehaviors.SingleH6SectionToggle) ;
    }
    if (CC_SectionManagement.ivH6Sec.SectionCntVal  >0 ){
        $('div#ivH6Sec_DivSubSec1.sub-sec h2.fo-sub-sec-hd').on( "click",chla.hm_supplies.eApps.CSSBehaviors.SingleH6SectionToggle) ;
    }
    if (CC_SectionManagement.mobH6Sec.SectionCntVal  >0 ){
        $('div#mobH6Sec_DivSubSec1.sub-sec h2.fo-sub-sec-hd').on( "click",chla.hm_supplies.eApps.CSSBehaviors.SingleH6SectionToggle) ;
    }
    if (CC_SectionManagement.respH6Sec.SectionCntVal  >0 ){
        $('div#respH6Sec_DivSubSec1.sub-sec h2.fo-sub-sec-hd').on( "click",chla.hm_supplies.eApps.CSSBehaviors.SingleH6SectionToggle) ;
    }
    if (CC_SectionManagement.woundH6Sec.SectionCntVal  >0 ){
        $('div#woundH6Sec_DivSubSec1.sub-sec h2.fo-sub-sec-hd').on( "click",chla.hm_supplies.eApps.CSSBehaviors.SingleH6SectionToggle) ;
    }
    if (CC_SectionManagement.uroH6Sec.SectionCntVal  >0 ){
        $('div#uroH6Sec_DivSubSec1.sub-sec h2.fo-sub-sec-hd').on( "click",chla.hm_supplies.eApps.CSSBehaviors.SingleH6SectionToggle) ;
    }

    if (CC_SectionManagement.ostomyH6Sec.SectionCntVal  >0 ){
        $('div#ostomyH6Sec_DivSubSec1.sub-sec h2.fo-sub-sec-hd').on( "click",chla.hm_supplies.eApps.CSSBehaviors.SingleH6SectionToggle) ;
    }

    if (CC_SectionManagement.vndrHomeHealthH6Sec.SectionCntVal  >0 ){
        $('div#vndrHomeHealthH6Sec_DivSubSec1.sub-sec h2.fo-sub-sec-hd').on( "click",chla.hm_supplies.eApps.CSSBehaviors.SingleH6SectionToggle) ;
    }
    if (CC_SectionManagement.vndrEquipH6Sec.SectionCntVal  >0 ){
        $('div#vndrEquipH6Sec_DivSubSec1.sub-sec h2.fo-sub-sec-hd').on( "click",chla.hm_supplies.eApps.CSSBehaviors.SingleH6SectionToggle) ;
    }
    if (CC_SectionManagement.serviceReqH6Sec.SectionCntVal  >0 ){
        $('div#serviceReqH6Sec_DivSubSec1.sub-sec h2.fo-sub-sec-hd').on( "click",chla.hm_supplies.eApps.CSSBehaviors.SingleH6SectionToggle) ;
    }
};


//::===========================================================================
//:: CC - Admission Info
//::---------------------------------------------------------------------------
chla.admit_info = function () { };
chla.admit_info.prototype = new MPage.Component();
chla.admit_info.prototype.constructor = MPage.Component;
chla.admit_info.prototype.base = MPage.Component.prototype;
chla.admit_info.prototype.name = "chla.admit_info";
chla.admit_info.prototype.cclProgram = "chla_ca_mp_cc_map_orders_json";
chla.admit_info.prototype.cclParams = [];
chla.admit_info.prototype.cclDataType = "JSON";
chla.admit_info.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("encounterId");
    this.cclParams[2] = this.getProperty("personId");
};


chla.admit_info.prototype.render = function () {
    var component = this;
    var elementObj = component.data.RPTDATA;
    var target = this.getTarget();
    var compContent;

    //-------------------------------------
    //  Common Used Variable Names for RPTDATA processing
    //-------------------------------------
    var i, j , k ;             // common for loop values
    var SectionObj,            // CC_SectionManagement
        // variables to hold RPTData values
        wrkRPTDATA_cnt,
        wrkRPTDATA,
        wrkRPTDATA_idx,
        wrkCnt,
        wrkValue,
        wrkDesc,
        wrkList,
        wrkPrevValue,
        wrkResults;

    var listLen,
        listLen2;
    //NOTE:: numbers used to denote the code hierarchy depth variable is used at.
    //NOTE:: i.e. inside for, while, if command statement

    //-------------------------------------
    //  CC - H5/H6  Management Section
    //-------------------------------------
    var CC_SectionManagement ={};

    CC_SectionManagement.mapdiagnosisH5Sec = new  chla.eApps.SectionHeader();
    CC_SectionManagement.mapstatusH5Sec     = new  chla.eApps.SectionHeader();
    CC_SectionManagement.maporderH5Sec     = new  chla.eApps.SectionHeader();

    CC_SectionManagement.mapdiagnosisH5Sec.SectionCntVal = 0;
    CC_SectionManagement.mapstatusH5Sec.SectionCntVal = 0;
    CC_SectionManagement.maporderH5Sec.SectionCntVal = 0;

    CC_SectionManagement.mapdiagnosisH5Sec.UnformatBodyVal = '';
    CC_SectionManagement.mapstatusH5Sec.UnformatBodyVal = '';
    CC_SectionManagement.maporderH5Sec.UnformatBodyVal = '';

    //-------------------------------------
    // CC - DIV Template Data Object
    //-------------------------------------
    var admitInfo = {
        cc_id: 'x',
        personId: 0,
        encounterId: 0,
        transparentSpacer:'',
        mapdiagnosisH5Section:'',
        mapstatusH5Section:'',
        maporderH5Section:'',
        Default_mapDiagnosis_content: '<tr><td class="col-1">No Diagnosis Listed</td></tr></div>',
        mapStatusUrl: 'https://pcs.chla.usc.edu/pfe/Shared%20Documents/Forms/AllItems.aspx?RootFolder=%2Fpfe%2FShared%20Documents%2FMAP%20Education%20Content&FolderCTID=0x01200040CE381A4D8074498B9275D42948F5AC&View=%7BD0D6E2D1%2D0D62%2D48F2%2DA52D%2D809DAFAA6DBB%7D'
    } ;

    //-------------------------------------
    // Main CC - DIV Template
    //-------------------------------------
    var admitInfo_Tmpl = [
        '<div id="<#=cc_id#>" class="eapps_CC">',
        '<#=mapdiagnosisH5Section#>',
        '<#=mapstatusH5Section#>',
        '<#=maporderH5Section#>',
        '</div>'
    ]

    var mapStatus0_Tmpl = [
        '<div  id="mapStatus0">',
        '<p><a href="javascript:APPLINK(100,&quot;<#=mapStatusUrl#>&quot;,&quot;&quot;)">Click here for a list of MAPs</a></p>',
        '<p><input type="checkbox" id="MapCheck1" />&nbsp;&nbsp;&nbsp;Admission diagnosis has a MAP</p></div>',
        '<div id="mapStatus1">',
        '<dl>',
        '<dt style="float: left; clear: left;width:30%;">&nbsp;Patient is on MAP&nbsp&nbsp</dt>',
        '<dd style=style="float: left;"<label><input type="Radio" id="mapyes" name="mapStatusRadio" checked="unchecked"/>&nbsp;Yes&nbsp;&nbsp;</label>',
        '<label><input type="Radio" id="mapno" name="mapStatusRadio" checked="checked"/>&nbsp;No&nbsp;</label> </dd>',
        '<dl><p style="clear: left;"/>',
        ' </div>',
        '<div id="mapStatus2">&nbsp;</div>',
        '<div id="mapStatus3">',
        '<dl><dt style="float: left; clear: left;width: 30%;" >&nbsp;<span id="reasonText">Reason not on MAP</span></dt>',
        '<dd style="float: left;"><label><input type="Radio" id="reasonQualify" name="reasonType" />&nbsp;Does not qualify&nbsp;&nbsp;&nbsp;&nbsp;</label>',
        '<label><input type="Radio" id="reasonOther"   name="reasonType" checked />&nbsp;Other&nbsp;</label></dd>',
        '</dl><p style=" clear: left;"/>',
        '</div>',
        '<textarea id="mapStatus4" rows="4" cols="40" name="mapTA" style="margin-bottom: 3px; width:97%"></textarea>',
        '<div id="mapStatus5"><button id="admitInfoMapStatusBtnSave" class="eappsBtnGrey">Save</button></div>'
    ];
//-------------------------------------
//  Stanadard Common initializations
//-------------------------------------
    chla.admit_info.eApps = {};
    chla.admit_info.eApps.cc_id = chla.admit_info.prototype.name.replace('.','_');
    chla.admit_info.eApps.SaveButtonAction = chla.eApps.SaveButtonBehavior.enable_disable_status_reset;
    chla.admit_info.eApps.CSSBehaviors = new chla.eApps.CSSBehaviors();

    admitInfo.cc_id = chla.admit_info.eApps.cc_id;
    admitInfo.personId = this.getProperty("personId");
    admitInfo.encounterId = this.getProperty("encounterId");
    admitInfo.transparentSpacer = '<img src="' + chla.eApps.Vars.transparentSpacer + '" height="5px" width="17px"  >'

//-------------------------------------
//  RPTDATA processing
//-------------------------------------
    CC_SectionManagement.mapdiagnosisH5Sec.SectionCntVal = 0;
    CC_SectionManagement.mapdiagnosisH5Sec.UnformatBodyVal = '';

    CC_SectionManagement.mapdiagnosisH5Sec.SectionCntVal  = elementObj.DIAGNOSIS_CNT;
    wrkRPTDATA_cnt = elementObj.DIAGNOSIS_CNT;
    listLen = wrkRPTDATA_cnt;
    for (i = 0; i < wrkRPTDATA_cnt; i++) {
        wrkRPTDATA = elementObj.DIAGNOSES[i];
        if (  !(((wrkRPTDATA.DIAG_NAME).length > 0) || ((wrkRPTDATA.DIAG_CONF).length > 0) || ((wrkRPTDATA.DIAG_CLASS).length > 0)))
            listLen--;
    }
    wrkResults = '';
    for (i = 0; i < listLen; i++) {
        wrkRPTDATA = elementObj.DIAGNOSES[i];
        if (((wrkRPTDATA.DIAG_NAME).length > 0) || ((wrkRPTDATA.DIAG_CONF).length > 0) || ((wrkRPTDATA.DIAG_CLASS).length > 0)) {
            wrkResults += '<tr>';
            wrkResults += '<td class="col-1">' + wrkRPTDATA.DIAG_NAME + '</td>';
            wrkResults += '<td class="col-2">' + wrkRPTDATA.DIAG_CONF + '</td>';
            wrkResults += '<td class="col-3">' + wrkRPTDATA.DIAG_CLASS + '</td>';
            wrkResults += '</tr>';
        }
    }
    CC_SectionManagement.mapdiagnosisH5Sec.SectionCntVal = listLen;
    CC_SectionManagement.mapdiagnosisH5Sec.UnformatBodyVal = wrkResults;

    CC_SectionManagement.mapstatusH5Sec.SectionCntVal = 0;
    CC_SectionManagement.mapstatusH5Sec.UnformatBodyVal = '';

    CC_SectionManagement.maporderH5Sec.SectionCntVal = 0;
    CC_SectionManagement.maporderH5Sec.UnformatBodyVal = '';

    CC_SectionManagement.maporderH5Sec.SectionCntVal =  elementObj.MAP_ORDER_CNT;
    wrkRPTDATA_cnt = elementObj.MAP_ORDER_CNT;
    wrkResults = '';

    for (i = 0; i < wrkRPTDATA_cnt; i++) {
        wrkRPTDATA = elementObj.MAP_ORDERS[i];
        wrkResults += '<tr class="rowPopup" tip="'
            + '<ul>'
            + '<li><strong>Original Order Date:</strong> ' + wrkRPTDATA.ORIG_ORDER_DT_TM + '</li>'
            + '<li><strong>Current Start Date:</strong> ' + wrkRPTDATA.CURRENT_START_DT_TM + '</li>'
            + '<li><strong>Projected Stop Date:</strong> ' + wrkRPTDATA.PROJECTED_STOP_DT_TM + '</li>'
            + '<li><strong>Clinical Display Line:</strong> ' + wrkRPTDATA.CLINICAL_DISPLAY_LINE + '</li>'
            + '</ul>">';
        wrkResults += '<td class="col-1">' + wrkRPTDATA.ORDER_MNEMONIC + '</td>';
        wrkResults += '<td class="col-2">' + wrkRPTDATA.CLINICAL_DISPLAY_LINE + '</td>';
        wrkResults += '</tr>';
    }
    CC_SectionManagement.maporderH5Sec.UnformatBodyVal = wrkResults;
    //-------------------------------------

    SectionObj = CC_SectionManagement.mapdiagnosisH5Sec  ;
    SectionObj.idLabel =  'mapdiagnosisH5Sec';
    SectionObj.TLabel1 =  'Admission Diagnoses ';
    SectionObj.SectionCnt = ' (' + SectionObj.SectionCntVal + ')';
    SectionObj.SectionClosed = 'closed';
    SectionObj.Disabled_Lbl = (SectionObj.SectionCntVal  == 0) ? 'grey': '';
    SectionObj.CustIcon = (SectionObj.SectionCntVal == 0) ? 'background-image:none;': '';
    SectionObj.HideIfEmpty = 'false';
    SectionObj.ContentBody = '<table class="header"><tr><th class="col-1">Diagnosis</th><th class="col-2">Confirmation Status</th><th class="col-3">Classification</th></tr>';
    SectionObj.ContentBody += SectionObj.UnformatBodyVal  + '</table>';
    admitInfo.mapdiagnosisH5Section = chla.eApps.Funcs.parseTemplate( chla.eApps.Vars.H5_Tmpl.join('') ,SectionObj);

    //-------------------------------------

    SectionObj = CC_SectionManagement.mapstatusH5Sec;
    SectionObj.idLabel =  'mapstatusH5Sec';
    SectionObj.TLabel1 =  'MAP Status';
    SectionObj.SectionCnt = '';
    SectionObj.SectionClosed = '';
    SectionObj.Disabled_Lbl = '';
    SectionObj.SectionCntVal = 1;
    SectionObj.CustIcon = '';
    SectionObj.HideIfEmpty = 'false';
    SectionObj.ContentBody = chla.eApps.Funcs.parseTemplate( mapStatus0_Tmpl.join(''),admitInfo);
    admitInfo.mapstatusH5Section = chla.eApps.Funcs.parseTemplate( chla.eApps.Vars.H5_Tmpl.join('') ,SectionObj);
    //-------------------------------------

    SectionObj = CC_SectionManagement.maporderH5Sec  ;
    SectionObj.idLabel =  'maporderH5Sec';
    SectionObj.TLabel1 =  'MAP Orders';
    SectionObj.SectionCnt = ' (' + SectionObj.SectionCntVal + ')';
    SectionObj.SectionClosed = (SectionObj.SectionCntVal  == 0) ? 'closed': '';
    SectionObj.Disabled_Lbl = (SectionObj.SectionCntVal  == 0) ? 'grey': '';
    SectionObj.CustIcon = (SectionObj.SectionCntVal == 0) ? 'background-image:none;': '';
    SectionObj.HideIfEmpty = 'false';
    SectionObj.ContentBody =  '<table class="header"><tr><th class="col-1">Name</th><th class="col-2">Detail</th><th class="col-3"></th></tr>';
    SectionObj.ContentBody +=  SectionObj.UnformatBodyVal  + '</table>';
    admitInfo.maporderH5Section = chla.eApps.Funcs.parseTemplate( chla.eApps.Vars.H5_Tmpl.join('') ,SectionObj);

    //-------------------------------------
    //  CC DIV sections HTML generations ( TEMPLATE MERGE )
    //-------------------------------------
    compContent = chla.eApps.Funcs.parseTemplate( admitInfo_Tmpl.join('') ,admitInfo);

    //-------------------------------------
    //  CC DIV Rendering
    //-------------------------------------
    chla.eAppsUtil.Logger.LogWarn('<textarea rows="4" style="width:99%;">admit_info </br>' + chla.eApps.Funcs.HtmlLogFormatter(compContent) + "</textarea>");
    target.innerHTML = compContent;

//-------------------------------------
//  CC HTML/CSS behaviours
//-------------------------------------
    //-------------------------------------------------------------------------------------------------
    // Point 0 :: Visible (mapStatus# areas) - Default or   no Patient Data  to trigger transformation.
    if ( elementObj.MAP_DIAGNOSIS == 0 &&
        elementObj.MAP_ORDER_CNT == 0   ) {
        // Default MAP Status - all controls visible
        $('#MapCheck1').prop("checked", false);
        $('#mapno').prop("checked", true);
        $('#mapyes').prop("disabled", true);
        $('#mapStatus1').hide();
        $('#mapStatus2').hide();
        $('#mapStatus3').hide();
        $('#mapStatus4').hide();
    } else {
        //-------------------------------------------------------------------------------------------------
        // Point 1 ::
        if (elementObj.MAP_ORDER_CNT > 0 ) {
            $('#MapCheck1').prop("checked", true);
            $('#MapCheck1').prop("disabled", true);
            $('#mapyes').prop("checked", true);
            $('#mapStatus2').hide();
            $('#mapStatus3').hide();
            $('#mapStatus4').hide();
        }

        //-------------------------------------------------------------------------------------------------
        // Point 2 ::
        if (elementObj.MAP_ORDER_CNT == 0 )
            $('#mapyes').prop("disabled", true);

        if (elementObj.MAP_ORDER_CNT == 0 && elementObj.MAP_DIAGNOSIS == 1) {
            $('#MapCheck1').prop("checked", true);
        }
        // -------------------------------------------------------------------------------------
        // Point 3 ::
        if (elementObj.PATIENT_MAP == 1 ){
            $('#mapyes').prop("checked", true);
            if( $('#MapCheck1').prop('checked')== true ){
                $('#mapStatus2').hide();
                $('#mapStatus3').hide();
                $('#mapStatus4').hide();
            }
        } else {
            if( $('#MapCheck1').prop('checked')== true ){
                $('#reasonText').css( {'color': 'red'});
            }
        }

        //-------------------------------------------------------------------------------------------------
        // Point 3 ::
        $('#mapStatus4').val(elementObj.MAPREASON);

        //-------------------------------------------------------------------------------------------------
        // Point 4 ::

        if( elementObj.REASONTYPE == 1){
            $('#reasonQualify').prop("checked", true);
        } else {
            $('#reasonOther').prop("checked", true);
        }
    }
    //-------------------------------------------------------------------------------------------------


    $("#mapyes").click(function () {
        chla.admit_info.eApps.SaveButtonAction('#admitInfoMapStatusBtnSave', 'ENABLE');
        $('#mapyes').prop("checked", true);
        if( $('#MapCheck1').prop('checked')== false ){
            $('#mapStatus2').show();
            $('#mapStatus3').show();
            $('#mapStatus4').show();
            $('span#reasonText').css({"color":"black"});
        } else {
            $('#mapStatus2').hide();
            $('#mapStatus3').hide();
            $('#mapStatus4').hide();
        }
    });

    $("#mapno").click(function () {
        chla.admit_info.eApps.SaveButtonAction('#admitInfoMapStatusBtnSave', 'ENABLE');
        $('#mapStatus1').show();
        $('#mapStatus2').show();
        $('#mapStatus3').show();
        $('#mapStatus4').show();
        $('span#reasonText').css( {"color":"black"});
        if( $('#MapCheck1').prop('checked')== true ){
            $('span#reasonText').css( {"color":"red"});
        }
    });
    //html body div.sectionDiv div div#mapStatus3 dl dt span#reasonText
    $("#MapCheck1").click(function () {
        chla.admit_info.eApps.SaveButtonAction('#admitInfoMapStatusBtnSave', 'ENABLE');

        if( $('#MapCheck1').prop('checked')== true ){
            $('#mapno').prop('checked',true );
            $('#mapStatus1').show();
            $('#mapStatus2').show();
            $('#mapStatus3').show();
            $('#mapStatus4').show();
            $('span#reasonText').css({"color":"red"});
        } else {
            $('#mapStatus1').hide();
            $('#mapStatus2').hide();
            $('#mapStatus3').hide();
            $('#mapStatus4').hide();
            $('span#reasonText').css({"color":"black"});
        }
    });

    $("#mapStatus4").click(function () {
        chla.admit_info.eApps.SaveButtonAction('#admitInfoMapStatusBtnSave', 'ENABLE');
    });

    chla.admit_info.eApps.CSSBehaviors = new chla.eApps.CSSBehaviors();
    chla.admit_info.eApps.HoverDataFormater =  function (sourceData) {
        var tempstr = '<span style="font-weight:bold;">Update History</span></br>';
        var tempstr1 = '',UMAP_DIAGNOSIS , UPATIENT_MAP, UMAPREASON ,UREASONTYPE ;
        var dirty, dirty2, lencnt;
        lencnt = sourceData.UPDT_CNT ;
        for (var i = 0; i < lencnt; i ++) {
            dirty = false;
            dirty2 = true;
            tempstr1 = '';
            UMAP_DIAGNOSIS = sourceData.UPDT_LIST[i].UMAP_DIAGNOSIS ;
            UPATIENT_MAP = sourceData.UPDT_LIST[i].UPATIENT_MAP ;
            UMAPREASON = sourceData.UPDT_LIST[i].UMAPREASON ||'';
            UREASONTYPE = sourceData.UPDT_LIST[i].UREASONTYPE ;
            //chla.eAppsUtil.Logger.LogInfo('UMAP_DIAGNOSIS: ' + UMAP_DIAGNOSIS + ' UPATIENT_MAP: ' + UPATIENT_MAP + ' UMAPREASON: ' + UMAPREASON);
            if( i ==(lencnt - 1)  ){
                if ( lencnt < 10){

                    if (UMAP_DIAGNOSIS != null ){
                        tempstr1 =  '&nbsp;&nbsp; Map Diagnosis Update -' + (UMAP_DIAGNOSIS == 1 ? 'Yes' : 'No');
                        dirty = true;
                    }
                    if (UPATIENT_MAP != null ){
                        tempstr1 += '&nbsp;&nbsp; Patient on Map Update  -' + (UPATIENT_MAP == 1 ? 'Yes' : 'No');
                        dirty = true;
                    }
                    if (UMAPREASON != null ){
                        tempstr1 += '&nbsp;&nbsp; Map Reason Update  ';
                        dirty = true;
                    }
                    if (UREASONTYPE != null ){
                        tempstr1 += '&nbsp;&nbsp;  Map Reason Type Update  -' + (UREASONTYPE == 1 ? 'Yes' : 'No');
                        dirty = true;
                    }
                }
                dirty2 = false;
            }
            if(dirty2 == true) {

                if (UMAP_DIAGNOSIS != sourceData.UPDT_LIST[i+1].UMAP_DIAGNOSIS ){
                    tempstr1 =  '&nbsp;&nbsp; Map Diagnosis Update -' + (UMAP_DIAGNOSIS == 1 ? 'Yes' : 'No');
                    dirty = true;
                }
                if (UPATIENT_MAP != sourceData.UPDT_LIST[i+1].UPATIENT_MAP ){
                    tempstr1 += '&nbsp;&nbsp; Patient on Map Update  -' + (UPATIENT_MAP == 1 ? 'Yes' : 'No');
                    dirty = true;
                }
                if (UMAPREASON != sourceData.UPDT_LIST[i+1].UMAPREASON ){
                    tempstr1 += '&nbsp;&nbsp; Map Reason Update  ';
                    dirty = true;
                }
                if (UREASONTYPE != null ){
                    tempstr1 += '&nbsp;&nbsp;  Map Reason Type Update  -' + (UREASONTYPE == 1 ? 'Yes' : 'No');
                    dirty = true;
                }
            }
            if (dirty == true){
                tempstr += sourceData.UPDT_LIST[i].UUPDT_MODBY_ID ;
                tempstr += ' on ';
                tempstr += sourceData.UPDT_LIST[i].UUPDTDATETIME ;
                tempstr += tempstr1;
                tempstr +=  "</br>" ;
            }
        };
        return tempstr ;
    };

    chla.admit_info.eApps.CSSBehaviors.InitPopUpsDiv(
        chla.admit_info.eApps.HoverDataFormater( elementObj), 'button#admitInfoMapStatusBtnSave','T');

    chla.admit_info.eApps.CCLreqObjSave = null;
    $("#admitInfoMapStatusBtnSave").on( "click", function () {
        var patOnMAP = 0,
            mapDiagnosis = 0,
            mapReason = "",
            reasonRadio = 0,
            wrkArr = [];

        patOnMAP = ($('#mapyes').prop("checked")  == true) ? 1 : 0 ;
        mapDiagnosis = ($('#MapCheck1').prop("checked") == false)? 0 : 1 ;
//             mapReason = $('#mapStatus4').val();
        reasonRadio = ($('#reasonQualify').prop("checked")  == true) ? 1 : 0 ;

//             chla.admit_info.eApps.CCLparmsSave = "^MINE^, value($VIS_Encntrid$)," +
//                                           mapDiagnosis + "," +
//                                           patOnMAP  +  ",' " +
//                                           mapReason +  "'," +
//                                           reasonRadio  + ", value($USR_PersonID$), ^^";
        wrkArr.push('^MINE^, value($VIS_Encntrid$),');
        wrkArr.push(mapDiagnosis);
        wrkArr.push( ",");
        wrkArr.push(patOnMAP );
        wrkArr.push( ",^");
        wrkArr.push( $('#mapStatus4').val());
        wrkArr.push("^,");
        wrkArr.push(reasonRadio);
        wrkArr.push(", value($USR_PersonID$),^^");
        chla.admit_info.eApps.CCLparmsSave = wrkArr.join('');

        if (chla.admit_info.eApps.CCLreqObjSave == null){
            chla.admit_info.eApps.CCLreqObjSave = new chla.eApps.CCLRequest.BtnSaveBehavior();
            chla.admit_info.eApps.CCLreqObjSave.ObjectName='OBJ_chla.admit_info.eApps.CCLreqObjSave';
            chla.admit_info.eApps.CCLreqObjSave.BtnSaveBehaviorFunc = chla.admit_info.eApps.SaveButtonAction ;
            chla.admit_info.eApps.CCLreqObjSave.CallBackOperation = function(responseData){
                chla.admit_info.eApps.CSSBehaviors.hoverContent =
                    chla.admit_info.eApps.HoverDataFormater(responseData);
            };
        };
        chla.admit_info.eApps.CCLreqObjSave.DataTransfer(
            chla.admit_info.eApps.CCLreqObjSave,
            'chla_ca_mp_cc_inst_adinfo_json',
            chla.admit_info.eApps.CCLparmsSave  ,
            '#admitInfoMapStatusBtnSave');

    });

    chla.admit_info.eApps.SaveButtonAction('#admitInfoMapStatusBtnSave', 'RESET');

    //-------------------------------------
    //Section Collapse and Expand CSS behavior handles
    //-------------------------------------
    if(CC_SectionManagement.mapdiagnosisH5Sec.SectionCntVal > 0)
        $('div#mapdiagnosisH5Sec_DivSubSec H2.h5a-marker').on( "click",chla.admit_info.eApps.CSSBehaviors.SingleH5SectionToggle) ;

    if(CC_SectionManagement.mapstatusH5Sec.SectionCntVal > 0)
        $('div#mapstatusH5Sec_DivSubSec H2.h5a-marker').on( "click",chla.admit_info.eApps.CSSBehaviors.SingleH5SectionToggle) ;

    if(CC_SectionManagement.maporderH5Sec.SectionCntVal > 0)
        $('div#maporderH5Sec_DivSubSec H2.h5a-marker').on( "click",chla.admit_info.eApps.CSSBehaviors.SingleH5SectionToggle) ;

    reInitPopUps();

    //Initialize hovers to display additional detail

    function reInitPopUps() {
        //add the class of hover to all elements with the class of rowPopup
        $(".rowPopup").hover(
            function (event) {
                if (this.tip > " ") {
                    //e = window.event;
                    $('<div id="tooltip">' + this.tip + '</div>').css({
                        position: 'absolute',
                        width: '250px',
                        top: event.pageY + 20,
                        left: event.pageX + 10,
                        border: '1px solid #BDBDBD',
                        padding: '10px 10px 10px 10px',
                        'background-color': '#FFFCE1',
                        opacity: 1.00
                    }).appendTo("body").fadeIn(0);
                }
            },
            function () {
                $("#tooltip").remove();
            }
        )
    };

};

//::===========================================================================
//:: CC - Transportation
//::---------------------------------------------------------------------------
chla.transportation = function () { };
chla.transportation.prototype = new MPage.Component();
chla.transportation.prototype.constructor = MPage.Component;
chla.transportation.prototype.base = MPage.Component.prototype;
chla.transportation.prototype.name = "chla.transportation";
chla.transportation.prototype.cclProgram = "chla_ca_mp_cc_dc_trnsprt_json";
chla.transportation.prototype.cclParams = [];
chla.transportation.prototype.cclDataType = "JSON";
chla.transportation.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("encounterId");
    this.cclParams[2] = this.getProperty("personId");
};
chla.transportation.prototype.render = function () {
    var component = this;
    var elementObj = component.data.RPTDATA;
    var target = this.getTarget();
    var compContent;
    var powerFormLinkParams ;

    var  transporation = {
        cc_id: '' ,
        powerFormLinkParams:'',
        ARRANGEDTRANSPORTNo: 'checked',
        ARRANGEDTRANSPORTYes: '',
        personId: 0,
        encounterId: 0,
        url : 'https://sharepoint.chla.usc.edu/Docs/_layouts/15/WopiFrame.aspx?sourcedoc=/Docs/Clinical%20Care/CC%20-%20246.0%20Positional%20Car%20Seat%20Testing.pdf',
        PowerNote: ''
    }
    var  transporation_Tmpl = [
        '<div class="eapps_CC" id="<#=cc_id#>">',
        '<p><a href=&quot;javascript:MPAGES_EVENT(<#=powerFormLinkParams#>)&quot;>Car Seat Safety Law Form</a></p>',
        '<p><a href="javascript:APPLINK(100,&quot;<#=url#>&quot;,&quot;&quot;)">Positional Car Seat Test Policy</a></p>',
        '<p><#=PowerNote#></p>',
        '<dl><dt style="float: left;clear:left; ">Is transportation confirmed the day prior to discharge?&nbsp;&nbsp;</dt>',
        '<dd style="float: left; "><input type="radio" id="trnsptConfYes" name="transpconfirmRadio" <#=ARRANGEDTRANSPORTYes#> />&nbsp;Yes&nbsp;',
        '<input type="radio" id="trnsptConfNo" name="transpconfirmRadio" <#=ARRANGEDTRANSPORTNo#>/>&nbsp;No&nbsp;</dd></dl>',
        '<p style="clear:left;"/></div><div><button id="DC_tbtnSave" class="eappsBtnGrey">Save</button></div></div>'
    ]

    chla.transportation.eApps = {};
    chla.transportation.eApps.cc_id = chla.transportation.prototype.name.replace('.','_');
    chla.transportation.eApps.SaveButtonAction = chla.eApps.SaveButtonBehavior.enable_disable_status_reset;

    if(elementObj.PCST_EVENT_ID > 0){

        transporation.PowerNote ='<a onclick="chla.eApps.Funcs.PowerNoteMPageUtils(' +
            elementObj.PERSON_ID + ',' +
            elementObj.ENCNTR_ID + ',' +
            elementObj.PCST_EVENT_ID +
            ');">Positional Car Seat Test Note</a><br/>';

    } else {
        transporation.PowerNote ='<a href="javascript:APPLINK(' +
            '0,&quot;Powerchart.exe&quot;,&quot;' +
            ' /PERSONID=' +  elementObj.PERSON_ID +
            ' /ENCNTRID=' +  elementObj.ENCNTR_ID +
            ' /FIRSTTAB=^PowerNote^&quot;)">Positional Car Seat Note</a><br/>';

    }

    transporation.cc_id = chla.transportation.eApps.cc_id ;
    transporation.powerFormLinkParams = '&quot;POWERFORM&quot;,&quot;' +
        this.cclParams[2]  + '|' + this.cclParams[1]  + '|' +
        elementObj.CSSL_POWERFM_ID + '|' +
        elementObj.CSSL_POWERFM_ACTID + '|0&quot;';

    transporation.personId = this.getProperty("personId");
    transporation.encounterId = this.getProperty("encounterId");

    if ( elementObj.ARRANGEDTRANSPORT == 1){
        transporation.ARRANGEDTRANSPORTYes = 'checked' ;
        transporation.ARRANGEDTRANSPORTNo = '' ;
    }

    compContent = chla.eApps.Funcs.parseTemplate( transporation_Tmpl.join(''), transporation );
    target.innerHTML = compContent;

    chla.eAppsUtil.Logger.LogWarn('<textarea rows="5" style="width:100%">transportation </br>' +
        chla.eApps.Funcs.HtmlLogFormatter(compContent) + "</textarea>");

    chla.transportation.eApps.CSSBehaviors = new chla.eApps.CSSBehaviors();
    chla.transportation.eApps.HoverDataFormater =  function (sourceData) {
        var tempstr = '<span style="font-weight:bold;">Update History</span></br>';
        var tempstr1 = '',UNEEDCARSEAT , UARRANGEDTRANSPORT;
        var dirty, dirty2, lencnt;
        lencnt = sourceData.UPDT_CNT ;
        for (var i = 0; i < lencnt; i ++) {
            dirty = false;
            dirty2 = true;
            tempstr1 = '';
            UARRANGEDTRANSPORT = sourceData.UPDT_LIST[i].UARRANGEDTRANSPORT ||'';
            if( i ==(lencnt - 1)  ){
                if ( lencnt < 10){
                    if (UARRANGEDTRANSPORT != null ){
                        tempstr1 += '&nbsp;&nbsp; Arranged Transportation Update  -' +
                            (UARRANGEDTRANSPORT == 1 ? 'Yes' : 'No');
                        dirty = true;
                    }
                }
                dirty2 = false;
            }
            if(dirty2 == true) {
                if (UARRANGEDTRANSPORT != sourceData.UPDT_LIST[i+1].UARRANGEDTRANSPORT ){
                    tempstr1 += '&nbsp;&nbsp; Arranged Transportation Update  -' +
                        (UARRANGEDTRANSPORT == 1 ? 'Yes' : 'No');
                    dirty = true;
                }
            }
            if (dirty == true){
                tempstr += sourceData.UPDT_LIST[i].UPDT_BY_ID ;
                tempstr += ' on ';
                tempstr += sourceData.UPDT_LIST[i].UPDT_DT_TM ;
                tempstr += tempstr1;
                tempstr +=  "</br>" ;
            }
        };
        return tempstr ;
    };

    chla.transportation.eApps.CSSBehaviors.InitPopUpsDiv(
        chla.transportation.eApps.HoverDataFormater(elementObj), 'button#DC_tbtnSave','L',0);

    $("input[name='transpconfirmRadio']").click(function () {
        chla.transportation.eApps.SaveButtonAction('#DC_tbtnSave', 'ENABLE');
    });

    chla.transportation.eApps.CCLreqObjSave = null;

    $("#DC_tbtnSave").on( "click", function () {
        var needCarSeat = 0;
        var arrangeTransport = 0;

        if ($('input#trnsptConfYes').prop('checked') == true) {
            arrangeTransport = parseInt(1);
        }
        chla.transportation.eApps.CCLparmsSave = "^MINE^, value($VIS_Encntrid$)," +
            arrangeTransport.toString()  + ", ^^," +
            needCarSeat.toString() + " ,^^,value($USR_PersonID$)";
        if (chla.transportation.eApps.CCLreqObjSave == null){
            chla.eAppsUtil.Logger.LogInfo('chla.transportation.eApps.CCLparmsSave: ' + chla.transportation.eApps.CCLparmsSave);
            chla.transportation.eApps.CCLreqObjSave = new chla.eApps.CCLRequest.BtnSaveBehavior();
            chla.transportation.eApps.CCLreqObjSave.ObjectName='OBJ_chla.transportation.eApps.CCLreqObjSave';
            chla.transportation.eApps.CCLreqObjSave.BtnSaveBehaviorFunc = chla.transportation.eApps.SaveButtonAction ;
            chla.transportation.eApps.CCLreqObjSave.CallBackOperation = function(responseData){
                chla.transportation.eApps.CSSBehaviors.hoverContent =
                    chla.transportation.eApps.HoverDataFormater(responseData);
            };
        };
        chla.eAppsUtil.Logger.LogInfo('#DC_tbtnSave DataTransfer event')    ;
        chla.transportation.eApps.CCLreqObjSave.DataTransfer( chla.transportation.eApps.CCLreqObjSave,
            'CHLA_CA_MP_CC_INSRT_TPT_JSON',
            chla.transportation.eApps.CCLparmsSave  ,
            '#DC_tbtnSave');
    });

    chla.transportation.eApps.SaveButtonAction('#DC_tbtnSave', 'RESET');
};

//::===========================================================================
//:: CC - Work/School Note
//::---------------------------------------------------------------------------
chla.wk_sch_note = function () { };
chla.wk_sch_note.prototype = new MPage.Component();
chla.wk_sch_note.prototype.constructor = MPage.Component;
chla.wk_sch_note.prototype.base = MPage.Component.prototype;
chla.wk_sch_note.prototype.name = "chla.wk_sch_note";
chla.wk_sch_note.prototype.cclProgram = "chla_ca_mp_cc_dc_wsnote_json";
chla.wk_sch_note.prototype.cclParams = [];
chla.wk_sch_note.prototype.cclDataType = "JSON";
chla.wk_sch_note.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("encounterId");
    this.cclParams[2] = this.getProperty("personId");
};

chla.wk_sch_note.prototype.render = function () {
    var component = this;
    var compContent;
    var target = this.getTarget();
    var elementObj =  component.data.RPTDATA;
    var clinicalNotesParms ;

    var wkSchNote = {
        cc_id: 'x',
        clinicalNotesParms :'',
        wkSchNoteNeedNoVal:'checked',
        wkSchNoteCompNoVal: 'checked'
    } ;
    var wkSchNote_Tmpl = [
        '<div id="<#=cc_id#>" class="eapps_CC">',
        '<dl><dt style="float:left;clear: left;margin-right: 5px; width:50%;">School/work note needed?&nbsp&nbsp</dt>',
        '<dd style="float:left"><input type="radio" id="wkSchNoteNeedYes" name="wscheck" checked />&nbsp;Yes&nbsp;&nbsp;',
        '<input type="radio" id="wkSchNoteNeedNo" name="wscheck" <#=wkSchNoteNeedNoVal#> />&nbsp;No&nbsp;</dd>',
        '<dt style="float:left;clear: left;margin-right: 5px; width:90%;"><#=clinicalNotesParms#></dt><dd style="float:left">&nbsp;</dd>',
        '<dt style="float:left;clear: left;margin-right: 5px;width:50%;">School/work note completed?&nbsp&nbsp</dt>',
        '<dd style="float:left"><input type="Radio" id="wkSchNoteCompYes" name="compcheck" checked />&nbsp;Yes&nbsp;&nbsp;',
        '<input type="Radio" id="wkSchNoteCompNo" name="compcheck" <#=wkSchNoteCompNoVal#> />&nbsp;No&nbsp;</dd>',
        '<dt style="float:left;clear: left;margin: 5px 0 2px 0 ;width:50%;"><button id="wkSchNoteBtnSave" class="eappsBtnGrey" ',
        '> Save </button></dt><dd style="float:left">&nbsp;</dd></dl><p style="clear:left;"/></div>'
    ]

    chla.wk_sch_note.eApps = {};
    chla.wk_sch_note.eApps.cc_id = chla.wk_sch_note.prototype.name.replace('.','_');
    chla.wk_sch_note.eApps.SaveButtonAction = chla.eApps.SaveButtonBehavior.enable_disable_status_reset;
    //"NEEDWSNOTE":0,"WSCOMPLETED":0,
    wkSchNote.cc_id = chla.wk_sch_note.eApps.cc_id;
    if( elementObj.NOTE_EVENT_ID > 0 ){
        wkSchNote.clinicalNotesParms ='<a href="javascript:MPAGES_EVENT(' +
            '&quot;CLINICALNOTE&quot;,&quot;' +
            elementObj.PERSON_ID + '|' +
            elementObj.ENCNTR_ID + '|[' +
            elementObj.NOTE_EVENT_ID + ']|Clinical Notes|31|CLINNOTES|' +
            '341' + '|CLINNOTES|1&quot;' +
            ')">Link to "Return to School/work" note in KIDS</a><br/>';

        wkSchNote.wkSchNoteCompNoVal = '';
    } else {
        wkSchNote.clinicalNotesParms ='<a href="javascript:APPLINK(' +
            '0,&quot;Powerchart.exe&quot;,&quot;' +
            ' /PERSONID=' +  elementObj.PERSON_ID +
            ' /ENCNTRID=' +  elementObj.ENCNTR_ID +
            ' /FIRSTTAB=^Notes^&quot;)">Link to "Return to School/Work" note in KIDS</a><br/>';

        if (elementObj.WSCOMPLETED == 1) {
            wkSchNote.wkSchNoteCompNoVal = '';
        }
    }
    if (elementObj.NEEDWSNOTE == 1) {
        wkSchNote.wkSchNoteNeedNoVal = '';
    }

    compContent = chla.eApps.Funcs.parseTemplate( wkSchNote_Tmpl.join(''), wkSchNote );
    chla.eAppsUtil.Logger.LogWarn("<textarea rows='3' style='width:99%;'> wk_sch_notes <br/> " +
        chla.eApps.Funcs.HtmlLogFormatter(compContent) +'</textarea>');
    target.innerHTML = compContent;

    $("#wkSchNoteNeedYes").click(function () {
        chla.wk_sch_note.eApps.SaveButtonAction('#wkSchNoteBtnSave', 'ENABLE');
    });
    $("#wkSchNoteNeedNo").click(function () {
        chla.wk_sch_note.eApps.SaveButtonAction('#wkSchNoteBtnSave', 'ENABLE');
    });
    $("#wkSchNoteCompYes").click(function () {
        chla.wk_sch_note.eApps.SaveButtonAction('#wkSchNoteBtnSave', 'ENABLE');
    });
    $("#wkSchNoteCompNo").click(function () {
        chla.wk_sch_note.eApps.SaveButtonAction('#wkSchNoteBtnSave', 'ENABLE');
    });

    chla.wk_sch_note.eApps.CCLreqObjSave = null;
    chla.wk_sch_note.eApps.CSSBehaviors = new chla.eApps.CSSBehaviors();
    chla.wk_sch_note.eApps.HoverDataFormater =  function (sourceData) {
        var tempstr = '<span style="font-weight:bold;">Update History</span></br>';
        var tempstr1, COMPLETED_WSNOTE , NEED_WSNOTE;
        var dirty,dirty2 ,lencnt , lookahead = 1 ;
        lencnt = sourceData.UPDT_CNT ;
        for (var i = 0; i < lencnt; i ++) {
            dirty = false;
            dirty2 = true;
            tempstr1 = '';
            COMPLETED_WSNOTE = sourceData.UPDT_LIST[i].UCOMPLETED_WSNOTE || '';
            NEED_WSNOTE = sourceData.UPDT_LIST[i].UNEED_WSNOTE || '';
            if( i ==(lencnt - 1)  ){
                if ( lencnt > 10  ){
                    dirty2 = false;
                } else {
                    dirty2 = false;
                    tempstr1 =  '&nbsp;&nbsp; Completed School/work Note Update -' +  (COMPLETED_WSNOTE == 1 ? 'Yes' : 'No');
                    tempstr1 += '&nbsp;&nbsp; Need School/work Note Update  -' + (NEED_WSNOTE == 1 ? 'Yes' : 'No');
                    dirty = true;
                }
            }
            if ( dirty2 == true){
                if (COMPLETED_WSNOTE != sourceData.UPDT_LIST[i+lookahead].UCOMPLETED_WSNOTE ) {
                    if (COMPLETED_WSNOTE != null ){
                        tempstr1 =  '&nbsp;&nbsp; Completed School/work Note Update -' +  (COMPLETED_WSNOTE == 1 ? 'Yes' : 'No');
                        dirty = true;
                    }
                }
                if (NEED_WSNOTE != sourceData.UPDT_LIST[i+lookahead].UNEED_WSNOTE ) {
                    if (NEED_WSNOTE != null ){
                        tempstr1 += '&nbsp;&nbsp; Need School/work Note Update  -' + (NEED_WSNOTE == 1 ? 'Yes' : 'No');
                        dirty = true;
                    }
                }
            }
            if (dirty == true){
                tempstr += sourceData.UPDT_LIST[i].UPDT_MODBY_ID ;
                tempstr += ' on ';
                tempstr += sourceData.UPDT_LIST[i].UPDTDATETIME ;
                tempstr += tempstr1;
                tempstr +=  "</br>" ;
            }
        };
        return tempstr ;
    };

    chla.wk_sch_note.eApps.CSSBehaviors.InitPopUpsDiv(
        chla.wk_sch_note.eApps.HoverDataFormater( elementObj), 'button#wkSchNoteBtnSave','L',0);

    $("#wkSchNoteBtnSave").on( "click", function () {
        var needNote = 0;
        var compNote = 0;
        if (wkSchNoteNeedYes.checked == true)
            needNote = 1
        if (wkSchNoteCompYes.checked == true)
            compNote = 1;
        chla.wk_sch_note.eApps.CCLparmsSave = "^MINE^, value($VIS_Encntrid$)," +
            compNote.toString()  + ", ^^," +
            needNote.toString() + " ,^^, value($USR_PersonID$)";
        if (chla.wk_sch_note.eApps.CCLreqObjSave == null){
            chla.wk_sch_note.eApps.CCLreqObjSave = new chla.eApps.CCLRequest.BtnSaveBehavior();
            chla.wk_sch_note.eApps.CCLreqObjSave.ObjectName='OBJ_chla.wk_sch_note.eApps.CCLreqObjSave';
            chla.wk_sch_note.eApps.CCLreqObjSave.BtnSaveBehaviorFunc = chla.wk_sch_note.eApps.SaveButtonAction ;
            chla.wk_sch_note.eApps.CCLreqObjSave.CallBackOperation = function(responseData){
                chla.wk_sch_note.eApps.CSSBehaviors.hoverContent =
                    chla.wk_sch_note.eApps.HoverDataFormater(responseData);
            };
        };

        chla.wk_sch_note.eApps.CCLreqObjSave.DataTransfer( chla.wk_sch_note.eApps.CCLreqObjSave,
            'chla_ca_mp_cc_insrt_wnote_json',
            chla.wk_sch_note.eApps.CCLparmsSave  ,
            '#wkSchNoteBtnSave');
    });

    chla.wk_sch_note.eApps.SaveButtonAction('#wkSchNoteBtnSave', 'RESET');
};
//::===========================================================================
//:: CC - dcMiscNotes
//::---------------------------------------------------------------------------

chla.dcMiscNotes = function () { };
chla.dcMiscNotes.prototype = new MPage.Component();
chla.dcMiscNotes.prototype.constructor = MPage.Component;
chla.dcMiscNotes.prototype.base = MPage.Component.prototype;
chla.dcMiscNotes.prototype.name = "chla.dcMiscNotes";
chla.dcMiscNotes.prototype.cclProgram = "chla_ca_mp_cc_dc_mnote_json";
chla.dcMiscNotes.prototype.cclParams = [];
chla.dcMiscNotes.prototype.cclDataType = "JSON";
chla.dcMiscNotes.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("encounterId");
    this.cclParams[2] = this.getProperty("personId");
};

chla.dcMiscNotes.prototype.render = function () {
    var component = this;
    var elementObj = component.data.RPTDATA;
    var target = this.getTarget();
    var compContent;
    //-------------------------------------
    //  Common Used Variable Names for RPTDATA processing
    //-------------------------------------
    var i, j , k ;             // common for loop values
    var SectionObj,            // CC_SectionManagement
        // variables to hold RPTData values
        wrkRPTDATA_cnt,
        wrkRPTDATA,
        wrkRPTDATA_idx,
        wrkCnt,
        wrkValue,
        wrkDesc,
        wrkList,
        wrkPrevValue,
        wrkResults;
    var listLen,
        listLen2;
    //NOTE:: numbers used to denote the code hierarchy depth variable is used at.
    //NOTE:: i.e. inside for, while, if command statement
    //-------------------------------------
    // CC - DIV Template Data Object
    //-------------------------------------
    var dcMiscNotes = {
        cc_id: 'x',
        personId: 0,
        encounterId: 0,
        transparentSpacer:'',
        dctextnotes:''
    } ;
    //-------------------------------------
    // Main CC - DIV Template
    //-------------------------------------
    var dcMiscNotes_Tmpl = [
        '<div id="<#=cc_id#>" class="eapps_CC"><textarea id="dcMiscNtsText" rows="10" ',
        'style="width:96%;margin-bottom:5px;"><#=dctextnotes#></textarea><br/><p>',
        '<button id="dcMiscNtsSave" class="eappsBtnGrey">  Save</button></p></div>'
    ];
//-------------------------------------
//  Stanadard Common initializations
//-------------------------------------
    chla.dcMiscNotes.eApps = {};
    chla.dcMiscNotes.eApps.cc_id = chla.dcMiscNotes.prototype.name.replace('.','_');
    chla.dcMiscNotes.eApps.SaveButtonAction = chla.eApps.SaveButtonBehavior.enable_disable_status_reset;
    chla.dcMiscNotes.eApps.CSSBehaviors = new chla.eApps.CSSBehaviors();

    dcMiscNotes.cc_id             = chla.dcMiscNotes.eApps.cc_id;
    dcMiscNotes.personId          = this.getProperty("personId");
    dcMiscNotes.encounterId       = this.getProperty("encounterId");
    dcMiscNotes.transparentSpacer = '<img src="' +
        chla.eApps.Vars.transparentSpacer +
        '" height="5px" width="17px"  >' ;
//-------------------------------------
//  RPTDATA processing
//-------------------------------------
    dcMiscNotes.dctextnotes =  elementObj.DCTEXTNOTES.replace(/%0D%0A/g, '\n');
    //-------------------------------------
    //  CC DIV sections HTML generations ( TEMPLATE MERGE )
    //-------------------------------------
    compContent = chla.eApps.Funcs.parseTemplate(dcMiscNotes_Tmpl.join('') ,dcMiscNotes);
    //-------------------------------------
    //  CC DIV Rendering
    //-------------------------------------
    chla.eAppsUtil.Logger.LogWarn("<textarea rows='3' style='width:99%;'> dcMiscNotes <br/> " +
        chla.eApps.Funcs.HtmlLogFormatter(compContent) +'</textarea>');
    target.innerHTML = compContent;
//-------------------------------------
//  CC HTML/CSS behaviours
//-------------------------------------
    chla.dcMiscNotes.eApps.CCLreqObjSave = null;

    chla.dcMiscNotes.eApps.CSSBehaviors = new chla.eApps.CSSBehaviors();
    chla.dcMiscNotes.eApps.HoverDataFormater =  function (sourceData) {
        wrkValue = '<span style="font-weight:bold;">Update History</span></br>';
        wrkCnt = sourceData.UPDT_CNT ;
        for (var i = 0; i < wrkCnt; i ++) {
            wrkValue += sourceData.UPDT_LIST[i].UPDT_MODBY_ID ;
            wrkValue += ' on ';
            wrkValue += sourceData.UPDT_LIST[i].UPDTDATETIME ;
            wrkValue +=  "</br>" ;
        };
        return wrkValue ;
    };

    chla.dcMiscNotes.eApps.CSSBehaviors.InitPopUpsDiv(
        chla.dcMiscNotes.eApps.HoverDataFormater( elementObj),
        'button#dcMiscNtsSave','T');

    $("#dcMiscNtsText").on( "click", function () {
        chla.dcMiscNotes.eApps.SaveButtonAction('#dcMiscNtsSave', 'ENABLE');
    } );

    $("#dcMiscNtsSave").on( "click", function () {
        var wrkArr=[],textStr;
        //textStr =  $('#dcMiscNtsText').val();
        //chla.dcMiscNotes.eApps.CCLparmsSave =
        //                                    textStr + "',  value($USR_PersonID$)";
        wrkArr.push('^MINE^, value($VIS_Encntrid$),^');
        wrkArr.push( $('#dcMiscNtsText').val());
        wrkArr.push('^, value($USR_PersonID$)');
        chla.dcMiscNotes.eApps.CCLparmsSave = wrkArr.join('');
        if (chla.dcMiscNotes.eApps.CCLreqObjSave == null){
            chla.dcMiscNotes.eApps.CCLreqObjSave = new chla.eApps.CCLRequest.BtnSaveBehavior();
            chla.dcMiscNotes.eApps.CCLreqObjSave.ObjectName='OBJ_chla.dcMiscNotes.eApps.CCLreqObjSave';
            chla.dcMiscNotes.eApps.CCLreqObjSave.BtnSaveBehaviorFunc = chla.dcMiscNotes.eApps.SaveButtonAction ;
            chla.dcMiscNotes.eApps.CCLreqObjSave.CallBackOperation = function(responseData){
                chla.dcMiscNotes.eApps.CSSBehaviors.hoverContent =
                    chla.dcMiscNotes.eApps.HoverDataFormater(responseData);
            };
        };

        chla.dcMiscNotes.eApps.CCLreqObjSave.DataTransfer( chla.dcMiscNotes.eApps.CCLreqObjSave,
            'chla_ca_mp_cc_ins_mnote_json',
            chla.dcMiscNotes.eApps.CCLparmsSave  ,
            '#dcMiscNtsSave');
    });

    chla.dcMiscNotes.eApps.SaveButtonAction('#dcMiscNtsSave', 'RESET');
}
//::=========================================================================
//:: eApps Lib vers 1.5 - 2.5
//::=========================================================================

chla.eApps.gFuncs = chla.eApps.Funcs;
chla.eApps.Logger = MP_Util;

chla.eApps.gFuncs.Log_CC =  function (CC_component, CC_compContent){
    chla.eApps.Logger.LogWarn('<textarea rows="4" style="width:99%;">' +
        CC_component.eApps.cc_id + '</br>' +
        chla.eApps.gFuncs.HtmlLogFormatter(CC_compContent) +
        "</textarea>");
};


chla.eApps.Tmplts = {
    eApps_panel_Tmpl: [
        '<div id="<#=idLabel#>_Div_eApps_panel" class="<#=TemplateType#>" >',
        '<h1 class="<#=TemplateType#>-hd h1a-marker">',
        '<span class="<#=TemplateType#>-hd-tgl h1b-marker" title="icon toggle open">-</span>',
        '<span class="<#=TemplateType#>-title "><#=TLabel1#></span></h1>',
        '<div id="', //'<span id="mainCompMenu_<#=idLabel#>" class="opts-menu menu-hide">&nbsp;
        '</span><#=idLabel#>_Div_<#=TemplateType#>Content" class="<#=TemplateType#>-content">',
        '<div id="<#=idLabel#>" class="<#=TemplateType#>-content-body"><#=ContentBody#></div></div></div>'
    ],
    H2_Tmpl : [
        '<div id="<#=idLabel#>_DivSection" class="section"><h2 class="sec-hd h2a-marker">',
        '<span class="sec-hd-tgl h2b-marker" title="icon toggle open">-</span>',
        '<span id="mainCompMenu_<#=idLabel#>" class="opts-menu menu-hide">&nbsp;</span>',
        '<span class="sec-title " style="margin-right:0px;"><span><#=TLabel1#></span>',
        '<span class="sec-total" style="padding-left: 3px; margin-top: 5px;"><#=SectionCnt#></span>',
        '</span></h2><div id="<#=idLabel#>_DivSecContent" class="sec-content">',
        '<div id="<#=idLabel#>" class="content-body"><#=ContentBody#></div></div></div>'
    ],
    H5_Tmpl : [
        '<div id="<#=idLabel#>_DivSubSec" class="sub-sec"><h2 class="fo-sub-sec-hd fo-cat-type h5a-marker">',
        '<span class="sub-sec-hd-tgl h5b-marker <#=SectionClosed#>" style="<#=CustIcon#>"',
        ' title="icon toggle open">-</span><span class="sub-sec-title  <#=Disabled_Lbl#> " style="background-image: none;">',
        '<#=TLabel1#><#=SectionCnt#></span></h2><div id="<#=idLabel#>_DivSubSecContent"',
        ' class="sub-sec-content <#=SectionClosed#>"><div id="<#=idLabel#>" class="content-body">',
        '<#=ContentBody#></div></div></div>'
    ],
    H6_Tmpl : [
        '<div id="<#=idLabel#>_DivSubSec1" class="sub-sec"><h2 class="fo-sub-sec-hd h6a-marker">',
        '<span class="sub-sec-hd-tgl h6b-marker <#=SectionClosed#>" style="<#=CustIcon#>',
        ' <#=CustMargin#>" title="icon toggle open">-</span><span class="sub-sec-title',
        ' <#=Disabled_Lbl#>"><#=TLabel1#><#=SectionCnt#></span></h2><div id="<#=idLabel#>',
        '_DivSubSecContent" class="sub-sec-content <#=SectionClosed#>"><div id="',
        '<#=idLabel#>" class="content-body"><#=ContentBody#></div></div></div>'
    ]
};


chla.eApps.SectionData2 = function (T_type) {
    this.Header = '';
    this.Body =  '';
    this.Count = 0;
    this.SectionDivID;
    this.TemplateType = T_type || 'H5';
};

chla.eApps.SectionHeaderCtl2 =  function(){
    this.idLabel =  '';
    this.TLabel1 =  '';
    this.SectionCnt = 'auto';
    this.SectionDivID =  '';
    this.SectionCntVal =  0;
    this.SectionClosed = 'auto';
    this.Disabled_Lbl = 'auto';
    this.CustIcon = 'auto';
    this.CustMargin = 'margin-left:15px;'
    this.HideIfEmpty = 'false';
    this.ContentBody = '';
    this.UnformatBodyVal = '';
    this.TemplateType = 'H5';
    this.SectionData = null;
};

chla.eApps.SectionHeaderCtl2.prototype = {
    generateHTML: function (){
        var secObj = this;
        var resultVal ;
        var sectionTemplate = chla.eApps.Tmplts.H2_Tmpl.join('');

        secObj.SectionDivID = 'div#' + secObj.idLabel + '_DivSection H2.h2a-marker';
        if (secObj.TemplateType == 'H6') {
            sectionTemplate = chla.eApps.Tmplts.H6_Tmpl.join('');
            secObj.SectionDivID = 'div#' + secObj.idLabel +
                '_DivSubSec1 H2.h6a-marker';
        }else if ( secObj.TemplateType == 'H5') {
            sectionTemplate = chla.eApps.Tmplts.H5_Tmpl.join('');
            secObj.SectionDivID = 'div#' + secObj.idLabel +
                '_DivSubSec H2.h5a-marker';
        }else if ( secObj.TemplateType == 'eApps_panel') {
            sectionTemplate = chla.eApps.Tmplts.eApps_panel_Tmpl.join('');
            secObj.SectionDivID = 'div#' + secObj.idLabel +
                '_Div_' + secObj.TemplateType + ' H1.h1a-marker';
        }
        if (secObj.SectionCnt == 'auto'  ){
            secObj.SectionCnt = ' (' + secObj.SectionCntVal + ')';
        } else if (secObj.SectionCnt != ''  ) {
            secObj.SectionCnt = secObj.SectionCnt;
        } else {
            secObj.SectionCnt = ''
        }
        if (secObj.SectionClosed == 'auto' ){
            secObj.SectionClosed = (secObj.SectionCntVal == 0 )? 'closed' : '';
        } else if (secObj.SectionClosed != 'closed') {
            secObj.SectionClosed = ''
        }
        if (secObj.Disabled_Lbl == 'auto'){
            secObj.Disabled_Lbl = (secObj.SectionCntVal == 0 ) ? 'grey': '';
        } else {
            secObj.Disabled_Lbl = '';
        }

        if (secObj.CustIcon == 'none'){
            secObj.CustIcon = 'background-image:none;'
        } else {
            secObj.CustIcon = (secObj.SectionCntVal == 0 ) ? 'background-image:none;': '';
        }
        if (secObj.HideIfEmpty != 'false'){
            resultVal = '';
        } else {
            resultVal =   chla.eApps.gFuncs.parseTemplate(sectionTemplate,secObj);
        }
        return  resultVal ;
    },
    initValues: function (o){
        for (var m in o) {
            this[m] = o[m];
        }
    },
    initToggle: function (CSSBehaviors,SectionData){
        var sectionCnt = 0 , sectionType = '' , sectionDivID = '';
        if ( typeof SectionData == 'undefined' ){
            sectionCnt = this.SectionCntVal;
            sectionType = this.TemplateType;
            sectionDivID = this.SectionDivID;
        } else {
            sectionCnt = SectionData.Count;
            sectionType = SectionData.TemplateType;
            sectionDivID = SectionData.SectionDivID;
        }
        if(sectionCnt > 0) {
            if (sectionType == 'H2') {
                $(sectionDivID).on( "click",CSSBehaviors.SingleH2SectionToggle) ;
            }
            else if (sectionType == 'H5') {
                $(sectionDivID).on( "click",CSSBehaviors.SingleH5SectionToggle) ;
            }
            else if (sectionType == 'H6') {
                $(sectionDivID).on( "click",CSSBehaviors.SingleH6SectionToggle) ;
            }
            else if (sectionType == 'eApps_panel') {
                $(sectionDivID).on( "click",CSSBehaviors.SingleEappsPanelSectionToggle) ;
            }
        }
    }
};

chla.eApps.CSSBehaviors2 = function() {
    this.CCSBehaviorObj = null ;
    this.BtnSaveLbl ='';
    this.bFinished = false;
};


chla.eApps.CSSBehaviors2.prototype = {
    SingleH2H5H6SectionToggle : function(){
        $(this).find('span.sub-sec-hd-tgl').toggleClass('closed');
        $(this).next().toggleClass('closed');
        return false;
    },
    SingleH2SectionToggle : function(){
        $(this).find('span.h2b-marker').toggleClass('closed');
        $(this).next().toggleClass('closed');
        return false;
    },
    SingleH5SectionToggle : function(){
        $(this).find('span.h5b-marker').toggleClass('closed');
        $(this).next().toggleClass('closed');
        return false;
    },
    SingleH6SectionToggle : function(){
        $(this).find('span.h6b-marker').toggleClass('closed');
        $(this).next().toggleClass('closed');
        return false;
    },
    SingleEappsPanelSectionToggle : function(){
        $(this).find('span.h1b-marker').toggleClass('closed');
        $(this).next().toggleClass('closed');
        return false;
    },
    reInitPopUps: function (class_selector) {
        $(class_selector).hover(
            function (event) {
                var tipValue = $(this).attr('tip');
                //if (this.tip > " ") {
                if (tipValue > " ") {
                    $(this).css({background: '#FFFCE1'})
                    $('<div id="tooltip">' + tipValue + '</div>').css({
                        position: 'absolute',
                        width: '250px',
                        top: event.pageY + 20,
                        left: event.pageX + 10,
                        border: '1px solid #BDBDBD',
                        padding: '10px 10px 10px 10px',
                        'background-color': '#FFFCE1',
                        opacity: 1.00
                    }).appendTo("body").fadeIn(0);
                }
            },
            function () {
                $("#tooltip").remove();
                $(this).css({background: '#FFF'}) ;
            }
        )
    },
    InitPopUpsDiv :  function (dataResponse,  argHoverelement, alignPos) {
        var Parent = this ;
        var alignPostion = 0 ;
        var alignPostion2 = 0 ;
        Parent.hoverContent = dataResponse;
        if (alignPos != null){
            if (alignPos == "L") alignPostion = -320;
        }
        if (alignPos != null){
            if (alignPos == "T") alignPostion2 = -50;
        }
        $(argHoverelement).hover( function (args) {
            $('<div class="eapps-tooltip"></div>')
            .html(Parent.hoverContent)
            .appendTo('body')
            .fadeIn('slow');
        }, function() {
            $('.eapps-tooltip').remove();
        }).mousemove(function(e) {
            var mousex = e.pageX + (20  + alignPostion);
            var mousey = e.pageY + (10  + alignPostion2);
            $('.eapps-tooltip')
            .css({ top: mousey, left: mousex })
        }) ;
    }
};
//::===========================================================================
//:: CC - eappsLib Sections ---------------------------------------------------
//::===========================================================================
(function (){
//     chlaNs('chla.eApps', ChlaStdClass.extend() );
    chlaNs('chla.eApps.developer', ChlaStdClass.extend() );
    chlaNs('chla.eApps.gNotify',   ChlaStdClass.extend() );
    chlaNs('chla.eApps.Logger',    {
        NotInitialized: true,
        toggle:   ChlaStdClass.emptyFn,
        resize:   ChlaStdClass.emptyFn,
        clear:    ChlaStdClass.emptyFn,
        move:     ChlaStdClass.emptyFn,
        debug:    ChlaStdClass.emptyFn,
        warn:     ChlaStdClass.emptyFn,
        info:     ChlaStdClass.emptyFn,
        error:    ChlaStdClass.emptyFn,
        LogDebug: ChlaStdClass.emptyFn,
        LogWarn:  ChlaStdClass.emptyFn,
        LogInfo:  ChlaStdClass.emptyFn,
        LogError: ChlaStdClass.emptyFn,
        profile:  ChlaStdClass.emptyFn
    });
    if (typeof chla.eAppsUtil === 'undefined' ){
        chlaNs('chla.eAppsUtil',   {} );
    }

    if ( typeof(MP_Util) != 'undefined'){
        chla.eApps.Logger = MP_Util;
        chla.eAppsUtil.Logger = chla.eApps.Logger;
        chla.eApps.Logger.NotInitialized = false;
    };

    if (ChlaStdClass.safeRead(chla,'eAppsUtil','Blackbird') != '' ){
        chla.eApps.Logger = window[ chla.eAppsUtil.Blackbird.NAMESPACE ];
        chla.eApps.Logger.NotInitialized = false;
        chla.eAppsUtil.Logger = chla.eApps.Logger;
        chla.eAppsUtil.Logger_Init =  chla.eAppsUtil.Blackbird.initializeBB;
        chla.eApps.Logger_Init = chla.eAppsUtil.Blackbird.initializeBB;
    };

    chlaNsMgr.chlaNs('chla.eApps.Html');
    chlaNs('chla.eApps.gVars', ChlaStdClass.neo() );
    chlaNs('chla.eApps.gTmplts', ChlaStdClass.applyProperties( ChlaStdClass.neo(), {_tmplCache: []}));

    chlaNs('chla.eApps.gFuncs',ChlaStdClass.applyProperties(ChlaStdClass.neo(),{
            /**
         *
         * @param aData
         * @returns {string}
         */
        KidsUTCcnvrtLocal: function (aData) {
            var  strWrk = aData.replace('/Date(','').replace(')/',''), // "/Date(2017-10-05T16:57:00.000+00:00)/"
                 arrWrk = [],
                 arrDt = [],
                 arrTm = [],
                 kidsDtTm;
            kidsDtTm = new Date(strWrk);                        // "10/5/2017, 6:59:59 PM"

            arrWrk.length=0;
            arrWrk.push(kidsDtTm.getMonth()+1);
            arrWrk.push(kidsDtTm.getDate());
            arrWrk.push(kidsDtTm.getFullYear());
            arrDt.push((arrWrk[0]<10? 0 : ''));                 // Month
            arrDt.push(arrWrk[0]);
            arrDt.push('/');
            arrDt.push((arrWrk[1]<10? 0 : ''));                 // Date
            arrDt.push(arrWrk[1]);
            arrDt.push('/');
            arrDt.push(arrWrk[2]);                              // Year
            strWrk = kidsDtTm.toTimeString();                   // "10/5/2017, 6:59:59 PM"
            arrWrk = strWrk.split(' ');
            arrWrk = arrWrk[0].split(':');
            // arrTm.push((arrWrk[0]<10? 0 : ''));                 // Hour
            arrTm.push(arrWrk[0]);
            arrTm.push(':');
            // arrTm.push((arrWrk[1]<10? 0 : ''));                 // Minutes
            arrTm.push(arrWrk[1]);
            return {
                Dte: arrDt.join(''),
                Tm : arrTm.join('')
            }
        },
        /**
         * Convert Cerner date format to mm/dd/yyyy hh:mm
         * @param data
         * @returns {string}
         */
        convertDate :  function (data){
            var strRetVal,
                arrWrk = [],
                objWrk;
            if(ChlaStdClass.isEmpty(data))
                {
                    strRetVal = '--';
                }
            if (data.substring(6, 10) === '0000')
                {
                    strRetVal = '--';
                }
            else {
                objWrk = chla.eApps.gFuncs.KidsUTCcnvrtLocal(data);
                arrWrk.push(objWrk.Dte);
                arrWrk.push(' ');
                arrWrk.push(objWrk.Tm);
                strRetVal = arrWrk.join('');
                // retVal.push(data.substring(11, 13)); /*Month*/
                // retVal.push('/');
                // retVal.push(data.substring(14, 16));/*Date*/
                // retVal.push('/');
                // retVal.push(year);/*Year*/
                // retVal.push(' ');
                // retVal.push(data.substring(17, 22));/*Time*/
            }
            return strRetVal;
        },
        /**
         * Convert Cerner date format to mm/dd/yyyy
         * @param data
         * @returns {string}
         */
        convertDate2 :  function (data){
            var strRetVal,
                objWrk;
            if(ChlaStdClass.isEmpty(data))
            {
                strRetVal = '--';
            }
            if (data.substring(6, 10) === '0000')
            {
                strRetVal = '--';
            }
            else {
                objWrk = chla.eApps.gFuncs.KidsUTCcnvrtLocal(data);
                strRetVal = objWrk.Dte;
                // retVal.push(data.substring(11, 13)); /*Month*/
                // retVal.push('/');
                // retVal.push(data.substring(14, 16));/*Date*/
                // retVal.push('/');
                // retVal.push(year);/*Year*/
            }
            return strRetVal;
        },
        /**
         * Convert Cerner date format to mm/dd/yyyy hh:mm
         * @param data
         * @returns {string}
         */
        convertDate3 :  function (data){
            var strRetVal,
                arrWrk = [],
                objWrk;
            if(ChlaStdClass.isEmpty(data))
            {
                strRetVal = ' ';
            }
            if (data.substring(6, 10) === '0000')
            {
                strRetVal = ' ';
            }
            else {
                objWrk = chla.eApps.gFuncs.KidsUTCcnvrtLocal(data);
                arrWrk.push(objWrk.Dte);
                arrWrk.push(' ');
                arrWrk.push(objWrk.Tm);
                strRetVal = arrWrk.join('');
                //     retVal.push(data.substring(6, 8)); /*Month*/
                //     retVal.push('/');
                //     retVal.push(data.substring(8, 10));/*Date*/
                //     retVal.push('/');
                //     retVal.push(year);/*Year*/
                //     retVal.push(' ');
                //     retVal.push(data.substring(10, 12));/*Hours*/
                //     retVal.push(':');
                //     retVal.push(data.substring(12, 14));/*Minutes*/
            }
            return strRetVal;
        },
        LogProfile :
            function (label) {
                var currentTime = new Date(); //record the current time when profile() is executed
                if (label == undefined || label == '') {
                    chla.eApps.Logger.LogError('<b>ERROR:</b> Please specify a label for your eApps profile statement');
                } else if (chla.eApps.gVars._profiler[label]) {
                    chla.eApps.Logger.LogInfo('profile[ ' + label + ':END   ' +
                        (currentTime - chla.eApps.gVars._profiler[label]) + 'ms');
                    delete chla.eApps.gVars._profiler[label];
                } else {
                    chla.eApps.gVars._profiler[label] = currentTime;
                    chla.eApps.Logger.LogInfo('profile' + label + ' :START');
                }
                return currentTime;
            },
        HtmlLogFormatter: function(HtmlStr) {
            return HtmlStr.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
        },
        sFormatShortDate:  function (dtCurWrkDate) {
            var twoDigitMonth = dtCurWrkDate.getMonth()+"";if(twoDigitMonth.length==1)  twoDigitMonth="0" +twoDigitMonth;
            var twoDigitDate = dtCurWrkDate.getDate()+"";if(twoDigitDate.length==1) twoDigitDate="0" +twoDigitDate;
            var currentDate = twoDigitDate + "/" + twoDigitMonth + "/" + dtCurWrkDate.getFullYear();
            return currentDate;
        },
        djb2Code: function(str){
            var hash = 5381;
            var i;
            for (i = 0; i < str.length; i++) {
                char = str.charCodeAt(i);
                hash = ((hash << 5) + hash) + char; /* hash * 33 + c */
            }
            return hash;
        },
        Log_CC: function (CC_component, CC_compContent){
            var strCc_id,
                arrLogItem=[];
            strCc_id = CC_component;
            if ((typeof CC_component).toUpperCase() === 'OBJECT') {  /* this is a compatibly patch prior to full refactor*/
                if (typeof CC_component.eApps.getCc_id === 'undefined'){
                    strCc_id = CC_component.eApps.cc_id
                }else {
                    strCc_id = CC_component.eApps.getCc_id(CC_component);
                }
            }
            arrLogItem.push('<textarea rows="4" style="width:99%;">');
            arrLogItem.push( strCc_id );
            arrLogItem.push( '</br>' );
            arrLogItem.push(  chla.eApps.gFuncs.HtmlLogFormatter(CC_compContent) );
            arrLogItem.push(  "</textarea>");
            chla.eApps.Logger.LogWarn(arrLogItem.join(''));
        },
        parseTemplate : function(str, obj) {
            var  err = "",
                 func,
                 strFunc = "not initialized";
            try {
                func =  chla.eApps.gTmplts._tmplCache[str];
                if (!func) {
                    strFunc =
                        "var p=[],print=function(){p.push.apply(p,arguments);};" +
                        "with(obj){p.push('" +
                        str.replace(/[\r\t\n]/g, " ")
                        .replace(/'(?=[^#]*#>)/g, "\t")
                        .split("'").join("\\'")
                        .split("\t").join("'")
                        .replace(/<#=(.+?)#>/g, "',$1,'")
                        .split("<#").join("');")
                        .split("#>").join("p.push('")
                        + "');}return p.join('');";
                    func = new Function("obj", strFunc);
                    chla.eApps.gTmplts._tmplCache[str] = func;
                }
                return func(obj);
            } catch (e) {
                err = e.message;
                chla.eApps.Logger.LogError('err - parseTemplate: ' + err);
                alert('err - parseTemplate: ' + err);
                chla.eApps.Logger.LogError('<textarea rows="4" style="width:99%;">' +
                    'parseTemple Error <br/><pre>' +
                    chla.eApps.gFuncs.HtmlLogFormatter(str) + ' ' + JSON.stringify(obj) +
                    "</pre></textarea>");
            }
            return;
        },
        PowerNoteMpUtil: function (x,y,z) {
//                              var P = window.external.DiscernObjectFactory("POWERNOTE");
//                              P.ModifyExistingNoteByEventId(x,y,z);
            var DiscernObjectFactory = chla.eApps.gFuncs.DiscernObjectFactory,P;
            P = DiscernObjectFactory("POWERNOTE");
            P.ModifyExistingNoteByEventId(x,y,z);
        },
        AppLinkMpUtil: function ( personid, encounterid , tab_lbl, organizer_flag )  {
            var sCmd = '/PERSONID=' + personid + ' /ENCNTRID=' + encounterid ;
            if (typeof(tab_lbl) != 'undefined'){
                if (tab_id.length > 0 )
                    sCmd +=  ' /FIRSTTAB=^' + tab_lbl + '^';
            }
            if (typeof(organizer_flag) != 'undefined'){
                if (organizer_flag.length > 0 )
                    sCmd =  '/ORGANIZERTAB=^' + organizer_flag + '^';
            }
            APPLINK(0, "Powerchart.exe", sCmd);
        },
        LaunchMpRDO: function () {
            APPLINK(0, "Powerchart.exe", "/ORGANIZERTAB=^Resource Directory Organizer^")
            return false;
        },
        MPageUtils: function(){
            var params = '', objType = '', P,
                DiscernObjectFactory = chla.eApps.gFuncs.DiscernObjectFactory,
                dPersonId = 0,
                dEncounterId = 0,
                formId = 0,
                activityId = 0,
                chartMode = 0,
                dEventId = 0,
                err;
            //chla.eAppsUtil.Logger.LogInfo('MPageUtils');
            if(arguments.length > 0)
                objType = arguments[0].toUpperCase();

            if (objType === 'POWERFORM'){
                P = DiscernObjectFactory(objType);
                dPersonId = arguments[1];
                dEncounterId = arguments[2];
                formId = arguments[3];
                activityId = arguments[4];
                chartMode = arguments[5];
                P.OpenForm(dPersonId, dEncounterId, formId, activityId, chartMode);

            } else if (objType === 'POWERNOTE'){
                P = DiscernObjectFactory(objType);
                dPersonId = arguments[1];
                dEncounterId = arguments[2];
                dEventId = arguments[3];
                chla.eApps.Logger.LogWarn('modify: ' + objType + ' ' + dPersonId  +
                    ' ' + dEncounterId + ' ' + dEventId ) ;
                try {
                    P.ModifyExistingNoteByEventId(dPersonId, dEncounterId, dEventId);
                }catch (e) {
                    err = e.message;
                    chla.eApps.Logger.LogError("eApps ERROR HNAM WIN32 function: " +
                        objType + ' error: ' + err );
                }

//         } else if (objType === 'ORDERS'){
//         } else if (objType === 'POWERORDERS'){
//         } else if (objType === 'PATIENTEDUCATION'){
//         } else if (objType === 'TASKDOC'){
            } else {
                chla.eApps.Logger.LogError("eApps unsupported HNAM WIN32 function: " + objType );
            }
        },
        ReadOnlyMPageUtils: function(){
            var params = '', objType = '', objPVViewerMPage,
                DiscernObjectFactory = chla.eApps.gFuncs.DiscernObjectFactory,
                dPersonId = 0,
                dEncounterId = 0,
                formId = 0,
                activityId = 0,
                chartMode = 0,
                dEventId = 0,
                err;

            if(arguments.length > 0)
                objType = arguments[0].toUpperCase();

            if (objType === 'POWERNOTE'){
                objPVViewerMPage = window.external.DiscernObjectFactory("PVVIEWERMPAGE");
                dPersonId = arguments[1];
                dEncounterId = arguments[2];
                dEventId = arguments[3];
                chla.eApps.Logger.LogWarn('modify: ' + objType + ' ' + dPersonId  +
                    ' ' + dEncounterId + ' ' + dEventId ) ;
                try {
                    objPVViewerMPage = window.external.DiscernObjectFactory("PVVIEWERMPAGE");
                    objPVViewerMPage.CreateDocViewer(dPersonId);
                    objPVViewerMPage.AppendDocEvent(dEventId);
                    objPVViewerMPage.LaunchDocViewer();
                }catch (e) {
                    err = e.message;
                    chla.eApps.Logger.LogError("eApps ERROR HNAM WIN32 function: " +
                        objType + ' error: ' + err );
                }

            } else {
                chla.eApps.Logger.LogError("eApps unsupported HNAM WIN32 function: " + objType );
            }
        },
        DiscernObjectFactory: function(objType)  {
            var P = null;
            if ( typeof window.external != 'undefined') {
                if( typeof window.external.DiscernObjectFactory != 'undefined') {
                    P = window.external.DiscernObjectFactory(objType);
                }
            }
            if  ( P == null && typeof chlaMpageApi != 'undefined') {
                if (objType == 'POWERNOTE'){
                    P = chlaMpageApi.mPageInterceptorPOWERNOTE;
                    P.ModifyExistingNoteByEventId = chlaMpageApi.mPageInterceptorPOWERNOTE;
                }
                if (objType == 'POWERFORM'){
                    P = chlaMpageApi.mPageInterceptorPOWERFORM;
                    P.OpenForm = chlaMpageApi.mPageInterceptorPOWERFORM;
                }
            }
            return P;
        },
        getDomPath: function (el) {
            var stack = [];
            while ( el.parentNode != null ) {
                console.log(el.nodeName);
                var sibCount = 0;
                var sibIndex = 0;
                for ( var i = 0; i < el.parentNode.childNodes.length; i++ ) {
                    var sib = el.parentNode.childNodes[i];
                    if ( sib.nodeName == el.nodeName ) {
                        if ( sib === el ) {
                            sibIndex = sibCount;
                        }
                        sibCount++;
                    }
                }
                if ( el.hasAttribute('id') && el.id != '' ) {
                    stack.unshift(el.nodeName.toLowerCase() + '#' + el.id);
                } else if ( sibCount > 1 ) {
                    stack.unshift(el.nodeName.toLowerCase() + ':eq(' + sibIndex + ')');
                } else {
                    stack.unshift(el.nodeName.toLowerCase());
                }
                el = el.parentNode;
            }

            return stack.slice(1); // removes the html element
        }
    }));

    chlaNs('chla.eApps.gCCLRequest', ChlaStdClass.extend (
        function () {
            this.CCLreqObj           = null ;
            this.ObjectName          = '';
            this.CallBackFunc        = '';
            this.bFinished           = false;
            this.BtnBehavior         = null;
            this.BtnSaveLbl          = '';
            this.XmtCycleCnt         = 0;
            this.CallBackOperation   = { notImplemented: true};
            this.BtnSaveBehaviorFunc = { notImplemented: true};
            this.DataTransferReceive = null;
        })
    .implement({
        DataTransfer0 :  function  ( thisParent,CCLreport,CCLparms,BtnSaveLbl,parentCC){
            var Parent = this;
            try {
                if (this.CCLreqObj == null){
                    this.CCLreqObj = new XMLCclRequest();
                    this.CCLreqObj.onreadystatechange = null;
                }
                chla.eApps.Logger.LogInfo('Data Transfer function');
                if (this.CCLreqObj != null && this.CCLreqObj.sendFlag == false) {
                    this.CCLreqObj.onreadystatechange = function() {
                        var fName = 'CCLreqObj.onreadystatechange'  ;
                        var OperationState;
                        var LogMsg;
                        var msgData;
                        var jsonData;
                        chla.eApps.Logger.LogInfo('Parent fn : ' +
                            Parent.ObjectName + ' :: ' + fName );
                        OperationState = '';
                        LogMsg ='';
                        msgData = '';
                        jsonData = '';
                        // Set the response CallBack Function
                        switch(Parent.CCLreqObj.readyState){
                            //0: request not initialized
                            case 0:
                                break;
                            //1: server connection established
                            case 1:
                                break;
                            //2: request received
                            case 2:
                                break;
                            //3: processing request
                            case 3:
                                break;
                            //4: request finished and response is ready
                            case 4:
                                if (Parent.CCLreqObj.status == 200) {
                                    msgData = Parent.CCLreqObj.responseText;

                                    if (msgData != null) {
                                        jsonData = eval('(' + msgData + ')');
                                    }
                                    if (jsonData) {
                                        var temp = jsonData.RPTDATA;
                                        if (temp.ERR_STAT = 'FALSE') {
                                            OperationState = 'OK';
                                            LogMsg = Parent.BtnSaveLbl + ': save OK ';
                                        }else  {
                                            OperationState = 'FAIL';
                                            LogMsg = Parent.BtnSaveLbl + ': save FAIL ' + msgData ;
                                        }
                                    }
                                } else {
                                    OperationState = 'FAIL';
                                    LogMsg = this.BtnSaveLbl + ': save FAIL : readyState/status = ' +
                                        this.CCLreqObj.readyState.toString() + '/' + this.CCLreqObj.status.toString()  ;
                                }
                                try
                                {
                                    if (Parent.BtnSaveBehaviorFunc.notImplemented == undefined)
                                        Parent.BtnSaveBehaviorFunc(Parent.BtnSaveLbl, OperationState);
                                } catch(err) {
                                    chla.eApps.Logger.LogError(err.message);
                                }
                                chla.eApps.Logger.LogInfo(LogMsg);
                                chla.eApps.Logger.LogInfo(msgData);
                                if (Parent.CallBackOperation.notImplemented == undefined && OperationState == 'OK'){
                                    Parent.CallBackOperation(jsonData.RPTDATA);
                                }
                                break;
                            //0: request not initialized
                            default:
                        }
                    };
                }
                this.BtnSaveLbl = BtnSaveLbl;
                // Call the ccl program and send the parameter string
                this.CCLreqObj.open('GET', CCLreport);
                chla.eApps.Logger.LogInfo(' Params: ' + CCLparms + ' ' + CCLreport );
                this.CCLreqObj.send(CCLparms);
            }
            catch(err) {
                chla.eApps.Logger.LogError(err.message + ' Params: ' + CCLparms );
            }
        },
        DataTransfer1:  function( thisParent,CCLreport,CCLparms,parentCC){
            var ParentObj = thisParent;
            ParentObj.ParentCC = parentCC;
            try {
                if (ParentObj.CCLreqObj == null){
                    if (typeof getXMLHttpRequest != 'undefined') {
                        ParentObj.CCLreqObj = getXMLHttpRequest();
                    } else  {
                        chla.eApps.Logger.LogInfo('getXMLHttpRequest not defined using dummy object.');
                        ParentObj.CCLreqObj = {
                            open: ChlaStdClass.emptyFn,
                            send: ChlaStdClass.emptyFn
                        }
                    }
                    ParentObj.CCLreqObj.onreadystatechange = null;
                }
                chla.eApps.Logger.LogInfo('Data Transfer1 function');
                if (ParentObj.CCLreqObj != null && ParentObj.CCLreqObj.sendFlag == false) {
                    ParentObj.CCLreqObj.onreadystatechange = function() {
                        var fName = 'CCLreqObj.DataTransfer1.onreadystatechange'  ;
                        var OperationState;
                        var LogMsg;
                        var temp;
                        var msgData;
                        var jsonData;
                        chla.eApps.Logger.LogInfo('ParentObj fn : ' +
                            ParentObj.ObjectName + ' :: ' + fName + ' onreadystatechange' );
                        OperationState = '';
                        LogMsg ='';
                        msgData = '';
                        jsonData = '';
                        // Set the response CallBack Function
                        switch(ParentObj.CCLreqObj.readyState){
                            //0: request not initialized
                            case 0:
                                break;
                            //1: server connection established
                            case 1:
                                break;
                            //2: request received
                            case 2:
                                break;
                            //3: processing request
                            case 3:
                                break;
                            //4: request finished and response is ready
                            case 4:
                                if (ParentObj.CCLreqObj.status == 200) {
                                    msgData = ParentObj.CCLreqObj.responseText;

                                    if (msgData != null | typeof msgData !== 'undefined') {
                                        jsonData = eval('(' + msgData + ')');
                                    } else {
                                        msgData = '';
                                    }
                                    LogMsg = 'CCL Request completion status:  ';
                                    if (jsonData) {
                                        OperationState = 'OK';
                                        temp = jsonData.RPTDATA;
                                        if (typeof temp.ERR_STAT != 'undefined'){
                                            if (temp.ERR_STAT === 'FALSE' || temp.ERR_STAT === '' ) {
                                                OperationState = 'OK';
                                            }else  {
                                                OperationState = 'FAILED';
                                            }
                                        }
                                    }
                                } else {
                                    OperationState = 'FAILED';
                                    LogMsg = OperationState + ' : readyState/status = ' +
                                        ParentObj.CCLreqObj.readyState.toString() + '/' + ParentObj.CCLreqObj.status.toString()  ;
                                }
                                LogMsg += OperationState;
                                chla.eApps.Logger.LogInfo(LogMsg);
                                chla.eApps.Logger.LogInfo(msgData);
                                try
                                {
                                    if (ParentObj.BtnSaveBehaviorFunc.notImplemented == undefined)
                                        ParentObj.BtnSaveBehaviorFunc(ParentObj.BtnSaveLbl, OperationState);
                                } catch(err) {
                                    chla.eApps.Logger.LogError(err.message);
                                }
                                if (ParentObj.CallBackOperation.notImplemented == undefined && OperationState == 'OK'){
                                    ParentObj.CallBackOperation(jsonData.RPTDATA,ParentObj.ParentCC);
                                }
                                break;
                            //0: request not initialized
                            default:
                                chla.eApps.Logger.LogInfo('DataTransfer1 - Not Handled : CCLreqObj.readyState' +  ParentObj.CCLreqObj.readyState);
                                break;
                        }
                    };
                }
                // Call the ccl program and send the parameter string
                ParentObj.CCLreqObj.open('GET', CCLreport);
                chla.eApps.Logger.LogInfo(' Params: ' + CCLparms + ' ' + CCLreport );
                ParentObj.CCLreqObj.send(CCLparms);
            }
            catch(err) {
                chla.eApps.Logger.LogError(err.message + ' Params: ' + CCLparms );
            }
        },
        DataTransfer2 :  function ( thisParent,CCLreport,CCLparms,BtnSaveLbl, parentCC) {
            var CCLparamsArray = [],
                wrkArray,
                wrkArray2,
                wrkValue,
                wrkValue2,
                component,
                ControlName,
                i,j,
                arrLen, arrLen2,
                parentCtl = this;
            try {
                chla.eApps.Logger.LogInfo(' loadCcl Data Transfer function');
                this.BtnSaveLbl = BtnSaveLbl;
                wrkArray = thisParent.ObjectName.split('.');
                i= wrkArray.length - 1;
                ControlName = wrkArray[i];

                if( typeof parentCC == 'undefined'){
                    component = chla[wrkArray[1]].eApps.parentCC;
                    wrkArray = component.name.split('.');
                } else {
                    component = parentCC;
                    wrkArray = component.name.split('.');
                    componentName = wrkArray[1];
                }
                component[ControlName] = this;
                CCLparamsArray.length = 0;
                if ($.isArray(CCLparms) != true) {
                    wrkValue =  CCLparms.replace(/^\^/, '');
                    CCLparms =  wrkValue.replace(/\^$/, '');
                    wrkArray = CCLparms.split('^');
                    for (i = 0, arrLen = wrkArray.length; i < arrLen; i++ ){
                        //if  !/^,/  then  splitArrayResult.push(wkarry[i])

                        if (wrkArray[i].indexOf(',') == -1 ){
                            CCLparamsArray.push(wrkArray[i]);

                            // if  /^,/   remove leading comma then  result  wrkarry[i]split(',')
                        } else if (wrkArray[i].indexOf(',') > -1 ){
                            //|,|      == ","    seperator   ^,^  no push
                            if (wrkArray[i] == ',' ){

                                //|,,|     == ",,"    empty field push
                            } else if (wrkArray[i] == ',' ){
                                CCLparamsArray.push( 0 - 0 );
                                // remove 1st and last comma  len >= 2  <> |,,|
                            } else if (wrkArray[i].length > 1 ){
                                //      splitArrayResult.push(result[i])
                                wrkArray2 = wrkArray[i].replace(/^,/, '').replace(/,$/, '').split(',');
                                for (j = 0 , arrLen2 = wrkArray2.length; j < arrLen2 ; j++){
                                    if (isNaN(wrkArray2[j])){
                                        CCLparamsArray.push(wrkArray2[j]);
                                    }else {
                                        CCLparamsArray.push(wrkArray2[j] - 0);
                                    }
                                }
                            }else {
                                chla.eApps.Logger.LogError(' Params Parsing Error: ' +
                                    wrkArray.join(', ') + ' - ' + CCLreport );
                            }
                        } else {
                            chla.eApps.Logger.LogError(' Params Parsing Error: ' +
                                wrkArray.join(', ') + ' - ' + CCLreport );
                        }
                    } //end of 1st for loop
                } else {
                    CCLparamsArray = CCLparms.slice();
                }
                chla.eApps.Logger.LogInfo( component.name + ' ' + this.BtnSaveLbl  +
                    ' Params: [' + CCLparamsArray.join(', ') + '] - ' + CCLreport );

                if(this.DataTransferReceive == null){
                    this.DataTransferReceive =  function (data) {
                        return parentCtl.DataTransfer2Receive(data, this[ControlName] );
                    }
                }

                if($(this.BtnSaveLbl).attr('buttonState') == 'Enabled'){
                    component.loadCcl( CCLreport,
                        CCLparamsArray,
                        this.DataTransferReceive,
                        "JSON");
                }
            } catch(err) {
                chla.eApps.Logger.LogError(err.message + ' Params: ' + CCLparms );
            }
        },
        DataTransfer2Receive: function ( dataResponse, parentCtl){
            var temp,
                OperationState = 'FAIL',
                LogMsg,
                Parent = parentCtl;

            if (dataResponse) {
                this.data = dataResponse;
                temp = ChlaStdClass.safeRead(this.data, 'RPTDATA');
                if (ChlaStdClass.safeRead(temp, 'ERR_STAT') == 'FALSE') {
                    OperationState = 'OK';
                    LogMsg = Parent.BtnSaveLbl + ': save OK ';
                }else  {
                    OperationState = 'FAIL';
                    LogMsg = Parent.BtnSaveLbl + ': save FAIL ' + JSON.stringify(dataResponse);
                }
            }
            try
            {
                if (typeof Parent.BtnSaveBehaviorFunc.notImplemented == 'undefined'){
                    if ( OperationState == 'OK')
                        null;
                    Parent.BtnSaveBehaviorFunc(Parent.BtnSaveLbl, OperationState);
                }
            } catch(err) {
                chla.eApps.Logger.LogError(err.message);
            }
            chla.eApps.Logger.LogInfo(LogMsg);
            //chla.eApps.Logger.LogInfo(JSON.stringify(dataResponse));
            if (Parent.CallBackOperation.notImplemented == undefined && OperationState == 'OK'){
                Parent.CallBackOperation(dataResponse.RPTDATA);
            }
        }
    }));
}());
ChlaStdClass.applyProperties( chla.eApps.gTmplts, {
    eApps_panel_Tmpl: [
        '<div id="<#=idLabel#>_Div_eApps_panel" class="<#=HdrCss#>">',
        '<h2 class="fo-sub-sec-hd <#=fo_cat_type#> hxa-marker <#=OvrrdHdrCss#>" <#=OvrrdHdrStyle#> <#=hovertip#>>',
        '<span class="sub-sec-hd-tgl hxb-marker <#=SectionClosed#>"  style="<#=CustIcon#> <#=CustMargin#>">-</span><#=HdrLayout#></h2>',
        '<div id="<#=idLabel#>_DivSubSecContent" class="sub-sec-content <#=SectionClosed#>" <#=SubSecContentStyle#>>',
        '<div id="<#=idLabel#>" class="content-body  <#=OvrrdContentBodyCss#>">',
        '<#=defaultHeightHdr#><#=ContentBody#><#=defaultHeightFtr#></div></div></div>'
    ],
    H2_Tmpl : [
        '<div id="<#=idLabel#>_DivSection" class="section <#=SectionTheme#>"><h2 class="sec-hd h2a-marker">',
        '<span class="sec-hd-tgl h2b-marker" title="icon toggle open">-</span>',
        '<span id="mainCompMenu_<#=idLabel#>" class="opts-menu menu-hide">&nbsp;</span>',
        '<span class="sec-title " style="margin-right:0px;"><span><#=TLabel1#></span>',
        '<span class="sec-total" style="padding-left: 3px; margin-top: 5px;"><#=SectionCnt#></span>',
        '</span></h2><div id="<#=idLabel#>_DivSecContent" class="sec-content">',
        '<div id="<#=idLabel#>" class="content-body"><#=ContentBody#></div></div></div>'
    ],
    H5_Tmpl : [
        '<div id="<#=idLabel#>_DivSubSec" class="sub-sec"><h2 class="fo-sub-sec-hd fo-cat-type h5a-marker">',
        '<span class="sub-sec-hd-tgl h5b-marker <#=SectionClosed#>" style="<#=CustIcon#>"',
        ' title="icon toggle open">-</span><span class="sub-sec-title  <#=Disabled_Lbl#> " style="background-image: none;">',
        '<#=TLabel1#><#=SectionCnt#></span></h2><div id="<#=idLabel#>_DivSubSecContent"',
        ' class="sub-sec-content <#=SectionClosed#>"><div id="<#=idLabel#>" class="content-body">',
        '<#=ContentBody#></div></div></div>'
    ],
    H6_Tmpl : [
        '<div id="<#=idLabel#>_DivSubSec1" class="sub-sec"><h2 class="fo-sub-sec-hd h6a-marker">',
        '<span class="sub-sec-hd-tgl h6b-marker <#=SectionClosed#>" style="<#=CustIcon#>',
        ' <#=CustMargin#>" title="icon toggle open">-</span><span class="sub-sec-title',
        ' <#=Disabled_Lbl#>" style="background-image: none;"><#=TLabel1#><#=SectionCnt#></span></h2><div id="<#=idLabel#>',
        '_DivSubSecContent" class="sub-sec-content <#=SectionClosed#>"><div id="',
        '<#=idLabel#>" class="content-body"><#=ContentBody#></div></div></div>'
    ],
    gCcMainDiv: [
        '<div id="<#=cc_id#>" class="eapps_CC">',
        '<#=mainSection#>',
        '</div>'
    ]
});

chla.eApps.gSectionData = ChlaStdClass.extend (
    function (T_type,
              SecId,
              TLblId,
              SecClsd,
              SecLvl,
              SecTgl
    ) {
        this.Header = '';
        this.Body =  '';
        this.Count = 0;
        this.Toggle = SecTgl || 'auto';
        this.SectionDivID;
        this.TLabel1= TLblId || 'NDEF';
        this.SectionID = SecId || 'NDEF';
        this.SectionClosed = SecClsd ||'auto';
        this.SectionLevel = SecLvl || 'H5';
        this.TemplateType = T_type || 'H5';
    })
.implement({
    Section_config: function (SectionCfg,targetCC_SectMgtObj){
        var wrkValue, i, listlen,
            htmlSecCtlData = chlaNsMgr.aliasDirector('chla.eApps.Html.SectionData'),
            resultSecLstArr= [];
        for ( i = 0, listlen = SectionCfg.length; i < listlen; i++){
            wrkValue = SectionCfg[i].SecLvl + '_Sec_' + SectionCfg[i].SecId ;
            targetCC_SectMgtObj[wrkValue] = htmlSecCtlData.neo(
                SectionCfg[i].T_type ,
                SectionCfg[i].SecId ,
                SectionCfg[i].TLblId ,
                SectionCfg[i].SecClsd ,
                SectionCfg[i].SecLvl
            ) ;
            resultSecLstArr.push(wrkValue);
        }
        return resultSecLstArr;
    }
});

chla.eApps.gSectionHeaderCtl = ChlaStdClass.extend (
    function(){
        this.idLabel =  '';
        this.SectionID =  '';
        this.TLabel1 =  '';
        this.SectionCnt = 'auto';
        this.SectionID =  '';
        this.SectionDivID =  '';
        this.SectionCntVal =  0;
        this.SectionClosed = 'auto';
        this.Disabled_Lbl = 'auto';
        this.CustIcon = 'auto';
        this.CustMargin = 'margin-left:15px;'
        this.HideIfEmpty = 'false';
        this.ContentBody = '';
        this.UnformatBodyVal = '';
        this.TemplateType = 'H5';
        this.SectionTheme = '';
        this.SectionData = ChlaStdClass.extend (
            function (T_type) {
                this.Header = '';
                this.Body =  '';
                this.Count = 0;
                this.SectionDivID;
                this.TemplateType = T_type || 'H5';
            });
    })
.implement(
    {
        generateHTML: function (){
            var secObj = this;
            var resultVal ;
            var sectionTemplate = chla.eApps.gTmplts.H2_Tmpl.join('');

            secObj.SectionDivID = 'div#' + secObj.idLabel + '_DivSection H2.h2a-marker';
            if (secObj.TemplateType == 'H6') {
                sectionTemplate = chla.eApps.gTmplts.H6_Tmpl.join('');
                secObj.SectionDivID = 'div#' + secObj.idLabel +
                    '_DivSubSec1 H2.h6a-marker';
            }else if ( secObj.TemplateType == 'H5') {
                sectionTemplate = chla.eApps.gTmplts.H5_Tmpl.join('');
                secObj.SectionDivID = 'div#' + secObj.idLabel +
                    '_DivSubSec H2.h5a-marker';
            }else if ( secObj.TemplateType == 'eApps_panel') {
                sectionTemplate = chla.eApps.gTmplts.eApps_panel_Tmpl.join('');
                secObj.SectionDivID = 'div#' + secObj.idLabel +
                    '_Div_' + secObj.TemplateType + ' H2.hxa-marker';
            }
            if (secObj.SectionCnt == 'auto'  ){
                secObj.SectionCnt = ' (' + secObj.SectionCntVal + ')';
            } else if (secObj.SectionCnt != ''  ) {
                secObj.SectionCnt = secObj.SectionCnt;
            } else {
                secObj.SectionCnt = ''
            }
            if (secObj.SectionClosed == 'auto' ){
                secObj.SectionClosed = (secObj.SectionCntVal == 0 )? 'closed' : '';
            } else if (secObj.SectionClosed != 'closed') {
                secObj.SectionClosed = ''
            }
            if (secObj.Disabled_Lbl == 'auto'){
                secObj.Disabled_Lbl = (secObj.SectionCntVal == 0 ) ? 'grey': '';
            } else {
                secObj.Disabled_Lbl = '';
            }
            secObj.defaultHeightHdr= ''
            secObj.defaultHeightFtr= ''
            secObj.defaultHeight = (typeof secObj.defaultHeight == 'undefined' )? '': secObj.defaultHeight;
            if (secObj.defaultHeight != ''){
                secObj.defaultHeightHdr = '<div style="height: ' + secObj.defaultHeight +'; overflow-y:auto;  overflow-x:hidden">';
                secObj.defaultHeightFtr= '</div>'
            }
            if (secObj.CustIcon == 'none'){
                secObj.CustIcon = 'background-image:none;'
            } else {
                secObj.CustIcon = (secObj.SectionCntVal == 0 ) ? 'background-image:none;': '';
            }
            if (secObj.HideIfEmpty != 'false'){
                resultVal = '';
            } else {
                resultVal =   chla.eApps.gFuncs.parseTemplate(sectionTemplate,secObj);
            }
            return  resultVal ;
        },
        initValues: function (o){
            this.idLabel =  '';
            this.SectionID =  '';
            this.TLabel1 =  '';
            this.SectionCnt = 'auto';
            this.SectionID =  '';
            this.SectionDivID =  '';
            this.SectionCntVal =  0;
            this.SectionClosed = 'auto';
            this.Disabled_Lbl = 'auto';
            this.CustIcon = 'auto';
            this.CustMargin = 'margin-left:15px;'
            this.HideIfEmpty = 'false';
            this.ContentBody = '';
            this.UnformatBodyVal = '';
            this.HdrCss = '';
            this.fo_cat_type = '';
            this.OvrrdHdrCss = '';
            this.OvrrdHdrStyle = '';
            this.hovertip = '';
            this.HdrLayout = '';
            this.SubSecContentStyle = '';
            this.OvrrdContentBodyCss = '';
            this.defaultHeightHdr = '';
            this.defaultHeightFtr = '';
            this.TemplateType = 'H5';
            for (var m in o) {
                this[m] = o[m];
            }
        },
        resetValues: function (sectionObj){
            sectionObj.idLabel =  '';
            sectionObj.SectionID =  '';
            sectionObj.TLabel1 =  '';
            sectionObj.SectionCnt = 'auto';
            sectionObj.SectionID =  '';
            sectionObj.SectionDivID =  '';
            sectionObj.SectionCntVal =  0;
            sectionObj.SectionClosed = 'auto';
            sectionObj.Disabled_Lbl = 'auto';
            sectionObj.CustIcon = 'auto';
            sectionObj.CustMargin = 'margin-left:15px;'
            sectionObj.HideIfEmpty = 'false';
            sectionObj.ContentBody = '';
            sectionObj.UnformatBodyVal = '';
            sectionObj.TemplateType = 'H5';
        },
        initToggle: function (CSSBehaviors,SectionData){
            var sectionCnt = 0 , sectionType = '' , sectionDivID = '',
                sectionToggle = 'auto';
            if ( typeof SectionData == 'undefined' ){
                sectionCnt = this.SectionCntVal;
                sectionType = this.TemplateType;
                sectionDivID = this.SectionDivID;
            } else {
                sectionCnt = SectionData.Count;
                sectionType = SectionData.TemplateType;
                sectionDivID = SectionData.SectionDivID;
                sectionToggle = SectionData.Toggle || 'auto';
            }
            if (typeof chla.eApps.gCSSBehavior == 'undefined'){
                sectionToggle = 'auto';
            }
            if(sectionCnt != '0' && ( sectionToggle == 'auto' ||sectionToggle == 'true' ) ) {
                if (sectionType == 'H2') {
                    $(sectionDivID).on( "click",CSSBehaviors.SingleH2SectionToggle) ;
                }
                else if (sectionType == 'H5') {
                    $(sectionDivID).on( "click",CSSBehaviors.SingleH5SectionToggle) ;
                }
                else if (sectionType == 'H6') {
                    $(sectionDivID).on( "click",CSSBehaviors.SingleH6SectionToggle) ;
                }
                else if (sectionType == 'eApps_panel') {
                    $(sectionDivID).on( "click",CSSBehaviors.SingleEappsPanelSectionToggle) ;
                }
            }

        }
    });

;
chlaNs('chla.eApps.gBtnBehavior', ChlaStdClass.extend( function(){
    this.CCLreqObj = null ;
    this.BtnLbl ='';
    this.BtnObj = '';
    this.BtnType ='';
    this.bFinished = false;
    this.ObjectName = '';
    this.XmtCycleCnt = 0;
}));

chlaNs('chla.eApps.gCSSBehavior',  ChlaStdClass.extend (
    function() {
        this.CCSBehaviorObj = null ;
        this.BtnSaveLbl ='';
        this.bFinished = false;
//    }));
    })
//chla.eApps.gCSSBehavior.implement({
.implement({
    SingleH2H5H6SectionToggle : function(){
        $(this).find('span.sub-sec-hd-tgl').toggleClass('closed');
        $(this).next().toggleClass('closed');
        chla.eApps.toggled = true;
        return false;
    },
    SingleH2SectionToggle : function(){
        $(this).find('span.h2b-marker').toggleClass('closed');
        $(this).next().toggleClass('closed');
        chla.eApps.toggled = true;
        return false;
    },
    SingleH5SectionToggle : function(){
        $(this).find('span.h5b-marker').toggleClass('closed');
        $(this).next().toggleClass('closed');
        chla.eApps.toggled = true;
        return false;
    },
    SingleH6SectionToggle : function(){
        $(this).find('span.h6b-marker').toggleClass('closed');
        $(this).next().toggleClass('closed');
        chla.eApps.toggled = true;
        return false;
    },
    SingleEappsPanelSectionToggle : function(){
        $(this).find('span.hxb-marker').toggleClass('closed');
        $(this).next().toggleClass('closed');
        chla.eApps.toggled = true;
        return false;
    },
    reInitPopUps: function (class_selector) {
        $(class_selector).hover(
            function (event) {
                var tipValue = $(this).attr('tip');
                //if (this.tip > " ") {
                if (tipValue > " ") {
                    $(this).css({background: '#FFFCE1'})
                    $('<div id="tooltip">' + tipValue + '</div>').css({
                        position: 'absolute',
                        width: '250px',
                        top: event.pageY + 20,
                        left: event.pageX + 10,
                        border: '1px solid #BDBDBD',
                        padding: '10px 10px 10px 10px',
                        'background-color': '#FFFCE1',
                        opacity: 1.00
                    }).appendTo("body").fadeIn(0);
                }
            },
            function () {
                $("#tooltip").remove();
                $(this).css({background: '#FFF'}) ;
            }
        )
    },
    InitPopUpsZstripe: function (class_selector) {
        $(class_selector).hover(
            function (event) {
                var tipValue = $(this).attr('tip');
                //if (this.tip > " ") {
                if (tipValue > " ") {
                    $(this).css({background: '#FFFCE1'})
                    $('<div id="tooltip">' + tipValue + '</div>').css({
                        'font-size': '12px',
                        'line-height': '1.5em',
                        position: 'absolute',
                        width: '250px',
                        top: event.pageY + 20,
                        left: event.pageX + 10,
                        border: '1px solid #BDBDBD',
                        padding: '10px 10px 10px 10px',
                        'background-color': '#FFFCE1',
                        opacity: 1.00
                    }).appendTo("body").fadeIn(0);
                }
            },
            function () {
                $("#tooltip").remove();
                if ($(this).hasClass( "odd" ) == true ){
                    $(this).css({background: '#F3F6FD'}) ;
                } else {
                    $(this).css({background: '#FFF'}) ;
                }
            }
        )
    },
    InitPopUpsDiv :  function (dataResponse,  argHoverelement, alignPos) {
        var Parent = this ;
        var alignPostion = 0 ;
        var alignPostion2 = 0 ;
        Parent.hoverContent = dataResponse;
        if (alignPos != null){
            if (alignPos == "L") alignPostion = -320;
        }
        if (alignPos != null){
            if (alignPos == "T") alignPostion2 = -50;
        }
        $(argHoverelement).hover( function (args) {
            $('<div class="eapps-tooltip"></div>')
            .html(Parent.hoverContent)
            .appendTo('body')
            .fadeIn(0);
            obj = $('.eapps-tooltip');
            dx = args.pageX + (60  + alignPostion);
            dy = args.pageY;
            dy1 = dy;
            objHeight = obj.outerHeight();
            objWidth  = obj.outerWidth();

            if ( $('.vwp-container').length > 0){
                vwpBodyWidth =  $('.vwp-container').innerWidth();
                vwpctnrHeight = $('.vwp-container').height();
                dw = vwpBodyWidth * 0.66;
                dw2 = vwpBodyWidth * 0.33;
                if ( args.pageX  > dw) {
                    dx = args.pageX - (objWidth + 60) ;
                }else if (args.pageX  > dw2 ){
                    dy = dy - (objHeight + 10);
                    dx = args.pageX ;
                }
                if ((objHeight + dy) > vwpctnrHeight ){
                    dy = dy - (objHeight);
                }
            } else {
                vwpBodyWidth =  $('body').innerWidth();
                vwpctnrHeight = $('body').innerHeight();
                dw = vwpBodyWidth * 0.66;
                dw2 = vwpBodyWidth * 0.33;
                if ( args.pageX  > dw) {
                    dx = args.pageX - (objWidth + 60) ;
                    dx = dx < 5 ? 5 : dx;
                }else if (args.pageX  > dw2 ){
                    dy = dy - (objHeight + 10);
                    dx = args.pageX ;
                }
                if ((objHeight + dy) > vwpctnrHeight ){
                    dy = dy - (objHeight);
                }
            }
            obj.css({top: dy, left: dx });
        }, function() {
            $('.eapps-tooltip').remove();
        });
    }
}));

chla.eApps.gButtonBehaviorSave  =  ChlaStdClass.extend (
    function() {
        this.BtnSaveLbl ='';
        this.ObjectName = '';
        this.CallBackOperation = { notImplemented: true};
        this.BtnSaveBehaviorFunc = { notImplemented: true};
    })
.implement({
    enable_disable_status_reset : function(SaveBtnID, SavedStatus) {
        var input_pseudoclass = SaveBtnID;
        if (SavedStatus === 'ENABLE' ) {
            $(input_pseudoclass).text('  Save   ');
            $(input_pseudoclass).attr('class','eappsBtnGrey');
            $(input_pseudoclass).attr('buttonState','Enabled');
            $(input_pseudoclass).attr('disabled',false);
        } else if (SavedStatus === 'OK') {
            $(input_pseudoclass).text('  Saved ');
            $(input_pseudoclass).attr('buttonState','Disabled');
            $(input_pseudoclass).attr('class','eappsBtnGreyDisabled');
        } else if (SavedStatus === 'FAIL') {
            $(input_pseudoclass).text('Not Saved');
            $(input_pseudoclass).attr('class','eappsBtnRed');
        } else if (SavedStatus === 'RESET') {
            $(input_pseudoclass).text('  Save   ');
            $(input_pseudoclass).attr('buttonState','Disabled');
            $(input_pseudoclass).attr('class','eappsBtnGreyDisabled');
        } else   {
            chla.eApps.Logger.LogError('Unknown Save button function:  ' + SavedStatus);
        }
    },
    grey_yellow_green_red_reset : function(SaveBtnID, SavedStatus) {
        var input_pseudoclass = SaveBtnID;
        if (SavedStatus == 'OK' ) {
            $(input_pseudoclass).text('Saved  ');
            $(input_pseudoclass).attr('class','eappsBtnLightGreen');
        } else if (SavedStatus == 'RESET') {
            $(input_pseudoclass).text('  Save  ');
            $(input_pseudoclass).attr('class','eappsBtnGrey');
        } else if (SavedStatus == 'CHANGED') {
            $(input_pseudoclass).text(' Changed ');
            $(input_pseudoclass).attr('class','eappsBtnYellow');
        } else if (SavedStatus == 'FAIL') {
            $(input_pseudoclass).text('Not Saved');
            $(input_pseudoclass).attr('class','eappsBtnRed');
        } else   {
            chla.eApps.Logger.LogError('Unknown Save button function:  ' + SavedStatus);
        }
    }
});
chlaNs('chla.eApps.Settings',   ChlaStdClass.neo() );
ChlaStdClass.applyProperties(chla.eApps.Settings, {
    version: 'R04_17_00',
    c_Date: '10/27/2018 14:00:00' ,
    c_Location:'I:/WININTEL/static_content/custom_mpage_content/custom-components/',
    c_Comment:'',
    loadVars: function (){
        ChlaStdClass.applyProperties(chla.eApps.gVars, chla.eApps.Settings.eApps.gVars);
    },
    eApps: {
        gVars: {
            LibVer: '3.0',
            transparentSpacer : 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAH0lEQVQ4y2P8//8/AzUAEwOVwKhBowaNGjRq0GAxCACzBwMhgtH1aQAAAABJRU5ErkJggg==',
            _profiler : {},
            _tmplCache: [],
            imgPathExtJS:'eAppsResources/ext-4.2.0/resources/themes/images/default/',
            //:|-------------------------------------------------------
            //:|-------------------------------------------------------
            //:|Edit the baseResources to point to the custom-components folder of the target environment.
            //:|baseResources: './',       //Local Development
            baseResources: 'I:/WININTEL/static_content/custom_mpage_content/custom-components/',
			baseStaticMPagesResources: 'I:/WININTEL/static_content/custom_mpage_content/Chla_eApps_Static_mPages/',
            //:|-------------------------------------------------------
            //:|Edit the testMode variables to 'false' for Cerner environments
            //:|=======================================================
            testMode: false,
            testModeAssignedProvidersData: true,
            testModeAssignedProvidersDivDefaultClosed: true,
            //:|appServer: '159.140.229.8',      // CERT
            appServer: '159.140.229.9',  // PROD  chla.eApps.gVars.appServer
            //:|-------------------------------------------------------
            //:|Edit the Web service DC menu, HO,  NR variables for target environments
            //:|=======================================================
            //:| development locally hosted environment Build/Cert
            //:| ServerURL : 'http://tchlaeappsdev01',
            //:| RLWebserviceURL : '/Dev_RLWebService_CK',
            //:|=======================================================
            //:| Cerner hosted environment Build/Cert
            //:| ServerURL : 'http://10.101.136.222',
            //:| RLWebserviceURL : '/Dev_RLWebService_CK',
            //:|=======================================================
            //:| Cerner hosted environment Prod  mPage IIS server
            ServerURL : 'http://Chlampageservice.cernerasp.com',
            RLWebserviceURL : '/RLWebService2',
            //:|=======================================================
            //:|--------------------------------------------------------
            //:|Edit the Web service DC menu, HO,  NR variables for target environments
            //:| Cerner hosted environment Prod mobile IIS server - ajax for assigned Providers
            //:| ServerURL_AP : 'http://10.100.30.76',                //iis chlaMhealth01
            //:| RLWebserviceURL_AP : 'RLWebServiceCC',
            //:|=======================================================
            //:| Development environment Build/Cert
            //:| ServerURL_AP : 'http://10.101.136.222',
            //:| RLWebserviceURL_AP : '/Dev_RLWebService_CK',
            //:|=======================================================
            //:|  Cerner hosted environment  Build/Cert
            //:| ServerURL_AP : 'http://tchlaeappsdev01',
            //:| RLWebserviceURL_AP : '/Dev_RLWebService_CK',
            //:|=======================================================
            //:| Cerner hosted environment Prod  mPage IIS server
            ServerURL_AP : 'http://Chlampageservice.cernerasp.com',
            RLWebserviceURL_AP : '/RLWebService2',
            //:|=======================================================
            //:|-------------------------------------------------------
            LearningAndCareNeedsAssessmentPowerForm_ID: '397861197',
            DischargeCriteriaPowerForm_ID: '421650037',
            educationnote_cd: 367287082,
            admissioneducationnote_cd: 324386751 ,
            niccueducationpnote_cd: 272789335 ,
            cardiologyeducationnote_cd: 329716968,
            sepsis_Lookback: '7,d'
        }
    }
});
chla.global = {
    baseResources: '',
    imgPath: '',
    imgPathExtJS:'',
    aryIntakeRate: [],
    aryUrineRate:[],
    aryMixedStool: [],
    last_stool: null,
    assignedProvidersResized: false,
    group_spacer: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAH0lEQVQ4y2P8//8/AzUAEwOVwKhBowaNGjRq0GAxCACzBwMhgtH1aQAAAABJRU5ErkJggg==',
    group_collapse:'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAMUlEQVR4nGNgGAV0B//RBZgo0UyqzRHkGgLTTJYrkDWTbAC6ZqwGMOLRjAvg0jNiAQB8ugxaeOBGaAAAAABJRU5ErkJggg==',
    group_expand: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAVElEQVR4nNWTQQrAQAgDM6X//3J6XRaV0L203pRkCAGxrZO5jtzfAgACtOxlObtuTNBBygRvIVEHEyQusYPEANtU9wjQmSPAZJakexFG5l3H/5/pAUdbHSOasGHAAAAAAElFTkSuQmCC"'

};

chla.eApps.Settings.loadVars();
chla.global.imgPathExtJS = chla.eApps.gVars.baseResources + chla.eApps.gVars.imgPathExtJS;
chla.global.imgPath      = chla.eApps.gVars.baseResources + 'eAppsResources/images/';
chla.global.testMode     = chla.eApps.gVars.testMode;

chla.global.ServerURL =  chla.eApps.gVars.ServerURL;
chla.global.RLWebserviceURL =  chla.eApps.gVars.RLWebserviceURL;

chla.global.ServerURL_AP =  chla.eApps.gVars.ServerURL_AP;
chla.global.RLWebserviceURL_AP =  chla.eApps.gVars.RLWebserviceURL_AP;

chla.eApps.gVars.H6_transparentSpacer = '<img src="' + chla.eApps.gVars.transparentSpacer + '" height="5px" width="17px"  >';

chla.eApps.Html.SectionHeaderCtl = chlaNsMgr.aliasDirector('chla.eApps.gSectionHeaderCtl');
chla.eApps.Html.SectionData = chlaNsMgr.aliasDirector('chla.eApps.gSectionData');
chla.eApps.Html.Tmplts = chlaNsMgr.aliasDirector('chla.eApps.gTmplts');


chla.eApps.gCSSBehaviors = chlaNsMgr.aliasDirector('chla.eApps.gCSSBehavior');  //need migration to non-conflict core library V3
chla.eApps.SaveButtonBehavior  = chla.eApps.gButtonBehaviorSave.neo();        //need migration to non-conflict core library V3

// chla.eApps.Funcs = chla.eApps.gFuncs;
// chla.eApps.Funcs.PowerNoteMPageUtils =   chla.eApps.gFuncs.PowerNoteMpUtil;
//
// chla.eApps.Vars.H5_Tmpl = chla.eApps.Tmplts.H5_Tmpl;
// chla.eApps.Vars.H6_Tmpl = chla.eApps.Tmplts.H6_Tmpl;
//
// chla.global.CCLRequest = chla.eApps.gCCLRequest.neo();
//
// chla.eApps.CCLRequest.BtnSaveBehavior = function() {
//         this.CCLreqObj = null ;
//         this.BtnSaveLbl ='';
//         this.bFinished = false;
//         this.ObjectName = '';
//         this.XmtCycleCnt = 0;
//         this.CallBackOperation = { notImplemented: true};
//         this.BtnSaveBehaviorFunc = { notImplemented: true};
//         this.DataTransferReceive = null;
//     }
//
//
// chla.eApps.CCLRequest.BtnSaveBehavior.prototype.DataTransfer = chla.global.CCLRequest.DataTransfer2;
// chla.eApps.CCLRequest.BtnSaveBehavior.prototype.DataTransfer2Receive = chla.global.CCLRequest.DataTransfer2Receive;
// chla.eApps.CCLRequest.prototype.DataTransfer = chla.global.CCLRequest.DataTransfer2;

chla.eApps.CC_Settings = {

    operationMode:'normal',
    getGlobalOperationModeCtlFlag: function() {
            return chla.eApps.CC_Settings.operationMode;
    },
    getGlobalOperationModeCtlFlag: function(ccname){
            return chla.eApps.CC_Settings[ccname].operationMode;
    },
    getDebugModeCtlFlag: function(ccname){
        return chla.eApps.CC_Settings[ccname].debugMode;
    },
    getLogModeCtlFlag: function(ccname){
        return chla.eApps.CC_Settings[ccname].logMode;
    },
    EDHnotesED:  {
        compHeight: '500px',   /*default 400px*/
        rowCnt: 55,
        NtsTextID: 'GNtsText',
        NtsSaveID: 'GNtsSave',
        NtsSaveCCL:'chla_ca_mp_cc_ins_ednote_json'
    },
    ptinfo:  {
        mainTemplate:'mainTbl',
        operationMode:false,
        debugMode:false,
        logMode:false

    },
    ptinfo2:  {
        mainTemplate:'mainTbl_4col',
        operationMode:'normal',
        debugMode:false,
        logMode:false,
        mainTbl_4col:[
           '<table id="PtinfoTbl" cellspacing="0" cellpadding="0" border="0"><tbody>'
          ,'<tr><td class="col-1" style="width:20%;">Age</td><td class="col-2" style="width:30%;"><#=Age#></span></td>'
          ,'<td class="col-1" style="width:20%;"><a href="<#=FirstCallLink#>">1st Call</a></td>'
          ,'<td class="col-2"="width:30%;"><#=FirstCall#></td></tr>'
          ,'<tr><td class="col-1" style="width:20%;">Admission Dt</td><td class="col-2" style="width:30%;"><#=AdmissionDate#></td>'
          ,'<td class="col-1" style="width:20%;">Attending</td><td class="col-2" style="width:30%;"><#=Attending#></td></tr>'
          ,'<tr><td class="col-1" style="width:20%;"><a href="<#=MedCalcWtLink#>">Med Calc Wt</a></td>'
          ,'<td class="col-2" style="width:30%;"><#=MedCalcWt#></td><td class="col-1" style="width:20%;">Referring</td>'
          ,'<td class="col-2" style="width:30%;"><#=Referring#></td></tr>'
          ,'<tr><td class="col-1" style="width:20%;"><a href="<#=RoutineWtLink#>">Routine Wt</a></td>'
          ,'<td class="col-2" style="width:30%;"><#=RoutineWt#></td><td class="col-1" style="width:20%;">Primary Oncologist-Life</td>'
          ,'<td class="col-2" style="width:30%;"><#=Oncologist#></td></tr>'
          ,'<tr><td class="col-1" style="width:20%;"><a href="<#=HeightLink#>">Height</a></td>'
          ,'<td class="col-2" style="width:30%;"><#=Height#></td>'
          ,'<td class="col-1" style="width:20%;"><a href="<#=CareTeamLink#>">Care Team</a></td>'
          ,'<td class="col-2" style="width:30%;"><#=CareTeam#></td></tr>'
          ,'<tr><td class="col-1" style="width:20%;">Allergies</td>'
          ,'<td class="col-2" style="width:30%;"><span class="allergyred"><#=Allergies#></span></td>'
          ,'<td class="col-1" style="width:20%;">Patient\'s Parent / Guardian</td>'
          ,'<td class="col-2" style="width:30%;"><#=PatientParentGuardian#></td></tr>'
          ,'<tr>'
          ,'<td class="col-1">Sepsis Alerts:</td><td class="col-2"><#=Sepsis#>'
          ,'<td class="col-1" style="width:20%;">Phone Number</td><td class="col-2" style="width:30%;"><#=PhoneNumber#></td></tr>'
          ,'<tr><td class="col-1" style="width:20%;">Resistant</td><td class="col-2" style="width:30%;"><#=Resistant#></td>'
          ,'<td class="col-1" style="width:20%;">Insurance</td><td class="col-2" style="width:30%;"><#=Insurance#></td></tr>'
          ,'<tr><td class="col-1" style="width:20%;">Isolation</td><td class="col-2" style="width:30%;"><#=Isolation#></td>'
          ,'<td class="col-1" style="width:20%;">ICU</td><td class="col-2" style="width:30%;"><#=ICU#></td></tr>'
          ,'<tr>'
          ,'<td class="col-1" style="width:20%;">Blood Type</td>'
          ,'<td class="col-2" style="width:30%;"><span class="bloodblue"><#=BloodType#></span></td>'
          ,'<td class="col-1" style="width:20%;">Medical Devices</td>'
          ,'<td class="col-2" style="width:30%;"><#=MedicalDevices#></td></tr>'
          ,'<tr>'
          ,'<td class="col-1" style="width:20%;"><a href="<#=FallsRiskScoreLink#>">Falls Risk Score</a></td>'
          ,'<td class="col-2" style="width:30%;"><#=FallsRiskScore#></td>'
          ,'<td class="col-1" style="width:20%;"><a href="<#=DateofLastFallLink#>">Date of Last Fall</a></td>'
          ,'<td class="col-2" style="width:30%;"><#=DateofLastFall#></td></tr>'
          ,'<tr>'
          ,'<td class="col-1" style="width:20%;">AB Screen 1:</td>'
          ,'<td class="col-2" style="width:30%;"><span class="bloodblue"><#=ABScreen1#></span></td>'
          ,'<td class="col-1" style="width:20%;">AB Screen 2:</td>'
          ,'<td class="col-2" style="width:30%;"><span class="bloodblue"><#=ABScreen2#></span></td></tr>'
          ,'<tr>'
          ,'<td class="col-1" style="width:20%;">Blood Consent Date</td>'
          ,'<td class="col-2" style="width:30%;"><span class="bloodblue"><#=BloodConsentDate#></span></td>'
          ,'<td class="col-1" style="width:20%;">Blood Type Confirmation</td>'
          ,'<td class="col-2" style="width:30%;"><span class="bloodblue"><#=BloodTypeConfirmation#></span></td></tr></tbody></table>'
       ]
    },
    assignedproviders: {
        operationMode:'normal',
        debugMode:false,
        logMode:false,
        getServerURL_AP: function(){
            return chla.eApps.CC_Settings.assignedproviders.ServerURL_AP;
        },
        getRLWebserviceURL_AP: function(){
            return chla.eApps.CC_Settings.assignedproviders.RLWebserviceURL_AP;
        },
        //:|=======================================================
        //:|--------------------------------------------------------
        //:|Edit the Web service DC menu, HO,  NR variables for target environments
        //:| Cerner hosted environment Prod mobile IIS server - ajax for assigned Providers
        //:| ServerURL_AP : 'http://10.100.30.76',                //iis chlaMhealth01
        //:| RLWebserviceURL_AP : 'RLWebServiceCC',
        //:|=======================================================
        //:| Development environment Build/Cert
        ServerURL_AP : 'http://10.101.136.222',
        RLWebserviceURL_AP : '/Dev_RLWebService_CK',
        //:|=======================================================
        //:|  ServerURL_AP : 'http://chlaMhealth01
        //:|  RLWebserviceURL_AP : 'RLWebServiceCC',
        //:|  ServerURL_AP : 'http://chlaiisappp01',
        //:|  RLWebserviceURL_AP : 'RLWebService2',
        //:|=======================================================
        //:|  Non - Cerner hosted environment - Local development
        //:| ServerURL_AP : 'http://tchlaeappsdev01',
        //:| RLWebserviceURL_AP : 'Dev_RLWebService_CK',
        //:|=======================================================
        //:| Cerner hosted environment Prod  mPage IIS server
        //:| ServerURL_AP : 'http://Chlampageservice.cernerasp.com',
        //:| RLWebserviceURL_AP : '/RLWebService2',
        //:|=======================================================
        //:|-------------------------------------------------------
        testModeUseDummyData: false ,
        getTestModeAssignedProvidersData: function(){
            return chla.eApps.CC_Settings.assignedproviders.testModeUseDummyData;
        },

        ExpandedModeAssignedProviders: 'open',
        getExpandedModeAssignedProviders: function(){
            return chla.eApps.CC_Settings.assignedproviders.ExpandedModeAssignedProviders;
        },
        setExpandedModeAssignedProviders: function(inputVal){
            chla.eApps.CC_Settings.assignedproviders.ExpandedModeAssignedProviders = inputVal;
        }

        // testModeAssignedProvidersDivDefaultClosed: false,
        // getTestModeAssignedProvidersDivDefaultClosed: function(){
        //     return chla.eApps.gVars.testModeAssignedProvidersDivDefaultClosed;
        // }
    },

    surgeries        : {operationMode: 'normal', debugMode: false, logMode: false},
    ios              : {operationMode: 'normal', debugMode: false, logMode: false},
    labs             : {operationMode: 'normal', debugMode: false, logMode: false},
    micros           : {operationMode: 'normal', debugMode: false, logMode: false},
    laborders        : {operationMode: 'normal', debugMode: false, logMode: false},
    meds             : {operationMode: 'normal', debugMode: false, logMode: false},
    radiology        : {operationMode: 'normal', debugMode: false, logMode: false},
    vitalsigns       : {operationMode: 'normal', debugMode: false, logMode: false},
    note             : {operationMode: 'normal', debugMode: false, logMode: false},
    gastroorders     : {operationMode: 'normal', debugMode: false, logMode: false},
    levels           : {operationMode: 'normal', debugMode: false, logMode: false},
    bloodgas         : {operationMode: 'normal', debugMode: false, logMode: false},
    ventilator       : {operationMode: 'normal', debugMode: false, logMode: false},
    dialysis         : {operationMode: 'normal', debugMode: false, logMode: false},
    linestubesdrains : {operationMode: 'normal', debugMode: false, logMode: false},
    neuro            : {operationMode: 'normal', debugMode: false, logMode: false},
    apneabradydesats : {operationMode: 'normal', debugMode: false, logMode: false},
    environment      : {operationMode: 'normal', debugMode: false, logMode: false},
    overview         : {operationMode: 'normal', debugMode: false, logMode: false},
    inhaledtreatments: {operationMode: 'normal', debugMode: false, logMode: false},
    analgesics       : {operationMode: 'normal', debugMode: false, logMode: false},
    dc_instructions  : {operationMode: 'normal', debugMode: false, logMode: false},
    diet_feeding     : {operationMode: 'normal', debugMode: false, logMode: false},
    appt             : {operationMode: 'normal', debugMode: false, logMode: false},
    medrec           : {operationMode: 'normal', debugMode: false, logMode: false},
    dcptinfo         : {operationMode: 'normal', debugMode: false, logMode: false},
    learning         : {operationMode: 'normal', debugMode: false, logMode: false},
    hm_supplies      : {operationMode: 'normal', debugMode: false, logMode: false},
    admit_info       : {operationMode: 'normal', debugMode: false, logMode: false},
    transportation   : {operationMode: 'normal', debugMode: false, logMode: false},
    wk_sch_note      : {operationMode: 'normal', debugMode: false, logMode: false},
    dcMiscNotes      : {operationMode: 'normal', debugMode: false, logMode: false},
    AmblAppts        : {operationMode: 'normal', debugMode: false, logMode: false},
    RadOrders        : {operationMode: 'normal', debugMode: false, logMode: false},
    RadPreScreen     : {operationMode: 'normal', debugMode: false, logMode: false},
    RadReports       : {operationMode: 'normal', debugMode: false, logMode: false},
    RadAppts         : {operationMode: 'normal', debugMode: false, logMode: false},
    radnpnotes       : {operationMode: 'normal', debugMode: false, logMode: false},
    BMTMeasure       : {operationMode: 'normal', debugMode: false, logMode: false},
    oncologySurgeries: {operationMode: 'normal', debugMode: false, logMode: false},
    OncologyPtInfo   : {operationMode: 'normal', debugMode: false, logMode: false},
    HearingOrder     : {operationMode: 'normal', debugMode: false, logMode: false},
    wpp              : {operationMode: 'normal', debugMode: false, logMode: false},
    EDHandoff1        : {operationMode: 'normal', debugMode: false, logMode: false},
    SurveyTimer      : {operationMode: 'normal', debugMode: false, logMode: false},
    GeneralDoc       : {operationMode: 'normal', debugMode: false, logMode: false},
    EDHnotes         : {operationMode: 'normal', debugMode: false, logMode: false},
    edDocNotes       : {operationMode: 'normal', debugMode: false, logMode: false},
    EDHandoff        : {operationMode: 'normal', debugMode: false, logMode: false},
    dcSummary        : {operationMode: 'normal', debugMode: false, logMode: false}


};
//::==========================================================================================================================
//::========================================================
//:: eApps Lib ver 3.0- 3.5
//::========================================================
/**
 *  input is mm/dd/yy or mm-dd-yy we need input year must be yyyy
 * @param dateStr
 * @param sepCharRet
 * @returns {string}
 */
chla.eApps.gFuncs.ISO8601_fullYearFmt = function (dateStr, sepCharRet) {
    var wrkDate,
        wrkValue,
        wrkArr = [],
        wrkArr2,
        wrkArr3 = [],
        retSepChar = sepCharRet || '/',
        retResult = '';
    if (typeof dateStr === 'string' && dateStr.length > 0) {
        if (dateStr.length === 8) {
            wrkArr.length = 0;
            wrkArr.push(dateStr.substring(0, 6));
            wrkArr.push('20');
            wrkArr.push(dateStr.substring(6, 8));
            dateStr = wrkArr.join(''); //mm/dd/yy --> mm/dd/yyyy
        }
        wrkDate = new Date(dateStr);
        wrkValue = wrkDate.toJSON();  // convert to ISO8601 string
        if (wrkValue !== null) {
            wrkArr = wrkValue.split('T');
            wrkArr2 = wrkArr[0].split('-');
            wrkArr3.length = 0;
            wrkArr3.push(wrkArr2[1]);
            wrkArr3.push(wrkArr2[2]);
            wrkArr3.push(wrkArr2[0]);
            retResult = (wrkArr3.join(retSepChar));
        }
    }
    return retResult;    //returns mm/dd/yyyy
};
/**
 * Calculates the number of day between to dates
 * @param date1
 * @param date2
 * @returns {number}
 */
chla.eApps.gFuncs.daysBetween = function (date1, date2) {
    var one_day = 1000 * 60 * 60 * 24,
        date1_ms = date1.getTime(),
        date2_ms = date2.getTime(),
        difference_ms = date2_ms - date1_ms;
    return Math.round(difference_ms / one_day);
};
/**
 * Convert date object to date string
 * @param dateObj
 * @param dateSepChar
 * @returns {string}
 */
chla.eApps.gFuncs.getStrFromDateObj = function (dateObj,dateSepChar) {
    var arrWrk=[],
        theMth= (dateObj.getMonth() + 1),
        theDte=dateObj.getDate();
    dateSepChar = (typeof dateSepChar !== 'undefined'? dateSepChar: '/');
    arrWrk.push((theMth<10? 0 : ''));
    arrWrk.push(theMth);
    arrWrk.push(dateSepChar);
    arrWrk.push((theDte<10? 0 : ''));
    arrWrk.push(theDte);
    arrWrk.push(dateSepChar);
    arrWrk.push(dateObj.getFullYear());
    return arrWrk.join('');
};
chla.eApps.gFuncs.dateDiff = function(fromDate, toDate, interval) {
    /*
     * DateFormat month/day/year hh:mm:ss
     * ex.
     * dateDiff('01/01/2011 12:00:00','01/01/2011 13:30:00','seconds');
     * dateDiff( fromDate_DateObj, toDate_DateObj,'minutes')
     */
    var second=1000, minute=second*60, hour=minute*60, day=hour*24, week=day*7;
    if (typeof fromDate === 'string')
        fromDate = new Date(fromDate);
    if (typeof toDate === 'string')
        toDate = new Date(toDate);
    var timediff = toDate - fromDate;
    if (isNaN(timediff)) return NaN;
    switch (interval) {
        case "years": return toDate.getFullYear() - fromDate.getFullYear();
        case "months": return (
            ( toDate.getFullYear() * 12 + toDate.getMonth() )
            -
            ( fromDate.getFullYear() * 12 + fromDate.getMonth() )
        );
        case "weeks"  : return Math.floor(timediff / week);
        case "days"   : return Math.floor(timediff / day);
        case "hours"  : return Math.floor(timediff / hour);
        case "minutes": return Math.floor(timediff / minute);
        case "seconds": return Math.floor(timediff / second);
        default: return undefined;
    }
};

/**
 * formats date object to string : mm/dd/yyyy
 * @param dtCurWrkDate - {date}  date source to be formatted
 * @param sepChar - {string} Character to be use as separator in formatted string
 * @returns {string}
 */
chla.eApps.gFuncs.sFormatShortDate = function (dtCurWrkDate,sepChar) {
    var Mth = dtCurWrkDate.getMonth() + 1,
        Dte = dtCurWrkDate.getDate(),
        dateSepChar = (sepChar || '/'),
        currentDate =[];
    currentDate.push((Mth > 9 ? '' : '0'));
    currentDate.push(Mth);
    currentDate.push(dateSepChar);
    currentDate.push((Dte > 9 ? '' : '0'));
    currentDate.push(Dte);
    currentDate.push(dateSepChar);
    currentDate.push(dtCurWrkDate.getFullYear());
    return currentDate.join('');
};
/**
 *
 * @param pWrkdttm - {Date}
 * @returns {string}
 */
chla.eApps.gFuncs.sFormatShortTime = function (pWrkdttm) {
    var strTime =[],
        hour    = pWrkdttm.getHours(),
        minute  = pWrkdttm.getMinutes();
    strTime.push((hour > 9 ? '' : '0'));
    strTime.push(hour);
    strTime.push(':');
    strTime.push((minute > 9 ? '' : '0'));
    strTime.push(minute);
    return strTime.join('');
};
/**
 *
 * @param arguments - [string]
 * @returns {string}
 */
chla.eApps.gFuncs.sFormatter = function (strFormat) {
    var args,
        formatRe = /\{(\d+)\}/g;
    function toArray(iterable, start, end){
        var array = [],
            i;
        if (!iterable || !iterable.length) {
            return [];
        }

        if (typeof iterable === 'string') {
            iterable = iterable.split('');
        }

        start = start || 0;
        end = end ? ((end < 0) ? iterable.length + end : end) : iterable.length;

        for (i = start; i < end; i++) {
            array.push(iterable[i]);
        }
        return array;
    }
     args = toArray(arguments, 1);
    return strFormat.replace(formatRe, function(m, i) {
        return args[i];
    });
};
/**
 * Get the X & Y coordinates of an element relative to the document
 */
chla.eApps.gFuncs.getOffset = function (selector) {
	var parentOffset = $(selector).offset();
    return { top: parentOffset.top, left: parentOffset.left };
}
/**
 * Get the X & Y coordinates of an element relative to the parentOffset
 */
chla.eApps.gFuncs.getParentOffset = function (selector) {
	var parentOffset = $(selector).position();
    return { top: parentOffset.top, left: parentOffset.left };
}

/**
 * Create a new floating table header by cloning the original and removing the tbody
 * @param parentSelector - [string]
 * @param tableSelector - [string]
 */
chla.eApps.gFuncs.createFloatingFixedTableHeader = function (parentSelector, tableSelector) {
	var new_Tbl_Name = tableSelector.replace(/\W/g, '').toLowerCase() + '_new';
	var newTbl = $(tableSelector).clone().css('position','absolute').css('z-index','5').css('top',chla.eApps.gFuncs.getParentOffset(tableSelector).top).prop('id', new_Tbl_Name).css('width',$(tableSelector).css('width'));
	$(parentSelector).append(newTbl);
	$('#' + new_Tbl_Name + ' tbody').remove();
}

/**
 * Create a new floating popup window (centered and at the top of the window)
 * @param id - [string]
 * @param winTitle - [string]
 * @param innerHTML - [string]
 * @param winWidth - [int]
 */
chla.eApps.gFuncs.createFloatingPopupWindow = function (id, winTitle, innerHTML) {	
	$('#' + id).remove();
	$('<div>').appendTo('body').prop('id', id).css('position', 'fixed').css('top', 30).css('padding', '12px')
	.css('border', '1px solid black').css('background-color', 'white').css('z-index', '99');
	
	var el = '<h2 style="cursor:pointer;margin-bottom:8px;"><span>' + winTitle + '</span></h2>' +
		'<img style="position:absolute;top:12px;right:12px;cursor:pointer;" onclick="$(this).parent().remove();" title="Close"' +
		'id="btn-close-' + id + '" src="' + chla.global.imgPath + '6457_up_18.png">' + 
		innerHTML;
	$('#' + id).append(el);
	var left = window.innerWidth/2 - ($('#' + id).width()/2) - 10;
	$('#' + id).css('left', left);
}

/**
 * Create a callout popup window that will point an arrow to target element
 * @param id - [string]
 * @param innerHTML - [string]
 * @param $targetEl - [JQuery object]
 * @param calloutDirection - ["right", "left", "above", "below"] - DO NOT use "left" or "above" with HighCharts 
 * because the graphs are rendered after this function runs out and callout width and height will not be available
 */
chla.eApps.gFuncs.createFloatingCallout = function (id, innerHTML, $targetEl, calloutDirection) {	
	var left = 0,
		top = 0,
		targetLeft = $targetEl.offset().left,
		targetTop = $targetEl.offset().top,
		targetHeight = $targetEl.height(),
		targetWidth = $targetEl.width(),
		winWidth = window.innerWidth,
		winHeight = window.innerHeight;
	var _div = $('<div>').appendTo('body').prop('id', id).css('position', 'fixed').css('padding', '12px')
	.css('border', '1px solid grey').css('background-color', 'white').css('z-index', '199');
	
	var el = '<img style="position:absolute;top:12px;right:12px;cursor:pointer;z-index:200;" onclick="$(this).parent().remove();" title="Close"' +
		'id="btn-close-' + id + '" src="' + chla.global.imgPath + '6457_up_18.png">' +
		innerHTML;
	_div.append(el);
	
	var _cout = calloutDirection ? calloutDirection.toLowerCase() : 'right';
	if (_cout == 'right') {
		if(!testDirection('right')) {
			if(!testDirection('below')) {
				if(!testDirection('left')) {
					testDirection('above');
				}
			}
		}
	} else if (_cout == 'left') {
		if(!testDirection('left')) {
			if(!testDirection('below')) {
				if(!testDirection('right')) {
					testDirection('above');
				}
			}
		}
	} else if (_cout == 'above') {
		if(!testDirection('above')) {
			if(!testDirection('below')) {
				if(!testDirection('right')) {
					testDirection('left');
				}
			}
		}
	} else {
		if(!testDirection('below')) {
			if(!testDirection('right')) {
				if(!testDirection('left')) {
					testDirection('above');
				}
			}
		}
	}
	
	_div.addClass('callout-' + _cout);
	$('#' + id).css('left', left).css('top', top);
	
	function testDirection (dir) {
		switch(dir) {
			case 'right' : 	
				if(winWidth - (targetLeft + targetWidth + _div.width()) > 0) {
					_cout = 'right'; 
					left = targetLeft + targetWidth;
					top = targetTop + targetHeight/2 - 10;
					return true;
				} else {
					return false;
				}
			case 'below' : 	
				if(winHeight - (targetTop + targetHeight + _div.height()) > 0) {
					_cout = 'below'; 
					left = targetLeft;
					top = targetTop + targetHeight + 5;
					return true;
				} else {
					return false;
				}
			case 'left' : 	
				if(targetLeft - _div.width() > 0) {
					_cout = 'left'; 
					left = targetLeft - _div.width() - 30;
					top = targetTop + targetHeight/2 - 10;
					return true;
				} else {
					return false;
				}
			case 'above' : 	
				if(targetTop - _div.height() > 0) {
					_cout = 'above'; 
					left = targetLeft;
					top = targetTop - _div.height() - 30;
					return true;
				} else {
					return false;
				}
			default: break;
		}
	};
}

/**
 * Create a hover based on html string or JS evaluation
 * @param selector - [string]
 * @param appendTo - [string]
 * @param htmlStr - [string]
 * @param evaluate - [bool]
 * @param expression - [string]
 * @param bgcolor - [string]
 */
chla.eApps.gFuncs.bindFloatingHover = function (selector, appendTo, htmlStr, evaluate, expression, bgcolor) {
	$(selector).hover(
		function(e) {
			var el;
			if(evaluate) {
				var el = eval(expression);
				if (typeof el === 'string') {
					el = $('<div>').append(el);
				}
			} else {
				el = $('<div>').append(htmlStr);
			}
			var parentOffset = $(appendTo).offset();
			var relX = e.pageX - parentOffset.left + 15;
			var relY = e.pageY - parentOffset.top;
            var _bgcolor = bgcolor ? bgcolor : 'lightyellow';

			el.appendTo(appendTo);
			el.prop('id', 'temp-hover').css('position', 'absolute').css('top', relY).css('left', relX)
			.css('padding', '3px').css('border', '1px solid black').css('background-color', _bgcolor).css('z-index', '36');
			
			var hoverHeight = $('#temp-hover').height();
			if(window.innerHeight - hoverHeight - relY < 0) {
				$('#temp-hover').css('top', relY - hoverHeight);
			} else {
				$('#temp-hover').css('top', relY);
			}
			//$('#temp-hover td').css('background-color', _bgcolor);
		}, function(e) {
			$('#temp-hover').remove();
		}
	);
};

/**
 * Enable Drag & Drop
 * @param divID - [string]
 */
chla.eApps.gFuncs.bindDragAndDrop = function (divID) {
	var offset = [0,0];
	var divPopup = document.getElementById(divID);
	var isDown = false;

	divPopup.addEventListener('mousedown', function(e) {
		isDown = true;
		offset = [
			divPopup.offsetLeft - e.clientX,
			divPopup.offsetTop - e.clientY
		]
	}, true);

	document.addEventListener('mouseup', function() {
		isDown = false;
	}, true);

	divPopup.addEventListener('mousemove', function(e) {
		e.preventDefault();
		if (isDown) {
			divPopup.style.left = (e.clientX + offset[0]) + 'px';
			divPopup.style.top  = (e.clientY + offset[1]) + 'px';
	   }
	}, true);
};

/**
 * Create horizontal tabs
 * @param selector - [string]
 *
 * CSS NOTES
 * ContainerClass: 	.chla_tab_container
 * TabClass: 		.chla_tab
 */
chla.eApps.gFuncs.makeHorizontalTabs = function (selector) {
	var tab_lists_anchors = document.querySelectorAll(selector + " .chla_tab_container li a");
    var divs = document.querySelector(selector + ' .chla_tab_container').getElementsByClassName("chla_tab");
    for (var x = 0; x < tab_lists_anchors.length; x++) {
        if (tab_lists_anchors[x].classList.contains('active')) {
            divs[x].style.display = "block";
        }
        document.querySelectorAll(selector + " .chla_tab_container li a")[x].addEventListener('click', function(e) {
            var clicked_tab = e.target || e.srcElement;
            var div_to_show = clicked_tab.getAttribute('href');
            for (var i = 0; i < divs.length; i++) {
                if(divs[i].id != div_to_show.substring(1)) {
					divs[i].style.display = "none";
				}
            }
            for (var i = 0; i < tab_lists_anchors.length; i++) {
                tab_lists_anchors[i].classList.remove("active");
            }
            clicked_tab.classList.add('active');
            if(document.querySelector(div_to_show).style.display != "block") {
				document.querySelector(div_to_show).style.display = "block";
			}
        });
    }
};

chla.eApps.gFuncs.PowerNoteMpUtil = function (x,y,z) {
    chla.eApps.gFuncs.MPageUtils('POWERNOTE',x,y,z)
};
/**
 * OPEN PowerChart default tab
 * Adapter function
 * @param personid
 * @param encounterid
 * @param tabLbl
 * @param organizerLbl
 * @constructor
 */
chla.eApps.gFuncs.AppLinkMpUtil = function ( personid, encounterid , tabLbl, organizerLbl )  {
    chla.eApps.gFuncs.MPageDiscernAPI('APPLINK',personid,encounterid ,tabLbl,organizerLbl );
};
/**
 *  OPEN PowerChart default tab
 * Adapter function
 * @param personid
 * @param encounterid
 */
chla.eApps.gFuncs.APPLINK = function ( personid, encounterid)  {
    chla.eApps.gFuncs.MPageDiscernAPI('APPLINK',personid,encounterid ,'', '' );
};
/**
 * OPEN PowerChart Organizer level Resource Directory

 * @returns {boolean} - always false
 */
chla.eApps.gFuncs.LaunchMpRDO = function () {
    chla.eApps.gFuncs.MPageDiscernAPI('APPLINK',0,0,'','Resource Directory Organizer' );
    return false;
};
/**
 * MPage Discern Native Functions API:
 * API Functions
 * 1  APPLINK
 * 2  CCLEVENT
 * 3  CCLLINK
 * 4  CCLLINKPOPUP
 * 5  CCLNEWSESSIONWINDOW
 * 6  MESSAGING
 * 7  MPAGES_EVENT
 * 8  MPAGES_SVC_EVENT
 * 9  MPAGESOVERRIDEREFRESH
 * 10 MPAGESOVERRIDEPRINT
 * 11 PATIENTLISTNAVIGATION
 * 12 PCUPDATEREFRESHTIME
 * 13 XMLCCLREQUEST
 *
 * Parameters are passed by argument object
 */
chla.eApps.gFuncs.MPageDiscernAPI = function(){
    var objType,
        fncList = {
            'APPLINK': function (args)  {
                var sCmd = [],
                    personid     = (ChlaStdClass.isEmpty(args[1])? '': args[1]),
                    encounterid  = (ChlaStdClass.isEmpty(args[2])? '': args[2]),
                    tabLbl       = (ChlaStdClass.isEmpty(args[3])? '': args[3]),
                    organizerLbl = (ChlaStdClass.isEmpty(args[4])? '': args[4]);
                sCmd.push('/PERSONID=');
                sCmd.push(personid);
                sCmd.push(' /ENCNTRID=');
                sCmd.push(encounterid);
                if (tabLbl.length > 0 ) {
                    sCmd.push(' /FIRSTTAB=^');
                    sCmd.push(tabLbl);
                    sCmd.push('^');
                }
                if (organizerLbl.length > 0 ) {
                    sCmd.push('/ORGANIZERTAB=^');
                    sCmd.push(organizerLbl);
                    sCmd.push( '^');
                }
                chla.eAppsUtil.Logger.LogInfo('Applink api call 0, "Powerchart.exe",' + sCmd.join('') );
                APPLINK(0, "Powerchart.exe", sCmd.join(''));
            },
            'XMLCCLREQUEST': function () {
                var retVal= null;
                chla.eAppsUtil.Logger.LogInfo('execute: MPageDiscernAPI - XMLCCLREQUEST');
                if ( typeof chlaMpageApi.getXMLHttpRequest != 'undefined') {
                    chla.eAppsUtil.Logger.LogInfo('execute: MPageDiscernAPI - chlaMpageApi.getXMLHttpRequest');
                    retVal = chlaMpageApi.getXMLHttpRequest();
                } else {
                    retVal = window.external.XMLCclRequest();
                }
                return retVal;
            }
        };
    if(arguments.length > 0) {
        objType = arguments[0].toUpperCase();
        if ( fncList.hasOwnProperty(objType)) {
            return fncList[objType](arguments);
        } else {
            chla.eAppsUtil.Logger.LogError("eApps unsupported mPage Discern Native Function: " + objType);
        }
    } else {
        chla.eAppsUtil.Logger.LogError("eApps unsupported mPage Discern Native function: None Requested");
    }
};


chla.cc = [
    { 'namespace': 'ptinfo'           , 'active_ind': 0, 'name': 'chla.ptinfo'           , 'cclProgram': 'CHLA_CA_MP_MD_PT_INFO_JSON'          , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId', 'userId' ]                                                   ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'surgeries'        , 'active_ind': 0, 'name': 'chla.surgeries'        , 'cclProgram': 'CHLA_CA_MP_CC_SURGERIES_JSON'        , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'personId' ]                                                                ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'ios'              , 'active_ind': 0, 'name': 'chla.ios'              , 'cclProgram': 'CHLA_CA_MP_MD_IO_JSON2'              , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId' ]                                                             ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'labs'             , 'active_ind': 0, 'name': 'chla.labs'             , 'cclProgram': 'CHLA_CA_MP_MD_LABS_JSON'             , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId' ]                                                             ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'micros'           , 'active_ind': 0, 'name': 'chla.micros'           , 'cclProgram': 'CHLA_CA_MP_MD_MICRO_JSON'            , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId' ]                                                             ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'laborders'        , 'active_ind': 0, 'name': 'chla.laborders'        , 'cclProgram': 'CHLA_CA_MP_MD_LAB_ORD_JSON'          , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId' ]                                                             ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'meds'             , 'active_ind': 0, 'name': 'chla.meds'             , 'cclProgram': 'CHLA_CA_MP_MD_MEDS_JSON'             , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId' ]                                                             ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'radiology'        , 'active_ind': 0, 'name': 'chla.radiology'        , 'cclProgram': 'CHLA_CA_MP_RAD_EVENTS_JSON'          , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId' ]                                                             ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'vitalsigns'       , 'active_ind': 0, 'name': 'chla.vitalsigns'       , 'cclProgram': 'CHLA_CA_MP_CC_VITALS_JSON'           , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId' ]                                                             ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'note'             , 'active_ind': 0, 'name': 'chla.note'             , 'cclProgram': 'CHLA_CA_MP_MD_VITALS_JSON'           , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId' ]                                                             ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'gastroorders'     , 'active_ind': 0, 'name': 'chla.gastroorders'     , 'cclProgram': 'CHLA_CA_MP_CC_DIET_ORDERS_JSON'      , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId' ]                                                             ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'levels'           , 'active_ind': 0, 'name': 'chla.levels'           , 'cclProgram': 'CHLA_CA_MP_CC_MIC_DRG_LVL_JSON'      , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId' ]                                                             ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'bloodgas'         , 'active_ind': 0, 'name': 'chla.bloodgas'         , 'cclProgram': 'CHLA_CA_MP_CC_BLOOD_GAS_JSON'        , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId', '10', 'D' ]                                                  ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'ventilator'       , 'active_ind': 0, 'name': 'chla.ventilator'       , 'cclProgram': 'CHLA_CA_MP_CC_VENTILATOR_JSON'       , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId' ]                                                             ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'dialysis'         , 'active_ind': 0, 'name': 'chla.dialysis'         , 'cclProgram': 'CHLA_CA_MP_CC_DIALYSIS_JSON'         , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId' ]                                                             ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'linestubesdrains' , 'active_ind': 0, 'name': 'chla.linestubesdrains' , 'cclProgram': 'CHLA_CA_MP_CC_LTD_JSON'              , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId' ]                                                             ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'neuro'            , 'active_ind': 0, 'name': 'chla.neuro'            , 'cclProgram': 'CHLA_CA_MP_CC_NEURO_JSON'            , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId' ]                                                             ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'apneabradydesats' , 'active_ind': 0, 'name': 'chla.apneabradydesats' , 'cclProgram': 'CHLA_CA_MP_CC_ABD_JSON2'             , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId' ]                                                             ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'environment'      , 'active_ind': 0, 'name': 'chla.environment'      , 'cclProgram': 'CHLA_CA_MP_CC_ENVIRONMENT_JSON'      , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId' ]                                                             ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'overview'         , 'active_ind': 0, 'name': 'chla.overview'         , 'cclProgram': 'CHLA_CA_MP_CC_GEN_INFOV2_JSON'       , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId' ]                                                             ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'inhaledtreatments', 'active_ind': 0, 'name': 'chla.inhaledtreatments', 'cclProgram': 'CHLA_CA_MP_CC_INH_MED_ORD_JSON'      , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId' ]                                                             ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'analgesics'       , 'active_ind': 0, 'name': 'chla.analgesics'       , 'cclProgram': 'CHLA_CA_MP_CC_ANALGESICS_JSON'       , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId' ]                                                             ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'dc_instructions'  , 'active_ind': 0, 'name': 'chla.dc_instructions'  , 'cclProgram': 'CHLA_CA_MP_CC_DC_INSTR_JSON'         , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId','personId' ]                                                  ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'diet_feeding'     , 'active_ind': 0, 'name': 'chla.diet_feeding'     , 'cclProgram': 'CHLA_CA_MP_CC_DC_DIET_JSON'          , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId' ]                                                             ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'appt'             , 'active_ind': 0, 'name': 'chla.appt'             , 'cclProgram': 'CHLA_CA_MP_CC_DC_APPT_JSON'          , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId' ]                                                             ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'medrec'           , 'active_ind': 0, 'name': 'chla.medrec'           , 'cclProgram': 'CHLA_CA_MP_CC_DC_MEDREC_JSON'        , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId' ]                                                             ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'dcptinfo'         , 'active_ind': 0, 'name': 'chla.dcptinfo'         , 'cclProgram': 'CHLA_CA_MP_CC_DC_PTINFO_JSON'        , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId' ]                                                             ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'learning'         , 'active_ind': 0, 'name': 'chla.learning'         , 'cclProgram': 'CHLA_CA_MP_CC_LEARNING_JSON'         , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId','personId' ]                                                  ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'hm_supplies'      , 'active_ind': 0, 'name': 'chla.hm_supplies'      , 'cclProgram': 'CHLA_CA_MP_CC_HM_HEALTH_JSON'        , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId','personId' ]                                                  ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'admit_info'       , 'active_ind': 0, 'name': 'chla.admit_info'       , 'cclProgram': 'CHLA_CA_MP_CC_MAP_ORDERS_JSON'        , 'cclParams': [],'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId','personId' ]                                                  ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'transportation'   , 'active_ind': 0, 'name': 'chla.transportation'   , 'cclProgram': 'CHLA_CA_MP_CC_DC_TRNSPRT_JSON'       , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId','personId' ]                                                  ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'wk_sch_note'      , 'active_ind': 0, 'name': 'chla.wk_sch_note'      , 'cclProgram': 'CHLA_CA_MP_CC_DC_WSNOTE_JSON'        , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId','personId' ]                                                  ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'dcMiscNotes'      , 'active_ind': 0, 'name': 'chla.dcMiscNotes'      , 'cclProgram': 'CHLA_CA_MP_CC_DC_MNOTE_JSON'         , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId','personId' ]                                                  ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'AmblAppts'        , 'active_ind': 0, 'name': 'chla.AmblAppts'        , 'cclProgram': 'CHLA_CA_MP_AMBL_APPT_JSON'           , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'personId','encounterId','userId','3,m' ]                                   ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'RadOrders'        , 'active_ind': 0, 'name': 'chla.RadOrders'        , 'cclProgram': 'CHLA_CA_MP_RAD_ORDERS_JSON'          , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'personId','userId' ]                                                       ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'RadPreScreen'     , 'active_ind': 0, 'name': 'chla.RadPreScreen'     , 'cclProgram': 'CHLA_CA_MP_RAD_SCR_PF'               , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'personId','encounterId','userId' ]                                         ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'RadReports'       , 'active_ind': 0, 'name': 'chla.RadReports'       , 'cclProgram': 'CHLA_CA_MP_CC_RAD_REPORTS_JSON'      , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'personId', 'userId' ]                                                      ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'RadAppts'         , 'active_ind': 0, 'name': 'chla.RadAppts'         , 'cclProgram': 'CHLA_CA_MP_RADNP_APPT_JSON'          , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'personId','encounterId','userId' ]                                         ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'radnpnotes'       , 'active_ind': 0, 'name': 'chla.radnpnotes'       , 'cclProgram': 'CHLA_CA_MP_CC_RADNPNOTES_JSON'       , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'personId','encounterId','userId' ]                                         ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'BMTMeasure'       , 'active_ind': 0, 'name': 'chla.BMTMeasure'       , 'cclProgram': 'CHLA_CA_MP_MD_BMT_INFO_JSON'         , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId','personId','','','userId' ]                                   ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'oncologySurgeries', 'active_ind': 0, 'name': 'chla.oncologySurgeries', 'cclProgram': 'CHLA_CA_MP_CC_SURGERIES_JSON'        , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'personId','userId' ]                                                       ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'OncologyPtInfo'   , 'active_ind': 0, 'name': 'chla.OncologyPtInfo'   , 'cclProgram': 'CHLA_CA_MP_MD_ONC_PTINFO'            , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId','userId' ]                                                    ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'HearingOrder'     , 'active_ind': 0, 'name': 'chla.HearingOrder'     , 'cclProgram': 'CHLA_CA_MP_CC_NB_HEARING_JSON'       , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId','personId','userId' ]                                         ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'CTSurgeryNotes'   , 'active_ind': 0, 'name': 'chla.CTSurgeryNotes'   , 'cclProgram': 'CHLA_CA_MP_CC_CTSURG_NOTE_JSON'      , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId','personId','userId' ]                                         ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'HemOncNotes'      , 'active_ind': 0, 'name': 'chla.HemOncNotes'      , 'cclProgram': 'CHLA_CA_MP_CC_HEMONC_NOTE_JSON'      , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId','personId','userId' ]                                         ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'wpp'              , 'active_ind': 0, 'name': 'chla.wpp'              , 'cclProgram': 'NONE'                                , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'NONE' ]                                                                                ,'mainSectionStyle':'', 'customCfg':{'Implemented':true, "InitCCL": false}}                ,
    { 'namespace': 'edDocNotes'       , 'active_ind': 0, 'name': 'chla.edDocNotes'       , 'cclProgram': 'CHLA_CA_MP_CC_GENNOTES_JSON'         , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'personId','encounterId','userId' ]                                         ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'EDHandoff'        , 'active_ind': 0, 'name': 'chla.EDHandoff'        , 'cclProgram': 'CHLA_CA_MP_MD_EDH_INFO_JSON'         , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId'  , 'userId' ]                                                 ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'EDHandoff1'       , 'active_ind': 0, 'name': 'chla.EDHandoff1'       , 'cclProgram': 'NONE'                                , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'NONE' ]                                                                                ,'mainSectionStyle':'', 'customCfg':{'Implemented':true, "InitCCL": false}}                ,
    { 'namespace': 'SurveyTimer'      , 'active_ind': 0, 'name': 'chla.SurveyTimer'      , 'cclProgram': 'CHLA_CA_MP_CC_EDSURVEY_JSON'         , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId','personId','userId' ]                                         ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'GeneralDoc'       , 'active_ind': 0, 'name': 'chla.GeneralDoc'       , 'cclProgram': 'NONE'                                , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'NONE' ]                                                                                ,'mainSectionStyle':'', 'customCfg':{'Implemented':true, "InitCCL": false}}                ,
    { 'namespace': 'EDHnotes'         , 'active_ind': 0, 'name': 'chla.EDHnotes'         , 'cclProgram': 'CHLA_CA_MP_CC_EDNOTE_JSON'           , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId','personId','userId' ]                                         ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'NiccuNotes'       , 'active_ind': 0, 'name': 'chla.NiccuNotes'       , 'cclProgram': 'CHLA_CA_MP_CC_NICCU_NTE_JSON'        , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId','personId','userId' ]                                         ,'mainSectionStyle':'', 'customCfg':{'Implemented':false}}                ,
    { 'namespace': 'dcSummary'        , 'active_ind': 0, 'name': 'chla.dcSummary'        , 'cclProgram': 'CHLA_CA_MP_CC_DC_SUMMARY_JSON'       , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId','personId' ]                                                  ,'mainSectionStyle':'', 'customCfg':{'Implemented':true,'DummyData':false}}                ,
    { 'namespace': 'btiron'           , 'active_ind': 1, 'name': 'chla.btiron'           , 'cclProgram': 'CHLA_CA_MP_CC_BT_BLDLOSS_JSON'       ,'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'funcoper','encounterId','personId', 'userId']                               ,'mainSectionStyle':'height:230px'                       , 'customCfg':{'Implemented':true,'DummyData':false}},
    { 'namespace': 'btresponse'       , 'active_ind': 1, 'name': 'chla.btresponse'       , 'cclProgram': 'CHLA_CA_MP_CC_BT_RSP_JSON'           , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId','personId','userId','12,m' ]                                  ,'mainSectionStyle':'height:450px;overflow-y:scroll;'    , 'customCfg':{'Implemented':true,'DummyData':false}},
    { 'namespace': 'bthistory'        , 'active_ind': 1, 'name': 'chla.bthistory'        , 'cclProgram': 'CHLA_CA_MP_CC_BT_RSP_JSON'           , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId','personId','userId','6,m' ]                                  ,'mainSectionStyle':'height:450px;overflow-y:scroll;'    , 'customCfg':{'Implemented':true,'DummyData':false}},
    { 'namespace': 'btIndPhysHist'    , 'active_ind': 1, 'name': 'chla.btIndPhysHist'    , 'cclProgram': 'CHLA_CA_MP_CC_BT_IND_JSON'           , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    ,1,'encounterId','personId','userId' ]                                        ,'mainSectionStyle':'height:290px'                       , 'customCfg':{'Implemented':true,'DummyData':false}},
    { 'namespace': 'btIndLabHist'     , 'active_ind': 1, 'name': 'chla.btIndLabHist'     , 'cclProgram': 'CHLA_CA_MP_CC_BT_IND_JSON'           , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    ,2,'encounterId','personId','userId' ]                                        ,'mainSectionStyle':'height:290px'                       , 'customCfg':{'Implemented':true,'DummyData':false}},
    { 'namespace': 'BTlegend'         , 'active_ind': 1, 'name': 'chla.BTlegend'         , 'cclProgram': 'NONE'                                , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'NONE' ]                                                                                ,'mainSectionStyle':''                                   , 'customCfg':{'Implemented':true, "InitCCL":false}},
    { 'namespace': 'btrisks'          , 'active_ind': 1, 'name': 'chla.btrisks'          , 'cclProgram': 'CHLA_CA_MP_CC_BT_BLDLOSS_JSON'       , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    ,0,'encounterId','personId','userId']                                         ,'mainSectionStyle':'height:230px;padding:5px;'          , 'customCfg':{'Implemented':true,'DummyData':false}},
    { 'namespace': 'btreact'          , 'active_ind': 1, 'name': 'chla.btreact'          , 'cclProgram': 'NONE'                                , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'NONE' ]                                                                                ,'mainSectionStyle':'height:230px'                       , 'customCfg':{'Implemented':true, "InitCCL":false}},
    { 'namespace': 'btconsent'        , 'active_ind': 1, 'name': 'chla.btconsent'        , 'cclProgram': 'CHLA_CA_MP_CC_BT_CONSENT_JSON'       , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId','personId','userId' ]                                         ,'mainSectionStyle':'height:290px'                       , 'customCfg':{'Implemented':true,'DummyData':false}},
    { 'namespace': 'btpremeds'        , 'active_ind': 1, 'name': 'chla.btpremeds'        , 'cclProgram': 'CHLA_CA_MP_CC_BT_PREMED_JSON'        , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId','personId','userId','90,min','90,min' ]                       ,'mainSectionStyle':'height:450px;overflow-y:scroll;'    , 'customCfg':{'Implemented':true,'DummyData':false}},
    { 'namespace': 'btNotes'          , 'active_ind': 1, 'name': 'chla.btNotes'          , 'cclProgram': 'CHLA_CA_MP_CC_BT_NOTES'              , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'MINE'    , 'encounterId','personId','userId']                                          ,'mainSectionStyle':'height:230px;overflow-y:scroll;'    , 'customCfg':{'Implemented':true,'DummyData':false}},
    { 'namespace': 'assignedproviders', 'active_ind': 0, 'name': 'chla.assignedproviders', 'cclProgram': 'NONE'                                , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'NONE' ]                                                                                ,'mainSectionStyle':''                                   , 'customCfg':{'Implemented':true,  "InitCCL": false}}                ,
    { 'namespace': 'wkSpaceInfo'      , 'active_ind': 0, 'name': 'chla.wkSpaceInfo'      , 'cclProgram': 'NONE'                                , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'NONE' ]                                                                                ,'mainSectionStyle':''                                   , 'customCfg':{'Implemented':true,  "InitCCL": false}}                ,
    { 'namespace': 'ccSedation'       , 'active_ind': 1, 'name': 'chla.ccSedation'       , 'cclProgram': 'chla_ca_mp_cc_clinicalcare'               , 'cclParams': [], 'cclDataType': 'JSON', 'cclParamsArr': ['MINE', 0, 'encounterId', 'personId', 'userId', '', '', '', '0700', '0700', 0, 0, 0, 0, 0, 0, ''], 'mainSectionStyle': 'width:98%;overflow-y:auto;overflow-x:hidden;', 'customCfg': { 'Implemented': true, 'DummyData': false, 'StartTime': '07:00:00', 'EndTime':   '06:59:59', 'ShiftLength': 12 } },
    { 'namespace': 'ccwrkspace'       , 'active_ind': 0, 'name':'chla.ccwrkspace'        , 'cclProgram': 'NONE'                                , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'NONE' ]                                                                                ,'mainSectionStyle':''                                   , 'customCfg':{'Implemented':true,  "InitCCL": false}}                ,
    { 'namespace': 'spacer1a'         , 'active_ind': 0, 'name':'chla.spacer1a   '        , 'cclProgram': 'NONE'                                , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'NONE' ]                                                                                ,'mainSectionStyle':''                                   , 'customCfg':{'Implemented':true,  "InitCCL": false}}                ,
    { 'namespace': 'spacer2a'         , 'active_ind': 0, 'name':'chla.spacer2a   '        , 'cclProgram': 'NONE'                                , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'NONE' ]                                                                                ,'mainSectionStyle':''                                   , 'customCfg':{'Implemented':true,  "InitCCL": false}}                ,
    { 'namespace': 'spacer3a'         , 'active_ind': 0, 'name':'chla.spacer3a   '        , 'cclProgram': 'NONE'                                , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'NONE' ]                                                                                ,'mainSectionStyle':''                                   , 'customCfg':{'Implemented':true,  "InitCCL": false}}                ,
    { 'namespace': 'vitals'           , 'active_ind': 0, 'name':'chla.vitals   '        , 'cclProgram': 'NONE'                                , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'NONE' ]                                                                                ,'mainSectionStyle':''                                   , 'customCfg':{'Implemented':true,  "InitCCL": false}}                ,
    { 'namespace': 'ioschart'         , 'active_ind': 0, 'name':'chla.ioschart   '        , 'cclProgram': 'NONE'                                , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'NONE' ]                                                                                ,'mainSectionStyle':''                                   , 'customCfg':{'Implemented':true,  "InitCCL": false}}                ,
    { 'namespace': 'spacer1'          , 'active_ind': 0, 'name':'chla.spacer1   '        , 'cclProgram': 'NONE'                                , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'NONE' ]                                                                                ,'mainSectionStyle':''                                   , 'customCfg':{'Implemented':true,  "InitCCL": false}}                ,
    { 'namespace': 'spacer2'          , 'active_ind': 0, 'name':'chla.spacer2   '        , 'cclProgram': 'NONE'                                , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'NONE' ]                                                                                ,'mainSectionStyle':''                                   , 'customCfg':{'Implemented':true,  "InitCCL": false}}                ,
    { 'namespace': 'spacer3'          , 'active_ind': 0, 'name':'chla.spacer3   '        , 'cclProgram': 'NONE'                                , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'NONE' ]                                                                                ,'mainSectionStyle':''                                   , 'customCfg':{'Implemented':true,  "InitCCL": false}},
    { 'namespace': 'PreOPAnLineTubeDrain', 'active_ind': 1, 'name': 'chla.PreOPAnLineTubeDrain'     , 'cclProgram': 'CHLA_CA_CC_ANES_TUBE_DRAI_JSON', 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ "MINE"    , "personId"       , "encounterId" , "userId" ]  ,'mainSectionStyle':'', 'customCfg':{'Implemented':true, "InitCCL": false}}                ,
    { 'namespace': 'PreOPAnVitals'       , 'active_ind': 1, 'name': 'chla.PreOPAnVitals'            , 'cclProgram': 'CHLA_CA_CC_ANES_VITALS_JSON'   , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ "MINE"    , "personId"       , "encounterId" , "userId" ]                                ,'mainSectionStyle':'max-height:400px;overflow-y:auto;overflow-x:hidden;', 'customCfg':{'Implemented':true, "InitCCL": false}}                ,
    { 'namespace': 'PreOPAnSurReady'     , 'active_ind': 1, 'name': 'chla.PreOPAnSurReady'          , 'cclProgram': 'CHLA_CA_CC_ANES_PRE_CHK_JSON'  , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ "MINE"    , "personId"       , "encounterId" , "userId" ]                                ,'mainSectionStyle':'', 'customCfg':{'Implemented':true, "InitCCL": false}}                ,
    { 'namespace': 'PreOPAnAssess'       , 'active_ind': 1, 'name': 'chla.PreOPAnAssess'            , 'cclProgram': 'CHLA_CA_CC_ANES_PR_ASSESS_JSON', 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ "MINE"    , "personId"       , "encounterId" , "userId" ]                                ,'mainSectionStyle':'', 'customCfg':{'Implemented':true, "InitCCL": false}}                ,
    { 'namespace': 'PreOPAnProcs'        , 'active_ind': 1, 'name': 'chla.PreOPAnProcs'             , 'cclProgram': ''                              , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ 'NONE' ]                                                                                 ,'mainSectionStyle':'', 'customCfg':{'Implemented':true, "InitCCL": false}}                ,
    { 'namespace': 'AnesthResults'       , 'active_ind': 1, 'name': 'chla.AnesthResults'            , 'cclProgram': 'CHLA_CA_CC_ANES_RESULTS_JSON'  , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ "MINE"    , "personId"       , "encounterId" , "userId", "Blood Gas Results"]            ,'mainSectionStyle':'max-height:400px;overflow-y:auto;', 'customCfg':{'Implemented':true, "DummyData": false}}                ,
    { 'namespace': 'procinfo'            , 'active_ind': 1, 'name': 'chla.procinfo'                 , 'cclProgram': 'CHLA_CA_CC_ANES_PROC_INFO_JSON', 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ "MINE"    , "personId"       , "encounterId" , "userId", "3" ]                           ,'mainSectionStyle':'', 'customCfg':{'Implemented':true, "InitCCL": false}}                ,
    { 'namespace': 'PostOpProcinfo'      , 'active_ind': 1, 'name': 'chla.postopprocinfo'           , 'cclProgram': 'CHLA_CA_CC_ANES_PROC_INFO_JSON', 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ "MINE"    , "personId"       , "encounterId" , "userId", "3" ]                           ,'mainSectionStyle':'', 'customCfg':{'Implemented':true, "InitCCL": false}}                ,
    { 'namespace': 'keyinfo'             , 'active_ind': 1, 'name': 'chla.keyinfo'                  , 'cclProgram': 'CHLA_CA_CC_ANES_KEY_INFO_JSON' , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ "MINE"    , "personId"       , "encounterId" , "userId" ]                                ,'mainSectionStyle':'max-height:350px;max-width:100%;overflow-y:auto;', 'customCfg':{'Implemented':true, "InitCCL": false}}                ,
    { 'namespace': 'PreOPAnAssessPO'     , 'active_ind': 1, 'name': 'chla.PreOPAnAssessPO'          , 'cclProgram': 'CHLA_CA_CC_ANES_PR_ASSESS_JSON', 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ "MINE"    , "personId"       , "encounterId" , "userId" ]                                                                                 ,'mainSectionStyle':'', 'customCfg':{'Implemented':true, "InitCCL": false}}                ,
    { 'namespace': 'PostOpAnesth'        , 'active_ind': 1, 'name': 'chla.PostOpAnesth'             , 'cclProgram': 'CHLA_CA_CC_ANES_POSTOP_JSON'   , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ "MINE"    , "personId"       , "encounterId" , "userId" ]                                ,'mainSectionStyle':'', 'customCfg':{'Implemented':true, "InitCCL": false}}                ,
    { 'namespace': 'IntraOpNurse'        , 'active_ind': 1, 'name': 'chla.IntraOpNurse'             , 'cclProgram': 'CHLA_CA_CC_ANES_INTRAOP_JSON'  , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ "MINE"    , "personId"       , "encounterId" , "userId" ]                                  ,'mainSectionStyle':'', 'customCfg':{'Implemented':true, "InitCCL": false}}                ,
    { 'namespace': 'AnesthMeds'          , 'active_ind': 1, 'name': 'chla.AnesthMeds'               , 'cclProgram': 'CHLA_CA_CC_ANES_MED_JSON'      , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ "MINE"    , "personId"       , "encounterId" , "userId", "FALSE" ]                       ,'mainSectionStyle':'', 'customCfg':{'Implemented':true, "InitCCL": false}}                ,
    { 'namespace': 'AnesthIO'            , 'active_ind': 1, 'name': 'chla.AnesthIO'                 , 'cclProgram': 'CHLA_CA_CC_ANES_IO_SUM_JSON'   , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ "MINE"    , "personId"       , "encounterId" , "userId" ]                               ,'mainSectionStyle':'', 'customCfg':{'Implemented':true, "InitCCL": false}}                ,
    { 'namespace': 'AnesthQA'            , 'active_ind': 1, 'name': 'chla.AnesthQA'                 , 'cclProgram': 'CHLA_CA_CC_ANES_QA_JSON'       , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ "MINE"    , "personId"       , "encounterId" , "userId" ]                               ,'mainSectionStyle':'', 'customCfg':{'Implemented':true, "InitCCL": false}}                ,
    { 'namespace': 'POIntubationHist'    , 'active_ind': 1, 'name': 'chla.POIntubationHist'         , 'cclProgram': 'CHLA_CA_CC_ANES_INT_HIST_JSON' , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ "MINE"    , "personId"       , "encounterId" ]                                            ,'mainSectionStyle':'height:240px;overflow-y:auto;', 'customCfg':{'Implemented':true, "InitCCL": false}}                ,
    { 'namespace': 'POAnesthHist'       , 'active_ind': 1, 'name': 'chla.POAnesthHist'              , 'cclProgram': 'CHLA_CA_CC_ANES_MPAGE_JSON'    , 'cclParams': [], 'cclDataType': 'JSON' , 'cclParamsArr': [ "MINE"    , "personId"       , "encounterId" , "userId" ]                                ,'mainSectionStyle':'height:400px;overflow-y:auto;', 'customCfg':{'Implemented':true, "InitCCL": false}}
    ];
/**
 * Legacy function needed to support existing code.
 */
//MPageUtils: null,
/**
 *
 *  MPage HNAM Win32 Utility Functions API:
 *  1  POWERFORM
 *  2  DYNDOC
 *  3  POWERNOTE
 *  4  PREGNANCY
 *  5  PVCONTXTMPAGE
 *  6  PVPATIENTFOCUS
 *  7  POWERORDERS
 *  8  KIACROSSMAPPING
 *  9  PVVIEWERMPAGE
 *  10 PVFRAMEWORKLINK
 *  11 DISCHARGEPROCESS
 *  12 PATIENTEDUCATION
 *  13 ORDERS
 *  14 PVPATIENTSEARCHMPAGE
 *  15 PMLISTMAINTENANCE
 *  16 TASKDOC
 *  17 CINFOBUTTONLINK
 *
 *  Parameters are passed by argument object
 */
chla.eApps.gFuncs.MPageHnamAPI = function(){
    var objType = '',
        retVal = null ,
        DiscernObjectFactory = chla.eApps.gFuncs.DiscernObjectFactory,
        err,
        argList = [],
        wrkArr=[],
        fncList = {
            'POWERFORM': function () {
                var P,
                    dPersonId   = (ChlaStdClass.isEmpty(argList[1])? '': argList[1]),
                    dEncounterId= (ChlaStdClass.isEmpty(argList[2])? '': argList[2]),
                    formId      = (ChlaStdClass.isEmpty(argList[3])? '': argList[3]),
                    activityId  = (ChlaStdClass.isEmpty(argList[4])? '': argList[4]),
                    chartMode   = (ChlaStdClass.isEmpty(argList[5])? '': argList[5]),
                    arrWrk = [];
                arrWrk.length = 0;
                arrWrk.push(argList[0]);
                arrWrk.push(': ');
                arrWrk.push(dPersonId);
                arrWrk.push(dEncounterId);
                arrWrk.push(formId);
                arrWrk.push(activityId);
                arrWrk.push(chartMode);
                chla.eAppsUtil.Logger.LogWarn(arrWrk.join(' '));
                P = DiscernObjectFactory(objType);
                P.OpenForm(dPersonId, dEncounterId, formId, activityId, chartMode);
            },
            'POWERNOTE': function () {
                var P,
                    dPersonId   = (ChlaStdClass.isEmpty(argList[1])? '': argList[1]),
                    dEncounterId= (ChlaStdClass.isEmpty(argList[2])? '': argList[2]),
                    dEventId    = (ChlaStdClass.isEmpty(argList[3])? '': argList[3]);
                wrkArr.length = 0;
                wrkArr.push(argList[0]);
                wrkArr.push(': ');
                wrkArr.push(objType);
                wrkArr.push(dPersonId );
                wrkArr.push(dEncounterId);
                wrkArr.push(dEventId);
                chla.eAppsUtil.Logger.LogWarn(wrkArr.join(''));
                try {
                    P = DiscernObjectFactory(objType);
                    P.ModifyExistingNoteByEventId(dPersonId, dEncounterId, dEventId);
                } catch (e) {
                    err = e.message;
                    wrkArr.length = 0;
                    wrkArr.push('eApps ERROR HNAM WIN32 function:');
                    wrkArr.push(objType);
                    wrkArr.push('error:');
                    wrkArr.push(err);
                    chla.eAppsUtil.Logger.LogError(wrkArr.join(' '));
                }
            }
        };
      if(arguments.length > 0) {
          chla.eAppsUtil.Logger.LogInfo('MPageHnamAPI' );
          argList =  Array.prototype.slice.call(arguments);
          objType = argList[0].toUpperCase();
          chla.eAppsUtil.Logger.LogWarn('MPageHnamAPI: ' + objType + "  " + argList.join(''));
          if (fncList.hasOwnProperty(objType)) {
              chla.eAppsUtil.Logger.LogWarn('MPageHnamAPI: ' + argList.join(''));
              //alert("DiscernObjectFactory");
               retVal = fncList[objType]();
               return retVal;
          } else {
              chla.eAppsUtil.Logger.LogError("eApps unsupported HNAM WIN32 function: " + objType);
          }
      } else {
          chla.eAppsUtil.Logger.LogError("eApps unsupported HNAM WIN32 function: None Requested");
      }
//     if(arguments.length > 0) {
//         argList = Array.from( arguments);
//         objType = argList[0].toUpperCase();
//         if (fncList.hasOwnProperty(objType)) {
//             chla.eAppsUtil.Logger.LogWarn('MPageHnamAPI: ' + argList.join(''));
//             alert("DiscernObjectFactory");
//             return false;
// //                 retVal = fncList[objType]();
// //                 return retVal;
//         } else {
//             chla.eAppsUtil.Logger.LogError("eApps unsupported HNAM WIN32 function: " + objType);
//         }
//     } else {
//         chla.eAppsUtil.Logger.LogError("eApps unsupported HNAM WIN32 function: None Requested");
//     }
};
chla.eApps.gFuncs.DiscernObjectFactory = function(objType)  {
    var P = null,
        validDiscernObjectFactory = false;
    if ( typeof window.external != 'undefined') {
        if( typeof window.external.DiscernObjectFactory != 'undefined') {
            P = window.external.DiscernObjectFactory(objType);
            validDiscernObjectFactory = true;
        }

    }
    if (validDiscernObjectFactory === false) {
        if (P == null && typeof chlaMpageApi != 'undefined') {
            if (objType == 'POWERNOTE') {
                P = chlaMpageApi.mPageInterceptorPOWERNOTE;
                P.ModifyExistingNoteByEventId = chlaMpageApi.mPageInterceptorPOWERNOTE;
            }
            if (objType == 'POWERFORM') {
                P = chlaMpageApi.mPageInterceptorPOWERFORM;
                P.OpenForm = chlaMpageApi.mPageInterceptorPOWERFORM;
            }
        } else{
            chla.eAppsUtil.Logger.LogError("eApps unsupported HNAM WIN32 function object requested: " + objType);
        }
    }
    return P;
};
chla.eApps.gFuncs.getDomPath = function (el) {
    var stack = [];
    while ( el.parentNode != null ) {
        console.log(el.nodeName);
        var sibCount = 0;
        var sibIndex = 0;
        for ( var i = 0; i < el.parentNode.childNodes.length; i++ ) {
            var sib = el.parentNode.childNodes[i];
            if ( sib.nodeName == el.nodeName ) {
                if ( sib === el ) {
                    sibIndex = sibCount;
                }
                sibCount++;
            }
        }
        if ( el.hasAttribute('id') && el.id != '' ) {
            stack.unshift(el.nodeName.toLowerCase() + '#' + el.id);
        } else if ( sibCount > 1 ) {
            stack.unshift(el.nodeName.toLowerCase() + ':eq(' + sibIndex + ')');
        } else {
            stack.unshift(el.nodeName.toLowerCase());
        }
        el = el.parentNode;
    }

    return stack.slice(1); // removes the html element
};
chla.eApps.gFuncs.getResolutionProfile = function(){
    var tempSize,
        SizeProfile;
    tempSize = $(window).width();
    SizeProfile = 'RLESS1279';
    if (tempSize > 1700){
        SizeProfile = 'R1920';
    } else if (tempSize > 1420){
        SizeProfile = 'R1440';
    } else if (tempSize > 1280){
        SizeProfile = 'R1280';
    } else {
        SizeProfile = 'RLESS1279';
    }
    return SizeProfile;
};



chlaNs('chla.eApps.gCcModuleCls', ChlaStdClass.extend() );
chla.eApps.gCcModuleCls.implement(
    {
        CC_Tmpls: {
            mainDiv: [
                '<div id="<#=cc_id#>" class="eapps_CC" style="',
                '<#=mainSectionStyle#>',
                '">',
                '<#=mainSection#>',
                '</div>'
            ],
            /**
             * general purpose panel tmpl used for CC container
             * @type {string[]}
             */
            eApps_panel_Tmpl:[
                '<div id="',
                '<#=idLabel#>_Div_eApps_panel" class="',
                '<#=HdrCss#>">',
                '<h2 class="fo-sub-sec-hd ',
                '<#=fo_cat_type#> hxa-marker ',
                '<#=OvrrdHdrCss#>" ',
                '<#=OvrrdHdrStyle#> ',
                '<#=hovertip#>>',
                '<span class="sub-sec-hd-tgl hxb-marker ',
                '<#=SectionClosed#>"  style="',
                '<#=CustIcon#> ',
                '<#=CustMargin#>"">-</span>',
                '<#=HdrLayout#>',
                '</h2>',
                '</div>',
                '<div id="',
                '<#=idLabel#>_DivSubSecContent" class="sub-sec-content ',
                '<#=SectionClosed#>" ',
                '<#=SubSecContentStyle#>>',
                '<div id="',
                '<#=idLabel#>" class="content-body  ',
                '<#=OvrrdContentBodyCss#>">',
                '<#=defaultHeightHdr#>',
                '<#=ContentBody#>',
                '<#=defaultHeightFtr#>',
                '</div>',
                '</div>'
            ]
        },
        gSection_config: function (aSectionCfg,aCcSectMgtObj){
            var htmlSecCtlData = chlaNsMgr.aliasDirector('chla.eApps.Html.SectionData'),
                resultSecLstArr= [];
            aSectionCfg.forEach(
                /**
                 *
                 *  cfg. object example:
                 *  {
                 *   CC_id:  'unique CC identifier"
                 *   T_type: 'H5',
                 *   SecId:  'Type0',
                 *   TLblId: 'Example Type0 H5 auto Disable closed label zero count',
                 *   SecClsd:'auto',
                 *   SecLvl: 'H5
                 *   }
                 * @param cfgItem
                 */
                function (cfgItem) {
                    var wrkValue;
                    wrkValue = cfgItem.SecLvl + '_Sec_' + cfgItem.SecId ;  // 'H5_Sec_Type0'
                    aCcSectMgtObj[wrkValue] = htmlSecCtlData.neo(
                        cfgItem.T_type ,
                        cfgItem.SecId ,
                        cfgItem.TLblId ,
                        cfgItem.SecClsd ,
                        cfgItem.SecLvl
                    ) ;
                    resultSecLstArr.push(wrkValue);
                });
            aCcSectMgtObj.sectionlist = resultSecLstArr;
        },
        gSecData_config: function (aSectionCfg){
            var htmlSecCtlData = chlaNsMgr.aliasDirector('chla.eApps.Html.SectionData'),
                resultSecContainer= {
                    sectionlist: []
                };
            aSectionCfg.forEach(
                /**
                 *
                 *  cfg. object example:
                 *  {
                 *   CC_id:  'unique CC identifier"
                 *   T_type: 'H5',
                 *   SecId:  'Type0',
                 *   TLblId: 'Example Type0 H5 auto Disable closed label zero count',
                 *   SecClsd:'auto',
                 *   SecLvl: 'H5
                 *   }
                 * @param cfgItem
                 */
                function (cfgItem) {
                    var wrkValue;
                    wrkValue = cfgItem.SecLvl + '_Sec_' + cfgItem.SecId ;  // 'H5_Sec_Type0'
                    resultSecContainer[wrkValue] = htmlSecCtlData.neo(
                        cfgItem.T_type ,
                        cfgItem.SecId ,
                        cfgItem.TLblId ,
                        cfgItem.SecClsd ,
                        cfgItem.SecLvl
                    ) ;
                    resultSecContainer.sectionlist.push(wrkValue);
                });
            return resultSecContainer;
        },
        /**
         *
         *  cfgObj = {
         *      namespace:      '', // "ptinfo";
         *      name:           '', // "chla.ptinfo";
         *      cclProgram:     '', // "CHLA_CA_MP_MD_PT_INFO_JSON" or '' for default init function
         *      cclParams:      '', // []
         *      cclDataType:    '', // "JSON"
         *      cclParamsArr:   []  // "MINE","encounterId","personId","userId"
         *  }
         * @param cfgObj
         */
        createCcObject: function (cfgObj) {
            var objCc,
                boolCustCfgPresent,
                boolCustCfgUseDummyData,
                boolCustCfgInitCCL,
                arrWrk,
                arrWrkList;
            chla[cfgObj.namespace]      = function () { };
            objCc                       = chla[cfgObj.namespace];
            objCc.prototype             = new MPage.Component();
            objCc.prototype.constructor = MPage.Component;
            objCc.prototype.base        = MPage.Component.prototype;
            objCc.prototype.name        = cfgObj.name;
            objCc.prototype.CCcfg = {'Implemented': 'false'};
            objCc.prototype.CCcfg.mainSectionStyle = ChlaStdClass.safeRead({'obj':cfgObj,'defaultvalue': false},'mainSectionStyle');
            if ( cfgObj.cclParamsArr[0].toUpperCase() !== 'NONE' && cfgObj.cclParamsArr[0] !== ''){
                objCc.prototype.cclParamsArr= cfgObj.cclParamsArr.slice();
            }else {
                objCc.prototype.cclParamsArr = [];
            }

            if (cfgObj.cclProgram !== '' && cfgObj.cclProgram.toUpperCase() !== 'NONE' ) {
                objCc.prototype.cclProgram  = cfgObj.cclProgram;
                objCc.prototype.cclParams   = [];
                objCc.prototype.cclDataType = cfgObj.cclDataType;
                objCc.prototype.init        = function (options) {
                    var tempArr     = this.cclParams,
                        tempArrList = this.cclParamsArr,
                        component = this;
                    tempArr.length  = 0;
                    tempArrList.forEach(
                        function (item) {
                            if(typeof item !== 'string'){
                                tempArr.push(item);
                            } else {
                                tempArr.push((item.indexOf('Id') > -1 ? component.getProperty(item) : item));
                            }
                        }
                    );
                    if ( typeof options !== 'undefined'){
                        tempArr = Object.keys(options);
                        tempArr.forEach(
                            function (item) {
                               if( options.hasOwnProperty(item)){
                                   component.setProperty(item,options[item]);
                               }
                            }
                        )
                    }
                };

            }
        },
        CcInit: function (aBaseObj,aComponent,aSectionCfg) {
            var subHeaderDisplay,
                htmlSecCtlData,
                initSecData,
                appNS,
                vGlbls,
                vProp;
            aBaseObj.Prop.elementObj    = aComponent.data.RPTDATA;
            aBaseObj.Prop.target        = aComponent.getTarget();
            aComponent.eApps = {
                cc_id:                  aComponent.name.replace('.', '_'),
                CSSBehaviors:           aBaseObj.gCSSBehaviorCls.neo(),
                SaveButtonAction:       aBaseObj.gButtonBehaviorSaveCls.neo(),
                TestSAP:                null,
                baseObj:                aBaseObj
            };
            aBaseObj.Prop.cc_id         = aComponent.eApps.cc_id;
            aBaseObj.thisComp           = aComponent;
            aBaseObj.thisCompEapps      = aComponent.eApps;
            appNS                       = aBaseObj.getCcNS();
            vGlbls                      = appNS.Globals;
            vProp                       = appNS.Prop;
            appNS.setInitOnly( (ChlaStdClass.safeRead(chla, 'eApps','operationMode') === 'test' ||
            ChlaStdClass.safeRead(chla, 'eApps', '_ccnsp_', 'operationMode') === '_ccnsp_Test'));
            appNS.setCc_id(aComponent.eApps.cc_id);
            vProp.personId              = aComponent.getProperty('personId');
            vProp.encounterId           = aComponent.getProperty('encounterId');
            vProp.prsnlId               = aComponent.getProperty('userId');
            aComponent.eApps.TestSAP    = appNS.TestServiceAccessPoint;
            if (typeof  aSectionCfg !== 'undefined') {
                vGlbls.htmlSecCtl       = aBaseObj.gSectionHeaderCtlCls;
                htmlSecCtlData          = aBaseObj.gSectionDataCls;
                vGlbls.htmlSecCtlObj    = vGlbls.htmlSecCtl.neo();
                initSecData             = htmlSecCtlData.neo();
                appNS.Dta.CC_SectionManagement.sectionlist = initSecData.Section_config(aSectionCfg, appNS.Dta.CC_SectionManagement);
            }
            vGlbls.CC_CssBehavior   = aComponent.eApps.CSSBehaviors;
            vGlbls.gFuncs           = aBaseObj.gFuncs;
            subHeaderDisplay        =
                'Value to loaded to component label such as a total of entries in the CC';
            //  i.e. subHeaderDisplay = "(" + micros.totalMicros + ")";
            aBaseObj.subHeaderDisplay(aComponent,subHeaderDisplay,arguments);
        },
        CcModInit: function (aComponent,aObjAppCfg) {
            var objAppNS =  chla.eAppsClass.neo();                 //creates an instance of the chla.eAppsClass
            ChlaStdClass.applyProperties(objAppNS,aObjAppCfg);     // subclasses the instance with specific application configuration.
            objAppNS.cfgInit(aComponent, objAppNS);                // function reference passed in via aObjAppCfg
            return objAppNS;
        },
        getCc_id: function (aCcBaseObj) {
                return aCcBaseObj.eApps.cc_id;
        },
        setCc_id: function (aCcBaseObj, cc_id) {
            aCcBaseObj.eApps.cc_id = cc_id;
        },
        getUiDto: function (aCcBaseObj) {
            return aCcBaseObj.eApps.UiDto;
        },
        setUiDto: function (aCcBaseObj, UiDto) {
            aCcBaseObj.eApps.UiDto = UiDto;
        },
         getRptdataStatus: function (aCcBaseObj) {
            aCcBaseObj.eApps.RPTDATA_STATUS = "DATA FOUND";
            if (typeof aCcBaseObj.data === 'undefined' ){
               aCcBaseObj.eApps.RPTDATA_STATUS ="NO DATA FOUND";
            }
              return aObjCcBase.eApps.RPTDATA_STATUS
        },
         getCclJsonDto: function (aCcBaseObj) {
            var DtoData,
                boolUseDummyData = ChlaStdClass.safeRead({'obj':aCcBaseObj,'defaultvalue': false,'skipOwnProperties':true},'CCcfg','DummyData'),
                strDummyData;
            if(boolUseDummyData){
                strDummyData = ChlaStdClass.safeRead({'obj':aCcBaseObj,'defaultvalue': 'EmptyMsgDefault',skipOwnProperties:true},'CCcfg','cclProgram');
                DtoData = chla.eAppsCCFrmWrk[strDummyData.toUpperCase()].RPTDATA;
            }else {
                DtoData = aCcBaseObj.data.RPTDATA;
            }
            return DtoData;
        },
        setCclJsonDto: function (aCcBaseObj, dataDto) {
            aCcBaseObj.eApps.dataDto = dataDto;
        },
        getJsonDataDto: function (aCcBaseObj) {
            var objRet;
            aCcBaseObj.eApps.RPTDATA_STATUS = "DATA FOUND";
            if (typeof aCcBaseObj.data === 'undefined' ){
               aCcBaseObj.eApps.RPTDATA_STATUS ="NO DATA FOUND";
               objRet = {"RPTDATA_STATUS":"NO DATA FOUND"};
            }else if (typeof aCcBaseObj.data.RPTDATA !== 'undefined') {
                objRet = aCcBaseObj.data.RPTDATA;
            } else {
                objRet = aCcBaseObj.data;
            }
            return objRet;
        },
        getDataDto: function (aCcBaseObj) {
            return aCcBaseObj.eApps.dataDto;
        },
        setDataDto: function (aCcBaseObj, dataDto) {
            aCcBaseObj.eApps.dataDto = dataDto;
        },
        setSectionObjID: function (aCcBaseObj,sectLbl,sectId) {
            aCcBaseObj.eApps.CC_SectionManagement[sectLbl] = sectId;
        },
        getSectionObjID: function (aCcBaseObj,sectLbl,sectId) {
            return aCcBaseObj.eApps.CC_SectionManagement[sectLbl];

        },
        addSectionList: function (aCcBaseObj,sectLbl) {
            aCcBaseObj.eApps.CC_SectionManagement.sectionlist.push(sectLbl);
        },
        getSectionList: function (aCcBaseObj) {
            return aCcBaseObj.eApps.CC_SectionManagement.sectionlist;
        },
        setHandler: function (aCcBaseObj,strEvntLbl,objEvntHndlr){
            'use strict';
            aCcBaseObj.eApps.EvtHdlr[strEvntLbl] = objEvntHndlr;
        },
        getHandler: function (aCcBaseObj,strEvntLbl){
            return aCcBaseObj.eApps.EvtHdlr[strEvntLbl];
        },
        CommonCcInit: function (aNsBaseObj,aCcBaseObj) {
            var CC_name = aCcBaseObj.name.replace('chla.',''),
                CC_test;
            CC_test = CC_name +  '_TESTMODE';
            aCcBaseObj.eApps = {
                initOnly            : false,
                cc_id               : aCcBaseObj.name.replace('.', '_'),
                CSSBehaviors        : aNsBaseObj.gCSSBehaviorCls.neo(),
                SaveButtonAction    : null,
                TestSAP             : null,
                CC_SectionManagement: {
                    sectionlist: []
                },
                elementObj          : ChlaStdClass.safeRead(aCcBaseObj,'data','RPTDATA'),
                target              : aCcBaseObj.getTarget(),
                encounterId         : aCcBaseObj.getProperty('encounterId'),
                personId            : aCcBaseObj.getProperty('personId'),
                userId              : aCcBaseObj.getProperty('userId'),
                appNS               : aNsBaseObj,
                dataDto             : '',
                UiDto               : '',
                getCc_id            : chla.eAppsClass.gCcModule.getCc_id,
                setCc_id            : chla.eAppsClass.gCcModule.setCc_id,
                getDataDto          : chla.eAppsClass.gCcModule.getDataDto,
                setDataDto          : chla.eAppsClass.gCcModule.setDataDto,
                getUiDto            : chla.eAppsClass.gCcModule.getUiDto,
                setUiDto            : chla.eAppsClass.gCcModule.setUiDto,
                getCclJsonDto       : chla.eAppsClass.gCcModule.getCclJsonDto,
                setCclJsonDto       : chla.eAppsClass.gCcModule.setCclJsonDto,
                getJsonDataDto      : chla.eAppsClass.gCcModule.getJsonDataDto,
                getSectionObjID     : chla.eAppsClass.gCcModule.getSectionObjID,
                setSectionObjID     : chla.eAppsClass.gCcModule.setSectionObjID,
                addSectionList      : chla.eAppsClass.gCcModule.addSectionList,
                getSectionList      : chla.eAppsClass.gCcModule.getSectionList,
                EvtHdlr             : {},
                setHandler          : chla.eAppsClass.gCcModule.setHandler,
                getHandler          : chla.eAppsClass.gCcModule.getHandler
            };
            aCcBaseObj.eApps.initOnly = ChlaStdClass.safeRead({
                    obj: chla.eApps.operationMode,
                    defaultvalue: 'NORMAL'
                },'gblMode').toUpperCase() === 'TEST' ||
                ChlaStdClass.safeRead({
                    obj: chla.eApps.operationMode,
                    defaultvalue: 'NORMAL'
                }, CC_name, 'operationMode') === CC_test;
            if(aCcBaseObj.eApps.initOnly === '') {
                aCcBaseObj.eApps.initOnly = false;
            }
        },
        renderCcInstance: function (aStrCc_ID,aCompContent,aTarget) {
            chla.eApps.gFuncs.Log_CC( aStrCc_ID, aCompContent);
            aTarget.innerHTML = aCompContent;
        },
        createCcModuleCls: ChlaStdClass.extend( function() {
            this.ccnsp = {
                mainSection: '',
                component: {},
                processData: function (aObjAppNS, aObjCcBase) {},
                processUI: function (aObjAppNS, aObjCcBase) {},
                processCcInstance: function (aObjAppNS, aObjCcBase) {
                    var strCompContent,
                        UI_mainSectionStyle = ChlaStdClass.safeRead({'obj':aObjCcBase,'defaultvalue': ''},'CCcfg','mainSectionStyle');//aObjCcBase.CCcfg.mainSectionStyle,
                        Ui_Dto = (typeof aObjCcBase.eApps.mainSection !== 'undefined'? aObjCcBase.eApps.mainSection: aObjCcBase.eApps.getUiDto(aObjCcBase) ),
                        objCcModule = chla.eAppsClass.gCcModule;
                    strCompContent = aObjAppNS.gFuncs.parseTemplate(objCcModule.CC_Tmpls.mainDiv.join(''), {
                        cc_id      : aObjCcBase.eApps.getCc_id(aObjCcBase),
                        mainSection: Ui_Dto,
                        mainSectionStyle: UI_mainSectionStyle
                    });
                    objCcModule.renderCcInstance(
                        aObjCcBase.eApps.getCc_id(aObjCcBase),
                        strCompContent,
                        aObjCcBase.getTarget());
                },
                processPostCcInstance: function (aObjAppNS, aObjCcBase) {},
                genInit: function (aObjThisCCInit,aObjAppNS,aObjCcBase) {
                    var  arrWrk = [],
                         objCcModule = chla.eAppsClass.gCcModule;
                    objCcModule.CommonCcInit(aObjAppNS, aObjCcBase);
                    if (aObjCcBase.eApps.initOnly === true){
                        aObjCcBase.eApps.TestSap = aObjThisCCInit.TestServiceAccessPoint;
                    }
                    arrWrk.push('<img src="');
                    arrWrk.push(aObjAppNS.gVars.transparentSpacer);
                    arrWrk.push('" height="5px" width="17px"  >');
                    aObjCcBase.eApps.transparentSpacer = arrWrk.join('');
                },
                postInit:function (aObjAppNS, aObjCcBase) {},
                TestServiceAccessPoint: function (aObjThisCCInit) {
                    return {
                        TestProcessInit:            aObjThisCCInit.genInit,
                        TestProcessPostInit:        aObjThisCCInit.postInit,
                        TestProcessRPTDATA_main:    aObjThisCCInit.processData,
                        TestProcessHTML_main:       aObjThisCCInit.processUI,
                        TestProcessCcInstance:      aObjThisCCInit.processCcInstance,
                        TestProcessPostCcInstance:  aObjThisCCInit.postProcessCcInstance,
                        TestProcessCtl:             aObjThisCCInit.ProcessCtl
                    };
                },
                ProcessCtl: function (aObjThisCCInit,aObjCcBase) {
                    var objAppNS = chla.eAppsClass.neo();
                    aObjThisCCInit.genInit( aObjThisCCInit,objAppNS,aObjCcBase);
                    if (aObjCcBase.eApps.initOnly === false) {
                        aObjThisCCInit.postInit(objAppNS, aObjCcBase);
                        aObjCcBase.eApps.setDataDto(aObjCcBase,aObjThisCCInit.processData(objAppNS, aObjCcBase));
                        aObjCcBase.eApps.setUiDto(aObjCcBase,aObjThisCCInit.processUI(objAppNS, aObjCcBase));
                        aObjThisCCInit.processCcInstance(objAppNS, aObjCcBase);
                        aObjThisCCInit.processPostCcInstance(objAppNS, aObjCcBase);
                    }
                }
            };
        })
    }
);
//::========================================================
chla.eApps.gFuncs.MPageUtils =  chla.eApps.gFuncs.MPageHnamAPI;

//::========================================================
/**
 * chla.eAppsClass base class - chla.eApps
 */
chlaNs('chla.eAppsClass',        ChlaStdClass.extend(function (){}));
chla.eAppsClass.implement(chla.eApps);
chla.eAppsClass.implement({ 'gCCLRequestCls':           chla.eApps.gCCLRequest });
chla.eAppsClass.implement({ 'MPageUtils':               chla.eApps.gFuncs.MPageHnamAPI });
chla.eAppsClass.implement({ 'gTmplts':                  chla.eApps.gTmplts});
chla.eAppsClass.implement({ 'gSectionDataCls':          chla.eApps.gSectionData  });
chla.eAppsClass.implement({ 'gSectionHeaderCtlCls':     chla.eApps.gSectionHeaderCtl });
chla.eAppsClass.implement({ 'gBtnBehaviorCls':          chla.eApps.gBtnBehavior });
chla.eAppsClass.implement({ 'gCSSBehaviorCls':          chla.eApps.gCSSBehavior });
chla.eAppsClass.implement({ 'gButtonBehaviorSaveCls':   chla.eApps.gButtonBehaviorSave });
chla.eAppsClass.implement({ 'isEmpty':                  ChlaStdClass.isEmpty});
chla.eAppsClass.applyProperties(chla.eAppsClass,{ 'gCcModule': chla.eApps.gCcModuleCls.neo()});

(function () {
    chla.cc.forEach(
        function (item){
            'use strict';
            if (item.active_ind === 1) {
                chla.eAppsClass.gCcModule.createCcObject.call(item, item);
            }
        }
    )
})();
//::===========================================================================
//:: CC - AmblAppts Module
//::---------------------------------------------------------------------------
//::==========================================================================================================================
chla.AmblAppts = function () { };
chla.AmblAppts.prototype = new MPage.Component();
chla.AmblAppts.prototype.constructor = MPage.Component;
chla.AmblAppts.prototype.base = MPage.Component.prototype;
chla.AmblAppts.prototype.name = "chla.AmblAppts";
chla.AmblAppts.prototype.cclProgram = "chla_ca_mp_ambl_appt_json"; //_CCL_init_
chla.AmblAppts.prototype.cclParams = [];
chla.AmblAppts.prototype.cclDataType = "JSON";
//noinspection JSUnusedLocalSymbols
chla.AmblAppts.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("personId");
    this.cclParams[2] = this.getProperty("encounterId");
    this.cclParams[3] = this.getProperty("userId");
    this.cclParams[4] = '3,m';
};
chla.AmblAppts.prototype.render = function () {
    var component = this,
        elementObj,
        target,
        compContent;

    var CC_SectMgt = null,
        CC_CssBehavior = null,
        gFuncs = null,
        htmlSecCtl = null,
        htmlSecCtlObj = null,
        htmlSecCtlData = null,
        CclReqObjSave = null,
        AmblAppts = {
            initOnly: false,
            cc_id: 'x',
            personId: 0,
            encounterId: 0,
            prsnlId: 0,
            transparentSpacer: '',
            DTRange_sel: '3m',
            CC_SectionManagement: {
                H5_Sec_Completed:{},
                H5_Sec_Future:{},
				H5_Sec_Reschedule:{},
                H5_Sec_Cancel:{},
                H5_Sec_NoShow:{},
                H5_Sec_Confirmed_Completed:{}
            },
            mainDataPV: [],
            mainDataFV: [],
			mainDataRV: [],
            mainDataCV: [],
            mainDataNSV: [],
            mainDataCCV: [],
            mainSection: '',
            mainSectionEnd:'',
            H5_Section_Completed: '',
            H5_Section_Future: '',
			H5_Section_Reschedule: '',
            H5_Section_Cancel: '',
            H5_Section_NoShow: '',
            H5_Section_Confirmed_Completed: '',
            CC_Tmpls: {
                mainDiv: [
                    '<div id="<#=cc_id#>" class="eapps_CC">',
                    '<div style="float:right; display:table-row;">',
                    '<div id="18m" class="eappsCssBtn eappsCssBtn-DtRange" style="float:right; display:table-row;">Last 18 months</div>',
                    '<div id="12m"  class="eappsCssBtn eappsCssBtn-DtRange" style="float:right; display:table-row;">Last 12 months</div>',
                    '<div id="6m"  class="eappsCssBtn eappsCssBtn-DtRange" style="float:right; display:table-row;">Last  6 months</div>',
                    '<div id="3m"  class="eappsCssBtn eappsCssBtn-DtRange activeselect" style="float:right; display:table-row;">Last  3 months</div>',
                    '</div><div style="height: 22px;">&nbsp;</div>',
                    '<div id="<#=cc_id#>_body">',
                    '<#=mainSection#>',
                    '<#=H5_Section_Completed#>',
                    '<#=H5_Section_Future#>',
					'<#=H5_Section_Reschedule#>',
                    '<#=H5_Section_Cancel#>',
                    '<#=H5_Section_NoShow#>',
                    '<#=H5_Section_Confirmed_Completed#>',
                    '<#=mainSectionEnd#>',
                    '</div></div>'
                ],
                rowResultsbody: [ '<div style="clear:both;"<#=defaultHeight#> >',
                    '<table class="header"><tr><th class="col-1" style="min-width:100px;width: 20%;">Appt Type</th>',
                    '<th class="col-2"  style="min-width:105px;width: 20%;" >Date</th>',
                    '<th class="col-3" style="min-width:100px;width: 20%;" >Location</th>',
                    '<th class="col-4" style="min-width:40px;width: 20%;" >Resource</th>',
					'<th class="col-5" style="min-width:40px;width: 20%;" >&nbsp;</th></tr>',
                    '<#=SectBody#></table></div>'
                ],
				rowResultsbodyRV: [ '<div style="clear:both;"<#=defaultHeight#> >',
                    '<table class="header"><tr><th class="col-1" style="min-width:100px;width: 20%;">Appt Type</th>',
                    '<th class="col-2" style="min-width:105px; width: 20%;" >Date</th>',
                    '<th class="col-3" style="min-width:100px; width: 20%;" >Location</th>',
                    '<th class="col-4" style="min-width:40px;  width: 20%;" >Resource</th>',
					'<th class="col-5" style="min-width:100px; width: 20%;" >Reschedule Reason</th></tr>',
                    '<#=SectBody#></table></div>'
                ],
                rowResultsbodyFV: [
                    '<table class="header"><tr><th class="col-1" style="min-width:100px;width: 30%;" >Appt Type</th>',
                    '<th class="col-2" style="min-width:110px;width: 20%;" >Date</th>',
                    '<th class="col-3" style="min-width:100px;width: 25%;" >Location</th>',
                    '<th class="col-4" style="min-width:40px;width: 20%;" >Resource</th>',
                    '<th class="col-5" style="min-width:20px;width: 5%;">Status</th></tr></table>',
                    '<div <#=defaultHeight#> ><table class="header">',
                    '<#=SectBody#></table></div>'
                ],
                //rowResults: ['<tr><td><#=apptype#></td><td><#=apptime#></td><td><#=location#></td><td>&nbsp;</tr>'
                rowResults: ['<tr <#=oddEvenFlag2#>><td><#=apptype#></td><td><#=apptime#></td><td><#=location#></td><td><#=resource#></td><td>&nbsp;</td></tr>'
                ],
				rowResultsRV: ['<tr <#=oddEvenFlag#>><td><#=apptype#></td><td><#=apptime#></td><td><#=location#></td><td><#=resource#></td><td><#=reason#></td></tr>'
                ],
                rowResultsCN: ['<tr <#=oddEvenFlag2#>><td><#=apptype#></td><td><#=apptime#></td><td><#=location#></td><td><#=resource#></td><td>&nbsp;</td></tr>'
                ],
                rowResultsFV: [
                    //'<tr><td><#=apptype#></td><td><#=apptime#></td><td><#=location#></td><td><#=resource#></td><td><#=appstatus#></td></tr>'
                    '<tr><td class="col-1" style="min-width:100px;width: 30%;" ><#=apptype#></td>',
                    '<td class="col-2" style="min-width:110px;width: 20%;" ><#=apptime#></td>',
                    '<td class="col-3" style="min-width:100px;width: 25%;" ><#=location#></td>',
                    '<td class="col-4" style="min-width:40px;width: 20%;" ><#=resource#></td>',
                    '<td class="col-5" style="min-width:20px;width: 5%;"><#=appstatus#></td></tr>'
                ],
                Additional_Template1: []
            },
            processRPTDATA_main_data: function (dataObj, sectObj) {

                var i, listlen, locStr;
                AmblAppts.mainSection= '';
                AmblAppts.mainDataPV.length = 0;
                for(i=0,listlen = dataObj.PREVIOUS_VISIT_CNT; i < listlen; i++){
                    if (dataObj.PREVIOUS_VISITS[i].TYPE > ''){
                        AmblAppts.mainDataPV.push(
                            {
                                ApptType: dataObj.PREVIOUS_VISITS[i].TYPE,
                                ApptTime: dataObj.PREVIOUS_VISITS[i].BEG_DT_TM.substr(0,16),
                                Location: dataObj.PREVIOUS_VISITS[i].LOCATION,
                                Resource: dataObj.PREVIOUS_VISITS[i].RESOURCE
                            });
                    }
                }
                AmblAppts.mainDataFV.length = 0;
                for(i=0,listlen = dataObj.FUTURE_VISIT_CNT; i < listlen; i++){
                    AmblAppts.mainDataFV.push(
                        {
                            ApptStatus: dataObj.FUTURE_VISITS[i].STATUS,
                            ApptType: dataObj.FUTURE_VISITS[i].TYPE,
                            ApptTime: dataObj.FUTURE_VISITS[i].BEG_DT_TM.substr(0,16),
                            Location: dataObj.FUTURE_VISITS[i].LOCATION,
                            RESOURCE: dataObj.FUTURE_VISITS[i].RESOURCE
                        });
                }
				AmblAppts.mainDataRV.length = 0;
                for(i=0,listlen = dataObj.RESCHEDULED_EVENTS_CNT; i < listlen; i++){
					for(j=0,rlistlen = dataObj.RESCHEDULED_EVENTS[i].RESCHEDULED_VISIT_CNT; j < rlistlen; j++){
						AmblAppts.mainDataRV.push(
							{
								//ApptStatus: dataObj.RESCHEDULED_EVENTS[i].RESCHEDULED_VISITS[j].STATUS,
								ApptType: dataObj.RESCHEDULED_EVENTS[i].RESCHEDULED_VISITS[j].TYPE,
								ApptTime: dataObj.RESCHEDULED_EVENTS[i].RESCHEDULED_VISITS[j].BEG_DT_TM.substr(0,16),
								Location: dataObj.RESCHEDULED_EVENTS[i].RESCHEDULED_VISITS[j].LOCATION,
								RESOURCE: dataObj.RESCHEDULED_EVENTS[i].RESCHEDULED_VISITS[j].RESOURCE,
								REASON: (dataObj.RESCHEDULED_EVENTS[i].RESCHEDULED_VISITS[j].REASON === ""? '&nbsp;':dataObj.RESCHEDULED_EVENTS[i].RESCHEDULED_VISITS[j].REASON )
							});
					}
				}
                AmblAppts.mainDataCV.length = 0;
                for(i=0,listlen = dataObj.CANCELLED_VISIT_CNT; i < listlen; i++){
                    AmblAppts.mainDataCV.push(
                        {
                            ApptType: dataObj.CANCELLED_VISITS[i].TYPE,
                            ApptTime: dataObj.CANCELLED_VISITS[i].BEG_DT_TM.substr(0,16),
                            Location: dataObj.CANCELLED_VISITS[i].LOCATION,
                            RESOURCE: dataObj.CANCELLED_VISITS[i].RESOURCE
                        });
                }
                AmblAppts.mainDataNSV.length = 0;
                for(i=0,listlen = dataObj.NO_SHOW_VISIT_CNT; i < listlen; i++){
                    AmblAppts.mainDataNSV.push(
                        {
                            ApptType: dataObj.NO_SHOW_VISITS[i].TYPE,
                            ApptTime: dataObj.NO_SHOW_VISITS[i].BEG_DT_TM.substr(0,16),
                            Location: dataObj.NO_SHOW_VISITS[i].LOCATION,
                            RESOURCE: dataObj.NO_SHOW_VISITS[i].RESOURCE
                        });
                }
                AmblAppts.mainDataCCV.length = 0;
                for(i=0,listlen = dataObj.CONFIRMED_PREVIOUS_VISIT_CNT; i < listlen; i++){
                    AmblAppts.mainDataCCV.push(
                        {
                            ApptType: dataObj.CONFIRMED_PREVIOUS_VISITS[i].TYPE,
                            ApptTime: dataObj.CONFIRMED_PREVIOUS_VISITS[i].BEG_DT_TM.substr(0,16),
                            Location: dataObj.CONFIRMED_PREVIOUS_VISITS[i].LOCATION,
                            RESOURCE: dataObj.CONFIRMED_PREVIOUS_VISITS[i].RESOURCE
                        });
                }
            },
            processH5_Sec_Completed_data: function (dataObj, sectObj) {
                var sectionObj = CC_SectMgt.H5_Sec_Completed,
                    i, listlen,temparr = [], utemparr = [];
                sectionObj.Count = 0;
                sectionObj.Body= '';
				temparr = AmblAppts.mainDataPV
                .sort( function(a,b){
                    if ( a.ApptType < b.ApptTime )
                        return -1;
                    if ( a.ApptType > b.ApptTime )
                        return 1;
                    return 0;} );

                for(i=0,listlen = temparr.length; i < listlen; i++){
                    if (sectionObj.Count < 20) {
                        sectionObj.Body +=gFuncs.parseTemplate(AmblAppts.CC_Tmpls.rowResults.join(''), {
                            apptype: temparr[i].ApptType,
                            apptime: temparr[i].ApptTime,
                            location:temparr[i].Location,
                            resource:temparr[i].Resource,
							oddEvenFlag2 : (( i % 2 === 0 )? '': 'class="odd"')
                        });
                        sectionObj.Count += 1;
                    }
                }
            },
            processH5_Sec_Future_data: function (dataObj, sectObj) {
                var sectionObj = CC_SectMgt.H5_Sec_Future,
                    i, listlen,temparr = [], utemparr = [];
                sectionObj.Count = 0;
                sectionObj.Body= '';
                temparr = AmblAppts.mainDataFV
                .sort( function(a,b){
                    if ( a.ApptType < b.ApptTime )
                        return -1;
                    if ( a.ApptType > b.ApptTime )
                        return 1;
                    return 0;} );
                for(i=0,listlen = temparr.length; i < listlen; i++){
                    sectionObj.Body +=gFuncs.parseTemplate(AmblAppts.CC_Tmpls.rowResults.join(''), {
                        apptype: temparr[i].ApptType,
                        apptime: temparr[i].ApptTime,
                        location:temparr[i].Location,
                        resource:temparr[i].RESOURCE,
                        appstatus: temparr[i].ApptStatus,
						oddEvenFlag2 : (( i % 2 === 0 )? '': 'class="odd"')
                    });
                    sectionObj.Count += 1;
                }

            },
			processH5_Sec_Reschedule_data: function (dataObj, sectObj) {
				var sectionObj = CC_SectMgt.H5_Sec_Reschedule,
                    i, listlen,temparr = [], utemparr = [];
                sectionObj.Count = 0;
                sectionObj.Body= '';
                temparr = AmblAppts.mainDataRV
                .sort( function(a,b){
                    if ( a.ApptType < b.ApptTime )
                        return -1;
                    if ( a.ApptType > b.ApptTime )
                        return 1;
                    return 0;} );
                for(i=0,listlen = temparr.length; i < listlen; i++){
                    sectionObj.Body +=gFuncs.parseTemplate(AmblAppts.CC_Tmpls.rowResultsRV.join(''), {
                        apptype: temparr[i].ApptType,
                        apptime: temparr[i].ApptTime,
                        location:temparr[i].Location,
                        resource:temparr[i].RESOURCE,
						reason:temparr[i].REASON,
						oddEvenFlag : (( i % 2 === 0 )? '': 'class="odd"')
                        //appstatus: temparr[i].ApptStatus
                    });
                    sectionObj.Count += 1;
                }

            },
            processH5_Sec_Cancel_data: function (dataObj, sectObj) {
                var sectionObj = CC_SectMgt.H5_Sec_Cancel,
                    i, listlen,temparr = [], utemparr = [];
                sectionObj.Count = 0;
                sectionObj.Body= '';
                temparr = AmblAppts.mainDataCV
                .sort( function(a,b){
                    if ( a.ApptType < b.ApptTime )
                        return -1;
                    if ( a.ApptType > b.ApptTime )
                        return 1;
                    return 0;} );
                for(i=0,listlen = temparr.length; i < listlen; i++){
                    if (sectionObj.Count < 10) {
                        sectionObj.Body +=gFuncs.parseTemplate(AmblAppts.CC_Tmpls.rowResults.join(''), {
                            apptype: temparr[i].ApptType,
                            apptime: temparr[i].ApptTime,
                            location:temparr[i].Location,
                            resource:temparr[i].RESOURCE,
							oddEvenFlag2 : (( i % 2 === 0 )? '': 'class="odd"')
                        });
                    }
                    sectionObj.Count += 1;
                }
            },
            processH5_Sec_NoShow_data: function (dataObj, sectObj) {
                var sectionObj = CC_SectMgt.H5_Sec_NoShow,
                    i, listlen,temparr = [], utemparr = [];
                sectionObj.Count = 0;
                sectionObj.Body= '';
                temparr = AmblAppts.mainDataNSV
                .sort( function(a,b){
                    if ( a.ApptType < b.ApptTime )
                        return -1;
                    if ( a.ApptType > b.ApptTime )
                        return 1;
                    return 0;} );
                for(i=0,listlen = temparr.length; i < listlen; i++){
                    if (sectionObj.Count < 10) {
                        sectionObj.Body +=gFuncs.parseTemplate(AmblAppts.CC_Tmpls.rowResultsCN.join(''), {
                            apptype: temparr[i].ApptType,
                            apptime: temparr[i].ApptTime,
                            location:temparr[i].Location,
                            resource:temparr[i].RESOURCE,
							oddEvenFlag2 : (( i % 2 === 0 )? '': 'class="odd"')
                        });
                    }
                    sectionObj.Count += 1;
                }
            },
            processH5_Sec_Confirmed_Completed_data: function (dataObj, sectObj) {
                var sectionObj = CC_SectMgt.H5_Sec_Confirmed_Completed,
                    i, listlen,temparr = [], utemparr = [];
                sectionObj.Count = 0;
                sectionObj.Body= '';
                temparr = AmblAppts.mainDataCCV
                .sort( function(a,b){
                    if ( a.ApptType < b.ApptTime )
                        return -1;
                    if ( a.ApptType > b.ApptTime )
                        return 1;
                    return 0;} );
                for(i=0,listlen = temparr.length; i < listlen; i++){
                    if (sectionObj.Count < 10) {
                        sectionObj.Body +=gFuncs.parseTemplate(AmblAppts.CC_Tmpls.rowResultsCN.join(''), {
                            apptype: temparr[i].ApptType,
                            apptime: temparr[i].ApptTime,
                            location:temparr[i].Location,
                            resource:temparr[i].RESOURCE,
							oddEvenFlag2 : (( i % 2 === 0 )? '': 'class="odd"')
                        });
                    }
                    sectionObj.Count += 1;
                }
            },
            processH5_Section_Completed: function () {
                var sectionObj = new htmlSecCtl(),
                    sectionData = CC_SectMgt.H5_Sec_Completed,
                    defaultHeight='';
                //defaultHeight = ( sectionData.Count < 7 ? '' : 'style="height:200px; overflow-y:auto"');
                sectionObj.initValues(
                    {
                        idLabel: 'H5_Sec_Completed',
                        TLabel1: 'Completed',
                        SectionClosed: 'closed',
                        SectionCnt: ' (' + sectionData.Count + ') <span style="font-size: 9px; color: grey"> - Max of 20 Appts Displayed</span>',
                        SectionCntVal: sectionData.Count,
                        ContentBody:gFuncs.parseTemplate(AmblAppts.CC_Tmpls.rowResultsbody.join(''), {
                            defaultHeight: defaultHeight,
                            SectBody: sectionData.Body
                        }) ,
                        TemplateType: sectionData.TemplateType
                    });
                AmblAppts.H5_Section_Completed =
                    sectionObj.generateHTML(CC_CssBehavior);
                sectionData.SectionDivID = sectionObj.SectionDivID;
            },
            processH5_Section_Future: function () {
                var sectionObj = new htmlSecCtl(),
                    sectionData = CC_SectMgt.H5_Sec_Future,
                    defaultHeight='';
                //defaultHeight = ( sectionData.Count < 7 ? '' : 'style="height:200px; overflow-y:auto"');
                sectionObj.initValues(
                    {
                        idLabel: 'H5_Sec_Future',
                        TLabel1: 'Future',
                        SectionClosed: 'closed',
                        SectionCntVal: sectionData.Count,
                        ContentBody:gFuncs.parseTemplate(AmblAppts.CC_Tmpls.rowResultsbody.join(''), {
                            defaultHeight: defaultHeight,
                            SectBody: sectionData.Body
                        }) ,
                        TemplateType: sectionData.TemplateType
                    });
                AmblAppts.H5_Section_Future =
                    sectionObj.generateHTML(CC_CssBehavior);
                sectionData.SectionDivID = sectionObj.SectionDivID;
            },
			 processH5_Section_Reschedule: function () {
				var sectionObj = new htmlSecCtl(),
                    sectionData = CC_SectMgt.H5_Sec_Reschedule,
                    defaultHeight='';

                sectionObj.initValues(
                    {
                        idLabel: 'H5_Sec_Reschedule',
                        TLabel1: 'Rescheduled',
                        SectionClosed: 'closed',
						SectionCnt: ' (' + sectionData.Count + ') <span style="font-size: 9px; color: grey"> - Max of 50 Appts Displayed</span>',
                        SectionCntVal: sectionData.Count,
                        ContentBody:gFuncs.parseTemplate(AmblAppts.CC_Tmpls.rowResultsbodyRV.join(''), {
                            defaultHeight: defaultHeight,
                            SectBody: sectionData.Body
                        }) ,
                        TemplateType: sectionData.TemplateType
                    });
                AmblAppts.H5_Section_Reschedule =
                    sectionObj.generateHTML(CC_CssBehavior);
                sectionData.SectionDivID = sectionObj.SectionDivID;

            },
            processH5_Section_Cancel: function () {
                var sectionObj = new htmlSecCtl(),
                    sectionData = CC_SectMgt.H5_Sec_Cancel,
                    defaultHeight='';
                //defaultHeight = ( sectionData.Count < 7 ? '' : 'style="height:200px; overflow-y:auto"');
                sectionObj.initValues(
                    {
                        idLabel: 'H5_Sec_Cancel',
                        TLabel1: 'Cancelled',
                        SectionClosed: 'closed',
                        SectionCnt: ' (' + sectionData.Count + ') <span style="font-size: 9px; color: grey"> - Max of 10 Appts Displayed</span>',
                        SectionCntVal: sectionData.Count,
                        ContentBody:gFuncs.parseTemplate(AmblAppts.CC_Tmpls.rowResultsbody.join(''), {
                            defaultHeight: defaultHeight,
                            SectBody: sectionData.Body
                        }) ,
                        TemplateType: sectionData.TemplateType
                    });
                AmblAppts.H5_Section_Cancel =
                    sectionObj.generateHTML(CC_CssBehavior);
                sectionData.SectionDivID = sectionObj.SectionDivID;
            },
            processH5_Section_NoShow: function () {
                var sectionObj = new htmlSecCtl(),
                    sectionData = CC_SectMgt.H5_Sec_NoShow,
                    defaultHeight='';
                //defaultHeight = ( sectionData.Count < 7 ? '' : 'style="height:200px; overflow-y:auto"');
                sectionObj.initValues(
                    {
                        idLabel: 'H5_Sec_NoShow',
                        TLabel1: 'No-Shows',
                        SectionClosed: 'closed',
                        SectionCnt: ' (' + sectionData.Count + ') <span style="font-size: 9px; color: grey"> - Max of 10 Appts Displayed</span>',
                        SectionCntVal: sectionData.Count,
                        ContentBody:gFuncs.parseTemplate(AmblAppts.CC_Tmpls.rowResultsbody.join(''), {
                            defaultHeight: defaultHeight,
                            SectBody: sectionData.Body
                        }) ,
                        TemplateType: sectionData.TemplateType
                    });
                AmblAppts.H5_Section_NoShow =
                    sectionObj.generateHTML(CC_CssBehavior);
                sectionData.SectionDivID = sectionObj.SectionDivID;
            },
            processH5_Section_Confirmed_Completed: function () {
                var sectionObj = new htmlSecCtl(),
                    sectionData = CC_SectMgt.H5_Sec_Confirmed_Completed,
                    defaultHeight='';
                //defaultHeight = ( sectionData.Count < 7 ? '' : 'style="height:200px; overflow-y:auto"');
                sectionObj.initValues(
                    {
                        idLabel: 'H5_Sec_Confirmed_Completed',
                        TLabel1: 'Past Appointments in Confirmed Status',
                        SectionClosed: 'closed',
                        SectionCnt: ' (' + sectionData.Count + ') <span style="font-size: 9px; color: grey"> - Max of 10 Appts Displayed</span>',
                        SectionCntVal: sectionData.Count,
                        ContentBody:gFuncs.parseTemplate(AmblAppts.CC_Tmpls.rowResultsbody.join(''), {
                            defaultHeight: defaultHeight,
                            SectBody: sectionData.Body
                        }) ,
                        TemplateType: sectionData.TemplateType
                    });
                AmblAppts.H5_Section_Confirmed_Completed =
                    sectionObj.generateHTML(CC_CssBehavior);
                sectionData.SectionDivID = sectionObj.SectionDivID;
            },
            processCcInstance: function () {
                compContent = gFuncs.parseTemplate(AmblAppts.CC_Tmpls.mainDiv.join(''), {
                    cc_id: AmblAppts.cc_id,
                    mainSection: AmblAppts.mainSection,
                    H5_Section_Completed: AmblAppts.H5_Section_Completed,
                    H5_Section_Future: AmblAppts.H5_Section_Future,
					H5_Section_Reschedule: AmblAppts.H5_Section_Reschedule,
                    H5_Section_Cancel: AmblAppts.H5_Section_Cancel,
                    H5_Section_NoShow: AmblAppts.H5_Section_NoShow,
                    H5_Section_Confirmed_Completed: AmblAppts.H5_Section_Confirmed_Completed,
                    mainSectionEnd: AmblAppts.mainSectionEnd
                });
                gFuncs.Log_CC( component, compContent);
                target.innerHTML = compContent;
            },
            processCcCssSectionBehavior1: function () {
                htmlSecCtlObj.initToggle(CC_CssBehavior,CC_SectMgt.H5_Sec_Completed);
            },
            processCcCssSectionBehavior2: function () {
                htmlSecCtlObj.initToggle(CC_CssBehavior,CC_SectMgt.H5_Sec_Future);
            },
			processCcCssSectionBehavior15: function () {
                htmlSecCtlObj.initToggle(CC_CssBehavior,CC_SectMgt.H5_Sec_Reschedule);
            },
            processCcCssSectionBehavior11: function () {
                htmlSecCtlObj.initToggle(CC_CssBehavior,CC_SectMgt.H5_Sec_Cancel);
            },
            processCcCssSectionBehavior12: function () {
                htmlSecCtlObj.initToggle(CC_CssBehavior,CC_SectMgt.H5_Sec_NoShow);
            },
            processCcCssSectionBehavior14: function () {
                htmlSecCtlObj.initToggle(CC_CssBehavior,CC_SectMgt.H5_Sec_Confirmed_Completed);
            },
            processCcCssControlBehavior1: function () {
                var cclParams;
                $('.eappsCssBtn-DtRange').removeClass('activeselect');
                $( '#' + component.cclParams[4].replace(',m','m')).addClass('activeselect');
                $('.eappsCssBtn-DtRange').on('click', function(){
                    $('.eappsCssBtn-DtRange').removeClass('activeselect');
                    //$(this).addClass('activeselect');
                    component.cclParams[4] = $(this).attr('id').replace('m',',m') ;
                    $(this).addClass('activeprocessing');
                    $('.eappsCssBtn-DtRange').off('click');


                    component.loadCcl('chla_ca_mp_ambl_appt_json',
                        component.cclParams,
                        DTRangeLoadCCL,
                        "JSON");
//                      DTRangeLoadCCL.call(component, elementObj);
                });
            },
            init: function () {
                var subHeaderDisplay;
                elementObj = component.data.RPTDATA;
                target = component.getTarget();

                component.eApps = {
                    cc_id: component.name.replace('.', '_'),
                    CSSBehaviors: new chla.eApps.CSSBehaviors2(),
                    TestSAP: null,
                    AmblAppts: AmblAppts
                };
                AmblAppts.initOnly = '';
                AmblAppts.cc_id = component.eApps.cc_id;
                AmblAppts.personId = component.getProperty("personId");
                AmblAppts.encounterId = component.getProperty("encounterId");
                AmblAppts.prsnlId = component.getProperty("userId");
                component.eApps.TestSAP= AmblAppts.TestServiceAccessPoint;
                htmlSecCtl = chla.eApps.SectionHeaderCtl2;
                htmlSecCtlObj = new htmlSecCtl();
                htmlSecCtlData = chla.eApps.SectionData2;
                CC_SectMgt = AmblAppts.CC_SectionManagement;
                CC_SectMgt.H5_Sec_Completed = new htmlSecCtlData('H5');
                CC_SectMgt.H5_Sec_Future = new htmlSecCtlData('H5');
				CC_SectMgt.H5_Sec_Reschedule = new htmlSecCtlData('H5');
                CC_SectMgt.H5_Sec_Cancel = new htmlSecCtlData('H5');
                CC_SectMgt.H5_Sec_NoShow = new htmlSecCtlData('H5');
                CC_SectMgt.H5_Sec_Confirmed_Completed = new htmlSecCtlData('H5');
                gFuncs = chla.eApps.Funcs;

                CC_CssBehavior = component.eApps.CSSBehaviors;

            },
            TestServiceAccessPoint: function (){
                return {
                    TestprocessRPTDATA_main_data: AmblAppts.processRPTDATA_main_data,
                    TestProcessH5_Sec_Completed_data: AmblAppts.processH5_Sec_Completed_data,
                    TestProcessH5_Sec_Future_data: AmblAppts.processH5_Sec_Future_data,
                    TestProcessH5_Sec_Cancel_data: AmblAppts.processH5_Sec_Cancel_data,
                    TestProcessH5_Sec_NoShow_data: AmblAppts.processH5_Sec_NoShow_data,
                    TestProcessH5_Sec_Confirmed_Completed_data: AmblAppts.processH5_Sec_Confirmed_Completed_data,

                    TestProcessH5_Section_Completed: AmblAppts.processH5_Section_Completed,
                    TestProcessH5_Section_Future: AmblAppts.processH5_Section_Future,
                    TestProcessH5_Section_Cancel: AmblAppts.processH5_Section_Cancel,
                    TestProcessH5_Section_NoShow: AmblAppts.processH5_Section_NoShow,
                    TestProcessH5_Section_Confirmed_Completed: AmblAppts.processH5_Section_Confirmed_Completed,

                    TestProcessCcInstance: AmblAppts.processCcInstance,
                    TestProcessCcCssSectionBehavior_1: AmblAppts.processCcCssSectionBehavior1,
                    TestProcessCcCssSectionBehavior_2: AmblAppts.processCcCssSectionBehavior2,
                    TestProcessCcCssSectionBehavior_11: AmblAppts.processCcCssSectionBehavior11,
                    TestProcessCcCssSectionBehavior_12: AmblAppts.processCcCssSectionBehavior12,
                    TestProcessCcCssSectionBehavior_14: AmblAppts.processCcCssSectionBehavior14

                };
            },
            CCprocessing: function (){
				if (AmblAppts.initOnly == false) {
                    AmblAppts.processRPTDATA_main_data(elementObj)
                    AmblAppts.processH5_Sec_Completed_data(elementObj);
                    AmblAppts.processH5_Sec_Future_data(elementObj);
					AmblAppts.processH5_Sec_Reschedule_data(elementObj);
                    AmblAppts.processH5_Sec_Cancel_data(elementObj);
                    AmblAppts.processH5_Sec_NoShow_data(elementObj);
                    AmblAppts.processH5_Sec_Confirmed_Completed_data(elementObj);

                    AmblAppts.processH5_Section_Completed();
                    AmblAppts.processH5_Section_Future();
					AmblAppts.processH5_Section_Reschedule();
                    AmblAppts.processH5_Section_Cancel();
                    AmblAppts.processH5_Section_NoShow();
                    AmblAppts.processH5_Section_Confirmed_Completed();

                    AmblAppts.processCcInstance();
                    AmblAppts.processCcCssSectionBehavior1();
                    AmblAppts.processCcCssSectionBehavior2();
					AmblAppts.processCcCssSectionBehavior15();
                    AmblAppts.processCcCssSectionBehavior11();
                    AmblAppts.processCcCssSectionBehavior12();
                    AmblAppts.processCcCssSectionBehavior14();
                    AmblAppts.processCcCssControlBehavior1();
                }
            }
        };
    function DTRangeLoadCCL(data){      //callback.call(self, JSON.parse(responseData));
        $('#' + component.eApps.AmblAppts.cc_id).remove();
        this.data = data;
        elementObj = component.data.RPTDATA;
        AmblAppts.CCprocessing();
    };
    AmblAppts.init();
    AmblAppts.CCprocessing();
};
//::===========================================================================
chla.RadOrders = function () { };
chla.RadOrders.prototype = new MPage.Component();
chla.RadOrders.prototype.constructor = MPage.Component;
chla.RadOrders.prototype.base = MPage.Component.prototype;
chla.RadOrders.prototype.name = "chla.RadOrders";
chla.RadOrders.prototype.cclProgram = "chla_ca_mp_rad_orders_json"; //_CCL_init_
chla.RadOrders.prototype.cclParams = [];
chla.RadOrders.prototype.cclDataType = "JSON";
chla.RadOrders.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("personId");
    this.cclParams[2] = this.getProperty("userId");
};

chla.RadOrders.prototype.render = function () {
    var component = this,
        elementObj,
        target,
        compContent;
    var CC_SectMgt = null,
        CC_CssBehavior = null,
        gFuncs = null,
        htmlSecCtl = null,
        htmlSecCtlObj = null,
        htmlSecCtlData = null,
        CclReqObjSave = null,
        RadOrders = {
            initOnly: false,
            cc_id: 'x',
            personId: 0,
            encounterId: 0,
            prsnlId: 0,
            transparentSpacer: '',

            CC_SectionManagement: {
                sectionlist: []
            },
            mainSection: '',
            mainSectionEnd:'',
            H5_Section_PU: '',
            H5_Section_CC: '',
            H5_Section_EN: '',
            H5_Section_SS: '',
            CC_Tmpls: {
                mainDiv: [
                    '<div id="<#=cc_id#>" class="eapps_CC">',
                    '<#=H5_Section_PU#>',
                    '<#=H5_Section_CC#>',
                    '<#=H5_Section_EN#>',
                    '<#=H5_Section_SS#>',
                    '<#=mainSectionEnd#>',
                    '</div>'
                ],
                orderRow_results : [
                    '<tr <#=ROWODDS#>><td><#=EVENT_DATE#></td><td><#=EVENT#></td><td><#=STATUS#></td></tr>'
                ],
                orderRow_header: [
                    '<table class="header"><tr width="100%">',
                    '<th width="25%" class="col-1">Date</th>',
                    '<th width="50%" class="col-2">Description</th>',
                    '<th width="25%" class="col-3">Status</th>',
                    '</tr>',
                    '<#=orderRow_body#></table>'
                ],
            },

            processH6_Sec_All_data: function (dataObj, sectObjLst) {
                var i,j,listmain, listlen,
                    sectionName,
                    orderObj,
                    oddEvenFlag,
                    sectionObj;
                for (j= 0 ,listmain = sectObjLst.sectionlist.length; j < listmain; j ++ ){
                    sectionName = sectObjLst.sectionlist[j];
                    sectionObj = sectObjLst[sectionName];
                    if (sectionObj.SectionLevel.toUpperCase()== 'H6' ) {
                        sectionObj.Count = 0;
                        sectionObj.Body = '';
                        listlen = 0;
                        orderObj= null;
                        if (sectionName == 'H6_Sec_SS'){
                            listlen = (typeof dataObj.SLEEP_STUDY_ORDER_CNT == 'undefined')? 0 : dataObj.SLEEP_STUDY_ORDER_CNT;
                            orderObj = (typeof dataObj.SLEEP_STUDY_ORDERS == 'undefined')? 0 : dataObj.SLEEP_STUDY_ORDERS;
                        }
                        oddEvenFlag = 0;
                        for ( i = 0; i < listlen; i++ ){
                            sectionObj.Count += 1;
                            oddEvenFlag = (( i % 2 == 0 )? '': 'class="odd"');
                            sectionObj.Body += gFuncs.parseTemplate(RadOrders.CC_Tmpls.orderRow_results.join(''),
                                {
                                    EVENT_DATE:  orderObj[i].ORIG_ORDER_DT_TM,
                                    EVENT:       orderObj[i].ORDER_MNEMONIC,
                                    STATUS:      orderObj[i].ORDER_STATUS,
                                    ROWODDS:     oddEvenFlag
                                });
                        }
                    }
                }
            },
            processH5_Sec_All_data: function (dataObj, sectObjLst) {
                var i,j,listmain, listlen,
                    sectionName,
                    orderObj,
                    oddEvenFlag,
                    sectionObj;
                for (j= 0 ,listmain = sectObjLst.sectionlist.length; j < listmain; j ++ ){
                    sectionName = sectObjLst.sectionlist[j];
                    sectionObj = sectObjLst[sectionName];
                    if (sectionObj.SectionLevel.toUpperCase()== 'H5' ) {
                        sectionObj.Count = 0;
                        sectionObj.Body = '';
                        listlen = 0;
                        orderObj= null;
                        if (sectionName == 'H5_Sec_CC'){
                            listlen = (typeof dataObj.CARDIO_ORDER_CNT == 'undefined')? 0 : dataObj.CARDIO_ORDER_CNT;
                            orderObj = (typeof dataObj.CARDIO_ORDERS == 'undefined')? 0 : dataObj.CARDIO_ORDERS;
                        } else if (sectionName == 'H5_Sec_PU'){
                            listlen = (typeof dataObj.PULM_ORDER_CNT == 'undefined')? 0 : dataObj.PULM_ORDER_CNT;
                            orderObj = (typeof dataObj.PULM_ORDERS == 'undefined')? 0 : dataObj.PULM_ORDERS;
                        } else if (sectionName == 'H5_Sec_EN'){
                            listlen = (typeof dataObj.ENDO_ORDER_CNT == 'undefined')? 0 : dataObj.ENDO_ORDER_CNT;
                            orderObj = (typeof dataObj.ENDO_ORDERS == 'undefined')? 0 : dataObj.ENDO_ORDERS;
                        }
                        oddEvenFlag = 0;
                        for ( i = 0; i < listlen; i++ ){
                            sectionObj.Count += 1;
                            oddEvenFlag = (( i % 2 == 0 )? '': 'class="odd"');
                            sectionObj.Body += gFuncs.parseTemplate(RadOrders.CC_Tmpls.orderRow_results.join(''), {
                                EVENT_DATE:  orderObj[i].ORIG_ORDER_DT_TM,
                                EVENT:       orderObj[i].ORDER_MNEMONIC,
                                STATUS:      orderObj[i].ORDER_STATUS,
                                ROWODDS:     oddEvenFlag
                            });
                        }
                    }
                }
            },
            processH6_Section_All: function (sectObjLst) {
                var i,j,listmain, listlen,
                    wrkValue,
                    sectionName,
                    sectionObj = htmlSecCtl.neo(),
                    orderObj,
                    sectionData;
                for (j= 0 ,listmain = sectObjLst.sectionlist.length; j < listmain; j ++ ){
                    sectionName = sectObjLst.sectionlist[j];
                    sectionData = sectObjLst[sectionName];
                    if (sectionData.SectionLevel.toUpperCase()== 'H6' ) {
                        sectionObj.resetValues(sectionObj);
                        sectionObj.initValues(
                            {
                                idLabel: 'H6_Sec_' + sectionData.SectionID,
                                TLabel1: sectionData.TLabel1,
                                SectionCntVal: sectionData.Count,
                                ContentBody: gFuncs.parseTemplate(RadOrders.CC_Tmpls.orderRow_header.join(''), {
                                    orderRow_body: sectionData.Body }),
                                TemplateType: sectionData.TemplateType
                            });
                        wrkValue = 'H6_Section_' + sectionData.SectionID ;
                        RadOrders[wrkValue] =
                            sectionObj.generateHTML(CC_CssBehavior);
                        sectionData.SectionDivID = sectionObj.SectionDivID;
                    }
                }
            },
            processH5_Section_All: function (sectObjLst) {
                var i,j,listmain, listlen,
                    wrkValue,
                    wrkValue2,
                    sectionName,
                    sectionObj = htmlSecCtl.neo(),
                    orderObj,
                    sectionData;
                for (j= 0 ,listmain = sectObjLst.sectionlist.length; j < listmain; j ++ ){
                    sectionName = sectObjLst.sectionlist[j];
                    sectionData = sectObjLst[sectionName];
                    if (sectionData.SectionLevel.toUpperCase()== 'H5' ) {
                        wrkValue = gFuncs.parseTemplate(RadOrders.CC_Tmpls.orderRow_header.join(''), {
                            orderRow_body: sectionData.Body }) ;

                        if (sectionName == 'H5_Sec_PU'){
                            if (sectionData.Count == 0){
                                wrkValue = '';
                            }
                            wrkValue += RadOrders['H6_Section_SS'];
                            sectionData.Toggle = 'disable';
                            sectionObj.initValues(
                                {
                                    idLabel: 'H5_Sec_' + sectionData.SectionID,
                                    TLabel1: sectionData.TLabel1,
                                    SectionCntVal: sectionData.Count,
                                    CustIcon: 'none',
                                    Disabled_Lbl: 'enabledAlways',
                                    ContentBody: wrkValue,
                                    SectionClosed: sectionData.SectionClosed,
                                    TemplateType: sectionData.TemplateType
                                });
                        } else {
                            sectionObj.initValues(
                                {
                                    idLabel: 'H5_Sec_' + sectionData.SectionID,
                                    TLabel1: sectionData.TLabel1,
                                    SectionCntVal: sectionData.Count,
                                    ContentBody: wrkValue,
                                    SectionClosed: sectionData.SectionClosed,
                                    TemplateType: sectionData.TemplateType
                                });
                        }
                        wrkValue = 'H5_Section_' + sectionData.SectionID ;
                        RadOrders[wrkValue] =
                            sectionObj.generateHTML(CC_CssBehavior);
                        sectionData.SectionDivID = sectionObj.SectionDivID;
                    }
                }
            },
            processCcInstance: function () {
                compContent = gFuncs.parseTemplate(RadOrders.CC_Tmpls.mainDiv.join(''), {
                    cc_id: RadOrders.cc_id,
                    mainSection:    RadOrders.mainSection,
                    H5_Section_CC:  RadOrders.H5_Section_CC,
                    H5_Section_PU:  RadOrders.H5_Section_PU,
                    H5_Section_EN:  RadOrders.H5_Section_EN,
                    H5_Section_SS:  RadOrders.H5_Section_SS,
                    mainSectionEnd: RadOrders.mainSectionEnd
                    //...
                });
                gFuncs.Log_CC( component, compContent);
                target.innerHTML = compContent;
            },
            processCcCssSectionBehaviors: function (sectObjLst) {
                var i,j,listmain, listlen,
                    sectionData, sectionName;
                for (j= 0 ,listmain = sectObjLst.sectionlist.length; j < listmain; j ++ ){
                    sectionName = sectObjLst.sectionlist[j];
                    sectionData = sectObjLst[sectionName];
                    htmlSecCtlObj.initToggle(CC_CssBehavior,sectionData);
                }
            },
            init: function () {
                var subHeaderDisplay,
                    SectionCfg,
                    i,listlen,wrkValue;

                elementObj = component.data.RPTDATA;
                target = component.getTarget();

                component.eApps = {
                    cc_id: component.name.replace('.', '_'),
                    CSSBehaviors: chla.eApps.gCSSBehaviors.neo(),
                    TestSAP: null
                };
                RadOrders.initOnly = ChlaStdClass.safeRead( chla,'eApps','operationMode') == 'test' ||
                    ChlaStdClass.safeRead( chla,'eApps','RadOrders','operationMode') == 'RadOrdersTest' ;
                RadOrders.cc_id = component.eApps.cc_id;
                RadOrders.personId = component.getProperty("personId");
                RadOrders.encounterId = component.getProperty("encounterId");
                RadOrders.prsnlId = component.getProperty("userId");
                component.eApps.TestSAP= RadOrders.TestServiceAccessPoint;
                htmlSecCtl = chlaNsMgr.aliasDirector('chla.eApps.Html.SectionHeaderCtl');
                htmlSecCtlData = chlaNsMgr.aliasDirector('chla.eApps.Html.SectionData');
                htmlSecCtlObj = htmlSecCtl.neo();
                CC_SectMgt = RadOrders.CC_SectionManagement;

                SectionCfg = [
                    // H5 Sections
                    {T_type: 'H5',SecId: 'CC',           TLblId: 'Cardiology',    SecClsd: 'auto',SecLvl:'H5'},
                    {T_type: 'H5',SecId: 'EN',           TLblId: 'Endocrinology', SecClsd: 'auto',SecLvl:'H5'},
                    {T_type: 'H5',SecId: 'PU',           TLblId: 'Pulmonary',     SecClsd: 'opened',SecLvl:'H5',SecTgl: 'disabled'},
                    {T_type: 'H6',SecId: 'SS',           TLblId: 'Sleep Study',   SecClsd: 'auto',SecLvl:'H6'}
                ];
                for ( i = 0, listlen = SectionCfg.length; i < listlen; i++){
                    wrkValue = SectionCfg[i].SecLvl + '_Sec_' + SectionCfg[i].SecId ;
                    CC_SectMgt[wrkValue] = htmlSecCtlData.neo(
                        SectionCfg[i].T_type ,
                        SectionCfg[i].SecId ,
                        SectionCfg[i].TLblId ,
                        SectionCfg[i].SecClsd ,
                        SectionCfg[i].SecLvl
                    ) ;
                    CC_SectMgt.sectionlist.push(wrkValue);
                }
                CC_CssBehavior = component.eApps.CSSBehaviors;

                gFuncs = chlaNsMgr.aliasDirector('chla.eApps.gFuncs');
            },
            TestServiceAccessPoint: function (){
                return {
                    TestprocessH5_Sec_All_data: RadOrders.processH5_Sec_All_data,
                    TestprocessH5_Section_All: RadOrders.processH5_Section_All,
                    TestProcessCcInstance: RadOrders.processCcInstance,
                    TestprocessCcCssSectionBehaviors: RadOrders.processCcCssSectionBehaviors
                };
            }
        };
    RadOrders.init();
    if (RadOrders.initOnly == false) {
        RadOrders.processH6_Sec_All_data(elementObj,CC_SectMgt);
        RadOrders.processH5_Sec_All_data(elementObj,CC_SectMgt);
        RadOrders.processH6_Section_All(CC_SectMgt);
        RadOrders.processH5_Section_All(CC_SectMgt);
        RadOrders.processCcInstance();
        RadOrders.processCcCssSectionBehaviors(CC_SectMgt);
    }
};
chla.RadPreScreen = function () { };
chla.RadPreScreen.prototype = new MPage.Component();
chla.RadPreScreen.prototype.constructor = MPage.Component;
chla.RadPreScreen.prototype.base = MPage.Component.prototype;
chla.RadPreScreen.prototype.name = "chla.RadPreScreen";
chla.RadPreScreen.prototype.cclProgram = "chla_ca_mp_rad_scr_pf"; //_CCL_init_
chla.RadPreScreen.prototype.cclParams = [];
chla.RadPreScreen.prototype.cclDataType = "JSON";
chla.RadPreScreen.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("personId");
    this.cclParams[2] = this.getProperty("encounterId");
    this.cclParams[3] = this.getProperty("userId");
};

chla.RadPreScreen.prototype.render = function () {

    var component = this,
        elementObj,
        target,
        compContent;
    var CC_SectMgt = null,
        CC_CssBehavior = null,
        gFuncs = null,
        htmlSecCtl = null,
        htmlSecCtlObj = null,
        htmlSecCtlData = null,
        CclReqObjSave = null,
        RadPreScreen = {
            initOnly: false,
            cc_id: 'x',
            personId: 0,
            encounterId: 0,
            prsnlId: 0,
            transparentSpacer: '',

            CC_SectionManagement: {
                sectionlist:[]
            },
            mainSection: '',
            mainSectionEnd:'',
            H5_Section_CurPatProblems:'',
            H5_Section_HistPatProblems:'',
            H6_Section_prog_shunt:'',
            Programmable_Shunt_detail:'',
            CC_Tmpls: {
                mainDiv: [
                    '<div id="<#=cc_id#>" class="eapps_CC">',
                    '<#=mainSection#>',
                    '<#=H5_Section_CurPatProblems#>',
                    '<#=H5_Section_HistPatProblems#>',
                    '<#=mainSectionEnd#>',
                    '</div>'
                ],
                Additional_Template1: []
            },
            processH5_Sec_CurPatProblems_data: function (dataObj, sectObj) {
                var sectionObj = CC_SectMgt.H5_Sec_CurPatProblems,
                    i, len, wrkdata;
                sectionObj.Body = '';
                CC_SectMgt.H6_Sec_prog_shunt.Count = 0;
                for ( i = 0, len = elementObj.CUR_DATA_CNT ; i < len ; i++){
                    //Programmable_Shunt_detail
                    if (elementObj.CUR_DATA[i].CUR_ITEM_NAME == 'Programmable Shunt'){
                        RadPreScreen.Programmable_Shunt_detail = elementObj.CUR_PROG_SHUNT_DETAILS;
                        CC_SectMgt.H6_Sec_prog_shunt.Count = 1;

                    } else {
                        wrkdata = '<tr ' + (i % 2 == 0 ? '' : 'class ="odd"') + '><td>' + elementObj.CUR_DATA[i].CUR_ITEM_NAME + '</td></tr>';
                        sectionObj.Body += wrkdata;
                    }
                }
                sectionObj.Count = elementObj.CUR_DATA_CNT;
            },
            processH5_Sec_HistPatProblems_data: function (dataObj, sectObj) {
                var sectionObj = CC_SectMgt.H5_Sec_HistPatProblems,
                    i, len, wrkdata;
                sectionObj.Body = '';
                for ( i = 0, len = elementObj.HIST_DATA_CNT ; i < len ; i++){
                    wrkdata = '<tr ' + (i % 2 == 0 ? '' : 'class ="odd"')+
                        'width="100%"><td width="50%">' + elementObj.HIST_DATA[i].HIST_ITEM_NAME +
                        '</td><td>' +
                        '<a onclick="chla.eApps.gFuncs.MPageUtils(&quot;POWERFORM&quot;,' +
                        elementObj.PERSON_ID + ',' +
                        elementObj.ENCNTR_ID + ',' +
                        elementObj.HIST_DATA[i].HIST_FORM_ID + ',' +
                        elementObj.HIST_DATA[i].HIST_ACTVITY_ID + ',' + '0 );">' +
                        elementObj.HIST_DATA[i].HIST_ITEM_DT_TM +
                        '</a></td><td>Radiology</td></tr>';
                    sectionObj.Body += wrkdata;
                }
                sectionObj.Count = elementObj.HIST_DATA_CNT;
            },
            processRPTDATA_main_data: function () {
                var DEF_CUR_FORM_ID,
                    DEF_PERSON_ID,
                    DEF_ENCTR_ID;
                DEF_CUR_FORM_ID = ( elementObj.CUR_FORM_ID == 0 ? 1740037 : elementObj.CUR_FORM_ID);
                DEF_PERSON_ID = ( elementObj.PERSON_ID == 0 ? RadPreScreen.personId : elementObj.PERSON_ID);
                DEF_ENCTR_ID = ( elementObj.ENCNTR_ID == 0 ? RadPreScreen.encounterId : elementObj.ENCNTR_ID);
                RadPreScreen.mainSection= '<a onclick="chla.eApps.gFuncs.MPageUtils(&quot;POWERFORM&quot;,' +
                    DEF_PERSON_ID + ',' +
                    DEF_ENCTR_ID + ',' +
                    DEF_CUR_FORM_ID + ',' +
                    elementObj.CUR_ACTVITY_ID + ',' +
                    '0 );"> Evaluation Form</a> signed at ' + elementObj.CUR_FORM_DT_TM +
                    '&nbsp;&nbsp;&nbsp;&nbsp;  Service/Dept: Radiology';
            },
            processH6_Section_prog_shunt: function () {
                var sectionObj = htmlSecCtl.neo(),
                    sectionData = CC_SectMgt.H6_Sec_prog_shunt;
                sectionObj.resetValues(sectionObj);
                if (sectionData.Count > 0 ){
                    sectionObj.initValues(
                        {
                            idLabel: 'H6_Sec_prog_shunt',
                            TLabel1: 'Programmable Shunt',
                            SectionClosed: 'open',
                            CustIcon:'none',
                            CustMargin: 'margin-left: -10px;',
                            SectionCntVal: 0,
                            SectionCnt: '',
                            ContentBody: '<tr><td>' + RadPreScreen.Programmable_Shunt_detail +
                            '</td></tr>'  ,
                            TemplateType: sectionData.TemplateType
                        });
                    RadPreScreen.H6_Section_prog_shunt =
                        sectionObj.generateHTML(CC_CssBehavior);
                    sectionData.SectionDivID = sectionObj.SectionDivID;
                }
            },
            processH5_Section_CurPatProblems: function () {
                var sectionObj = htmlSecCtl.neo(),
                    sectionData = CC_SectMgt.H5_Sec_CurPatProblems;
                sectionObj.resetValues(sectionObj);
                sectionObj.initValues(
                    {
                        idLabel: 'H5_Sec_CurPatProblems',
                        TLabel1: 'Current Radiology GA Precautions',
                        SectionClosed: 'auto',
                        SectionCntVal: sectionData.Count,
                        ContentBody: '<table>' +
                        sectionData.Body +
                        '</td></tr>'  + '</table>'  +
                        RadPreScreen.H6_Section_prog_shunt,
                        TemplateType: sectionData.TemplateType
                    });
                RadPreScreen.H5_Section_CurPatProblems =
                    sectionObj.generateHTML(CC_CssBehavior);
                sectionData.SectionDivID = sectionObj.SectionDivID;
            },
            processH5_Section_HistPatProblems: function () {
                var sectionObj = htmlSecCtl.neo(),
                    sectionData = CC_SectMgt.H5_Sec_HistPatProblems;
                sectionObj.resetValues(sectionObj);
                sectionObj.initValues(
                    {
                        idLabel: 'H5_Sec_HistPatProblems',
                        TLabel1: 'Historical Radiology GA Precautions',
                        SectionClosed: 'auto',
                        SectionCnt: 'auto',
                        SectionCntVal: sectionData.Count,
                        ContentBody: '<table class="header"><tr><th class="col-1">&nbsp;&nbsp;&nbsp;&nbsp;Problem</th>' +
                        '<th class="col-2">Date/Time</th>' +
                        '<th class="col-3">Service/Dept&nbsp;&nbsp;&nbsp;&nbsp;</th>' +
                        sectionData.Body +  '</table>' ,
                        TemplateType: sectionData.TemplateType
                    });
                RadPreScreen.H5_Section_HistPatProblems =
                    sectionObj.generateHTML(CC_CssBehavior);
                sectionData.SectionDivID = sectionObj.SectionDivID;
            },
            processCcInstance: function () {
                compContent = gFuncs.parseTemplate(RadPreScreen.CC_Tmpls.mainDiv.join(''), {
                    cc_id: RadPreScreen.cc_id,
                    mainSection: RadPreScreen.mainSection,
                    H5_Section_CurPatProblems: RadPreScreen.H5_Section_CurPatProblems,
                    H5_Section_HistPatProblems: RadPreScreen.H5_Section_HistPatProblems,
                    mainSectionEnd: RadPreScreen.mainSectionEnd
                });
                gFuncs.Log_CC( component, compContent);
                target.innerHTML = compContent;
            },
            processCcCssSectionBehavior1: function () {
                htmlSecCtlObj.initToggle(CC_CssBehavior,CC_SectMgt.H5_Sec_CurPatProblems);
            },
            processCcCssSectionBehavior2: function () {
                htmlSecCtlObj.initToggle(CC_CssBehavior,CC_SectMgt.H5_Sec_HistPatProblems);
            },
            init: function () {
                var subHeaderDisplay,
                    initSecData;

                elementObj = component.data.RPTDATA;
                target = component.getTarget();

                component.eApps = {
                    cc_id: component.name.replace('.', '_'),
                    CSSBehaviors: chla.eApps.gCSSBehaviors.neo(),
                    TestSAP: null
                };
                RadPreScreen.initOnly = ChlaStdClass.safeRead( chla,'eApps','operationMode') == 'test' ||
                    ChlaStdClass.safeRead( chla,'eApps','RadPreScreen','operationMode') == 'RadPreScreenTest' ;
                RadPreScreen.cc_id = component.eApps.cc_id;
                RadPreScreen.personId = component.getProperty("personId");
                RadPreScreen.encounterId = component.getProperty("encounterId");
                RadPreScreen.prsnlId = component.getProperty("userId");
                component.eApps.TestSAP= RadPreScreen.TestServiceAccessPoint;
                htmlSecCtl = chlaNsMgr.aliasDirector('chla.eApps.Html.SectionHeaderCtl');
                htmlSecCtlData = chlaNsMgr.aliasDirector('chla.eApps.Html.SectionData');
                htmlSecCtlObj = htmlSecCtl.neo();
                initSecData = htmlSecCtlData.neo();

                CC_SectMgt = RadPreScreen.CC_SectionManagement;
                SectionCfg = [
                    // H5 Sections
                    {T_type: 'H5',SecId: 'CurPatProblems', TLblId: 'Cardiology',    SecClsd: 'opened',SecLvl:'H5'},
                    {T_type: 'H5',SecId: 'HistPatProblems',TLblId: 'Endocrinology', SecClsd: 'opened',SecLvl:'H5'},
                    {T_type: 'H6',SecId: 'prog_shunt',TLblId: 'Programmable Shunt', SecClsd: 'opened',SecLvl:'H6'}
                ];
                CC_SectMgt.sectionlist = initSecData.Section_config(SectionCfg,CC_SectMgt);
                CC_CssBehavior = component.eApps.CSSBehaviors;

                gFuncs = chlaNsMgr.aliasDirector('chla.eApps.gFuncs');
            },
            TestServiceAccessPoint: function (){
                return {
                    TestProcessRPTDATA_main: RadPreScreen.processRPTDATA_main_data,
                    TestProcessH5_Sec_CurPatProblems_data: RadPreScreen.processH5_Sec_CurPatProblems_data,
                    TestProcessH5_Sec_HistPatProblems_data: RadPreScreen.processH5_Sec_HistPatProblems_data,
                    TestProcessH5_Section_CurPatProblems: RadPreScreen.processH5_Section_CurPatProblems,
                    TestProcessH5_Section_HistPatProblems: RadPreScreen.processH5_Section_HistPatProblems,
                    TestProcessCcInstance: RadPreScreen.processCcInstance,
                    TestProcessCcCssSectionBehavior_1: RadPreScreen.processCcCssSectionBehavior1,
                    TestProcessCcCssSectionBehavior_2: RadPreScreen.processCcCssSectionBehavior2
                };
            }
        };
    RadPreScreen.init();
    if (RadPreScreen.initOnly == false) {
        RadPreScreen.processRPTDATA_main_data();
        RadPreScreen.processH5_Sec_CurPatProblems_data();
        RadPreScreen.processH5_Sec_HistPatProblems_data();
        RadPreScreen.processH6_Section_prog_shunt();
        RadPreScreen.processH5_Section_CurPatProblems();
        RadPreScreen.processH5_Section_HistPatProblems();
        RadPreScreen.processCcInstance();
        RadPreScreen.processCcCssSectionBehavior1();
        RadPreScreen.processCcCssSectionBehavior2();
    }

};
chla.RadReports = function () { };
chla.RadReports.prototype = new MPage.Component();
chla.RadReports.prototype.constructor = MPage.Component;
chla.RadReports.prototype.base = MPage.Component.prototype;
chla.RadReports.prototype.name = "chla.RadReports";
chla.RadReports.prototype.cclProgram = "chla_ca_mp_cc_rad_reports_json"; //_CCL_init_
chla.RadReports.prototype.cclParams = [];
chla.RadReports.prototype.cclDataType = "JSON";
chla.RadReports.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("personId");
    this.cclParams[2] = this.getProperty("userId");
};

chla.RadReports.prototype.render = function () {
    var component = this,
        elementObj,
        target,
        compContent;
    var CC_SectMgt = null,
        CC_CssBehavior = null,
        gFuncs = null,
        htmlSecCtl = null,
        htmlSecCtlObj = null,
        htmlSecCtlData = null,
        CclReqObjSave = null,
        RadReports = {
            initOnly: false,
            cc_id: 'x',
            personId: 0,
            encounterId: 0,
            prsnlId: 0,
            transparentSpacer: '',
            CC_SectionManagement: {
                sectionlist: []
            },
            mainSection: '',
            mainSectionEnd:'',
            //H5_Section_Orders:'',
            //H5_Section_PulmPulm:'',
            //H5_Section_EEGNeuro:'',
            //H5_Section_StressTests:'',
            //H5_Section_MiscTests:'',
            H5_Section_RO:'',
            H5_Section_OperativeRO:'',
            CC_Tmpls: {
                mainDiv: [
                    '<div id="<#=cc_id#>" class="eapps_CC">',
                    '<#=mainSection#>',
                    '<#=H5_Section_RO#>',
                    '<#=H5_Section_OperativeRO#>',
                    '<#=mainSectionEnd#>',
                    '</div>'
                ],
                ResultsRow_results : [
                    '<tr class="popuprow <#=ROWODDS#>" tip="Performed by: <#=PERFORMED_BY#><br/>Performed on: <#=PERFORMED_DT_TM#>"><td><#=EVENT_END_DATE#></td>',
                    '<td><a onclick="chla.eApps.gFuncs.ReadOnlyMPageUtils(&quot;POWERNOTE&quot;,',
                    '<#=personId#>,<#=encounterId#>,<#=EVENT_ID#>);">',
                    '<#=EVENT_TITLE_TEXT#></a></td>',
                    '<td><#=STATUS#></td></tr>'
                ],
                ResultsRow_header: [
                    '<table class="header"><tr width="100%">',
                    '<th width="25%" class="col-1">Date</th>',
                    '<th width="50%" class="col-2">Description</th>',
                    '<th width="25%" class="col-3">Status</th></tr>',
                    '<#=ResultsRow_body#></table>'
                ],
                Additional_Template1: []
            },

            processH5_Sec_All_data: function (dataObj, sectObjLst) {
                var i,j,listmain, listlen,
                    sectionName,
                    ResultsObj,
                    sectionObj;
                for (j= 0 ,listmain = sectObjLst.sectionlist.length; j < listmain; j ++ ){
                    sectionName = sectObjLst.sectionlist[j];
                    sectionObj = sectObjLst[sectionName];
                    sectionObj.Count = 0;
                    sectionObj.Body = '';
                    listlen = 0;
                    ResultsObj= null;
                    if (sectionName == 'H5_Sec_RO'){
                        listlen = (typeof dataObj.RESULT_CNT == 'undefined')? 0 : dataObj.RESULT_CNT;
                        ResultsObj = (typeof dataObj.RESULTS == 'undefined')? 0 : dataObj.RESULTS;
                    } else if (sectionName == 'H5_Sec_OperativeRO'){
                        listlen = (typeof dataObj.RESULT_CNT == 'undefined')? 0 : dataObj.OP_RESULT_CNT;
                        ResultsObj = (typeof dataObj.RESULTS == 'undefined')? 0 : dataObj.OP_RESULTS;
                    }
                    for ( i = 0; i < listlen; i++ ){
                        sectionObj.Count += 1;
                        sectionObj.Body += gFuncs.parseTemplate(RadReports.CC_Tmpls.ResultsRow_results.join(''), {
                            personId:          RadReports.personId,
                            encounterId:       RadReports.encounterId,
                            EVENT_ID:          ResultsObj[i].EVENT_ID,
                            EVENT_END_DATE:    ResultsObj[i].EVENT_END_DATE,
                            EVENT_TITLE_TEXT:  ResultsObj[i].EVENT_DISP,
                            STATUS:            ResultsObj[i].STATUS,
                            PERFORMED_BY:      ResultsObj[i].PERFORMED_BY,
                            PERFORMED_DT_TM:   ResultsObj[i].PERFORMED_DT_TM,
                            ROWODDS:           (i % 2 == 0 ? '' : 'odd')
                        });
                    }
                }
            },
            processH5_Section_All: function (sectObjLst) {
                var i,j,listmain, listlen,
                    wrkValue,
                    sectionData,
                    sectionObj = htmlSecCtl.neo();
                for (j= 0 ,listmain = sectObjLst.sectionlist.length; j < listmain; j ++ ){
                    sectionData = sectObjLst[sectObjLst.sectionlist[j]];
                    sectionObj.initValues(
                        {
                            idLabel: 'H5_Sec_' + sectionData.SectionID,
                            TLabel1: sectionData.TLabel1,
                            SectionCntVal: sectionData.Count,
                            ContentBody: gFuncs.parseTemplate(RadReports.CC_Tmpls.ResultsRow_header.join(''),
                                {
                                    ResultsRow_body: sectionData.Body
                                }
                            ),
                            TemplateType: sectionData.TemplateType
                        });
                    wrkValue = 'H5_Section_' + sectionData.SectionID ;
                    RadReports[wrkValue] =
                        sectionObj.generateHTML(CC_CssBehavior);
                    sectionData.SectionDivID = sectionObj.SectionDivID;
                }
            },
            processCcInstance: function () {
                compContent = gFuncs.parseTemplate(RadReports.CC_Tmpls.mainDiv.join(''), {
                    cc_id: RadReports.cc_id,
                    mainSection: RadReports.mainSection,
                    H5_Section_RO: RadReports.H5_Section_RO,
                    H5_Section_OperativeRO: RadReports.H5_Section_OperativeRO,
                    mainSectionEnd: RadReports.mainSectionEnd
                    //...
                });
                gFuncs.Log_CC( component, compContent);
                target.innerHTML = compContent;
            },
            processCcCssSectionBehaviors: function (sectObjLst) {
                var i,j,listmain, listlen,
                    sectionName,sectionData;
                for (j= 0 ,listmain = sectObjLst.sectionlist.length; j < listmain; j ++ ){
                    sectionName = sectObjLst.sectionlist[j];
                    sectionData = sectObjLst[sectionName];
                    htmlSecCtlObj.initToggle(CC_CssBehavior,sectionData);
                }
            },
            processCcCssControlBehaviors: function () {
                CC_CssBehavior.InitPopUpsZstripe('div#chla_RadReports tr.popuprow') ;
            },
            init: function () {
                var subHeaderDisplay,
                    wrkValue,
                    SectionCfg;

                elementObj = component.data.RPTDATA;
                target = component.getTarget();

                component.eApps = {
                    cc_id: component.name.replace('.', '_'),
                    CSSBehaviors: chla.eApps.gCSSBehaviors.neo(),
                    TestSAP: null
                };
                RadReports.initOnly = ChlaStdClass.safeRead( chla,'eApps','operationMode') == 'test' ||
                    ChlaStdClass.safeRead( chla,'eApps','RadReports','operationMode') == 'RadReportsTest' ;
                RadReports.cc_id = component.eApps.cc_id;
                RadReports.personId = component.getProperty("personId");
                RadReports.encounterId = component.getProperty("encounterId");
                RadReports.prsnlId = component.getProperty("userId");
                component.eApps.TestSAP= RadReports.TestServiceAccessPoint;
                htmlSecCtl = chlaNsMgr.aliasDirector('chla.eApps.Html.SectionHeaderCtl');
                htmlSecCtlData = chlaNsMgr.aliasDirector('chla.eApps.Html.SectionData');
                htmlSecCtlObj = htmlSecCtl.neo();
                CC_SectMgt = RadReports.CC_SectionManagement;
                SectionCfg = [
                    // H5 Sections
                    {T_type: 'H5',SecId: 'RO',TLblId: 'Reports', SecClsd: 'auto',SecLvl:'H5'},
                    {T_type: 'H5',SecId: 'OperativeRO',TLblId: 'Operative Reports', SecClsd: 'auto',SecLvl:'H5'},
                    //{T_type: 'H5',SecId: 'PolyPulm',TLblId: 'Polysomnography  - Pulm', SecClsd: 'auto',SecLvl:'H5'},
                    //{T_type: 'H5',SecId: 'PulmPulm',TLblId: 'Pulmonary Function Tests - Pulm', SecClsd: 'auto',SecLvl:'H5'},
                    //{T_type: 'H5',SecId: 'EEGNeuro',TLblId: 'EEG - Neuro', SecClsd: 'auto',SecLvl:'H5'},
                    //{T_type: 'H5',SecId: 'StressTests',TLblId: 'Stress Tests', SecClsd: 'auto',SecLvl:'H5'},
                    //{T_type: 'H5',SecId: 'MiscTests',TLblId: 'Cultures-blood , urine , swabs, Influenza, ...', SecClsd: 'auto',SecLvl:'H5'}
                ];
                for ( i = 0, listlen = SectionCfg.length; i < listlen; i++){
                    wrkValue = SectionCfg[i].SecLvl + '_Sec_' + SectionCfg[i].SecId ;
                    CC_SectMgt[wrkValue] = htmlSecCtlData.neo(
                        SectionCfg[i].T_type ,
                        SectionCfg[i].SecId ,
                        SectionCfg[i].TLblId ,
                        SectionCfg[i].SecClsd ,
                        SectionCfg[i].SecLvl
                    ) ;
                    CC_SectMgt.sectionlist.push(wrkValue);
                }
                CC_CssBehavior = component.eApps.CSSBehaviors;

                gFuncs = chlaNsMgr.aliasDirector('chla.eApps.gFuncs');
            },
            TestServiceAccessPoint: function (){
                return {

                    TestProcessH5_Sec_All_data: RadReports.processH5_Sec_All_data,
                    TestProcessH5_Section_All: RadReports.processH5_Section_All,
                    TestProcessCcInstance: RadReports.processCcInstance,
                    TestProcessCcCssSectionBehaviors: RadReports.processCcCssSectionBehaviors,
                    TestProcessCcCssControlBehaviors: RadReports.processCcCssControlBehaviors
                };
            }
        };
    RadReports.init();
    if (RadReports.initOnly == false) {

        RadReports.processH5_Sec_All_data(elementObj, CC_SectMgt);
        RadReports.processH5_Section_All(CC_SectMgt);
        RadReports.processCcInstance();
        RadReports.processCcCssSectionBehaviors(CC_SectMgt);
        RadReports.processCcCssControlBehaviors();
    }
};
chla.RadAppts = function () { };
chla.RadAppts.prototype = new MPage.Component();
chla.RadAppts.prototype.constructor = MPage.Component;
chla.RadAppts.prototype.base = MPage.Component.prototype;
chla.RadAppts.prototype.name = "chla.RadAppts";
chla.RadAppts.prototype.cclProgram = "chla_ca_mp_radnp_appt_json"; //_CCL_init_
chla.RadAppts.prototype.cclParams = [];
chla.RadAppts.prototype.cclDataType = "JSON";
chla.RadAppts.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("personId");
    this.cclParams[2] = this.getProperty("encounterId");
    this.cclParams[3] = this.getProperty("userId");

};

chla.RadAppts.prototype.render = function () {
    var component = this,
        elementObj,
        target,
        compContent;
    var CC_SectMgt = null,
        CC_CssBehavior = null,
        gFuncs = null,
        htmlSecCtl = null,
        htmlSecCtlObj = null,
        htmlSecCtlData = null,
        CclReqObjSave = null,
        RadAppts = {
            initOnly: false,
            cc_id: 'x',
            personId: 0,
            encounterId: 0,
            prsnlId: 0,
            transparentSpacer: '',

            CC_SectionManagement:  {
                sectionlist:[]
            },
            mainSection: '',
            mainSectionEnd:'',
            H5_Section_CC: '',
            H5_Section_PU: '',
            H5_Section_EN: '',
            mainSectionEnd: '',
            CC_Tmpls: {
                mainDiv: [
                    '<div id="<#=cc_id#>" class="eapps_CC">',
                    '<#=mainSection#>',
                    '<#=H5_Section_CC#>',
                    '<#=H5_Section_EN#>',
                    '<#=H5_Section_PU#>',
                    '<#=mainSectionEnd#>',
                    '</div>'
                ],
                rowResultsbody: [ '<div style="clear:both;">',
                    '<table class="header"><tr><th class="col-1" style="min-width:100px;width: 30%;">Appt Type</th>',
                    '<th class="col-2"  style="min-width:105px;width: 20%;" >Date</th>',
                    '<th class="col-3" style="min-width:100px;width: 30%;" >Location</th>',
                    '<th class="col-4" style="min-width:40px;width: 20%;" >Resource</th></tr>',
                    '<#=SectBody#></table></div>'
                ],
                rowResults: ['<tr <#=ROWODDS#> ><td><#=apptype#></td><td><#=apptime#></td><td><#=location#></td><td><#=resource#></td></tr>'
                ],
                Additional_Template1: []
            },
            processRPTDATA_main_data: function (dataObj, sectObjLst) {
                var i, listlen, locStr;
                RadAppts.mainSection= '&nbsp;&nbsp;&nbsp;<span style="font-size: 9px; color: grey">* - Max of 5 Appts Displayed</span>';
                // Call PV  ; Call FV

                if( typeof dataObj.SLEEP_STUDY_PREVIOUS_VISIT_CNT == 'undefined' ) dataObj.SLEEP_STUDY_PREVIOUS_VISIT_CNT = 0 ;
                sectObjLst['H7X_Sec_SSPV'].PV = (dataObj.SLEEP_STUDY_PREVIOUS_VISIT_CNT == 0 )? [] : dataObj.SLEEP_STUDY_PREVIOUS_VISITS;

                if( typeof dataObj.SLEEP_STUDY_FUTURE_VISIT_CNT == 'undefined' ) dataObj.SLEEP_STUDY_FUTURE_VISIT_CNT = 0 ;
                sectObjLst['H7X_Sec_SSFV'].FV = (dataObj.SLEEP_STUDY_FUTURE_VISIT_CNT == 0 )? [] : dataObj.SLEEP_STUDY_FUTURE_VISITS;

                if( typeof dataObj.CRD_PREVIOUS_VISIT_CNT == 'undefined' ) dataObj.CRD_PREVIOUS_VISIT_CNT = 0 ;
                sectObjLst['H6_Sec_CCPV'].PV = (dataObj.CRD_PREVIOUS_VISIT_CNT == 0 )? [] : dataObj.CRD_PREVIOUS_VISITS;

                if( typeof dataObj.CRD_FUTURE_VISIT_CNT == 'undefined' ) dataObj.CRD_FUTURE_VISIT_CNT = 0 ;
                sectObjLst['H6_Sec_CCFV'].FV = (dataObj.CRD_FUTURE_VISIT_CNT == 0 )? [] : dataObj.CRD_FUTURE_VISITS;

                if( typeof dataObj.PULM_PREVIOUS_VISIT_CNT == 'undefined' ) dataObj.PULM_PREVIOUS_VISIT_CNT = 0 ;
                sectObjLst['H6_Sec_PUPV'].PV = (dataObj.PULM_PREVIOUS_VISIT_CNT == 0 )? [] : dataObj.PULM_PREVIOUS_VISITS;

                if( typeof dataObj.PULM_FUTURE_VISIT_CNT == 'undefined' ) dataObj.PULM_FUTURE_VISIT_CNT = 0 ;
                sectObjLst['H6_Sec_PUFV'].FV = (dataObj.PULM_FUTURE_VISIT_CNT == 0 )? [] : dataObj.PULM_FUTURE_VISITS;

                if( typeof dataObj.ENDO_PREVIOUS_VISIT_CNT == 'undefined' ) dataObj.ENDO_PREVIOUS_VISIT_CNT = 0 ;
                sectObjLst['H6_Sec_ENPV'].PV = (dataObj.ENDO_PREVIOUS_VISIT_CNT == 0 )? [] : dataObj.ENDO_PREVIOUS_VISITS;

                if( typeof dataObj.ENDO_FUTURE_VISIT_CNT == 'undefined' ) dataObj.ENDO_FUTURE_VISIT_CNT = 0 ;
                sectObjLst['H6_Sec_ENFV'].FV = (dataObj.ENDO_FUTURE_VISIT_CNT == 0 )? [] : dataObj.ENDO_FUTURE_VISITS;
            },
            processH6_Sec_ALL_data: function (sectObjLst, tmpl) {
                var sectionObj,
                    i,j,k, listlen, listlen2,
                    temparr = [],
                    oddEvenFlag,
                    utemparr = [];
                for (i = 0, listlen = sectObjLst.sectionlist.length; i< listlen ;i++ ){
                    sectionObj = sectObjLst[sectObjLst.sectionlist[i]];
                    if (sectionObj.SectionLevel.toUpperCase()== 'H6' ) {
                        sectionObj.Count = 0;
                        sectionObj.Body= '';
                        if (typeof sectionObj.FV == 'undefined' ){
                            utemparr = sectionObj.PV;
                            temparr = utemparr.sort( function(a,b){
                                if ( a.BEG_DT_TM < b.BEG_DT_TM )
                                    return 1;
                                if ( a.BEG_DT_TM > b.BEG_DT_TM )
                                    return -1;
                                return 0;} );
                        } else {
                            utemparr = sectionObj.FV;
                            temparr = utemparr.sort( function(a,b){
                                if ( a.BEG_DT_TM < b.BEG_DT_TM )
                                    return -1;
                                if ( a.BEG_DT_TM > b.BEG_DT_TM )
                                    return 1;
                                return 0;} );
                        }
                        listlen2 = temparr.length;
                        if (typeof sectionObj.FV == 'undefined' ){
                            listlen2 = (temparr.length >= 5 )? 5: temparr.length;
                        }
                        for(k=0; k < listlen2; k++){
                            oddEvenFlag = (k % 2 == 0? '' : 'class="odd"');
                            sectionObj.Body +=gFuncs.parseTemplate(tmpl, {
                                apptype: temparr[k].TYPE,
                                apptime: temparr[k].BEG_DT_TM,
                                location:temparr[k].LOCATION,
                                resource:temparr[k].RESOURCE,
                                ROWODDS:  oddEvenFlag
                            });
                            sectionObj.Count += 1;
                        }
                    }
                }
                j=0;
            },
            processH7X_Sec_ALL_data: function (sectObjLst, tmpl) {
                var sectionObj,
                    i,j,k, listlen, listlen2,
                    temparr = [],
                    oddEvenFlag,
                    utemparr = [];
                for (i = 0, listlen = sectObjLst.sectionlist.length; i< listlen ; i++ ){
                    sectionObj = sectObjLst[sectObjLst.sectionlist[i]];
                    if (sectionObj.SectionLevel.toUpperCase()== 'H7X' ) {
                        sectionObj.Count = 0;
                        sectionObj.Body= '';
                        if (typeof sectionObj.FV == 'undefined' ){
                            utemparr = sectionObj.PV;
                            temparr = utemparr.sort( function(a,b){
                                if ( a.BEG_DT_TM < b.BEG_DT_TM )
                                    return -1;
                                if ( a.BEG_DT_TM > b.BEG_DT_TM )
                                    return 1;
                                return 0;} );
                        } else {
                            utemparr = sectionObj.FV;
                            temparr = utemparr.sort( function(a,b){
                                if ( a.BEG_DT_TM < b.BEG_DT_TM )
                                    return 1;
                                if ( a.BEG_DT_TM > b.BEG_DT_TM )
                                    return -1;
                                return 0;} );

                        }
                        listlen2 = temparr.length;
                        if (typeof sectionObj.FV == 'undefined' ){
                            listlen2 = (temparr.length >= 5 )? 5: temparr.length;
                        }
                        for(k=0; k < listlen2; k++){
                            oddEvenFlag = (k % 2 == 0? '' : 'class="odd"');
                            sectionObj.Body +=gFuncs.parseTemplate(tmpl, {
                                apptype: temparr[k].TYPE,
                                apptime: temparr[k].BEG_DT_TM,
                                location:temparr[k].LOCATION,
                                resource:temparr[k].RESOURCE,
                                ROWODDS:  oddEvenFlag
                            });
                            sectionObj.Count += 1;
                        }
                    }
                }
                j=0;
            },
            processH6_Section_ALL: function (sectObjLst,tmpl) {
                var sectionObj = htmlSecCtl.neo(),
                    i,j,k, listlen,sectionData;
                for (i = 0, listlen = sectObjLst.sectionlist.length; i< listlen ; i++ ){
                    sectionData = sectObjLst[sectObjLst.sectionlist[i]];
                    if (sectionData.SectionLevel.toUpperCase()== 'H6') {
                        sectionObj.resetValues(sectionObj);
                        sectionObj.initValues(
                            {
                                idLabel: ('H6_Sec_' + sectionData.SectionID),
                                TLabel1: sectionData.TLabel1,
                                SectionClosed: sectionData.SectionClosed,
                                defaultHeight: '',
                                Disabled_Lbl: 'auto',
                                SectionCnt: ' (' + sectionData.Count + ')' +
                                ((sectionData.SectionID.indexOf('PV') > -1)? ' *' : ''),
                                SectionCntVal: sectionData.Count,
                                ContentBody:gFuncs.parseTemplate(tmpl, {
                                    SectBody: sectionData.Body
                                }) ,
                                TemplateType: sectionData.TemplateType
                            });
                        sectionData.FmtSectionBody =
                            sectionObj.generateHTML(CC_CssBehavior);
                        sectionData.SectionDivID = sectionObj.SectionDivID;
                    }
                }
                j=0;
            },

            processH7X_Section_ALL: function (sectObjLst,tmpl) {
                var sectionObj = htmlSecCtl.neo(),
                    i,j,k, listlen,
                    hdrTmpl = [
                        '<span class="sub-sec-title  <#=Disabled_Lbl#> " style="margin-right:0px;"><span><#=TLabel1#></span>',
                        '<span class="sub-sec-total" style="padding-left: 3px; margin-top: 5px;"><#=SectionCnt#></span></span>'
                    ],
                    sectionData;

                for (i = 0, listlen = sectObjLst.sectionlist.length; i< listlen ; i++ ){
                    sectionData = sectObjLst[sectObjLst.sectionlist[i]];
                    if (sectionData.SectionLevel.toUpperCase()== 'H7X') {
                        sectionObj.resetValues(sectionObj);
                        sectionObj.initValues(
                            {
                                idLabel: ('H7X_Sec_' + sectionData.SectionID),
                                HdrCss: 'sub-sec',
                                OvrrdHdrCss:'',
                                hovertip: '',
                                tip: '',
                                HdrLayout: gFuncs.parseTemplate(hdrTmpl.join(''), {
                                    TLabel1: sectionData.TLabel1 ,
                                    Disabled_Lbl: ((sectionData.Count == 0)? 'grey':''),
                                    SectionCntVal: sectionData.Count,
                                    SectionCnt: ' (' + sectionData.Count +')' +
                                    ((sectionData.SectionID.indexOf('PV') > -1)? ' *' : ''),
                                }) ,
                                OvrrdContentBodyCss: '',
                                CustMargin: 'margin-left: 28px;',
                                OvrrdHdrStyle:  'style="background-color:#D6DEDF;"', //#ADD8E6;"',  E3F0EF
                                SubSecContentStyle: '',                              // ="float:clear"
                                fo_cat_type: '',                                     // 'fo-cat-type' value H5 with H6 without
                                defaultHeight: '',
                                Disabled_Lbl: 'auto',
                                SectionClosed: sectionData.SectionClosed,
                                SectionCntVal: sectionData.Count,
                                ContentBody:gFuncs.parseTemplate(tmpl, {
                                    SectBody: sectionData.Body
                                }) ,
                                TemplateType: 'eApps_panel'
                            });
                        sectionData.FmtSectionBody =
                            sectionObj.generateHTML(CC_CssBehavior);
                        sectionData.SectionDivID = sectionObj.SectionDivID;
                    }
                }
                j=0;
            },
            processH6X_Section_ALL: function (sectObjLst) {
                var sectionObj = htmlSecCtl.neo(),
                    i,j,k, listlen,
                    sectionData;
                for (i = 0, listlen = sectObjLst.sectionlist.length; i< listlen ; i++ ){
                    sectionData = sectObjLst[sectObjLst.sectionlist[i]];
                    if (sectionData.SectionLevel.toUpperCase()== 'H6X') {
                        sectionObj.resetValues(sectionObj);
                        sectionObj.initValues(
                            {
                                idLabel: ('H6X_Sec_' + sectionData.SectionID),
                                TLabel1: sectionData.TLabel1,
                                defaultHeight: '',
                                SectionClosed: 'opened',
                                SectionCnt: '',
                                CustIcon: 'none',
                                Disabled_Lbl: 'auto',
                                SectionCntVal: 1,
                                ContentBody: sectObjLst.H7X_Sec_SSFV.FmtSectionBody +
                                sectObjLst.H7X_Sec_SSPV.FmtSectionBody,
                                TemplateType: 'H6'
                            });
                        sectionData.FmtSectionBody =
                            sectionObj.generateHTML(CC_CssBehavior);
                        sectionData.SectionDivID = sectionObj.SectionDivID;
                    }
                }
                j=0;
            },
            processH5_Section_ALL: function (sectObjLst) {
                var sectionObj = htmlSecCtl.neo(),
                    i,j,k, listlen,
                    wrkValue, sectionData;
                for (i = 0, listlen = sectObjLst.sectionlist.length;  i< listlen ;i++ ){
                    sectionData = sectObjLst[sectObjLst.sectionlist[i]];
                    if (sectionData.SectionLevel.toUpperCase()== 'H5') {
                        if (sectionData.SectionID == 'CC'){
                            wrkValue = sectObjLst.H6_Sec_CCFV.FmtSectionBody +
                                sectObjLst.H6_Sec_CCPV.FmtSectionBody;
                        }else if (sectionData.SectionID == 'EN'){
                            wrkValue = sectObjLst.H6_Sec_ENFV.FmtSectionBody +
                                sectObjLst.H6_Sec_ENPV.FmtSectionBody;
                        }else if (sectionData.SectionID == 'PU'){
                            wrkValue = sectObjLst.H6_Sec_PUFV.FmtSectionBody +
                                sectObjLst.H6_Sec_PUPV.FmtSectionBody +
                                sectObjLst.H6X_Sec_SS.FmtSectionBody;
                        }
                        sectionObj.resetValues(sectionObj);
                        sectionObj.initValues(
                            {
                                idLabel: ('H5_Sec_' + sectionData.SectionID),
                                TLabel1: sectionData.TLabel1,
                                defaultHeight: '',
                                SectionClosed: 'opened',
                                SectionCnt: '',
                                SectionCntVal: 1,
                                Disabled_Lbl: 'auto',
                                CustIcon: 'none',
                                ContentBody:  wrkValue,
                                TemplateType: sectionData.TemplateType
                            });
                        wrkValue = 'H5_Section_' + sectionData.SectionID;
                        RadAppts[wrkValue] =
                            sectionObj.generateHTML(CC_CssBehavior);
                        sectionData.SectionDivID = sectionObj.SectionDivID;
                    }
                }
            },
            processCcInstance: function () {
                compContent = gFuncs.parseTemplate(RadAppts.CC_Tmpls.mainDiv.join(''), {
                    cc_id:          RadAppts.cc_id,
                    mainSection:    RadAppts.mainSection,
                    H5_Section_CC:  RadAppts.H5_Section_CC,
                    H5_Section_EN:  RadAppts.H5_Section_EN,
                    H5_Section_PU:  RadAppts.H5_Section_PU,
                    mainSectionEnd: RadAppts.mainSectionEnd
                });
                gFuncs.Log_CC( component, compContent);
                target.innerHTML = compContent;
            },
            processCcCssSectionBehaviors: function (sectObjLst) {
                var sectionObj = htmlSecCtl.neo(),
                    i,j,k, listlen,
                    wrkValue, sectionData;
                for (i = 0, listlen = sectObjLst.sectionlist.length;  i< listlen ;i++ ){
                    sectionData = sectObjLst[sectObjLst.sectionlist[i]];
                    if (sectionData.SectionLevel.toUpperCase()== 'H6') {
                        htmlSecCtlObj.initToggle(CC_CssBehavior,sectionData);
                    }else if (sectionData.SectionLevel.toUpperCase()== 'H7X') {
                        htmlSecCtlObj.initToggle(CC_CssBehavior,sectionData);
                    }
                }

            },
            init: function () {
                var subHeaderDisplay,
                    wrkValue, i, listlen,
                    SectionCfg,
                    initSecData;

                elementObj = component.data.RPTDATA;
                target = component.getTarget();

                component.eApps = {
                    cc_id: component.name.replace('.', '_'),
                    CSSBehaviors: chla.eApps.gCSSBehaviors.neo(),
                    TestSAP: null
                };
                RadAppts.initOnly = ChlaStdClass.safeRead( chla,'eApps','operationMode') == 'test' ||
                    ChlaStdClass.safeRead( chla,'eApps','RadAppts','operationMode') == 'RadApptsTest' ;
                RadAppts.cc_id = component.eApps.cc_id;
                RadAppts.personId = component.getProperty("personId");
                RadAppts.encounterId = component.getProperty("encounterId");
                RadAppts.prsnlId = component.getProperty("userId");
                component.eApps.TestSAP= RadAppts.TestServiceAccessPoint;
                htmlSecCtl = chlaNsMgr.aliasDirector('chla.eApps.Html.SectionHeaderCtl');
                htmlSecCtlData = chlaNsMgr.aliasDirector('chla.eApps.Html.SectionData');
                htmlSecCtlObj = htmlSecCtl.neo();
                initSecData = htmlSecCtlData.neo();

                CC_SectMgt = RadAppts.CC_SectionManagement;
                SectionCfg = [
                    // H5 Sections
                    {T_type: 'H5',SecId: 'CC',           TLblId: 'Cardiology',    SecClsd: 'opened',SecLvl:'H5'},
                    {T_type: 'H5',SecId: 'EN',           TLblId: 'Endocrinology', SecClsd: 'opened',SecLvl:'H5'},
                    {T_type: 'H5',SecId: 'PU',           TLblId: 'Pulmonary',     SecClsd: 'opened',SecLvl:'H5'},
                    // H6 Sections
                    {T_type: 'H6',SecId: 'CCPV',         TLblId: 'Past Visits',   SecClsd: 'auto',  SecLvl:'H6'},
                    {T_type: 'H6',SecId: 'CCFV',         TLblId: 'Future Visits', SecClsd: 'auto',  SecLvl:'H6'},
                    {T_type: 'H6',SecId: 'ENPV',         TLblId: 'Past Visits',   SecClsd: 'auto',  SecLvl:'H6'},
                    {T_type: 'H6',SecId: 'ENFV',         TLblId: 'Future Visits', SecClsd: 'auto',  SecLvl:'H6'},
                    {T_type: 'H6',SecId: 'PUPV',         TLblId: 'Past Visits',   SecClsd: 'auto',  SecLvl:'H6'},
                    {T_type: 'H6',SecId: 'PUFV',         TLblId: 'Future Visits', SecClsd: 'auto',  SecLvl:'H6'},
                    // eApps_panel Sections
                    {T_type: 'eApps_panel',SecId: 'SS',  TLblId: 'Sleep Study',   SecClsd: 'opened',SecLvl:'H6X'},
                    {T_type: 'eApps_panel',SecId: 'SSPV',TLblId: 'Past Visits',   SecClsd: 'auto',  SecLvl:'H7X'},
                    {T_type: 'eApps_panel',SecId: 'SSFV',TLblId: 'Future Visits', SecClsd: 'auto',  SecLvl:'H7X'},
                ];
                CC_SectMgt.sectionlist = initSecData.Section_config(SectionCfg,CC_SectMgt);
                CC_CssBehavior = component.eApps.CSSBehaviors;
                gFuncs = chlaNsMgr.aliasDirector('chla.eApps.gFuncs');
            },
            TestServiceAccessPoint: function (){
                return {
                    TestprocessRPTDATA_main_data: RadAppts.processRPTDATA_main_data,
                    TestprocessH6_Sec_ALL_data: RadAppts.processH6_Sec_ALL_data,
                    TestprocessH6_Section_ALL: RadAppts.processH6_Section_ALL,
                    TestprocessH5_Section_ALL: RadAppts.processH5_Section_ALL,
                    TestProcessCcInstance: RadAppts.processCcInstance,
                    TestProcessCcCssSectionBehaviors: RadAppts.processCcCssSectionBehaviors
                };
            }
        };
    RadAppts.init();
    if (RadAppts.initOnly == false) {
        RadAppts.processRPTDATA_main_data(elementObj,CC_SectMgt)
        RadAppts.processH6_Sec_ALL_data(CC_SectMgt, RadAppts.CC_Tmpls.rowResults.join('') );
        RadAppts.processH7X_Sec_ALL_data(CC_SectMgt, RadAppts.CC_Tmpls.rowResults.join('') );
        RadAppts.processH6_Section_ALL(CC_SectMgt, RadAppts.CC_Tmpls.rowResultsbody.join(''));
        RadAppts.processH7X_Section_ALL(CC_SectMgt, RadAppts.CC_Tmpls.rowResultsbody.join(''));
        RadAppts.processH6X_Section_ALL(CC_SectMgt, RadAppts.CC_Tmpls.rowResultsbody.join(''));
        RadAppts.processH5_Section_ALL(CC_SectMgt);
        RadAppts.processCcInstance(RadAppts);
        RadAppts.processCcCssSectionBehaviors(CC_SectMgt);
    }
};
chla.radnpnotes = function () { };
chla.radnpnotes.prototype = new MPage.Component();
chla.radnpnotes.prototype.constructor = MPage.Component;
chla.radnpnotes.prototype.base = MPage.Component.prototype;
chla.radnpnotes.prototype.name = "chla.radnpnotes";
chla.radnpnotes.prototype.cclProgram = "CHLA_CA_MP_CC_RADNPNOTES_JSON";
chla.radnpnotes.prototype.cclParams = [];
chla.radnpnotes.prototype.cclDataType = "JSON";
chla.radnpnotes.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("personId");
    this.cclParams[2] = this.getProperty("encounterId");
    this.cclParams[3] = this.getProperty("userId");
};

chla.radnpnotes.prototype.render = function () {
    var component = this,
        elementObj,
        target,
        compContent;
    var CC_SectMgt = null,
        CC_CssBehavior = null,
        gFuncs = null,
        htmlSecCtl = null,
        htmlSecCtlObj = null,
        htmlSecCtlData = null,
        CclReqObjSave = null,
        radnpnotes = {
            initOnly: false,
            cc_id: 'x',
            personId: 0,
            encounterId: 0,
            prsnlId: 0,
            transparentSpacer: '',
            CC_SectionManagement: {
                sectionlist: []
            },
            mainSection: '',
            mainSectionEnd:'',
            H5_Section_ClinicMDNotes: '',
            H5_Section_IPNotes: '',
            H5_Section_HPNotes: '',
            H5_Section_CRPIPC: '',
            H5_Section_EDPN: '',
            H6_Section_Pulm: '',
            H6_Section_Cardio: '',
            H6_Section_Endoc: '',
            H6_Section_Nuerol: '',
            H6_Section_Nueros: '',
            H6_Section_NephRen: '',
            H6_Section_HistPhy: '',
            H6_Section_PHistPhy: '',
            H6_Section_PIPDP: '',
            H6_Section_PORec: '',
            CC_Tmpls: {
                mainDiv: [
                    '<div id="<#=cc_id#>" class="eapps_CC">',
                    '<#=mainSection#>',
                    '<#=H5_Section_ClinicMDNotes#>',
                    '<#=H5_Section_IPNotes#>',
                    '<#=H5_Section_HPNotes#>',
                    '<#=H5_Section_CRPIPC#>',
                    '<#=H5_Section_EDPN#>',
                    '<#=mainSectionEnd#>',
                    '</div>'
                ],
                RowResults: [ '<tr <#=ROWODDS#> >',
                    '<td><#=eventdate#></td>',
                    '<td><a onclick="chla.eApps.gFuncs.ReadOnlyMPageUtils(&quot;POWERNOTE&quot;,',
                    '<#=personId#>,<#=encounterId#>,<#=eventId#>);">',
                    '<#=titleLbl#></a></td><td><#=authorby#></td></tr>'
                ],
                RowResultHdr : '<tr><th style="width:25%">Last Updated</th><th style="width:50%">Title</th><th style="width:25%">Author</th></tr>'
            },
            processH6_Sec_All_Data: function (dataObj, sectObj) {
                var i,j,lencnt,dataElement,
                    lentest,
                    listlen,
                    oddEvenFlag,
                    sectionData;
                for (j = 0 , lencnt = sectObj.sectionlist.length; j < lencnt; j++) {
                    sectionData = CC_SectMgt[CC_SectMgt.sectionlist[j]];
                    if (sectionData.SectionLevel == 'H6') {
                        sectionData.Count = 0;
                        sectionData.Body = '';
                        dataElement = null;
                        //H5 sectionData.SectionID: 'ClinicMDNotes  groups the clinic notes
                        lentest =  dataObj.PULM_CLINIC_NOTES_CNT
                        if( sectionData.SectionID == 'Pulm' &&  lentest > 0 ){
                            dataElement =  dataObj.PULM_CLINIC_NOTES ;
                            listlen = lentest;
                        }
                        lentest =  dataObj.CARDIO_CLINIC_NOTES_CNT;
                        if( sectionData.SectionID == 'Cardio' &&  lentest > 0 ){
                            dataElement =  dataObj.CARDIO_CLINIC_NOTES ;
                            listlen = lentest;
                        }
                        lentest = dataObj.ENDOCRN_CLINIC_NOTES_CNT;
                        if( sectionData.SectionID == 'Endoc' &&  lentest > 0 ){
                            dataElement =  dataObj.ENDOCRN_CLINIC_NOTES ;
                            listlen = lentest;
                        }
                        lentest = dataObj.NEURO_CLINIC_NOTES_CNT;
                        if( sectionData.SectionID == 'Nuerol' &&  lentest > 0 ){
                            dataElement =  dataObj.NEURO_CLINIC_NOTES ;
                            listlen = lentest;
                        }
                        lentest = dataObj.NEUROSURGERY_CLINIC_NOTES_CNT ;
                        if( sectionData.SectionID == 'Nueros' && lentest > 0 ){
                            dataElement =  dataObj.NEUROSURGERY_CLINIC_NOTES;
                            listlen = lentest;
                        }
                        lentest = dataObj.NEPHRO_CLINIC_NOTES_CNT ;
                        if( sectionData.SectionID == 'NephRen' &&  lentest > 0 ){
                            dataElement =  dataObj.NEPHRO_CLINIC_NOTES  ;
                            listlen = lentest;
                        }
                        //H5 sectionData.SectionID: 'IPNotes'       groups the PIPDP notes
                        if( sectionData.SectionID == 'PIPDP' ){
                            dataElement = [];
                            dataElement.push(dataObj.IP_DAILY_PROGRESS_NOTE);
                            listlen = dataElement[0].EVENT_ID == ''? 0 : 1;
                        }
                        if( sectionData.SectionID == 'HistPhy') {
                            dataElement = [];
                            dataElement.push(dataObj.HP_NOTE);
                            listlen = dataElement[0].EVENT_ID == ''? 0 : 1;
                        }
                        if( sectionData.SectionID == 'PHistPhy') {
                            dataElement = [];
                            dataElement.push(dataObj.PREOP_HP_NOTE);
                            listlen = dataElement[0].EVENT_ID == ''? 0 : 1;
                        }
                        if (dataElement == null){
                            listlen = 0;
                        }
                        for (i = 0 ; i < listlen ; i++){
                            oddEvenFlag = (i % 2 == 0? '' : 'class="odd"');
                            sectionData.Body += gFuncs.parseTemplate(radnpnotes.CC_Tmpls.RowResults.join(''),{
                                personId: radnpnotes.personId,
                                encounterId: radnpnotes.encounterId,
                                eventId: dataElement[i].EVENT_ID,
                                titleLbl: dataElement[i].EVENT_DISP,
                                authorby: dataElement[i].PERFORMED_BY,
                                eventdate: dataElement[i].EVENT_END_DATE,
                                ROWODDS: oddEvenFlag
                            });
                            sectionData.Count += 1;
                        }
                    }
                }
            },
            processH5_Sec_All_Data: function (dataObj, sectObj) {
                var i,j,lencnt,dataElement,
                    listlen,
                    oddEvenFlag,
                    sectionData;
                for (j = 0 , lencnt = sectObj.sectionlist.length; j < lencnt; j++)  {
                    sectionData = CC_SectMgt[CC_SectMgt.sectionlist[j]];
                    if (sectionData.SectionLevel == 'H5') {
                        sectionData.Body = '';
                        sectionData.Count = 0;
                        dataElement = null;
                        listlen = dataObj.CONSULTATION_REFERRALS_CNT ;
                        if( sectionData.SectionID == 'CRPIPC' && listlen > 0 ){
                            dataElement =  dataObj.CONSULTATION_REFERRALS  ;
                        }
                        if( sectionData.SectionID == 'EDPN'){
                            dataElement = [];
                            dataElement.push(dataObj.ED_PROVIDER_NOTE);
                            listlen = dataElement[0].EVENT_ID == ''? 0 : 1;
                        }
                        if( sectionData.SectionID == 'PORec') {
                            dataElement = [];
                            dataElement.push(dataObj.PERI_OPERATIVE_RECORD);
                            listlen = dataElement[0].EVENT_ID == ''? 0 : 1;
                        }
                        if (dataElement == null){
                            listlen = 0;
                        }
                        for (i = 0; i < listlen ; i++){
                            oddEvenFlag = (i % 2 == 0? '' : 'class="odd"');
                            sectionData.Body += gFuncs.parseTemplate(radnpnotes.CC_Tmpls.RowResults.join(''),{
                                personId: radnpnotes.personId,
                                encounterId: radnpnotes.encounterId,
                                eventId: dataElement[i].EVENT_ID,
                                titleLbl: dataElement[i].EVENT_DISP,
                                authorby: dataElement[i].PERFORMED_BY,
                                eventdate: dataElement[i].EVENT_END_DATE,
                                ROWODDS: oddEvenFlag
                            });
                        }
                        sectionData.Count = listlen;
                    }
                }
            },
            processRPTDATA_main_data: function () {
                radnpnotes.mainSection= '';
            },
            processH6_Section_All: function (sectObj) {
                var j,lencnt,dataElement,
                    sectionObj = htmlSecCtl.neo(),
                    wrkValue,
                    sectionData,
                    sectionName,
                    defaultHeight;
                for (j = 0 , lencnt = CC_SectMgt.sectionlist.length; j < lencnt; j++)  {
                    sectionData = CC_SectMgt[CC_SectMgt.sectionlist[j]];
                    if (sectionData.SectionLevel == 'H6') {
                        wrkValue = '(' + sectionData.Count + ')';
                        if( sectionData.SectionID == 'PIPDP' ){
                            wrkValue = ( sectionData.Count == 0? '(0)': '');
                        } else if( sectionData.SectionID == 'HistPhy') {
                            wrkValue = ( sectionData.Count == 0? '(0)': '');
                        } else if( sectionData.SectionID == 'PHistPhy') {
                            wrkValue = ( sectionData.Count == 0? '(0)': '');
                        } else{
                            wrkValue = '(' + sectionData.Count + ')';
                        }
                        defaultHeight = sectionData.Count < 15?  '' : 'style="height:300px; overflow-y:auto"';
                        sectionObj.initValues(
                            {
                                idLabel: sectionData.SectionLevel  + '_Sec_' + sectionData.SectionID,
                                TLabel1: sectionData.TLabel1,
                                SectionClosed: sectionData.SectionClosed,
                                SectionCntVal: sectionData.Count,
                                //CustIcon: 'none',
                                SectionCnt: wrkValue,
                                ContentBody: '<div ' + defaultHeight + '><table>' +
                                radnpnotes.CC_Tmpls.RowResultHdr +
                                sectionData.Body +
                                '</table></div>',
                                TemplateType: sectionData.TemplateType
                            });
                        sectionName = sectionData.SectionLevel  + '_Section_' + sectionData.SectionID,
                            radnpnotes[sectionName] =
                                sectionObj.generateHTML(CC_CssBehavior);
                        sectionData.SectionDivID = sectionObj.SectionDivID;
                    }
                }
            },
            processH5_Section_All: function () {
                var sectionObj = htmlSecCtl.neo(),
                    wrkValue,
                    sectionName,
                    sectionData,
                    defaultHeight;
                for (j = 0 , lencnt = CC_SectMgt.sectionlist.length; j < lencnt; j++)  {
                    sectionData = CC_SectMgt[CC_SectMgt.sectionlist[j]];
                    sectionData.CustIcon = '';
                    if (sectionData.SectionLevel == 'H5') {
                        wrkValue = '';
                        sectionData.CustIcon = 'auto';
                        //H5 sectionData.SectionID: 'ClinicMDNotes    groups the clinic notes
                        if( sectionData.SectionID == 'ClinicMDNotes' ){
                            sectionData.Body += radnpnotes.H6_Section_Pulm;
                            sectionData.Body += radnpnotes.H6_Section_Cardio;
                            sectionData.Body += radnpnotes.H6_Section_Endoc;
                            sectionData.Body += radnpnotes.H6_Section_Nuerol;
                            sectionData.Body += radnpnotes.H6_Section_Nueros;
                            sectionData.Body += radnpnotes.H6_Section_NephRen;
                            sectionData.Count = 1;
                            sectionData.CustIcon = 'none';
                        }
                        //H5 sectionData.SectionID: 'IPNotes'       groups the PIPDP notes  open always
                        else if( sectionData.SectionID == 'IPNotes' ){
                            sectionData.Body += radnpnotes.H6_Section_PIPDP;
                            sectionData.CustIcon = 'none';
                            sectionData.Count = 1;
                        }
                        //H5 sectionData.SectionID: 'HPNotes'       groups the HistPhy &&  PHistPhy notes  open always
                        else if( sectionData.SectionID == 'HPNotes' ){
                            sectionData.Body += radnpnotes.H6_Section_HistPhy;
                            sectionData.Body += radnpnotes.H6_Section_PHistPhy;
                            sectionData.CustIcon = 'none';
                            sectionData.Count = 1;
                        }
                        //H5 sectionData.SectionID: 'CRPIPC'          groups the Consults / Referral - Physicians IP Consultation  notes
                        else if( sectionData.SectionID == 'CRPIPC' ){
                            wrkValue = sectionData.Body
                            if (sectionData.Count > 0) {
                                sectionData.Body =  '<div ' + defaultHeight + '><table>' +
                                    radnpnotes.CC_Tmpls.RowResultHdr +
                                    wrkValue +
                                    '</table></div>';
                            }
                            //sectionData.Count = 1;
                            //sectionData.CustIcon = 'none';
                        }
                        //H5 sectionData.SectionID: 'EDPN'            groups the ED Physician Provider Notes note always open
                        else if( sectionData.SectionID == 'EDPN' ){
                            //sectionData.CustIcon = 'none';
                            if (sectionData.Count == 0){
                                //sectionData.Count = 1;
                                sectionData.Body = '';
                            } else {
                                wrkValue = sectionData.Body;
                                sectionData.Body =  '<div ' + defaultHeight + '><table>' +
                                    radnpnotes.CC_Tmpls.RowResultHdr +
                                    wrkValue +
                                    '</table></div>';
                            }
                        }
                        defaultHeight =  '';  //sectionData.Count < 15?  '' : 'style="height:300px; overflow-y:auto"';
                        sectionObj.initValues(
                            {
                                idLabel: sectionData.SectionLevel  + '_Sec_' + sectionData.SectionID,
                                TLabel1: sectionData.TLabel1,
                                SectionClosed: sectionData.SectionClosed,
                                SectionCntVal: sectionData.Count,
                                SectionCnt: '',
                                CustIcon: sectionData.CustIcon,
                                ContentBody: sectionData.Body,
                                TemplateType: sectionData.TemplateType
                            });
                        sectionName = sectionData.SectionLevel  + '_Section_' + sectionData.SectionID
                        radnpnotes[sectionName] = sectionObj.generateHTML(CC_CssBehavior);
                        sectionData.SectionDivID = sectionObj.SectionDivID;
                    }
                }
            },
            processCcInstance: function () {
                compContent = gFuncs.parseTemplate(radnpnotes.CC_Tmpls.mainDiv.join(''), {
                    cc_id: radnpnotes.cc_id,
                    mainSection: radnpnotes.mainSection,
                    H5_Section_ClinicMDNotes: radnpnotes.H5_Section_ClinicMDNotes,
                    H5_Section_IPNotes:     radnpnotes.H5_Section_IPNotes,
                    H5_Section_HPNotes:     radnpnotes.H5_Section_HPNotes,
                    H5_Section_CRPIPC:        radnpnotes.H5_Section_CRPIPC,
                    H5_Section_EDPN:          radnpnotes.H5_Section_EDPN,
                    mainSectionEnd:           radnpnotes.mainSectionEnd
                });
                gFuncs.Log_CC( component, compContent);
                target.innerHTML = compContent;
            },
            processCcCssSectionBehavior1: function (CssBehavior,sectObj) {
                htmlSecCtlObj.initToggle(CssBehavior,sectObj);
            },
            processCcCssSectionBehaviorH6: function (CssBehavior,CC_SectMgt_Obj) {
                var j,lencnt;
                for (j = 0 , lencnt = CC_SectMgt_Obj.sectionlist.length; j < lencnt; j++)  {
                    sectionData = CC_SectMgt_Obj[CC_SectMgt_Obj.sectionlist[j]];
                    if (sectionData.SectionLevel == 'H6') {
                        htmlSecCtlObj.initToggle(CssBehavior,sectionData);
                    }
                }
            },
            init: function () {
                var subHeaderDisplay;

                elementObj = component.data.RPTDATA;
                target = component.getTarget();

                component.eApps = {
                    cc_id: component.name.replace('.', '_'),
                    CSSBehaviors: chla.eApps.gCSSBehaviors.neo(),
                    TestSAP: null
                };
                radnpnotes.initOnly = ChlaStdClass.safeRead( chla,'eApps','operationMode') == 'test' ||
                    ChlaStdClass.safeRead( chla,'eApps','radnpnotes','operationMode') == 'radnpnotesTest' ;
                radnpnotes.cc_id = component.eApps.cc_id;
                radnpnotes.personId = component.getProperty("personId");
                radnpnotes.encounterId = component.getProperty("encounterId");
                radnpnotes.prsnlId = component.getProperty("userId");
                component.eApps.TestSAP= radnpnotes.TestServiceAccessPoint;

                htmlSecCtl = chlaNsMgr.aliasDirector('chla.eApps.Html.SectionHeaderCtl');
                htmlSecCtlData = chlaNsMgr.aliasDirector('chla.eApps.Html.SectionData');
                htmlSecCtlObj = htmlSecCtl.neo();
                initSecData = htmlSecCtlData.neo();

                CC_SectMgt = radnpnotes.CC_SectionManagement;

                SectionCfg = [
                    // H5 Sections
                    {T_type: 'H5',SecId: 'ClinicMDNotes',TLblId: ' Clinic MD Notes - most recent two notes for each clinic', SecClsd: 'open',SecLvl:'H5'},
                    {T_type: 'H5',SecId: 'IPNotes',TLblId: 'Progress Notes', SecClsd: 'open',SecLvl:'H5'},
                    {T_type: 'H5',SecId: 'HPNotes',TLblId: 'H&P Notes', SecClsd: 'open',SecLvl:'H5'},
                    {T_type: 'H5',SecId: 'CRPIPC',TLblId: 'Physician IP Consultation - up to most 5 recent', SecClsd: 'open',SecLvl:'H5'},
                    {T_type: 'H5',SecId: 'EDPN',TLblId: 'ED Physician Provider Notes - most recent note', SecClsd: 'open',SecLvl:'H5'},
                    // {T_type: 'H5',SecId: 'PORec',TLblId: 'PERI OPERATIVE RECORD', SecClsd: 'auto',SecLvl:'H5'},
                    // H6 Sections
                    {T_type: 'H6',SecId: 'Pulm',TLblId: 'Pulmonology', SecClsd: 'closed',SecLvl:'H6'},
                    {T_type: 'H6',SecId: 'Cardio',TLblId: 'Cardiology', SecClsd: 'closed',SecLvl:'H6'},
                    {T_type: 'H6',SecId: 'Endoc',TLblId: 'Endocrinology', SecClsd: 'closed',SecLvl:'H6'},
                    {T_type: 'H6',SecId: 'Nuerol',TLblId: 'Neurology', SecClsd: 'closed',SecLvl:'H6'},
                    {T_type: 'H6',SecId: 'Nueros',TLblId: 'Neurosurgery', SecClsd: 'closed',SecLvl:'H6'},
                    {T_type: 'H6',SecId: 'NephRen',TLblId: 'Nephrology/Renal', SecClsd: 'closed',SecLvl:'H6'},
                    {T_type: 'H6',SecId: 'HistPhy',TLblId: 'IP History & Physical - most recent note', SecClsd: 'closed',SecLvl:'H6'},
                    {T_type: 'H6',SecId: 'PHistPhy',TLblId: 'Pre-Op History & Physical - most recent note', SecClsd: 'closed',SecLvl:'H6'},
                    {T_type: 'H6',SecId: 'PIPDP',TLblId: 'Physician IP Daily Progress - most recent note', SecClsd: 'closed',SecLvl:'H6'}
                ];
                CC_SectMgt.sectionlist = initSecData.Section_config(SectionCfg,CC_SectMgt);

                CC_CssBehavior = component.eApps.CSSBehaviors;

                gFuncs = chlaNsMgr.aliasDirector('chla.eApps.gFuncs');
            },
            TestServiceAccessPoint: function (){
                return {
                    TestProcessRPTDATA_main: radnpnotes.processRPTDATA_main_data,
                    TestProcessH6_Sec_All_data: radnpnotes.processH6_Sec_All_data,
                    TestProcessH5_Sec_All_data: radnpnotes.processH5_Sec_All_data,
                    TestProcessH6_Section_All_data: radnpnotes.processH6_Section_All,
                    TestProcessH5_Section_All_data: radnpnotes.processH5_Section_All,
                    TestProcessCcInstance: radnpnotes.processCcInstance,
                    TestProcessCcCssSectionBehavior_1: radnpnotes.processCcCssSectionBehavior1,
                    TestProcessCcCssSectionBehavior_H6: radnpnotes.processCcCssSectionBehaviorH6
                };
            }
        };
    radnpnotes.init();
    if (radnpnotes.initOnly == false) {
        radnpnotes.processRPTDATA_main_data(elementObj);
        radnpnotes.processH5_Sec_All_Data(elementObj,CC_SectMgt);
        radnpnotes.processH6_Sec_All_Data(elementObj,CC_SectMgt);
        radnpnotes.processH6_Section_All(elementObj,CC_SectMgt);
        radnpnotes.processH5_Section_All(elementObj,CC_SectMgt);
        radnpnotes.processCcInstance();
        radnpnotes.processCcCssSectionBehavior1(CC_CssBehavior,CC_SectMgt['H5_Sec_EDPN']);
        radnpnotes.processCcCssSectionBehavior1(CC_CssBehavior,CC_SectMgt['H5_Sec_CRPIPC']);
        radnpnotes.processCcCssSectionBehaviorH6(CC_CssBehavior,CC_SectMgt);
    }
}

chla.BMTMeasure = function () { };
chla.BMTMeasure.prototype = new MPage.Component();
chla.BMTMeasure.prototype.constructor = MPage.Component;
chla.BMTMeasure.prototype.base = MPage.Component.prototype;
chla.BMTMeasure.prototype.name = "chla.BMTMeasure";
chla.BMTMeasure.prototype.cclProgram = "chla_ca_mp_md_bmt_info_json"; //_CCL_init_ start of section to call to LoadCCL
chla.BMTMeasure.prototype.cclParams = [];
chla.BMTMeasure.prototype.cclDataType = "JSON";
chla.BMTMeasure.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("encounterId");
    this.cclParams[2] = this.getProperty("personId");
    this.cclParams[3] = "";
    this.cclParams[4] = "";
    this.cclParams[5] = this.getProperty("userId");
};                                                              // end of  section for call to LoadCCL
//-----------------------------------------------------------------------------------------------------------------
chla.BMTMeasure.prototype.render = function () {
    var component = this,
        elementObj,
        target,
        compContent;
    var CC_SectMgt = null,
        CC_CssBehavior = null,
        gFuncs = null,
        htmlSecCtl = null,
        htmlSecCtlObj = null,
        BMTMeasure = {
            initOnly: false,
            cc_id: 'x',
            personId: 0,
            encounterId: 0,
            prsnlId: 0,
            transparentSpacer: '',
            CC_SectionManagement: {
                sectionlist: []
            },
            mainSection: '',
            mainSectionData: {
                CumFluidBal:'--',
                CumFluidBalUnits:'--',
                CumFluidBalDT:'--',
                PercentageWtGain:'--',
                PercentageWtGainUnits:'--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;',
                PercentageWtGainDT:'--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;',
                PercentageWtGainRangeVisible: ' display:none; ',
                PercentageWtGainRange:'--',
                PercentageWtGainRangeUnits:'--',
                PercentageWtGainSdt:'--',
                PercentageWtGainEdt:'--',
                AdmissionWt:'--',
                AdmissionWtDT:'--',
                RoutineWtLink:'--',
                RoutineWt: '--',
                RoutineWtDT:'--'
            },
            mainSectionEnd:'',

            CC_Tmpls: {
                mainDiv: [
                    '<div id="<#=cc_id#>" class="eapps_CC">',
                    '<#=mainSection#>',
                    '<#=mainSectionEnd#>',
                    '</div>'
                ],
                BMTMeasure_tmplt: [
                    '<table><tbody><tr><td class="col-1" >Cumulative Fluid Balance:</td><td class="col-2">',
                    '<#=CumFluidBal#><br/><span class="eapps-units"><#=CumFluidBalDT#></span></td></tr>',
                    '<tr><td class="col-1" style="vertical-align: top;">Percentage&nbsp;of&nbsp;Weight&nbsp;Gain:</td>',
                    '<td class="col-2"><div><div style="display:table-row;float:left;">&nbsp;&nbsp;<#=PercentageWtGain#>',
                    '<span class="eapps-units">&nbsp;<#=PercentageWtGainUnits#></span><span class="eapps-units"><#=PercentageWtGainDT#></span>',
                    '<div id="PWtGRange" style="<#=PercentageWtGainRangeVisible#> float:left; margin-top:5px;width:100%">&nbsp;&nbsp;',
                    '<#=PercentageWtGainRange#><span class="eapps-units">&nbsp;<#=PercentageWtGainRangeUnits#></span>',
                    '<span class="eapps-units">Date Range:<br/><#=PercentageWtGainSdt#> - <#=PercentageWtGainEdt#></span></div>',
                    '<div style="width:100%; display:inline;"><div style="display:inline;">&nbsp;</div>',
                    '<div id="BMTRange" class="eappsCssBtn eappsCssBtn-DtRange" style="float:right; display:table-row; margin-top:3px;"> Select Date Range',
                    '</div></div></div></div></td></tr><tr><td class="col-1" >Admission Weight:</td><td class="col-2">&nbsp;&nbsp;<#=AdmissionWt#>',
                    '<span class="eapps-units"><#=AdmissionWtDT#></span></td></tr><tr><td class="col-1">',
                    '<a href="javascript:MPAGES_EVENT(&quot;POWERFORM&quot;,&quot;<#=RoutineWtLink#>&quot;)">Routine Wt:</a></td>',
                    '<td class="col-2">&nbsp;&nbsp;<#=RoutineWt#><span class="eapps-units"><#=RoutineWtDT#></td></tr></table>'
                ],
                BMTDateRange_tmpl: [
                    '<div id="BMTDateRangePopUP" style=" display: block;  width: 480px; z-index: 30; left: 40px; top:45px; position: fixed;">',
                    '<div class="cernerblue section " id="BMTDateRange_DivSection" ><h2 class="sec-hd h2a-marker">',
                    '<span style="margin-right:0px;" class="sec-title "><span>Percentage Weight Gain Date Range Selection</span></span></h2>',
                    '<div class="sec-content" id="BMTDateRange_DivSecContent"><table style="border: 2px solid grey;"><tr  style="border: 1px solid grey;">',
                    '<td style="width:30%; text-align: right; background-color:lightgrey;">Select Start Date:&nbsp;&nbsp;&nbsp;</td>',
                    '<td style="width:70%; text-align: center;">',
                    '<input type="text" style="padding-left:10px;" id="BMTDateRange_datepicker1" value="<#=UPDT_START_DTTM#>"></td>',
                    '</tr><tr  style="border: 1px solid grey;">',
                    '<td style="width:30%; text-align: right; background-color:lightgrey;"> Select End Date:&nbsp;&nbsp;&nbsp;</td>',
                    '<td style="width:70%; text-align: center;" >',
                    '<input type="text" style="padding-left:10px;" id="BMTDateRange_datepicker2" value="<#=UPDT_END_DTTM#>" ></td>',
                    '</tr></table><br/><div style="display:table; width:100%;"><div  style="display:table-row;float:left;">',
                    '<button id="BMTDateRangeBtnCancel" class="eappsBtnGrey">  Cancel</button></div>  &nbsp;&nbsp;&nbsp;<div  style="display:table-row;float:right;">',
                    '<button id="BMTDateRangeBtnOK" class="eappsBtnGrey">  OK</button></div></div></div></div>',
                    '</div>'
                ],
                BMTPWtGRange: [
                    '<#=PercentageWtGainRange#><span class="eapps-units">&nbsp;<#=PercentageWtGainRangeUnits#></span>',
                    '<span class="eapps-units">Date Range:<br/><#=PercentageWtGainSdt#> - <#=PercentageWtGainEdt#></span></div>'
                ],
                Additional_Template1: []
            },
            processRPTDATA_main_data: function () {
                var  wrkArr = [],
                     wrkValue;
                BMTMeasure.mainSection= 'This is the Template main section<br/>';
                BMTMeasure.mainSection += '<br/>';

                wrkArr.push('<span style="font-weight:bold">');
                wrkArr.push( (elementObj.INTAKE_TOTAL).toFixed() );
                wrkArr.push( '</span>/');
                wrkArr.push( (elementObj.OUTPUT_TOTAL).toFixed());
                wrkArr.push( ' ');
                wrkArr.push( ( elementObj.INTAKE_TOTAL >= elementObj.OUTPUT_TOTAL? '(+' : '(-' ));
                wrkArr.push( (elementObj.INTAKE_TOTAL - elementObj.OUTPUT_TOTAL).toFixed());
                wrkArr.push(')');
                BMTMeasure.mainSectionData.CumFluidBal = wrkArr.join('') ;
                BMTMeasure.mainSectionData.CumFluidBalUnits = '';
                BMTMeasure.mainSectionData.CumFluidBalDT =  elementObj.FLUIDBAL_DT_TM_DISP;

                BMTMeasure.mainSectionData.PercentageWtGainUnits = '';
                BMTMeasure.mainSectionData.PercentageWtGainDT = elementObj.ROUTINE_WT_DT_TM_DISP.substring(3);
                if ( elementObj.MEDCALC_WT <= elementObj.ROUTINE_WT ){
                    wrkValue = (elementObj.ROUTINE_WT - elementObj.MEDCALC_WT ) * 100;
                    wrkValue = ( wrkValue / elementObj.MEDCALC_WT) ;
                    wrkArr.length = 0;
                    wrkArr.push('+');
                    wrkArr.push( wrkValue.toFixed(2));
                    wrkArr.push('% ');
                } else {
                    wrkValue = ( elementObj.MEDCALC_WT - elementObj.ROUTINE_WT ) * 100;
                    wrkValue = ( wrkValue / elementObj.MEDCALC_WT) ;
                    wrkArr.length = 0;
                    wrkArr.push('-');
                    wrkArr.push( wrkValue.toFixed(2));
                    wrkArr.push('% ');
                }
                BMTMeasure.mainSectionData.PercentageWtGain = wrkArr.join('');

                //BMTMeasure.mainSectionData.PercentageWtGainRangeVisible = 'display: table-row;';
                if (elementObj.PROUTINE_WT_START !="") {
                    if ( elementObj.PROUTINE_WT_START <= elementObj.PROUTINE_WT_END ){
                        wrkValue = (elementObj.PROUTINE_WT_END - elementObj.PROUTINE_WT_START ) * 100;
                        wrkValue = ( wrkValue / elementObj.PROUTINE_WT_START) ;
                        wrkArr.length = 0;
                        wrkArr.push('+');
                        wrkArr.push( wrkValue.toFixed(2));
                        wrkArr.push('% ');
                    } else {
                        wrkValue = ( elementObj.PROUTINE_WT_END - elementObj.PROUTINE_WT_START ) * 100;
                        wrkValue = ( wrkValue / elementObj.PROUTINE_WT_START) ;
                        wrkArr.length = 0;
                        //wrkArr.push('-');
                        wrkArr.push( wrkValue.toFixed(2));
                        wrkArr.push('% ');
                    }
                    BMTMeasure.mainSectionData.PercentageWtGainRange = wrkArr.join('');
                    BMTMeasure.mainSectionData.PercentageWtGainRangeUnits = '';
                    BMTMeasure.mainSectionData.PercentageWtGainSdt = elementObj.PROUTINE_WT_START_DT_TM;
                    BMTMeasure.mainSectionData.PercentageWtGainEdt = elementObj.PROUTINE_WT_END_DT_TM;
                    BMTMeasure.mainSectionData.PercentageWtGainRangeVisible  = '';
                } else {
                    BMTMeasure.mainSectionData.PercentageWtGainRangeVisible  = ' display:none; ';
                }
                BMTMeasure.mainSectionData.AdmissionWt = elementObj.MEDCALC_WT;
                BMTMeasure.mainSectionData.AdmissionWtDT = elementObj.MEDCALC_WT_DT_TM_DISP;

                BMTMeasure.mainSectionData.RoutineWtLink = BMTMeasure.personId + '|' +  BMTMeasure.encounterId + '|1170425|0|0';
                BMTMeasure.mainSectionData.RoutineWt = elementObj.ROUTINE_WT;
                BMTMeasure.mainSectionData.RoutineWtDT = elementObj.ROUTINE_WT_DT_TM_DISP;

                BMTMeasure.mainSection = gFuncs.parseTemplate(BMTMeasure.CC_Tmpls.BMTMeasure_tmplt.join(''),  BMTMeasure.mainSectionData );
            },
            processRPTDATA_end_data: function () {
                BMTMeasure.mainSectionEnd = '';
            },

            processCcInstance: function () {
                compContent = gFuncs.parseTemplate(BMTMeasure.CC_Tmpls.mainDiv.join(''), {
                    cc_id: BMTMeasure.cc_id,
                    mainSection:      BMTMeasure['mainSection'],
                    mainSectionEnd:   BMTMeasure['mainSectionEnd']
                });
                gFuncs.Log_CC( component, compContent);
                target.innerHTML = compContent;
            },
            processCcCssButtonBehavior1: function () {
                $('div#chla_BMTMeasure div#BMTRange').on('click', function(){
                    var inputForm,
                        inpputFormFrag,
                        wrkArr = [],
                        dateval1,
                        dateval2;
                    dateval1 = ( elementObj.START_DTTM == '' ? elementObj.REG_DT_TM_DISP: elementObj.START_DTTM);
                    dateval2 = ( elementObj.END_DTTM == '' ? elementObj.NOW_DT_TM_DISP: elementObj.END_DTTM);

                    inputForm = gFuncs.parseTemplate(BMTMeasure.CC_Tmpls.BMTDateRange_tmpl.join('') ,{
                        UPDT_START_DTTM: dateval1,
                        UPDT_END_DTTM:   dateval2
                    });
                    wrkArr = elementObj.REG_DT_TM_DISP.split('/');
                    $('div#' + BMTMeasure.cc_id ).append(inputForm);
                    $('input#BMTDateRange_datepicker1').datepicker( {
                        minDate: new Date(wrkArr[2], wrkArr[0] - 1, wrkArr[1]),
                        maxDate: '0d'
                    });
                    $('input#BMTDateRange_datepicker2').datepicker({
                        minDate: new Date(wrkArr[2], wrkArr[0] - 1, wrkArr[1]),
                        maxDate: '0d'
                    });

                    $('#BMTDateRangeBtnCancel').on('click',function(){
                        $('div#BMTDateRangePopUP').remove();
                    });
                    $('#BMTDateRangeBtnOK').on('click',function(){
                        var cclParams;
                        component.cclParams[3] = $('#BMTDateRange_datepicker1').val();
                        component.cclParams[4] = $('#BMTDateRange_datepicker2').val();
                        chla.eApps.Logger.LogInfo(' ' + component.cclParams.join(', '));
                        $('div#BMTDateRangePopUP').remove();

                        component.loadCcl('chla_ca_mp_md_bmt_info_json',
                            component.cclParams,
                            BMTMeasure.BMTDTRangeLoadCCL,
                            "JSON");
                        //BMTMeasure.BMTDTRangeLoadCCL.call(component, elementObj)required to test by setting the "this" = component;;
                    });
                });
            },
            //LoadCCL uses this format for: callback.call(self, JSON.parse(responseData)) to set the "this" = component;
            BMTDTRangeLoadCCL: function (data){
                var  wrkArr = [],
                     wrkValue;
                this.data = data;
                elementObj = this.data.RPTDATA;
                if (elementObj.PROUTINE_WT_START !="") {
                    if ( elementObj.PROUTINE_WT_START <= elementObj.PROUTINE_WT_END ){
                        wrkValue = (elementObj.PROUTINE_WT_END - elementObj.PROUTINE_WT_START ) * 100;
                        wrkValue = ( wrkValue / elementObj.PROUTINE_WT_START) ;
                        wrkArr.length = 0;
                        wrkArr.push('+');
                        wrkArr.push( wrkValue.toFixed(2));
                        wrkArr.push('% ');
                    } else {
                        wrkValue = ( elementObj.PROUTINE_WT_END - elementObj.PROUTINE_WT_START ) * 100;
                        wrkValue = ( wrkValue / elementObj.PROUTINE_WT_START) ;
                        wrkArr.length = 0;
                        //wrkArr.push('-');
                        wrkArr.push( wrkValue.toFixed(2));
                        wrkArr.push('% ');
                    }
                    BMTMeasure.mainSectionData.PercentageWtGainRange = wrkArr.join('');
                    BMTMeasure.mainSectionData.PercentageWtGainRangeUnits = '';
                    BMTMeasure.mainSectionData.PercentageWtGainSdt = elementObj.PROUTINE_WT_START_DT_TM;
                    BMTMeasure.mainSectionData.PercentageWtGainEdt = elementObj.PROUTINE_WT_END_DT_TM;
                    BMTMeasure.mainSectionData.PercentageWtGainRangeVisible  = '';
                } else {
                    BMTMeasure.mainSectionData.PercentageWtGainRangeVisible  = ' display:none; ';
                }
                wrkValue = gFuncs.parseTemplate(BMTMeasure.CC_Tmpls.BMTPWtGRange.join('') ,  BMTMeasure.mainSectionData );
                chla.eApps.Logger.LogInfo( chla.eApps.Funcs.HtmlLogFormatter( wrkValue));
                $('div#PWtGRange').html(wrkValue);
                $('div#PWtGRange').css('display','table-row');
            },
            init: function () {
                var subHeaderDisplay,
                    SectionCfg,
                    htmlSecCtlData,
                    initSecData;

                elementObj = component.data.RPTDATA;
                target = component.getTarget();

                component.eApps = {
                    cc_id: component.name.replace('.', '_'),
                    CSSBehaviors: chla.eApps.gCSSBehaviors.neo(),
                    SaveButtonAction: chla.eApps.SaveButtonBehavior.enable_disable_status_reset,
                    TestSAP: null
                };
                BMTMeasure.initOnly = ChlaStdClass.safeRead( chla,'eApps','operationMode') == 'test' ||
                    ChlaStdClass.safeRead( chla,'eApps','BMTMeasure','operationMode') == 'BMTMeasureTest' ;
                BMTMeasure.cc_id = component.eApps.cc_id;
                BMTMeasure.personId = component.getProperty("personId");
                BMTMeasure.encounterId = component.getProperty("encounterId");
                BMTMeasure.prsnlId = component.getProperty("userId");
                component.eApps.TestSAP= BMTMeasure.TestServiceAccessPoint;
                ;
                htmlSecCtl = chlaNsMgr.aliasDirector('chla.eApps.Html.SectionHeaderCtl');
                htmlSecCtlData = chlaNsMgr.aliasDirector('chla.eApps.Html.SectionData');

                CC_CssBehavior = component.eApps.CSSBehaviors;
                gFuncs = chlaNsMgr.aliasDirector('chla.eApps.gFuncs');
            },
            TestServiceAccessPoint: function (){
                return {
                    TestProcessRPTDATA_main: BMTMeasure.processRPTDATA_main_data,
                    TestProcessRPTDATA_end: BMTMeasure.processRPTDATA_end_data,
                    TestProcessCcInstance: BMTMeasure.processCcInstance,
                    TestProcessCcCssButtonBehavior1: BMTMeasure.processCcCssButtonBehavior1
                };
            },
            CCProcessing: function (){
                BMTMeasure.processRPTDATA_main_data(elementObj);
                BMTMeasure.processRPTDATA_end_data(elementObj);
                BMTMeasure.processCcInstance();
                BMTMeasure.processCcCssButtonBehavior1(CC_SectMgt);
            }
        };

    BMTMeasure.init();
    if (BMTMeasure.initOnly == false) {
        BMTMeasure.CCProcessing();
    }
};

chla.oncologySurgeries = function () { };
chla.oncologySurgeries.prototype = new MPage.Component();
chla.oncologySurgeries.prototype.constructor = MPage.Component;
chla.oncologySurgeries.prototype.base = MPage.Component.prototype;
chla.oncologySurgeries.prototype.name = "chla.oncologySurgeries";
chla.oncologySurgeries.prototype.cclProgram = "CHLA_CA_MP_CC_SURGERIES_JSON";
chla.oncologySurgeries.prototype.cclParams = [];
chla.oncologySurgeries.prototype.cclDataType = "JSON";
chla.oncologySurgeries.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("personId");
    this.cclParams[2] = this.getProperty("userId");
};

chla.oncologySurgeries.prototype.render = function () {
    var component = this,
        elementObj,
        target,
        compContent;
    var CC_SectMgt = null,
        CC_CssBehavior = null,
        gFuncs = null,
        htmlSecCtl = null,
        htmlSecCtlData = null,
        htmlSecCtlObj = null,
        CclReqObjSave = null,
        wrkResults,
        oncologySurgeries = {
            initOnly: false,
            cc_id: 'x',
            personId: 0,
            encounterId: 0,
            prsnlId: 0,
            transparentSpacer: '',

            CC_SectionManagement: {
                H5SecFuture: null,
                H5SecCompleted:null,
                H5SecOutSide: null,
                H6SecLPFuture: null,
                H6SecLPCompleted: null
            },
            mainSection: '',
            FutureH5Section: '',
            CompletedH5Section: '',
            OutSideH5Section: '',
            LPFutureH6Section: '',
            LPCompletedH6Section: '',
            OncologySurgeriesH5Section: '',
            CC_Tmpls: {
                mainDiv: [
                    '<div id="<#=cc_id#>" class="eapps_CC">',
                    '<#=mainSection#>',
                    '<#=FutureH5Section#>',
                    '<#=CompletedH5Section#>',
                    '<#=OutSideH5Section#>',
                    '<#=OncologySurgeriesH5Section#>',
                    '</div>'
                ],
                mainHdr: [
                    '<table class="header"><tr><th class="col-a">',
                    'Date</th><th class="col-b">Name of Surgery</th>',
                    '<th class="col-c">Surgeon</th></table>'
                ]
            },
            processH5SectionFuture: function () {
                var sectionObj = htmlSecCtl.neo(),
                    sectionData = CC_SectMgt.H5SecFuture,
                    defaultHeight;
                defaultHeight = sectionData.Count < 5? '' : 'style="height:200px; overflow-y:auto"';
                sectionObj.initValues(
                    {
                        idLabel: 'osFutureH5Sec',
                        TLabel1: 'Future',
                        SectionCntVal: sectionData.Count,
                        SectionClosed: 'closed',
                        ContentBody: '<div ' + defaultHeight + '> <table>' + sectionData.Body + '</table></div>',
                        TemplateType: sectionData.TemplateType
                    });
                oncologySurgeries.FutureH5Section =
                    sectionObj.generateHTML(CC_CssBehavior);
                sectionData.SectionDivID = sectionObj.SectionDivID;
            },
            processH5SectionCompleted: function () {
                var sectionObj = htmlSecCtl.neo(),
                    sectionData = CC_SectMgt.H5SecCompleted,
                    defaultHeight;
                defaultHeight = sectionData.Count < 5? '' :  'style="height:200px; overflow-y:auto"';
                sectionObj.initValues(
                    {
                        idLabel: 'osCompletedH5Sec',
                        TLabel1: 'Completed',
                        SectionCntVal: sectionData.Count,
                        SectionClosed: 'closed',
                        ContentBody: '<div ' + defaultHeight + '> <table>' +  sectionData.Body + '</table></div>',
                        TemplateType: sectionData.TemplateType
                    });
                oncologySurgeries.CompletedH5Section =
                    sectionObj.generateHTML(CC_CssBehavior);
                sectionData.SectionDivID = sectionObj.SectionDivID;
            },
            processH5SectionOutSide: function () {
                var sectionObj = htmlSecCtl.neo(),
                    sectionData = CC_SectMgt.H5SecOutSide,
                    defaultHeight;
                defaultHeight = sectionData.Count < 5? '' :  'style="height:200px; overflow-y:auto"';
                sectionObj.initValues(
                    {
                        idLabel: 'osOutsideH5Sec',
                        TLabel1: 'Outside',
                        SectionClosed: 'closed',
                        SectionCntVal: sectionData.Count,
                        ContentBody: '<div ' + defaultHeight + '> <table>' + sectionData.Body + '</table></div>',
                        TemplateType: sectionData.TemplateType
                    });
                oncologySurgeries.OutSideH5Section =
                    sectionObj.generateHTML(CC_CssBehavior);
                sectionData.SectionDivID = sectionObj.SectionDivID;
            },
            processH6SectionLPCompleted: function () {
                var sectionObj = htmlSecCtl.neo(),
                    sectionData = CC_SectMgt.H6SecLPCompleted,
                    defaultHeight;
                defaultHeight = sectionData.Count < 5? '' :  'style="height:200px; overflow-y:auto"';
                sectionObj.initValues(
                    {
                        idLabel: 'osLPCompletedH6Sec',
                        TLabel1: 'Completed',
                        SectionCntVal: sectionData.Count,
                        SectionClosed: 'closed',
                        ContentBody: '<div ' + defaultHeight + '><table>' +  sectionData.Body + '</table></div>',
                        TemplateType: sectionData.TemplateType
                    });
                oncologySurgeries.LPCompletedH6Section =
                    sectionObj.generateHTML(CC_CssBehavior);
                sectionData.SectionDivID = sectionObj.SectionDivID;
            },
            processH6SectionLPFuture: function () {
                var sectionObj = htmlSecCtl.neo(),
                    sectionData = CC_SectMgt.H6SecLPFuture,
                    defaultHeight;
                defaultHeight = sectionData.Count < 5? '' :  'style="height:200px; overflow-y:auto"';
                sectionObj.initValues(
                    {
                        idLabel: 'osLPFutureH6Sec',
                        TLabel1: 'Future',
                        SectionCntVal: sectionData.Count,
                        SectionClosed: 'closed',
                        ContentBody: '<div ' + defaultHeight + '> <table>' +  sectionData.Body + '</table></div>',
                        TemplateType: sectionData.TemplateType
                    });
                oncologySurgeries.LPFutureH6Section =
                    sectionObj.generateHTML(CC_CssBehavior);
                sectionData.SectionDivID = sectionObj.SectionDivID;
            },
            processH5SectionOncologySurgeries: function () {
                var sectionObj = htmlSecCtl.neo(),
                    sectionData = CC_SectMgt.H5SecOncologySurgeries;
                sectionObj.initValues(
                    {
                        idLabel: 'LPSurgeriesH5Sec',
                        TLabel1: 'Lumbar Punctures',
                        SectionClosed: 'open',
                        SectionCnt: '',
                        SectionCntVal: 1,
                        ContentBody: oncologySurgeries.LPFutureH6Section +
                        oncologySurgeries.LPCompletedH6Section ,
                        TemplateType: 'H5'
                    });
                oncologySurgeries.OncologySurgeriesH5Section =
                    sectionObj.generateHTML(CC_CssBehavior);
                sectionData.Count = 1;
                sectionData.SectionDivID = sectionObj.SectionDivID;
            },
            processCcInstance: function () {
                oncologySurgeries.mainSection =  oncologySurgeries.CC_Tmpls.mainHdr.join('');

                compContent = chla.eApps.gFuncs.parseTemplate(oncologySurgeries.CC_Tmpls.mainDiv.join(''),
                    {
                        cc_id: oncologySurgeries.cc_id,
                        mainSection: oncologySurgeries.mainSection,
                        FutureH5Section: oncologySurgeries.FutureH5Section,
                        CompletedH5Section: oncologySurgeries.CompletedH5Section,
                        OutSideH5Section: oncologySurgeries.OutSideH5Section,
                        OncologySurgeriesH5Section: oncologySurgeries.OncologySurgeriesH5Section
                    });

                gFuncs.Log_CC( component, compContent);
                target.innerHTML = compContent;
            },
            processCcCssSectionBehaviorFuture: function () {
                htmlSecCtlObj.initToggle(CC_CssBehavior,CC_SectMgt.H5SecFuture);
            },
            processCcCssSectionBehaviorCompleted: function () {
                htmlSecCtlObj.initToggle(CC_CssBehavior,CC_SectMgt.H5SecCompleted);
            },
            processCcCssSectionBehaviorOutside: function () {
                htmlSecCtlObj.initToggle(CC_CssBehavior,CC_SectMgt.H5SecOutSide);
            },
            processCcCssSectionBehaviorLPFuture: function () {
                htmlSecCtlObj.initToggle(CC_CssBehavior,CC_SectMgt.H6SecLPFuture);
            },
            processCcCssSectionBehaviorLPCompleted: function () {
                htmlSecCtlObj.initToggle(CC_CssBehavior,CC_SectMgt.H6SecLPCompleted);
            },
            processCcCssSectionBehaviorOncologySurgeries: function () {
                htmlSecCtlObj.initToggle(CC_CssBehavior,CC_SectMgt.H5SecOncologySurgeries);
            },
            init: function () {
                var subHeaderDisplay;

                elementObj = component.data.RPTDATA;
                target = component.getTarget();

                subHeaderDisplay = "(" + elementObj.PROC_CNT + ")";;
                component.setProperty("headerSubTitle", subHeaderDisplay);

                component.eApps = {
                    cc_id: component.name.replace('.', '_'),
                    CSSBehaviors: chla.eApps.gCSSBehaviors.neo(),
                    TestSAP: null,
                    initOnly: false
                };

                component.eApps.initOnly = ChlaStdClass.safeRead(chla, 'eApps', 'operationMode') == 'test' ||
                    ChlaStdClass.safeRead(chla,'eApps','oncologySurgeries','operationMode') == 'oncologySurgeriesTest' ;

                oncologySurgeries.cc_id = component.eApps.cc_id;
                oncologySurgeries.personId = component.getProperty("personId");
                oncologySurgeries.encounterId = component.getProperty("encounterId");
                oncologySurgeries.prsnlId = component.getProperty("userId");
                component.eApps.TestSAP = oncologySurgeries.TestServiceAccessPoint;
                htmlSecCtl = chlaNsMgr.aliasDirector('chla.eApps.Html.SectionHeaderCtl');
                htmlSecCtlObj = htmlSecCtl.neo();
                htmlSecCtlData = htmlSecCtlObj.SectionData;
                CC_SectMgt = oncologySurgeries.CC_SectionManagement;
                CC_SectMgt.H5SecFuture = htmlSecCtlData.neo('H5');
                CC_SectMgt.H5SecCompleted = htmlSecCtlData.neo('H5');
                CC_SectMgt.H5SecOutSide = htmlSecCtlData.neo('H5');
                CC_SectMgt.H6SecLPFuture = htmlSecCtlData.neo('H6');
                CC_SectMgt.H6SecLPCompleted = htmlSecCtlData.neo('H6');
                CC_SectMgt.H5SecOncologySurgeries = htmlSecCtlData.neo('H5');

                CC_CssBehavior = component.eApps.CSSBehaviors;

                gFuncs = chlaNsMgr.aliasDirector('chla.eApps.gFuncs');

            },
            TestServiceAccessPoint: function (){
                return {
                    TestProcessRPTDATA:  oncologySurgeries.processRPTDATA,
                    TestProcessRPTDATA_LP:  oncologySurgeries.processRPTDATA_LP,

                    TestProcessFuture: oncologySurgeries.processH6SectionLPFuture,
                    TestProcessCompleted: oncologySurgeries.processH6SectionLPCompleted,
                    TestProcessFuture: oncologySurgeries.processH5SectionFuture,
                    TestProcessCompleted: oncologySurgeries.processH5SectionCompleted,
                    TestProcessCompleted: oncologySurgeries.processH5SectionOutSide,
                    TestProcessOncologySurgeries: oncologySurgeries.processH5SectionOncologySurgeries,

                    TestProcessCcInstance: oncologySurgeries.processCcInstance,

                    TestProcessCcCssSectionBehaviorFuture: oncologySurgeries.processCcCssSectionBehaviorFuture,
                    TestProcessCcCssSectionBehaviorCompleted: oncologySurgeries.processCcCssSectionBehaviorCompleted,
                    TestProcessCcCssSectionBehaviorOutside: oncologySurgeries.processCcCssSectionBehaviorOutside,
                    TestProcessCcCssSectionBehaviorFuture: oncologySurgeries.processCcCssSectionBehaviorLPFuture,
                    TestProcessCcCssSectionBehaviorCompleted: oncologySurgeries.processCcCssSectionBehaviorLPCompleted,

                    TestProcessCcCssSectionBehaviorOncologySurgeries: oncologySurgeries.processCcCssSectionBehaviorOncologySurgeries
                };
            },
            processRPTDATA_LP: function () {
                var wrkResults,
                    wrkCnt,
                    wrkCnt2,
                    p, f, c, o, oddEvenFlag,
                    cprocedure,
                    fprocedure,
                    futProcCnt,
                    compProcCnt,
                    futureProcedures,
                    completedProcedures;

                if (elementObj.LP_PROC_CNT > 0) {

                    for (p = 0, wrkCnt = elementObj.LP_PROCEDURES.length; p < wrkCnt; p++) {
                        completedProcedures = elementObj.LP_PROCEDURES[p].COMPLETED;
                        futureProcedures = elementObj.LP_PROCEDURES[p].FUTURE;

                        compProcCnt = elementObj.LP_PROCEDURES[p].COMP_PROC_CNT;
                        futProcCnt = elementObj.LP_PROCEDURES[p].FUTURE_PROC_CNT;

                        oddEvenFlag = 0;
                        wrkResults = '';
                        for (f = 0, wrkCnt2 = futureProcedures.length; f < wrkCnt2 ; f++) {
                            fprocedure = futureProcedures[f];
                            wrkResults += '<tr class="rowPopup ';
                            wrkResults += (oddEvenFlag == 1? ' odd" ': '"');
                            oddEvenFlag = (oddEvenFlag == 1?0:1);

                            wrkResults += " tip=\""
                                + "<ul>"
                                + "<li><strong>Start Date:</strong> " + fprocedure.SCHED_START_DT_TM + "</li>"
                                + "<li><strong>Procedure:</strong> " + fprocedure.PROC_DISP + "</li>"
                                + "<li><strong>State:</strong> " + fprocedure.APPT_STATE + "</li>"
                                + "<li><strong>Surgery Area:</strong> " + fprocedure.SURG_AREA + "</li>"
                                + "<li><strong>OR:</strong> " + fprocedure.SCHED_OR + "</li>"
                                + "<li><strong>Scheduled Duration:</strong> " + fprocedure.SCHED_DURATION + " minutes</li>"
                                //+ "<li><strong>Duration:</strong> " + fprocedure.PROC_DURATION + " minutes</li>"
                                + "<li><strong>Surgeon:</strong> " + fprocedure.SURGEON + "</li>"
                                + "<li><strong>Case Number:</strong> " + fprocedure.SURG_CASE_NBR + "</li>"
                                + "<li><strong>Procedure Text:</strong> " + fprocedure.PROC_TEXT + "</li>"
                                //+ "<li><strong>End Date/Time:</strong> " + fprocedure.PROC_END_DT_TM + "</li>"
                                + "</ul>"
                                + "\">";
                            wrkResults += "<td class='col-a'>" + fprocedure.SCHED_START_DT_TM + "</td>";
                            wrkResults += "<td class='col-b'>" + fprocedure.PROC_DISP + "</td>";
                            wrkResults += "<td class='col-c'>" + fprocedure.SURGEON + "</td>";
                            wrkResults += "</tr>";
                        }
                        CC_SectMgt.H6SecLPFuture.Count = futProcCnt;
                        CC_SectMgt.H6SecLPFuture.Body = wrkResults;
                        oddEvenFlag = 0;
                        wrkResults = '';
                        for (c = 0, wrkCnt2 = completedProcedures.length ; c < wrkCnt2 ; c++) {
                            cprocedure = completedProcedures[c];

                            wrkResults += '<tr class="rowPopup ';
                            wrkResults += (oddEvenFlag == 1? ' odd" ': '"');
                            oddEvenFlag = (oddEvenFlag == 1?0:1);

                            wrkResults += " tip=\""
                                + "<ul>"
                                + "<li><strong>Start Date:</strong> " + cprocedure.SCHED_START_DT_TM + "</li>"
                                + "<li><strong>Procedure:</strong> " + cprocedure.PROC_DISP + "</li>"
                                + "<li><strong>State:</strong> " + cprocedure.APPT_STATE + "</li>"
                                + "<li><strong>Surgery Area:</strong> " + cprocedure.SURG_AREA + "</li>"
                                + "<li><strong>OR:</strong> " + cprocedure.SCHED_OR + "</li>"
                                + "<li><strong>Duration:</strong> " + cprocedure.PROC_DURATION + " minutes</li>"
                                + "<li><strong>Surgeon:</strong> " + cprocedure.SURGEON + "</li>"
                                + "<li><strong>Case Number:</strong> " + cprocedure.SURG_CASE_NBR + "</li>"
                                + "<li><strong>Procedure Text:</strong> " + cprocedure.PROC_TEXT + "</li>"
                                + "<li><strong>End Date/Time:</strong> " + cprocedure.PROC_END_DT_TM + "</li>"
                                + "</ul>"
                                + "\">";

                            wrkResults += "<td class='col-a'>" + cprocedure.SCHED_START_DT_TM + "</td>";
                            wrkResults += "<td class='col-b'>" + cprocedure.PROC_DISP + "</td>";
                            wrkResults += "<td class='col-c'>" + cprocedure.SURGEON + "</td>";
                            wrkResults += "</tr>";

                        }
                        CC_SectMgt.H6SecLPCompleted.Count = compProcCnt;
                        CC_SectMgt.H6SecLPCompleted.Body = wrkResults;
                    }
                }
            },
            processRPTDATA: function () {
                var wrkResults,
                    wrkCnt,
                    wrkCnt2,
                    p, f, c, o,oddEvenFlag,
                    oprocedure,
                    cprocedure,
                    fprocedure,
                    outProcCnt,
                    futProcCnt,
                    compProcCnt,
                    outsideProcedures,
                    futureProcedures,
                    completedProcedures;

                if (elementObj.PROC_CNT > 0) {

                    for (p = 0, wrkCnt = elementObj.PROCEDURES.length; p < wrkCnt; p++) {
                        completedProcedures = elementObj.PROCEDURES[p].COMPLETED;
                        futureProcedures = elementObj.PROCEDURES[p].FUTURE;
                        outsideProcedures = elementObj.PROCEDURES[p].OUTSIDE;
                        compProcCnt = elementObj.PROCEDURES[p].COMP_PROC_CNT;
                        futProcCnt = elementObj.PROCEDURES[p].FUTURE_PROC_CNT;
                        outProcCnt = elementObj.PROCEDURES[p].OUTSIDE_PROC_CNT;
                        oddEvenFlag = 0;
                        wrkResults = '';
                        for (f = 0, wrkCnt2 = futProcCnt; f < wrkCnt2 ; f++) {
                            fprocedure = futureProcedures[f];
                            wrkResults += '<tr class="rowPopup ';
                            wrkResults += (oddEvenFlag == 1? ' odd" ': '"');
                            oddEvenFlag = (oddEvenFlag == 1?0:1);

                            wrkResults += " tip=\""
                                + "<ul>"
                                + "<li><strong>Start Date:</strong> " + fprocedure.SCHED_START_DT_TM + "</li>"
                                + "<li><strong>Procedure:</strong> " + fprocedure.PROC_DISP + "</li>"
                                + "<li><strong>State:</strong> " + fprocedure.APPT_STATE + "</li>"
                                + "<li><strong>Surgery Area:</strong> " + fprocedure.SURG_AREA + "</li>"
                                + "<li><strong>OR:</strong> " + fprocedure.SCHED_OR + "</li>"
                                + "<li><strong>Scheduled Duration:</strong> " + fprocedure.SCHED_DURATION + " minutes</li>"
                                //+ "<li><strong>Duration:</strong> " + fprocedure.PROC_DURATION + " minutes</li>"
                                + "<li><strong>Surgeon:</strong> " + fprocedure.SURGEON + "</li>"
                                + "<li><strong>Case Number:</strong> " + fprocedure.SURG_CASE_NBR + "</li>"
                                + "<li><strong>Procedure Text:</strong> " + fprocedure.PROC_TEXT + "</li>"
                                //+ "<li><strong>End Date/Time:</strong> " + fprocedure.PROC_END_DT_TM + "</li>"
                                + "</ul>"
                                + "\">";
                            wrkResults += "<td class='col-a'>" + fprocedure.SCHED_START_DT_TM + "</td>";
                            wrkResults += "<td class='col-b'>" + fprocedure.PROC_DISP + "</td>";
                            wrkResults += "<td class='col-c'>" + fprocedure.SURGEON + "</td>";
                            wrkResults += "</tr>";
                        }
                        CC_SectMgt.H5SecFuture.Count = futProcCnt;
                        CC_SectMgt.H5SecFuture.Body = wrkResults;
                        oddEvenFlag = 0;
                        wrkResults = '';
                        for (c = 0, wrkCnt2 = compProcCnt ; c < wrkCnt2 ; c++) {
                            cprocedure = completedProcedures[c];

                            wrkResults += '<tr class="rowPopup ';
                            wrkResults += (oddEvenFlag == 1? ' odd" ': '"');
                            oddEvenFlag = (oddEvenFlag == 1?0:1);

                            wrkResults += " tip=\""
                                + "<ul>"
                                + "<li><strong>Start Date:</strong> " + cprocedure.SCHED_START_DT_TM + "</li>"
                                + "<li><strong>Procedure:</strong> " + cprocedure.PROC_DISP + "</li>"
                                + "<li><strong>State:</strong> " + cprocedure.APPT_STATE + "</li>"
                                + "<li><strong>Surgery Area:</strong> " + cprocedure.SURG_AREA + "</li>"
                                + "<li><strong>OR:</strong> " + cprocedure.SCHED_OR + "</li>"
                                + "<li><strong>Duration:</strong> " + cprocedure.PROC_DURATION + " minutes</li>"
                                + "<li><strong>Surgeon:</strong> " + cprocedure.SURGEON + "</li>"
                                + "<li><strong>Case Number:</strong> " + cprocedure.SURG_CASE_NBR + "</li>"
                                + "<li><strong>Procedure Text:</strong> " + cprocedure.PROC_TEXT + "</li>"
                                + "<li><strong>End Date/Time:</strong> " + cprocedure.PROC_END_DT_TM + "</li>"
                                + "</ul>"
                                + "\">";

                            wrkResults += "<td class='col-a'>" + cprocedure.SCHED_START_DT_TM + "</td>";
                            wrkResults += "<td class='col-b'>" + cprocedure.PROC_DISP + "</td>";
                            wrkResults += "<td class='col-c'>" + cprocedure.SURGEON + "</td>";
                            wrkResults += "</tr>";

                        }
                        CC_SectMgt.H5SecCompleted.Count = compProcCnt;
                        CC_SectMgt.H5SecCompleted.Body = wrkResults;

                        wrkResults = '';
                        oddEvenFlag = 0;
                        for (o = 0, wrkCnt2 = outProcCnt; o < wrkCnt2; o++) {
                            oprocedure = outsideProcedures[o];
                            wrkResults += "<tr";
                            wrkResults += (oddEvenFlag == 1? " class='odd' >": ">");
                            oddEvenFlag = (oddEvenFlag == 1?0:1);

                            wrkResults += "<td class='col-a'>" + oprocedure.PROC_DT_TM_DISP + " " + oprocedure.PROC_DT_TM + "</td>";
                            wrkResults += "<td class='col-b' colspan=2>" + oprocedure.PROC_TEXT + "</td>";
                            wrkResults += "</tr>";

                        }
                        CC_SectMgt.H5SecOutSide.Count = outProcCnt;
                        CC_SectMgt.H5SecOutSide.Body = wrkResults;

                    }
                } else {
                    wrkResults = "<p>There are no scheduled oncologySurgeries at this time.</p>";
                }
            }
        };
    oncologySurgeries.init();
    if (oncologySurgeries.initOnly == false) {

        oncologySurgeries.processRPTDATA();
        oncologySurgeries.processRPTDATA_LP();

        oncologySurgeries.processH5SectionFuture();
        oncologySurgeries.processH5SectionCompleted();
        oncologySurgeries.processH5SectionOutSide();
        oncologySurgeries.processH6SectionLPFuture();
        oncologySurgeries.processH6SectionLPCompleted();
        oncologySurgeries.processH5SectionOncologySurgeries();

        oncologySurgeries.processCcInstance();

        oncologySurgeries.processCcCssSectionBehaviorFuture();
        oncologySurgeries.processCcCssSectionBehaviorCompleted();
        oncologySurgeries.processCcCssSectionBehaviorLPFuture();
        oncologySurgeries.processCcCssSectionBehaviorOutside();
        oncologySurgeries.processCcCssSectionBehaviorLPCompleted();
        oncologySurgeries.processCcCssSectionBehaviorOncologySurgeries();

        component.eApps.CSSBehaviors.InitPopUpsZstripe('div#' + component.eApps.cc_id + ' .rowPopup');
    }

};
chla.OncologyPtInfo = function () { };
chla.OncologyPtInfo.prototype = new MPage.Component();
chla.OncologyPtInfo.prototype.constructor = MPage.Component;
chla.OncologyPtInfo.prototype.base = MPage.Component.prototype;
chla.OncologyPtInfo.prototype.name = "chla.OncologyPtInfo";
chla.OncologyPtInfo.prototype.cclProgram = "chla_ca_mp_md_onc_ptinfo"; //_CCL_init_
chla.OncologyPtInfo.prototype.cclParams = [];
chla.OncologyPtInfo.prototype.cclDataType = "JSON";
chla.OncologyPtInfo.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("encounterId");
    this.cclParams[2] = this.getProperty("userId");
};

chla.OncologyPtInfo.prototype.render = function () {
    var component = this,
        elementObj,
        target,
        compContent;
    var CC_SectMgt = null,
        CC_CssBehavior = null,
        gFuncs = null,
        htmlSecCtl = null,
        htmlSecCtlObj = null,
        htmlSecCtlData = null,
        CclReqObjSave = null,
        OncologyPtInfo = {
            initOnly: false,
            cc_id: 'x',
            personId: 0,
            encounterId: 0,
            prsnlId: 0,
            transparentSpacer: '',

            CC_SectionManagement: {
            },
            mainSection: '',
            mainSectionEnd:'',
            H5_Section_Type1: '',
            H5_Section_Type2: '',
            H6_Section_Type3: '',
            CC_Tmpls: {
                mainDiv: [
                    '<div id="<#=cc_id#>" class="eapps_CC">',
                    '<#=mainSection#>',
                    '<#=mainSectionEnd#>',
                    '</div>'
                ],
                BodyContent: [
                    '<table>',
                    '<tr><td style="min-width: 120px; width:35%;background: #F6F6F6;">Chief Complaint:</td><td  width="65%"><#=Visitinfo#></td></tr>',
                    '<tr><td style="background: #F6F6F6;">Reason for Visit:</td><td><#=VisitReason#></td></tr>',
                    '<tr><td style="background: #F6F6F6;">Primary Physician:</td><td><#=PrimPhy#></td></tr>',
                    //'<tr><td style="background: #F6F6F6;">Referring Physician:</td><td><#=RefPhy#></td></tr>',
                    '<tr><td style="background: #F6F6F6;">Admitting Physician:</td><td><#=AdmPhy#></td></tr>',
                    '<tr><td style="background: #F6F6F6;">Attending Physician:</td><td><#=AttnPhy#></td></tr>',
                    '<tr><td style="background: #F6F6F6;">Primary Hematologist/ Oncologist - Life:</td><td><#=PrimOncol#></td></tr>',
                    '<tr><td style="background: #F6F6F6;">Primary NP:</td><td><#=PrimNP#></td></tr>',
                    '<tr><td style="background: #F6F6F6;">Primary Fellow:</td><td><#=PrimFellow#></td></tr>',
                    '<tr><td style="background: #F6F6F6;">Primary Care Manager:</td><td><#=PrimCM#></td></tr>',
                    '<tr><td style="background: #F6F6F6;">Primary Social Worker:</td><td><#=PrimSW#></td></tr>',
                    '<tr><td style="background: #F6F6F6;">Advance Directive:</td><td><#=advdir#></td></tr>',
                    '<tr><td style="background: #F6F6F6;">Last Visit:</td><td><#=LastVisit#></td></tr>',
                    //'<tr><td style="background: #F6F6F6;">Code Status:</td><td><#=CodeStatus#></td></tr>',
                    '</table>'
                ]
            },
            processRPTDATA_main_data: function () {
                var i, primNPs, primFellows, primCMs, primSWs;
                var primNPCnt = elementObj.PRIMARY_NP_LIFE_CNT;
                var primFellowCnt = elementObj.PRIMARY_FELLOW_LIFE_CNT;
                var primCMCnt = elementObj.PRIMARY_CM_LIFE_CNT;
                var primSWCnt = elementObj.PRIMARY_SW_LIFE_CNT;

                for ( i = 0; i < primNPCnt; i++) {
                    if (i == 0)
                        primNPs = elementObj.PRIMARY_NP_LIFE[i].PRIMARY_NP_NAME;
                    else
                        primNPs = primNPs + ", " + elementObj.PRIMARY_NP_LIFE[i].PRIMARY_NP_NAME;
                }

                for ( i = 0; i < primFellowCnt; i++) {
                    if (i == 0)
                        primFellows = elementObj.PRIMARY_FELLOW_LIFE[i].PRIMARY_FELLOW_NAME;
                    else
                        //primFellows = primFellows + ", " + elementObj.PRIMARY_NP_LIFE[i].PRIMARY_FELLOW_NAME;
                        primFellows = primFellows + ", " + elementObj.PRIMARY_FELLOW_LIFE[i].PRIMARY_FELLOW_NAME;
                }

                for ( i = 0; i < primCMCnt; i++) {
                    if (i == 0)
                        primCMs = elementObj.PRIMARY_CM_LIFE[i].PRIMARY_CM_NAME;
                    else
                        primCMs = primCMs + ", " + elementObj.PRIMARY_CM_LIFE[i].PRIMARY_CM_NAME;
                }

                for ( i = 0; i < primSWCnt; i++) {
                    if (i == 0)
                        primSWs = elementObj.PRIMARY_SW_LIFE[i].PRIMARY_SW_NAME;
                    else
                        primSWs = primSWs + ", " + elementObj.PRIMARY_SW_LIFE[i].PRIMARY_SW_NAME;
                }
                OncologyPtInfo.mainSection=  gFuncs.parseTemplate(OncologyPtInfo.CC_Tmpls.BodyContent.join(''), {
                    Visitinfo: elementObj.VISIT_REASON,
                    VisitReason: elementObj.REASON_FOR_VISIT,
                    PrimPhy:  elementObj.PRIMARY_NAME,
                    //RefPhy: elementObj.REFERRING_NAME,
                    AdmPhy: elementObj.ADMITTING_NAME,
                    AttnPhy: elementObj.ATTENDING_NAME,
                    PrimOncol:  elementObj.ONCOLOGIST_NAME,
                    PrimNP:  primNPs,
                    PrimFellow:  primFellows,
                    PrimCM:  primCMs,
                    PrimSW:  primSWs,
                    advdir:     elementObj.ADV_DIRECTIVE,
                    LastVisit:  elementObj.LAST_VISIT,
                    //CodeStatus: ' No Result found '
                });

            },
            processCcInstance: function () {
                compContent = gFuncs.parseTemplate(OncologyPtInfo.CC_Tmpls.mainDiv.join(''), {
                    cc_id: OncologyPtInfo.cc_id,
                    mainSection: OncologyPtInfo.mainSection,
                    mainSectionEnd: OncologyPtInfo.mainSectionEnd
                });
                gFuncs.Log_CC( component, compContent);
                target.innerHTML = compContent;
            },
            init: function () {
                var subHeaderDisplay;

                elementObj = component.data.RPTDATA;
                target = component.getTarget();

                component.eApps = {
                    cc_id: component.name.replace('.', '_'),
                    CSSBehaviors: chla.eApps.gCSSBehaviors.neo(),
                    TestSAP: null
                };
                OncologyPtInfo.initOnly = ChlaStdClass.safeRead( chla,'eApps','operationMode') == 'test' ||
                    ChlaStdClass.safeRead( chla,'eApps','OncologyPtInfo','operationMode') == 'OncologyPtInfoTest' ;
                OncologyPtInfo.cc_id = component.eApps.cc_id;
                OncologyPtInfo.personId = component.getProperty("personId");
                OncologyPtInfo.encounterId = component.getProperty("encounterId");
                OncologyPtInfo.prsnlId = component.getProperty("userId");
                component.eApps.TestSAP= OncologyPtInfo.TestServiceAccessPoint;

                gFuncs = chlaNsMgr.aliasDirector('chla.eApps.gFuncs');
            },
            TestServiceAccessPoint: function (){
                return {
                    TestProcessRPTDATA_main: OncologyPtInfo.processRPTDATA_main_data,
                    TestProcessCcInstance: OncologyPtInfo.processCcInstance
                };
            }
        };
    OncologyPtInfo.init();
    if (OncologyPtInfo.initOnly == false) {
        OncologyPtInfo.processRPTDATA_main_data();
        OncologyPtInfo.processCcInstance();
    }
};

//::===========================================================================
//:: CC - HearingOrder Module
//::---------------------------------------------------------------------------
chla.HearingOrder = function () { };
chla.HearingOrder.prototype = new MPage.Component();
chla.HearingOrder.prototype.constructor = MPage.Component;
chla.HearingOrder.prototype.base = MPage.Component.prototype;
chla.HearingOrder.prototype.name = "chla.HearingOrder";
chla.HearingOrder.prototype.cclProgram = "chla_ca_mp_cc_nb_hearing_json";
chla.HearingOrder.prototype.cclParams = [];
chla.HearingOrder.prototype.cclDataType = "JSON";
chla.HearingOrder.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("encounterId");
    this.cclParams[2] = this.getProperty("personId");
    this.cclParams[3] = this.getProperty("userId");
};                                                              // end of  section for call to LoadCCL
//-----------------------------------------------------------------------------------------------------------------
chla.HearingOrder.prototype.render = function () {
    var component = this,
        elementObj,
        target,
        compContent;
    var CC_SectMgt = null,
        CC_CssBehavior = null,
        gFuncs = null,
        htmlSecCtl = null,
        htmlSecCtlObj = null,
        HearingOrder = {
            initOnly: false,
            cc_id: 'x',
            personId: 0,
            encounterId: 0,
            prsnlId: 0,
            transparentSpacer: '',
            CC_SectionManagement: {
                sectionlist: []
            },
            mainSection: '',
            mainSectionEnd:'',
            HearingOrderTAval: '',
            HearingOrderRadYChecked:'checked',
            HearingOrderRadNChecked: '',
            CC_Tmpls: {
                mainDiv: [
                    '<div id="cc_id" class="eapps_CC">',
                    '<#=mainSection#>',
                    '<#=mainSectionEnd#>',
                    '</div>'
                ],
                Row_template: [
                    '<tr <#=ROWODDS#>><td style="padding-left:22px; width:30px;">',
                    '<span class="<#=learningComplete#>"  style="color: transparent; font-size: 14px;">MM</span></td>', //;>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td>',
                    '<td ><#=ORDER_MNEMONIC#></td></tr>'
                ],
                NoRow_template: [
                    '<tr <#=ROWODDS#>><td style="padding-left: 2px; width:30px;" >&nbsp;</td><td>',
                    '<span>No hearing screen order has been placed for this patient on this encounter</span></td></tr>'
                ],
                Table_template: [
                    '<table class="header" style="width:100%;"><tr><thead>',
                    '<th style="width:50px;text-align:center;">Status</th><th >Name</th>',
                    '</thead></tr><tbody><#=tableBody#></tbody></table>',
                    '<div id="HearingOrderformat" style="margin-top: 5px;">',
                    '<br/><dl><dt style="float: left;clear:left;padding-left:2px;">Hearing test needed:&nbsp;&nbsp;</dt>',
                    '<dd style="float: left;width:180px; ">',
                    '<input type="Radio" name="HearingOrderRadButton" id="HearingOrderRadY" <#=HearingOrderRadYChecked#> />&nbsp;Yes&nbsp;&nbsp;',
                    '<input type="Radio" name="HearingOrderRadButton" id="HearingOrderRadN" <#=HearingOrderRadNChecked#> />&nbsp;No&nbsp;</dd></dl><br/>',
                    '<br><textarea rows="4" cols="40" id="HearingOrderTA" style="margin-bottom: 3px;width: 97%;">',
                    '<#=HearingOrderTAval#></textarea>',
                    '<br/><button id="HearingOrderBtnSave" class="eappsBtnGrey">Save</button>',
                    '</div>'
                ]
            },
            processRPTDATA_main_data: function () {
                var i,
                    lencnt,
                    wrkResult = '',
                    wrkValue, oddEvenFlag = '',
                    filterValue = 'CompletedOrdered';
                HearingOrder.mainSection= '';
                HearingOrder.HearingOrderTAval= ChlaStdClass.safeRead(elementObj,'CADDTL_AUDIO_TEST_DETAILS');
                wrkValue = ChlaStdClass.safeRead(elementObj,'CAUDIO_TEST_NEEDED');

                chla.eApps.Logger.LogInfo('CAUDIO_TEST_NEEDED: ' + wrkValue);
                if (wrkValue == 1){
                    HearingOrder.HearingOrderRadNChecked = 'checked';
                    HearingOrder.HearingOrderRadYChecked= '';
                } else {
                    HearingOrder.HearingOrderRadNChecked = '';
                    HearingOrder.HearingOrderRadYChecked = 'checked';
                }

                if(elementObj.ORDER_CNT > 0 ) {

                    for ( i=0,lencnt= elementObj.ORDER_CNT ; i < lencnt ; i++) {
                        if  (filterValue.indexOf(elementObj.ORDERS[i].ORDER_STATUS )> -1){
                            wrkResult += gFuncs.parseTemplate(HearingOrder.CC_Tmpls.Row_template.join(''), {
                                ROWODDS: "" ,
                                learningComplete: (elementObj.ORDERS[i].ORDER_STATUS == 'Ordered'? 'learning_incomplete': 'learning_complete'),
                                ORDER_MNEMONIC:  elementObj.ORDERS[i].ORDER_MNEMONIC
                            });
                            /* if (elementObj.ORDERS[i].ORDER_STATUS == 'Completed'){
                             HearingOrder.HearingOrderRadNChecked = '';
                             HearingOrder.HearingOrderRadYChecked = 'checked';
                             } */
                        }
                    }
                    if (wrkResult == ''){
                        wrkResult = gFuncs.parseTemplate(HearingOrder.CC_Tmpls.NoRow_template.join(''), { ROWODDS: "" });
                        HearingOrder.mainSection = gFuncs.parseTemplate(HearingOrder.CC_Tmpls.Table_template.join(''), {
                            tableBody: wrkResult,
                            HearingOrderRadYChecked: HearingOrder.HearingOrderRadYChecked,
                            HearingOrderRadNChecked: HearingOrder.HearingOrderRadNChecked,
                            HearingOrderTAval: HearingOrder.HearingOrderTAval
                        });
                    } else {
                        HearingOrder.mainSection = gFuncs.parseTemplate(HearingOrder.CC_Tmpls.Table_template.join(''), {
                            tableBody: wrkResult,
                            HearingOrderRadYChecked: HearingOrder.HearingOrderRadYChecked,
                            HearingOrderRadNChecked: HearingOrder.HearingOrderRadNChecked,
                            HearingOrderTAval: HearingOrder.HearingOrderTAval
                        });
                    }
                } else if (elementObj.ORDER_CNT == 0 && elementObj.UPDT_CNT > 0) {
                    wrkResult = gFuncs.parseTemplate(HearingOrder.CC_Tmpls.NoRow_template.join(''), { ROWODDS: "" });
                    wrkValue = ChlaStdClass.safeRead(elementObj,'CAUDIO_TEST_NEEDED');
                    if (wrkValue == 1) {
                        HearingOrder.mainSection = gFuncs.parseTemplate(HearingOrder.CC_Tmpls.Table_template.join(''), {
                            tableBody: wrkResult,
                            HearingOrderRadYChecked: '',
                            HearingOrderRadNChecked: 'checked',
                            HearingOrderTAval: HearingOrder.HearingOrderTAval
                        });

                    }   else {

                        HearingOrder.mainSection = gFuncs.parseTemplate(HearingOrder.CC_Tmpls.Table_template.join(''), {
                            tableBody: wrkResult,
                            HearingOrderRadYChecked: 'checked',
                            HearingOrderRadNChecked: '',
                            HearingOrderTAval: HearingOrder.HearingOrderTAval
                        });

                    }

                } else {
                    //HearingOrder.mainSection = 'No hearing screen order has been placed for this patient on this encounter';
                    wrkResult = gFuncs.parseTemplate(HearingOrder.CC_Tmpls.NoRow_template.join(''), { ROWODDS: "" });
                    HearingOrder.mainSection = gFuncs.parseTemplate(HearingOrder.CC_Tmpls.Table_template.join(''), {
                        tableBody: wrkResult,
                        HearingOrderRadYChecked: '',
                        HearingOrderRadNChecked: '',
                        HearingOrderTAval: HearingOrder.HearingOrderTAval
                    });

                }
            },
            processRPTDATA_end_data: function () {
                HearingOrder.mainSectionEnd = '';
                if (elementObj.UPDT_CNT != 'undefined')
                    HearingOrder.HoverDataFormater(elementObj);
            },
            processCcInstance: function () {
                compContent = gFuncs.parseTemplate(HearingOrder.CC_Tmpls.mainDiv.join(''), {
                    cc_id:            HearingOrder.cc_id,
                    mainSection:      HearingOrder['mainSection'],
                    mainSectionEnd:   HearingOrder['mainSectionEnd']
                });
                gFuncs.Log_CC( component, compContent);
                target.innerHTML = compContent;
            },
            processCcCssButtonBehavior1: function (){
                component.eApps.CCLreqObjSave = null;
                component.eApps.CCLparmsSave = [];
                component.eApps.CSSBehaviors.InitPopUpsDiv(
                    HearingOrder.HoverDataFormater( elementObj), 'button#HearingOrderBtnSave', 'T');

                $("#HearingOrderBtnSave").on( "click", function () {
                    var RadioButton1 = 0,
                        HearingOrderTADetails = "";

                    RadioButton1 = ($('div#HearingOrderformat input#HearingOrderRadN').prop('checked')== true )? 1 : 0 ;
                    HearingOrderTADetails = ($("#HearingOrderTA").val()!== "" )? $("#HearingOrderTA").val(): '';
                    component.eApps.CCLparmsSave.length = 0 ;
                    component.eApps.CCLparmsSave.push('^MINE^');
                    component.eApps.CCLparmsSave.push('value($VIS_Encntrid$)');
                    component.eApps.CCLparmsSave.push(RadioButton1);
                    component.eApps.CCLparmsSave.push('^' + HearingOrderTADetails + '^');
                    component.eApps.CCLparmsSave.push('value($USR_PersonID$)');

                    chla.eApps.Logger.LogInfo('HearingOrderRadN,  HearingOrderTADetail: ' +
                        RadioButton1+ ':: ' + HearingOrderTADetails);
                    chla.eApps.Logger.LogInfo('chla.HearingOrder.eApps.CCLparmsSave: ' + component.eApps.CCLparmsSave.join());

                    if (component.eApps.CCLreqObjSave == null){
                        component.eApps.CCLreqObjSave = new chla.eApps.CCLRequest.BtnSaveBehavior();
                        component.eApps.CCLreqObjSave.ObjectName='OBJ_chla.HearingOrder.eApps.CCLreqObjSave';
                        component.eApps.CCLreqObjSave.BtnSaveBehaviorFunc = component.eApps.SaveButtonAction ;

                        component.eApps.CCLreqObjSave.CallBackOperation = function(responseData){
                            component.eApps.CSSBehaviors.hoverContent =
                                HearingOrder.HoverDataFormater(responseData);
                        };
                    };
                    chla.eApps.Logger.LogInfo(' CCLREPORT: CHLA_CA_CC_INS_NB_HEAR_JSON2 ' );
                    chla.eApps.Logger.LogInfo('chla.HearingOrder.eApps.CCLparmsSave: ' + component.eApps.CCLparmsSave.join());
                    component.eApps.CCLreqObjSave.DataTransfer(
                        component.eApps.CCLreqObjSave,
                        'CHLA_CA_CC_INS_NB_HEAR_JSON2',
                        component.eApps.CCLparmsSave.join()  ,
                        'button#HearingOrderBtnSave');
                });
                component.eApps.SaveButtonAction('#HearingOrderBtnSave', 'RESET');
                $('#HearingOrderTA').on( "click", function () {
                    component.eApps.SaveButtonAction('#HearingOrderBtnSave', 'ENABLE') ;
                });
                $('#HearingOrderRadY').on( "click", function () {
                    component.eApps.SaveButtonAction('#HearingOrderBtnSave', 'ENABLE') ;
                });
                $('#HearingOrderRadN').on( "click", function () {
                    component.eApps.SaveButtonAction('#HearingOrderBtnSave', 'ENABLE') ;
                });
            },
            HoverDataFormater:  function (sourceData) {
                var tempstr = '<span style="font-weight:bold;">Update History</span></br>',
                    tempstr1 = '',
                    RadioButton1 = 0,
                    RadioButton2 = 0,
                    HearingOrderTADetails = "",
                    LastNoButton = 0,
                    LastHearingOrderTADetails = "",
                    dirty,
                    dirty2,
                    lencnt;
                lencnt = sourceData.UPDT_CNT ;
                //lencnt = 0;
                for (var i = 0; i < lencnt; i ++) {
                    dirty = false;
                    dirty2 = true;
                    tempstr1 = '';
                    RadioButton1 = sourceData.UPDT_LIST[i].UAUDIO_TEST_NEEDED ;
                    HearingOrderTADetails =(sourceData.UPDT_LIST[i].UADDTL_AUDIO_TEST_DETAILS ||'');

                    if( i ==(lencnt - 1)  ){
                        if ( lencnt < 11){
                            if (RadioButton1!= null ){
                                tempstr1 =  '&nbsp;&nbsp; Hearing test needed Update -' + (RadioButton1 == 1 ? 'No' : 'Yes');
                                dirty = true;
                            }
                            if (HearingOrderTADetails.length > 0 ){
                                tempstr1 += '&nbsp;&nbsp; Hearing Order Comments Update  -'  ;
                                dirty = true;
                            }
                        }
                        dirty2= false;
                    }
                    if (dirty2 == true){
                        if (RadioButton1 != sourceData.UPDT_LIST[i+1].UAUDIO_TEST_NEEDED ){
                            tempstr1 =   '&nbsp;&nbsp; Hearing test needed Update -' + (RadioButton1 == 1 ? 'No' : 'Yes');
                            dirty = true;
                        }
                        if (HearingOrderTADetails != sourceData.UPDT_LIST[i+1].UADDTL_AUDIO_TEST_DETAILS ){
                            tempstr1 += '&nbsp;&nbsp; Hearing Order Comments Update  -'  ;
                            dirty = true;
                        }
                    }
                    if (dirty == true){
                        tempstr += sourceData.UPDT_LIST[i].UUPDT_MODBY_ID ;
                        tempstr += ' on ';
                        tempstr += sourceData.UPDT_LIST[i].UUPDTDATETIME ;
                        tempstr += tempstr1;
                        tempstr +=  "</br>" ;
                    }
                    LastHearingOrderTADetails = HearingOrderTADetails;
                    LastNoButton = RadioButton1;
                };
                return tempstr ;
            },
            init: function () {
                var subHeaderDisplay,
                    SectionCfg,
                    htmlSecCtlData,
                    initSecData;

                elementObj = component.data.RPTDATA;
                target = component.getTarget();

                component.eApps = {
                    cc_id: component.name.replace('.', '_'),
                    CSSBehaviors: chla.eApps.gCSSBehaviors.neo(),
                    SaveButtonAction: chla.eApps.SaveButtonBehavior.enable_disable_status_reset,
                    TestSAP: null
                };
                HearingOrder.initOnly = ChlaStdClass.safeRead( chla,'eApps','operationMode') == 'test' ||
                    ChlaStdClass.safeRead( chla,'eApps','HearingOrder','operationMode') == 'HearingOrderTest' ;
                HearingOrder.cc_id = component.eApps.cc_id;
                HearingOrder.personId = component.getProperty("personId");
                HearingOrder.encounterId = component.getProperty("encounterId");
                HearingOrder.prsnlId = component.getProperty("userId");
                component.eApps.TestSAP= HearingOrder.TestServiceAccessPoint;

                CC_CssBehavior = component.eApps.CSSBehaviors;
                gFuncs = chlaNsMgr.aliasDirector('chla.eApps.gFuncs');
            },
            TestServiceAccessPoint: function (){
                return {
                    TestProcessRPTDATA_main: HearingOrder.processRPTDATA_main_data,
                    TestProcessRPTDATA_end: HearingOrder.processRPTDATA_end_data,
                    TestProcessCcInstance: HearingOrder.processCcInstance,
                    TestProcessCcCssButtonBehavior1: HearingOrder.processCcCssButtonBehavior1
                };
            }
        };
    HearingOrder.init();
    if (HearingOrder.initOnly == false) {
        HearingOrder.processRPTDATA_main_data(elementObj);
        HearingOrder.processRPTDATA_end_data(elementObj);
        HearingOrder.processCcInstance();
        HearingOrder.processCcCssButtonBehavior1();
    }

};
// ::===========================================================================
// :: CC - CTSurgeryNotes Module
// ::---------------------------------------------------------------------------
chla.CTSurgeryNotes = function() {};
chla.CTSurgeryNotes.prototype = new MPage.Component();
chla.CTSurgeryNotes.prototype.constructor = MPage.Component;
chla.CTSurgeryNotes.prototype.base = MPage.Component.prototype;
chla.CTSurgeryNotes.prototype.name = 'chla.CTSurgeryNotes';
chla.CTSurgeryNotes.prototype.cclProgram = 'chla_ca_mp_cc_ctsurg_note_json';
chla.CTSurgeryNotes.prototype.cclParams = [];
chla.CTSurgeryNotes.prototype.cclDataType = 'JSON';
chla.CTSurgeryNotes.prototype.init = function() {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("encounterId");
    this.cclParams[2] = this.getProperty("personId");
    this.cclParams[3] = this.getProperty("userId");
};
chla.CTSurgeryNotes.prototype.render = function() {
    var component = this,
        elementObj = null,
        target,
        compContent;
    var CC_SectMgt = null,
        CC_CssBehavior = null,
        gFuncs = null,
        htmlSecCtl = null,
        htmlSecCtlObj = null,
        CTSurgeryNotes = {
            initOnly: false,
            cc_id: 'x',
            personId: 0,
            encounterId: 0,
            prsnlId: 0,
            transparentSpacer: '',
            dctextnotes: '',
            CC_Tmpls: {
                mainDiv: [
                    '<div id="<#=cc_id#>" class="eapps_CC">',
                    '<textarea id="ctSurgNtsText" rows="10" style="width:96%;margin-bottom:5px;">',
                    '<#=dctextnotes#></textarea><br/>',
                    '<button id="ctSurgNtsSave" class="eappsBtnGrey">  Save</button></p></div>'
                ]
            },
            processRPTDATA_main_data: function() {
                var i,
                    lencnt,
                    wrkArr = [],
                    wrkValue;
                lencnt = elementObj.CTSURGCNT;
                for (i = 0; i < lencnt; i++) {
                    wrkArr.push(elementObj.CTSURG_LIST[i].CTSURGNOTES);
                    wrkArr.push(' \n');
                }
                wrkValue = wrkArr.join('');
                //CTSurgeryNotes.dctextnotes = wrkValue.replace(/%0D%0A/g, '\n');
                CTSurgeryNotes.dctextnotes = wrkValue.replace(/\\par/g,'\n');
            },
            processCcInstance: function() {
                compContent = gFuncs.parseTemplate(CTSurgeryNotes.CC_Tmpls.mainDiv.join(''), {
                    cc_id: CTSurgeryNotes.cc_id,
                    dctextnotes: CTSurgeryNotes.dctextnotes
                });
                gFuncs.Log_CC(component, compContent);
                target.innerHTML = compContent;
            },
            processCcCssButtonBehavior1: function() {
                $("#ctSurgNtsSave").on("click", function() { // ENCOUNTERID, CTSURG_NOTE, PERSONID, UPDT_MODBY
                    var paramArr = [],
                        wrkValue,
                        wrkCnt;
                    paramArr.push('^MINE^, value($VIS_Encntrid$),^');
                    wrkValue = $('#ctSurgNtsText').val();
                    wrkValue = wrkValue.replace(/\n/g, '\\par ')
                    //wrkCnt = wrkValue.indexOf('###--');
                    //paramArr.push((wrkCnt > -1? wrkValue.substring(0,(wrkCnt -1)): wrkValue));
                    paramArr.push(wrkValue);
                    paramArr.push('^,value($PAT_PersonID$),  value($USR_PersonID$)');
                    component.eApps.CCLparmsSave = paramArr.join('');
                    if (component.eApps.CCLreqObjSave === null) {
                        component.eApps.CCLreqObjSave = new chla.eApps.CCLRequest.BtnSaveBehavior();
                        component.eApps.CCLreqObjSave.ObjectName = 'OBJ_component.eApps.CCLreqObjSave';
                        component.eApps.CCLreqObjSave.BtnSaveBehaviorFunc = component.eApps.SaveButtonAction;
                        component.eApps.CCLreqObjSave.CallBackOperation = function(responseData) {
                            component.eApps.CSSBehaviors.hoverContent = component.eApps.HoverDataFormater(responseData);
                        };
                    }
                    component.eApps.CCLreqObjSave.DataTransfer(
                        component.eApps.CCLreqObjSave,
                        'chla_ca_mp_cc_ins_ctsnote_json',
                        component.eApps.CCLparmsSave,
                        '#ctSurgNtsSave');
                });
                component.eApps.SaveButtonAction('#ctSurgNtsSave', 'RESET');
            },
            processCcCssButtonBehavior2: function() {
                component.eApps.CCLreqObjSave = null;

                component.eApps.CSSBehaviors = new chla.eApps.CSSBehaviors();
                component.eApps.HoverDataFormater =  function (sourceData) {
                    wrkValue = '<span style="font-weight:bold;">Update History</span></br>';
                    wrkCnt = sourceData.UPDT_CNT ;
                    for (var i = 0; i < wrkCnt; i ++) {
                        wrkValue += sourceData.UPDT_LIST[i].UPDT_MODBY_ID ;
                        wrkValue += ' on ';
                        wrkValue += sourceData.UPDT_LIST[i].UPDTDATETIME ;
                        wrkValue +=  "</br>" ;
                    };
                    return wrkValue ;
                };
                component.eApps.CSSBehaviors.InitPopUpsDiv(
                    component.eApps.HoverDataFormater(elementObj),
                    'button#ctSurgNtsSave', 'T');
            },
            processCcCssControlBehavior1: function() {
                $("#ctSurgNtsText").on("click", function() {
                    component.eApps.SaveButtonAction('#ctSurgNtsSave', 'ENABLE');
                });
            },
            init: function() {
                var subHeaderDisplay,
                    SectionCfg,
                    htmlSecCtlData,
                    initSecData;
                elementObj = component.data.RPTDATA;
                target = component.getTarget();
                component.eApps = {
                    cc_id: component.name.replace('.', '_'),
                    CSSBehaviors: chla.eApps.gCSSBehaviors.neo(),
                    SaveButtonAction: chla.eApps.SaveButtonBehavior.enable_disable_status_reset,
                    TestSAP: null
                };
                CTSurgeryNotes.initOnly = ChlaStdClass.safeRead(chla, 'eApps',
                        'operationMode') === 'test' ||
                    ChlaStdClass.safeRead(chla, 'eApps', 'CTSurgeryNotes',
                        'operationMode') === 'CTSurgeryNotesTest';
                CTSurgeryNotes.cc_id = component.eApps.cc_id;
                CTSurgeryNotes.personId = component.getProperty('personId');
                CTSurgeryNotes.encounterId = component.getProperty('encounterId');
                CTSurgeryNotes.prsnlId = component.getProperty('userId');
                component.eApps.TestSAP = CTSurgeryNotes.TestServiceAccessPoint;
                CTSurgeryNotes.transparentSpacer = '<img src="' +
                    chla.eApps.Vars.transparentSpacer +
                    '" height="5px" width="17px"  >';
                gFuncs = chlaNsMgr.aliasDirector('chla.eApps.gFuncs');
            },
            TestServiceAccessPoint: function() {
                return {
                    TestProcessRPTDATA_main: CTSurgeryNotes.processRPTDATA_main_data,
                    TestProcessCcInstance: CTSurgeryNotes.processCcInstance,
                    TestProcessCcCssButtonBehavior_1: CTSurgeryNotes.processCcCssButtonBehavior1,
                    TestProcessCcCssButtonBehavior_2: CTSurgeryNotes.processCcCssButtonBehavior2,
                    TestProcessCcCssControlBehavior_1: CTSurgeryNotes.processCcCssControlBehavior1
                };
            }
        };
    CTSurgeryNotes.init();
    if (CTSurgeryNotes.initOnly === false) {
        CTSurgeryNotes.processRPTDATA_main_data(elementObj);
        CTSurgeryNotes.processCcInstance();
        CTSurgeryNotes.processCcCssButtonBehavior1();
        CTSurgeryNotes.processCcCssButtonBehavior2();
        CTSurgeryNotes.processCcCssControlBehavior1();
    }
};
// ::===========================================================================
// :: CC - HemOncNotes Module
// ::---------------------------------------------------------------------------
chla.HemOncNotes = function() {};
chla.HemOncNotes.prototype = new MPage.Component();
chla.HemOncNotes.prototype.constructor = MPage.Component;
chla.HemOncNotes.prototype.base = MPage.Component.prototype;
chla.HemOncNotes.prototype.name = 'chla.HemOncNotes';
chla.HemOncNotes.prototype.cclProgram = 'chla_ca_mp_cc_hemonc_note_json';
chla.HemOncNotes.prototype.cclParams = [];
chla.HemOncNotes.prototype.cclDataType = 'JSON';
chla.HemOncNotes.prototype.init = function() {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("encounterId");
    this.cclParams[2] = this.getProperty("personId");
    this.cclParams[3] = this.getProperty("userId");
};
chla.HemOncNotes.prototype.render = function() {
    var component = this,
        elementObj = null,
        target,
        compContent;
    var CC_SectMgt = null,
        CC_CssBehavior = null,
        gFuncs = null,
        htmlSecCtl = null,
        htmlSecCtlObj = null,
        HemOncNotes = {
            initOnly: false,
            cc_id: 'x',
            personId: 0,
            encounterId: 0,
            prsnlId: 0,
            transparentSpacer: '',
            dctextnotes: '',
            CC_Tmpls: {
                mainDiv: [
                    '<div id="<#=cc_id#>" class="eapps_CC">',
                    '<textarea id="hemOncNtsText" rows="10" style="width:96%;margin-bottom:5px;">',
                    '<#=dctextnotes#></textarea><br/>',
                    '<button id="hemOncNtsSave" class="eappsBtnGrey">  Save</button></p></div>'
                ]
            },
            processRPTDATA_main_data: function() {
                var i,
                    lencnt,
                    wrkArr = [],
                    wrkValue;
                lencnt = elementObj.HEMONCNT;
                for (i = 0; i < lencnt; i++) {
                    wrkArr.push(elementObj.HEMOC_LIST[i].HEMONCNOTES);
                    wrkArr.push('\n');
                }
                wrkValue = wrkArr.join('');
                //HemOncNotes.dctextnotes = wrkValue.replace(/%0D%0A/g, '\n');
                HemOncNotes.dctextnotes = wrkValue.replace(/\\par/g, '\n');
            },
            processCcInstance: function() {
                compContent = gFuncs.parseTemplate(HemOncNotes.CC_Tmpls.mainDiv.join(''), {
                    cc_id: HemOncNotes.cc_id,
                    dctextnotes: HemOncNotes.dctextnotes
                });
                gFuncs.Log_CC(component, compContent);
                target.innerHTML = compContent;
            },
            processCcCssButtonBehavior1: function() {
                $("#hemOncNtsSave").on("click", function() { // ENCOUNTERID, HEMONC_NOTE, UPDT_MODBY, PERSONID, USERID
                    var paramArr = [],
                        wrkValue,
                        wrkCnt;
                    paramArr.push('^MINE^, value($VIS_Encntrid$),^');
                    wrkValue = $('#hemOncNtsText').val();
                    wrkValue = wrkValue.replace(/\n/g,'\\par ')
                    //wrkCnt = wrkValue.indexOf('###--');
                    //paramArr.push((wrkCnt > -1? wrkValue.substring(0,(wrkCnt -1)): wrkValue));
                    paramArr.push( wrkValue);
                    paramArr.push('^,value($PAT_PersonID$),  value($USR_PersonID$)');
                    component.eApps.CCLparmsSave = paramArr.join('');
                    if (component.eApps.CCLreqObjSave === null) {
                        component.eApps.CCLreqObjSave = new chla.eApps.CCLRequest.BtnSaveBehavior();
                        component.eApps.CCLreqObjSave.ObjectName = 'OBJ_component.eApps.CCLreqObjSave';
                        component.eApps.CCLreqObjSave.BtnSaveBehaviorFunc = component.eApps.SaveButtonAction;
                        component.eApps.CCLreqObjSave.CallBackOperation = function(responseData) {
                            component.eApps.CSSBehaviors.hoverContent = component.eApps.HoverDataFormater(responseData);
                        };
                    }
                    component.eApps.CCLreqObjSave.DataTransfer(component.eApps.CCLreqObjSave,
                        'chla_ca_mp_cc_ins_hemonc_json',
                        component.eApps.CCLparmsSave,
                        '#hemOncNtsSave');
                });
                component.eApps.SaveButtonAction('#hemOncNtsSave', 'RESET');
            },
            processCcCssButtonBehavior2: function() {
                component.eApps.CCLreqObjSave = null;

                component.eApps.CSSBehaviors = new chla.eApps.CSSBehaviors();
                component.eApps.HoverDataFormater =  function (sourceData) {
                    wrkValue = '<span style="font-weight:bold;">Update History</span></br>';
                    wrkCnt = sourceData.UPDT_CNT ;
                    for (var i = 0; i < wrkCnt; i ++) {
                        wrkValue += sourceData.UPDT_LIST[i].UPDT_MODBY_ID ;
                        wrkValue += ' on ';
                        wrkValue += sourceData.UPDT_LIST[i].UPDTDATETIME ;
                        wrkValue +=  "</br>" ;
                    };
                    return wrkValue ;
                };
                component.eApps.CSSBehaviors.InitPopUpsDiv(
                    component.eApps.HoverDataFormater(elementObj),
                    'button#hemOncNtsSave', 'T');
            },
            processCcCssControlBehavior1: function() {
                $("#hemOncNtsText").on("click", function() {
                    component.eApps.SaveButtonAction('#hemOncNtsSave', 'ENABLE');
                });
            },
            init: function() {
                var subHeaderDisplay,
                    SectionCfg,
                    htmlSecCtlData,
                    initSecData;
                elementObj = component.data.RPTDATA;
                target = component.getTarget();
                component.eApps = {
                    cc_id: component.name.replace('.', '_'),
                    CSSBehaviors: chla.eApps.gCSSBehaviors.neo(),
                    SaveButtonAction: chla.eApps.SaveButtonBehavior.enable_disable_status_reset,
                    TestSAP: null
                };
                HemOncNotes.initOnly = ChlaStdClass.safeRead(chla, 'eApps', 'operationMode') === 'test' ||
                    ChlaStdClass.safeRead(chla, 'eApps', 'HemOncNotes', 'operationMode') === 'HemOncNotesTest';
                HemOncNotes.cc_id = component.eApps.cc_id;
                HemOncNotes.personId = component.getProperty('personId');
                HemOncNotes.encounterId = component.getProperty('encounterId');
                HemOncNotes.prsnlId = component.getProperty('userId');
                component.eApps.TestSAP = HemOncNotes.TestServiceAccessPoint;
                HemOncNotes.transparentSpacer = '<img src="' +
                    chla.eApps.Vars.transparentSpacer +
                    '" height="5px" width="17px"  >';
                gFuncs = chlaNsMgr.aliasDirector('chla.eApps.gFuncs');
            },
            TestServiceAccessPoint: function() {
                return {
                    TestProcessRPTDATA_main: HemOncNotes.processRPTDATA_main_data,
                    TestProcessCcInstance: HemOncNotes.processCcInstance,
                    TestProcessCcCssButtonBehavior_1: HemOncNotes.processCcCssButtonBehavior1,
                    TestProcessCcCssButtonBehavior_2: HemOncNotes.processCcCssButtonBehavior2,
                    TestProcessCcCssControlBehavior_1: HemOncNotes.processCcCssControlBehavior1
                };
            }
        };
    HemOncNotes.init();
    if (HemOncNotes.initOnly === false) {
        HemOncNotes.processRPTDATA_main_data(elementObj);
        HemOncNotes.processCcInstance();
        HemOncNotes.processCcCssButtonBehavior1();
        HemOncNotes.processCcCssButtonBehavior2();
        HemOncNotes.processCcCssControlBehavior1();
    }
};
//::===========================================================================
//:: CC - End of Sections --------------------------------------------------------------
//::---------------------------------------------------------------------------


//Withdrawal Prevention Protocol
chla.wpp = function () { };
chla.wpp.prototype = new MPage.Component();
chla.wpp.prototype.constructor = MPage.Component;
chla.wpp.prototype.base = MPage.Component.prototype;
chla.wpp.prototype.name = "chla.wpp";
chla.wpp.prototype.cclProgram = "";
//chla.wpp.prototype.cclParams = [];
//chla.wpp.prototype.cclDataType = "JSON";
//chla.wpp.prototype.init = function (options) {
//    this.cclParams[0] = "MINE";
//    this.cclParams[1] = this.getProperty("encounterId");
//};

chla.wpp.prototype.render = function () {
    var component = this,
        target,
        compContent,
        wrkArr =[
            '<div id="<#=cc_id#>" class="eapps_CC">',
            '<p style="padding:5px 10px ;"><a href="javascript:APPLINK(100,&quot;https://wpp.vpicu.net/&quot;,&quot;&quot;)">Withdrawal Prevention Protocol Wean Calculator</a></p>',
            '<p style="padding:5px 10px;"><a href="javascript:APPLINK(100,&quot;https://nicu.shinyapps.io/feedingcalc/&quot;,&quot;&quot;)">NICU Feeding Advancement Calculator</a></p>',
            '</div>'
        ],
        gFuncs,
        wpp = {};
    target = component.getTarget();

    component.eApps = {
        cc_id: component.name.replace('.', '_'),
        TestSAP: null
    };
    wpp.cc_id = component.eApps.cc_id;
    wpp.initOnly = ChlaStdClass.safeRead(chla, 'eApps', 'operationMode') === 'test' ||
        ChlaStdClass.safeRead(chla, 'eApps', 'wpp', 'operationMode') === 'wppTest';
    gFuncs = chlaNsMgr.aliasDirector('chla.eApps.gFuncs');
    compContent = gFuncs.parseTemplate(wrkArr.join(''), {cc_id: wpp.cc_id });
    gFuncs.Log_CC(component,compContent);
    target.innerHTML = compContent;
};

chla.edDocNotes = function () { };
chla.edDocNotes.prototype = new MPage.Component();
chla.edDocNotes.prototype.constructor = MPage.Component;
chla.edDocNotes.prototype.base = MPage.Component.prototype;
chla.edDocNotes.prototype.name = "chla.edDocNotes";
chla.edDocNotes.prototype.cclProgram = "CHLA_CA_MP_CC_edDocNotes_JSON";
chla.edDocNotes.prototype.cclParams = [];
chla.edDocNotes.prototype.cclDataType = "JSON";
chla.edDocNotes.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("personId");
    this.cclParams[2] = this.getProperty("encounterId");
    this.cclParams[3] = this.getProperty("userId");
};

chla.edDocNotes.prototype.render = function () {
    var component = this,
        elementObj,
        target,
        compContent;
    var CC_SectMgt = null,
        CC_CssBehavior = null,
        gFuncs = null,
        htmlSecCtl = null,
        htmlSecCtlObj = null,
        htmlSecCtlData = null,
        CclReqObjSave = null,
        edDocNotes = {
            initOnly: false,
            cc_id: 'x',
            personId: 0,
            encounterId: 0,
            prsnlId: 0,
            transparentSpacer: '',
            CC_SectionManagement: {
                sectionlist: []
            },
            mainSection: '',
            mainSectionEnd: '',
            H5_Section_ClinicMDNotes: '',
            H5_Section_IPNotes: '',
            H5_Section_HPNotes: '',
            H5_Section_CRPIPC: '',
            H5_Section_EDPN: '',
            H6_Section_Pulm: '',
            H6_Section_Cardio: '',
            H6_Section_Endoc: '',
            H6_Section_Nuerol: '',
            H6_Section_Nueros: '',
            H6_Section_NephRen: '',
            H6_Section_HistPhy: '',
            H6_Section_PHistPhy: '',
            H6_Section_PIPDP: '',
            H6_Section_PORec: '',
            CC_Tmpls: {
                mainDiv: [
                    '<div id="<#=cc_id#>" class="eapps_CC">',
                    '<#=mainSection#>',
                    // '<#=H5_Section_ClinicMDNotes#>',
                    '<#=H5_Section_IPNotes#>',
                    // '<#=H5_Section_HPNotes#>',
                    // '<#=H5_Section_CRPIPC#>',
                    '<#=H5_Section_EDPN#>',
                    '<#=mainSectionEnd#>',
                    '</div>'
                ],
                RowResults: ['<tr <#=ROWODDS#> >',
                    '<td><#=eventdate#></td>',
                    '<td><a onclick="chla.eApps.gFuncs.ReadOnlyMPageUtils(&quot;POWERNOTE&quot;,',
                    '<#=personId#>,<#=encounterId#>,<#=eventId#>);">',
                    '<#=titleLbl#></a></td><td><#=authorby#></td></tr>'
                ],
                RowResultHdr: '<tr><th style="width:25%">Last Updated</th><th style="width:50%">Title</th><th style="width:25%">Author</th></tr>'
            },
            processH6_Sec_All_Data: function (dataObj, sectObj) {
                var i, j, lencnt, dataElement,
                    lentest,
                    listlen,
                    oddEvenFlag,
                    sectionData;
                for (j = 0 , lencnt = sectObj.sectionlist.length; j < lencnt; j++) {
                    sectionData = CC_SectMgt[CC_SectMgt.sectionlist[j]];
                    if (sectionData.SectionLevel == 'H6') {
                        sectionData.Count = 0;
                        sectionData.Body = '';
                        dataElement = null;
                        //H5 sectionData.SectionID: 'ClinicMDNotes  groups the clinic notes
                        lentest = dataObj.PULM_CLINIC_NOTES_CNT
                        if (sectionData.SectionID == 'Pulm' && lentest > 0) {
                            dataElement = dataObj.PULM_CLINIC_NOTES;
                            listlen = lentest;
                        }
                        lentest = dataObj.CARDIO_CLINIC_NOTES_CNT;
                        if (sectionData.SectionID == 'Cardio' && lentest > 0) {
                            dataElement = dataObj.CARDIO_CLINIC_NOTES;
                            listlen = lentest;
                        }
                        lentest = dataObj.ENDOCRN_CLINIC_NOTES_CNT;
                        if (sectionData.SectionID == 'Endoc' && lentest > 0) {
                            dataElement = dataObj.ENDOCRN_CLINIC_NOTES;
                            listlen = lentest;
                        }
                        lentest = dataObj.NEURO_CLINIC_NOTES_CNT;
                        if (sectionData.SectionID == 'Nuerol' && lentest > 0) {
                            dataElement = dataObj.NEURO_CLINIC_NOTES;
                            listlen = lentest;
                        }
                        lentest = dataObj.NEUROSURGERY_CLINIC_NOTES_CNT;
                        if (sectionData.SectionID == 'Nueros' && lentest > 0) {
                            dataElement = dataObj.NEUROSURGERY_CLINIC_NOTES;
                            listlen = lentest;
                        }
                        lentest = dataObj.NEPHRO_CLINIC_NOTES_CNT;
                        if (sectionData.SectionID == 'NephRen' && lentest > 0) {
                            dataElement = dataObj.NEPHRO_CLINIC_NOTES;
                            listlen = lentest;
                        }
                        //H5 sectionData.SectionID: 'IPNotes'       groups the PIPDP notes
                        if (sectionData.SectionID == 'PIPDP') {
                            dataElement = [];
                            dataElement.push(dataObj.IP_DAILY_PROGRESS_NOTE);
                            listlen = dataElement[0].EVENT_ID == '' ? 0 : 1;
                        }
                        if (sectionData.SectionID == 'HistPhy') {
                            dataElement = [];
                            dataElement.push(dataObj.HP_NOTE);
                            listlen = dataElement[0].EVENT_ID == '' ? 0 : 1;
                        }
                        if (sectionData.SectionID == 'PHistPhy') {
                            dataElement = [];
                            dataElement.push(dataObj.PREOP_HP_NOTE);
                            listlen = dataElement[0].EVENT_ID == '' ? 0 : 1;
                        }
                        if (dataElement == null) {
                            listlen = 0;
                        }
                        for (i = 0; i < listlen; i++) {
                            oddEvenFlag = (i % 2 == 0 ? '' : 'class="odd"');
                            sectionData.Body += gFuncs.parseTemplate(edDocNotes.CC_Tmpls.RowResults.join(''), {
                                personId: edDocNotes.personId,
                                encounterId: edDocNotes.encounterId,
                                eventId: dataElement[i].EVENT_ID,
                                titleLbl: dataElement[i].EVENT_DISP,
                                authorby: dataElement[i].PERFORMED_BY,
                                eventdate: dataElement[i].EVENT_END_DATE,
                                ROWODDS: oddEvenFlag
                            });
                            sectionData.Count += 1;
                        }
                    }
                }
            },
            processH5_Sec_All_Data: function (dataObj, sectObj) {
                var i, j, lencnt, dataElement,
                    listlen,
                    oddEvenFlag,
                    sectionData;
                for (j = 0 , lencnt = sectObj.sectionlist.length; j < lencnt; j++) {
                    sectionData = CC_SectMgt[CC_SectMgt.sectionlist[j]];
                    if (sectionData.SectionLevel == 'H5') {
                        sectionData.Body = '';
                        sectionData.Count = 0;
                        dataElement = null;
                        listlen = dataObj.CONSULTATION_REFERRALS_CNT;
                        if (sectionData.SectionID == 'CRPIPC' && listlen > 0) {
                            dataElement = dataObj.CONSULTATION_REFERRALS;
                        }
                        if (sectionData.SectionID == 'EDPN') {
                            dataElement = [];
                            dataElement.push(dataObj.ED_PROVIDER_NOTE);
                            listlen = dataElement[0].EVENT_ID == '' ? 0 : 1;
                        }
                        if (sectionData.SectionID == 'PORec') {
                            dataElement = [];
                            dataElement.push(dataObj.PERI_OPERATIVE_RECORD);
                            listlen = dataElement[0].EVENT_ID == '' ? 0 : 1;
                        }
                        if (dataElement == null) {
                            listlen = 0;
                        }
                        for (i = 0; i < listlen; i++) {
                            oddEvenFlag = (i % 2 == 0 ? '' : 'class="odd"');
                            sectionData.Body += gFuncs.parseTemplate(edDocNotes.CC_Tmpls.RowResults.join(''), {
                                personId: edDocNotes.personId,
                                encounterId: edDocNotes.encounterId,
                                eventId: dataElement[i].EVENT_ID,
                                titleLbl: dataElement[i].EVENT_DISP,
                                authorby: dataElement[i].PERFORMED_BY,
                                eventdate: dataElement[i].EVENT_END_DATE,
                                ROWODDS: oddEvenFlag
                            });
                        }
                        sectionData.Count = listlen;
                    }
                }
            },
            processRPTDATA_main_data: function () {
                edDocNotes.mainSection = '';
            },
            processH6_Section_All: function (sectObj) {
                var j, lencnt, dataElement,
                    sectionObj = htmlSecCtl.neo(),
                    wrkValue,
                    sectionData,
                    sectionName,
                    defaultHeight;
                for (j = 0 , lencnt = CC_SectMgt.sectionlist.length; j < lencnt; j++) {
                    sectionData = CC_SectMgt[CC_SectMgt.sectionlist[j]];
                    if (sectionData.SectionLevel == 'H6') {
                        wrkValue = '(' + sectionData.Count + ')';
                        if (sectionData.SectionID == 'PIPDP') {
                            wrkValue = ( sectionData.Count == 0 ? '(0)' : '');
                        } else if (sectionData.SectionID == 'HistPhy') {
                            wrkValue = ( sectionData.Count == 0 ? '(0)' : '');
                        } else if (sectionData.SectionID == 'PHistPhy') {
                            wrkValue = ( sectionData.Count == 0 ? '(0)' : '');
                        } else {
                            wrkValue = '(' + sectionData.Count + ')';
                        }
                        defaultHeight = sectionData.Count < 15 ? '' : 'style="height:300px; overflow-y:auto"';
                        sectionObj.initValues(
                            {
                                idLabel: sectionData.SectionLevel + '_Sec_' + sectionData.SectionID,
                                TLabel1: sectionData.TLabel1,
                                SectionClosed: sectionData.SectionClosed,
                                SectionCntVal: sectionData.Count,
                                //CustIcon: 'none',
                                SectionCnt: wrkValue,
                                ContentBody: '<div ' + defaultHeight + '><table>' +
                                edDocNotes.CC_Tmpls.RowResultHdr +
                                sectionData.Body +
                                '</table></div>',
                                TemplateType: sectionData.TemplateType
                            });
                        sectionName = sectionData.SectionLevel + '_Section_' + sectionData.SectionID,
                            edDocNotes[sectionName] =
                                sectionObj.generateHTML(CC_CssBehavior);
                        sectionData.SectionDivID = sectionObj.SectionDivID;
                    }
                }
            },
            processH5_Section_All: function () {
                var sectionObj = htmlSecCtl.neo(),
                    wrkValue,
                    sectionName,
                    sectionData,
                    defaultHeight;
                for (j = 0 , lencnt = CC_SectMgt.sectionlist.length; j < lencnt; j++) {
                    sectionData = CC_SectMgt[CC_SectMgt.sectionlist[j]];
                    sectionData.CustIcon = '';
                    if (sectionData.SectionLevel == 'H5') {
                        wrkValue = '';
                        sectionData.CustIcon = 'auto';
                        //H5 sectionData.SectionID: 'ClinicMDNotes    groups the clinic notes
                        if (sectionData.SectionID == 'ClinicMDNotes') {
                            sectionData.Body += edDocNotes.H6_Section_Pulm;
                            sectionData.Body += edDocNotes.H6_Section_Cardio;
                            sectionData.Body += edDocNotes.H6_Section_Endoc;
                            sectionData.Body += edDocNotes.H6_Section_Nuerol;
                            sectionData.Body += edDocNotes.H6_Section_Nueros;
                            sectionData.Body += edDocNotes.H6_Section_NephRen;
                            sectionData.Count = 1;
                            sectionData.CustIcon = 'none';
                        }
                        //H5 sectionData.SectionID: 'IPNotes'       groups the PIPDP notes  open always
                        else if (sectionData.SectionID == 'IPNotes') {
                            sectionData.Body += edDocNotes.H6_Section_PIPDP;
                            sectionData.CustIcon = 'none';
                            sectionData.Count = 1;
                        }
                        //H5 sectionData.SectionID: 'HPNotes'       groups the HistPhy &&  PHistPhy notes  open always
                        else if (sectionData.SectionID == 'HPNotes') {
                            sectionData.Body += edDocNotes.H6_Section_HistPhy;
                            sectionData.Body += edDocNotes.H6_Section_PHistPhy;
                            sectionData.CustIcon = 'none';
                            sectionData.Count = 1;
                        }
                        //H5 sectionData.SectionID: 'CRPIPC'          groups the Consults / Referral - Physicians IP Consultation  notes
                        else if (sectionData.SectionID == 'CRPIPC') {
                            wrkValue = sectionData.Body
                            if (sectionData.Count > 0) {
                                sectionData.Body = '<div ' + defaultHeight + '><table>' +
                                    edDocNotes.CC_Tmpls.RowResultHdr +
                                    wrkValue +
                                    '</table></div>';
                            }
                            //sectionData.Count = 1;
                            //sectionData.CustIcon = 'none';
                        }
                        //H5 sectionData.SectionID: 'EDPN'            groups the ED Physician Provider Notes note always open
                        else if (sectionData.SectionID == 'EDPN') {
                            //sectionData.CustIcon = 'none';
                            if (sectionData.Count == 0) {
                                //sectionData.Count = 1;
                                sectionData.Body = '';
                            } else {
                                wrkValue = sectionData.Body;
                                sectionData.Body = '<div ' + defaultHeight + '><table>' +
                                    edDocNotes.CC_Tmpls.RowResultHdr +
                                    wrkValue +
                                    '</table></div>';
                            }
                        }
                        defaultHeight = '';  //sectionData.Count < 15?  '' : 'style="height:300px; overflow-y:auto"';
                        sectionObj.initValues(
                            {
                                idLabel: sectionData.SectionLevel + '_Sec_' + sectionData.SectionID,
                                TLabel1: sectionData.TLabel1,
                                SectionClosed: sectionData.SectionClosed,
                                SectionCntVal: sectionData.Count,
                                SectionCnt: '',
                                CustIcon: sectionData.CustIcon,
                                ContentBody: sectionData.Body,
                                TemplateType: sectionData.TemplateType
                            });
                        sectionName = sectionData.SectionLevel + '_Section_' + sectionData.SectionID
                        edDocNotes[sectionName] = sectionObj.generateHTML(CC_CssBehavior);
                        sectionData.SectionDivID = sectionObj.SectionDivID;
                    }
                }
            },
            processCcInstance: function () {
                compContent = gFuncs.parseTemplate(edDocNotes.CC_Tmpls.mainDiv.join(''), {
                    cc_id: edDocNotes.cc_id,
                    mainSection: edDocNotes.mainSection,
                    H5_Section_ClinicMDNotes: edDocNotes.H5_Section_ClinicMDNotes,
                    H5_Section_IPNotes: edDocNotes.H5_Section_IPNotes,
                    H5_Section_HPNotes: edDocNotes.H5_Section_HPNotes,
                    H5_Section_CRPIPC: edDocNotes.H5_Section_CRPIPC,
                    H5_Section_EDPN: edDocNotes.H5_Section_EDPN,
                    mainSectionEnd: edDocNotes.mainSectionEnd
                });
                gFuncs.Log_CC(component, compContent);
                target.innerHTML = compContent;
            },
            processCcCssSectionBehavior1: function (CssBehavior, sectObj) {
                htmlSecCtlObj.initToggle(CssBehavior, sectObj);
            },
            processCcCssSectionBehaviorH6: function (CssBehavior, CC_SectMgt_Obj) {
                var j, lencnt;
                for (j = 0 , lencnt = CC_SectMgt_Obj.sectionlist.length; j < lencnt; j++) {
                    sectionData = CC_SectMgt_Obj[CC_SectMgt_Obj.sectionlist[j]];
                    if (sectionData.SectionLevel == 'H6') {
                        htmlSecCtlObj.initToggle(CssBehavior, sectionData);
                    }
                }
            },
            init: function () {
                var subHeaderDisplay;

                elementObj = component.data.RPTDATA;
                target = component.getTarget();

                component.eApps = {
                    cc_id: component.name.replace('.', '_'),
                    CSSBehaviors: chla.eApps.gCSSBehaviors.neo(),
                    TestSAP: null
                };
                edDocNotes.initOnly = ChlaStdClass.safeRead(chla, 'eApps', 'operationMode') == 'test' ||
                    ChlaStdClass.safeRead(chla, 'eApps', 'edDocNotes', 'operationMode') == 'edDocNotesTest';
                edDocNotes.cc_id = component.eApps.cc_id;
                edDocNotes.personId = component.getProperty("personId");
                edDocNotes.encounterId = component.getProperty("encounterId");
                edDocNotes.prsnlId = component.getProperty("userId");
                component.eApps.TestSAP = edDocNotes.TestServiceAccessPoint;

                htmlSecCtl = chlaNsMgr.aliasDirector('chla.eApps.Html.SectionHeaderCtl');
                htmlSecCtlData = chlaNsMgr.aliasDirector('chla.eApps.Html.SectionData');
                htmlSecCtlObj = htmlSecCtl.neo();
                initSecData = htmlSecCtlData.neo();

                CC_SectMgt = edDocNotes.CC_SectionManagement;

                SectionCfg = [
                    // H5 Sections
                    {
                        T_type: 'H5',
                        SecId: 'ClinicMDNotes',
                        TLblId: ' Clinic MD Notes - most recent two notes for each clinic',
                        SecClsd: 'open',
                        SecLvl: 'H5'
                    },
                    {T_type: 'H5', SecId: 'IPNotes', TLblId: 'Progress Notes', SecClsd: 'open', SecLvl: 'H5'},
                    {T_type: 'H5', SecId: 'HPNotes', TLblId: 'H&P Notes', SecClsd: 'open', SecLvl: 'H5'},
                    {
                        T_type: 'H5',
                        SecId: 'CRPIPC',
                        TLblId: 'Physician IP Consultation - up to most 5 recent',
                        SecClsd: 'open',
                        SecLvl: 'H5'
                    },
                    {
                        T_type: 'H5',
                        SecId: 'EDPN',
                        TLblId: 'ED Physician Provider Notes - most recent note',
                        SecClsd: 'open',
                        SecLvl: 'H5'
                    },
                    // {T_type: 'H5',SecId: 'PORec',TLblId: 'PERI OPERATIVE RECORD', SecClsd: 'auto',SecLvl:'H5'},
                    // H6 Sections
                    {T_type: 'H6', SecId: 'Pulm', TLblId: 'Pulmonology', SecClsd: 'closed', SecLvl: 'H6'},
                    {T_type: 'H6', SecId: 'Cardio', TLblId: 'Cardiology', SecClsd: 'closed', SecLvl: 'H6'},
                    {T_type: 'H6', SecId: 'Endoc', TLblId: 'Endocrinology', SecClsd: 'closed', SecLvl: 'H6'},
                    {T_type: 'H6', SecId: 'Nuerol', TLblId: 'Neurology', SecClsd: 'closed', SecLvl: 'H6'},
                    {T_type: 'H6', SecId: 'Nueros', TLblId: 'Neurosurgery', SecClsd: 'closed', SecLvl: 'H6'},
                    {T_type: 'H6', SecId: 'NephRen', TLblId: 'Nephrology/Renal', SecClsd: 'closed', SecLvl: 'H6'},
                    {
                        T_type: 'H6',
                        SecId: 'HistPhy',
                        TLblId: 'IP History & Physical - most recent note',
                        SecClsd: 'closed',
                        SecLvl: 'H6'
                    },
                    {
                        T_type: 'H6',
                        SecId: 'PHistPhy',
                        TLblId: 'Pre-Op History & Physical - most recent note',
                        SecClsd: 'closed',
                        SecLvl: 'H6'
                    },
                    {
                        T_type: 'H6',
                        SecId: 'PIPDP',
                        TLblId: 'Physician IP Daily Progress - most recent note',
                        SecClsd: 'closed',
                        SecLvl: 'H6'
                    }
                ];
                CC_SectMgt.sectionlist = initSecData.Section_config(SectionCfg, CC_SectMgt);

                CC_CssBehavior = component.eApps.CSSBehaviors;

                gFuncs = chlaNsMgr.aliasDirector('chla.eApps.gFuncs');
            },
            TestServiceAccessPoint: function () {
                return {
                    TestProcessRPTDATA_main: edDocNotes.processRPTDATA_main_data,
                    TestProcessH6_Sec_All_data: edDocNotes.processH6_Sec_All_data,
                    TestProcessH5_Sec_All_data: edDocNotes.processH5_Sec_All_data,
                    TestProcessH6_Section_All_data: edDocNotes.processH6_Section_All,
                    TestProcessH5_Section_All_data: edDocNotes.processH5_Section_All,
                    TestProcessCcInstance: edDocNotes.processCcInstance,
                    TestProcessCcCssSectionBehavior_1: edDocNotes.processCcCssSectionBehavior1,
                    TestProcessCcCssSectionBehavior_H6: edDocNotes.processCcCssSectionBehaviorH6
                };
            }
        };
    edDocNotes.init();
    if (edDocNotes.initOnly == false) {
        edDocNotes.processRPTDATA_main_data(elementObj);
        edDocNotes.processH5_Sec_All_Data(elementObj, CC_SectMgt);
        edDocNotes.processH6_Sec_All_Data(elementObj, CC_SectMgt);
        edDocNotes.processH6_Section_All(elementObj, CC_SectMgt);
        edDocNotes.processH5_Section_All(elementObj, CC_SectMgt);
        edDocNotes.processCcInstance();
        edDocNotes.processCcCssSectionBehavior1(CC_CssBehavior, CC_SectMgt['H5_Sec_EDPN']);
        edDocNotes.processCcCssSectionBehavior1(CC_CssBehavior, CC_SectMgt['H5_Sec_CRPIPC']);
        edDocNotes.processCcCssSectionBehaviorH6(CC_CssBehavior, CC_SectMgt);
    }
}
//::===========================================================================
//:: CC - EDHandoff Module
//::---------------------------------------------------------------------------
chla.EDHandoff1 = function () { };
chla.EDHandoff1.prototype = new MPage.Component();
chla.EDHandoff1.prototype.constructor = MPage.Component;
chla.EDHandoff1.prototype.base = MPage.Component.prototype;
chla.EDHandoff1.prototype.name = "chla.EDHandoff1";

chla.EDHandoff1.prototype.render = function () {
    var component = this,
        target,
        mainDiv = [
            '<div id="chla_EDHandoff1" class="eapps_CC" <#=StyleOverRd#>>',
            '<#=Loadscrn#></div>'
        ],
        initialScreen = [
            '<div  id="EDHWait" style="margin: 50px auto;  width: 250px; height: 250px;',
            ' background: url(data:image/gif;base64,R0lGODlhIAAgAPMAAP///ylTl8/Y55erzMHN4Kq61VZ3rHGMud7k7ujs88bR40JnoyxVmAAAAAAAAAAAACH/',
            'C05FVFNDQVBFMi4wAwEAAAAh/h1CdWlsdCB3aXRoIEdJRiBNb3ZpZSBHZWFyIDQuMAAh/hVNYWRlIGJ5IEFqYXhMb2FkLmluZm8AIfkECQoAAAAsAAAAACAAIAAABOcQyElpYaXqzediS4UknUY',
            'MFaNSAkGUVLIsB6UyU+IqMDUvL8ltonAhepPBzDAZAhA7JMUwQwGcLgJJKiH8SEMoQUARbwEEgyEzOVQ1ulzROCmoDYegYMHutLJkFAd3eEc9WQQKZxQEg3dIYoYddgZBPZIwCVZcnFyIOwkCBQ',
            'OkpZyfO6Wqm0ioiqKrrJ2zHZgwtrV0JZFIc4mLclk8SH8ugRPFibeWCb6SYr8TWhpix09FZzoEmH9HWV0uwD3aQd9PUZxzhuYA6lxiw2guOew9c2f1f55jjPNl4h0S2CoSj9aGZgA3RAAAIfkECQo',
            'AAAAsAAAAACAAIAAABOoQyElpWaTqzadZRjUUnUaQ1KJSBsOUVGIYR7pKhbvA7KxMqp1k4RrwJoVZbXgb6I6UwwwVBCBcDBQUQJgZEoDqwRWaIAgEsAQxGPwmUoOxkhNIEgo0ATFRtNt8VgYZJQJ6',
            'BHYUBH8jajCHCo4UbIxHZ3swfgOJPIE8CYRboluHaJF4paFHqQQKeamiqaevh6O2llueMJe6G7xHtJEbqKZQhnqcEsdoyb6hxJhresISaRqXyQh5jqDRymh8etVokkfdhOJWxaKvgekA7bnrXGgT51',
            'uvju8Ax6SIivUmlSuRoFeeN7c44BnIIQIAIfkECQoAAAAsAAAAACAAIAAABO4QyEkpMaTqzecxRzVkXYUolaFSx7KUVDKMlGpMhHvD0zwgE1vQNeBNFL7gCjDQGSmFGQogTLgWpEkChvBthc1FqMdgF',
            'LQEBXASpVUKC4EEXmYUJQiCXrEFyOQdAgZ1DDsTAnp6An0whFgbCQqJUzADZXcdeQRrPAecJQmfT6OjiZMJkaZ6pKp7kq2sqnypqqS2o6IluRyauxS9Rq9pjDHClDCIiYCHpsu8WbSbE5rDOMR4ir+Sj',
            'Al6n8lAiRKJ1zzdqwDiAJrHwd7j6ACvvhvsOPHnWTyvjOoSyaUIOPOHp1yHUBUktbulIZLBDREAACH5BAkKAAAALAAAAAAgACAAAATnEMhJqRii6s1nGUVVEJ2WINWgUodhlFRCENmkDhPhvnA+J7aV',
            'pGUI9SSImSKIAxRchyNFMUMBboDEjhSDyX7X1QBKGSwW3CxBYZUIqhqdVXdeNAFJJVDd3ggOdQtRFjMzAnswgQZpMVSFRwVndxx5fSUDiCUnUpydEwygoQsFCY6FjD2hqgymp52rDKOlpzOetkeWJbm',
            'UcLq9MKYKmROzSlJvhTUTyIYwScSmbXlriATDeM0TCFSIX33IKI8Ahdde4uJ5S52Oc7US7JzpPmlfqCWO1e5u+j3ZEuLaynHYNGXNLU3CpEQAACH5BAkKAAAALAAAAAAgACAAAATuEMhJKSqo6s0nKUW',
            'lZF2VkBMYpsNQUglBCJQ6Ia37enKSgpOcYneTDSU2gCJHpChkJFsih5L4SrEewEZorZAGA2ESG1EEUI1gcCUcwoYvQkZQXGNVDeINP1TQdAJXL3AGB0cmT3REBWFfHHMEeR1sRCdNmJkTC5ydcQmKdGO',
            'YnaULoaKZpgtioKIymrFEA5OQTQMMDDodkbUaubkLj2ShiCUCBsAMBn+iNCVzKQvAu5F1gwSDRTMUuAyjAFlVgBmLAHTalubmkcZEiiTmSmlN7TzgWeA7itiwE4CYZDyTIE8CgnRY8jxxJysRQg4RAAA',
            'h+QQJCgAAACwAAAAAIAAgAAAE8xDISWlSqerNpyJKJSCdlpAUoaZFUVqqkK4S0hLvTGSSivctWa6mCvVogpZr6FGhfICEEjXhdRK+DDRZ+EkUgwEVq6ACBE4NYlcLh42AdZGHNZsK7sFygvYJrCV5Yhs',
            'XPl4lAm8vcnYdbDknTJKTEwaWlwc7H4aHOZefBpuck6AGmYWjlKo5A4AljRwFCwsDi2k5s7MGnRKoIEMIB7kLByKGQh0DDEIEBrm1RHMTjxQHDAwGFAPOXlgEZn0kUAnXDHtM3j9QAMoMC5SbTzQAC9fQ',
            'wEXT8wTlkptW6yQYuObKEQFkAAJK0CMpEoUPcFYRwsAkAgAh+QQJCgAAACwAAAAAIAAgAAAE6xDISWlSqerNpyJKhWRdlSAVoVLCWk6JKlAqAavhO9UkUHsqlE6CwO1cRdCQ8iEIfzFVTzLdRAmZX3I2',
            'SfZiCqGk5dTESJeaOAlClzsJsqwiJwiqnFrb2nS9kmIcgEsjQydLiIkTA4yNBXd9P4iNlAORkkuVA49pejaKoDoDeIJLBAYGBX9BQ6ioB58mfTl/B64GB3R6XB0FC1wEtqiqRDUYO3gDCwu5EwWosVGB',
            'ZCgM1gAJywuxS1cS1gwSygsGik1C4BMGywOISbTpEgTaiE098RIHy6QbcxP44ri9OERhAYMFoUoUYEBMRwQAIfkECQoAAAAsAAAAACAAIAAABO8QyElpUqnqzaciSoVkXZUgFaFSwlpOiSpQKgGr4TvVJ',
            'FB7KpROgsDtXEXQkPIhCH8xVU8y3UQJmV9yNkn2YgqhpOXUxEiXmjgJQpc7CbKsIicIqpxa29p0vZJiHIBLI0MnS4iJR3oYaXo2iI84fXqJko2UfoqbJViESwIDAzkdgzqiqIEwfaQlCQWoAwV0elwdBA',
            'ZCCLGkbBhjDAMaAwYGB0yiYlGBBgwMxwvRAAnFBpCIBc4MGdELEgXFx4kLzsIA3RMHxbNLA87eEugSuMWI5Azs59LpxXgczgYoyJtQ4JoOWBUMLAjI6daCfC8iAAAh+QQJCgAAACwAAAAAIAAgAAAE8BDI',
            'SWlSqerNpyJKhWRdlSAVoVLCWk6JKlAqAavhO9UkUHsqlE6CwO1cRdCQ8iEIfzFVTzLdRAmZX3I2SfZiCqGk5dTESJeaOAlClzsJsqwiJwiqnFrb2nS9kmIcgEsjQydLiIlHehhpejaIjzh9eomSjZR+ip',
            'slhToIB4RBLwMMDANDfRgbBAumpoZ1XBMGrwwGsxsCA2h9YqWmCwVEwhoEAwPDXR89BaaoEwcLC6gG1gAJyAOBVinTCxnWBhIK2ooG09DiEwXIOUMD0+MS60TmS+gLkAD1Eu28S6aFonWNCbcSxyocMDCQU',
            'x4DynREAAAh+QQJCgAAACwAAAAAIAAgAAAE6xDISWlSqerNpyJKhWRdlSAVoVLCWk6JKlAqAavhO9UkUHsqlE6CwO1cRdCQ8iEIfzFVTzLdRAmZX3I2SfZiCqGk5dTESJeaOAlClzsJsqwiJwiqnFrb2nS9',
            'kmIcgEsjQydLiIlHehgFCwyQkYl6NQqRlwyTlI2PmIqfQ4U6CQOEQS8DCwsFQ30YGwQGqqqGdVwTB7MLB7cbRWh9YqmqBjYACMUaWxQIHz0EqqW4BgalA9cAV3gmKdQGGdfSSTmIB9SsAOFAb0MF1AcT6lQ',
            '/S97G6dgTZNsb7xTyXfjBQjehwACCoDYIGNCrRAQAIfkECQoAAAAsAAAAACAAIAAABOgQyElpUqnqzaciSoVkXZUgFaFSwlpOiSpQKgGr4TvVJFB7KpROgsDtXEXQkPIhCH8xVU8y3UQJmV9yNkn2CAzGgB',
            'XUxEiXmhAwCDMWBaqzlGjVuBODm2HAl2ogVRIFC3tDSWscbWJLI4djS5GSEoA4CYR7YZKVOJlum5UYmJmTpYeCVpA6iC8FBgZxOk2BGwoHr69DdYB+ALe4B4kaRWiza66vBzYACQO9AFsUCB9fr7GDAwM2UD',
            'wvVQjZA1lIRpLhOT8STcIlCuFHy8zpQ+Fr8wB2qBvZ8T4uXfo2FKnwIYcpDhcCVogAACH5BAkKAAAALAAAAAAgACAAAATwEMhJaVKp6s2nIkqFZF1VDBWhUsJaTgnDGJRKwGr4TjJzSzaPCrGbDGSLSRCAy',
            'BUpCxkKEEzYSLBXoUcMNgkCyhdLWBimEoPsoLGSLjaiZLCoG34CBnqTaNnCFAd1dQdyLzYgWDUGg0k7X4YcdAsFTyNFCXtPm5uIOVYHBqKjnJ45o6g0nZ4YBKGpnLGblztWlkMvCgMDgLk2GBsIu8OYfiq9',
            'EifDBYoaTW8fuBK6uwWAbs7HYh9YwgM6En5dK1YqzW0V5QQZS1/gT9FySwDxs05ALgDqm9Fk+QB+znHQpuQfE4EcEkSiB0LWiwsINUQAADsAAAAAAAAAAAA=) no-repeat center;">',
            '<div style="font-size:18px;text-align: center;" >This tab content: <br/>Temporarily Unavailable</div></div>'
        ],
        wrkValue,
        compContent;
    target = component.getTarget();
    wrkValue = initialScreen.join('');
    compContent = chla.eApps.gFuncs.parseTemplate(mainDiv.join(''), {
        StyleOverRd: ' style="font-size:14px; min-width:1280px;"',
        cc_id:      'chla_EDHandoff',
        Loadscrn:    wrkValue
    });
    target.innerHTML = compContent;
};
chla.SurveyTimer                       = function () { };
chla.SurveyTimer.prototype             = new MPage.Component();
chla.SurveyTimer.prototype.constructor = MPage.Component;
chla.SurveyTimer.prototype.base        = MPage.Component.prototype;
chla.SurveyTimer.prototype.name        = "chla.SurveyTimer";
chla.SurveyTimer.prototype.cclProgram  = 'chla_ca_mp_cc_edsurvey_json';
chla.SurveyTimer.prototype.cclParams   = [];
chla.SurveyTimer.prototype.cclDataType = 'JSON';
chla.SurveyTimer.prototype.init        = function () {
    this.cclParams[0] = 'MINE';
    this.cclParams[1] = this.getProperty('encounterId');
    this.cclParams[2] = this.getProperty('personId');
    this.cclParams[3] = this.getProperty('userId');
};

chla.SurveyTimer.prototype.render      = function () {
    var component           = this,
        elementObj          = null,
        target,
        compContent;
    var CC_CssBehavior      = null,
        appSurveyTimer = chla.eAppsClass.implement({isEmpty: ChlaStdClass.isEmpty}).neo();
    ChlaStdClass.applyProperties(appSurveyTimer,{
        initOnly:       false,
        cc_id:          'x',
        personId:       0,
        encounterId:    0,
        prsnlId:        0,
        mainSection:    '',
        mainSectionEnd: '',
        CC_Tmpls: {
            mainDiv: [
                '<div id="<#=cc_id#>" class="eapps_CC" <#=StyleOverRd#>>',
                '<div style="width:<#=width#>;display:table-row;">',
                '<div id="<#=cc_id#>_survText" style="display:table-cell;width:98%;padding-left:.3em;padding-bottom:.3em;"><#=survText#></div>',
                '<div style="display:table-cell;float: right;padding-top:.3em;padding-right:.3em;"><button id="EDSurvStartButton" class="eappsBtnGrey" >Start</button></div>',
                '</div>',
                '<div style="display:table-row;">',
                '<div id="<#=cc_id#>_TimeDur" style="display:table-cell;width: 98% ;adding-left:.3em;padding-bottom:.3em;visibility: hidden;">Time Duration: </div>',
                '<div style="display:table-cell;float: right;padding-right:.3em; "><button id="EDSurvReviewButton" class="eappsBtnGrey" style="visibility:hidden;">Review</button></div>',
                '</div>',
                '</div>'
            ],
            Additional_Template1: []
        },
        processRPTDATA_main_data: function () {
            var elementObj = component.eApps.elementObj;
            component.eApps.UPDT_BYID       = elementObj.UPDT_BYID;
            component.eApps.TRIAGE_LEVEL    = elementObj.TRIAGE_LEVEL;
            component.eApps.RRT_24HRS       = elementObj.RRT_24HRS;
            component.eApps.LIKERT_SCORE    = elementObj.LIKERT_SCORE;
            component.eApps.MISSED_ELEMENTS = elementObj.MISSED_ELEMENTS;
            component.eApps.TEXT_NOTES      = elementObj.TEXT_NOTES;
            component.eApps.duration        = elementObj.DURATION;
            appSurveyTimer.mainSection= 'This is the Template main section';
        },
        processRPTDATA_end_data: function () {
            appSurveyTimer.mainSectionEnd = 'This is the Template end section';
        },
        processCcInstance: function () {
            var SizeProfile,
                fontBase        = '12px';
            SizeProfile         = appSurveyTimer.gFuncs.getResolutionProfile();
            if(SizeProfile == 'RLESS1279')
                fontBase        = '10px';
            compContent         = appSurveyTimer.gFuncs.parseTemplate(appSurveyTimer.CC_Tmpls.mainDiv.join(''), {
                StyleOverRd:    ' style="font-size: ' + fontBase + '"',
                width:          ((($('div#' + target.id).parent().width()/fontBase.substring(0,2)) - 6.5) + 'em'),
                survText:       component.eApps.survTextStart.join(''),
                cc_id:          appSurveyTimer.cc_id,
                mainSection:    appSurveyTimer['mainSection'],
                mainSectionEnd: appSurveyTimer['mainSectionEnd']
            });
            appSurveyTimer.gFuncs.Log_CC( component, compContent);
            target.innerHTML = compContent;
        },
        /**
         *
         * @param componentObj
         * @param baseObj
         */
        processCcCssButtonBehavior1: function (componentObj, baseObj) {
            var btnStart    = $('button#EDSurvStartButton'),
                CcObj       = componentObj,
                CcObjEapps  = componentObj.eApps;
            btnStart.attr('class', 'eappsBtnGrey');
            btnStart.attr('buttonState','Disabled');
            if (baseObj.isEmpty(CcObj.eApps.UPDT_BYID)){
                /**
                 * button event handler: 'click'
                 */
                btnStart.on('click', function () {
                    var txtAreaName,
                        txtBoxName,
                        buttonObj = $(this),
                        vCcObj = CcObj,
                        vCcObjEapps,
                        vCclReqObj,
                        appNS,
                        vRptParms = [];

                    vCcObjEapps = vCcObj.eApps;
                    appNS = vCcObjEapps.appNS;
                    txtAreaName = ['div#', vCcObjEapps.cc_id, '_survText'].join('');
                    txtBoxName  = ['div#', vCcObjEapps.cc_id, '_TimeDur'].join('');

                    if (buttonObj.text() == 'Start') {
                        vCcObjEapps.startTime = new Date();
                        buttonObj.text('Finish');
                        $(txtAreaName).html([
                            vCcObjEapps.survTextRunning.join('') ,
                            '&nbsp;<span style="color:green;font-weight:800;"> Survey Timer is RUNNING</span>'
                        ].join(''));

                    } else if (buttonObj.text() == 'Finish') {
                        vCcObjEapps.endTime = new Date();
                        buttonObj.text('Submit');
                        $(txtAreaName).html(vCcObjEapps.survTextQuestions.join(''));
                        $(txtBoxName).css('visibility', 'visible');
                        vCcObjEapps.duration = chla.eApps.gFuncs.dateDiff(vCcObjEapps.startTime, vCcObjEapps.endTime, 'minutes');
                        $(txtBoxName).html(['Time Duration: ', CcObjEapps.duration, ' Minute(s)'].join(''));
                    } else if (buttonObj.text() == 'Submit') {
                        if (appNS.isEmpty(vCcObjEapps.CCLreqObj)){
                            vCcObjEapps.CCLreqObj = appNS.gCCLRequestCls.neo();
                        }
                        vCclReqObj = vCcObjEapps.CCLreqObj;
                        vRptParms.push('^MINE^,');
                        vRptParms.push(CcObjEapps.encounterId, ',');
                        vRptParms.push(CcObjEapps.personId, ',');
                        vRptParms.push(CcObjEapps.userId, ',');
                       //sets default value to indicate if the question was not answered
                        vRptParms.push(($('input[name="TrgLvl"]:checked').val() || '0') , ',');
                        vRptParms.push(($('input[name="RRT24"]:checked').val() || '2'), ',');
                        vRptParms.push(($('input[name="Likert"]:checked').val() || '0'), ',');
                        vRptParms.push(($('input[name="EESO"]:checked').val() || '0'), ',');
                        vRptParms.push('^', chla.eApps.gFuncs.sFormatShortDate(CcObjEapps.startTime), ' ', chla.eApps.gFuncs.sFormatShortTime(CcObjEapps.startTime), '^,');
                        vRptParms.push('^', chla.eApps.gFuncs.sFormatShortDate(CcObjEapps.endTime), ' ', chla.eApps.gFuncs.sFormatShortTime(CcObjEapps.endTime), '^,');
                        vRptParms.push('^', $('textarea#EDSurvCmts').val(), '^,');
                        vRptParms.push(CcObjEapps.duration, ',');
                        vRptParms.push(CcObjEapps.Fin_ID);
                        appNS.Logger.LogInfo( CcObjEapps.cc_id + ': CCLReport: ' +CcObjEapps.insCCLname + ' - CcObjEapps.CclObj' + ' CCL params: ' + vRptParms.join(''));
                        vCclReqObj.BtnSaveLbl = '#EDSurvStartButton';
                        vCclReqObj.BtnSaveBehaviorFunc = appNS.SaveButtonBehavior.enable_disable_status_reset;
                        //vCclReqObj.BtnSaveFailBehaviorFunc = {};

                        vCclReqObj.DataTransfer1(
                            vCclReqObj,
                            CcObjEapps.insCCLname ,
                            vRptParms.join(''),
                            vCcObj);
                        //buttonObj.css('visibility', 'hidden');
                    }
                });
            } else {
                btnStart.css('visibility', 'hidden');
            }
        },
        processCcCssButtonBehavior2: function (componentObj, baseObj){
            var btnReview = $('button#EDSurvReviewButton'),
                CcObjEapps = componentObj.eApps,
                txtAreaName;

            if (ChlaStdClass.isEmpty(CcObjEapps.UPDT_BYID)) {
                btnReview.css('visibility', 'hidden');
            } else {
                txtAreaName = ['div#', CcObjEapps.cc_id, '_survText'].join('');
                $(txtAreaName).html(CcObjEapps.survTextReview.join(''));
                btnReview.css('visibility', 'visible');
                btnReview.attr('class', 'eappsBtnGrey');
                btnReview.on('click', function () {
                    var buttonObj = $(this),
                        txtAreaName = ['div#', CcObjEapps.cc_id, '_survText'].join(''),
                        txtBoxName  = ['div#', CcObjEapps.cc_id, '_TimeDur'].join('');
                    $(txtAreaName).html(CcObjEapps.survTextQuestions.join(''));
                    $(txtBoxName).css('visibility', 'visible');
                    $(txtBoxName).html(['Time Duration: ', CcObjEapps.duration, ' Minute(s)'].join(''));
                    $('input[name="TrgLvl"][value="'  + CcObjEapps.TRIAGE_LEVEL +'"]').prop('checked', true);
                    $('input[name="RRT24"][value="'   + CcObjEapps.RRT_24HRS +'"]').prop('checked', true);
                    $('input[name="Likert"][value="'  + CcObjEapps.LIKERT_SCORE +'"]').prop('checked', true);
                    $('input[name="EESO"][value="'    + CcObjEapps.MISSED_ELEMENTS +'"]').prop('checked', true);
                    $('textarea#EDSurvCmts').val(CcObjEapps.TEXT_NOTES );
                    buttonObj.css('visibility', 'hidden');
                });
            }
        },
        init: function () {
            elementObj      = component.data.RPTDATA;
            target          = component.getTarget();
            component.eApps = {
                cc_id:              component.name.replace('.', '_'),
                CSSBehaviors:       appSurveyTimer.gCSSBehaviorCls.neo(),
                SaveButtonAction:   appSurveyTimer.gButtonBehaviorSaveCls.neo().enable_disable_status_reset,
                TestSAP:            null,
                Fin_ID:             elementObj.FIN_ID,
                encounterId:        component.getProperty('encounterId'),
                personId:           component.getProperty('personId'),
                userId:             component.getProperty('userId'),
                appNS:              appSurveyTimer,
                insCCLname:         'chla_ca_mp_cc_ins_edsrv_json',
                survTextStart: [
                    '<div id="TimerStart">&nbsp;Press "Start" to activate the survey timer.</div>'
                ],
                survTextReview: [
                    '<div id="TimerStart">&nbsp;Press "Review" for previous responses to the survey.</div>'
                ],
                survTextRunning: [
                    '<div id="TimerFinish">&nbsp;Press "Finish" to stop survey timer. <br/>',
                    '&nbsp;Survey questions will be presented at that time.</div>'
                ],
                survTextQuestions: [
                    '<div id="SurveyQuestions" style=";padding-bottom:5px;">',
                    '<div style="display:table-row" ><div style="display:table-cell;padding-top:5px;">',
                    '&nbsp;Triage level in Ed?&nbsp;&nbsp;&nbsp;</div>',
                    '<div style="display:table-cell;"><input type="radio" name="TrgLvl" value="1">&nbsp;1&nbsp;</div>',
                    '<div style="display:table-cell;"><input type="radio" name="TrgLvl" value="2">&nbsp;2&nbsp;</div>',
                    '<div style="display:table-cell;"><input type="radio" name="TrgLvl" value="3">&nbsp;3&nbsp;</div>',
                    '<div style="display:table-cell;"><input type="radio" name="TrgLvl" value="4">&nbsp;4&nbsp;</div>',
                    '<div style="display:table-cell;"><input type="radio" name="TrgLvl" value="5">&nbsp;5&nbsp;</div>',
                    '</div><div style="display:table-row""><div style="display:table-cell;padding-top:5px;">',
                    '&nbsp;RRT risk in 24 hours?&nbsp;&nbsp;&nbsp;</div>',
                    '<div style="display:table-cell;"><input type="radio" name="RRT24" value="1">&nbsp;Yes&nbsp;</div>',
                    '<div style="display:table-cell;"><input type="radio" name="RRT24" value="0">&nbsp;No&nbsp;</div>',
                    '</div><div style="display:table-row""><div style="display:table-cell;padding-top:5px;">',
                    '&nbsp;Likert scale on overall quality of sign out?(verbal+supplemental EMR tab together)&nbsp;&nbsp;&nbsp;</div>',
                    '<div style="display:table-cell;"><input type="radio" name="Likert" value="1">&nbsp;1&nbsp;</div>',
                    '<div style="display:table-cell;"><input type="radio" name="Likert" value="2">&nbsp;2&nbsp;</div>',
                    '<div style="display:table-cell;"><input type="radio" name="Likert" value="3">&nbsp;3&nbsp;</div>',
                    '<div style="display:table-cell;"><input type="radio" name="Likert" value="4">&nbsp;4&nbsp;</div>',
                    '<div style="display:table-cell;"><input type="radio" name="Likert" value="5">&nbsp;5&nbsp;</div></div>',
                    '<div style="display:table-row""><div style="display:table-cell;">&nbsp;</div>',
                    '<div style="display:table-cell;"><span style="font-size:10px">Poor</span></div>',
                    '<div style="display:table-cell;">&nbsp;&nbsp;</div><div style="display:table-cell;">&nbsp;&nbsp;</div>',
                    '<div style="display:table-cell;">&nbsp;&nbsp;</div><div style="display:table-cell;">',
                    '<span style="font-size:10px;">Great</span></div></div>',
                    '<div style="padding-top:5px;">&nbsp;Number of essential elements requiring verbal sign out?(in addition to verbal+supplemental EMR tab together) </div>',
                    '<div style="display:table-row"><div style="display:table-cell;padding-top:5px;">&nbsp;&nbsp;&nbsp;</div>',
                    '<div style="display:table-cell;"><input type="radio" name="EESO" value="1">&nbsp;1&nbsp;&nbsp;</div>',
                    '<div style="display:table-cell;"><input type="radio" name="EESO" value="2">&nbsp;2&nbsp;&nbsp;</div>',
                    '<div style="display:table-cell;"><input type="radio" name="EESO" value="3">&nbsp;3&nbsp;&nbsp;</div>',
                    '<div style="display:table-cell;"><input type="radio" name="EESO" value="4">&nbsp;4&nbsp;&nbsp;</div>',
                    '<div style="display:table-cell;"><input type="radio" name="EESO" value="5">&nbsp;5&nbsp;&nbsp;</div>',
                    '<div style="display:table-cell;"><input type="radio" name="EESO" value="6">&nbsp;6&nbsp;&nbsp;</div>',
                    '<div style="display:table-cell;"><input type="radio" name="EESO" value="7">&nbsp;7&nbsp;&nbsp;</div>',
                    '<div style="display:table-cell;"><input type="radio" name="EESO" value="8">&nbsp;8&nbsp;&nbsp;</div>',
                    '<div style="display:table-cell;"><input type="radio" name="EESO" value="9">&nbsp;9&nbsp;&nbsp;</div>',
                    '<div style="display:table-cell;"><input type="radio" name="EESO" value="10">&nbsp;10&nbsp;&nbsp;</div></div>',
                    '<div style="padding-top:5px;">&nbsp;Survey Comments: </div>',
                    '<div style="display:table-cell;"><textarea id="EDSurvCmts" rows="5" cols="60" value=""></textarea></div>',
                    '</div></div>'
                ]
            };
            appSurveyTimer.initOnly = ChlaStdClass.safeRead( chla,'eApps','operationMode') == 'test' ||
                ChlaStdClass.safeRead( chla,'eApps','SurveyTimer','operationMode') == 'SurveyTimerTest' ;
            appSurveyTimer.cc_id        = component.eApps.cc_id;
            appSurveyTimer.personId     = component.getProperty("personId");
            appSurveyTimer.encounterId  = component.getProperty("encounterId");
            appSurveyTimer.prsnlId      = component.getProperty("userId");
            component.eApps.TestSAP     = appSurveyTimer.TestServiceAccessPoint;
            CC_CssBehavior              = appSurveyTimer.gCSSBehaviorCls;
            component.eApps.elementObj  = elementObj;
        },
        TestServiceAccessPoint: function (){
            return {
                TestProcessRPTDATA_main:            appSurveyTimer.processRPTDATA_main_data,
                TestProcessRPTDATA_end:             appSurveyTimer.processRPTDATA_end_data,
                TestProcessCcInstance:              appSurveyTimer.processCcInstance,
                TestProcessCcCssButtonBehavior_1:   appSurveyTimer.processCcCssButtonBehavior1,
                TestProcessCcCssButtonBehavior_2:   appSurveyTimer.processCcCssButtonBehavior2
            };
        }
    });
    appSurveyTimer.init();
    if (appSurveyTimer.initOnly == false) {
        appSurveyTimer.processRPTDATA_main_data(elementObj);
        appSurveyTimer.processRPTDATA_end_data(elementObj);
        appSurveyTimer.processCcInstance(component, appSurveyTimer);
        appSurveyTimer.processCcCssButtonBehavior1(component, appSurveyTimer);
        appSurveyTimer.processCcCssButtonBehavior2(component, appSurveyTimer);
    }
};

//::===========================================================================
//:: GeneralDoc Module
//::---------------------------------------------------------------------------
chla.GeneralDoc                       = function () { };
chla.GeneralDoc.prototype             = new MPage.Component();
chla.GeneralDoc.prototype.constructor = MPage.Component;
chla.GeneralDoc.prototype.base        = MPage.Component.prototype;
chla.GeneralDoc.prototype.name        = "chla.GeneralDoc";
//-----------------------------------------------------------------------------
chla.GeneralDoc.prototype.render = function () {
    var component = this,
        elementObj = '',
        target,
        compContent;
    var CC_CssBehavior = null,
        gFuncs = null,
        htmlSecCtl = null,
        htmlSecCtlObj = null,
        GeneralDoc = {
            initOnly: false,
            cc_id: 'x',
            personId: 0,
            encounterId: 0,
            prsnlId: 0,
            rowCnt: 50,
            compHeight: '',
            NtsData: "",
            NtsTextID: 'GNtsText',
            NtsSaveID: 'GNtsSave',
            NtsSaveCCL:'CHLA_CA_MP_CC_DUMMY_JSON' ,
            transparentSpacer: '',
            CC_SectionManagement: {
                sectionlist: []
            },
            mainSection: '',
            CC_Tmpls: {
                mainDiv: [
                    '<div id="<#=cc_id#>" class="eapps_CC"><#=mainSection#> <#=CustStyle#></div>'
                ],
                Notes_Tmpl: [
                    '<textarea id="<#=NtsTextID#>" rows="<#=rowCnt#>" ',
                    'style="width:100%;margin-bottom:5px;<#=dheight#>"><#=textnotes#></textarea><br/><p>',
                    '<div style="display:inline-block;width:100%;">',
                    '<div style="display:inline-block;float:right;">',
                    '<button id="<#=NtsSaveID#>" class="eappsBtnGrey">Save</button></p>',
                    '</div></div>'
                ],
                Additional_Template1: []
            },
            processRPTDATA_main_data: function () {
                GeneralDoc.NtsData = elementObj.DOCDATA.replace(/%0D%0A/g, '\n');
            },
            processCcInstance: function (componentObj, baseObj) {
                var compContent,
                    mainSection = gFuncs.parseTemplate(baseObj.CC_Tmpls.Notes_Tmpl.join('') ,{
                        NtsTextID:    baseObj.NtsTextID,
                        rowCnt:       baseObj.rowCnt,
                        textnotes:    baseObj.NtsData,
                        NtsSaveID:    baseObj.NtsSaveID,
                        dheight:      baseObj.compHeight
                    });
                compContent = baseObj.gFuncs.parseTemplate(baseObj.CC_Tmpls.mainDiv.join(''), {
                    cc_id:           baseObj.cc_id,
                    CustStyle:       '',
                    mainSection:     mainSection
                });
                baseObj.gFuncs.Log_CC( componentObj, compContent);
                target.innerHTML = compContent;
            },
            processCcCssButtonBehavior1: function (componentObj, baseObj){
                $("#" + GeneralDoc.NtsSaveID).on( "click", function () {
                    var temparr = [];
                    if($(this).attr('buttonState') == 'Enabled'){
                        temparr.push('^MINE^,');
                        temparr.push('value($VIS_Encntrid$),');
                        temparr.push('^');
                        temparr.push( $('#' + GeneralDoc.NtsTextID).val());
                        temparr.push('^,');
                        temparr.push( 'value($USR_PersonID$)');
                        if (component.eApps.CCLreqObjSave == null){
                            component.eApps.CCLreqObjSave = chla.eApps.gCCLRequest.neo();
                            component.eApps.CCLreqObjSave.ObjectName='OBJ_component.eApps.CCLreqObjSave';
                            component.eApps.CCLreqObjSave.BtnSaveBehaviorFunc = component.eApps.SaveButtonAction ;
                            component.eApps.CCLreqObjSave.CallBackOperation =
                                function(responseData){
                                    component.eApps.CSSBehaviors.hoverContent =
                                        component.eApps.HoverDataFormater(responseData);
                                };
                        };
                        component.eApps.CCLreqObjSave.DataTransfer0( component.eApps.CCLreqObjSave,
                            GeneralDoc.NtsSaveCCL,
                            temparr.join(''),
                            '#' + GeneralDoc.NtsSaveID);
                    }
                });
                component.eApps.SaveButtonAction('#' + GeneralDoc.NtsSaveID, 'RESET');
            },
            processCcCssControlBehavior1: function (){
                $("#" + GeneralDoc.NtsTextID).on( "click", function () {
                    $(this).attr('buttonState','Enabled');
                    component.eApps.SaveButtonAction('#' + GeneralDoc.NtsSaveID, 'ENABLE');
                } );
            },
            /**
             *
             */
            processCcCssControlBehavior2: function (){
                /**
                 *
                 * @param sourceData
                 * @returns {string}
                 */
                component.eApps.HoverDataFormater =  function (sourceData) {
                    wrkValue = '<span style="font-weight:bold;">Update History</span></br>';
                    wrkCnt = sourceData.UPDT_CNT ;
                    for (var i = 0; i < wrkCnt; i ++) {
                        wrkValue += sourceData.UPDT_LIST[i].UPDT_MODBY_ID ;
                        wrkValue += ' on ';
                        wrkValue += sourceData.UPDT_LIST[i].UPDTDATETIME ;
                        wrkValue +=  "</br>" ;
                    }
                    return wrkValue ;
                };
                component.eApps.CSSBehaviors.InitPopUpsDiv(
                    component.eApps.HoverDataFormater( elementObj),
                    ('button#' + GeneralDoc.NtsSaveID),'T');
            },
            init: function () {
                var subHeaderDisplay,
                    SectionCfg,
                    htmlSecCtlData,
                    initSecData;
                elementObj = ChlaStdClass.safeRead( component,'data','RPTDATA');
                GeneralDoc.elementObj = elementObj;
                target = component.getTarget();
                GeneralDoc.target = target;
                component.eApps = {
                    cc_id: component.name.replace('.', '_'),
                    CSSBehaviors: chla.eApps.gCSSBehaviors.neo(),
                    SaveButtonAction: chla.eApps.SaveButtonBehavior.enable_disable_status_reset,
                    TestSAP: null
                };
                GeneralDoc.initOnly = ChlaStdClass.safeRead( chla,'eApps','operationMode') == 'test' ||
                    ChlaStdClass.safeRead( chla,'eApps','GeneralDoc','operationMode') == 'GeneralDocTest' ;
                GeneralDoc.cc_id = component.eApps.cc_id;
                GeneralDoc.personId = component.getProperty("personId");
                GeneralDoc.encounterId = component.getProperty("encounterId");
                GeneralDoc.prsnlId = component.getProperty("userId");
                component.eApps.TestSAP= GeneralDoc.TestServiceAccessPoint;;
                htmlSecCtl = chlaNsMgr.aliasDirector('chla.eApps.Html.SectionHeaderCtl');
                htmlSecCtlData = chlaNsMgr.aliasDirector('chla.eApps.Html.SectionData');
                htmlSecCtlObj = htmlSecCtl.neo();
                initSecData = htmlSecCtlData.neo();
                CC_CssBehavior = component.eApps.CSSBehaviors;
                gFuncs = chlaNsMgr.aliasDirector('chla.eApps.gFuncs');
                elementObj = component.data.RPTDATA;
            },
            TestServiceAccessPoint: function (){
                return {
                    TestProcessRPTDATA_main: GeneralDoc.processRPTDATA_main_data,
                    TestProcessCcInstance: GeneralDoc.processCcInstance,
                    TestProcessCcCssButtonBehavior_1:  GeneralDoc.processCcCssButtonBehavior1,
                    TestProcessCcCssControlBehavior_1:  GeneralDoc.processCcCssControlBehavior1
                };
            }
        };
    if (arguments.length == 1 && (typeof arguments[0]).toLowerCase() == 'object') {
        component.cloneInit(arguments[0].clone_name, GeneralDoc, arguments);
    }
    GeneralDoc.init();
    if (GeneralDoc.initOnly == false) {
        GeneralDoc.processRPTDATA_main_data(component, GeneralDoc);
        GeneralDoc.processCcInstance(component, GeneralDoc);
        GeneralDoc.processCcCssButtonBehavior1(component, GeneralDoc);
        GeneralDoc.processCcCssControlBehavior1(component, GeneralDoc);
    }
};

/* ====================================================================================================== */
//::CC - EDHnotes - javascript section
/* ====================================================================================================== */
chla.EDHnotes                       = function () { };
chla.EDHnotes.prototype             = new MPage.Component();
chla.EDHnotes.prototype.constructor = MPage.Component;
chla.EDHnotes.prototype.base        = MPage.Component.prototype;
chla.EDHnotes.prototype.name        = "chla.EDHnotes";
chla.EDHnotes.prototype.cclProgram  = "chla_ca_mp_cc_ednote_json";
chla.EDHnotes.prototype.cclParams   = [];
chla.EDHnotes.prototype.cclDataType = "JSON";
chla.EDHnotes.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("encounterId");
    this.cclParams[2] = this.getProperty("personId");
    this.cclParams[3] = this.getProperty("userId");
};

chla.EDHnotes.prototype.render = function () {
    var thisClone_component=this,
        objWrk,
        elementObj = {
            "PROGVER_CHLA": "20160418001",
            "ERR_STAT": "FALSE",
            "ERR_DETAIL": "",
            "EDNOTESCNT": 0,
            "EDNOTES_LIST": [],
            "EDSECTLBLSCNT": 0,
            "EDSECTLBL_LIST": [],
            "UPDT_CNT": 0,
            "UPDT_LIST": []
        },
        appEDN =  chla.eAppsClass.neo(),                 //creates an instance of the chla.eAppsClass
        //ChlaStdClass.applyProperties(vCcMod,vAppCfgObj);
        Clone_content_body = '',
        Notes_Tmpl = [
            '<div <#=dheight#> >',
            '<#=textnotes#><br/><p><div style="display:inline-block;width:100%;">',
            '<div style="display:inline-block;float:right;">',
            '<button id="<#=NtsSaveID#>" class="eappsBtnGrey">Save</button></p>',
            '</div></div></div>'
        ],
        /**
         *
         * @param componentObj
         * @param baseObj
         */
        processCcInstance = function (componentObj, baseObj) {
            var compContent,
                mainSection = appEDN.gFuncs.parseTemplate(Notes_Tmpl.join('') ,{
                    NtsTextID:    baseObj.NtsTextID,
                    rowCnt:       baseObj.rowCnt,
                    textnotes:    Clone_content_body,
                    NtsSaveID:    baseObj.NtsSaveID,
                    dheight:      (baseObj.compHeight === ''? '':'style="height:' + baseObj.compHeight + ';overflow-y:auto;"')
                });
            compContent = appEDN.gFuncs.parseTemplate(baseObj.CC_Tmpls.mainDiv.join(''), {
                cc_id:          baseObj.cc_id,
                CustStyle:      '',
                mainSection:    mainSection
            });
            appEDN.gFuncs.Log_CC( componentObj, compContent);
            baseObj.target.innerHTML = compContent;
        },
        /**
         *
         * @param componentObj
         * @param baseObj
         */
        processCcCssButtonBehavior1 = function (componentObj, baseObj){
            var btnLbl = "#" + baseObj.NtsSaveID,
                CcBaseObj = baseObj;
            $(btnLbl).attr('buttonState','Disabled');
            $(btnLbl).on( "click", function () {
                var arrWrk = [],
                    vCcBaseObj = CcBaseObj ;;
                if ( $(btnLbl).attr('buttonState') =='Enabled'){
                    arrWrk.push('^MINE^,');
                    arrWrk.push(componentObj.getProperty("encounterId"), ',');//1,2
                    arrWrk.push( $('div#EDnotes_0').html());//3
                    arrWrk.push( $('div#EDnotes_1').html());//4
                    arrWrk.push( $('div#EDnotes_2').html());//5
                    arrWrk.push( $('div#EDnotes_3').html());//6
                    arrWrk.push( $('div#EDnotes_4').html());//7
                    arrWrk.push( $('div#EDnotes_5').html());//8
                    arrWrk.push( $('div#EDnotes_6').html());//9
                    arrWrk.push( $('div#EDnotes_7').html());//10
                    arrWrk.push( $('div#EDnotes_8').html());//11
                    arrWrk.push( $('div#EDnotes_9').html());//12
                    arrWrk.push(componentObj.getProperty("personId"));//13
                    arrWrk.push(',', componentObj.getProperty("userId"));
                    arrWrk.push(',100');
                    arrWrk.forEach(
                        function (item, index) {
                            var strWrk,
                                strWrk2;
                            if( index >2 && index < 13) {
                                strWrk = item.replace('<div>','\\par ').replace(/<div>/g,'').replace(/<\/div>/g,'\\par ').replace(/<br>/g,'<br/>').replace(/<br\/>/,'\\par ');
                                if (strWrk.indexOf('\\par ') < 0 ) {
                                    strWrk += '\\par ';
                                }
                                strWrk2 = '^' + strWrk + '^,';
                                arrWrk[index] = (strWrk2 === '^\\par ^,'? '^^,': strWrk2);
                            }
                        });
                    if (componentObj.eApps.CCLreqObjSave == null){
                        componentObj.eApps.CCLreqObjSave = chla.eApps.gCCLRequest.neo();
                        componentObj.eApps.CCLreqObjSave.ObjectName='EDNotes.eApps.CCLreqObjSave';
                        componentObj.eApps.CCLreqObjSave.BtnSaveBehaviorFunc = componentObj.eApps.SaveButtonAction ;

                        vCcBaseObj.appNS.Logger.LogInfo(' Ednotes : CCLReport: ' + vCcBaseObj.NtsSaveCCL + ' CCL params: ' + arrWrk.join(''));
                        // componentObj.eApps.CCLreqObjSave.CallBackOperation =
                        //     function(responseData){
                        //         componentObj.eApps.CSSBehaviors.hoverContent =
                        //             componentObj.eApps.HoverDataFormater(responseData);
                        //     };
                    }
                    componentObj.eApps.CCLreqObjSave.DataTransfer0( componentObj.eApps.CCLreqObjSave,
                        vCcBaseObj.NtsSaveCCL,
                        arrWrk.join(''),
                        '#' + vCcBaseObj.NtsSaveID);
                }
            });
            componentObj.eApps.SaveButtonAction('#' + baseObj.NtsSaveID, 'RESET');
        },
        /**
         *
         * @param componentObj
         * @param baseObj
         */
        processCcCssControlBehavior1 =  function (componentObj, baseObj){

            $('[id^=EDnotes_]').on( "click", function () {
                var btnId = '#' + baseObj.NtsSaveID;
                $(btnId).attr('buttonState','Enabled');
                componentObj.eApps.SaveButtonAction('#' + baseObj.NtsSaveID, 'ENABLE');
            } );
        },
        /**
         *
         * @param arrQuestions
         * @param arrAnswers
         -         */
        processRPTDATA_main_data = function (arrQuestions, arrAnswers) {
            var arrCloneData = arrQuestions.map(
                /**
                 *
                 * @param item
                 * @param index
                 * @returns {String}
                 */
                function (item,index) {
                    var arrWrk = [];
                    arrWrk.push('<div style="font-weight:600;">',(index + 1), '. ', item.SEC_LBL, ':','</div>');
                    arrWrk.push('<div id="EDnotes_',index,'" style="padding-left:1em;padding-bottom:.3em;" contentEditable="true"><br/><#=DocData#></div>');
                    return arrWrk.join('');
                });
            arrAnswers.forEach(
                /**
                 *
                 * @param item
                 */
                function (item) {
                    var strWrk,
                        strWrk2;
                    strWrk2 = item.EDNOTES;
                    strWrk2 = (strWrk2 === ''? '\\par': strWrk2);
                    strWrk = arrCloneData[item.SEC_LBL_ID].replace('<br/><#=DocData#>',strWrk2.replace(/\\par/g,'<br>'));
                    arrCloneData[item.SEC_LBL_ID] = strWrk;
                });
            Clone_content_body = arrCloneData.join('').replace(/<#=DocData#>/g,'');
        },
        base_component;
    /**
     *
     * @param this_cc_id_objName
     * @param base_component_data
     * @param parameterslist
     */
    thisClone_component.cloneInit = function (this_cc_id_objName,base_component_data,parameterslist) {
        var wrkValue,
            wrkObj;
        // load the customization information
        wrkObj = ChlaStdClass.safeRead(chla,'eApps','CC_Settings',this_cc_id_objName); //'EDHnotes'
        if ( wrkObj != '' ){
            // load specific customization information
            wrkValue = ChlaStdClass.safeRead(chla,'eApps','CC_Settings',this_cc_id_objName,'compHeight');
            if ( wrkValue != '' ){
                base_component_data.compHeight = wrkValue;
            }
            wrkValue = ChlaStdClass.safeRead(chla,'eApps','CC_Settings',this_cc_id_objName,'rowCnt');
            if ( wrkValue != '' ){
                base_component_data.rowCnt = wrkValue;
            }
            wrkValue = ChlaStdClass.safeRead(chla,'eApps','CC_Settings',this_cc_id_objName,'NtsTextID');
            if ( wrkValue != '' ){
                base_component_data.NtsTextID = wrkValue;
            }
            wrkValue = ChlaStdClass.safeRead(chla,'eApps','CC_Settings',this_cc_id_objName,'NtsSaveID');
            if ( wrkValue != '' ){
                base_component_data.NtsSaveID = wrkValue;
            }
            wrkValue = ChlaStdClass.safeRead(chla,'eApps','CC_Settings',this_cc_id_objName,'NtsSaveCCL');
            if ( wrkValue != '' ){
                base_component_data.NtsSaveCCL = wrkValue;
            }
        }
        base_component_data.appNS = chla.eAppsClass.neo();
        ChlaStdClass.applyProperties(base_component_data.appNS, base_component_data);
        base_component_data.processCcInstance = processCcInstance;
        base_component_data.processRPTDATA_main_data = function () {};
        base_component_data.processCcCssControlBehavior1 = processCcCssControlBehavior1;
        base_component_data.processCcCssButtonBehavior1 = processCcCssButtonBehavior1;

    };
    objWrk = ChlaStdClass.safeRead( thisClone_component,'data','RPTDATA');
    elementObj = (objWrk === ''? elementObj : objWrk );

    processRPTDATA_main_data(elementObj.EDSECTLBL_LIST, elementObj.EDNOTES_LIST);
    base_component = new chla.GeneralDoc();
    base_component.render.call(thisClone_component,
        {
            clone_base_component: thisClone_component,
            clone_name: thisClone_component.name.replace('chla.',''),
            clone_default_data: Clone_content_body
        } );
};
chla.edDocNotes = function () { };
chla.edDocNotes.prototype = new MPage.Component();
chla.edDocNotes.prototype.constructor = MPage.Component;
chla.edDocNotes.prototype.base = MPage.Component.prototype;
chla.edDocNotes.prototype.name = "chla.edDocNotes";
chla.edDocNotes.prototype.cclProgram = "chla_ca_mp_cc_gennotes_json";
chla.edDocNotes.prototype.cclParams = [];
chla.edDocNotes.prototype.cclDataType = "JSON";
chla.edDocNotes.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("personId");
    this.cclParams[2] = this.getProperty("encounterId");
    this.cclParams[3] = this.getProperty("userId");
};

chla.edDocNotes.prototype.render = function () {
    var component = this,
        elementObj,
        target,
        compContent;
    var CC_SectMgt = null,
        CC_CssBehavior = null,
        gFuncs = null,
        htmlSecCtl = null,
        htmlSecCtlObj = null,
        htmlSecCtlData = null,
        CclReqObjSave = null,
        edDocNotes = {
            initOnly: false,
            cc_id: 'x',
            personId: 0,
            encounterId: 0,
            prsnlId: 0,
            transparentSpacer: '',
            CC_SectionManagement: {
                sectionlist: []
            },
            mainSection: '',
            mainSectionEnd: '',
            H5_Section_ClinicMDNotes: '',
            H5_Section_IPNotes: '',
            H5_Section_HPNotes: '',
            H5_Section_CRPIPC: '',
            H5_Section_EDPN: '',
            H6_Section_Pulm: '',
            H6_Section_Cardio: '',
            H6_Section_Endoc: '',
            H6_Section_Nuerol: '',
            H6_Section_Nueros: '',
            H6_Section_NephRen: '',
            H6_Section_HistPhy: '',
            H6_Section_PHistPhy: '',
            H6_Section_PIPDP: '',
            H6_Section_PORec: '',
            CC_Tmpls: {
                mainDiv: [
                    '<div id="<#=cc_id#>" class="eapps_CC">',
                    '<#=mainSection#>',
                    // '<#=H5_Section_ClinicMDNotes#>',
                    '<#=H5_Section_IPNotes#>',
                    // '<#=H5_Section_HPNotes#>',
                    // '<#=H5_Section_CRPIPC#>',
                    '<#=H5_Section_EDPN#>',
                    '<#=mainSectionEnd#>',
                    '</div>'
                ],
                RowResults: ['<tr <#=ROWODDS#> >',
                    '<td><#=eventdate#></td>',
                    '<td><a onclick="chla.eApps.gFuncs.ReadOnlyMPageUtils(&quot;POWERNOTE&quot;,',
                    '<#=personId#>,<#=encounterId#>,<#=eventId#>);">',
                    '<#=titleLbl#></a></td><td><#=authorby#></td></tr>'
                ],
                RowResultHdr: '<tr><th style="width:25%">Last Updated</th><th style="width:50%">Title</th><th style="width:25%">Author</th></tr>'
            },
            processH6_Sec_All_Data: function (dataObj, sectObj) {
                var i, j, lencnt, dataElement,
                    lentest,
                    listlen,
                    oddEvenFlag,
                    sectionData;
                for (j = 0 , lencnt = sectObj.sectionlist.length; j < lencnt; j++) {
                    sectionData = CC_SectMgt[CC_SectMgt.sectionlist[j]];
                    if (sectionData.SectionLevel == 'H6') {
                        sectionData.Count = 0;
                        sectionData.Body = '';
                        dataElement = null;
                        //H5 sectionData.SectionID: 'ClinicMDNotes  groups the clinic notes
                        lentest = dataObj.PULM_CLINIC_NOTES_CNT
                        if (sectionData.SectionID == 'Pulm' && lentest > 0) {
                            dataElement = dataObj.PULM_CLINIC_NOTES;
                            listlen = lentest;
                        }
                        lentest = dataObj.CARDIO_CLINIC_NOTES_CNT;
                        if (sectionData.SectionID == 'Cardio' && lentest > 0) {
                            dataElement = dataObj.CARDIO_CLINIC_NOTES;
                            listlen = lentest;
                        }
                        lentest = dataObj.ENDOCRN_CLINIC_NOTES_CNT;
                        if (sectionData.SectionID == 'Endoc' && lentest > 0) {
                            dataElement = dataObj.ENDOCRN_CLINIC_NOTES;
                            listlen = lentest;
                        }
                        lentest = dataObj.NEURO_CLINIC_NOTES_CNT;
                        if (sectionData.SectionID == 'Nuerol' && lentest > 0) {
                            dataElement = dataObj.NEURO_CLINIC_NOTES;
                            listlen = lentest;
                        }
                        lentest = dataObj.NEUROSURGERY_CLINIC_NOTES_CNT;
                        if (sectionData.SectionID == 'Nueros' && lentest > 0) {
                            dataElement = dataObj.NEUROSURGERY_CLINIC_NOTES;
                            listlen = lentest;
                        }
                        lentest = dataObj.NEPHRO_CLINIC_NOTES_CNT;
                        if (sectionData.SectionID == 'NephRen' && lentest > 0) {
                            dataElement = dataObj.NEPHRO_CLINIC_NOTES;
                            listlen = lentest;
                        }
                        //H5 sectionData.SectionID: 'IPNotes'       groups the PIPDP notes
                        if (sectionData.SectionID == 'PIPDP') {
                            dataElement = [];
                            dataElement.push(dataObj.IP_DAILY_PROGRESS_NOTE);
                            listlen = dataElement[0].EVENT_ID == '' ? 0 : 1;
                        }
                        if (sectionData.SectionID == 'HistPhy') {
                            dataElement = [];
                            dataElement.push(dataObj.HP_NOTE);
                            listlen = dataElement[0].EVENT_ID == '' ? 0 : 1;
                        }
                        if (sectionData.SectionID == 'PHistPhy') {
                            dataElement = [];
                            dataElement.push(dataObj.PREOP_HP_NOTE);
                            listlen = dataElement[0].EVENT_ID == '' ? 0 : 1;
                        }
                        if (dataElement == null) {
                            listlen = 0;
                        }
                        for (i = 0; i < listlen; i++) {
                            oddEvenFlag = (i % 2 == 0 ? '' : 'class="odd"');
                            sectionData.Body += gFuncs.parseTemplate(edDocNotes.CC_Tmpls.RowResults.join(''), {
                                personId: edDocNotes.personId,
                                encounterId: edDocNotes.encounterId,
                                eventId: dataElement[i].EVENT_ID,
                                titleLbl: dataElement[i].EVENT_DISP,
                                authorby: dataElement[i].PERFORMED_BY,
                                eventdate: dataElement[i].EVENT_END_DATE,
                                ROWODDS: oddEvenFlag
                            });
                            sectionData.Count += 1;
                        }
                    }
                }
            },
            processH5_Sec_All_Data: function (dataObj, sectObj) {
                var i, j, lencnt, dataElement,
                    listlen,
                    oddEvenFlag,
                    sectionData;
                for (j = 0 , lencnt = sectObj.sectionlist.length; j < lencnt; j++) {
                    sectionData = CC_SectMgt[CC_SectMgt.sectionlist[j]];
                    if (sectionData.SectionLevel == 'H5') {
                        sectionData.Body = '';
                        sectionData.Count = 0;
                        dataElement = null;
                        listlen = dataObj.CONSULTATION_REFERRALS_CNT;
                        if (sectionData.SectionID == 'CRPIPC' && listlen > 0) {
                            dataElement = dataObj.CONSULTATION_REFERRALS;
                        }
                        if (sectionData.SectionID == 'EDPN') {
                            dataElement = [];
                            dataElement.push(dataObj.ED_PROVIDER_NOTE);
                            listlen = dataElement[0].EVENT_ID == '' ? 0 : 1;
                        }
                        if (sectionData.SectionID == 'PORec') {
                            dataElement = [];
                            dataElement.push(dataObj.PERI_OPERATIVE_RECORD);
                            listlen = dataElement[0].EVENT_ID == '' ? 0 : 1;
                        }
                        if (dataElement == null) {
                            listlen = 0;
                        }
                        for (i = 0; i < listlen; i++) {
                            oddEvenFlag = (i % 2 == 0 ? '' : 'class="even"');
                            sectionData.Body += gFuncs.parseTemplate(edDocNotes.CC_Tmpls.RowResults.join(''), {
                                personId: edDocNotes.personId,
                                encounterId: edDocNotes.encounterId,
                                eventId: dataElement[i].EVENT_ID,
                                titleLbl: dataElement[i].EVENT_DISP,
                                authorby: dataElement[i].PERFORMED_BY,
                                eventdate: dataElement[i].EVENT_END_DATE,
                                ROWODDS: oddEvenFlag
                            });
                        }
                        sectionData.Count = listlen;
                    }
                }
            },
            processRPTDATA_main_data: function () {
                edDocNotes.mainSection = '';
            },
            processH6_Section_All: function (sectObj) {
                var j, lencnt, dataElement,
                    sectionObj = htmlSecCtl.neo(),
                    wrkValue,
                    sectionData,
                    sectionName,
                    defaultHeight;
                for (j = 0 , lencnt = CC_SectMgt.sectionlist.length; j < lencnt; j++) {
                    sectionData = CC_SectMgt[CC_SectMgt.sectionlist[j]];
                    if (sectionData.SectionLevel == 'H6') {
                        wrkValue = '(' + sectionData.Count + ')';
                        if (sectionData.SectionID == 'PIPDP') {
                            wrkValue = ( sectionData.Count == 0 ? '(0)' : '');
                        } else if (sectionData.SectionID == 'HistPhy') {
                            wrkValue = ( sectionData.Count == 0 ? '(0)' : '');
                        } else if (sectionData.SectionID == 'PHistPhy') {
                            wrkValue = ( sectionData.Count == 0 ? '(0)' : '');
                        } else {
                            wrkValue = '(' + sectionData.Count + ')';
                        }
                        defaultHeight = sectionData.Count < 15 ? '' : 'style="height:300px; overflow-y:auto"';
                        sectionObj.initValues(
                            {
                                idLabel: sectionData.SectionLevel + '_Sec_' + sectionData.SectionID,
                                TLabel1: sectionData.TLabel1,
                                SectionClosed: sectionData.SectionClosed,
                                SectionCntVal: sectionData.Count,
                                //CustIcon: 'none',
                                SectionCnt: wrkValue,
                                ContentBody: '<div ' + defaultHeight + '><table>' +
                                edDocNotes.CC_Tmpls.RowResultHdr +
                                sectionData.Body +
                                '</table></div>',
                                TemplateType: sectionData.TemplateType
                            });
                        sectionName = sectionData.SectionLevel + '_Section_' + sectionData.SectionID,
                            edDocNotes[sectionName] =
                                sectionObj.generateHTML(CC_CssBehavior);
                        sectionData.SectionDivID = sectionObj.SectionDivID;
                    }
                }
            },
            processH5_Section_All: function () {
                var sectionObj = htmlSecCtl.neo(),
                    wrkValue,
                    sectionName,
                    sectionData,
                    defaultHeight;
                for (j = 0 , lencnt = CC_SectMgt.sectionlist.length; j < lencnt; j++) {
                    sectionData = CC_SectMgt[CC_SectMgt.sectionlist[j]];
                    sectionData.CustIcon = '';
                    if (sectionData.SectionLevel == 'H5') {
                        wrkValue = '';
                        sectionData.CustIcon = 'auto';
                        //H5 sectionData.SectionID: 'ClinicMDNotes    groups the clinic notes
                        if (sectionData.SectionID == 'ClinicMDNotes') {
                            sectionData.Body += edDocNotes.H6_Section_Pulm;
                            sectionData.Body += edDocNotes.H6_Section_Cardio;
                            sectionData.Body += edDocNotes.H6_Section_Endoc;
                            sectionData.Body += edDocNotes.H6_Section_Nuerol;
                            sectionData.Body += edDocNotes.H6_Section_Nueros;
                            sectionData.Body += edDocNotes.H6_Section_NephRen;
                            sectionData.Count = 1;
                            sectionData.CustIcon = 'none';
                        }
                        //H5 sectionData.SectionID: 'IPNotes'       groups the PIPDP notes  open always
                        else if (sectionData.SectionID == 'IPNotes') {
                            sectionData.Body += edDocNotes.H6_Section_PIPDP;
                            sectionData.CustIcon = 'none';
                            sectionData.Count = 1;
                        }
                        //H5 sectionData.SectionID: 'HPNotes'       groups the HistPhy &&  PHistPhy notes  open always
                        else if (sectionData.SectionID == 'HPNotes') {
                            sectionData.Body += edDocNotes.H6_Section_HistPhy;
                            sectionData.Body += edDocNotes.H6_Section_PHistPhy;
                            sectionData.CustIcon = 'none';
                            sectionData.Count = 1;
                        }
                        //H5 sectionData.SectionID: 'CRPIPC'          groups the Consults / Referral - Physicians IP Consultation  notes
                        else if (sectionData.SectionID == 'CRPIPC') {
                            wrkValue = sectionData.Body
                            if (sectionData.Count > 0) {
                                sectionData.Body = '<div ' + defaultHeight + '><table>' +
                                    edDocNotes.CC_Tmpls.RowResultHdr +
                                    wrkValue +
                                    '</table></div>';
                            }
                            //sectionData.Count = 1;
                            //sectionData.CustIcon = 'none';
                        }
                        //H5 sectionData.SectionID: 'EDPN'            groups the ED Physician Provider Notes note always open
                        else if (sectionData.SectionID == 'EDPN') {
                            //sectionData.CustIcon = 'none';
                            if (sectionData.Count == 0) {
                                //sectionData.Count = 1;
                                sectionData.Body = '';
                            } else {
                                wrkValue = sectionData.Body;
                                sectionData.Body = '<div ' + defaultHeight + '><table>' +
                                    edDocNotes.CC_Tmpls.RowResultHdr +
                                    wrkValue +
                                    '</table></div>';
                            }
                        }
                        defaultHeight = '';  //sectionData.Count < 15?  '' : 'style="height:300px; overflow-y:auto"';
                        sectionObj.initValues(
                            {
                                idLabel: sectionData.SectionLevel + '_Sec_' + sectionData.SectionID,
                                TLabel1: sectionData.TLabel1,
                                SectionClosed: sectionData.SectionClosed,
                                SectionCntVal: sectionData.Count,
                                SectionCnt: '',
                                CustIcon: sectionData.CustIcon,
                                ContentBody: sectionData.Body,
                                TemplateType: sectionData.TemplateType
                            });
                        sectionName = sectionData.SectionLevel + '_Section_' + sectionData.SectionID
                        edDocNotes[sectionName] = sectionObj.generateHTML(CC_CssBehavior);
                        sectionData.SectionDivID = sectionObj.SectionDivID;
                    }
                }
            },
            processCcInstance: function () {
                compContent = gFuncs.parseTemplate(edDocNotes.CC_Tmpls.mainDiv.join(''), {
                    cc_id: edDocNotes.cc_id,
                    mainSection: edDocNotes.mainSection,
                    H5_Section_ClinicMDNotes: edDocNotes.H5_Section_ClinicMDNotes,
                    H5_Section_IPNotes: edDocNotes.H5_Section_IPNotes,
                    H5_Section_HPNotes: edDocNotes.H5_Section_HPNotes,
                    H5_Section_CRPIPC: edDocNotes.H5_Section_CRPIPC,
                    H5_Section_EDPN: edDocNotes.H5_Section_EDPN,
                    mainSectionEnd: edDocNotes.mainSectionEnd
                });
                gFuncs.Log_CC(component, compContent);
                target.innerHTML = compContent;
            },
            processCcCssSectionBehavior1: function (CssBehavior, sectObj) {
                htmlSecCtlObj.initToggle(CssBehavior, sectObj);
            },
            processCcCssSectionBehaviorH6: function (CssBehavior, CC_SectMgt_Obj) {
                var j, lencnt;
                for (j = 0 , lencnt = CC_SectMgt_Obj.sectionlist.length; j < lencnt; j++) {
                    sectionData = CC_SectMgt_Obj[CC_SectMgt_Obj.sectionlist[j]];
                    if (sectionData.SectionLevel == 'H6') {
                        htmlSecCtlObj.initToggle(CssBehavior, sectionData);
                    }
                }
            },
            init: function () {
                var subHeaderDisplay;

                elementObj = component.data.RPTDATA;
                target = component.getTarget();

                component.eApps = {
                    cc_id: component.name.replace('.', '_'),
                    CSSBehaviors: chla.eApps.gCSSBehaviors.neo(),
                    TestSAP: null
                };
                edDocNotes.initOnly = ChlaStdClass.safeRead(chla, 'eApps', 'operationMode') == 'test' ||
                    ChlaStdClass.safeRead(chla, 'eApps', 'edDocNotes', 'operationMode') == 'edDocNotesTest';
                edDocNotes.cc_id = component.eApps.cc_id;
                edDocNotes.personId = component.getProperty("personId");
                edDocNotes.encounterId = component.getProperty("encounterId");
                edDocNotes.prsnlId = component.getProperty("userId");
                component.eApps.TestSAP = edDocNotes.TestServiceAccessPoint;

                htmlSecCtl = chlaNsMgr.aliasDirector('chla.eApps.Html.SectionHeaderCtl');
                htmlSecCtlData = chlaNsMgr.aliasDirector('chla.eApps.Html.SectionData');
                htmlSecCtlObj = htmlSecCtl.neo();
                initSecData = htmlSecCtlData.neo();

                CC_SectMgt = edDocNotes.CC_SectionManagement;

                SectionCfg = [
                    // H5 Sections
                    {
                        T_type: 'H5',
                        SecId: 'ClinicMDNotes',
                        TLblId: ' Clinic MD Notes - most recent two notes for each clinic',
                        SecClsd: 'open',
                        SecLvl: 'H5'
                    },
                    {T_type: 'H5', SecId: 'IPNotes', TLblId: 'Progress Notes', SecClsd: 'open', SecLvl: 'H5'},
                    {T_type: 'H5', SecId: 'HPNotes', TLblId: 'H&P Notes', SecClsd: 'open', SecLvl: 'H5'},
                    {
                        T_type: 'H5',
                        SecId: 'CRPIPC',
                        TLblId: 'Physician IP Consultation - up to most 5 recent',
                        SecClsd: 'open',
                        SecLvl: 'H5'
                    },
                    {
                        T_type: 'H5',
                        SecId: 'EDPN',
                        TLblId: 'ED Physician Provider Notes - most recent note',
                        SecClsd: 'open',
                        SecLvl: 'H5'
                    },
                    // {T_type: 'H5',SecId: 'PORec',TLblId: 'PERI OPERATIVE RECORD', SecClsd: 'auto',SecLvl:'H5'},
                    // H6 Sections
                    {T_type: 'H6', SecId: 'Pulm', TLblId: 'Pulmonology', SecClsd: 'closed', SecLvl: 'H6'},
                    {T_type: 'H6', SecId: 'Cardio', TLblId: 'Cardiology', SecClsd: 'closed', SecLvl: 'H6'},
                    {T_type: 'H6', SecId: 'Endoc', TLblId: 'Endocrinology', SecClsd: 'closed', SecLvl: 'H6'},
                    {T_type: 'H6', SecId: 'Nuerol', TLblId: 'Neurology', SecClsd: 'closed', SecLvl: 'H6'},
                    {T_type: 'H6', SecId: 'Nueros', TLblId: 'Neurosurgery', SecClsd: 'closed', SecLvl: 'H6'},
                    {T_type: 'H6', SecId: 'NephRen', TLblId: 'Nephrology/Renal', SecClsd: 'closed', SecLvl: 'H6'},
                    {
                        T_type: 'H6',
                        SecId: 'HistPhy',
                        TLblId: 'IP History & Physical - most recent note',
                        SecClsd: 'closed',
                        SecLvl: 'H6'
                    },
                    {
                        T_type: 'H6',
                        SecId: 'PHistPhy',
                        TLblId: 'Pre-Op History & Physical - most recent note',
                        SecClsd: 'closed',
                        SecLvl: 'H6'
                    },
                    {
                        T_type: 'H6',
                        SecId: 'PIPDP',
                        TLblId: 'Physician IP Daily Progress - most recent note',
                        SecClsd: 'closed',
                        SecLvl: 'H6'
                    }
                ];
                CC_SectMgt.sectionlist = initSecData.Section_config(SectionCfg, CC_SectMgt);

                CC_CssBehavior = component.eApps.CSSBehaviors;

                gFuncs = chlaNsMgr.aliasDirector('chla.eApps.gFuncs');
            },
            TestServiceAccessPoint: function () {
                return {
                    TestProcessRPTDATA_main: edDocNotes.processRPTDATA_main_data,
                    TestProcessH6_Sec_All_data: edDocNotes.processH6_Sec_All_data,
                    TestProcessH5_Sec_All_data: edDocNotes.processH5_Sec_All_data,
                    TestProcessH6_Section_All_data: edDocNotes.processH6_Section_All,
                    TestProcessH5_Section_All_data: edDocNotes.processH5_Section_All,
                    TestProcessCcInstance: edDocNotes.processCcInstance,
                    TestProcessCcCssSectionBehavior_1: edDocNotes.processCcCssSectionBehavior1,
                    TestProcessCcCssSectionBehavior_H6: edDocNotes.processCcCssSectionBehaviorH6
                };
            }
        };
    edDocNotes.init();
    if (edDocNotes.initOnly == false) {
        edDocNotes.processRPTDATA_main_data(elementObj);
        edDocNotes.processH5_Sec_All_Data(elementObj, CC_SectMgt);
        edDocNotes.processH6_Sec_All_Data(elementObj, CC_SectMgt);
        edDocNotes.processH6_Section_All(elementObj, CC_SectMgt);
        edDocNotes.processH5_Section_All(elementObj, CC_SectMgt);
        edDocNotes.processCcInstance();
        edDocNotes.processCcCssSectionBehavior1(CC_CssBehavior, CC_SectMgt['H5_Sec_EDPN']);
        edDocNotes.processCcCssSectionBehavior1(CC_CssBehavior, CC_SectMgt['H5_Sec_CRPIPC']);
        edDocNotes.processCcCssSectionBehaviorH6(CC_CssBehavior, CC_SectMgt);
    }
};
//::===========================================================================
//:: CC - EDHandoff Module
//::---------------------------------------------------------------------------
chla.EDHandoff                       = function () { };
chla.EDHandoff.prototype             = new MPage.Component();
chla.EDHandoff.prototype.constructor = MPage.Component;
chla.EDHandoff.prototype.base        = MPage.Component.prototype;
chla.EDHandoff.prototype.name        = "chla.EDHandoff";
chla.EDHandoff.prototype.cclProgram  = "chla_ca_mp_md_edh_info_json";
chla.EDHandoff.prototype.cclParams   = [];
chla.EDHandoff.prototype.cclDataType = "JSON";
chla.EDHandoff.prototype.init        = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("encounterId");
    this.cclParams[2] = this.getProperty("userId");
};
//::---------------------------------------------------------------------------
chla.EDHandoff.prototype.render = function () {
{
    var vComponent = this,
        appEDH;
    appEDH = chla.eAppsClass.gCcModule.CcModInit(vComponent,{
//::============================================================================================
//::    PROPERTIES  of the  EDHandoff Class Lib
//::============================================================================================
        Globals: {
            CC_SectMgt: null,
            CC_CssBehavior: null,
            Funcs: null,
            InitSecData: null
        },
        Prop: {
            initOnly: false,
            cc_id: 'x',
            cc_lbl: 'EDH',
            personId: 0,
            encounterId: 0,
            prsnlId: 0,
            Enctr: {Reg_DT: null},
            transparentSpacer: '',
            CC_SectionManagement: {
                sectionlist: []
            },
            mainSection: '',
            mainSectionEnd: '',
            mainSectionBody: '',
            CC_Modules: [
                {
                    nsp: 'chla.meds',
                    lbl: 'Meds',
                    tLbl: 'Meds',
                    objTypeName: 'Meds',
                    processType: 'Orders',
                    cclProgram: 'chla_ca_mp_md_EDmeds_json'
                },
                {
                    nsp: 'chla.edDocNotes',
                    lbl: 'Documents',
                    tLbl: 'Documents',
                    objTypeName: 'EdDocs',
                    processType: 'Orders',
                    cclProgram: 'chla_ca_mp_cc_gennotes_json'
                },
                {
                    nsp: 'chla.vitalsigns',
                    lbl: 'Vital Signs',
                    tLbl: 'Vital Signs',
                    objTypeName: 'VitalSigns',
                    processType: 'Results',
                    cclProgram: 'chla_ca_mp_cc_EDvitals_json'
                },
                {
                    nsp: 'chla.labs',
                    lbl: 'Labs',
                    tLbl: 'Labs',
                    objTypeName: 'Labs',
                    processType: 'Results',
                    cclProgram: 'chla_ca_mp_md_EDlabs_json'
                },
                {
                    nsp: 'chla.micros',
                    lbl: 'Micros',
                    tLbl: '',
                    objTypeName: 'Micros',
                    processType: 'Results',
                    cclProgram: 'chla_ca_mp_md_EDmicro_json'
                },
                {
                    nsp: 'chla.radiology',
                    lbl: 'Radiology',
                    tLbl: 'Radiology',
                    objTypeName: 'Radiology',
                    processType: 'Results',
                    cclProgram: 'chla_ca_mp_rad_EDevents_json'
                },
                {
                    nsp: 'chla.SurveyTimer',
                    lbl: 'Survey Timer',
                    tLbl: '',
                    objTypeName: 'SurvTimr',
                    processType: 'FuncTimr',
                    cclProgram: 'chla_ca_mp_cc_edsurvey_json'
                },
                {
                    nsp: 'chla.EDHnotes',
                    lbl: 'ED Handoff Notes',
                    tLbl: '',
                    objTypeName: 'EDHnotes',
                    processType: 'Notes',
                    cclProgram: 'chla_ca_mp_cc_ednote_json'
                }
            ],
            CC_Tmpls: {
                mainDiv: [
                    '<div id="EDHXX11" >',
                    '<div id="<#=cc_id#>" class="eapps_CC"  <#=StyleOverRd#>><#=Loadscrn#></div>',
                    '</div>'
                ],
                ssecTmpltLbl: [
                    '<div id="ssecLblTop" style="z-index: 20; display:block; position: fixed; width: 852px;">',
                    '<table class="header EDHtbl1"><tr><td class="<#=secColor#>">Time: ',
                    '<span style="font-weight: bold;"><#=ElapseTMlbl#></td></tr></table><div>'
                ],
                ssecNavHdrTmplt: [                                                          //150
                    '<div class="wrkflw-nav-subsechdr" id="ssecElementIda" style="height:140px; padding-left: 6px;">', //<br>',
                    '<span class="eapps-units">ED Encounter<br/>Start Time:<br>',
                    '<#=startdate#></span><span class="eapps-units" >&nbsp;<#=starttime#></span><br>',
                    '<span class="eapps-units">Until:<br>',
                    '<#=enddate#></span><span class="eapps-units" >&nbsp;<#=endtime#></span><br>',
                    '<div id="EDbtn1SV" class="eappsCssBtn_EDH eappsCssBtn" style="margin-bottom:4px;">Summary View</div>',
                    '<div id="EDbtn1TLV" class="eappsCssBtn_EDH eappsCssBtn" > TimeLine View</div>',
                    '</div>',
                    '<div id="edFlwNavTL" style="overflow-y: auto;"></div>'
                ],
                ssecTmplt: [
                    '<div class="wrkflw-views" id="<#=ssBodyId#>"><div class="wrkflw-view" id="<#=assocViewId#>">',
                    '<div id="<#=secId#>"><table class="header EDHtbl1"><tr><td class="<#=secColor#>">Time:&nbsp;',
                    '<span style="font-weight: bold;"><#=ElapseTMlbl#></td></tr></table>',
                    '<div><table class="header EDHtbl2 <#=EDHtbl2Display#>"><tr>',
                    '<th style="font-size: 10px;color:black;font-weight:bold;">Orders</th>',
                    '<th style="font-size: 10px;color:black;font-weight:bold;">Results</th></tr>',
                    '<tr><td id="OrdersData<#=secId#>" ><#=OrdersData#></td><td id="ResultsData<#=secId#>">',
                    '<#=ResultsData#></td></tr></table></div></div>'
                ],
                ssecTmpltSummary: [
                    '<div class="wrkflw-views" id="<#=ssBodyId#>"><div class="wrkflw-view" id="<#=assocViewId#>">',
                    '<div id="<#=secId#>"><table class="header EDHtbl0" style="background-color:#FF8025;"><tr><td class="<#=secColor#>">',
                    '&nbsp;<span style="font-weight: bold;"><#=ElapseTMlbl#></td></tr></table>',
                    '<div><table class="header EDHtbl2"><tr><th style="font-size: 10px;color:black;font-weight:bold;">Orders</th>',
                    '<th style="font-size: 10px;color:black;font-weight:bold;">Results</th></tr>',
                    '<tr><td id="OrdersData<#=secId#>" ><#=OrdersData#></td><td id="ResultsData<#=secId#>">',
                    '<#=ResultsData#></td></tr></table></div></div>'
                ],
                ssecNavTmplt: [
                    '<div class="wrkflw-nav-subsec" id="<#=ssContainerId#>"><div class="Anavi-subsec-body" id="<#=navId#>">',
                    '<span class="wrkflw-selectOption" onclick="chla.eApps.EDH.wfScroll(',
                    '<#=navNum#>);"><#=navLbl#></span></div></div>'
                ],
                edNoteHdrTmpl: [
                    'Date: <#=NoteDateTime#>  UserID:<#=NoteUserID#> <br/>'
                ],
                initialScreen: [
                    '<div  id="EDHWait" style="margin: 50px auto;  width: 250px; height: 250px;',
                    ' background: url(data:image/gif;base64,R0lGODlhIAAgAPMAAP///ylTl8/Y55erzMHN4Kq61VZ3rHGMud7k7ujs88bR40JnoyxVmAAAAAAAAAAAACH/',
                    'C05FVFNDQVBFMi4wAwEAAAAh/h1CdWlsdCB3aXRoIEdJRiBNb3ZpZSBHZWFyIDQuMAAh/hVNYWRlIGJ5IEFqYXhMb2FkLmluZm8AIfkECQoAAAAsAAAAACAAIAAABOcQyElpYaXqzediS4UknUY',
                    'MFaNSAkGUVLIsB6UyU+IqMDUvL8ltonAhepPBzDAZAhA7JMUwQwGcLgJJKiH8SEMoQUARbwEEgyEzOVQ1ulzROCmoDYegYMHutLJkFAd3eEc9WQQKZxQEg3dIYoYddgZBPZIwCVZcnFyIOwkCBQ',
                    'OkpZyfO6Wqm0ioiqKrrJ2zHZgwtrV0JZFIc4mLclk8SH8ugRPFibeWCb6SYr8TWhpix09FZzoEmH9HWV0uwD3aQd9PUZxzhuYA6lxiw2guOew9c2f1f55jjPNl4h0S2CoSj9aGZgA3RAAAIfkECQo',
                    'AAAAsAAAAACAAIAAABOoQyElpWaTqzadZRjUUnUaQ1KJSBsOUVGIYR7pKhbvA7KxMqp1k4RrwJoVZbXgb6I6UwwwVBCBcDBQUQJgZEoDqwRWaIAgEsAQxGPwmUoOxkhNIEgo0ATFRtNt8VgYZJQJ6',
                    'BHYUBH8jajCHCo4UbIxHZ3swfgOJPIE8CYRboluHaJF4paFHqQQKeamiqaevh6O2llueMJe6G7xHtJEbqKZQhnqcEsdoyb6hxJhresISaRqXyQh5jqDRymh8etVokkfdhOJWxaKvgekA7bnrXGgT51',
                    'uvju8Ax6SIivUmlSuRoFeeN7c44BnIIQIAIfkECQoAAAAsAAAAACAAIAAABO4QyEkpMaTqzecxRzVkXYUolaFSx7KUVDKMlGpMhHvD0zwgE1vQNeBNFL7gCjDQGSmFGQogTLgWpEkChvBthc1FqMdgF',
                    'LQEBXASpVUKC4EEXmYUJQiCXrEFyOQdAgZ1DDsTAnp6An0whFgbCQqJUzADZXcdeQRrPAecJQmfT6OjiZMJkaZ6pKp7kq2sqnypqqS2o6IluRyauxS9Rq9pjDHClDCIiYCHpsu8WbSbE5rDOMR4ir+Sj',
                    'Al6n8lAiRKJ1zzdqwDiAJrHwd7j6ACvvhvsOPHnWTyvjOoSyaUIOPOHp1yHUBUktbulIZLBDREAACH5BAkKAAAALAAAAAAgACAAAATnEMhJqRii6s1nGUVVEJ2WINWgUodhlFRCENmkDhPhvnA+J7aV',
                    'pGUI9SSImSKIAxRchyNFMUMBboDEjhSDyX7X1QBKGSwW3CxBYZUIqhqdVXdeNAFJJVDd3ggOdQtRFjMzAnswgQZpMVSFRwVndxx5fSUDiCUnUpydEwygoQsFCY6FjD2hqgymp52rDKOlpzOetkeWJbm',
                    'UcLq9MKYKmROzSlJvhTUTyIYwScSmbXlriATDeM0TCFSIX33IKI8Ahdde4uJ5S52Oc7US7JzpPmlfqCWO1e5u+j3ZEuLaynHYNGXNLU3CpEQAACH5BAkKAAAALAAAAAAgACAAAATuEMhJKSqo6s0nKUW',
                    'lZF2VkBMYpsNQUglBCJQ6Ia37enKSgpOcYneTDSU2gCJHpChkJFsih5L4SrEewEZorZAGA2ESG1EEUI1gcCUcwoYvQkZQXGNVDeINP1TQdAJXL3AGB0cmT3REBWFfHHMEeR1sRCdNmJkTC5ydcQmKdGO',
                    'YnaULoaKZpgtioKIymrFEA5OQTQMMDDodkbUaubkLj2ShiCUCBsAMBn+iNCVzKQvAu5F1gwSDRTMUuAyjAFlVgBmLAHTalubmkcZEiiTmSmlN7TzgWeA7itiwE4CYZDyTIE8CgnRY8jxxJysRQg4RAAA',
                    'h+QQJCgAAACwAAAAAIAAgAAAE8xDISWlSqerNpyJKJSCdlpAUoaZFUVqqkK4S0hLvTGSSivctWa6mCvVogpZr6FGhfICEEjXhdRK+DDRZ+EkUgwEVq6ACBE4NYlcLh42AdZGHNZsK7sFygvYJrCV5Yhs',
                    'XPl4lAm8vcnYdbDknTJKTEwaWlwc7H4aHOZefBpuck6AGmYWjlKo5A4AljRwFCwsDi2k5s7MGnRKoIEMIB7kLByKGQh0DDEIEBrm1RHMTjxQHDAwGFAPOXlgEZn0kUAnXDHtM3j9QAMoMC5SbTzQAC9fQ',
                    'wEXT8wTlkptW6yQYuObKEQFkAAJK0CMpEoUPcFYRwsAkAgAh+QQJCgAAACwAAAAAIAAgAAAE6xDISWlSqerNpyJKhWRdlSAVoVLCWk6JKlAqAavhO9UkUHsqlE6CwO1cRdCQ8iEIfzFVTzLdRAmZX3I2',
                    'SfZiCqGk5dTESJeaOAlClzsJsqwiJwiqnFrb2nS9kmIcgEsjQydLiIkTA4yNBXd9P4iNlAORkkuVA49pejaKoDoDeIJLBAYGBX9BQ6ioB58mfTl/B64GB3R6XB0FC1wEtqiqRDUYO3gDCwu5EwWosVGB',
                    'ZCgM1gAJywuxS1cS1gwSygsGik1C4BMGywOISbTpEgTaiE098RIHy6QbcxP44ri9OERhAYMFoUoUYEBMRwQAIfkECQoAAAAsAAAAACAAIAAABO8QyElpUqnqzaciSoVkXZUgFaFSwlpOiSpQKgGr4TvVJ',
                    'FB7KpROgsDtXEXQkPIhCH8xVU8y3UQJmV9yNkn2YgqhpOXUxEiXmjgJQpc7CbKsIicIqpxa29p0vZJiHIBLI0MnS4iJR3oYaXo2iI84fXqJko2UfoqbJViESwIDAzkdgzqiqIEwfaQlCQWoAwV0elwdBA',
                    'ZCCLGkbBhjDAMaAwYGB0yiYlGBBgwMxwvRAAnFBpCIBc4MGdELEgXFx4kLzsIA3RMHxbNLA87eEugSuMWI5Azs59LpxXgczgYoyJtQ4JoOWBUMLAjI6daCfC8iAAAh+QQJCgAAACwAAAAAIAAgAAAE8BDI',
                    'SWlSqerNpyJKhWRdlSAVoVLCWk6JKlAqAavhO9UkUHsqlE6CwO1cRdCQ8iEIfzFVTzLdRAmZX3I2SfZiCqGk5dTESJeaOAlClzsJsqwiJwiqnFrb2nS9kmIcgEsjQydLiIlHehhpejaIjzh9eomSjZR+ip',
                    'slhToIB4RBLwMMDANDfRgbBAumpoZ1XBMGrwwGsxsCA2h9YqWmCwVEwhoEAwPDXR89BaaoEwcLC6gG1gAJyAOBVinTCxnWBhIK2ooG09DiEwXIOUMD0+MS60TmS+gLkAD1Eu28S6aFonWNCbcSxyocMDCQU',
                    'x4DynREAAAh+QQJCgAAACwAAAAAIAAgAAAE6xDISWlSqerNpyJKhWRdlSAVoVLCWk6JKlAqAavhO9UkUHsqlE6CwO1cRdCQ8iEIfzFVTzLdRAmZX3I2SfZiCqGk5dTESJeaOAlClzsJsqwiJwiqnFrb2nS9',
                    'kmIcgEsjQydLiIlHehgFCwyQkYl6NQqRlwyTlI2PmIqfQ4U6CQOEQS8DCwsFQ30YGwQGqqqGdVwTB7MLB7cbRWh9YqmqBjYACMUaWxQIHz0EqqW4BgalA9cAV3gmKdQGGdfSSTmIB9SsAOFAb0MF1AcT6lQ',
                    '/S97G6dgTZNsb7xTyXfjBQjehwACCoDYIGNCrRAQAIfkECQoAAAAsAAAAACAAIAAABOgQyElpUqnqzaciSoVkXZUgFaFSwlpOiSpQKgGr4TvVJFB7KpROgsDtXEXQkPIhCH8xVU8y3UQJmV9yNkn2CAzGgB',
                    'XUxEiXmhAwCDMWBaqzlGjVuBODm2HAl2ogVRIFC3tDSWscbWJLI4djS5GSEoA4CYR7YZKVOJlum5UYmJmTpYeCVpA6iC8FBgZxOk2BGwoHr69DdYB+ALe4B4kaRWiza66vBzYACQO9AFsUCB9fr7GDAwM2UD',
                    'wvVQjZA1lIRpLhOT8STcIlCuFHy8zpQ+Fr8wB2qBvZ8T4uXfo2FKnwIYcpDhcCVogAACH5BAkKAAAALAAAAAAgACAAAATwEMhJaVKp6s2nIkqFZF1VDBWhUsJaTgnDGJRKwGr4TjJzSzaPCrGbDGSLSRCAy',
                    'BUpCxkKEEzYSLBXoUcMNgkCyhdLWBimEoPsoLGSLjaiZLCoG34CBnqTaNnCFAd1dQdyLzYgWDUGg0k7X4YcdAsFTyNFCXtPm5uIOVYHBqKjnJ45o6g0nZ4YBKGpnLGblztWlkMvCgMDgLk2GBsIu8OYfiq9',
                    'EifDBYoaTW8fuBK6uwWAbs7HYh9YwgM6En5dK1YqzW0V5QQZS1/gT9FySwDxs05ALgDqm9Fk+QB+znHQpuQfE4EcEkSiB0LWiwsINUQAADsAAAAAAAAAAAA=) no-repeat center;">',
                    '<div style="font-size:18px;text-align: center;" >Page Loading ... </div></div>'
                ]
            }
        },
//::============================================================================================
//::   METHODS- TIME
//::============================================================================================
        Dte: {
            util: {
                calcEDHDate: function (pWrkdttm, baseObj) {
                    var tempstr = [];
                    tempstr.push(appEDH.gFuncs.sFormatShortTime(pWrkdttm));
                    tempstr.push('</span>&nbsp;&nbsp;&nbsp; Date: ');
                    tempstr.push(appEDH.gFuncs.sFormatShortDate(pWrkdttm, '/'));
                    return tempstr.join('');
                },
                calcDate: function (pWrkdttm) {
                    return appEDH.gFuncs.sFormatShortDate(pWrkdttm, '/');
                },
                calcTime: function (pWrkdttm) {
                    return appEDH.gFuncs.sFormatShortTime(pWrkdttm);
                }
            }
        },
//::============================================================================================
//::   METHODS - DATA.UTILITIES
//::============================================================================================
        Dta: {
            util: {
                getCC_Data: function (baseObj) {
                    var appNS = baseObj.getCcNS(),
                        DTO_ccData = {
                            Orders_CC: {},
                            Results_CC: {},
                            EDfunc_CC: {}
                        },
                        CC_Modules;
                    CC_Modules = appNS.Prp.CC_Modules;
                    CC_Modules.forEach(
                        function (vModule) {
                            var cc_idnum,
                                objTypeName = vModule.objTypeName,
                                componentEapps = appNS.comp_eApps,
                                trgPtr;

                            if (vModule.processType == 'Orders') {
                                trgPtr = componentEapps.Orders_CC[objTypeName];
                                cc_idnum = trgPtr.id;
                                trgPtr.data = componentEapps._BaseObjs[cc_idnum].data;
                                DTO_ccData.Orders_CC[objTypeName] = {};
                                DTO_ccData.Orders_CC[objTypeName].data = trgPtr.data;
                            } else if (vModule.processType == 'Results') {
                                trgPtr = componentEapps.Results_CC[objTypeName];
                                cc_idnum = trgPtr.id;
                                trgPtr.data = componentEapps._BaseObjs[cc_idnum].data;
                                DTO_ccData.Results_CC[objTypeName] = {};
                                DTO_ccData.Results_CC[objTypeName].data = trgPtr.data;
                            }
                        }
                    );
                    return (DTO_ccData);
                },
                CC_DefCls: ChlaStdClass.extend(function () {
                    this.data = 'NotInitialized';
                    this.cc_id = 'NotInitialized';
                    this.id = 0;
                    this.processType = 'NotInitialized';
                    this.objTypeName = 'NotInitialized';
                    this.titleheader = 'NotInitialized';
                    this.target = null;
                    this.initState = false;
                    this.CCLname = 'NotInitialized';
                    this.RptParms = [];
                    this.CCLreqObj = null;
                }),
                /**
                 * processSectionalData
                 * Process the input data to select on data within time interval
                 *     interval_length = minutes in milli-seconds
                 *     (minutes*60000)  60000 = number of milli-seconds in 1 minute
                 * @param baseObj
                 * @param objTypeName
                 * @param Start_Time
                 * @param interval_length
                 * @param data
                 * @returns {object}
                 */
                processSectionalData: function (baseObj, objTypeName, Start_Time, interval_length, data) {
                    var result = {},
                        arrObjKeys,
                        med_cd,
                        eventDate,
                        eventDateEnd,
                        VSdata,
                        utils = {
                            edDocs: {
                                /**
                                 *
                                 * @param Start_Time
                                 * @param interval_length
                                 * @param EvntObj - {Array}
                                 * @returns {Array}
                                 */
                                withInTimeSeg: function (Start_Time, interval_length, EvntObj) {
                                    var eventDate,
                                        eventDateEnd,
                                        retValArr = [];
                                    EvntObj.forEach(
                                        function (Evnt) {
                                            eventDate = new Date(Evnt.EVENT_END_DATE);
                                            eventDateEnd = new Date(Start_Time.getTime() + interval_length);
                                            if (Start_Time < eventDate && eventDate < eventDateEnd) {
                                                retValArr.push(Evnt);
                                            }
                                        });
                                    return retValArr;
                                },
                                /**
                                 *
                                 * @param Start_Time - {Date}
                                 * @param interval_length - {number}
                                 * @param EvntObj
                                 * @returns {{EVENT_ID: string, EVENT_END_DATE: string, EVENT_DISP: string, PERFORMED_BY: string}}
                                 */
                                withInTimeSegEvent: function (Start_Time, interval_length, EvntObj) {
                                    var eventDate,
                                        eventDateEnd,
                                        retValObj = {
                                            EVENT_ID: '',
                                            EVENT_END_DATE: '',
                                            EVENT_DISP: '',
                                            PERFORMED_BY: ''
                                        };
                                    eventDate = new Date(EvntObj.EVENT_END_DATE);
                                    eventDateEnd = new Date(Start_Time.getTime() + interval_length);
                                    if (Start_Time < eventDate && eventDate < eventDateEnd) {
                                        arrObjKeys = Object.keys(retValObj);
                                        arrObjKeys.forEach(function (item) {
                                            retValObj[item] = EvntObj[item];
                                        })
                                    }
                                    return retValObj;
                                }
                            }
                        };
                    result.RPTDATA = {};
                    result.RPTDATA.DATAPRESENT = 0;
                    switch (objTypeName) {
                        case "EdDocs":
                            result.RPTDATA.PROGVER = data.RPTDATA.PROGVER;
                            result.RPTDATA.PERSON_ID = data.RPTDATA.PERSON_ID;

                            result.RPTDATA.PULM_CLINIC_NOTES = utils.edDocs.withInTimeSeg(
                                Start_Time,
                                interval_length,
                                data.RPTDATA.PULM_CLINIC_NOTES,
                                data.RPTDATA.PULM_CLINIC_NOTES_CNT
                            );
                            result.RPTDATA.PULM_CLINIC_NOTES_CNT = result.RPTDATA.PULM_CLINIC_NOTES.length;
                            result.RPTDATA.ENDOCRN_CLINIC_NOTES = utils.edDocs.withInTimeSeg(
                                Start_Time,
                                interval_length,
                                data.RPTDATA.ENDOCRN_CLINIC_NOTES,
                                data.RPTDATA.ENDOCRN_CLINIC_NOTES_CNT
                            );
                            result.RPTDATA.ENDOCRN_CLINIC_NOTES_CNT = result.RPTDATA.PULM_CLINIC_NOTES.length;
                            result.RPTDATA.CARDIO_CLINIC_NOTES = utils.edDocs.withInTimeSeg(
                                Start_Time,
                                interval_length,
                                data.RPTDATA.CARDIO_CLINIC_NOTES,
                                data.RPTDATA.CARDIO_CLINIC_NOTES_CNT
                            );
                            result.RPTDATA.CARDIO_CLINIC_NOTES_CNT = result.RPTDATA.PULM_CLINIC_NOTES.length;
                            result.RPTDATA.NEURO_CLINIC_NOTES = utils.edDocs.withInTimeSeg(
                                Start_Time,
                                interval_length,
                                data.RPTDATA.NEURO_CLINIC_NOTES,
                                data.RPTDATA.NEURO_CLINIC_NOTES_CNT
                            );
                            result.RPTDATA.NEURO_CLINIC_NOTES_CNT = result.RPTDATA.PULM_CLINIC_NOTES.length;
                            result.RPTDATA.NEUROSURGERY_CLINIC_NOTES = utils.edDocs.withInTimeSeg(
                                Start_Time,
                                interval_length,
                                data.RPTDATA.NEUROSURGERY_CLINIC_NOTES,
                                data.RPTDATA.NEUROSURGERY_CLINIC_NOTES_CNT
                            );
                            result.RPTDATA.NEUROSURGERY_CLINIC_NOTES_CNT = result.RPTDATA.PULM_CLINIC_NOTES.length;
                            result.RPTDATA.NEPHRO_CLINIC_NOTES = utils.edDocs.withInTimeSeg(
                                Start_Time,
                                interval_length,
                                data.RPTDATA.NEPHRO_CLINIC_NOTES,
                                data.RPTDATA.NEPHRO_CLINIC_NOTES_CNT
                            );
                            result.RPTDATA.NEPHRO_CLINIC_NOTES_CNT = result.RPTDATA.PULM_CLINIC_NOTES.length;
                            result.RPTDATA.CONSULTATION_REFERRALS = utils.edDocs.withInTimeSeg(
                                Start_Time,
                                interval_length,
                                data.RPTDATA.CONSULTATION_REFERRALS,
                                data.RPTDATA.CONSULTATION_REFERRALS_CNT
                            );
                            result.RPTDATA.CONSULTATION_REFERRALS_CNT = result.RPTDATA.PULM_CLINIC_NOTES.length;
                            result.RPTDATA.HP_NOTE = utils.edDocs.withInTimeSegEvent(
                                Start_Time,
                                interval_length,
                                data.RPTDATA.HP_NOTE);
                            result.RPTDATA.PREOP_HP_NOTE = utils.edDocs.withInTimeSegEvent(
                                Start_Time,
                                interval_length,
                                data.RPTDATA.PREOP_HP_NOTE);
                            result.RPTDATA.IP_DAILY_PROGRESS_NOTE = utils.edDocs.withInTimeSegEvent(
                                Start_Time,
                                interval_length,
                                data.RPTDATA.IP_DAILY_PROGRESS_NOTE);
                            result.RPTDATA.PERI_OPERATIVE_RECORD = utils.edDocs.withInTimeSegEvent(
                                Start_Time,
                                interval_length,
                                data.RPTDATA.PERI_OPERATIVE_RECORD);
                            result.RPTDATA.ED_PROVIDER_NOTE = utils.edDocs.withInTimeSegEvent(
                                Start_Time,
                                interval_length,
                                data.RPTDATA.ED_PROVIDER_NOTE);
                            break;
                        case "Micros":
                            result.RPTDATA.ENCNTR_ID = data.RPTDATA.ENCNTR_ID;
                            result.RPTDATA.PERSON_ID = data.RPTDATA.PERSON_ID;
                            result.RPTDATA.REG_DT_TM = data.RPTDATA.REG_DT_TM;
                            result.RPTDATA.MICRO = [];
                            data.RPTDATA.MICRO.forEach(
                                function (microItems) {
                                    var micros = {
                                        POS: [],
                                        POS_CNT: 0,
                                        POS_SORTED: [],
                                        NEG: [],
                                        NEG_CNT: 0,
                                        NEG_SORTED: [],
                                        PENDING: [],
                                        PENDING_CNT: 0,
                                        PENDING_SORTED: []
                                    };
                                    microItems.NEG.forEach(
                                        function (itemNeg) {
                                            var selectedNeg,
                                                eventDate = new Date(appEDH.gFuncs.convertDate(itemNeg.DRAWN_DT_TM)),
                                                eventDateEnd = new Date(Start_Time.getTime() + interval_length);
                                            if (Start_Time < eventDate && eventDate < eventDateEnd) {
                                                micros.NEG_CNT++;
                                                micros.NEG_SORTED.push({UNSORTED_IDX: micros.NEG_CNT});
                                                selectedNeg = $.extend(true, {}, itemNeg);
                                                micros.NEG.push(selectedNeg);
                                                result.RPTDATA.DATAPRESENT = 1;
                                            }
                                        });
                                    microItems.PENDING.forEach(
                                        function (itemPend) {
                                            var selectedPending,
                                                eventDate = new Date(appEDH.gFuncs.convertDate(itemPend.DRAWN_DT_TM)),
                                                eventDateEnd = new Date(Start_Time.getTime() + interval_length);
                                            if (Start_Time < eventDate && eventDate < eventDateEnd) {
                                                micros.PENDING_CNT++;
                                                micros.PENDING_SORTED.push({UNSORTED_IDX: micros.PENDING_CNT});
                                                selectedPending = $.extend(true, {}, itemPend);
                                                micros.PENDING.push(selectedPending);
                                                result.RPTDATA.DATAPRESENT = 1;
                                            }
                                        });
                                    microItems.POS.forEach(
                                        function (itemPOS) {
                                            var selectedPOS,
                                                eventDate = new Date(appEDH.gFuncs.convertDate(itemPOS.DRAWN_DT_TM)),
                                                eventDateEnd = new Date(Start_Time.getTime() + interval_length);
                                            if (Start_Time < eventDate && eventDate < eventDateEnd) {
                                                micros.POS_CNT++;
                                                micros.POS_SORTED.push({
                                                    UNSORTED_IDX: micros.POS_CNT
                                                });
                                                selectedPOS = $.extend(true, {}, itemPOS);
                                                micros.POS.push(selectedPOS);
                                                result.RPTDATA.DATAPRESENT = 1;
                                            }
                                        });
                                    result.RPTDATA.MICRO.push(micros);
                                }
                            );
                            break;
                        case "Labs":
                            result.RPTDATA.ENCNTR_ID = data.RPTDATA.ENCNTR_ID;
                            result.RPTDATA.PERSON_ID = data.RPTDATA.PERSON_ID;
                            result.RPTDATA.PROGVER_CHLA = data.RPTDATA.PROGVER_CHLA;
                            result.RPTDATA.LABS = [];
                            data.RPTDATA.LABS.forEach(
                                function (item) {
                                    var labs = {
                                        CHEM_PANEL_SORTED: [],
                                        CHEM_PANEL_CNT: 0,
                                        CBC_SORTED: [],
                                        CBC_CNT: 0,
                                        OTHER_SORTED: [],
                                        OTHER_CNT: 0,
                                        LAB: [],
                                        LAB_CNT: 0
                                    };
                                    item.LAB.forEach(
                                        function (labType) {
                                            var selectedLab,
                                                eventDate = new Date(appEDH.gFuncs.convertDate(labType.EVENT_END_DT_TM)),
                                                eventDateEnd = new Date(Start_Time.getTime() + interval_length);
                                            if (Start_Time < eventDate && eventDate < eventDateEnd) {
                                                labs.LAB_CNT++;
                                                selectedLab = $.extend(true, {}, labType);
                                                result.RPTDATA.DATAPRESENT = 1;
                                                if (selectedLab.TYPE_FLAG == 0) {
                                                    labs.OTHER_CNT++;
                                                    labs.OTHER_SORTED.push({
                                                        UNSORTED_IDX: labs.LAB_CNT
                                                    });
                                                } else if (selectedLab.TYPE_FLAG == 1) {
                                                    labs.CHEM_PANEL_CNT++;
                                                    labs.CHEM_PANEL_SORTED.push({
                                                        UNSORTED_IDX: labs.LAB_CNT
                                                    });
                                                } else if (selectedLab.TYPE_FLAG == 2) {
                                                    labs.CBC_CNT++;
                                                    labs.CBC_SORTED.push({
                                                        UNSORTED_IDX: labs.LAB_CNT
                                                    });
                                                }
                                                labs.LAB.push(selectedLab);
                                            }
                                        });
                                    result.RPTDATA.LABS.push(labs);
                                });
                            break;
                        case "LabOrders":
                            result.RPTDATA.ENCNTR_ID = data.RPTDATA.ENCNTR_ID;
                            result.RPTDATA.PERSON_ID = data.RPTDATA.PERSON_ID;
                            result.RPTDATA.PROGVER_CHLA = data.RPTDATA.PROGVER_CHLA;
                            result.RPTDATA.ORDERS = [];
                            result.RPTDATA.ORDERS_CNT = 0;
                            data.RPTDATA.ORDERS.forEach(
                                function (labOrder) {
                                    var selectedOrder,
                                        eventDate = new Date(appEDH.gFuncs.convertDate(labOrder.ORIG_ORDER_DT_TM)),
                                        eventDateEnd = new Date(Start_Time.getTime() + interval_length);
                                    if (Start_Time < eventDate && eventDate < eventDateEnd) {
                                        result.RPTDATA.ORDERS_CNT++;
                                        selectedOrder = $.extend(true, {}, labOrder);
                                        result.RPTDATA.ORDERS.push(selectedOrder);
                                        result.RPTDATA.DATAPRESENT = 1;
                                    }
                                })
                            break;
                        case "Meds":
                            result.RPTDATA.ENCNTR_ID = data.RPTDATA.ENCNTR_ID;
                            result.RPTDATA.PERSON_ID = data.RPTDATA.PERSON_ID;
                            result.RPTDATA.REG_DT_TM = data.RPTDATA.REG_DT_TM;
                            result.RPTDATA.IP_MED = [];
                            med_cd = 10577.000;
                            data.RPTDATA.IP_MED.forEach(
                                function (ipMeds) {
                                    var meds = {
                                        CNT: 0,
                                        DRIP_CNT: 0,
                                        PRN_CNT: 0,
                                        SCHED_CNT: 0,
                                        QUAL: []
                                    };
                                    ipMeds.QUAL.forEach(
                                        function (itemMed) {
                                            var selectedMed,
                                                eventDate = new Date(appEDH.gFuncs.convertDate(itemMed.CURRENT_START_DT_TM)),
                                                eventDateEnd = new Date(Start_Time.getTime() + interval_length);
                                            if (Start_Time < eventDate && eventDate < eventDateEnd) {
                                                meds.CNT++;
                                                selectedMed = $.extend(true, {}, itemMed);
                                                if (itemMed.DCP_CLIN_CAT_CD !== med_cd) {
                                                    meds.DRIP_CNT++;
                                                } else if (itemMed.DCP_CLIN_CAT_CD == med_cd && itemMed.PRN_IND == 1) {
                                                    meds.PRN_CNT++;
                                                } else if (itemMed.DCP_CLIN_CAT_CD == med_cd && itemMed.PRN_IND == 0) {
                                                    meds.SCHED_CNT++;
                                                }
                                                meds.QUAL.push(selectedMed);
                                                result.RPTDATA.DATAPRESENT = 1;
                                            }
                                        });
                                    result.RPTDATA.IP_MED.push(meds);
                                });
                            break;
                        case "Radiology":
                            result.RPTDATA.ENCNTR_ID = data.RPTDATA.ENCNTR_ID;
                            result.RPTDATA.PERSON_ID = data.RPTDATA.PERSON_ID;
                            result.RPTDATA.REG_DT_TM = data.RPTDATA.REG_DT_TM;
                            result.RPTDATA.EVENTS = [];
                            eventDateEnd = new Date(Start_Time.getTime() + interval_length);
                            data.RPTDATA.EVENTS.forEach(
                                /**
                                 *
                                 */
                                function (itemRad) {
                                    var selectRad;
                                    eventDate = new Date(itemRad.EVENT_DATE);
                                    if (Start_Time < eventDate && eventDate < eventDateEnd) {
                                        selectRad = $.extend(true, {}, itemRad);
                                        result.RPTDATA.EVENTS.push(selectRad);
                                        result.RPTDATA.DATAPRESENT = 1;
                                    }
                                }
                            );
                            break;
                        case "VitalSigns":
                            VSdata = {
                                ENCNTR_ID: '',
                                PERSON_ID: '',
                                PROGVER_CHLA: '',
                                ART_BP_CURRENT_DIASTOLIC: '',
                                ART_BP_CURRENT_SYSTOLIC: '',
                                ART_BP_DIASTOLIC_IDX: '',
                                ART_BP_HIGH_DIASTOLIC: '',
                                ART_BP_HIGH_EVENT_END_DT_TM: '',
                                ART_BP_HIGH_SYSTOLIC: '',
                                ART_BP_LOW_DIASTOLIC: '',
                                ART_BP_LOW_EVENT_END_DT_TM: '',
                                ART_BP_LOW_SYSTOLIC: '',
                                ART_BP_SYSTOLIC_IDX: '',
                                ART_DIASTOLIC_IDX: '',
                                ART_SYSTOLIC_IDX: '',
                                BP_CURRENT_DIASTOLIC: '',
                                BP_CURRENT_SYSTOLIC: '',
                                BP_DIASTOLIC_IDX: '',
                                BP_HIGH_DIASTOLIC: '',
                                BP_HIGH_EVENT_END_DT_TM: '',
                                BP_HIGH_SYSTOLIC: '',
                                BP_LOW_DIASTOLIC: '',
                                BP_LOW_EVENT_END_DT_TM: '',
                                BP_LOW_SYSTOLIC: '',
                                BP_SYSTOLIC_IDX: '',
                                DIASTOLIC_IDX: '',
                                SYSTOLIC_IDX: ''
                            };
                            arrObjKeys = Object.keys(VSdata);
                            arrObjKeys.forEach(
                                function (item) {
                                    result.RPTDATA[item] = data.RPTDATA[item];
                                });
                            result.RPTDATA.VITALS = [];
                            result.RPTDATA.VITALS_CNT = 0;
                            data.RPTDATA.VITALS.forEach(
                                function (itemVs) {
                                    var selectedVs,
                                        eventDate = new Date(itemVs.DT_TM),
                                        eventDateEnd = new Date(Start_Time.getTime() + interval_length);
                                    if (Start_Time < eventDate && eventDate < eventDateEnd) {
                                        selectedVs = $.extend(true, {}, itemVs);
                                        result.RPTDATA.VITALS.push(selectedVs);
                                        result.RPTDATA.DATAPRESENT = 1;
                                    }
                                })
                            break;
                        case "BloodGas":
                            result.RPTDATA.ENCNTR_ID = data.RPTDATA.ENCNTR_ID;
                            result.RPTDATA.PERSON_ID = data.RPTDATA.PERSON_ID;
                            result.RPTDATA.REG_DT_TM = data.RPTDATA.REG_DT_TM;
                            result.RPTDATA.PROGVER_CHLA = data.RPTDATA.PROGVER_CHLA;
                            result.RPTDATA.ABG_RESULTS = [];
                            result.RPTDATA.ABG_RESULT_CNT = 0;
                            data.RPTDATA.ABG_RESULTS.forEach(
                                function (itemAbg) {
                                    var selectedAbg,
                                        eventDate = new Date(itemAbg.EVENT_DATE),
                                        eventDateEnd = new Date(Start_Time.getTime() + interval_length);
                                    if (eventDate > Start_Time && eventDate < eventDateEnd) {
                                        result.RPTDATA.ABG_RESULT_CNT++;
                                        selectedAbg = $.extend(true, {}, itemAbg);
                                        result.RPTDATA.ABG_RESULTS.push(selectedAbg);
                                        result.RPTDATA.DATAPRESENT = 1;
                                    }
                                });
                            result.RPTDATA.CBG_RESULTS = [];
                            result.RPTDATA.CBG_RESULT_CNT = 0;
                            data.RPTDATA.CBG_RESULTS.forEach(
                                function (itemCbg) {
                                    var selectedCbg,
                                        eventDate = new Date(itemCbg.EVENT_DATE),
                                        eventDateEnd = new Date(Start_Time.getTime() + interval_length);
                                    if (eventDate > Start_Time && eventDate < eventDateEnd) {
                                        result.RPTDATA.CBG_RESULT_CNT++;
                                        selectedCbg = $.extend(true, {}, itemCbg);
                                        result.RPTDATA.CBG_RESULTS.push(selectedCbg);
                                        result.RPTDATA.DATAPRESENT = 1;
                                    }
                                });
                            result.RPTDATA.VBG_RESULTS = [];
                            result.RPTDATA.VBG_RESULT_CNT = 0;
                            data.RPTDATA.VBG_RESULTS.forEach(
                                function (itemVbg) {
                                    var selectedVb,
                                        eventDate = new Date(itemVbg.EVENT_DATE),
                                        eventDateEnd = new Date(Start_Time.getTime() + interval_length);
                                    if (eventDate > Start_Time && eventDate < eventDateEnd) {
                                        result.RPTDATA.VBG_RESULT_CNT++;
                                        selectedVb = $.extend(true, {}, itemVbg);
                                        result.RPTDATA.VBG_RESULTS.push(selectedVb);
                                        result.RPTDATA.DATAPRESENT = 1;
                                    }
                                });
                            break;
                        default:
                            return data;
                            break;
                    }
                    return result;
                }
            },
//::============================================================================================
//::   METHODS - DATA.MAIN
//::============================================================================================
            InitBaseObj: function (aCCobjLst, aBaseObj) {
                var arrWrk = [],
                    vCCbaseObj,
                    vCompEapps,
                    vCCLoadFlag;
                vCompEapps = aBaseObj.thisCompEapps;
                if (aCCobjLst.processType == "Orders") {
                    vCCbaseObj = vCompEapps.Orders_CC[aCCobjLst.objTypeName];
                } else if (aCCobjLst.processType == "Results") {
                    vCCbaseObj = vCompEapps.Results_CC[aCCobjLst.objTypeName];
                } else if (aCCobjLst.processType == "Notes") {
                    vCCbaseObj = vCompEapps[aCCobjLst.objTypeName];
                } else if (aCCobjLst.processType == "FuncTimr") {
                    vCCbaseObj = vCompEapps[aCCobjLst.objTypeName];
                } else {
                    vCCbaseObj = null;
                    arrWrk.length = 0;
                    arrWrk.push('InitBaseObj ');
                    arrWrk.push(vCCbaseObj.objTypeName);
                    arrWrk.push(' - ProcessType not defined: ');
                    arrWrk.push(vCCbaseObj.processType);
                    aBaseObj.Logger.LogError(arrWrk.join(''));
                }
                if (vCCbaseObj != null) {
                    vCCbaseObj.initState = true;
                    vCCbaseObj.CCLrequest = aBaseObj.gCCLRequestCls.neo();
                    arrWrk.length = 0;
                    arrWrk.push('OBJ_');
                    arrWrk.push(aBaseObj.thisComp.name);
                    arrWrk.push('.baseObj.');
                    arrWrk.push(vCCbaseObj.cc_id);
                    arrWrk.push('.eApps.CCLrequest');
                    vCCbaseObj.CCLrequest.ObjectName = arrWrk.join('');
                    vCCLoadFlag = true;
                    arrWrk.length = 0;
                    if (vCCbaseObj.processType == 'Orders') {
                        vCompEapps.OrdersReady.push(vCCbaseObj.objTypeName);
                        vCCbaseObj.CCLrequest.CallBackOperation = function (respData, CCparent) {
                            var dataObj     = {RPTDATA: {}},
                                appObj      = chla.eApps.EDH.baseObj;
                            dataObj.RPTDATA = respData;
                            aBaseObj.Logger.LogInfo('InitBaseObj OrdersReady.pop ');
                            CCparent.data   = dataObj;
                            vCompEapps.OrdersReady.pop();
                        };
                    } else if (vCCbaseObj.processType == 'Results') {
                        vCompEapps.ResultsReady.push(vCCbaseObj.objTypeName);
                        vCCbaseObj.CCLrequest.CallBackOperation = function (respData, CCparent) {
                            var dataObj     = {RPTDATA: {}},
                                appObj      = chla.eApps.EDH.baseObj;
                            dataObj.RPTDATA = respData;
                            aBaseObj.Logger.LogInfo('InitBaseObj ResultsReady.pop ');
                            CCparent.data   = dataObj;
                            vCompEapps.ResultsReady.pop();
                        };
                    } else if (vCCbaseObj.processType == 'Notes') {
                        vCCbaseObj.CCLrequest.CallBackOperation = function (respData, CCparent) {
                            var dataObj     = {RPTDATA: {}},
                                appObj      = chla.eApps.EDH.baseObj;
                            dataObj.RPTDATA = respData;
                            aBaseObj.Logger.LogInfo('InitBaseObj Notes ');
                            CCparent.data   = dataObj;
                        };
                    } else if (vCCbaseObj.processType == 'FuncTimr') {
                        vCCbaseObj.CCLrequest.CallBackOperation = function (respData, CCparent) {
                            var dataObj     = {RPTDATA: {}},
                                appObj      = chla.eApps.EDH.baseObj;
                            dataObj.RPTDATA = respData;
                            aBaseObj.Logger.LogInfo('InitBaseObj FuncTimr ');
                            CCparent.data   = dataObj;
                        };
                    } else {
                        arrWrk.length = 0;
                        arrWrk.push('InitBaseObj ');
                        arrWrk.push(vCCbaseObj.cc_id);
                        arrWrk.push(' ');
                        arrWrk.push(vCCbaseObj.objTypeName);
                        arrWrk.push(' - ProcessType not defined: ');
                        arrWrk.push(vCCbaseObj.processType);
                        aBaseObj.Logger.LogError(arrWrk.join(''));
                        vCCLoadFlag = false;
                    }
                    if (vCCLoadFlag) {
                        vCCbaseObj.RptParms[0] = '^MINE^';
                        vCCbaseObj.CCLrequest.DataTransfer1(
                            vCCbaseObj.CCLrequest,
                            vCCbaseObj.CCLname,
                            vCCbaseObj.RptParms.join(),
                            vCompEapps._BaseObjs[vCCbaseObj.id]);
                    }
                }
            },
            processRPTDATA_main_data: function (dataObj, baseObj) {
                var appNS = baseObj.getCcNS(),
                    vPrp = baseObj.Prop,
                    vSubSecData = baseObj.UI.sSecData,
                    wrkdttm;
                vPrp.mainSection = '';
                vPrp.Enctr.E_ENCNTR_TYPE = (typeof dataObj.E_ENCNTR_TYPE !== 'undefined' ? dataObj.E_ENCNTR_TYPE : '');
                vPrp.Enctr.E_ADMIT_TYPE = (typeof dataObj.E_ADMIT_TYPE !== 'undefined' ? dataObj.E_ADMIT_TYPE : '');
                vPrp.Enctr.REG_DT_TM_DISP = dataObj.REG_DT_TM_DISP;
                vPrp.Enctr.DISCH_DT_TM_DISP = dataObj.DISCH_DT_TM_DISP;
                vPrp.Enctr.BEG_DT_TM_DISP = dataObj.BEG_DT_TM_DISP;
                vPrp.Enctr.END_DTTM = new Date();
                vPrp.Enctr.DISCH_DT = 0;
                vPrp.Enctr.END_DTTM = 0;
                if (vPrp.Enctr.DISCH_DT_TM_DISP != '') {
                    vPrp.Enctr.DISCH_DT = new Date(dataObj.DISCH_DT_TM_DISP);
                    vPrp.Enctr.END_DTTM = vPrp.Enctr.DISCH_DT;
                }
                vPrp.Enctr.Reg_DT = 0;
                if (vPrp.Enctr.REG_DT_TM_DISP !== '') {
                    vPrp.Enctr.Reg_DT = new Date(vPrp.Enctr.REG_DT_TM_DISP);
                }
                vPrp.Enctr.Beg_DT = 0;
                if (vPrp.Enctr.BEG_DT_TM_DISP !== '') {
                    vPrp.Enctr.Beg_DT = new Date(vPrp.Enctr.BEG_DT_TM_DISP);
                }
                vPrp.Enctr.DIFF_BEG_DT_REG_DT = appNS.gFuncs.dateDiff(vPrp.Enctr.Beg_DT, vPrp.Enctr.Reg_DT, 'minutes');
                vPrp.Enctr.START_DTTM = vPrp.Enctr.Beg_DT;
                if (vPrp.Enctr.DISCH_DT === 0 & vPrp.Enctr.E_ENCNTR_TYPE !== 'Emergency') {
                    vPrp.Enctr.END_DTTM = vPrp.Enctr.Reg_DT;
                }
                wrkdttm = vPrp.Enctr.START_DTTM;
                vSubSecData.startdate = appNS.DteUtl.calcDate(wrkdttm);
                vSubSecData.starttime = appNS.DteUtl.calcTime(wrkdttm);
                vSubSecData.lblStartdate = vSubSecData.startdate;
                vSubSecData.lblStarttime = vSubSecData.starttime;
                if (vPrp.Enctr.E_ENCNTR_TYPE === 'Emergency' && vPrp.Enctr.END_DTTM === 0) {
                    vSubSecData.lblEnddate = '--/--/----';
                    vSubSecData.lblEndtime = '--:--';
                } else {
                    wrkdttm = vPrp.Enctr.END_DTTM;
                    vSubSecData.lblEnddate = appNS.DteUtl.calcDate(wrkdttm);
                    vSubSecData.lblEndtime = appNS.DteUtl.calcTime(wrkdttm);
                }
            },
            processCcInstance: function (baseObj) {
                var compContent,
                    SizeProfile,
                    mainDivTpl,
                    arrWrk      = [],
                    initScrn,
                    fontBase    = '12px';
                SizeProfile = baseObj.gFuncs.getResolutionProfile();
                if (SizeProfile == 'RLESS1279') {
                    fontBase = '10px';
                }
                initScrn    = baseObj.Prop.CC_Tmpls.initialScreen.join('');
                mainDivTpl  = baseObj.Prop.CC_Tmpls.mainDiv.join('');
                arrWrk.push(' style="font-size: ');
                arrWrk.push(fontBase);
                arrWrk.push('; min-width:1280px;"');
                compContent = baseObj.gFuncs.parseTemplate(mainDivTpl, {
                    StyleOverRd:    arrWrk.join(''),
                    cc_id:          baseObj.Prop.cc_id,
                    Loadscrn:       initScrn
                });
                baseObj.gFuncs.Log_CC(baseObj.thisComp, compContent);
                baseObj.target.innerHTML = compContent;
            },
            ldBaseObjs: function (ccList, baseObj) {
                var appNS = baseObj.getCcNS();
                appNS.comp_eApps._BaseObjs = [];
                ccList.forEach(
                    /**
                     *
                     * @param lstItem
                     * @param index
                     */
                    function (lstItem, index) {
                        var custComp,
                            vCompEapps = appNS.comp_eApps,
                            wrkArr = [],
                            CC_DefObj;
                        custComp = baseObj.Dta.initMpageComponent(baseObj, lstItem.nsp, lstItem.data, lstItem.lbl, '');
                        custComp.name = custComp.name + 'ED';
                        vCompEapps._BaseObjs.push(custComp);
                        CC_DefObj = appNS.DtaUtl.CC_DefCls.neo();
                        CC_DefObj.objTypeName = lstItem.objTypeName;
                        CC_DefObj.processType = lstItem.processType;
                        CC_DefObj.cc_id = lstItem.nsp;
                        CC_DefObj.id = index;
                        CC_DefObj.titleheader = lstItem.lbl;
                        CC_DefObj.CCLname = (lstItem.cclProgram !== '' ? lstItem.cclProgram : custComp.cclProgram);
                        CC_DefObj.RptParms = custComp.cclParams;
                        if (CC_DefObj.processType == "Orders") {
                            vCompEapps.Orders_CC[CC_DefObj.objTypeName] = CC_DefObj;
                        } else if (CC_DefObj.processType == "Results") {
                            vCompEapps.Results_CC[CC_DefObj.objTypeName] = CC_DefObj;
                        } else if (CC_DefObj.processType == "Notes") {
                            vCompEapps[CC_DefObj.objTypeName] = CC_DefObj;
                        } else if (CC_DefObj.processType == "FuncTimr") {
                            vCompEapps[CC_DefObj.objTypeName] = CC_DefObj;
                        } else {
                            wrkArr.push('ldBaseObjs ');
                            wrkArr.push(CC_DefObj.cc_id);
                            wrkArr.push(' ');
                            wrkArr.push(CC_DefObj.objTypeName);
                            wrkArr.push(' - ProcessType not defined: ');
                            wrkArr.push(CC_DefObj.processType);
                            appNS.Log.LogError(wrkArr.join(''));
                        }
                    })
            },
            initMpageComponent: function (baseObj, nsp, dataValue, HeaderTitle, secId) {
                var custComp = null,
                    arrWrk = [];
                arrWrk.push("custComp = new ");
                arrWrk.push(nsp);
                arrWrk.push("();");
                eval(arrWrk.join(''));
                custComp.options = null;
                custComp.data = dataValue;
                arrWrk.length = 0;
                arrWrk.push('CC_');
                arrWrk.push(nsp.replace('chla.', ''));
                arrWrk.push(secId);
                custComp.setOption("id", arrWrk.join(''));
                custComp.setProperty("mine", "mine");
                custComp.setProperty("personId", baseObj.thisComp.getProperty('personId'));
                custComp.setProperty("userId", baseObj.thisComp.getProperty('userId'));
                custComp.setProperty("encounterId", baseObj.thisComp.getProperty('encounterId'));
                custComp.setProperty("pprCd", baseObj.thisComp.getProperty('pprCd'));
                custComp.setProperty("PPRCode", baseObj.thisComp.getProperty('PPRCode'));
                custComp.setProperty("staticContent", baseObj.thisComp.getProperty('staticContent'));
                custComp.setProperty("compSourceLocation", baseObj.thisComp.getProperty('compSourceLocation'));
                custComp.setProperty("positionCd", baseObj.thisComp.getProperty('positionCd'));
                custComp.setProperty("categoryMean", baseObj.thisComp.getProperty('categoryMean'));
                custComp.setProperty("person_info", baseObj.thisComp.getProperty('person_info'));
                custComp.setProperty("codes", baseObj.thisComp.getProperty('codes'));
                custComp.init();
                return custComp;
            },
            setPropertyMpageComponent: function (baseObj, nsp, dataValue, secId,custComp) {
                var arrWrk = [];
                custComp.options = null;
                custComp.data = dataValue;
                arrWrk.length = 0;
                arrWrk.push('CC_');
                arrWrk.push(nsp.replace('chla.', ''));
                arrWrk.push(secId);
                custComp.setOption("id", arrWrk.join(''));
                custComp.setProperty("mine", "mine");
                custComp.setProperty("personId", baseObj.thisComp.getProperty('personId'));
                custComp.setProperty("userId", baseObj.thisComp.getProperty('userId'));
                custComp.setProperty("encounterId", baseObj.thisComp.getProperty('encounterId'));
                custComp.setProperty("pprCd", baseObj.thisComp.getProperty('pprCd'));
                custComp.setProperty("PPRCode", baseObj.thisComp.getProperty('PPRCode'));
                custComp.setProperty("staticContent", baseObj.thisComp.getProperty('staticContent'));
                custComp.setProperty("compSourceLocation", baseObj.thisComp.getProperty('compSourceLocation'));
                custComp.setProperty("positionCd", baseObj.thisComp.getProperty('positionCd'));
                custComp.setProperty("categoryMean", baseObj.thisComp.getProperty('categoryMean'));
                custComp.setProperty("person_info", baseObj.thisComp.getProperty('person_info'));
                custComp.setProperty("codes", baseObj.thisComp.getProperty('codes'));
            }
        },
//::============================================================================================
//::   METHODS - UI.UTILITIES
//::============================================================================================
        UI: {
            util: {
                injectStyles: function (rule) {
                    var div = $("<div />", {html: '&shy;<style>' + rule + '</style>'}).appendTo("body");
                },
                calcTimesectHeight: function (baseObj) {
                    //=========================================================================================
                    // calculate section height for navigation
                    //=========================================================================================
                    var thisNS = baseObj.getCcNS(),
                        i,
                        totalCnt,
                        ssHeight,
                        totalOffset,
                        vMgr,
                        edFlwVwDummy,
                        containerHeight;
                    totalOffset = 0;
                    vMgr = thisNS.comp_eApps.EdhLayOutMgr;
                    containerHeight = thisNS.comp_eApps.CCcontainerHeight;
                    for (i = 0 , totalCnt = thisNS.comp_eApps.TimeSectionCnt; i < totalCnt; i++) {
                        thisNS.UI.sSecData.ssContainerHeight.push(totalOffset);
                        ssHeight = $('#' + thisNS.Prp.cc_lbl + '_' + i).height();
                        totalOffset += ssHeight;
                        vMgr.sSecData.ssec.push(thisNS.UI.sSecData.ssec[i]);
                        vMgr.sSecData.ssecNav.push(thisNS.UI.sSecData.ssecNav[i]);
                    }
                    if (thisNS.comp_eApps.TimeSectionCnt > 0) {
                        if (ssHeight < containerHeight) {
                            edFlwVwDummy = $("<div></div>");
                            edFlwVwDummy.append('&nbsp;');
                            edFlwVwDummy.height(containerHeight - ssHeight);
                            $('#edFlwVw').append(edFlwVwDummy);
                            totalOffset += (containerHeight - ssHeight);
                        }
                    }
                    vMgr.totalOffset = totalOffset;
                    vMgr.ContainerHeightBase = containerHeight;
                    vMgr.sSecData.ContainerHeight = containerHeight;
                    vMgr.sSecData.ssContainerHeight = thisNS.UI.sSecData.ssContainerHeight;
                },
                GenSec_DTO: function (baseObj, secName, cc_name, titleHdr) {
                    var appNS = baseObj.getCcNS(),
                        sectionData,
                        SectionObjCCcontainer,
                        secValues,
                        HdrLayoutTemplate = [
                            '<span class="',
                            '<#=hd_tglCls#> hxb-marker ',
                            '<#=SectionClosed#>" style="',
                            '<#=hd_tglStyle#> ',
                            '<#=CustIcon#> ',
                            '<#=CustMargin#>">&nbsp;',
                            '</span>',
                            /*'<span class="',
                             '<#=hd_tglCls#> hxb-marker ',
                             '<#=SectionClosed#>" style="',
                             '<#=hd_tglStyle#> ',
                             '<#=CustIcon#>" title="icon toggle open">&nbsp;',
                             '</span>',*/
                            '<span class="',
                            '<#=titleCls#> ',
                            '<#=Disabled_Lbl#> " style="',
                            '<#=titleStyle#>">',
                            ' <#=titleVal#><#=SectionCnt#>',
                            '</span>'
                        ];
                    SectionObjCCcontainer = baseObj.gSectionHeaderCtlCls.neo();
                    sectionData = appNS.Glbls.CC_SectMgt[secName];
                    secValues = {
                        idLabel: cc_name,
                        TLabel1: titleHdr,
                        SectionCnt: 'auto',
                        SectionID: '',
                        SectionDivID: '',
                        SectionCntVal: sectionData.Count,
                        SectionClosed: sectionData.SectionClosed,
                        Disabled_Lbl: 'auto',
                        CustIcon: 'auto',
                        CustMargin: '',//'margin-left:15px;',
                        HideIfEmpty: 'false',
                        ContentBody: '',
                        UnformatBodyVal: '',
                        HdrCss: 'section',
                        SectionTheme: '',
                        HdrH2Css: 'sec-hd',
                        fo_cat_type: '',
                        OvrrdHdrCss: '',
                        OvrrdHdrStyle: '',
                        hovertip: '',
                        HdrLayout: '',
                        DivSubSecContentCss: 'sec-content',
                        SubSecContentStyle: ' style="background-image: none;" ',
                        OvrrdContentBodyCss: '',
                        defaultHeightHdr: '',
                        defaultHeightFtr: '',
                        TemplateType: sectionData.TemplateType,
                        div1_idLabel: cc_name + '_DivSection',
                        div2_idLabel: cc_name + '_DivSubSecContent',
                        div3_idLabel: cc_name,
                        hd_tglCls: 'sec-hd-tgl',
                        hd_tglStyle: 'background-image: none;',
                        titleCls: 'sec-title',
                        titleStyle: 'background-image: none;',
                        titleVal: titleHdr
                    };
                    secValues.HdrLayout = appNS.gFuncs.parseTemplate(HdrLayoutTemplate.join(''), {
                        hd_tglCls: secValues.hd_tglCls,
                        SectionClosed: '',
                        CustMargin: '',//'margin-left:15px;',
                        hd_tglStyle: 'background-image: none;',
                        CustIcon: '',
                        titleCls: secValues.titleCls,
                        Disabled_Lbl: '',
                        titleStyle: secValues.titleStyle,
                        titleVal: secValues.titleVal,
                        SectionCnt: ''
                    });
                    SectionObjCCcontainer.initValues(secValues);
                    return SectionObjCCcontainer;
                },
                ssecDataCls: ChlaStdClass.extend(function () {
                    this.startdate = '';
                    this.starttime = '';
                    this.ssContainerNum = 1;
                    this.ssContainerHeight = [];
                    this.ssecNav = [];
                    this.ssec = [];
                }),
                TimeSectionCls: ChlaStdClass.extend(function (section_ID, baseObj) {
                    var thisNS = baseObj.getCcNS();
                    this.Start_Time = null;
                    this.interval_length = thisNS.comp_eApps.interval_length;
                    this._section_ID = section_ID;
                    this.dataPresent = 0;
                    this.wrkSSec = thisNS.UiUtl.SsecCLs.neo(section_ID);
                    this.wkSSecNav = thisNS.UiUtl.SsecNavCls.neo(section_ID);
                    this._BaseObjs = [];
                    this.Orders_CC = {};
                    this.Results_CC = {};
                    this.NotesSummary = '';
                    this.EDSurvey = '';
                }),
                SsecNavCls: ChlaStdClass.extend(function (ssContainerNum) {
                    this.ssContainerId = ("EDH_ssContainer_" + ssContainerNum);
                    this.navId = "EDH_ssNav_1";
                    this.navNum = 0;
                    this.navLbl = '00:00';
                    this.secColor = '';
                }),
                SsecCLs: ChlaStdClass.extend(function (ssContainerNum) {
                    this.secId = 0;
                    this.secNum = ssContainerNum;
                    this.VitalsData = '';
                    this.OrdersData = '';
                    this.ResultsData = '';
                    this.secHdrPartB = '';
                    this.ssBodyId = ("EDH_" + ssContainerNum);
                    this.assocViewId = ("EDH_ssBody_" + ssContainerNum);
                    this.ElapseTMlbl = 'ELAPSED TIME: 00:00 Minutes (00h:00m)</span> - Since Admission';
                    this.secColor = '';
                    this.EDHtbl2Display = '';
                })
//::============================================================================================
//::   METHODS - UI.BEHAVIOURS
//::============================================================================================
            },
            behaviors: {
                wfscroll: function (offsetnum, updateonly) {
                    var thisNS = chla.eApps.EDH.baseObj.getCcNS(),
                        cHeight,
                        wrkdttm,
                        _30minutes,
                        arrWrk = [],
                        vMgr;
                    cHeight = thisNS.UI.sSecData.ssContainerHeight[offsetnum];
                    wrkdttm = new Date(thisNS.Prp.Enctr.START_DTTM.getTime());
                    vMgr = thisNS.comp_eApps.EdhLayOutMgr;
                    _30minutes = offsetnum * thisNS.comp_eApps.interval_length;
                    wrkdttm.setMinutes(wrkdttm.getMinutes() + _30minutes);
                    if (typeof updateonly == 'undefined') {
                        $('#EDH-content-body').scrollTop(cHeight);
                    }
                    $('#EDH-content-nav').find("span.navi-subsec-select").removeClass('navi-subsec-select');
                    arrWrk.push('#EDH_ssNav_');
                    arrWrk.push(offsetnum);
                    $(arrWrk.join('')).find('span.wrkflw-selectOption').addClass("navi-subsec-select");
                    vMgr.baseOffset = cHeight;
                    vMgr.secIdx = offsetnum;
                },
                scrolling: function () {
                    var thisNS = chla.eApps.EDH.baseObj.getCcNS(),
                        vMgr,
                        edFlwNaTl = $('#edFlwNavTL'),
                        EDH_content_body = $('#EDH-content-body');
                    vMgr = thisNS.comp_eApps.EdhLayOutMgr;
                    vMgr.didScroll = false;
                    vMgr.TimerB = null;
                    vMgr.baseOffset = 0;
                    vMgr.secIdx = 0;
                    EDH_content_body.scrollTop(20);
                    thisNS.UiB.wfscroll(0);
                    if (edFlwNaTl.get(0).scrollHeight > edFlwNaTl.innerHeight()) {
                        edFlwNaTl.scrollTop(20);
                        edFlwNaTl.scrollTop(0);
                    }
                    EDH_content_body.scroll(thisNS.UiB.adjMarker);
                },
                adjMarker: function () {
                    var thisNS = chla.eApps.EDH.baseObj.getCcNS(),
                        vMgr = thisNS.comp_eApps.EdhLayOutMgr,
                        EDH_content_body = $('#EDH-content-body');
                    vMgr.offsetPosTrk = EDH_content_body.scrollTop();
                    if (vMgr.didScroll == false) {
                        vMgr.didScroll = true;
                        if (vMgr.TimerB == null) {
                            vMgr.TimerB = thisNS.ObjUtl.setIntervalWithContext(function () {
                                var thisNS = chla.eApps.EDH.baseObj.getCcNS(),
                                    i,
                                    lencnt,
                                    workarr,
                                    prevIdx,
                                    workoffset = -1,
                                    offsetPos = $('#EDH-content-body').scrollTop();
                                workarr = vMgr.sSecData.ssContainerHeight;
                                prevIdx = 0;
                                if (vMgr.offsetPosTrk == offsetPos) {
                                    if (vMgr.baseOffset != offsetPos) {
                                        for (i = 0, lencnt = workarr.length; i < lencnt; i++) {
                                            if (offsetPos >= vMgr.baseOffset) {
                                                // scroll direction up but we are going down the page
                                                if ((vMgr.secIdx + i) == lencnt || workarr[vMgr.secIdx + i] > offsetPos) {
                                                    workoffset = vMgr.secIdx + prevIdx;
                                                }
                                            } else if (offsetPos <= vMgr.baseOffset) {
                                                // scroll direction down but we are going up the page
                                                if ((vMgr.secIdx - i) >= 0) {
                                                    if (workarr[vMgr.secIdx - i] <= offsetPos) {
                                                        workoffset = vMgr.secIdx - i;
                                                    }
                                                } else {
                                                    workoffset = vMgr.secIdx - prevIdx;
                                                }
                                            }
                                            prevIdx = i;
                                            if (workoffset != -1) {
                                                vMgr.baseOffset = offsetPos;
                                                thisNS.UiB.wfscroll(workoffset, true);
                                                break;
                                            }
                                        }
                                    }
                                }
                            }, 2000, thisNS.comp);
                        }
                    }
                },
                processCcCssButtonBehavior1: function () {
                    // var thisNS = this.getCcNS();
                },
                processCcCssButtonBehavior2: function () {
                    $('div#EDbtn1SV').on('click', function () {
                        var thisNS                  = chla.eApps.EDH.baseObj.getCcNS(),
                            EDH_Content_body        = $('div#EDH-Content-body'),
                            EDH_BaseContent_body    = $('div#EDH-BaseContent-body'),
                            EdFlwNavTL              = $('div#edFlwNavTL'),
                            SsecLblTop              = $('div#ssecLblTop');
                        clearInterval(thisNS.comp_eApps.EdhLayOutMgr.TimerB);
                        thisNS.comp_eApps.EdhLayOutMgr.TimerB = null;
                        EDH_BaseContent_body.show();
                        EDH_Content_body.off('scroll', thisNS.UiB.adjMarker);
                        EDH_Content_body.hide();
                        EdFlwNavTL.hide();
                        EDH_BaseContent_body.scrollTop(0);
                        SsecLblTop.hide();
                        EDH_BaseContent_body.focus();
                    });
                },
                processCcCssButtonBehavior3: function () {
                    $('div#EDbtn1TLV').on('click', function () {
                        var appObj                  = chla.eApps.EDH.baseObj,
                            EDH_Content_body        = $('div#EDH-Content-body'),
                            EDH_BaseContent_body    = $('div#EDH-BaseContent-body'),
                            EdFlwNavTL              = $('div#edFlwNavTL');
                        appObj.thisCompEapps.EdhLayOutMgr.didScroll = true;
                        EDH_Content_body.show();
                        EdFlwNavTL.show();
                        EDH_BaseContent_body.hide();
                        EDH_Content_body.scrollTop(0);
                        if (appObj.UI.C8createSubSectLblTop) {
                            appObj.UI.util.calcTimesectHeight(appObj);
                            appObj.UI.C8createSubSectLblTop = false;
                            $('div#EDH-content-body  div[name*="_lab24_cbc_div"]').off();
                            $('div#EDH-content-body  div[name*="_lab24_chem_div"]').off();
                            $('div#EDH-content-body  div[name*="_lab24_oth_div"]').off();
                            $('div#EDH-content-body  h2.bloodgas_sectionHead').off();
                            $('div#EDH-content-body  h2.fo-sub-sec-hd.fo-cat-type.h5a-marker').off();
                        }
                        appObj.thisCompEapps.EdhLayOutMgr.didScroll = false;
                        appObj.UI.behaviors.scrolling();
                        EDH_Content_body.focus();
                    });
                }
//::============================================================================================
//::   METHODS - UI.LAYOUT
//::============================================================================================
            },
            layout: {
                /**
                 *
                 * @param baseObj
                 */
                renderMainContainer: function (baseObj) {
                    var EDHContainer,
                        containerHeight,
                        containerOffset,
                        windowHeight,
                        EDHcontID,
                        edflwCntrName = 'EDH-container',
                        edflwBdyBaseName = 'EDH-BaseContent-body',
                        edflwBdyName = 'EDH-content-body',
                        edFlwNavName = "EDH-content-nav",
                        edFlwHOName = 'edFlwHOSection',
                        edFlwStr,
                        edFlwNav,
                        edFlwNavTL,
                        edFlwVw,
                        edFlwVwBase,
                        edflwBdy,
                        edFlwHO;
                    $('div#EDHWait').remove();
                    EDHcontID = $('#' + baseObj.Prop.cc_id);
                    EDHContainer = EDHcontID.get(0);
                    //=========================================================================================
                    //  jquery syntax to create html element but not append to dom $("<div></div>")
                    //  create the three main sections of the layout
                    //=========================================================================================
                    edFlwNav = $("<div></div>")
                    .addClass("wrkflw-nav")
                    .attr("id", edFlwNavName)
                    .css({'display': 'inline-block'});
                    edFlwVw = $("<div></div>")
                    .addClass("wrkflw-content-body")
                    .attr("id", edflwCntrName)
                    .css({
                        'width': '870px',
                        'overflow-x': 'hidden',
                        'overflow-y': 'hidden',
                        'display': 'inline-block',
                        'height': '30px'
                    });
                    edFlwVwBase = $("<div></div>")
                    .addClass("wrkflw-content-body")
                    .attr("id", edflwBdyBaseName)
                    .css({
                        //'width':'870px',
                        'overflow-x': 'hidden',
                        'overflow-y': 'auto',
                        'height': '30px'
                    });
                    edflwBdy = $("<div></div>")
                    .addClass("wrkflw-content-body")
                    .attr("id", edflwBdyName)
                    .css({
                        // 'width':'870px',
                        'overflow-x': 'hidden',
                        'overflow-y': 'auto',
                        'height': '30px'
                    });
                    edFlwHO = $("<div></div>")
                    .addClass("EDH_notes")
                    .attr("id", edFlwHOName)
                    .css({
                        'display': 'inline-block',
                        'height': '30px',
                        'border': '1px solid black;',
                        'vertical-align': 'top'
                    });
                    edFlwVwBase.append('<div id="EDHdefault" style="text-align:center;font-size:14px;font-weight:bold;"><br/><br/><br/> No Orders / Results found</div>');
                    edFlwVw.append(edFlwVwBase);
                    edFlwVw.append(edflwBdy);
                    edFlwStr = baseObj.gFuncs.parseTemplate(baseObj.Prop.CC_Tmpls.ssecNavHdrTmplt.join(''), {
                        startdate: baseObj.UI.sSecData.lblStartdate,
                        starttime: baseObj.UI.sSecData.lblStarttime,
                        enddate: baseObj.UI.sSecData.lblEnddate,
                        endtime: baseObj.UI.sSecData.lblEndtime
                    });
                    edFlwNav.append(edFlwStr);
                    $('#' + EDHContainer.id).append(edFlwNav).append(edFlwVw).append(edFlwHO);
                    windowHeight = window.innerHeight;
                    containerOffset = EDHcontID.offset();
                    containerHeight = windowHeight - containerOffset.top;
                    containerHeight -= (3 + 25);
                    baseObj.thisCompEapps.CCcontainerHeight = containerHeight;
                    edFlwNav.height(containerHeight);
                    edFlwVw.height(containerHeight);
                    edFlwVwBase.height(containerHeight);
                    edflwBdy.height(containerHeight);
                    $('#edFlwNavTL').height((containerHeight - 175));
                    baseObj.gFuncs.Log_CC(baseObj.thisComp, baseObj.target.innerHTML);
                },
                setup_CcObjs: function (baseObj) {
                    var vCompEapps = baseObj.thisCompEapps;
                    $('div#EDHdefault').remove();
                    baseObj.UI.layout.clone_CcBaseObjs(baseObj, vCompEapps.SummarySection);
                    vCompEapps.TimeSection.forEach(
                        /**
                         *
                         * @param vTsect
                         * @param index
                         */
                        function (vTsect, index) {
                            var tempStr;
                            baseObj.UI.layout.clone_CcObjs(baseObj, vTsect);
                            tempStr = baseObj.gFuncs.parseTemplate(baseObj.Prop.CC_Tmpls.ssecNavTmplt.join(''), vTsect.wkSSecNav);
                            $('#edFlwNavTL').append(tempStr);
                            if (vTsect.dataPresent == 0) {
                                $("div#EDH_ssContainer_" + vTsect.wrkSSec.secNum + " span.wrkflw-selectOption").addClass('grey');
                            }
                        }
                    );
                    //add Dummy type segment for spacing on scroll
                    $('div#EDH-content-body').append(' <div id="dummytimeSection" style="height:600px;"> &nbsp;</div>');
                    $('span.h5b-marker.closed').toggleClass('closed');
                    $('div.sub-sec-content.closed').toggleClass('closed');
                },
                clone_CcBaseObjs: function (baseObj, timeSecObj) {
                    var tempstr,
                        vSectionlist = baseObj.Globals.CC_SectMgt.sectionlist,
                        vProp = baseObj.Prop;
                    tempstr = baseObj.gFuncs.parseTemplate(vProp.CC_Tmpls.ssecTmpltSummary.join(''), timeSecObj.wrkSSec);
                    $('div#EDH-BaseContent-body').append(tempstr);
                    vProp.CC_Modules.forEach(
                        function (vCC_Module, index) {
                            var custComp,
                                SectionObjCCcontainer,
                                target = {},
                                locId,
                                SectionCfg = [];
                            if (vCC_Module.processType === 'Orders' | vCC_Module.processType === 'Results') {
                                target = baseObj.UI.layout.cloneCC_info(baseObj, timeSecObj, index);
                                if (target.init == true) {
                                    custComp = baseObj.thisCompEapps._BaseObjs[index];
                                    custComp.data = target.data;
                                    locId = vSectionlist.length;
                                    tempstr = custComp.getOption('id') + 'Base';
                                    SectionCfg.length = 0;
                                    SectionCfg.push(
                                        {
                                            T_type: 'eApps_GenSection',
                                            SecId: tempstr,
                                            TLblId: tempstr,
                                            SecClsd: 'open',
                                            SecLvl: 'H2'
                                        }
                                    );
                                    vSectionlist.push(baseObj.Globals.InitSecData.Section_config(SectionCfg, baseObj.Globals.CC_SectMgt)[0]);
                                    SectionObjCCcontainer = baseObj.UI.util.GenSec_DTO(baseObj, vSectionlist[locId], tempstr, target.lbl);
                                    SectionObjCCcontainer.SectionCnt = "";
                                    SectionObjCCcontainer.SectionTheme = baseObj.thisCompEapps.SummarySection.wrkSSec.secColor;
                                    $('td#' + target.type + timeSecObj.wrkSSec.secId).append(SectionObjCCcontainer.generateHTML());
                                    custComp.setTarget($('#' + (custComp.getOption('id') + 'Base')).get(0));
                                    custComp.render();
                                }
                            }
                        }
                    )
                },
                clone_CcObjs: function (baseObj, timeSecObj) {
                    var ctlFlg,
                        vSectionlist = baseObj.Globals.CC_SectMgt.sectionlist,
                        tempstr;
                    tempstr = baseObj.gFuncs.parseTemplate(baseObj.Prop.CC_Tmpls.ssecTmplt.join(''), timeSecObj.wrkSSec);
                    $('div#EDH-content-body').append(tempstr);
                    ctlFlg = 0;
                    baseObj.Prop.CC_Modules.forEach(
                        function (vCC_Module, index) {
                            var tempstr,
                                custComp,
                                SectionObjCCcontainer,
                                target = {},
                                locId,
                                SectionCfg = [],
                                arrWrk = [];
                            if (vCC_Module.processType === 'Orders' || vCC_Module.processType === 'Results') {
                                target = baseObj.UI.layout.cloneCC_info(baseObj, timeSecObj, index);
                                if (target.init == true && vCC_Module.tLbl !== '') {
                                    custComp = baseObj.thisCompEapps._BaseObjs[index];
                                    custComp.data = target.data;
                                    timeSecObj._BaseObjs.push(custComp);
                                    locId = vSectionlist.length;
                                    tempstr = custComp.getOption('id') + timeSecObj._section_ID;
                                    SectionCfg.length = 0;
                                    SectionCfg.push(
                                        {
                                            T_type: 'eApps_GenSection',
                                            SecId: tempstr,
                                            TLblId: tempstr,
                                            SecClsd: 'open',
                                            SecLvl: 'H2'
                                        }
                                    );
                                    vSectionlist.push(baseObj.Globals.InitSecData.Section_config(SectionCfg, baseObj.Globals.CC_SectMgt)[0]);
                                    if (target.data.RPTDATA.DATAPRESENT == 1) {
                                        SectionObjCCcontainer = baseObj.UI.util.GenSec_DTO(baseObj, vSectionlist[locId], tempstr, target.lbl);
                                        SectionObjCCcontainer.SectionCnt = "";
                                        SectionObjCCcontainer.SectionTheme = timeSecObj.wrkSSec.secColor;
                                        $('td#' + target.type + timeSecObj.wrkSSec.secId).append(SectionObjCCcontainer.generateHTML());
                                        custComp.setTarget($('#' + (tempstr)).get(0));

                                        custComp.name = tempstr.replace('CC_', 'chla.');
                                        custComp.render();
                                    } else {
                                        if (ctlFlg == 0) {
                                            arrWrk.length = 0;
                                            arrWrk.push('td#');
                                            arrWrk.push(timeSecObj.wrkSSec.secId);
                                            arrWrk.push(" table.EDHtbl1 td");
                                            $(arrWrk.join('')).css('background-color', 'lightgrey');
                                            ctlFlg = 1;
                                        }
                                    }
                                }
                            }
                        }
                    )
                },
                cloneCC_info: function (baseObj, timeSecObj, SepJsFilesJS_idx) {
                    var SepJsFilesJS,
                        srcData,
                        vObjTypeName,
                        vCC_Modules = baseObj.Prop.CC_Modules,
                        target = {
                            data: {
                                RPTDATA: {
                                    DATAPRESENT: 0
                                }
                            }
                        };
                    SepJsFilesJS = vCC_Modules[SepJsFilesJS_idx];
                    target.nsp = SepJsFilesJS.nsp;
                    target.init = 'false';
                    vObjTypeName = SepJsFilesJS.objTypeName;
                    srcData = (SepJsFilesJS.processType === 'Orders' ? timeSecObj.Orders_CC : timeSecObj.Results_CC );
                    if (typeof srcData[vObjTypeName] !== 'undefined') {
                        if (typeof srcData[vObjTypeName].data !== 'undefined') {
                            target.data = srcData[vObjTypeName].data;
                            if (typeof target.data.RPTDATA != 'undefined') {
                                target.init = true;
                            }
                        }
                    }
                    target.type = SepJsFilesJS.processType + 'Data';
                    target.lbl = SepJsFilesJS.lbl;
                    return target;
                },
                createSurveyTimerSection: function (CCbaseObj, baseObj) {
                    var w,
                        o2,
                        tempWidth,
                        tempWidthAdj,
                        custCompObj,
                        SectionObjCCcontainer,
                        edFlwHOSection,
                        cc_name;
                    edFlwHOSection = $('div#edFlwHOSection');
                    custCompObj = baseObj.thisCompEapps._BaseObjs[CCbaseObj.id];
                    baseObj.Dta.setPropertyMpageComponent(baseObj,  CCbaseObj.cc_id, custCompObj.data, CCbaseObj.id, custCompObj);
                    cc_name = custCompObj.getOption('id');
                    SectionObjCCcontainer = baseObj.UI.util.GenSec_DTO(baseObj, 'H2_Sec_EDHsurvTimer', cc_name, CCbaseObj.titleheader);
                    SectionObjCCcontainer.SectionCnt = '';
                    SectionObjCCcontainer.SectionTheme = 'yellow';
                    edFlwHOSection.append(SectionObjCCcontainer.generateHTML(baseObj.gCC_CssBehavior));
                    o2 = edFlwHOSection.offset();
                    tempWidth = ( window.innerWidth < 1280 ? 1280 : window.innerWidth);
                    tempWidthAdj = ( window.innerWidth < 1280 ? 0 : 50);
                    w = tempWidth - o2.left - tempWidthAdj; //15 ;
                    if (window.innerWidth < 1280) {
                        $('div#chla_EDHandoff').width('1280px');
                        //$('div#chla_EDHandoff').css('scroll-x','auto');
                        $('div#EDHXX11').css('overflow-x', 'scroll');
                    }
                    edFlwHOSection.width(w + 'px');
                    custCompObj.setTarget($('div#' + cc_name).get(0));
                    custCompObj.render();
                    $('.sec-hd-tgl.h2b-marker').css('background-image', 'none');
                    $('.opts-menu.menu-hide').css('background-image', 'none');
                },
                createNoteSection: function (CCLreqBaseObj, baseObj) {
                    var appNS = baseObj.getCcNS(),
                        o2,
                        h,
                        tempWidthAdj,
                        custCompObj,
                        SectionObjCCcontainer,
                        edFlwHOSection,
                        div_cc_name,
                        cc_name,
                        arrWrk = [];
                    // arrWrk.push('<a style="float:right;font-size:11px;" href="javascript:MPAGES_EVENT(',
                    //     '"chla.eApps.gFuncs.MPageHnamAPI(&quot;POWERFORM&quot;,',
                    //     appNS.Prp.personId,
                    //     ',',
                    //     appNS.Prp.encounterId,
                    //     ',',
                    //     '92432008',
                    //     ',',
                    //     appNS.Prp.ACTIVITY_ID_PF,
                    //     ',',
                    //     '0 );">PowerFrom: Info for MD</a>');
                    // arrWrk.push('<a href="javascript:MPAGES_EVENT(',
                    //     "'POWERFORM','",
                    //     appNS.Prp.personId,
                    //     '|',
                    //     appNS.Prp.encounterId,
                    //     '|92432008|',
                    //     appNS.Prp.ACTIVITY_ID_PF,
                    //     "|0'",
                    //     ');">',
                    //     'PowerFrom: Info for MD</a>');

                    arrWrk.push('<a style="float:right;font-size:11px;" href="javascript:MPAGES_EVENT(',
                        "'POWERFORM','",
                        appNS.Prp.personId,
                        '|',
                        appNS.Prp.encounterId,
                        '|92432008|',
                        appNS.Prp.ACTIVITY_ID_PF,
                        "|0'",
                        ');">',
                        'Form: Info for MD Rounding Report</a>');
                    edFlwHOSection = $('div#edFlwHOSection');
                    appNS.Logger.LogInfo('PowerFrom: ' + appNS.gFuncs.HtmlLogFormatter(arrWrk.join('')));
                    custCompObj = baseObj.thisCompEapps._BaseObjs[CCLreqBaseObj.id];
                    cc_name = custCompObj.getOption('id');
                    SectionObjCCcontainer = baseObj.UI.util.GenSec_DTO(baseObj, 'H2_Sec_EDHpatNotes', cc_name, CCLreqBaseObj.titleheader);
                    SectionObjCCcontainer.SectionCnt =  arrWrk.join('');
                    SectionObjCCcontainer.SectionCntVal =  arrWrk.join('');
                    SectionObjCCcontainer.SectionTheme = 'yellow';
                    edFlwHOSection.append(SectionObjCCcontainer.generateHTML());
                    //o2 = $('div#' + cc_name).offset();
                    //o2 = edFlwHOSection.offset();
                    h = baseObj.thisCompEapps.containerHeight;
                    //tempWidth= (window.innerWidth < 1280 ? 1280 :  window.innerWidth);
                    //w = window.innerWidth  -  o2.left  - 15 ;
                    tempWidthAdj = ( window.innerWidth < 1280 ? 15 : 20);
                    //$('div#edFlwHOSection').width( w + 'px');
                    div_cc_name = $('div#' + cc_name);
                    custCompObj.setTarget(div_cc_name.get(0));
                    custCompObj.render();
                    o2 = div_cc_name.offset();
                    h = h - o2.top - tempWidthAdj;
                    $('#GNtsText').height(h + 'px');
                    $('.sec-hd-tgl.h2b-marker').css('background-image', 'none');
                    $('.opts-menu.menu-hide').css('background-image', 'none');
                },
                createSubSectLblTop: function (ED_date, sscontainerID) {
                    var tempstr,
                        tempArr = [];
                    tempArr.push('ED_date ');
                    tempArr.push(ED_date);
                    tempArr.push(' sscontainerID  ');
                    tempArr.push(sscontainerID);
                    tempstr = tempArr.join('');
                    chla.eAppsUtil.Logger.LogInfo(tempstr);
                    $('div#timeperiod' + sscontainerID).prepend(tempstr);
                },
                createSumSection: function (baseObj, baseDTTM, baseEndDTTM) {
                    var tempstr,
                        timeSecObj,
                        setColor,
                        DTO_ccData,
                        ccList = baseObj.Prop.CC_Modules,
                        vCompEapps = baseObj.thisCompEapps,
                        vOrders,
                        vResults;
                    DTO_ccData = baseObj.Dta.util.getCC_Data(baseObj);
                    vOrders = DTO_ccData.Orders_CC;
                    vResults = DTO_ccData.Results_CC;
                    timeSecObj = baseObj.UI.util.TimeSectionCls.neo(0, baseObj);
                    tempstr = baseObj.Dte.util.calcTime(baseDTTM);
                    timeSecObj.Start_Time = tempstr + ':00';
                    setColor = ('orange');
                    timeSecObj.wrkSSec.secColor = setColor;
                    timeSecObj.wrkSSec.ssBodyId = baseObj.Prop.cc_lbl + "_sp";
                    timeSecObj.wrkSSec.assocViewId = baseObj.Prop.cc_lbl + "_ssBody_sp";
                    timeSecObj.wrkSSec.ElapseTMlbl = (' Summary ');
                    timeSecObj.wrkSSec.secId = 'sumPeriod';
                    ccList.forEach(
                        function (vCC_Module) {
                            var srcPtr = null,
                                trgPtr = null,
                                intervalTime = null,
                                vObjTypeName = vCC_Module.objTypeName;
                            if (vCC_Module.processType == 'Orders') {
                                timeSecObj.Orders_CC[vObjTypeName] = {};
                                srcPtr = vOrders[vObjTypeName];
                                trgPtr = timeSecObj.Orders_CC[vObjTypeName];
                            } else if (vCC_Module.processType == 'Results') {
                                timeSecObj.Results_CC[vObjTypeName] = {};
                                srcPtr = vResults[vObjTypeName];
                                trgPtr = timeSecObj.Results_CC[vObjTypeName];
                            }
                            if (srcPtr !== null) {
                                intervalTime = baseEndDTTM - baseDTTM;
                                trgPtr.data = baseObj.Dta.util.processSectionalData(
                                    baseObj,
                                    vObjTypeName,
                                    baseDTTM,
                                    intervalTime,
                                    srcPtr.data);
                            }
                        });

                    vCompEapps.SummarySection = timeSecObj;
                },
                createTimeSections: function (baseObj, wrkDtTm) {
                    var i,
                        totCnt,
                        timeSecObj,
                        vCompEapps = baseObj.thisCompEapps,
                        arrTimeSection = baseObj.thisCompEapps.TimeSection,
                        vTimeSectionCls = baseObj.UI.util.TimeSectionCls;
                    for (i = 0, totCnt = vCompEapps.TimeSectionCnt; i < totCnt; i++) {
                        timeSecObj = vTimeSectionCls.neo(i, baseObj);
                        arrTimeSection.push(timeSecObj);
                    }
                    arrTimeSection.forEach(
                        function (timeSecObj, index) {
                            var tempstr,
                                setColor,
                                ccList = baseObj.Prop.CC_Modules,
                                trgPtr,
                                vCompEapps = baseObj.thisCompEapps,
                                vCC_lbl = baseObj.Prop.cc_lbl,
                                vOrders = baseObj.thisCompEapps.Orders_CC,
                                vResults = baseObj.thisCompEapps.Results_CC;
                            baseObj.UI.sSecData.startdate = baseObj.Dte.util.calcDate(wrkDtTm);
                            tempstr = baseObj.Dte.util.calcTime(wrkDtTm);
                            baseObj.UI.sSecData.starttime = tempstr;
                            timeSecObj.Start_Time = new Date(wrkDtTm.getTime());
                            wrkDtTm.setMinutes(wrkDtTm.getMinutes() + (vCompEapps.interval_length));
                            setColor = ( (index % 2) == 0 ? 'cernerblue' : 'darkgreen');
                            timeSecObj.wkSSecNav.secColor = setColor;
                            timeSecObj.wkSSecNav.ssContainerNum = index;
                            timeSecObj.wkSSecNav.ssContainerId = vCC_lbl + "_ssContainer_" + index;
                            timeSecObj.wkSSecNav.navId = vCC_lbl + "_ssNav_" + index;
                            timeSecObj.wkSSecNav.navNum = index;
                            timeSecObj.wkSSecNav.navLbl = tempstr;
                            timeSecObj.wrkSSec.secColor = setColor;
                            timeSecObj.wrkSSec.ssBodyId = vCC_lbl + "_" + index;
                            timeSecObj.wrkSSec.assocViewId = vCC_lbl + "_ssBody_" + index;
                            timeSecObj.wrkSSec.ElapseTMlbl = (tempstr + '</span>&nbsp;&nbsp;&nbsp; Date: ' + baseObj.Dte.util.calcDate(wrkDtTm));
                            timeSecObj.wrkSSec.secId = 'timeperiod' + index;
                            ccList.forEach(
                                function (vCC_Module) {
                                    var srcPtr = null,
                                        vObjTypeName = vCC_Module.objTypeName;
                                    if (vCC_Module.processType == 'Orders') {
                                        timeSecObj.Orders_CC[vObjTypeName] = {};
                                        srcPtr = vOrders[vObjTypeName];
                                        trgPtr = timeSecObj.Orders_CC[vObjTypeName];
                                    } else if (vCC_Module.processType == 'Results') {
                                        timeSecObj.Results_CC[vObjTypeName] = {};
                                        srcPtr = vResults[vObjTypeName];
                                        trgPtr = timeSecObj.Results_CC[vObjTypeName];
                                    }
                                    if (srcPtr !== null) {
                                        trgPtr.data = baseObj.Dta.util.processSectionalData(
                                            baseObj,
                                            vObjTypeName,
                                            timeSecObj.Start_Time,
                                            (timeSecObj.interval_length * 60000),
                                            srcPtr.data);
                                        timeSecObj.dataPresent += trgPtr.data.RPTDATA.DATAPRESENT;
                                    }
                                });
                            timeSecObj.wrkSSec.secColor = (timeSecObj.dataPresent > 0 ? setColor : 'grey');
                            timeSecObj.wrkSSec.EDHtbl2Display = (timeSecObj.dataPresent > 0 ? '' : 'eAppsNoDisplay');
                            baseObj.UI.sSecData.ssec.push(timeSecObj.wrkSSec);
                            baseObj.UI.sSecData.ssecNav.push(timeSecObj.wkSSecNav);
                        });
                },
                createDspSections: function (baseObj) {
                    var baseDTTM,
                        baseEndDTTM,
                        wrkMin,
                        vCompEapps = baseObj.thisCompEapps,
                        vEnctr = baseObj.Prop.Enctr;
                    baseDTTM = new Date(vEnctr.START_DTTM.getTime());
                    if (vEnctr.END_DTTM === 0) {
                        baseEndDTTM = new Date();
                    } else {
                        baseEndDTTM = new Date(vEnctr.END_DTTM.getTime());
                    }
                    baseObj.UI.layout.createSumSection(baseObj, vEnctr.START_DTTM, baseEndDTTM);
                    vCompEapps.TimeSectionCnt = 0;  //20 12
                    if (vEnctr.END_DTTM > 0) {
                        wrkMin = baseObj.gFuncs.dateDiff(vEnctr.START_DTTM, vEnctr.END_DTTM, 'minutes');
                        if (vEnctr.E_ENCNTR_TYPE === 'Emergency' || vEnctr.E_ADMIT_TYPE === 'Emergency') {
                            vCompEapps.TimeSectionCnt = 1;
                            vCompEapps.TimeSectionCnt += parseInt(wrkMin / vCompEapps.interval_length);
                            vCompEapps.TimeSectionCnt += (wrkMin % vCompEapps.interval_length > 0 ? 1 : 0);
                        }
                    }
                    baseObj.UI.layout.createTimeSections(baseObj, baseDTTM);
                }
            },
            sSecData: null,
            C8createSubSectLblTop: null
        },
        //::============================================================================================
        //::   METHODS - TESTING
        //::============================================================================================
        Tests: {
            TestServiceAccessPoint: function () {
                return {
                    TestProcessRPTDATA_main: appEDH.Dta.processRPTDATA_main_data,
                    TestProcessRPTDATA_end: appEDH.Dta.processRPTDATA_end_data
                };
            }
        },
        //::============================================================================================
        //::   METHODS - Utilities
        //::============================================================================================

        Util_functions: {
            setIntervalWithContext: function (code, delay, context) {
                return setInterval(function () {
                    code.call(context)
                }, delay)
            },
            setTimeoutWithContext: function (code, delay, context) {
                return setTimeout(function () {
                    code.call(context)
                }, delay)
            }
        },
        //::============================================================================================
        //::   METHODS - PROCESS FLOW
        //::============================================================================================
        thisComp: null,
        thisCompEapps: null,
        /**
         *
         * @param vComponent
         * @param vBaseObj
         */
        cfgInit: function (vComponent, vBaseObj) {
            var vGlbls,
                vInitSecData,
                vPrp,
                vUI,
                vCC_SectMgt,
                SectionCfg;
            vComponent.eApps = {
                cc_id:                  vComponent.name.replace('.', '_'),
                CSSBehaviors:           vBaseObj.gCSSBehaviorCls.neo(),
                SaveButtonAction:       vBaseObj.gButtonBehaviorSaveCls.neo(),
                TestSAP:                null,
                appEDH:                 appEDH,
                _BaseObjs:              [],
                interval_length:        30,
                TimeSection:            [],
                SummarySection:         null,
                OrdersReady:            [],
                Orders_CC:              {},
                ResultsReady:           [],
                Results_CC:             {},
                CCcontainerHeight:      0,
                EdhLayOutMgr:   {
                    toggled:            false,
                    TimerA:             null,
                    totalOffset:        0,
                    ContainerHeightBase:0,
                    sSecData: {
                        ContainerHeight:0,
                        ssecNav:        [],
                        ssec:           []
                    }
                }
            };
            vBaseObj.elementObj         = vComponent.data.RPTDATA;
            vBaseObj.target             = vComponent.getTarget();
            vBaseObj.thisComp           = vComponent;
            vBaseObj.thisCompEapps      = vComponent.eApps;
            vGlbls                      = vBaseObj.Globals;
            vUI                         = vBaseObj.UI;
            vPrp                        = vBaseObj.Prop;
            vComponent.eApps.TestSAP    = vBaseObj.Tests.TestServiceAccessPoint;
            vPrp.initOnly = ChlaStdClass.safeRead(chla, 'eApps', 'operationMode') == 'test' ||
                ChlaStdClass.safeRead(chla, 'eApps', 'EDH', 'operationMode') == 'EDHTest';
            vUI.C8createSubSectLblTop   = true;
            vPrp.cc_id                  = vComponent.eApps.cc_id;
            vPrp.personId               = vComponent.getProperty("personId");
            vPrp.encounterId            = vComponent.getProperty("encounterId");
            vPrp.prsnlId                = vComponent.getProperty("userId");
            vPrp.ACTIVITY_ID_PF         = vBaseObj.elementObj.ACTIVITY_ID_INFO_MD_PF;
            vUI.sSecData                = vUI.util.ssecDataCls.neo();
            vGlbls.InitSecData          = vBaseObj.gSectionDataCls.neo();
            vGlbls.CC_SectMgt           = vPrp.CC_SectionManagement;
            vCC_SectMgt                 = vGlbls.CC_SectMgt;
            vInitSecData                = vGlbls.InitSecData;
            SectionCfg = [
                {
                    T_type:     'eApps_GenSection',
                    SecId:      'EDHpatNotes',
                    TLblId:     'EDHpatNotes',
                    SecClsd:    'open',
                    SecLvl:     'H2'
                },
                {
                    T_type:     'eApps_GenSection',
                    SecId:      'EDHsurvTimer',
                    TLblId:     'EDHsurvTimer',
                    SecClsd:    'open',
                    SecLvl:     'H2'
                }
            ];
            vCC_SectMgt.sectionlist = vInitSecData.Section_config(SectionCfg, vCC_SectMgt);
            chla.eApps.EDH = {
                wfScroll:       vUI.behaviors.wfscroll,
                baseObj:        vBaseObj
            };
            vUI.util.injectStyles('table.EDHtbl1 td.grey{background-color:lightgrey;}');
            vUI.util.injectStyles('span.wrkflw-selectOption.grey{color:tan;}');
        },
        CreateUItimer: function (baseObj) {
            var appNS = baseObj.getCcNS();
            appNS.comp_eApps.TimerUI = appNS.ObjUtl.setIntervalWithContext(
                function () {
                    var thisContext = this,
                        appNS;
                    appNS = thisContext.getCcNS();
                    if (( appNS.comp_eApps.OrdersReady.length == 0 && appNS.comp_eApps.ResultsReady.length == 0 )) {
                        clearInterval(appNS.comp_eApps.TimerUI);
                        appNS.comp_eApps.TimerUI = null;
                        appNS.Log.LogInfo('CreatUItimer executed');
                        appNS.UiLO.createDspSections(appNS.Obj);
                        appNS.Obj.CreateUI(appNS.Obj);
                    }
                }, 2000, appEDH);
        },
        CreateUI: function (baseObj) {
            var appNS = baseObj.getCcNS(),
                CC_modName = 'SurvTimr',
                divEDH_BaseContent_body;
            appNS.UiLO.renderMainContainer(baseObj);
            divEDH_BaseContent_body = $('div#EDH-BaseContent-body');
            appNS.UiLO.setup_CcObjs(baseObj);
            appNS.UiLO.createSurveyTimerSection(appNS.comp_eApps[CC_modName], baseObj);
            appNS.UiLO.createNoteSection(appNS.comp_eApps.EDHnotes, baseObj);
            if (appNS.comp_eApps.TimeSectionCnt > 0) {
                $('.sec-hd-tgl.h2b-marker').css('background-image', 'none');
                $('.opts-menu.menu-hide').css('background-image', 'none');
                appNS.UiB.processCcCssButtonBehavior3();
            } else {
                $('div#EDbtn1TLV').hide();
            }
            appNS.UiB.processCcCssButtonBehavior2();
            appNS.UiB.processCcCssButtonBehavior1();
            $('div#edFlwNavTL').hide();
            $('div#ssecLblTop').hide();
            $('div#EDH-Content-body').hide();
            divEDH_BaseContent_body.scrollTop(0);
            divEDH_BaseContent_body.focus();
            $(window).resize(
                function () {
                    var w,
                        o2,
                        divEdFlwHOSection,
                        tempWidth,
                        tempWidthAdj;
                    divEdFlwHOSection = $('div#edFlwHOSection');
                    o2 = divEdFlwHOSection.offset();
                    tempWidth = ( window.innerWidth < 1280 ? 1280 : window.innerWidth);
                    tempWidthAdj = ( window.innerWidth < 1280 ? 0 : 50);
                    w = tempWidth - o2.left - tempWidthAdj; //15 ;
                    if (window.innerWidth < 1280) {
                        $('div#chla_EDHandoff').width('1280px');
                        $('div#EDHXX11').css('overflow-x', 'scroll');
                    } else {
                        $('div#chla_EDHandoff').width(tempWidth + 'px');
                        $('div#EDHXX11').css('overflow-x', 'hidden');
                    }

                    if (o2.left > 980) {
                        divEdFlwHOSection.width(w + 'px');
                    }
                });
        },
        cfgProcessor: function (baseObj){
            baseObj.Dta.processRPTDATA_main_data(baseObj.elementObj,baseObj);
            baseObj.Dta.processCcInstance(appEDH);
            baseObj.Dta.ldBaseObjs(baseObj.Prop.CC_Modules, baseObj);
            baseObj.Prop.CC_Modules.forEach(
                function (CC_Module) {
                    baseObj.Dta.InitBaseObj(CC_Module, baseObj);
                });
            baseObj.CreateUItimer(baseObj);
        },
        getCcNS: function () {
            var retObj = chla.eAppsClass.neo();
            ChlaStdClass.applyProperties(retObj, {
                Log:            appEDH.Logger,
                gCCLRequest:    appEDH.gCCLRequestCls,
                gCCLRequestCls: appEDH.gCCLRequestCls,
                gFuncs:         appEDH.gFuncs,
                comp:           appEDH.thisComp,
                comp_eApps:     appEDH.thisCompEapps,
                Obj:            appEDH,
                appObj:         appEDH,
                ObjUtl:         appEDH.Util_functions,
                Glbls:          appEDH.Globals,
                Prp:            appEDH.Prop,
                Dte:            appEDH.Dte,
                DteUtl:         appEDH.Dte.util,
                Dta:            appEDH.Dta,
                DtaUtl:         appEDH.Dta.util,
                UI:             appEDH.UI,
                UiUtl:          appEDH.UI.util,
                UiLO:           appEDH.UI.layout,
                UiB:            appEDH.UI.behaviors,
                Tst:            appEDH.Tests
            });
            return retObj;
        }
    });

    if (appEDH.Prop.initOnly == false) {
        appEDH.cfgProcessor(appEDH);
    }
}};
// ::===========================================================================
// :: CC - NiccuNotes Module
// ::---------------------------------------------------------------------------
chla.NiccuNotes = function() {};
chla.NiccuNotes.prototype = new MPage.Component();
chla.NiccuNotes.prototype.constructor = MPage.Component;
chla.NiccuNotes.prototype.base = MPage.Component.prototype;
chla.NiccuNotes.prototype.name = 'chla.NiccuNotes';
chla.NiccuNotes.prototype.cclProgram = 'chla_ca_mp_cc_niccu_nte_json';
chla.NiccuNotes.prototype.cclParams = [];
chla.NiccuNotes.prototype.cclDataType = 'JSON';
chla.NiccuNotes.prototype.init = function() {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("encounterId");
    this.cclParams[2] = this.getProperty("personId");
    this.cclParams[3] = this.getProperty("userId");
};

chla.NiccuNotes.prototype.render = function() {
    var component = this,
        appNS = null,
        NiccuNotes = {
            initOnly: false,
            cc_id: 'x',
            personId: 0,
            encounterId: 0,
            prsnlId: 0,
            transparentSpacer: '',
            textNotes: '',
            checkBoxItems:{
                check1:'',
                check2:'',
                check3:'',
                check4:'',
                check5:''
            },
            CC_Tmpls: {
                Note_Tmplt: [
                    '<br/><div style="display:table-row" >',
                    '<div style="display:table-cell;"><input type="checkbox" id="item1" <#=checked1#>>&nbsp;Unstable&nbsp;</div>',
                    '</div><div style="display:table-row"">',
                    '<div style="display:table-cell;"><input type="checkbox" id="item2" <#=checked2#>>&nbsp;Critical Airway/Fresh Trach&nbsp;</div>',
                    '</div><div style="display:table-row"">',
                    '<div style="display:table-cell;"><input type="checkbox" id="item3" <#=checked3#>>&nbsp;Heparinized&nbsp;</div>',
                    '</div><div style="display:table-row"">',
                    '<div style="display:table-cell;"><input type="checkbox" id="item4" <#=checked4#>>&nbsp;Metal Alert&nbsp;</div>',
                    '</div><div style="display:table-row"">',
                    '<div style="display:table-cell;"><input type="checkbox" id="item5" <#=checked5#>>&nbsp;OR in AM&nbsp;</div>',
                    '</div>',
                    '<br/><div style="display:table-row;font-weight:500;" >Notes:</div>',
                    '<textarea id="niccuNtsText" rows="15" style="width:96%;margin-bottom:5px;">',
                    '<#=textNotes#></textarea><br/>',
                    '<br/><button id="niccuNtsSave" class="eappsBtnGrey">  Save</button></p>'
                ]
            },
            /**
             *
             * @param objBaseNS {object}
             * @param objCcBase {object}
             */
            processRPTDATA_main_data: function(objBaseNS,objCcBase) {
                var wrkArr      = [],
                    wrkValue,
                    objData     = objCcBase.eApps.elementObj,
                    chkBoxItems = objBaseNS.NiccuNotes.checkBoxItems ;
                objData.NICCU_LIST.forEach(
                    function (item) {
                        wrkArr.push(item.NICCUNOTES);
                        wrkArr.push('\n');
                    }
                );
                if (wrkArr.join().indexOf('CNS:') ===  -1 ){
                    wrkArr.unshift('CNS:\n\nCVS:\n\nRS:\n\nFEN/GI:\n\nEndo:\n\nID:\n\nOther:\n\n');
                }
                chkBoxItems.check1 = (objData.CHECK1== 'true'? 'checked':'');
                chkBoxItems.check2 = (objData.CHECK2== 'true'? 'checked':'');
                chkBoxItems.check3 = (objData.CHECK3== 'true'? 'checked':'');
                chkBoxItems.check4 = (objData.CHECK4== 'true'? 'checked':'');
                chkBoxItems.check5 = (objData.CHECK5== 'true'? 'checked':'');
                wrkValue = wrkArr.join('');
                objBaseNS.NiccuNotes.textNotes = wrkValue.replace(/\\par/g, '\n');
            },
            /**
             *
             * @param objBaseNS {object}
             * @param objCcBase {object}
             */
            processCcInstance: function(objBaseNS,objCcBase) {
                var compContent,
                    chkBoxItems =objBaseNS.NiccuNotes.checkBoxItems;
                compContent = objBaseNS.gFuncs.parseTemplate(objBaseNS.gTmplts.gCcMainDiv.join(''), {
                    cc_id      : objBaseNS.NiccuNotes.cc_id,
                    mainSection: appNS.gFuncs.parseTemplate(objBaseNS.NiccuNotes.CC_Tmpls.Note_Tmplt.join(''), {
                      checked1: chkBoxItems.check1,
                      checked2: chkBoxItems.check2,
                      checked3: chkBoxItems.check3,
                      checked4: chkBoxItems.check4,
                      checked5: chkBoxItems.check5,
                      textNotes: objBaseNS.NiccuNotes.textNotes
                    })
                });
                appNS.gFuncs.Log_CC(objCcBase, compContent);
                objCcBase.eApps.target.innerHTML = compContent;
            },
            /**
             *
             * @param objBaseNS {object}
             * @param objCcBase {object}
             */
            processCcCssButtonBehavior1: function(objBaseNS,objCcBase) {
                var btnLbl = $("#niccuNtsSave");
                btnLbl.attr('buttonState','Disabled');
                btnLbl.on("click",
                    /**
                     *
                     */
                     function() {
                        var paramArr = [],
                            CcEapps = objCcBase.eApps,
                            wrkValue;
                        if ( $('#niccuNtsSave').attr('buttonState') =='Enabled'){
                            paramArr.push('^MINE^,');
                            paramArr.push(component.eApps.encounterId,',');
                            paramArr.push(component.eApps.personId,',');
                            wrkValue = $('#niccuNtsText').val();
                            wrkValue = wrkValue.replace(/\n/g,'\\par ');
                            paramArr.push( '^',wrkValue,'^,^');
                            //id="item1" Unstable
                            paramArr.push($('input[id="item1"]').is(':checked'), '^,^');
                            //id="item2" &nbsp;Critical Airway/Fresh Trach
                            paramArr.push($('input[id="item2"]').is(':checked'), '^,^');
                            //id="item3" &nbsp;Heparinized
                            paramArr.push($('input[id="item3"]').is(':checked'), '^,^');
                            //id="item4" &nbsp;Metal Alert
                            paramArr.push($('input[id="item4"]').is(':checked'), '^,^');
                            //id="item5" &nbsp;OR in AM
                            paramArr.push($('input[id="item5"]').is(':checked'), '^,');
                            paramArr.push(component.eApps.userId);
                            if (CcEapps.CCLreqObjSave === null) {
                                CcEapps.CCLreqObjSave                       = objBaseNS.gCCLRequestCls.neo();
                                CcEapps.CCLreqObjSave.ObjectName           = objBaseNS.NiccuNotes.cc_id +'_CCLreqObjSave';
                                CcEapps.CCLreqObjSave.BtnSaveBehaviorFunc   = CcEapps.SaveButtonAction;
                                /**
                                 *
                                 * @param responseData
                                 */
                                CcEapps.CCLreqObjSave.CallBackOperation = function(responseData) {
                                    CcEapps.CSSBehaviors.hoverContent   = CcEapps.HoverDataFormatter(responseData);
                                };
                            }
                            CcEapps.CCLreqObjSave.DataTransfer0(
                                CcEapps.CCLreqObjSave,
                                'chla_ca_mp_cc_ins_niccu_json',
                                paramArr.join(''),
                                '#niccuNtsSave');
                        }
                    });
                objCcBase.eApps.SaveButtonAction('#niccuNtsSave', 'RESET');
            },
            /**
             *
             * @param objBaseNS {object}
             * @param objCcBase {object}
             */
            processCcCssButtonBehavior2: function(objBaseNS,objCcBase) {
                var CcEapps = objCcBase.eApps;
                CcEapps.CCLreqObjSave = null;
                CcEapps.CSSBehaviors = objBaseNS.gCSSBehaviorCls.neo();
                /**
                 *
                 * @param sourceData
                 * @returns {string}
                 */
                CcEapps.HoverDataFormatter = function (sourceData) {
                    var arrWrk=[];
                    arrWrk.push('<span style="font-weight:bold;">Update History</span></br>');
                    if(ChlaStdClass.isEmpty(sourceData.UPDT_LIST) === false) {
                        sourceData.UPDT_LIST.forEach(
                            function (item) {
                                arrWrk.push(item.UPDT_MODBY_ID);
                                arrWrk.push(' on ');
                                arrWrk.push(item.UPDTDATETIME);
                                arrWrk.push("</br>");
                            }
                        );
                    }
                    return arrWrk.join('');
                };
                CcEapps.CSSBehaviors.InitPopUpsDiv(
                    CcEapps.HoverDataFormatter(CcEapps.elementObj),
                    'button#niccuNtsSave', 'T');
            },
            /**
             *
             * @param objBaseNS {object}
             * @param objCcBase {object}
             */
            processCcCssControlBehavior1: function(objBaseNS,objCcBase) {
                var objCC = objCcBase;
                $("#niccuNtsText").on("click",
                    function() {
                        $('#niccuNtsSave').attr('buttonState','Enabled');
                        objCC.eApps.SaveButtonAction('#niccuNtsSave', 'ENABLE');
                });
            },
            /**
             *
             * @param objBaseNS {object}
             * @param objCcBase {object}
             */
            processCcCssControlBehavior2: function(objBaseNS,objCcBase) {
                var objCC = objCcBase,
                    cc_name = [ 'div#',objCcBase.eApps.cc_id, ' input[id^="item"]'];;
                $(cc_name.join('')).on("click",
                    function() {
                        $("#niccuNtsText").attr('buttonState','Enabled');
                        objCC.eApps.SaveButtonAction('#niccuNtsSave', 'ENABLE');
                    });
            },
            init: function() {
                var CcInit = chla.eApps.gCcModuleCls.neo(),
                    arrWrk=[];
                appNS =  chla.eAppsClass.neo();
                CcInit.CommonCcInit( appNS, component);
                component.eApps.TestSap = NiccuNotes.TestServiceAccessPoint;
                component.eApps.SaveButtonAction = chla.eApps.SaveButtonBehavior.enable_disable_status_reset;
                NiccuNotes.cc_id        = component.eApps.cc_id;
                NiccuNotes.personId     = component.eApps.personId;
                NiccuNotes.encounterId  = component.eApps.encounterId;
                NiccuNotes.prsnlId      = component.eApps.userId;
                arrWrk.push( '<img src="' );
                arrWrk.push( chla.eApps.Vars.transparentSpacer );
                arrWrk.push( '" height="5px" width="17px"  >');
                NiccuNotes.transparentSpacer = arrWrk.join('');
                ChlaStdClass.applyProperties(appNS,{'NiccuNotes':NiccuNotes});
            },
            TestServiceAccessPoint: function() {
                return {
                    TestProcessRPTDATA_main:           NiccuNotes.processRPTDATA_main_data,
                    TestProcessCcInstance:             NiccuNotes.processCcInstance,
                    TestProcessCcCssButtonBehavior_1:  NiccuNotes.processCcCssButtonBehavior1,
                    TestProcessCcCssButtonBehavior_2:  NiccuNotes.processCcCssButtonBehavior2,
                    TestProcessCcCssControlBehavior_1: NiccuNotes.processCcCssControlBehavior1
                };
            }
        };
    if (arguments.length == 1 && (typeof arguments[0]).toLowerCase() == 'object') {
        component.cloneInit(arguments[0].clone_name, NiccuNotes, arguments);
    }
    NiccuNotes.init();
    if (component.eApps.initOnly === false) {
        NiccuNotes.processRPTDATA_main_data(appNS,component);
        NiccuNotes.processCcInstance(appNS,component);
        NiccuNotes.processCcCssButtonBehavior1(appNS,component);
        NiccuNotes.processCcCssButtonBehavior2(appNS,component);
        NiccuNotes.processCcCssControlBehavior1(appNS,component);
        NiccuNotes.processCcCssControlBehavior2(appNS,component);
        NiccuNotes = null;
    }
};

//::===========================================================================
//:: CC - dcSummary
//::---------------------------------------------------------------------------

chla.dcSummary = function () { };
chla.dcSummary.prototype = new MPage.Component();
chla.dcSummary.prototype.constructor = MPage.Component;
chla.dcSummary.prototype.base = MPage.Component.prototype;
chla.dcSummary.prototype.name = "chla.dcSummary";
chla.dcSummary.prototype.cclProgram = "chla_ca_mp_cc_dc_summary_json";
chla.dcSummary.prototype.cclParams = [];
chla.dcSummary.prototype.cclDataType = "JSON";
chla.dcSummary.prototype.init = function (options) {
    this.cclParams[0] = "MINE";
    this.cclParams[1] = this.getProperty("encounterId");
    this.cclParams[2] = this.getProperty("personId");
};
//::===========================================================================
//:: CC - dcSummary
//::---------------------------------------------------------------------------

chla.dcSummary.prototype.render = function () {
    var component = this;
    var elementObj = component.data.RPTDATA;
    var target = this.getTarget();
    var compContent;
    //-------------------------------------
    //  Common Used Variable Names for RPTDATA processing
    //-------------------------------------
    var i, j , k ;             // common for loop values
    var SectionObj,            // CC_SectionManagement
                               // variables to hold RPTData values
        wrkRPTDATA_cnt,
        wrkRPTDATA,
        wrkRPTDATA_idx,
        wrkCnt,
        wrkValue,
        wrkDesc,
        wrkList,
        wrkPrevValue,
        wrkResults;
    var listLen,
        listLen2;
        //NOTE:: numbers used to denote the code hierarchy depth variable is used at.
        //NOTE:: i.e. inside for, while, if command statement
    //-------------------------------------
    // CC - DIV Template Data Object
    //-------------------------------------
    var dcSummary = {
        cc_id: 'x',
        personId: 0,
        encounterId: 0,
        transparentSpacer:'',
        dctextnotes:''
        } ;
    //-------------------------------------
    // Main CC - DIV Template
    //-------------------------------------
    var dcSummary_Tmpl = [
      '<div id="<#=cc_id#>" class="eapps_CC"><textarea id="dcSummaryNtsText" rows="10" ',
      'style="width:96%;margin-bottom:5px;"><#=dctextnotes#></textarea><br/><p>',
      '<button id="dcSummaryNtsSave" class="eappsBtnGrey">  Save</button></p></div>'
   ];
//-------------------------------------
//  Stanadard Common initializations
//-------------------------------------
      chla.dcSummary.eApps = {};
      chla.dcSummary.eApps.cc_id = chla.dcSummary.prototype.name.replace('.','_');
      chla.dcSummary.eApps.SaveButtonAction = chla.eApps.SaveButtonBehavior.enable_disable_status_reset;
      chla.dcSummary.eApps.CSSBehaviors = new chla.eApps.CSSBehaviors();

      dcSummary.cc_id             = chla.dcSummary.eApps.cc_id;
      dcSummary.personId          = this.getProperty("personId");
      dcSummary.encounterId       = this.getProperty("encounterId");
      dcSummary.transparentSpacer = '<img src="' +
                                    chla.eApps.Vars.transparentSpacer +
                                    '" height="5px" width="17px"  >' ;
//-------------------------------------
//  RPTDATA processing
//-------------------------------------
     dcSummary.dctextnotes =  elementObj.PRLM_DC_SUMMARY.replace(/\\par/g, '\n');
    //-------------------------------------
    //  CC DIV sections HTML generations ( TEMPLATE MERGE )
    //-------------------------------------
    compContent = chla.eApps.Funcs.parseTemplate(dcSummary_Tmpl.join('') ,dcSummary);
    //-------------------------------------
    //  CC DIV Rendering
    //-------------------------------------
    chla.eAppsUtil.Logger.LogWarn("<textarea rows='3' style='width:99%;'> dcSummary <br/> " +
                        chla.eApps.Funcs.HtmlLogFormatter(compContent) +'</textarea>');
    target.innerHTML = compContent;
//-------------------------------------
//  CC HTML/CSS behaviours
//-------------------------------------
    chla.dcSummary.eApps.CCLreqObjSave = null;

    chla.dcSummary.eApps.CSSBehaviors = new chla.eApps.CSSBehaviors();
    chla.dcSummary.eApps.HoverDataFormater =  function (sourceData) {
          wrkValue = '<span style="font-weight:bold;">Update History</span></br>';
          wrkCnt = sourceData.UPDT_CNT ;

          for (var i = 0; i < wrkCnt; i ++) {
                  wrkValue += sourceData.UPDT_LIST[i].UPDT_PRSNL ;
                  wrkValue += ' on ';
                  wrkValue += sourceData.UPDT_LIST[i].UPDT_DT_TM ;
                  wrkValue +=  "</br>" ;
         };
          return wrkValue ;
     };

    chla.dcSummary.eApps.CSSBehaviors.InitPopUpsDiv(
                   chla.dcSummary.eApps.HoverDataFormater( elementObj),
                   'button#dcSummaryNtsSave','T');

    $("#dcSummaryNtsText").on( "click", function () {
       chla.dcSummary.eApps.SaveButtonAction('#dcSummaryNtsSave', 'ENABLE');
    } );

    $("#dcSummaryNtsSave").on( "click", function () {
           var arrWrk=[];
           textStr =  $('#dcSummaryNtsText').val();
           arrWrk.push('^MINE^,');
           arrWrk.push( 'value($VIS_Encntrid$),^');
           arrWrk.push( textStr.replace(/\n/g,'\\par '));
           arrWrk.push( '^, value($USR_PersonID$)');
           chla.dcSummary.eApps.CCLparmsSave = arrWrk.join('');

           if (chla.dcSummary.eApps.CCLreqObjSave == null){
               chla.dcSummary.eApps.CCLreqObjSave = new chla.eApps.CCLRequest.BtnSaveBehavior();
               chla.dcSummary.eApps.CCLreqObjSave.ObjectName='OBJ_chla.dcSummary.eApps.CCLreqObjSave';
               chla.dcSummary.eApps.CCLreqObjSave.BtnSaveBehaviorFunc = chla.dcSummary.eApps.SaveButtonAction ;
               chla.dcSummary.eApps.CCLreqObjSave.CallBackOperation = function(responseData){
                                                    chla.dcSummary.eApps.CSSBehaviors.hoverContent =
                                                         chla.dcSummary.eApps.HoverDataFormater(responseData);
                                                   };
            };

            chla.dcSummary.eApps.CCLreqObjSave.DataTransfer( chla.dcSummary.eApps.CCLreqObjSave,
                                                          'chla_ca_mp_cc_ins_dc_summary',
                                                            chla.dcSummary.eApps.CCLparmsSave  ,
                                                             '#dcSummaryNtsSave');
        });

    chla.dcSummary.eApps.SaveButtonAction('#dcSummaryNtsSave', 'RESET');
}

//::===========================================================================
//:: CC - End of Sections -----------------------------------------------------
//::---------------------------------------------------------------------------


chla.spacer1 = function () { };
chla.spacer1.prototype = new MPage.Component();
chla.spacer1.prototype.constructor = MPage.Component;
chla.spacer1.prototype.base = MPage.Component.prototype;
chla.spacer1.prototype.name = "chla.spacer1";

chla.spacer1.prototype.render = function () {
    var component = this,
        elementObj,
        target,
        compContent;
 target = component.getTarget();
 target.innerHTML = '<h2>Spacer 1</h2>';
}
chla.spacer2 = function () { };
chla.spacer2.prototype = new MPage.Component();
chla.spacer2.prototype.constructor = MPage.Component;
chla.spacer2.prototype.base = MPage.Component.prototype;
chla.spacer2.prototype.name = "chla.spacer2";

chla.spacer2.prototype.render = function () {
    var component = this,
        elementObj,
        target,
        compContent;
 target = component.getTarget();
 target.innerHTML = '<h2>Spacer 2</h2>';
}
chla.spacer3 = function () { };
chla.spacer3.prototype = new MPage.Component();
chla.spacer3.prototype.constructor = MPage.Component;
chla.spacer3.prototype.base = MPage.Component.prototype;
chla.spacer3.prototype.name = "chla.spacer3";

chla.spacer3.prototype.render = function () {
    var component = this,
        elementObj,
        target,
        compContent;
 target = component.getTarget();
 target.innerHTML = '<h2>Spacer 2</h2>';
}

chla.ccwrkspace = function () { };
chla.ccwrkspace.prototype = new MPage.Component();
chla.ccwrkspace.prototype.constructor = MPage.Component;
chla.ccwrkspace.prototype.base = MPage.Component.prototype;
chla.ccwrkspace.prototype.name = "chla.ccwrkspace";

chla['ccwrkspace'].prototype.render = function() {
    'use strict';
    var  component = this,
        /**
         * variable to contain working object for cc rendering
         */
        ccwrkspace;
    /**
     *  initialize the variable with the CC Module base class
     */
    ccwrkspace  = chla.eAppsClass.gCcModule.createCcModuleCls.neo();
    /*----------------------------------------------------*/
    /* Replace these functions with this CC specific code.*/
    /*----------------------------------------------------*/
    /**
     * Parent function for processing initialization specifically for the CC
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    ccwrkspace.ccnsp.postInit  = function (aObjNSbase, aObjCcBase) {
    };
    /**
     * Parent function for processing the JSON data received for display
     * Output of this function will be an object tha contains data items to be used in the presentation construction process.
     *  All data validation and transformations are done in this function
     *
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @param aDtoData {object} Dto object specifically defined by RPTDATA response from CCL request
     * @returns {*} {object} retVal is a CC specifically defined DTO for transferring data to presentation processing
     */
    ccwrkspace.ccnsp.processData = function (aObjNSbase, aObjCcBase,aDtoData) {
        var retVal = {};
        return retVal;
    };

    /**
     * Parent function for construction of the UI
     * Output of the function will be an object contain a string of the total html to be render for this component
     *   All necessary presentation formation and transformation are done in this function.
     *
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @param aDtoUI {object} aDtoData object
     * @returns {object} retVal is a CC specifically defined DTO for transferring data to presentation rendering processing
     */
    ccwrkspace.ccnsp.processUI   = function (aObjNSbase, aObjCcBase,aDtoUI) {
        var arrContent= [
                    '<div id="<#=cc_id#>" class="eapps_CC">',
                    '<p style="padding:5px 10px ;">Custom-Components.js Version:&nbsp;',
                    chla.eApps.Settings.version,
                    ' &nbsp;&nbsp; c_Date:&nbsp;',
                    chla.eApps.Settings.c_Date,
                    '<br/>&nbsp;&nbsp; c_Location:&nbsp;',
                    chla.eApps.Settings.c_Location,
                    '<br/>&nbsp;&nbsp; global imgpath:&nbsp;',
                    chla.global.imgPath,
                    '<br/>&nbsp;&nbsp; c_Comment:&nbsp;',
                    chla.eApps.Settings.c_Comment
                    ];
        return chla.eAppsClass.prototype.gFuncs.parseTemplate(arrContent.join(''), { "cc_id": aObjCcBase.cc_id});
    };
    /**
     * Parent function for processing functions after the UI has been render to the DOM
     *   All css,dom behaviors to be associated with UI components is handled in this function.
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    ccwrkspace.ccnsp.processPostCcInstance  = function (aObjNSbase, aObjCcBase) {};

    /**
     *  Call to build CC and to render to CC framework
     */
    ccwrkspace.ccnsp.ProcessCtl(ccwrkspace.ccnsp,component);

};
/*======   REQUIRED FILE TERMINATOR INDICATOR ======*/

/*======   REQUIRED FILE TERMINATOR INDICATOR ======*/
chla['btiron'].prototype.render = function() {
    'use strict';
    var  component = this,
         /**
          * variable to contain working object for cc rendering
          */
         btiron;
    /**
     *  initialize the variable with the CC Module base class
     */
    btiron  = chla.eAppsClass.gCcModule.createCcModuleCls.neo();
    /*----------------------------------------------------*/
    /* Replace these functions with this CC specific code.*/
    /*----------------------------------------------------*/
    /**
     * Parent function for processing initialization specifically for the CC
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    btiron.ccnsp.postInit  = function (aObjNSbase, aObjCcBase) {
    };
    /**
     * Parent function for processing the JSON data received for display
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @returns {*} retVal is fully process data for content body
     */
    btiron.ccnsp.processData = function (aObjNSbase, aObjCcBase) {
        var objRetValue = {},
            boolUseDummyData = (typeof aObjCcBase.CCcfg.DummyData !== 'undefined'? aObjCcBase.CCcfg.DummyData: false),
            objData;
        if(boolUseDummyData){
            objData = chla.eAppsCCFrmWrk[aObjCcBase.CCcfg.cclProgram.toUpperCase()].RPTDATA;
        }else {
            objData = aObjCcBase.eApps.getJsonDataDto(aObjCcBase);
        }
        objRetValue.TOTBLDLOSS = objData.RESULT_VAL;
        objRetValue.Units = objData.RESULT_UNITS;
        objRetValue.DTTM = objData.RESULT_DT_TM;
         return objRetValue;
    };
    /**
     * Parent function for construction of the UI
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @returns {string} retVal is html formatted content body of CC
     */
    btiron.ccnsp.processUI   = function (aObjNSbase, aObjCcBase) {
        var arrRetValue = [],
            arrWrk=[],
            strWrk,
            dataDto;
        dataDto = aObjCcBase.eApps.getDataDto(aObjCcBase);
        arrWrk.push(chla.global.imgPath );
        if (dataDto.TOTBLDLOSS === ''){
            strWrk = '<span style="color:lightgrey;font-size: 16px;">Information Unavailable</span>';
        }else {
            arrWrk.length = 0;
            arrWrk.push(dataDto.TOTBLDLOSS);
            arrWrk.push(' ');
            arrWrk.push(dataDto.Units);
            arrWrk.push(' <span style="color:black; font-size: 9px;">as of</span> ');
            arrWrk.push(dataDto.DTTM);
            strWrk = arrWrk.join('');
        }
        arrRetValue.length = 0;
        arrRetValue.push('<br/>');
        arrRetValue.push('<table class="table" ><tr><td>&nbsp;</td>');
        arrRetValue.push('<td><span style="font-weight:700;">Total Blood Loss</span><br/>&nbsp; </td>');
        arrRetValue.push('<td><span style="color:blue;font-size:16px;"> ');
        arrRetValue.push(strWrk);
        arrRetValue.push(' </span></td>');
        arrRetValue.push('</tr></table>');
		arrRetValue.push('<br><p>Cumulative PRBC Volume is derived from Nursing EMR documentation.  It may be underestimated with PRBC transfusion prior to August 2017 and PRBC administered outside of CHLA</p>');
        //aObjCcBase.eApps.mainSectionStyle = 'height:230px;';
        return arrRetValue.join('');
    };
    /**
     * Parent function for processing functions after the UI has been render to the DOM
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    btiron.ccnsp.processPostCcInstance  = function (aObjNSbase, aObjCcBase) {};

    /**
     *  Call to build CC and to render to CC framework
     */
    btiron.ccnsp.ProcessCtl(btiron.ccnsp,component);

};
/*======   REQUIRED FILE TERMINATOR INDICATOR ======*/
// ::===========================================================================
// :: CC -  btrisks Module
// ::---------------------------------------------------------------------------
chla['btrisks'].prototype.render = function() {
    'use strict';
    var  component = this,
        /**
         * variable to contain working object for cc rendering
         */
        btrisks;
    /**
     *  initialize the variable with the CC Module base class
     */
    btrisks  = chla.eAppsClass.gCcModule.createCcModuleCls.neo();
    /*----------------------------------------------------*/
    /* Replace these functions with this CC specific code.*/
    /*----------------------------------------------------*/
    /**
     * Parent function for processing initialization specifically for the CC
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    btrisks.ccnsp.postInit  = function (aObjNSbase, aObjCcBase) {
    };
    /**
     * Parent function for processing the JSON data received for display
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @returns {*} retVal is fully process data for content body
     */
    btrisks.ccnsp.processData = function (aObjNSbase, aObjCcBase) {
        var objRetValue = {},
            boolUseDummyData = (typeof aObjCcBase.CCcfg.DummyData !== 'undefined'? aObjCcBase.CCcfg.DummyData: false),
            objData;
        if(boolUseDummyData){
            objData = chla.eAppsCCFrmWrk[aObjCcBase.CCcfg.cclProgram.toUpperCase()].RPTDATA;
        }else {
            objData = aObjCcBase.eApps.getJsonDataDto(aObjCcBase);
        }
        objRetValue.TOTBLDLOSS = objData.PRBC_PRE_AUG17_VOL;
        objRetValue.DTTM = objData.PRBC_PRE_AUG17_DT_TM;
        objRetValue.Units = objData.PRBC_PRE_AUG17_RESULT_UNITS;
        objRetValue.POSTTOTBLDLOSS = objData.PRBC_POST_AUG17_VOL;
        objRetValue.POSTDTTM = objData.PRBC_POST_AUG17_DT_TM;
        objRetValue.POSTUnits = objData.PRBC_POST_AUG17_RESULT_UNITS;
         return objRetValue;
        };
    /**
     * Parent function for construction of the UI
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @returns {string} retVal is html formatted content body of CC
     */
     btrisks.ccnsp.processUI   = function (aObjNSbase, aObjCcBase){
        var arrRetValue = [],
            arrWrk=[],
            strWrk,
            strWrk2,
            dataDto;
        dataDto = aObjCcBase.eApps.getDataDto(aObjCcBase);
        arrWrk.push(chla.global.imgPath );
        if (dataDto.DTTM === ''){
            strWrk = '<span style="color:grey;font-size: 14px;">Pre-Aug 27th 2017 <span style="color:transparent;">e</span>: Information Unavailable</span>';
        }else {
            arrWrk.length = 0;
            arrWrk.push('<span style="font-size: 14px;">Pre-Aug 27th 2017 <span style="color:transparent;">e</span>: ');
            arrWrk.push(dataDto.TOTBLDLOSS);
            arrWrk.push(' ');
            arrWrk.push(dataDto.Units);
            arrWrk.push(' <span style="color:black; font-size: 9px;">as of</span> ');
            arrWrk.push(dataDto.DTTM);
            strWrk = arrWrk.join('');
        }
         if (dataDto.POSTDTTM === ''){
             strWrk2 = '<span style="color:grey;font-size: 14px;">Post-Aug 27th 2017 : Information Unavailable</span>';
         }else {
             arrWrk.length = 0;
             arrWrk.push('<span style="font-size: 14px;">Post-Aug 27th 2017 : ');
             arrWrk.push(dataDto.POSTTOTBLDLOSS);
             arrWrk.push(' ');
             arrWrk.push(dataDto.POSTUnits);
             arrWrk.push(' <span style="color:black; font-size: 9px;">as of</span> ');
             arrWrk.push(dataDto.POSTDTTM);
             strWrk2 = arrWrk.join('');
         }
        arrRetValue.length = 0;
        arrRetValue.push('<br/>');
         arrRetValue.push('<div style="font-weight:700;">Cumulative PRBC Volume Transfused</span></div>');
         arrRetValue.push('<div style="text-align: left;font-size:14px;">',strWrk,'</div>');
         arrRetValue.push('<div style="text-align: left;font-size:14px;">',strWrk2,'</div>');
         arrRetValue.push('<div style="font-size:10px;color:grey;line-height:10px;"><br/>Cumulative Transfusion PRBC volume (cPRBCv) is derived by Nursing EMR documentation.  cPRBCv is accurate for inpatient blood transfusion after March 20th, 2017 and outpatient blood transfusions after August 27th 2017. cPRBCv does not currently include intraoperative blood transfusion. <br/><br/>');
         arrRetValue.push('Transfusion Iron loading (TIL) = cPRBCv - (0.25 * Frank Blood Loss Volume) * (1 mg iron/1 ml PRBC).  TIL is a risk factor for iron organ toxicity.  Different patient groups have different risks of iron organ toxicity.<br/><br/>');
         arrRetValue.push('Once cPRBCv is > 100ml/kg or TIL > 100mg Iron/kg, consider ordering Ferritin, Serum Iron, TIBC, CRP, ALT, CBC, and Reticulocyte count, and discussing case with Hematology.</div>');
         return arrRetValue.join('');
    };
    /**
     * Parent function for processing functions after the UI has been render to the DOM
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    btrisks.ccnsp.processPostCcInstance  = function (aObjNSbase, aObjCcBase) {};

    /**
     *  Call to build CC and to render to CC framework
     */
    btrisks.ccnsp.ProcessCtl(btrisks.ccnsp,component);

};
/*======   REQUIRED FILE TERMINATOR INDICATOR ======*/
chla['btNotes'].prototype.render = function() {
    'use strict';
    var  component = this,
         /**
          * variable to contain working object for cc rendering
          */
         btNotes;
    /**
     *  initialize the variable with the CC Module base class
     */
    btNotes  = chla.eAppsClass.gCcModule.createCcModuleCls.neo();
    /*----------------------------------------------------*/
    /* Replace these functions with this CC specific code.*/
    /*----------------------------------------------------*/
    /**
     * Parent function for processing initialization specifically for the CC
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    btNotes.ccnsp.postInit  = function (aObjNSbase, aObjCcBase) {
    };
    /**
     * Parent function for processing the JSON data received for display
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @returns {*} retVal is fully process data for content body
     */
    btNotes.ccnsp.processData = function (aObjNSbase, aObjCcBase) {
        var retVal= {
                "TX_MED_NOTES": [],
                "TX_SERV_NOTES": [],
                "TX_REACTION_REPORT": [],
                "TX_NURSING_NOTES": [ ]
            },
            encntrID = aObjCcBase.getProperty("encounterId"),
            personID = aObjCcBase.getProperty("personId"),
            DtoJsonData,
            boolUseDummyData = (typeof aObjCcBase.CCcfg.DummyData !== 'undefined'? aObjCcBase.CCcfg.DummyData: false);
        if(boolUseDummyData){
            DtoJsonData = chla.eAppsCCFrmWrk[aObjCcBase.CCcfg.cclProgram.toUpperCase()].RPTDATA;
        }else {
            DtoJsonData = aObjCcBase.eApps.getJsonDataDto(aObjCcBase);
        }

        if (DtoJsonData.TX_MED_NOTES.length > 0 ){
            DtoJsonData.TX_MED_NOTES.forEach(
                function (item) {
                    retVal.TX_MED_NOTES.push(      {
                        encntrID: item.ENCNTR_ID ,
                        personID: personID ,
                        NoteID: item.NOTE,
                        NoteDt: item.DATE,
                        NoteEvtID: item.EVENT_ID,
                        Signby: item.SIGNING_PRSNL
                    });
                }
            )
        }

        if (DtoJsonData.TX_SERV_NOTES.length > 0 ){
            DtoJsonData.TX_SERV_NOTES.forEach(
                function (item) {
                    retVal.TX_SERV_NOTES.push(      {
                        encntrID: item.ENCNTR_ID ,
                        personID: personID ,
                        NoteID: item.NOTE,
                        NoteDt: item.DATE,
                        NoteEvtID: item.EVENT_ID,
                        Signby: item.SIGNING_PRSNL
                    });
                }
            )
        }
        if (DtoJsonData.TX_REACTION_REPORT.length > 0 ){
            DtoJsonData.TX_REACTION_REPORT.forEach(
                function (item) {
                    retVal.TX_REACTION_REPORT.push(      {
                        encntrID: item.ENCNTR_ID ,
                        personID: personID ,
                        NoteID: item.NOTE,
                        NoteDt: item.DATE,
                        NoteEvtID: item.EVENT_ID,
                        Signby: item.SIGNING_PRSNL
                    });
                }
            )
        }
        if (DtoJsonData.TX_NURSING_NOTES.length > 0 ){
            DtoJsonData.TX_NURSING_NOTES.forEach(
                function (item) {
                    retVal.TX_NURSING_NOTES.push(      {
                        encntrID: item.ENCNTR_ID ,
                        personID: personID ,
                        NoteID: item.NOTE,
                        NoteDt: item.DATE,
                        NoteEvtID: item.EVENT_ID,
                        Signby: item.SIGNING_PRSNL
                    });

                }
            );

        }
        return retVal;
    };

    /**
     * Parent function for construction of the UI
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object                              <strong></strong>
     * @returns {string} retVal is html formatted content body of CC
     */
    btNotes.ccnsp.processUI   = function (aObjNSbase, aObjCcBase) {
        var sectionObj     = aObjNSbase.gSectionHeaderCtlCls.neo(),
            arrWrk =[],
            arrTbl = [
                '<table><tr><th style="font-weight:800;width:300px;">&nbsp;</th><th style="">Signed Date/Time</th></tr>',
                '</table>'
            ],
            rwtmpl = [
                '<tr>',
                '',
                '',
                '<td STYLE="FONT-SIZE:10PX;" ><#=NteDt#></td></tr>'
            ],
            retVal  = [],
            DtoData   = aObjCcBase.eApps.getDataDto(aObjCcBase);
        arrWrk.length = 0;
        arrWrk.push(arrTbl[0]);
        DtoData.TX_MED_NOTES.forEach(
            function (item) {
                var linkStyle = (item.NoteDt !== ''?'COLOR:Blue;"':''),
                    iNoteDt  =  ( item.NoteDt !== ''?item.NoteDt :'Note Not Available');
                    rwtmpl[1]='<td><a onclick="chla.eApps.gFuncs.ReadOnlyMPageUtils(&quot;POWERNOTE&quot;,<#=personId#>,<#=encounterId#>,<#=EVENT_ID#>);">';
                    rwtmpl[2]='<SPAN STYLE="FONT-SIZE:12PX;<#=linkStyle#>;text-decoration:none;"><#=NteID#></span></a></td>';
                    rwtmpl[3]='<td STYLE="FONT-SIZE:10PX;" ><#=NteDt#></td></tr>';
                arrWrk.push(aObjNSbase.gFuncs.parseTemplate(rwtmpl.join(''), {
                        encounterId: item.encntrID ,
                        personId: item.personID,
                        EVENT_ID: item.NoteEvtID,
                        NteID: item.NoteID,
                        NteDt: iNoteDt,
                        linkStyle: linkStyle
                    })
                );
            });
        if (DtoData.TX_MED_NOTES.length === 0){
            arrWrk.push('<tr><td colspan="2" STYLE="FONT-SIZE:10PX;text-align: center;" > No Data Available</td></tr>')
        }
        arrWrk.push(arrTbl[1]);
        sectionObj.initValues({
            idLabel      : 'btNotes1',
            TLabel1      : 'Transfusion Medicine Notes',
            SectionClosed: 'OPEN',
            SectionCnt   : '',
            SectionCntVal: '',
            ContentBody  : arrWrk.join(''),
            TemplateType : 'H5',
            CustIcon     : 'None'
        });
        retVal.push(sectionObj.generateHTML());
        arrWrk.length = 0;
        arrWrk.push(arrTbl[0]);
        DtoData.TX_SERV_NOTES.forEach(
            function (item) {
                var linkStyle = (item.NoteDt !== ''?'COLOR:Blue;"':''),
                    iNoteDt  =  ( item.NoteDt !== ''?item.NoteDt :'Note Not Available');
                    rwtmpl[1]='<td><a onclick="chla.eApps.gFuncs.ReadOnlyMPageUtils(&quot;POWERNOTE&quot;,<#=personId#>,<#=encounterId#>,<#=EVENT_ID#>);">';
                    rwtmpl[2]='<SPAN STYLE="FONT-SIZE:12PX;<#=linkStyle#>;text-decoration:none;"><#=NteID#></span></a></td>';
 					rwtmpl[3]='<td><span style="color:#7C7C7C;font-size: 9px;"><#=NteDt#></span></td></tr>';
	                arrWrk.push(aObjNSbase.gFuncs.parseTemplate(rwtmpl.join(''), {
                        encounterId: item.encntrID ,
                        personId: item.personID,
                        EVENT_ID: item.NoteEvtID,
                        NteID: item.NoteID,
                        NteDt: iNoteDt,
                        linkStyle: linkStyle
                    })
                )
            });
        if (DtoData.TX_SERV_NOTES.length === 0){
            arrWrk.push('<tr><td colspan="2" STYLE="FONT-SIZE:10PX;text-align: center;" > No Data Available</td></tr>')
        }
        arrWrk.push(arrTbl[1]);
        sectionObj.initValues({
            idLabel      : 'btNotes2',
            TLabel1      : 'Transfusion Service Notes',
            SectionClosed: 'OPEN',
            SectionCnt   : '',
            SectionCntVal: '',
            ContentBody  : arrWrk.join(''),
            TemplateType : 'H5',
            CustIcon     : 'None'
        });
        retVal.push(sectionObj.generateHTML());
        arrWrk.length = 0;
        arrWrk.push(arrTbl[0]);
        DtoData.TX_REACTION_REPORT.forEach(
            function (item) {
                var linkStyle = (item.NoteDt !== ''?'COLOR:Blue;"':''),
                    iNoteDt  =  ( item.NoteDt !== ''?item.NoteDt :'Note Not Available');
                    rwtmpl[1]='<td><a onclick="chla.eApps.gFuncs.ReadOnlyMPageUtils(&quot;POWERNOTE&quot;,<#=personId#>,<#=encounterId#>,<#=EVENT_ID#>);">';
                    rwtmpl[2]='<SPAN STYLE="FONT-SIZE:12PX;<#=linkStyle#>;text-decoration:none;"><#=NteID#></span></a></td>';
                    rwtmpl[3]='<td STYLE="FONT-SIZE:10PX;" ><#=NteDt#></td></tr>';
                arrWrk.push(aObjNSbase.gFuncs.parseTemplate(rwtmpl.join(''), {
                        encounterId: item.encntrID ,
                        personId: item.personID,
                        EVENT_ID: item.NoteEvtID,
                        NteID: item.NoteID,
                        NteDt: iNoteDt,
                        linkStyle: linkStyle
                    })
                )
            });
        if (DtoData.TX_REACTION_REPORT.length === 0){
            arrWrk.push('<tr><td colspan="2" STYLE="FONT-SIZE:10PX;text-align: center;" > No Data Available</td></tr>')
        }
        arrWrk.push(arrTbl[1]);
        sectionObj.initValues({
            idLabel      : 'btNotes3',
            TLabel1      : 'Nursing Transfusion Notes',
            SectionClosed: 'OPEN',
            SectionCnt   : '',
            SectionCntVal: '',
            ContentBody  : arrWrk.join(''),
            TemplateType : 'H5',
            CustIcon     : 'None'
        });
        retVal.push(sectionObj.generateHTML());
        arrWrk.length = 0;
        arrWrk.push(arrTbl[0]);
        DtoData.TX_NURSING_NOTES.length = 0;
        DtoData.TX_NURSING_NOTES.forEach(
            function (item) {
                var linkStyle = (item.NoteDt !== ''?'COLOR:Blue;"':''),
                    iNoteDt  =  ( item.NoteDt !== ''?item.NoteDt :'Note Not Available');
                    rwtmpl[1]='<td><a onclick="chla.eApps.gFuncs.ReadOnlyMPageUtils(&quot;POWERNOTE&quot;,<#=personId#>,<#=encounterId#>,<#=EVENT_ID#>);">';
                    rwtmpl[2]='<SPAN STYLE="FONT-SIZE:12PX;<#=linkStyle#>;text-decoration:none;"><#=NteID#></span></a></td>';
                    rwtmpl[3]='<td STYLE="FONT-SIZE:10PX;" ><#=NteDt#></td></tr>';
                arrWrk.push(aObjNSbase.gFuncs.parseTemplate(rwtmpl.join(''), {
                        encounterId: item.encntrID ,
                        personId: item.personID,
                        EVENT_ID: item.NoteEvtID,
                        NteID: item.NoteID,
                        NteDt: iNoteDt,
                        linkStyle: linkStyle
                    })
                )
            });

        if (DtoData.TX_NURSING_NOTES.length === 0){
            arrWrk.push('<tr><td colspan="2" STYLE="FONT-SIZE:10PX;text-align: center;" > No Data Available</td></tr>')
        }
        arrWrk.push(arrTbl[1]);
        sectionObj.initValues({
            idLabel      : 'btNotes4',
            TLabel1      : 'Apheresis Service Notes',
            SectionClosed: 'OPEN',
            SectionCnt   : '',
            SectionCntVal: '',
            ContentBody  : arrWrk.join(''),
            TemplateType : 'H5',
            CustIcon     : 'None'
        });
        retVal.push(sectionObj.generateHTML());
        aObjCcBase.eApps.mainSectionStyle = 'height:230px;';
        retVal.push('</table>');
        return retVal.join('');
    };
    /**
     * Parent function for processing functions after the UI has been render to the DOM
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    btNotes.ccnsp.processPostCcInstance  = function (aObjNSbase, aObjCcBase) {};

    /**
     *  Call to build CC and to render to CC framework
     */
    btNotes.ccnsp.ProcessCtl(btNotes.ccnsp,component);

};
/*======   REQUIRED FILE TERMINATOR INDICATOR ======*/
chla['btpremeds'].prototype.render = function() {
    var  component = this,
        /**
         * variable to contain working object for cc rendering
         */
        btpremeds;
    /**
     *  initialize the variable with the CC Module base class
     */
    btpremeds  = chla.eAppsClass.gCcModule.createCcModuleCls.neo();
    /*----------------------------------------------------*/
    /* Replace these functions with this CC specific code.*/
    /*----------------------------------------------------*/
    /**
     * Parent function for processing initialization specifically for the CC
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    btpremeds.ccnsp.postInit  = function (aObjNSbase, aObjCcBase) {
    };
    /**
     * Parent function for processing the JSON data received for display
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @returns {*} retVal is fully process data for content body
     */
    btpremeds.ccnsp.processData = function (aObjNSbase, aObjCcBase) {
        var objRetValue;
        aObjCcBase.eApps.processData = function (aObjNSbase, aObjCcBase) {
            var boolUseDummyData = (typeof aObjCcBase.CCcfg.DummyData !== 'undefined'? aObjCcBase.CCcfg.DummyData: false),
                objData,
                objRetValue2;
            if(boolUseDummyData){
                objData = chla.eAppsCCFrmWrk[aObjCcBase.CCcfg.cclProgram.toUpperCase()].RPTDATA;
            }else {
                objData = aObjCcBase.eApps.getJsonDataDto(aObjCcBase);
            }
            objRetValue2 = {
                LAST_TX_LIST: [],
                HIST_TX_LIST: []
            };
            objData.LAST_TX_LIST.forEach(
                function (item) {
                    if (item.PREMED_LIST.length === 0) {
                        objRetValue2.LAST_TX_LIST.push({
                            BLDPRD : item.BLOOD_PRODUCT_TYPE + ' ' + item.DOSAGE + ' mL',
                            TXDTTM : item.TX_START_DATE,
                            DRGDTTM: '',
                            DRG    : '',
                            DOSAGE : '',
                            UNIT   : ''
                        });
                    } else {
                        item.PREMED_LIST.forEach(
                            function (value) {
                                objRetValue2.LAST_TX_LIST.push({
                                    BLDPRD : item.BLOOD_PRODUCT_TYPE + ' ' + item.DOSAGE + ' mL',
                                    TXDTTM : item.TX_START_DATE,
                                    DRGDTTM: value.DATE,
                                    DRG    : value.PREMED,
                                    DOSAGE : value.DOSAGE.replace('.000000', ''),
                                    UNIT   : value.UNIT
                                });
                            }
                        )
                    }
                }
            );
            objData.HIST_TX_LIST.forEach(
                function (item) {
                     if (item.PREMED_LIST.length === 0) {
                        objRetValue2.HIST_TX_LIST.push({
                            BLDPRD : item.BLOOD_PRODUCT_TYPE + ' ' + item.DOSAGE + ' mL',
                            TXDTTM : item.TX_START_DATE,
                            DRGDTTM: '',
                            DRG    : '',
                            DOSAGE : '',
                            UNIT   : ''
                        });
                    } else {
                      item.PREMED_LIST.forEach(
                          function (value) {
                              objRetValue2.HIST_TX_LIST.push({
                                  BLDPRD : item.BLOOD_PRODUCT_TYPE + ' ' + item.DOSAGE + ' mL',
                                  TXDTTM : item.TX_START_DATE,
                                  DRGDTTM: value.DATE,
                                  DRG    : value.PREMED,
                                  DOSAGE : value.DOSAGE.replace('.000000',''),
                                  UNIT   : value.UNIT
                              });
                          }
                      )
                    }
                }
            );
            return objRetValue2;
        };
        objRetValue = aObjCcBase.eApps.processData(aObjNSbase, aObjCcBase);
        return objRetValue;
    };

    /**
     * Parent function for construction of the UI
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @returns {string} retVal is html formatted content body of CC
     */
    btpremeds.ccnsp.processUI   = function (aObjNSbase, aObjCcBase) {
        var retVal = [],
            arrWrk = [],
            DtoWrk,
            DtoData = aObjCcBase.eApps.getDataDto(aObjCcBase);
        aObjCcBase.eApps.processUI = {};
       /**
         *
         *
         * @param aCtlID
         * @param aObjCfg
         *      {
         *       id:'',
         *       lbl: '',
         *       value:''
         *       }
         * @param aObjCcBase
         * @returns {string}
         */
        aObjCcBase.eApps.processUI.createVariableTRangeInput = function (aCtlID,aObjCfg,aObjCcBase) {
            var HtmlCtl = [
                '<div class="<#=ctlid#>" style="float:right; display:table-row;"><span style="font-size:11px;">Last&nbsp;</span> '
                ],
                button =  '<div id="<#=btnID#>" class="eappsCssBtn eappsCssBtn-DtRange <#=active#>" style="float:right;display:table-row;"><#=btnLbl#></div>',
                objNSBase = chla.eAppsClass.neo();
            aObjCfg.optvalues.forEach(
                function (item,index) {
                    HtmlCtl.push(objNSBase.gFuncs.parseTemplate(button,{
                        btnID: (aObjCcBase.eApps.cc_id + '_' + item.id + '_' + item.value),
                        btnLbl: item.lbl,
                        active: item.select
                }));
                }
            );

            HtmlCtl.push('</div><div class="chla_premed_DTRangeLoadCCL1spacer',aCtlID,'" style="height: 22px;">&nbsp;</div>');
            return  objNSBase.gFuncs.parseTemplate(HtmlCtl.join(''),{ctlid: aCtlID});
        };
        aObjCcBase.eApps.processUI.createDTRangeLoadCCL1_Buttons= function (aObjNSbase,aObjCcBase) {
            return  aObjCcBase.eApps.processUI.createVariableTRangeInput('curTx1', {
                    optvalues: [
                        {
                         id    : 'pb1',
                            lbl   : '90 Minutes',
                            value : '90m',
                            select: ''

                        }, {
                            id    : 'pb1',
                            lbl   : '60 Minutes',
                            value : '60m',
                            select: ''

                        }, {
                            id    : 'pb1',
                            lbl   : '30 Minutes',
                            value : '30m',
                            select: ''

                        }
                    ]
                },
                aObjCcBase
            );
        };
        aObjCcBase.eApps.processUI.createDTRangeLoadCCL2_Buttons= function (aObjNSbase,aObjCcBase) {
            return  aObjCcBase.eApps.processUI.createVariableTRangeInput('curTx2', {
                    optvalues: [
                        {
                            id    : 'pb2',
                            lbl   : '90 Minutes',
                            value : '90m',
                            select: ''
                        }, {
                            id    : 'pb2',
                            lbl   : '60 Minutes',
                            value : '60m',
                            select: ''
                        }, {
                            id    : 'pb2',
                            lbl   : '30 Minutes',
                            value : '30m',
                            select: ''
                        }

                    ]
                },
                aObjCcBase
            );
        };
        /**
         *
         * @param aObjNSbase
         * @param aObjCsbase
         * @param DtoData
         * @returns {string}
         */
        aObjCcBase.eApps.processUI.createCurrentPreMedDataSection = function (aObjNSbase,aObjCsbase,DtoData) {
            var arrWrk = [],
                DtoWrk = {};
            /**
             *
             * @param aObjNSbase
             * @param aDataDto
             * @returns {{sectID: (string|*|string), sectTitle: (string|string), contentBody: string}|*}
             */
            function formatCurrentPreMedData(aObjNSbase,aDataDto) {
                var rowTmpl= [
                        '<tr class="<#=ODDFLAG#>">',
                        '<td style="font-size: 9px;line-height:10px;"><#=BLDPD#></td>',
                        '<td style="font-size: 9px;line-height:10px;"><#=TX_DTTM#></td>',
                        '<td style="font-size: 9px;line-height:10px;"><#=DRG_DTTM#></td>',
                        '<td style="font-size: 9px;line-height:10px;"><#=DRUGLBL#></td>',
                        '<td style="font-size: 9px;line-height:10px;"> <#=AMTDOSAGE#> <#=UNITLBL#></td></tr>'
                    ],
                    arrWrk =  ['<table id="CurrentPreMedData"><tbody><th style="width:25%;">Blood Product</th><th style="width:15%;">Tx Dt Tm</th><th style="width:15%;">Drug Dt Tm</th><th style="width:25%;">Drug</th><th style="width:10%;">Dosage</th></tr>'];
                aDataDto.forEach(
                    function (item,index){
                        if (item.DOSAGE === ''){
                            arrWrk.push(aObjNSbase.gFuncs.parseTemplate(rowTmpl.join(''), {
                                ODDFLAG: (index % 2 === 0? '':'odd'),
                                BLDPD       : item.BLDPRD,
                                TX_DTTM     : item.TXDTTM,
                                DRG_DTTM    : '',
                                DRUGLBL     : 'No Data Available',
                                AMTDOSAGE   : '',
                                UNITLBL     : ''
                            }));
                        }else {
                            arrWrk.push(aObjNSbase.gFuncs.parseTemplate(rowTmpl.join(''), {
                                ODDFLAG  : (index % 2 === 0 ? '' : 'odd'),
                                BLDPD    : item.BLDPRD,
                                TX_DTTM  : item.TXDTTM,
                                DRG_DTTM : item.DRGDTTM,
                                DRUGLBL  : item.DRG,
                                AMTDOSAGE: item.DOSAGE,
                                UNITLBL  : item.UNIT
                            }));
                        }
                    }
                );
                arrWrk.push('</tbody></table>');
                return arrWrk.join('');
            }
            return formatCurrentPreMedData(aObjNSbase,DtoData);
        };
        /**
         *
         * @param aObjNSbase
         * @param aObjCsBase
         * @param aDtoData
         * @returns {string}
         */
        aObjCcBase.eApps.processUI.createHistoricPreMedDataSection = function (aObjNSbase,aObjCsBase,aDtoData) {
            /**
             *
             * @param aObjNSbase {object}
             * @param aDataDto {object}
             * @returns {string}
             */
            function formatHistoricPreMedData(aObjNSbase,aDataDto) {
                var arrRetVal = ['<table id="HistoricPreMedData"><tbody><th style="width:25%;">Blood Product</th><th style="width:10%;">Tx Dt Tm</th><th style="width:10%;">Drug Dt Tm</th><th style="width:25%;">Drug</th><th style="width:10%;">Dosage</th></tr>'];
                aDataDto.forEach(
                    /**
                     *
                     * @param preMedItem
                     * @param index
                     */
                     function (preMedItem,index) {
                        var rowTmpl= [
                                '<tr class="<#=ODDFLAG#>">',
                                '<td style="font-size: 9px;line-height:10px;"><#=BLDPD#></td>',
                                '<td style="font-size: 9px;line-height:10px;"><#=TX_DTTM#></td>',
                                '<td style="font-size: 9px;line-height:10px;"><#=DRG_DTTM#></td>',
                                '<td style="font-size: 9px;line-height:10px;"><#=DRUGLBL#></td>',
                                '<td style="font-size: 9px;line-height:10px;">&nbsp;&nbsp;<#=AMTDOSAGE#> <#=UNITLBL#></td></tr>'
                            ],
                            strRetVal;
                        if (preMedItem.DOSAGE === ''){
                            strRetVal = aObjNSbase.gFuncs.parseTemplate(rowTmpl.join(''), {
                                ODDFLAG: (index % 2 === 0? '':'odd'),
                                BLDPD       : preMedItem.BLDPRD,
                                TX_DTTM     : preMedItem.TXDTTM,
                                DRG_DTTM    : '',
                                DRUGLBL     : 'No Data Available',
                                AMTDOSAGE   : '',
                                UNITLBL     : ''
                            });
                        }else {
                            strRetVal = aObjNSbase.gFuncs.parseTemplate(rowTmpl.join(''),{
                                ODDFLAG: (index % 2 === 0? '':'odd'),
                                BLDPD       : preMedItem.BLDPRD,
                                TX_DTTM     : preMedItem.TXDTTM,
                                DRG_DTTM    : preMedItem.DRGDTTM,
                                DRUGLBL     : preMedItem.DRG,
                                AMTDOSAGE   : preMedItem.DOSAGE,
                                UNITLBL     : preMedItem.UNIT
                            });
                        }
                        arrRetVal.push(strRetVal);
                    }
                );
                arrRetVal.push('</table>');
                return arrRetVal.join('');
            }
            return formatHistoricPreMedData(aObjNSbase, aDtoData);
        };

        retVal.push('<div id="chla_premedLbl1" style="font-size:10px;color:grey;">Pre-medication assoicated with last transfusion of each blood product type</div>');
        retVal.push(aObjCcBase.eApps.processUI.createDTRangeLoadCCL1_Buttons(aObjNSbase,aObjCcBase));
        retVal.push(aObjCcBase.eApps.processUI.createCurrentPreMedDataSection(aObjNSbase,aObjCcBase,DtoData.LAST_TX_LIST));
        retVal.push('<br/><div id="chla_premedLbl2"style="font-size:10px;color:grey;">Pre-medication associated with historical transfusions</div>');
        retVal.push(aObjCcBase.eApps.processUI.createDTRangeLoadCCL2_Buttons(aObjNSbase,aObjCcBase));
        retVal.push(aObjCcBase.eApps.processUI.createHistoricPreMedDataSection(aObjNSbase,aObjCcBase,DtoData.HIST_TX_LIST));
        aObjCcBase.eApps.mainSectionStyle = 'max-height:450px;overflow-y:scroll;';
        retVal.push('<div>&nbsp;</div>');
        retVal.push('<div style="font-size:10px;color:grey;">Febrile Non-Hemolytic Transfusion reactions (FNHTR) are associated with PRBC transfusions, occur at a rate of 1-2%, are a diagnosis of exclusion, and rarely occur with platelet or FFP transfusions.  With febrile transfusion reactions, consider getting blood cultures, with clinical concern, neutropenia, a central line, and/or platelet/FFP transfusions.</div>');
        return retVal.join('');
    };
    /**
     * Parent function for processing functions after the UI has been render to the DOM
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    btpremeds.ccnsp.processPostCcInstance  = function (aObjNSbase, aObjCcBase) {
        aObjCcBase.eApps.DTRangeLoadCCL1 = {
            objCcBase :        aObjCcBase,
            eappsCssBtnDtRange: '',
            pb1:                '',
            removeList:         [],
            cclParams:          {},
            /**
             *
             * @param aObjNSbase
             * @param aObjCcBase
             */
            setDTRangeLoadCCL1_Buttons_Handler: function(aObjNSbase, aObjCcBase) {
                var eappsCssBtnDtRange,
                    pb1,
                    arrWrk = [];
                arrWrk.push('div#');
                arrWrk.push(aObjCcBase.eApps.cc_id );
                arrWrk.push( ' div.curTx1 div.eappsCssBtn-DtRange');
                eappsCssBtnDtRange = arrWrk.join('');
                arrWrk.length = 0;
                arrWrk.push('#');
                arrWrk.push(aObjCcBase.eApps.cc_id );
                arrWrk.push('_bp1_');
                arrWrk.push( aObjCcBase.cclParams[4].replace(',m','m'));
                pb1 = arrWrk.join('');
                aObjCcBase.eApps.DTRangeLoadCCL1.eappsCssBtnDtRange = eappsCssBtnDtRange;
                aObjCcBase.eApps.DTRangeLoadCCL1.pb1 = pb1;
                aObjCcBase.eApps.DTRangeLoadCCL1.cclParams = aObjCcBase.cclParams;

                aObjCcBase.DTRangeLoadCCL1 = function (data){      //callback.call(self, JSON.parse(responseData));
                    var component = this,
                        objNSbase = chla.eAppsClass.neo(),
                        arrWrk = [],
                        DtoData;

                    component.eApps.DTRangeLoadCCL1.removeList.forEach(
                        function (item) {
                            $(item).remove();
                        }
                    );
                    component.data = data;
                    //#### data processing
                    DtoData = component.eApps.processData (objNSbase, component);
                    //#### UI processing
                    arrWrk.push(component.eApps.processUI.createDTRangeLoadCCL1_Buttons(objNSbase,component));
                    arrWrk.push(component.eApps.processUI.createCurrentPreMedDataSection(objNSbase,component,DtoData.LAST_TX_LIST));
                    $("div#chla_premedLbl1").after(arrWrk.join(''));
                    //#### post processing
                    component.eApps.DTRangeLoadCCL1.setDTRangeLoadCCL1_Buttons_Handler(objNSbase, component);
                };
                aObjCcBase.eApps.pb1 = '#' + aObjCcBase.eApps.cc_id +'_pb1_'+ aObjCcBase.cclParams[4].replace(',min','m');
                eappsCssBtnDtRange =  $('div#' + aObjCcBase.eApps.cc_id + ' div.curTx1 div.eappsCssBtn-DtRange  ');
                $( aObjCcBase.eApps.pb1).addClass('activeselect');
                eappsCssBtnDtRange.on('click', aObjCcBase.eApps.DTRangeLoadCCL1,
                    function(event){
                        var objCcBase = event.data.objCcBase,
                            DTRangeLoadCCL1 = event.data,
                            removeList = event.data.removeList,
                            cclParams = event.data.cclParams,
                            eappsCssBtnDtRange =  $(event.data.eappsCssBtnDtRange);
                        $(event.data.pb1).removeClass('activeselect');

                        event.data.pb1 = '#' + $(this).attr('id');
                        DTRangeLoadCCL1.pb1 = '#' + $(this).attr('id');
                        removeList.push(eappsCssBtnDtRange);
                        removeList.push('div#BtCurPreMedH5Sec_DivSubSec.sub-sec');
                        removeList.push($('div#' + objCcBase.eApps.cc_id + ' div.curTx1'));
                        removeList.push($('div#' + objCcBase.eApps.cc_id + ' div.chla_premed_DTRangeLoadCCL1spacercurTx1'));
                        removeList.push($('table#CurrentPreMedData'));
                        cclParams[4] = $(this).attr('id').replace('chla_btpremeds_pb1_','').replace('m',',min') ;
                        $(this).addClass('activeprocessing');
                        eappsCssBtnDtRange.off('click');
                        objCcBase.loadCcl('chla_ca_mp_cc_bt_premed_json',
                            objCcBase.cclParams,
                            objCcBase.DTRangeLoadCCL1,
                            "JSON");
                    });
            }
        };
        aObjCcBase.eApps.DTRangeLoadCCL2 = {
            objCcBase :        aObjCcBase,
            eappsCssBtnDtRange: '',
            pb2:                '',
            removeList:         [],
            cclParams:          {},
            /**
             *
             * @param aObjNSbase
             * @param aObjCcBase
             */
            setDTRangeLoadCCL2_Buttons_Handler: function (aObjNSbase, aObjCcBase) {
                var eappsCssBtnDtRange,
                    pb2,
                    arrWrk = [];
                arrWrk.push('div#');
                arrWrk.push(aObjCcBase.eApps.cc_id );
                arrWrk.push( ' div.curTx2 div.eappsCssBtn-DtRange');
                eappsCssBtnDtRange = arrWrk.join('');
                arrWrk.length = 0;
                arrWrk.push('#');
                arrWrk.push(aObjCcBase.eApps.cc_id );
                arrWrk.push('_bp2_');
                arrWrk.push( aObjCcBase.cclParams[4].replace(',m','m'));
                pb2 = arrWrk.join('');
                aObjCcBase.eApps.DTRangeLoadCCL2.eappsCssBtnDtRange = eappsCssBtnDtRange;
                aObjCcBase.eApps.DTRangeLoadCCL2.rp2 = pb2;
                aObjCcBase.eApps.DTRangeLoadCCL2.cclParams = aObjCcBase.cclParams;
                aObjCcBase.DTRangeLoadCCL2 = function (data) {      //callback.call(self, JSON.parse(responseData));
                    var component = this,
                        objNSbase = chla.eAppsClass.neo(),
                        arrWrk = [],
                        DtoData;

                    component.eApps.DTRangeLoadCCL2.removeList.forEach(
                        function (item) {
                            $(item).remove();
                        }
                    );
                    component.data = data;
                    //#### data processing
                    DtoData = component.eApps.processData (objNSbase, component);
                    //#### UI processing
                    arrWrk.push(component.eApps.processUI.createDTRangeLoadCCL2_Buttons(objNSbase,component));
                    arrWrk.push(component.eApps.processUI.createHistoricPreMedDataSection(objNSbase,component,DtoData.HIST_TX_LIST));
                    $("div#chla_premedLbl2").after(arrWrk.join(''));
                    //#### post processing
                    component.eApps.DTRangeLoadCCL2.setDTRangeLoadCCL2_Buttons_Handler(objNSbase, component);
                };
                aObjCcBase.eApps.pb2 = '#' + aObjCcBase.eApps.cc_id +'_pb2_'+ aObjCcBase.cclParams[5].replace(',min','m');
                eappsCssBtnDtRange =  $('div#' + aObjCcBase.eApps.cc_id + ' div.curTx2 div.eappsCssBtn-DtRange  ');
                $( aObjCcBase.eApps.pb2).addClass('activeselect');
                eappsCssBtnDtRange.on('click',aObjCcBase.eApps.DTRangeLoadCCL2,
                    function(event){
                        var objCcBase = event.data.objCcBase,
                            DTRangeLoadCCL2 = event.data,
                            removeList = event.data.removeList,
                            cclParams = event.data.cclParams,
                            eappsCssBtnDtRange =  $(event.data.eappsCssBtnDtRange);
                        $(event.data.pb2).removeClass('activeselect');
                        event.data.pb2 = '#' + $(this).attr('id');
                        DTRangeLoadCCL2.pb2 = '#' + $(this).attr('id');
                        removeList.push(eappsCssBtnDtRange);
                        removeList.push('div#BtHistoricH5Sec_DivSubSec.sub-sec');
                        removeList.push($('div#' + objCcBase.eApps.cc_id + ' div.curTx2'));
                        removeList.push($('div#' + objCcBase.eApps.cc_id + ' div.chla_premed_DTRangeLoadCCL1spacercurTx2'));
                        removeList.push($('table#HistoricPreMedData'));
                        cclParams[5] = $(this).attr('id').replace('chla_btpremeds_pb2_','').replace('m',',min') ;
                        $(this).addClass('activeprocessing');
                        eappsCssBtnDtRange.off('click');
                        objCcBase.loadCcl('chla_ca_mp_cc_bt_premed_json',
                            objCcBase.cclParams,
                            objCcBase.DTRangeLoadCCL2,
                            "JSON");
                    });
            }
        };

        aObjCcBase.eApps.DTRangeLoadCCL1.setDTRangeLoadCCL1_Buttons_Handler(aObjNSbase, aObjCcBase);
        aObjCcBase.eApps.DTRangeLoadCCL2.setDTRangeLoadCCL2_Buttons_Handler(aObjNSbase, aObjCcBase);
    };

    /**
     *  Call to build CC and to render to CC framework
     */
    btpremeds.ccnsp.ProcessCtl(btpremeds.ccnsp,component);

};
/*======   REQUIRED FILE TERMINATOR INDICATOR ======*/
chla['btresponse'].prototype.render = function(){
    'use strict';
    var  component = this,
         /**
          * variable to contain working object for cc rendering
          */
         btresponse;
    /**
     *  initialize the variable with the CC Module base class
     */
    btresponse  = chla.eAppsClass.gCcModule.createCcModuleCls.neo();
    /*----------------------------------------------------*/
    /* Replace these functions with this CC specific code.*/
    /*----------------------------------------------------*/
    /**
     * Parent function for processing the JSON data received for display
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @returns {object} objRetValue is fully process data for content body
     */
    btresponse.ccnsp.processData = function (aObjNSbase, aObjCcBase) {
        var objRetValue = {},
            arrWrk,
            objWrk,
            BTR_RPTDATA_CTL = {

                BTR2: {
                    LBL      : 'BLOODPRODS',
                    ITEM_DET : {
                        'CNT'   : '_PROD_CNT',
                        'GRP_ID': '_PROD_LIST',
                        'RET_ID': '_PROD_HIST'
                    },
                    ITEM_LIST :[
                        'RBC',
                        'PLT',
                        'FFP',
                        'CRYOFIBRIN'
                    ],
                    ITEM_PARAMS: {
                        'RBC': {
                            'PARAM1': 'RBC - HGB',
                            'BLOODPROD':'RBC'
                        },
                        'PLT':{
                            'PARAM1': 'Platelets - PLTE',
                            'BLOODPROD':'PLT'
                        },
                        'FFP':{
                            'PARAM1': 'FFP - INR',
                            'PARAM2': 'FFP - PTINR',
                            'BLOODPROD':'FFP'

                        },
                        'CRYOFIBRIN':{
                            'PARAM1': 'CRYO - Fibrinogen',
                            'BLOODPROD':'CRYO'
                        }
                    },
                    ITEM_DATA: [//
                        {src: 'TX_PARAM1_PRE'            , ptype:1 , getType: 'd', tgt: 'HR1_PreValue'} ,
                        {src: 'TX_PARAM1_PRE_DT_TM'      , ptype:1 , getType: 'd', tgt: 'HR1_Pre_DTTM'} ,
                        {src: 'TX_START_DT_TM'              , ptype:1 , getType: 'd', tgt: 'BLOOD_SDTTM'},
                        {src: 'TX_END_DT_TM'                , ptype:1 , getType: 'd', tgt: 'BLOOD_EDTTM'},
                        {src: '_DOSAGE'                     , ptype:1 , getType: 'p', tgt: 'BLOOD_AMT'},
                        {src: 'TX_PARAM1_POST_24_HR_AMT'    , ptype:1 , getType: 'd', tgt: 'BLOOD_HR24_AMT'}, //HR24_PreValue
                        {src: '_UNIT'                       , ptype:1 , getType: 'p', tgt: 'BLOOD_UNITS'},
                        {src: 'TX_PARAM1_POST_1_HR'         , ptype:1 , getType: 'd', tgt: 'HR1_PostValue'} ,
                        {src: 'TX_PARAM1_POST_1_HR_DT_TM'   , ptype:1 , getType: 'd', tgt: 'HR1_Post_DTTM'} ,
                        {src: 'TX_PARAM1_POST_24_HR'        , ptype:1 , getType: 'd', tgt: 'HR24_PostValue'} ,
                        {src: 'TX_PARAM1_POST_24_HR_DT_TM'  , ptype:1 , getType: 'd', tgt: 'HR24_Post_DTTM'} ,
                        {src: 'CALC_DELTA1'                 , ptype:1 , getType: 'c', tgt: 'TxfDelta1' ,src1:'TX_PARAM1_PRE', src2:'TX_PARAM1_POST_1_HR'},
                        {src: 'CALC_DELTA24'                , ptype:1 , getType: 'c', tgt: 'TxfDelta24',src1:'TX_PARAM1_PRE', src2:'TX_PARAM1_POST_24_HR'},

                        {src: 'TX_PARAM2_PRE'            , ptype:2 , getType: 'd', tgt: 'HR1_PreValue'} ,
                        {src: 'TX_PARAM2_PRE_DT_TM'      , ptype:2 , getType: 'd', tgt: 'HR1_Pre_DTTM'} ,
                        {src: 'TX_START_DT_TM'              , ptype:2 , getType: 'd', tgt: 'BLOOD_SDTTM'},
                        {src: 'TX_END_DT_TM'                , ptype:2 , getType: 'd', tgt: 'BLOOD_EDTTM'},
                        {src: '_DOSAGE'                     , ptype:2 , getType: 'p', tgt: 'BLOOD_AMT'},
                       // {src: 'TX_PARAM2_POST_24_HR_AMT'    , ptype:2 , getType: 'd', tgt: 'BLOOD_HR24_AMT'}, //HR24_PreValue
                        {src: '_UNIT'                       , ptype:2 , getType: 'p', tgt: 'BLOOD_UNITS'},
                        {src: 'TX_PARAM2_POST_1_HR'         , ptype:2 , getType: 'd', tgt: 'HR1_PostValue'} ,
                        {src: 'TX_PARAM2_POST_1_HR_DT_TM'   , ptype:2 , getType: 'd', tgt: 'HR1_Post_DTTM'} ,
                        {src: 'TX_PARAM2_POST_24_HR'        , ptype:2 , getType: 'd', tgt: 'HR24_PostValue'} ,
                        {src: 'TX_PARAM2_POST_24_HR_DT_TM'  , ptype:2 , getType: 'd', tgt: 'HR24_Post_DTTM'} ,
                        {src: 'CALC_DELTA1'                 , ptype:2 , getType: 'c', tgt: 'TxfDelta1' ,src1:'TX_PARAM2_PRE', src2:'TX_PARAM2_POST_1_HR'},
                        {src: 'CALC_DELTA24'                , ptype:2 , getType: 'c', tgt: 'TxfDelta24',src1:'TX_PARAM2_PRE', src2:'TX_PARAM2_POST_24_HR'},

                        {src: 'TX_PARAM3_PRE'            , ptype:3 , getType: 'd', tgt: 'HR1_PreValue'} ,
                        {src: 'TX_PARAM3_PRE_DT_TM'      , ptype:3 , getType: 'd', tgt: 'HR1_Pre_DTTM'} ,
                        {src: 'TX_START_DT_TM'              , ptype:3 , getType: 'd', tgt: 'BLOOD_SDTTM'},
                        {src: 'TX_END_DT_TM'                , ptype:3 , getType: 'd', tgt: 'BLOOD_EDTTM'},
                        {src: '_DOSAGE'                     , ptype:3 , getType: 'p', tgt: 'BLOOD_AMT'},
                        {src: '_UNIT'                       , ptype:3 , getType: 'p', tgt: 'BLOOD_UNITS'},
                        {src: 'TX_PARAM3_POST_1_HR'         , ptype:3 , getType: 'd', tgt: 'HR1_PostValue'} ,
                        {src: 'TX_PARAM3_POST_1_HR_DT_TM'   , ptype:3 , getType: 'd', tgt: 'HR1_Post_DTTM'} ,
                        {src: 'TX_PARAM3_POST_24_HR'        , ptype:3 , getType: 'd', tgt: 'HR24_PostValue'} ,
                        {src: 'TX_PARAM3_POST_24_HR_DT_TM'  , ptype:3 , getType: 'd', tgt: 'HR24_Post_DTTM'} ,
                        {src: 'CALC_DELTA1'                 , ptype:3 , getType: 'c', tgt: 'TxfDelta1' ,src1:'TX_PARAM3_PRE', src2:'TX_PARAM3_POST_1_HR'},
                        {src: 'CALC_DELTA24'                , ptype:3 , getType: 'c', tgt: 'TxfDelta24',src1:'TX_PARAM3_PRE', src2:'TX_PARAM3_POST_24_HR'}
                    ]
                }
            };
        /**
         *
         * @param aObjAppNS
         * @param aObjCcBase
         * @param BTRCTL
         * @param aSectionCfg
         * @returns {*}
         */
        function processDataBTR_TBL(aObjAppNS, aObjCcBase, BTRCTL, aSectionCfg) {
            var RetDTO = {},
                objData,
                boolUseDummyData = (typeof aObjCcBase.CCcfg.DummyData !== 'undefined'? aObjCcBase.CCcfg.DummyData: false);
            if(boolUseDummyData){
                objData = chla.eAppsCCFrmWrk[aObjCcBase.CCcfg.cclProgram.toUpperCase()].RPTDATA;
            }else {
                objData = aObjCcBase.eApps.getJsonDataDto(aObjCcBase);
            }            /**
             *
             * @returns {*}
             */
            function BTR2() {
                var arrWrk       = [],
                    arrItemsData = BTRCTL.ITEM_DATA,
                    objItemsDet  = BTRCTL.ITEM_DET,
                    arrItemsGrps = BTRCTL.ITEM_LIST,
                    objItemsParam= BTRCTL.ITEM_PARAMS;
                arrItemsGrps.forEach(/*get key of groups to be processed  */
                    /**
                     *
                     * @param grpItem
                     */
                    function (grpItem) {        //RBC
                        var objDataRow,
                            itemCnt,
                            ptype=0,
                            itemsID,
                            retObj;
                        itemsID = grpItem + objItemsDet.GRP_ID;  //RBC + _PROD_LIST
                        itemCnt = grpItem + objItemsDet.CNT;     //RBC + _PROD_CNT;
                        /*load reference to group under process */
                        if (objData[itemCnt] > 0) {
                            objDataRow = objData[itemsID];       //RBC_PROD_LIST
                            objDataRow.forEach(
                                /**
                                 * Pull the transfusion history information items
                                 * @param RowItem
                                 */
                                function (RowItem) {             // RBC_PROD_LIST[#]
                                    var objRow = {},

                                        arrWrk2;
                                    arrItemsData.forEach(
                                        /**
                                         *
                                         * @param rowDetailItem
                                         * @param index
                                         */
                                        function (rowDetailItem, index) {
                                            var srcLbl,
                                                tgtLbl,
                                                srcLbl2,
                                                tmp1,
                                                tmp2,
                                                ctlFlag;
                                            if ( typeof(objItemsParam[grpItem]) !== "undefined"){
                                                switch (arrItemsData[index].ptype) {
                                                    case 1:
                                                        ctlFlag = ( typeof(objItemsParam[grpItem].PARAM1 ) !== "undefined" ? 1 : 0 );
                                                        if (ptype === 0) {
                                                            ptype          = 1;
                                                            objRow.row1 = {};
                                                            retObj = objRow.row1;
                                                            retObj.PRODLBL = objItemsParam[grpItem].PARAM1;
                                                            retObj.PROD = objItemsParam[grpItem].BLOODPROD;
                                                        }
                                                        break;
                                                    case 2:
                                                        ctlFlag = ( typeof(objItemsParam[grpItem].PARAM2 ) !== "undefined" ? 1 : 0 );
                                                        if (ptype === 1 && ctlFlag === 1) {
                                                            objRow.row2 = {};
                                                            retObj = objRow.row2;
                                                            retObj.PRODLBL = objItemsParam[grpItem].PARAM2;
                                                            retObj.PROD = objItemsParam[grpItem].BLOODPROD;
                                                            ptype          = 2;
                                                        }
                                                        break;
                                                    case 3:
                                                        ctlFlag = ( typeof(objItemsParam[grpItem].PARAM3 ) !== "undefined" ? 1 : 0 );
                                                        if (ptype === 2 && ctlFlag === 1) {
                                                            objRow.row3 = {};
                                                            retObj = objRow.row3;
                                                            retObj.PRODLBL = objItemsParam[grpItem].PARAM3;
                                                            retObj.PROD = objItemsParam[grpItem].BLOODPROD;
                                                            ptype          = 3;
                                                        }
                                                        break;
                                                    default:
                                                        ctlFlag = 0;
                                                        break;
                                                }
                                                if (ctlFlag === 1) {
                                                    srcLbl = arrItemsData[index].src;            //TX_PARAM1_PRE_1_HR
                                                    tgtLbl = arrItemsData[index].tgt;            //PreValue
                                                    if (arrItemsData[index].getType === 'd' && typeof RowItem[srcLbl] !== 'undefined') {
                                                        if (tgtLbl.indexOf("Value") > -1) {
                                                            retObj[tgtLbl + '_Unit'] = '';
                                                            if (grpItem === 'RBC') {
                                                                retObj[tgtLbl + '_Unit'] = 'g/dL';
                                                                retObj[tgtLbl] = RowItem[srcLbl].replace('g/dL','');
                                                            } else if (grpItem === 'FFP') {
                                                                retObj[tgtLbl + '_Unit'] = 'sec';
                                                                retObj[tgtLbl] = RowItem[srcLbl].replace('sec','');
                                                            } else if (grpItem === 'PLT') {
                                                                retObj[tgtLbl + '_Unit'] = 'K/uL';
                                                                retObj[tgtLbl] = RowItem[srcLbl].replace('K/uL','');
                                                            }
                                                        } else {
                                                            retObj[tgtLbl] = RowItem[srcLbl];
                                                        }
                                                        // RBC_PROD_LIST : g/dl
                                                        // FFP_PROD_LIST : sec
                                                        // PLT_PROD_LIST : K/uL

                                                    } else if (arrItemsData[index].getType === 'p') {
                                                        srcLbl         = grpItem + arrItemsData[index].src;  //RBC + _PROD
                                                        retObj[tgtLbl] = RowItem[srcLbl];
                                                    } else if (arrItemsData[index].getType === 'c') {
                                                        srcLbl  = arrItemsData[index].src1;
                                                        srcLbl2 = arrItemsData[index].src2;
                                                        tmp1    = RowItem[srcLbl];
                                                        tmp2    = RowItem[srcLbl2];
                                                        if (tmp1 !== '') {
                                                            tmp1 = parseFloat(tmp1);
                                                            if (tmp2 !== '') {
                                                                tmp2 = parseFloat(tmp2);
                                                                retObj[tgtLbl] = (tmp2 - tmp1).toFixed(1);
                                                            } else {
                                                                retObj[tgtLbl] = '--';
                                                            }

                                                        } else {
                                                            retObj[tgtLbl] ='--';
                                                        }
                                                    }
                                                }
                                            }

                                        }
                                    );
                                    arrWrk2 = Object.keys(objRow);
                                    arrWrk2.forEach(
                                        function (item) {
                                            arrWrk.push(objRow[item]);
                                        }
                                    );
                                    ptype = 0;
                                }
                            );
                        }
                    }
                );
                return arrWrk;
            }


            if (BTRCTL.LBL === 'TXFHIST') {
                RetDTO = BTR1();
            }
            if (BTRCTL.LBL === 'BLOODPRODS') {
                RetDTO = BTR2();
            }
            return RetDTO;
        }
        objRetValue.BTRProd_SectionData = {
            PROD: [],
            State: ''
        };
        objWrk = processDataBTR_TBL(aObjNSbase, aObjCcBase, BTR_RPTDATA_CTL.BTR2);
        arrWrk = Object.keys(objWrk);
        if (arrWrk.length > 0 ){
            objRetValue.BTRProd_SectionData.State = "Data Available";
            arrWrk.forEach(
                function (item){
                    objRetValue.BTRProd_SectionData.PROD.push( objWrk[item]);
                }
            )

        } else {
            objRetValue.BTRProd_SectionData.State = 'noData';
        }
        return objRetValue;
    };

    /**
     * Parent function for construction of the UI
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @returns {string} retVal is html formatted content body of CC
     */
    btresponse.ccnsp.processUI   = function (aObjNSbase, aObjCcBase) {
        var arrWrk = [],
            objComponentContent,
            DtoData = aObjCcBase.eApps.getDataDto(aObjCcBase);

        /**
         *
         * @param aObjAppNS
         * @param aObjCcBase
         * @param aSectionData
         * @param H5Cfg
         * @returns {object}
         */
        function processH5_BTRProd(aObjAppNS, aObjCcBase,aSectionData,H5Cfg) {
            var arrComponentBody     = [],
                arrComponentBodyNoData   = [
                    '<table class="header"><tr>',
                    '<th style="text-align:center;">Tx Dt Tm</th>',
                    '<th style="">Tx&nbsp;Amt</th>',
                    '<th style="text-align:center;">Pre Tx<br/>Lab Value</th>',
                    '<th style="text-align:center;">Pre Tx<br/>Lab Dt Tm</th>',
                    '<th style="text-align:center;">Post Tx<br/>Lab Value</th>',
                    '<th style="text-align:center;">Post Tx<br/>Lab Dt Tm</th>',
                    '<th style="">Tx Response</th></tr>',
                    '<tr><td colspan="7" style="text-align: center;"><span style="font-size:9px;">No Data Available</span></td></tr>',
                    '</table><div style="font-size:8px;line-height:1em;">&nbsp;</div>'
                ],
                arrTblTmplt  = [
                    '<table class="header"><tr>',
                    '<th style="text-align:center;">Tx Dt Tm</th>',
                    '<th style="">Tx&nbsp;Amt</th>',
                    '<th style="text-align:center;">Pre Tx<br/>Lab Value</th>',
                    '<th style="text-align:center;">Pre Tx<br/>Lab Dt Tm</th>',
                    '<th style="text-align:center;">Post Tx<br/>Lab Value</th>',
                    '<th style="text-align:center;">Post Tx<br/>Lab Dt Tm</th>',
                    '<th style="">Tx Response</th></tr>',
                    '<#=TblBody#>',
                    '</table><div style="font-size:8px;line-height:1em;">&nbsp;</div>'
                ],
                row_1Hr = [
                    '<tr class="">',
                    '<td style="font-size:10px;line-height: 1em;vertical-align:middle;"><span style="font-size:9px;"><#=TxDTTM#></span></td>',
                    '<td style="font-size:10px;line-height: 1em;vertical-align:middle;"><span style="font-size:10px;">&nbsp;<#=TxValue#></span>',
                    '<SPAN CLASS="eapps-unitsHO" STYLE="font-size: 9PX;line-height: 1em;"><#=TxUnits#></SPAN></td>',
                    '<td style="font-size:10px;line-height: 1em;vertical-align:middle;"><span style="font-size:10px;">&nbsp;<#=TxPreValue#></span>',
                    '<SPAN CLASS="eapps-unitsHO" STYLE="font-size: 9PX;line-height: 1em;"> <#=TxPreUnits#></SPAN></td>',
                    '<td style="font-size:10px;line-height: 1em;vertical-align:middle;"><#=TxPreDTTM#></td>',
                    '<td style="font-size:10px;line-height: 1em;vertical-align:middle;">',
                    '<span style="font-size:10px;">&nbsp;<span style="color:transparent;">0</span>1Hr:&nbsp;<#=Hr1PostValue#></span>',
                    '<SPAN CLASS="eapps-unitsHO" STYLE="font-size: 9PX;line-height: 1em;"> <#=Hr1PostUnits#></SPAN></td>',
                    '<td style="font-size:10px;line-height: 1em;vertical-align:middle;">&nbsp;<#=Hr1PostDTTM#></td>',
                    '<td style="font-size:10px;line-height: 1em;vertical-align:middle;">',
                    '<span style="font-size:10px;">&nbsp;<#=Hr1Delta#></span><SPAN CLASS="eapps-unitsHO" STYLE="font-size: 9PX;line-height: 1em;"> <#=Hr1DeltaUnits#></SPAN></td></tr>'
                ],
                row_24Hr = [
                    '<tr class="odd">',
                    '<td style="font-size:10px;line-height: 1em;vertical-align:middle;"><span style="font-size:9px;">&nbsp;</span></td>',
                    '<td style="font-size:10px;line-height: 1em;vertical-align:middle;"><span style="font-size:10px;">&nbsp;<#=Hr24TxValue#></span>',
                    '<SPAN CLASS="eapps-unitsHO" STYLE="font-size: 9PX;line-height: 1em;"><#=Hr24TxUnits#></SPAN></td>',
                    '<td style="font-size:10px;line-height: 1em;vertical-align:middle;"><span style="font-size:10px;">&nbsp;</span>',
                    '<SPAN CLASS="eapps-unitsHO" STYLE="font-size: 9PX;line-height: 1em;">&nbsp;</SPAN></td>',
                    '<td style="font-size:10px;line-height: 1em;vertical-align:middle;">&nbsp;</td>',
                    '<td style="font-size:10px;line-height: 1em;vertical-align:middle;"><span style="font-size:10px;">&nbsp;24Hr:&nbsp;<#=Hr24PostValue#></span>',
                    '<SPAN CLASS="eapps-unitsHO" STYLE="font-size: 9PX;line-height: 1em;"><#=Hr24PostUnits#></SPAN> </td>',
                    '<td style="font-size:10px;line-height: 1em;vertical-align:middle;">&nbsp;<#=Hr24PostDTTM#></td>',
                    '<td style="font-size:10px;line-height: 1em;vertical-align:middle;"><span style="font-size:10px;">&nbsp;<#=Hr24Delta#></span>',
                    '<SPAN CLASS="eapps-unitsHO" STYLE="font-size: 9PX;line-height: 1em;"> <#=Hr24DeltaUnits#></SPAN></td></tr>'
                ],
                curLbl = '',
                secLbl =  {
                    'RBC': 'RBC - HGB',
                    'PLT': 'Platelets - PLTE',
                    'FFP': 'FFP - PTINR',
                    'CRYO': 'CRYO - Fibrinogen'
                },
                secBody = {
                    RBC:[],
                    PLT:[],
                    FFP:[],
                    CRYO:[]
                },
                arrKeys;
            // split aSectionData into  RBC,PLT,FFP,CRYO tables
            aSectionData.forEach(
                /**
                 *
                 * @param item
                 */
                function (item) {
                    var strWrk,strWrk2,
                        arrTblBody,
                        arrWrk,
                        arrWrk2,
                        fixDisplay1 = item.TxfDelta1.toString(),
                        fixDisplay24 = item.TxfDelta24.toString();
                    if (fixDisplay1.indexOf('.') > -1){
                        fixDisplay1 =  fixDisplay1.substring(0, fixDisplay1.indexOf('.')+2) ;
                    }
                    if (fixDisplay24.indexOf('.') > -1){
                        fixDisplay24 =  fixDisplay24.substring(0, fixDisplay24.indexOf('.')+2) ;
                    }
                    arrTblBody = secBody[item.PROD];
                    secLbl[item.PROD] = item.PRODLBL;
                    if (typeof item.HR1_Pre_DTTM === 'undefined'){
                        alert('hi');
                    }

                    if (item.HR1_Pre_DTTM + item.HR1_Post_DTTM+ item.HR24_Post_DTTM  !== '') {
                        arrTblBody.push(
                            aObjAppNS.gFuncs.parseTemplate(row_1Hr.join(''), {
                                TxDTTM:  item.BLOOD_EDTTM.replace(/:..$/,''),
                                TxValue: item.BLOOD_AMT.replace('ml', ''),
                                TxUnits: 'ml',
                                TxPreValue: item.HR1_PreValue,
                                TxPreUnits: (item.HR1_PreValue !==''? item.HR1_PreValue_Unit:''),
                                TxPreDTTM: item.HR1_Pre_DTTM.replace(/:..$/,''),
                                Hr1PostValue: item.HR1_PostValue,
                                Hr1PostUnits:(item.HR1_PostValue !==''? item.HR1_PostValue_Unit:'') ,
                                Hr1PostDTTM:item.HR1_Post_DTTM.replace(/:..$/,''),
                                Hr1Delta:  fixDisplay1,
                                Hr1DeltaUnits:(item.TxfDelta1 !=='--'?item.HR1_PreValue_Unit:'')
                            })
                        );
                        curLbl = item.PRODLBL;
                        strWrk = (typeof item.BLOOD_HR24_AMT === 'undefined'? '':item.BLOOD_HR24_AMT);
                        strWrk2 = (typeof item.BLOOD_HR24_AMT === 'undefined'? '': 'ml');
                        arrWrk =  item.HR24_Post_DTTM.split(':');
                        if (arrWrk.length === 3) {
                           arrWrk.pop();
                        }
                        arrTblBody.push(
                            aObjAppNS.gFuncs.parseTemplate(row_24Hr.join(''), {
                                Hr24TxValue: strWrk,
                                Hr24TxUnits: strWrk2,
                                Hr24PostValue: item.HR24_PostValue,
                                Hr24PostUnits: (item.HR24_PostValue !==''? item.HR24_PostValue_Unit:''),
                                Hr24PostDTTM:  arrWrk.join(':'), //item.HR24_Post_DTTM.replace(/:..0$/,''),
                                Hr24Delta:     fixDisplay24,
                                Hr24DeltaUnits:(item.TxfDelta24 !=='--'?item.HR24_PostValue_Unit:'')
                            })
                        );
                    }
                }
            );
            arrKeys = Object.keys(secBody);
            arrKeys.forEach(
                function (value,index) {
                    var strWrk,
                        sectionData  = aObjNSbase.gSectionDataCls.neo(
                           'H5',            // @param T_type
                            value + index,  // @param SecId    value + index
                            secLbl[value],  // @param TLblId   value
                            'OPEN',         // @param SecClsd   auto
                            'H5',           // @param SecLvl  H5
                            'auto'          // @param SecTgl 'auto'
                            ),
                        sectionObj = aObjNSbase.gSectionHeaderCtlCls.neo(),
                        strRetValue;
                    if (secBody[value].length > 0) {
                        strWrk = aObjAppNS.gFuncs.parseTemplate(arrTblTmplt.join(''), {
                            TblBody: secBody[value].join('')
                        })
                    }else{
                        strWrk = arrComponentBodyNoData.join('');
                    }
                    sectionObj.resetValues(sectionObj);
                    sectionObj.initValues({
                        idLabel      : sectionData.SectionID,
                        TLabel1      : sectionData.TLabel1,
                        SectionClosed: sectionData.SectionClosed,
                        SectionCnt   : '',
                        SectionCntVal: secBody[value].length/2,
                        ContentBody  : strWrk,
                        TemplateType : sectionData.TemplateType,
                        CustIcon     : 'none'
                    });
                    strRetValue = sectionObj.generateHTML(aObjCcBase.eApps.CSSBehaviors);
                    sectionData.sectionID = sectionObj.SectionID;
                    sectionData.sectionDivID = sectionObj.SectionDivID;
                    aObjCcBase.eApps.setSectionObjID(aObjCcBase,sectionObj.SectionID, sectionData);
                    aObjCcBase.eApps.addSectionList(aObjCcBase,sectionObj.SectionID);
                    arrComponentBody.push(strRetValue);
                }
            );

            return {
                strFormattedValue: arrComponentBody.join('')
            };
        }
        /**
         *
         *
         * @param aCtlID
         * @param aObjCfg
         *      {
         *       id:'',
         *       lbl: '',
         *       value:''
         *       }
         * @param aObjCcBase
         * @returns {string}
         */
        function variableTRangeInput(aCtlID,aObjCfg,aObjCcBase) {
            var HtmlCtl = [
                    '<div class="<#=ctlid#>" style="float:right; display:table-row;">'
                ],

                button =  '<div id="<#=btnID#>" class="eappsCssBtn eappsCssBtn-DtRange <#=active#>" style="float:right;display:table-row;"><#=btnLbl#></div>',
                objNSBase = chla.eAppsClass.neo();
            aObjCfg.optvalues.forEach(
                function (item,index) {
                    HtmlCtl.push(objNSBase.gFuncs.parseTemplate(button,{
                        btnID: (aObjCcBase.eApps.cc_id + '_' + item.id + '_' + item.value),
                        btnLbl: item.lbl,
                        active: item.select
                    }));
                }
            );
            HtmlCtl.push('</div><div style="height: 22px;">&nbsp;</div>');
            return  objNSBase.gFuncs.parseTemplate(HtmlCtl.join(''),{ctlid: aCtlID});
        }
        arrWrk.push(variableTRangeInput('curTx1',{
                optvalues:[
                    {
                        id:'rp1',
                        lbl: 'Last 18 Months',
                        value:'18m',
                        select: ''
                    },{
                        id:'rp1',
                        lbl: 'Last 12 Months',
                        value:'12m',
                        select: ''

                    },{
                        id:'rp1',
                        lbl: 'Last 6 Months',
                        value:'6m',
                        select: ''

                    },{
                        id:'rp1',
                        lbl: 'Last 3 Months',
                        value:'3m',
                        select: ''

                    }
                ]
            },
            aObjCcBase
        ));
        arrWrk.push('<br/>');
        objComponentContent = processH5_BTRProd(aObjNSbase, aObjCcBase, DtoData.BTRProd_SectionData.PROD );

        arrWrk.push(objComponentContent.strFormattedValue);
        arrWrk.push('<span style="font-size:10px;color:grey;">Transfusion response algorithm: ');
        arrWrk.push(' <span style="text-decoration: none;">For 1 hr response utilizes labs from (0-6 hrs closest to 1 hr). For 24 hr response utilizes labs from (18-36 hrs closest to 24 hrs).</span> See guidelines for Transfusion Dosing and Early Identification of Transfusion Refractory States.</span>');
        //aObjCcBase.eApps.mainSectionStyle = 'max-height:450px;overflow-y:auto;';
        return arrWrk.join('');
    };
    /**
     * Parent function for processing functions after the UI has been render to the DOM
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    btresponse.ccnsp.processPostCcInstance  = function (aObjNSbase, aObjCcBase) {
        var eappsCssBtnDtRange,
            rp1,
            arrWrk = [];

        aObjCcBase.eApps.DTRangeLoadCCL1 = {
            objCcBase :        aObjCcBase,
            eappsCssBtnDtRange: '',
            rp1:                '',
            cclParams:          {}
        };
        arrWrk.push('div#');
        arrWrk.push(aObjCcBase.eApps.cc_id );
        arrWrk.push( ' div.curTx1 div.eappsCssBtn-DtRange');
        eappsCssBtnDtRange = arrWrk.join('');
        arrWrk.length = 0;
        arrWrk.push('#');
        arrWrk.push(aObjCcBase.eApps.cc_id );
        arrWrk.push('_rp1_');
        arrWrk.push( aObjCcBase.cclParams[4].replace(',m','m'));
        //arrWrk.push( '12m');
        rp1 = arrWrk.join('');
        aObjCcBase.eApps.DTRangeLoadCCL1.eappsCssBtnDtRange = eappsCssBtnDtRange;
        aObjCcBase.eApps.DTRangeLoadCCL1.rp1 = rp1;
        aObjCcBase.eApps.DTRangeLoadCCL1.cclParams = aObjCcBase.cclParams;

        aObjCcBase.DTRangeLoadCCL1 = function (data){      //callback.call(self, JSON.parse(responseData));
            var component = this;
            $('#' + component.eApps.cc_id).remove();
            this.data = data;
            component.render();
        };

        eappsCssBtnDtRange =  $(eappsCssBtnDtRange); /*convert to jQuery object*/
        $(rp1).addClass('activeselect');

        eappsCssBtnDtRange.on('click',aObjCcBase.eApps.DTRangeLoadCCL1,
            /**
             * click event handler for btresponse DTRangeLoadCCL1 buttons
             *
             * @param event
             */
            function(event){
                var objCcBase = event.data.objCcBase,
                    DTRangeLoadCCL1 = event.data,
                    rp1 = event.data.rp1,
                    cclParams = event.data.cclParams,
                    eappsCssBtnDtRange =  $(event.data.eappsCssBtnDtRange);

                $(rp1).removeClass('activeselect');
                DTRangeLoadCCL1.rp1 = '#' + $(this).attr('id');
                cclParams[4] = $(this).attr('id').replace('chla_btresponse_rp1_','').replace('m',',m') ;

                $(this).addClass('activeprocessing');
                eappsCssBtnDtRange.off('click');
                objCcBase.loadCcl('chla_ca_mp_cc_bt_rsp_json',
                    objCcBase.cclParams,
                    objCcBase.DTRangeLoadCCL1,
                    "JSON");
            });

    };

    /**
     *  Call to build CC and to render to CC framework
     */
    btresponse.ccnsp.ProcessCtl(btresponse.ccnsp,component);

}
/*======   REQUIRED FILE TERMINATOR INDICATOR ======*/
chla['btconsent'].prototype.render = function() {
    'use strict';
    var  component = this,
        /**
         * variable to contain working object for cc rendering
         */
        btconsent;
    /**
     *  initialize the variable with the CC Module base class
     */
    btconsent  = chla.eAppsClass.gCcModule.createCcModuleCls.neo();
    /*----------------------------------------------------*/
    /* Replace these functions with this CC specific code.*/
    /*----------------------------------------------------*/
    /**
     * Parent function for processing the JSON data received for display
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @returns {*} objRetValue is fully process data for content body
     */
    btconsent.ccnsp.processData = function (aObjNSbase, aObjCcBase) {
        var objData,
            objRetValue = {},
            boolUseDummyData = (typeof aObjCcBase.CCcfg.DummyData !== 'undefined'? aObjCcBase.CCcfg.DummyData: false);
        if(boolUseDummyData){
            objData = chla.eAppsCCFrmWrk[aObjCcBase.CCcfg.cclProgram.toUpperCase()].RPTDATA;
        }else {
            objData = aObjCcBase.eApps.getJsonDataDto(aObjCcBase);
        }
        objRetValue.DT =  objData.BLOOD_CONSENT_DT_TM;
        objRetValue.FORMID = objData.PFORM_ACTIVITY_ID;
        return objRetValue;
    };

    /**
     * Parent function for construction of the UI
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @returns {string} retVal is html formatted content body of CC
     */
    btconsent.ccnsp.processUI   = function (aObjNSbase, aObjCcBase) {
        var arrUI_layout = [
                '<br/><table class="table" ><tr><td style="height: 50px;"><img  height="40px" width="40px"  src="'
                ,'<#=ICONIMAGE#>'
                ,'" alt="consent_present_state" style="padding-left:5px;"/></td>'
                ,'<td style="vertical-align: middle;"><span style="font-weight:700;">Transfusion Consent</span><br/>&nbsp; </td>'
                ,'<td style="padding-top: 8px;"><span style=""> '
                ,'<#=CONSENTDT#>'
                ,' </span></td>'
                ,'</tr></table><span style="font-weight:700;padding-left:15px;">Paul Gann Act'
                ,'&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:APPLINK(100,&quot;'
                ,'<#=pGannEn#>'
                ,'&quot;,&quot;&quot;)"><SPAN STYLE="COLOR:Blue;text-decoration: none;">  English</span></a></span>'
                ,'<br/><span style="font-weight:700;color:white;padding-left:15px;">Paul Gann Act'
                ,'&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:APPLINK(100,&quot;'
                ,'<#=pGannSp#>'
                ,'&quot;,&quot;&quot;)"><SPAN STYLE="COLOR:Blue;text-decoration:none;">  Spanish</span></a></span>'
                ,'<div style="padding-top:5px;padding-left:15px;width:90%;">'
                ,'<a href="javascript:APPLINK(100,&quot;'
                ,'<#=pBT#>'
                ,'&quot;,&quot;&quot;)"><SPAN STYLE="font-weight:700;COLOR:Blue;text-decoration: none;">  Blood Transfusion Policy</span></a>'
                ,'</div> '
                ,'<div style="padding-top:5px;padding-left:15px;width:90%;">'
                ,'<a href="javascript:APPLINK(0,&quot;Powerchart.exe&quot;,&quot;'
                ,' /PERSONID='
                ,'<#=strPer#>'
                ,' /ENCNTRID='
                ,'<#=strEnc#>'
                ,' /FIRSTTAB=^Consent Form^&quot;)"><SPAN STYLE="font-weight:700;COLOR:Blue;text-decoration: none;">  Consent Form</span></a>'
                ,'</div> '
                ,'<div style="padding-top:5px;padding-left:15px;width:90%;">'
				,'<a onclick="chla.eApps.gFuncs.ReadOnlyMPageUtils(&quot;POWERNOTE&quot;,<#=strPer#>,<#=strEnc#>,<#=ACTVITY_ID#>);"><SPAN STYLE="font-weight:700;COLOR:Blue;text-decoration: none;">  Link to Last Blood Transfusion Consent w/in 1 year</SPAN></a>'
                ,'</div> '
            ],
            arrWrk=[],
            pGannEn = 'http://159.140.229.9/mpage-content/p1345.chla_ca.cernerasp.com/custom_mpage_content/Chla_eApps_Static_mPages/BT/PaulGannActEng.pdf',
            pGannSp = 'http://159.140.229.9/mpage-content/p1345.chla_ca.cernerasp.com/custom_mpage_content/Chla_eApps_Static_mPages/BT/PaulGannActSpan.pdf',
            pBTaddr ='https://sharepoint.chla.usc.edu/Docs/Pages/Policies.aspx?k=',
            strWrk,
            dataDto;
        dataDto = aObjCcBase.eApps.getDataDto(aObjCcBase);

        aObjCcBase.eApps.mainSectionStyle = 'height:230px;';
        arrWrk.push(chla.global.imgPath );
        if (dataDto.DT === ''){
            arrWrk.push('Yellow_circle-256.jpg');
            strWrk = '<span style="color:lightgrey;font-size: 16px;">No Consent Active</span>';
        }else {
            arrWrk.push('green_circle-256.png');
            strWrk = dataDto.DT;
        }
        return aObjNSbase.gFuncs.parseTemplate(arrUI_layout.join(''),{
            ICONIMAGE:arrWrk.join(''),
            CONSENTDT:strWrk,
            pGannEn:pGannEn,
            pGannSp:pGannSp,
            strEnc: aObjCcBase.getProperty("encounterId"),
            strPer: aObjCcBase.getProperty("personId"),
            pBT:pBTaddr,
            FORM_ID: '2561991.0',
            ACTVITY_ID:dataDto.FORMID
        });
    };
    /**
     *  Call to build CC and to render to CC framework
     */
    btconsent.ccnsp.ProcessCtl(btconsent.ccnsp,component);

};
/*======   REQUIRED FILE TERMINATOR INDICATOR ======*/
chla['bthistory'].prototype.render = function() {
    'use strict';
    var  component = this,
        /**
         * variable to contain working object for cc rendering
         */
        bthistory;
    /**
     *  initialize the variable with the CC Module base class
     */
    bthistory  = chla.eAppsClass.gCcModule.createCcModuleCls.neo();
    /*----------------------------------------------------*/
    /* Replace these functions with this CC specific code.*/
    /*----------------------------------------------------*/
    /**
     * Parent function for processing the JSON data received for display
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @returns {object} objRetValue is fully process data for content body
     */
    bthistory.ccnsp.processData = function (aObjNSbase, aObjCcBase) {
        var objRetValue = {},
            arrWrk,
            objWrk,
            BTR_RPTDATA_CTL = {
                BTR1: {
                    LBL      : 'TXFHIST',
                    ITEM_DET : {
                        'CNT'   : '_PROD_CNT',
                        'GRP_ID': '_PROD_LIST',
                        'RET_ID': '_PROD_HIST'
                    },
                    ITEM_LIST :[
                        'RBC',
                        'PLT',
                        'FFP',
                        'GRANULOCYTES',
                        'CRYOFIBRIN',
                        'OTHER'
                    ],
                    ITEM_DATA: [
                        {src: '_PROD',          tgt: 'PRD_LBL'},
                        {src: 'TX_START_DT_TM', tgt: 'BLOOD_GIVEN_DTTM'},
                        {src: '_DOSAGE',        tgt: 'BLOOD_AMT'},
                        {src: '_UNIT',          tgt: 'BLOOD_UNITS'}
                    ]
                }
            };
        /**
         *
         * @param aObjAppNS
         * @param aObjCcBase
         * @param BTRCTL
         * @param aSectionCfg
         * @returns {*}
         */
        function processDataBTR_TBL(aObjAppNS, aObjCcBase, BTRCTL, aSectionCfg) {
            var RetDTO = {},
                objData,
                boolUseDummyData = (typeof aObjCcBase.CCcfg.DummyData !== 'undefined'? aObjCcBase.CCcfg.DummyData: false);
            if(boolUseDummyData){
                objData = chla.eAppsCCFrmWrk[aObjCcBase.CCcfg.cclProgram.toUpperCase()].RPTDATA;
            }else {
                objData = aObjCcBase.eApps.getJsonDataDto(aObjCcBase);
            }
            /**
             *
             * @returns {*}
             */
            function BTR1() {
                var objRetValue = {},

                    arrWrk       = [],
                    arrItemsData = BTRCTL.ITEM_DATA,
                    objItemsDet  = BTRCTL.ITEM_DET,
                    arrItemsGrps = BTRCTL.ITEM_LIST,
                    retID;
                retID            = objItemsDet.RET_ID;
                arrItemsGrps.forEach(
                    /**
                     *  Process the list of Blood Prod for standard list
                     * @param grpItem
                     */
                    function (grpItem) {   //grpItem = RPC
                        var objDataRow,
                            arrRet       = [],
                            itemCnt,
                            itemsID;

                        itemsID = grpItem + objItemsDet.GRP_ID;  //RBC + _PROD_LIST
                        itemCnt = grpItem + objItemsDet.CNT;     //RBC + _PROD_CNT

                        if (objData[itemCnt] > 0) {
                            objDataRow = objData[itemsID];       //RBC_PROD_LIST
                            objDataRow.forEach(
                                /**
                                 * Pull the transfusion history information items
                                 * @param RowItem
                                 */
                                function (RowItem) {             // RBC_PROD_LIST[#]
                                    var objRow = {};
                                    arrItemsData.forEach(
                                        /**
                                         *
                                         * @param rowDetailItem
                                         * @param index
                                         */
                                        function (rowDetailItem, index) {
                                            var srcLbl, tgtLbl,srcPart;
                                            srcPart = arrItemsData[index].src;
                                            if (srcPart.substr(0,1) === '_') {
                                                srcLbl = grpItem + arrItemsData[index].src;  //RBC + _PROD
                                            }else{
                                                srcLbl = arrItemsData[index].src;  //TX_START_DT_TM
                                            }
                                            tgtLbl = arrItemsData[index].tgt;            //PROD_LBL
                                            objRow[tgtLbl] = RowItem[srcLbl];
                                        }
                                    );
                                    arrRet.push(objRow);
                                }
                            )
                        } else {
                            arrRet.push({
                                'PRD_LBL'         :  'No Data Available',
                                'BLOOD_GIVEN_DTTM': '',
                                'BLOOD_AMT'       : '',
                                'BLOOD_UNITS'     : ''
                                }
                            )
                        }
                        objRetValue[grpItem + retID] = arrRet.slice();
                    }
                );
                return objRetValue;
            }
            if (BTRCTL.LBL === 'TXFHIST') {
                RetDTO = BTR1();
            }
            return RetDTO;
        }
        objRetValue.BTRHist_SectionData = {};
        objWrk = processDataBTR_TBL(aObjNSbase, aObjCcBase, BTR_RPTDATA_CTL.BTR1);
        arrWrk = Object.keys(objWrk);
        if (arrWrk.length > 0 ){
            arrWrk.forEach(
                function (item){
                    objRetValue.BTRHist_SectionData[item] = objWrk[item];
                }
            )

        } else {
            objRetValue.BTRHist_SectionData.State = 'noData';
        }

        return objRetValue;
    };

    /**
     * Parent function for construction of the UI
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @returns {string} retVal is html formatted content body of CC
     */
    bthistory.ccnsp.processUI   = function (aObjNSbase, aObjCcBase) {
        var arrWrk = [],
            DtoData = aObjCcBase.eApps.getDataDto(aObjCcBase);

        /**
         *
         * @param aObjAppNS
         * @param aObjCcBase
         * @param aSectionData
         * @param H5Cfg
         * @returns {string}
         */
        function processH5_BTRHist(aObjAppNS, aObjCcBase, aSectionData,H5Cfg) {
                var sectionObj  = aObjAppNS.gSectionHeaderCtlCls.neo(),
                    objData = {},
                    strTblBodyTmpl = [
                        '<tr class="<#=oddRow#>"><td style="line-height: 1em;"><span style="font-size:9px;"><#=DTTM#></span></td>',
                        '<td style="font-weight:500;line-height: 1em;"><span style="font-size:9px;"><#=ProdName#></span></td>',
                        '<td style="line-height: 9px;"><span style="font-size:9px;"><#=ProdAmt#>&nbsp;</span><span CLASS="eapps-unitsHO" STYLE="font-size: 9PX;"><#=ProdUnits#></span></td></tr>'
                    ],
                    arrTbl      = [
                        '<table><tbody><tr>',
                        '<th style="width:100px;">Date</th>',
                        '<th style="min-width:200px;">Product</th>',
                        '<th style="max-width:45px;">Tx Amt</th></tr>',
                        '<#=TblBody#></table>'
                    ],
                    arrWrk= [],
                    arrList;
                arrList = Object.keys(aSectionData);
                arrList.forEach(
                    function (item) {
                        var newLbl = item.replace('HIST','H5_DATA'),
                            arrTblBody     = [],
                            arrData = aSectionData[item];
                        if (ChlaStdClass.isArray(arrData)) {
                            arrData.forEach(
                                function (rowItem,index) {
                                    arrTblBody.push(aObjAppNS.gFuncs.parseTemplate(strTblBodyTmpl.join(''), {
                                        oddRow   : (index % 2 === 0 ? 'odd' : ''),
                                        ProdName : rowItem.PRD_LBL,
                                        DTTM     : rowItem.BLOOD_GIVEN_DTTM.replace(/:..$/,''),
                                        ProdAmt  : rowItem.BLOOD_AMT,
                                        ProdUnits: (rowItem.BLOOD_AMT === ''?'': 'ml')//;rowItem.BLOOD_UNITS
                                    })
                                    )
                                }
                            );
                            objData[newLbl] = aObjAppNS.gFuncs.parseTemplate(arrTbl.join(''), {
                                TblBody: arrTblBody.join('')
                            });
                        }
                    }
                );

            /**
             *
             * @param aObjNSbase
             * @param aObjCcBase
             * @param aDataDto
             * @param aSectionCfg
             * @returns {string} strRetValue
             */
            function processH5Sections(aObjNSbase,aObjCcBase,aDataDto,aSectionCfg) {
                var sectionData  = aObjNSbase.gSectionDataCls.neo(
                    aSectionCfg.T_type,
                    aSectionCfg.SecId,
                    aSectionCfg.TLblId,
                    aSectionCfg.secClsd,
                    aSectionCfg.SecLvl,
                    aSectionCfg.SecTgl
                    ),
                    sectionObj = aObjNSbase.gSectionHeaderCtlCls.neo(),
                    strRetValue;
                sectionObj.resetValues(sectionObj);
                sectionObj.initValues({
                    idLabel      : sectionData.SectionID,
                    TLabel1      : sectionData.TLabel1,
                    SectionClosed: sectionData.SectionClosed,
                    SectionCnt   : '',
                    SectionCntVal: 1,
                    ContentBody  : aDataDto,
                    TemplateType : sectionData.TemplateType,
                    CustIcon     : 'none'
                });
                strRetValue = sectionObj.generateHTML(aObjCcBase.eApps.CSSBehaviors);
                sectionData.sectionID = sectionObj.SectionID;
                sectionData.sectionDivID = sectionObj.SectionDivID;
                aObjCcBase.eApps.setSectionObjID(aObjCcBase,sectionObj.SectionID, sectionData);
                aObjCcBase.eApps.addSectionList(aObjCcBase,sectionObj.SectionID);
                return strRetValue;
            }

            arrWrk.push(processH5Sections(aObjNSbase,aObjCcBase,objData.RBC_PROD_H5_DATA,
                {
                    T_type:  'H5',
                    SecId:   'BH5Sec',
                    TLblId:  '<span style="font-weight:800;">PRBC</span>',
                    secClsd: 'open',
                    SecLvl:  'H5',
                    SecTgl:  'false'
                }));
            arrWrk.push('<br/>');
            arrWrk.push(processH5Sections(aObjNSbase,aObjCcBase,objData.PLT_PROD_H5_DATA,                {
                    T_type:  'H5',
                    SecId:   'BH5Sec1',
                    TLblId:  '<span style="font-weight:800;">Platelets</span>',
                    secClsd: 'open',
                    SecLvl:  'H5',
                    SecTgl:  'false'
                }));
            arrWrk.push('<br/>');
            arrWrk.push(processH5Sections(aObjNSbase,aObjCcBase,objData.FFP_PROD_H5_DATA,
                {
                    T_type:  'H5',
                    SecId:   'BH5Sec2',
                    TLblId:  '<span style="font-weight:800;">FFP</span>',
                    secClsd: 'open',
                    SecLvl:  'H5',
                    SecTgl:  'false'
                }));
            arrWrk.push('<br/>');
            arrWrk.push(processH5Sections(aObjNSbase,aObjCcBase,objData.CRYOFIBRIN_PROD_H5_DATA,
                {
                    T_type:  'H5',
                    SecId:   'BH5Sec3',
                    TLblId:  '<span style="font-weight:800;">Cryo</span>',
                    secClsd: 'open',
                    SecLvl:  'H5',
                    SecTgl:  'false'
                }));
            arrWrk.push('<br/>');
            arrWrk.push(processH5Sections(aObjNSbase,aObjCcBase,objData.GRANULOCYTES_PROD_H5_DATA,
                {
                    T_type:  'H5',
                    SecId:   'BH5Sec4',
                    TLblId:  '<span style="font-weight:800;">Granulocytes</span>',
                    secClsd: 'open',
                    SecLvl:  'H5',
                    SecTgl:  'false'
                }));
            arrWrk.push('<br/>');
            arrWrk.push(processH5Sections(aObjNSbase,aObjCcBase,objData.OTHER_PROD_H5_DATA,
                {
                    T_type:  'H5',
                    SecId:   'BH5Sec5',
                    TLblId:  '<span style="font-weight:800;">Other</span>',
                    secClsd: 'open',
                    SecLvl:  'H5',
                    SecTgl:  'false'
                }))
            return arrWrk.join('');
            // sectionObj.initValues({
            //         idLabel      : H5Cfg.SecId,
            //         TLabel1      : H5Cfg.TLblId,
            //         SectionClosed: H5Cfg.SecClsd,
            //         SectionCnt   : '',
            //         SectionCntVal: 1,
            //         ContentBody  : arrWrk.join(''),
            //         TemplateType : H5Cfg.T_type,
            //         CustIcon     : 'None'
            //     });
            //     strRetValue              = sectionObj.generateHTML();
            //     aSectionData.SectionDivID = sectionObj.SectionDivID;
            //     return strRetValue;
        }
        /**
         *
         *
         * @param aCtlID
         * @param aObjCfg
         *      {
         *       id:'',
         *       lbl: '',
         *       value:''
         *       }
         * @param aObjCcBase
         * @returns {string}
         */
        function variableTRangeInput(aCtlID,aObjCfg,aObjCcBase) {
            var HtmlCtl = [
                    '<div class="<#=ctlid#>" style="float:right; display:table-row;">'
                ],

                button =  '<div id="<#=btnID#>" class="eappsCssBtn eappsCssBtn-DtRange <#=active#>" style="float:right;display:table-row;"><#=btnLbl#></div>',
                objNSBase = chla.eAppsClass.neo();
            aObjCfg.optvalues.forEach(
                function (item,index) {
                    HtmlCtl.push(objNSBase.gFuncs.parseTemplate(button,{
                        btnID: (aObjCcBase.eApps.cc_id + '_' + item.id + '_' + item.value),
                        btnLbl: item.lbl,
                        active: item.select
                    }));
                }
            );
            HtmlCtl.push('</div><div style="height: 22px;">&nbsp;</div>');
            return  objNSBase.gFuncs.parseTemplate(HtmlCtl.join(''),{ctlid: aCtlID});
        }
        arrWrk.push(variableTRangeInput('curTx1',{
                optvalues:[
                    {
                        id:'rp1',
                        lbl: 'Last 18 Months',
                        value:'18m',
                        select: ''
                    },{
                        id:'rp1',
                        lbl: 'Last 12 Months',
                        value:'12m',
                        select: ''

                    },{
                        id:'rp1',
                        lbl: 'Last 6 Months',
                        value:'6m',
                        select: ''

                    },{
                        id:'rp1',
                        lbl: 'Last 3 Months',
                        value:'3m',
                        select: ''

                    }
                ]
            },
            aObjCcBase
        ));
        arrWrk.push('<br/>');
        arrWrk.push(processH5_BTRHist(aObjNSbase, aObjCcBase, DtoData.BTRHist_SectionData,
            {
                    T_type : 'H5',
                    SecId  : 'BTRHist',
                    TLblId : 'Transfusion History',
                    SecClsd: 'open',
                    SecLvl : 'H5',
                    SecTgl : ''
                }
        ));
         arrWrk.push('<span style="font-size:10px;color:grey;">Blood Product data is accurate for inpatient blood transfusion after March 20th, 2017 and outpatient blood transfusions after August 27th 2017.  For blood product information prior to this date, please contact the blood bank.</span>');
        aObjCcBase.eApps.mainSectionStyle = 'max-height:450px;overflow-y:auto;';
        return arrWrk.join('');
    };
    /**
     * Parent function for processing functions after the UI has been render to the DOM
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    bthistory.ccnsp.processPostCcInstance  = function (aObjNSbase, aObjCcBase) {
        var eappsCssBtnDtRange,
            rp1,
            arrWrk = [];

        aObjCcBase.eApps.DTRangeLoadCCL1 = {
                objCcBase :        aObjCcBase,
                eappsCssBtnDtRange: '',
                rp1:                '',
                cclParams:          {}
            };
        arrWrk.push('div#');
        arrWrk.push(aObjCcBase.eApps.cc_id );
        arrWrk.push( ' div.curTx1 div.eappsCssBtn-DtRange');
        eappsCssBtnDtRange = arrWrk.join('');
        arrWrk.length = 0;
        arrWrk.push('#');
        arrWrk.push(aObjCcBase.eApps.cc_id );
        arrWrk.push('_rp1_');
        arrWrk.push( aObjCcBase.cclParams[4].replace(',m','m'));
        rp1 = arrWrk.join('');
        aObjCcBase.eApps.DTRangeLoadCCL1.eappsCssBtnDtRange = eappsCssBtnDtRange;
        aObjCcBase.eApps.DTRangeLoadCCL1.rp1 = rp1;
        aObjCcBase.eApps.DTRangeLoadCCL1.cclParams = aObjCcBase.cclParams;

        aObjCcBase.DTRangeLoadCCL1 = function (data){      //callback.call(self, JSON.parse(responseData));
            var component = this;
            $('#' + component.eApps.cc_id).remove();
            this.data = data;
            component.render();
        };

        eappsCssBtnDtRange =  $(eappsCssBtnDtRange); /*convert to jQuery object*/
        $(rp1).addClass('activeselect');

        eappsCssBtnDtRange.on('click',aObjCcBase.eApps.DTRangeLoadCCL1,
            /**
             * click event handler for bthistory DTRangeLoadCCL1 buttons
             *
             * @param event
             */
            function(event){
                var objCcBase = event.data.objCcBase,
                    DTRangeLoadCCL1 = event.data,
                    rp1 = event.data.rp1,
                    cclParams = event.data.cclParams,
                    eappsCssBtnDtRange =  $(event.data.eappsCssBtnDtRange);

                $(rp1).removeClass('activeselect');
                DTRangeLoadCCL1.rp1 = '#' + $(this).attr('id');
                cclParams[4] = $(this).attr('id').replace('chla_bthistory_rp1_','').replace('m',',m') ;
                $(this).addClass('activeprocessing');
                eappsCssBtnDtRange.off('click');
                objCcBase.loadCcl('chla_ca_mp_cc_bt_rsp_json',
                    objCcBase.cclParams,
                    objCcBase.DTRangeLoadCCL1,
                    "JSON");
        });

    };

    /**
     *  Call to build CC and to render to CC framework
     */
    bthistory.ccnsp.ProcessCtl(bthistory.ccnsp,component);

};
/*======   REQUIRED FILE TERMINATOR INDICATOR ======*/
chla['btIndLabHist'].prototype.render = function() {
    'use strict';
    var  component = this,
         /**
          * variable to contain working object for cc rendering
          */
         btIndLabHist;
    /**
     *  initialize the variable with the CC Module base class
     */
    btIndLabHist  = chla.eAppsClass.gCcModule.createCcModuleCls.neo();
    /*----------------------------------------------------*/
    /* Replace these functions with this CC specific code.*/
    /*----------------------------------------------------*/
    /**
     * Parent function for processing the JSON data received for display
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @returns {*} retVal is fully process data for content body
     */
    btIndLabHist.ccnsp.processData = function (aObjNSbase, aObjCcBase) {
        var DtoData,
            objRetValue = {},
            boolUseDummyData = (typeof aObjCcBase.CCcfg.DummyData !== 'undefined'? aObjCcBase.CCcfg.DummyData: false);
        if(boolUseDummyData){
            DtoData = chla.eAppsCCFrmWrk[aObjCcBase.CCcfg.cclProgram.toUpperCase()].RPTDATA;
        }else {
            DtoData = aObjCcBase.eApps.getJsonDataDto(aObjCcBase);
        }

        /**
         *
         * @param aObjNSbase
         * @param arrDataMarkers  {string }  - 'BTIPhysiological' or 'BTILabs'
         * @param aSectionCfg
         * @param aDtoData
         * @returns {*}
         */
        function processSectionData(aObjNSbase,arrDataMarkers,aSectionCfg,aDtoData) {
            var BTI_RPTDATA_Markers = {
                    BTILabs: [
                        'HGB',
                        'PLT',
                        'PTT',
                        'PT',
                        'INR',
                        'FIBRINOGEN'
                    ]
                },
                SectionData_DTO,
                objData;
            objData = aDtoData;
            SectionData_DTO = aObjNSbase.gSectionDataCls.neo(
                aSectionCfg.T_type,
                aSectionCfg.SecId,
                aSectionCfg.TLblId,
                aSectionCfg.SecLvl,
                aSectionCfg.SecTgl
            );
            SectionData_DTO.Body = [];
            /*#################################################################### */
            /* Need function to process loop json data for the group the data records*/
            /* by type: 'BTIPhysiological' or 'BTILabs'                            */
            /*#################################################################### */

            BTI_RPTDATA_Markers[arrDataMarkers].forEach(
                /**
                 * Process each data record
                 * @param item {string} BTI_RPTDATA_Markers of types BTIPhysiological or BTILabs
                 */
                function (item) {
                    var objRetVal = {
                            ITEM_ID:'',
                            LAST_DTTM: '',
                            ITEM_VAL:'',
                            ITEM_UNITS:'',
                            ITEM_RANGE: '',
                            ITEM_CRITICAL:'',
                            ITEM_CRITICAL_HIGH:'',
                            ITEM_CRITICAL_LOW:'',
                            ITEM_LIST:[]
                        },
                        arrItems,
                        arrItems2,
                        arrItemsRev,
                        arrWrk    = [];
                    /*------------------------------------------------------------------*/
                    /**
                     * Process data record for additional BTILabs data markers
                     * @param aArrWrk
                     */
                    function processBTILabs(aArrWrk) {
                        objRetVal.ITEM_UNITS    = objData[aArrWrk[3]];     /* objData.xxx_UNITS */
                        objRetVal.ITEM_CRITICAL = objData[aArrWrk[4]];     /* objData.xxx_CRITICAL */
                        objRetVal.ITEM_CRITICAL_HIGH = (typeof objData[aArrWrk[5]] !== 'undefined'? objData[aArrWrk[5]]: '');     /* objData.xxx_CRITICAL_HIGH */
                        objRetVal.ITEM_CRITICAL_LOW =  (typeof objData[aArrWrk[6]] !== 'undefined'? objData[aArrWrk[6]]: '');     /* objData.xxx_CRITICAL_LOW */
                    }
                    /*------------------------------------------------------------------*/
                    arrWrk.push(item + '_CNT');             /*0    SBP_CNT,DBP_CNT,PULSE_CNT,MEANAP_CNT*/
                    arrWrk.push(item + '_LAST_DTTM');       /*1    SBP_LAST_DTTM,DBP_LAST_DTTM,PULSE_LAST_DTTM,MEANAP_LAST_DTTM */
                    arrWrk.push(item + '_LIST');            /*2    SBP_LIST,DBP_LIST,PULSE_LIST,MEANAP_LIST */
                    objRetVal.ITEM_ID   = item;             /* custom label to be used */
                    /*------------------------------------------------------------------*/
                    /* Determine if this is a record type to be processed               */
                    /*------------------------------------------------------------------*/
                    if ( objData[arrWrk[0]] !== 0 ) {
                        arrItems = objData[arrWrk[2]];
                        if (arrItems.length > 0){
                            objRetVal.LAST_DTTM = arrItems[0].DATE;
                            objRetVal.ITEM_VAL  = arrItems[0][objRetVal.ITEM_ID];
                            //sort order lowest to highest
                            arrItemsRev = arrItems.reverse();
                            objRetVal.ITEM_LIST = arrItemsRev.map(
                                function(item){
                                    var retVal = item[objRetVal.ITEM_ID].replace(/g.dL/g,'');
                                    retVal = retVal.replace(/x10.3.uL/g,''); //x10*3/uL
                                    retVal = retVal.replace(/K.uL/g,'');
                                    retVal = retVal.replace(/sec/g,'');
                                    retVal = retVal.replace(/m/g,'');
                                    return (retVal);
                                }
                            );
                            arrItems2 = objRetVal.ITEM_LIST.slice();
                            arrItems2 = arrItems2.sort(function(a, b){return a-b});
                            objRetVal.ITEM_RANGE = arrItems2[0] + '-' + arrItems2.pop();
                        }
                        if (arrDataMarkers === 'BTILabs'){
                            arrWrk.push(item + '_UNITS');         /*3 */
                            arrWrk.push(item + '_CRITICAL');      /*4 */
                            arrWrk.push(item + '_CRITICAL_HIGH'); /*5 */
                            arrWrk.push(item + '_CRITICAL_LOW');  /*6 */
                            processBTILabs( arrWrk);
                        }
                    }
                    SectionData_DTO.Body.push(objRetVal);
                }
            );
            return SectionData_DTO;
        }
        objRetValue.PERSON_AGE = DtoData.PERSON_AGE;
        objRetValue.BTIlab_SectionData = processSectionData(aObjNSbase,'BTILabs',
            {
                T_type: 'H5',
                SecId: 'BTIlab',
                TLblId: '<span style="font-weight:800;">Last Lab Results</span>',
                SecClsd: 'open',
                SecLvl:'H5',
                SecTgl:''
            },
            DtoData);
        return objRetValue;
    };
    /**
     * Parent function for construction of the UI
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @returns {string} arrRetValue.join('') is html formatted content body of CC
     */
    btIndLabHist.ccnsp.processUI   = function (aObjNSbase, aObjCcBase) {
        var arrRetValue = [],
            sectionObj     = aObjNSbase.gSectionHeaderCtlCls.neo(),
            arrWrk = [],
            strWrk,
            ffpNotConsistent,
            BodyContent,
            DtoDataUI,
            iconStatus = {
                'HGB'       : '',  //RBC
                'PLT'       : '',  //Platelet
                'PTT'       : '',  // FFP
                'PT'        : '',  // FFP
                'INR'     : '',    // FFP
                'FIBRINOGEN': ''   // CRYO
            }
        ;
        DtoDataUI = aObjCcBase.eApps.getDataDto(aObjCcBase);
        /**
         *
         * @param aObjNSbase
         * @param aObjCcBase
         * @param aDtoUi
         * @param aPtAge
         * @returns {string}
         */
        function processH5_BTIlab(aObjNSbase, aObjCcBase,aDtoUi,aPtAge) {
            var sectionObj     = aObjNSbase.gSectionHeaderCtlCls.neo(),
                sectionData    = aDtoUi,
                strTblBodyTmpl = [
                    '<tr <#=disableRow#> style="line-height:.75em;">',
                    '<td>&nbsp;<#=alertIcon#></td>',
                    '<td><#=RowMeasure#></td>',
                    '<td style="padding-left: 8px;"><#=RowRange#></td>',
                    '<td><#=RowLast#> <span class="eapps-unitsHO" style="font-size:9px;"><#=RowUnits#><span></td>',
                    //'<td><img src="',
                    //chla.global.imgPath,
                    //'<#=AltInd#>"/></td>',
                    '<td><span style="color:#7C7C7C;font-size: 9px;"><#=RowDate#></span></td>',
					'<td><img src="',
                    chla.global.imgPath,
                    '<#=AltInd#>"/></td>',
                    '<td id="<#=MTrend#>"><#=RowTrend#></td>',
                    '</tr>'
                ],
                arrWrkTmpl                   = [],
                arrWrk                       = [
                    '<table><tr>',
                    '<th style="width:30px;">&nbsp;</th>',
                    '<th style="width:20px;">Measure</th>',
                    '<th style="width:70px;">Last 5 Rslts w/i 72 Hrs</th>',
                    '<th style="width:90px;">Last Result w/i 72 Hrs</th>', //<br/>(Within 72hrs)</th>',
                    '<th style="width:100px;">Date</th>',
					'<th style="width:19px;">&nbsp;</th>',
                    '<th style="width:130px;">Trend</th>',
                    '</tr>',
                    '<#=TblBody#></table>'
                ],
                BTILabs                      = {
                    'HGB'       : '',
                    'PLT'       : '',
                    'PTT'       : '',
                    'PT'        : '',
                    'INR'     : 'PT-INR',
                    'FIBRINOGEN': ''
                },
                strFormattedValue,
                strRetValue;
            aObjCcBase.eApps.BTIlabSparkline = [];
            sectionData.Body.forEach(
                function (item) {
                    var arrWrk = [],
                        strUnits,
                        strVal,
                        arrWrk,
                        strRange,
                        strList;
                    arrWrk.push('div#');
                    arrWrk.push(aObjCcBase.eApps.cc_id);
                    arrWrk.push(' td#');
                    arrWrk.push(item.ITEM_ID);
                    //chla.eAppsUtil.Logger.LogInfo('LOGINFO: ' + item.ITEM_ID);
                    if (item.ITEM_VAL.indexOf('mg/dL') > -1) {
                        //chla.eAppsUtil.Logger.LogInfo('LOGINFO: btIndLabHist1');
                        strUnits        = 'mg/dL';
                        strVal          = item.ITEM_VAL.replace('mg/dL', '');
                        strRange        = item.ITEM_RANGE.replace(/mg.dL/g, '');
                        item.ITEM_UNITS = strUnits;
                        strList         = item.ITEM_LIST.join(',').replace(/mg.dL/g, '');
                    } else if (item.ITEM_VAL.indexOf('g/dL') > -1) {
                        //chla.eAppsUtil.Logger.LogInfo('LOGINFO: btIndLabHist2');
                        strUnits        = 'g/dL';
                        strRange        = item.ITEM_RANGE.replace(/g.dL/g, '');
                        strVal          = item.ITEM_VAL.replace('g/dL', '');
                        item.ITEM_UNITS = strUnits;
                        strList         = item.ITEM_LIST.join(',').replace(/g.dL/g, '');
                    } else if (item.ITEM_VAL.indexOf('x10*3/uL') > -1) {
                        //chla.eAppsUtil.Logger.LogInfo('LOGINFO: btIndLabHist3');
                        strUnits        = 'x10*3/uL';
                        strRange        = item.ITEM_RANGE.replace(/x10.3.uL/g, '');
                        strVal          = item.ITEM_VAL.replace('x10*3/uL', '');
                        item.ITEM_UNITS = strUnits;
                        strList         = item.ITEM_LIST.join(',').replace(/x10.3.uL/g, '');
                    } else if (item.ITEM_VAL.indexOf('K/uL') > -1) {
                        //chla.eAppsUtil.Logger.LogInfo('LOGINFO: btIndLabHist3');
                        strUnits        = 'K/uL';
                        strRange        = item.ITEM_RANGE.replace(/K.uL/g, '');
                        strVal          = item.ITEM_VAL.replace('K/uL', '');
                        item.ITEM_UNITS = strUnits;
                        strList         = item.ITEM_LIST.join(',').replace(/K.uL/g, '');

                    } else if (item.ITEM_VAL.indexOf('sec') > -1) {
                        //chla.eAppsUtil.Logger.LogInfo('LOGINFO: btIndLabHist4');
                        strUnits        = 'sec';
                        strRange        = item.ITEM_RANGE.replace(/sec/g, '');
                        strVal          = item.ITEM_VAL.replace('sec', '');
                        item.ITEM_UNITS = strUnits;
                        strList         = item.ITEM_LIST.join(',').replace(/sec/g, '');
                    } else {
                        strUnits        = '';
                        strRange        = item.ITEM_RANGE;
                        strVal          = item.ITEM_VAL;
                        item.ITEM_UNITS = strUnits;
                        strList         = item.ITEM_LIST.join(',');
                    }
                    aObjCcBase.eApps.BTIlabSparkline.push(arrWrk.join(''));
                    iconStatus[item.ITEM_ID] = strVal;
                    arrWrk = item.LAST_DTTM.split(':');
                    //arrWrk.pop();
                    arrWrkTmpl.push(aObjNSbase.gFuncs.parseTemplate(strTblBodyTmpl.join(''), {
                            disableRow: (item.ITEM_VAL === '' ? 'style="color:lightgrey;"' : ''),
                            alertIcon : item.ITEM_CRITICAL,
                            RowMeasure: (BTILabs[item.ITEM_ID] === '' ? item.ITEM_ID : BTILabs[item.ITEM_ID]),
                            RowRange  : strRange,
                            RowDate   : arrWrk.join(':'),
                            RowLast   : strVal,
                            AltInd    : (item.ITEM_VAL !== '' ?processAlertStatus(strVal, item.ITEM_ID, aPtAge):'s.gif'),
                            RowUnits  : item.ITEM_UNITS,
                            RowTrend  : strList,
                            MTrend    : item.ITEM_ID + 'Trend'
                        })
                    );
                }
            );
            strFormattedValue = aObjNSbase.gFuncs.parseTemplate(arrWrk.join(''), {TblBody: arrWrkTmpl.join('')});
            sectionObj.initValues({
                idLabel      : sectionData.SectionID,
                TLabel1      : sectionData.TLabel1,
                SectionClosed: sectionData.SectionClosed,
                SectionCnt   : '',
                SectionCntVal: '',
                ContentBody  : strFormattedValue,
                TemplateType : sectionData.TemplateType,
                CustIcon     : 'None'
            });
            strRetValue              = sectionObj.generateHTML();
            sectionData.SectionDivID = sectionObj.SectionDivID;
            return strRetValue;
        }

        /**
         *
         * @param aLastVal
         * @param aItem
         * @param aFlip
         * @param aPtAge
         * @returns {string}
         */
        function processAlertStatusProd(aLastVal, aItem,aFlip,aPtAge) {
            var ageComponents,
                ageValue,
                ageRange,
                arrValues,
                retVal = 1,
                retAction,
                // retOK = 's.gif" style="width:16px;height:22px; background: url(' + chla.global.imgPath ,
                // retCaution ='s.gif" style="width:16px;height:22px; background: url(' + chla.global.imgPath,
                retOK = 's.gif" style="width:32px;height:42px; background: url(' + chla.global.imgPath,
                retCaution = 's.gif" style="width:32px;height:42px; background: url(' + chla.global.imgPath,
                AlertRanges = {
                    "HOUR" : "Month6",
                    "DAY"  : "Month6",
                    "WEEK" : "Month6",
                    "MONTH": "MonthCalc",
                    "YEAR" : "Month7"
                };
            switch (aItem) {
                case 'HGB':
                    retOK +=  'BtIndLabsHist_icons_OK.jpg) 0  -2px;';
                    retCaution += 'BtIndLabsHist_icons_Caution.jpg) 0  -2px;';
                    // retCaution += 'BtIndLabsHist_icons_Caution_16.jpg) 0  -2px;';
                    // retOK +=  'BtIndLabsHist_icons_OK_16.jpg) 0  -2px;';
                    if (aLastVal < 7) {
                        retVal = 0;
                    }
                    break;
                case 'PLT':
                    retOK += 'BtIndLabsHist_icons_OK.jpg) 0 -51px ;';
                    retCaution += 'BtIndLabsHist_icons_Caution.jpg) 0 -45px;';
                    //  retCaution += 'BtIndLabsHist_icons_Caution_16.jpg) 0  -26px;';
                    // retOK +=  'BtIndLabsHist_icons_OK_16.jpg) 0  -26px;';
                    if (aLastVal < 10) {
                        retVal = 0;
                    }
                    break;
                case 'PTT':
                    retOK +='BtIndLabsHist_icons_OK.jpg) 0 -102px ;';
                    retCaution += 'BtIndLabsHist_icons_Caution.jpg) 0 -90px;';
                    // retCaution += 'BtIndLabsHist_icons_Caution_16.jpg) 0  -134px;';
                    // retOK +=  'BtIndLabsHist_icons_OK_16.jpg) 0  -146px;';
                    if ( aLastVal > 39) {
                        retVal = 0;
                    }
                    break;
                case 'PT':
                    /*
                    PT (for 0-6 months)          > 14.7 sec Consistent with Tx
                                             <=14.7 sec Not Consistent with Tx

                    PT ( > 6 months)                > 12.5 sec Consistent with Tx
                                             <=12.5 sec Not Consistent with Tx

                     */
                    ageComponents = aPtAge.trim().split(' ');
                    ageRange = ageComponents[1].toUpperCase().replace('S','');
                    ageValue = ageComponents[0];
                    arrValues = AlertRanges[ageRange];

                    retOK +='BtIndLabsHist_icons_OK.jpg) 0 -102px ;';
                    retCaution += 'BtIndLabsHist_icons_Caution.jpg) 0 -90px;';
                    // retCaution += 'BtIndLabsHist_icons_Caution_16.jpg) 0  -134px;';
                    // retOK +=  'BtIndLabsHist_icons_OK_16.jpg) 0  -146px;';
                    retAction = 0;
                    if (arrValues === 'Month6') {
                        retAction = 1;
                    } else if (arrValues === 'MonthCalc') {
                        retAction = 1;
                        if (ageValue > 6 ){
                            retAction = 2;
                        }
                    } else if (arrValues === 'Month7') {
                        retAction = 2;
                    }
                    if (  retAction === 1){
                        if (aLastVal > 14.5) {
                            retVal = 0;
                        }
                    }else if (  retAction === 2){
                        if (aLastVal > 12.5) {
                            retVal = 0;
                        }
                    }
                    break;
                case 'INR':
                    retOK +='BtIndLabsHist_icons_OK.jpg) 0 -102px ;';
                    retCaution += 'BtIndLabsHist_icons_Caution.jpg) 0 -90px;';
                    // retCaution += 'BtIndLabsHist_icons_Caution_16.jpg) 0  -134px;';
                    // retOK +=  'BtIndLabsHist_icons_OK_16.jpg) 0  -146px;';
                    if (aLastVal > 1.5) {
                        retVal = 0;
                    }
                    break;
                case 'FIBRINOGEN':
                    retOK += 'BtIndLabsHist_icons_OK.jpg) 0 -150px ;';
                    retCaution += 'BtIndLabsHist_icons_Caution.jpg) 0 -132px;';
                    // retCaution += 'BtIndLabsHist_icons_Caution_16.jpg) 0  -154px;';
                    // retOK +=  'BtIndLabsHist_icons_OK_16.jpg) 0  -168px;';
                    if (aLastVal < 100) {
                        retVal = 0;
                    }
                    break;
                default:
                    retOK =  's.gif" style="width:32px;height:42px;';
                    retCaution =  's.gif" style="width:32px;height:42px;';
                    break;
            }
            return  (retVal === 0 ? retOK : retCaution );
        }
        /**
         *
         * @param aLastVal
         * @param aItem
         * @param aPtAge
         * @returns {string}
         */
        function processAlertStatus(aLastVal, aItem, aPtAge ) {
            var ageComponents = aPtAge.trim().split(' '),
                ageValue,
                ageRange,
                arrValues,
                retAction = 0,
                retVal =1,
                AlertRanges = {
                    "HOUR" : "Month6",
                    "DAY"  : "Month6",
                    "WEEK" : "Month6",
                    "MONTH": "MonthCalc",
                    "YEAR" : "Month7"
                },
                retOK = 's.gif" style="width:16px;height:22px; background: url(' + chla.global.imgPath ,
                retCaution ='s.gif" style="width:16px;height:22px; background: url(' + chla.global.imgPath;

            ageRange = ageComponents[1].toUpperCase().replace('S','');
            ageValue = ageComponents[0];
            arrValues = AlertRanges[ageRange];
            switch (aItem) {
                case 'HGB':
                    retCaution += 'BtIndLabsHist_icons_Caution_16.jpg) 0  -2px;';
                    retOK +=  'BtIndLabsHist_icons_OK_16.jpg) 0  -2px;';
                    if (aLastVal < 7) {
                        retVal = 0;
                    }
                    break;
                case 'PLT':
                    retCaution += 'BtIndLabsHist_icons_Caution_16.jpg) 0  -26px;';
                    retOK +=  'BtIndLabsHist_icons_OK_16.jpg) 0  -26px;';
                    if (aLastVal < 10) {
                        retVal = 0;
                    }
                    break;
                case 'PTT':
                    retCaution += 'BtIndLabsHist_icons_Caution_16.jpg) 0  -134px;';
                    retOK +=  'BtIndLabsHist_icons_OK_16.jpg) 0  -146px;';
                    if ( aLastVal > 39) {
                        retVal = 0;
                    }
                    break;
                case 'PT':
                    retCaution += 'BtIndLabsHist_icons_Caution_16.jpg) 0  -134px;';
                    retOK +=  'BtIndLabsHist_icons_OK_16.jpg) 0  -146px;';
                    if (arrValues === 'Month6') {
                       retAction = 1;
                    } else if (arrValues === 'MonthCalc') {
                       retAction = 1;
                       if (ageValue > 6 ){
                            retAction = 2;
                       }
                    } else if (arrValues === 'Month7') {
                       retAction = 2;
                    }
                    if (  retAction === 1){
                        if (aLastVal > 14.5) {
                            retVal = 0;
                        }
                    }else if (  retAction === 2){
                        if (aLastVal > 12.5) {
                            retVal = 0;
                        }
                    }
                    break;
                case 'INR':
                    retCaution += 'BtIndLabsHist_icons_Caution_16.jpg) 0  -134px;';
                    retOK +=  'BtIndLabsHist_icons_OK_16.jpg) 0  -146px;';
                    if (aLastVal > 1.5) {
                        retVal = 0;
                    }
                    break;
                case 'FIBRINOGEN':
                    retCaution += 'BtIndLabsHist_icons_Caution_16.jpg) 0  -154px;';
                    retOK +=  'BtIndLabsHist_icons_OK_16.jpg) 0  -168px;';
                    if (aLastVal < 100) {
                        retVal = 0;
                    }
                    break;
                default:
                    retVal =  's.gif';
                    break;
            }
            return (retVal === 0 ? retOK : retCaution );
        }
        BodyContent = processH5_BTIlab(aObjNSbase, aObjCcBase,DtoDataUI.BTIlab_SectionData,DtoDataUI.PERSON_AGE);

        arrWrk.push('<div style="text-align: center;">');
        if ( iconStatus.HGB !== '') {
            arrWrk.push('<img src="');
            arrWrk.push(chla.global.imgPath);
            arrWrk.push(processAlertStatusProd(iconStatus.HGB, 'HGB', true));
            arrWrk.push('"/>RBC ');
        }
        if ( iconStatus.PLT !== '') {
            arrWrk.push('<img src="');
            arrWrk.push(chla.global.imgPath);
            arrWrk.push(processAlertStatusProd(iconStatus.PLT, 'PLT', true));
            arrWrk.push('"/>Platelet ');
        }
        if ( iconStatus.PT !== '' || iconStatus.PTT !== '' ||iconStatus.INR !== '') {
            arrWrk.push('<img src="');
            arrWrk.push(chla.global.imgPath);
            ffpNotConsistent = false;
            if (typeof iconStatus.INR !== 'undefined') {
                strWrk = processAlertStatusProd(iconStatus.INR, 'INR', true);
                if (strWrk.indexOf('BtIndLabsHist_icons_Caution') > -1) {
                    ffpNotConsistent = true;
                }
            }
            if (typeof iconStatus.PT !== 'undefined' && ffpNotConsistent === false) {
                strWrk = processAlertStatusProd(iconStatus.PT, 'PT', true, DtoDataUI.PERSON_AGE);
                if (strWrk.indexOf('BtIndLabsHist_icons_Caution') > -1) {
                    ffpNotConsistent = true;
                }
            }
            if (typeof iconStatus.PTT !== 'undefined' && ffpNotConsistent === false) {
                strWrk = processAlertStatusProd(iconStatus.PTT, 'PTT', true, DtoDataUI.PERSON_AGE);
            }
            arrWrk.push(strWrk);
            arrWrk.push('"/>FFP ');
        }
        if ( iconStatus.FIBRINOGEN !== '') {
            arrWrk.push('<img src="');
            arrWrk.push(chla.global.imgPath);
            arrWrk.push(processAlertStatusProd(iconStatus.FIBRINOGEN, 'FIBRINOGEN', true));
            arrWrk.push('"/>Cryo');
        }
        arrWrk.push('</div>');
        arrWrk.push('<div style="text-align: left;font-size: 10px;">See Legend for Overrides where Alerts/MPage may incorrectly indicate transfusion not indicated</div>')
        sectionObj.initValues({
            idLabel      : 'btIndLabsIcon',
            TLabel1      : 'The blood drop below indicates if transfusion is indicated based on meeting any of the laboratory parameters',
            SectionClosed: 'OPEN',
            SectionCnt   : '',
            SectionCntVal: '',
            ContentBody  : arrWrk.join(''),
            TemplateType : 'H5',
            CustIcon     : 'None'
        });

        arrRetValue.push(sectionObj.generateHTML());

        arrRetValue.push(BodyContent);
        return arrRetValue.join('');
    };
    /**
     * Parent function for processing functions after the UI has been render to the DOM
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    btIndLabHist.ccnsp.processPostCcInstance  = function (aObjNSbase, aObjCcBase) {
        function renderSparkline(strWrk) {
            $(strWrk).sparkline('html',{width:'100px',height:'20px', defaultPixelsPerValue:'5px',linewidth:'2px'});
        }
        renderSparkline('#HGBTrend');
        renderSparkline('#PLTTrend');
        renderSparkline('#PTTTrend');
        renderSparkline('#PTTrend');
        renderSparkline('#INRTrend');
        renderSparkline('#FIBRINOGENTrend');
    };

    /**
     *  Call to build CC and to render to CC framework
     */
    btIndLabHist.ccnsp.ProcessCtl(btIndLabHist.ccnsp,component);

};
/*======   REQUIRED FILE TERMINATOR INDICATOR ======*/
chla['btIndPhysHist'].prototype.render = function() {
    'use strict';
    var  component = this,
        /**
         * variable to contain working object for cc rendering
         */
        btIndPhysHist;
    /**
     *  initialize the variable with the CC Module base class
     */
    btIndPhysHist  = chla.eAppsClass.gCcModule.createCcModuleCls.neo();
    /*----------------------------------------------------*/
    /* Replace these functions with this CC specific code.*/
    /*----------------------------------------------------*/
    /**
     * Parent function for processing the JSON data received for display
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @returns {*} retVal is fully process data for content body
     */
    btIndPhysHist.ccnsp.processData = function (aObjNSbase, aObjCcBase) {
        var DtoData,
            objRetValue = {},
            boolUseDummyData = (typeof aObjCcBase.CCcfg.DummyData !== 'undefined'? aObjCcBase.CCcfg.DummyData: false);
        if(boolUseDummyData){
            DtoData = chla.eAppsCCFrmWrk[aObjCcBase.CCcfg.cclProgram.toUpperCase()].RPTDATA;
        }else {
            DtoData = aObjCcBase.eApps.getJsonDataDto(aObjCcBase);
        }
        /**
         *
         * @param aObjNSbase
         * @param arrDataMarkers  {string }  - 'BTIPhysiological' or 'BTILabs'
         * @param aSectionCfg
         * @param aDtoData
         * @returns {*}
         */
        function processSectionData(aObjNSbase,arrDataMarkers,aSectionCfg,aDtoData) {
            var BTI_RPTDATA_Markers = {
                    BTIPhysiological: [
                        'SBP',
                        'DBP',
                        'PULSE',
                        'MEANAP'
                    ]
                },
                SectionData_DTO,
                objData;
            objData = aDtoData;
            SectionData_DTO = aObjNSbase.gSectionDataCls.neo(
                aSectionCfg.T_type,
                aSectionCfg.SecId,
                aSectionCfg.TLblId,
                aSectionCfg.SecLvl,
                aSectionCfg.SecTgl
            );
            SectionData_DTO.Body = [];
            /*#################################################################### */
            /* Need function to process loop json data for the group the data records*/
            /* by type: 'BTIPhysiological' or 'BTILabs'                            */
            /*#################################################################### */
            BTI_RPTDATA_Markers[arrDataMarkers].forEach(
                /**
                 * Process each data record
                 * @param item {string} BTI_RPTDATA_Markers of types BTIPhysiological or BTILabs
                 */
                function (item) {
                    var objRetVal = {
                            ITEM_ID:'',
                            LAST_DTTM: '',
                            ITEM_VAL:'',
                            ITEM_UNITS:'',
                            ITEM_RANGE: '',
                            ITEM_CRITICAL:'',
                            ITEM_CRITICAL_HIGH:'',
                            ITEM_CRITICAL_LOW:'',
                            ITEM_LIST:[]
                        },
                        arrItems,
                        arrItems2,
                        arrItemsRev,
                        arrWrk    = [];
                    arrWrk.push(item + '_CNT');             /*0    SBP_CNT,DBP_CNT,PULSE_CNT,MEANAP_CNT*/
                    arrWrk.push(item + '_LAST_DTTM');       /*1    SBP_LAST_DTTM,DBP_LAST_DTTM,PULSE_LAST_DTTM,MEANAP_LAST_DTTM */
                    arrWrk.push(item + '_LIST');            /*2    SBP_LIST,DBP_LIST,PULSE_LIST,MEANAP_LIST */
                    objRetVal.ITEM_ID   = item;             /* custom label to be used */
                    /*------------------------------------------------------------------*/
                    /* Determine if this is a record type to be processed               */
                    /*------------------------------------------------------------------*/
                    if ( objData[arrWrk[0]] !== 0 ) {
                        arrItems = objData[arrWrk[2]];
                        if ((typeof arrItems !== 'undefined') && arrItems.length > 0){
                            objRetVal.LAST_DTTM = arrItems[0].DATE;
                            objRetVal.ITEM_VAL  = arrItems[0][objRetVal.ITEM_ID];
                            //sort order lowest to highest
                            arrItemsRev = arrItems.reverse();
                            objRetVal.ITEM_LIST = arrItemsRev.map(
                                function(item){
                                    var retVal = item[objRetVal.ITEM_ID].replace(/mm HG/g,'');
                                    retVal = retVal.replace(/bpm/g,'');
                                    return (retVal);
                                }
                            );
                            arrItems2 = objRetVal.ITEM_LIST.slice();
                            arrItems2 = arrItems2.sort(function(a, b){return a-b});
                            objRetVal.ITEM_RANGE = arrItems2[0] + '-' + arrItems2.pop();
                        }
                    }
                    SectionData_DTO.Body.push(objRetVal);
                }
            );
            return SectionData_DTO;
        }
        objRetValue.PERSON_AGE = DtoData.PERSON_AGE;
        objRetValue.BTIphysio_SectionData = processSectionData(aObjNSbase,'BTIPhysiological',
            {
                T_type: 'H5',
                SecId: 'BTIphysio' ,
                TLblId: '<span style="font-weight:800">Last Physiological Results </span>' ,
                SecClsd: 'open',
                SecLvl:'H5',
                SecTgl:''
            },
            DtoData);
        return objRetValue;
    };
    /**
     * Parent function for construction of the UI
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @returns {string} arrRetValue.join('') is html formatted content body of CC
     */
    btIndPhysHist.ccnsp.processUI   = function (aObjNSbase, aObjCcBase) {
        var arrRetValue = [],
            strWrk,
            arrWrk = [],
            statusAlertInd = 0,
            btIndPhy_Items_Present = 0,
            sectionObj     = aObjNSbase.gSectionHeaderCtlCls.neo(),
            DtoDataUI;
            DtoDataUI = aObjCcBase.eApps.getDataDto(aObjCcBase);
        /**
         *
         * @param aObjNSbase
         * @param aObjCcBase
         * @param aDtoUi
         * @param aPtAge
         * @returns {string}
         */
        function processH5_BTIphysio(aObjNSbase, aObjCcBase,aDtoUi,aPtAge) {
            var sectionObj     = aObjNSbase.gSectionHeaderCtlCls.neo(),
                sectionData    = aDtoUi,
                arrWrkTmpl     = [],
                strTblBodyTmpl = [
                    '<tr <#=disableRow#>  style="line-height:10px;"><td>&nbsp;<#=alertIcon#></td>',
                    '<td <#=MeasureCss#>><#=RowMeasure#></td>',
                    '<td><#=RowRange#></td>',
                    '<td><#=RowLast#>',
                    ' <span class="eapps-unitsHO" style="font-size:9px;"><#=RowUnits#></span></td>',
                    '<td><span style="color:#7C7C7C;font-size: 9px;"><#=Dttm#></span></td>',
                    '<td><img src="',
                    chla.global.imgPath,
                    //'<td><','img style="width: 16px;height: 16px;padding-left:3px;"',
                    //' src="',
                    //chla.global.imgPath,
                    '<#=AltInd#>"/></td>',
                    '<td id="<#=MTrend#>Trend"><#=RowTrend#></td></tr>'],
                arrWrk         = [
                    '<table><tr><th style="width:30px;">&nbsp;</th>',
                    '<th style="width:80px;">Measure</th>',
                    '<th style="width:100px;">Last 5 Rslts w/i 24 Hrs&nbsp;</th>',
                    '<th style="width:100px;">Last Result w/i 24 Hrs</th>', //<br/> (Within 24 hrs)</th>',
                    '<th style="width:130px;">&nbsp;&nbsp;Date</th>',
                    '<th style="width:19px;">&nbsp;</th>',
                    '<th>Trend</th></tr>',
                    '<#=TblBody#></table>'
                ],
                BTIPhysiological =  {
                        'SBP'   : '',
                        'DBP'   : '',
                        'PULSE' : '',
                        'MEANAP': 'MAP'
                },
                strFormattedValue,
                strRetValue;
                aObjCcBase.eApps.BTIphysioSparkline = [];
                sectionData.Body.forEach(
                    function (item) {
                        var arrWrk = [],
                            strWrk,
                            strLbl,
                            strList,
                            strRng,
                            arrWrk,
                            strItem,
                            strCssMeaure = '';
                        arrWrk.push('div#');
                        arrWrk.push(aObjCcBase.eApps.getCc_id(aObjCcBase));
                        arrWrk.push(' td#');
                        arrWrk.push(item.ITEM_ID);
                        arrWrk.push('Trend');
                        aObjCcBase.eApps.BTIphysioSparkline.push(arrWrk.join(''));
                        if (item.ITEM_ID === 'PULSE'){
                            strWrk =  item.ITEM_VAL.replace('bpm','');
                            strLbl = ' bpm';
                            strRng =  item.ITEM_RANGE.replace(/bpm/g,'');
                            strList=  item.ITEM_LIST.join().replace(/bpm/g,'');
                        } else {
                            strWrk =  item.ITEM_VAL.replace('mm HG','');
                            strLbl =  ' mm HG';
                            strRng =  item.ITEM_RANGE.replace(/mm HG/g,'');
                            strList=  item.ITEM_LIST.join().replace(/mm HG/g,'');
                        }
                        strItem = (BTIPhysiological[item.ITEM_ID] === ''? item.ITEM_ID:BTIPhysiological[item.ITEM_ID]);
                        if (strItem === 'MEAN ARTERIAL PRESSURE'){
                            strCssMeaure = 'style="font-size:11px;line-height:12px;"';
                        }
                        if (item.ITEM_VAL !== ''){
                            btIndPhy_Items_Present += 1;
                        }
                        arrWrk = item.LAST_DTTM.split(':');
                       // arrWrk.pop();
                        arrWrkTmpl.push(aObjNSbase.gFuncs.parseTemplate(strTblBodyTmpl.join(''), {
                            disableRow: (item.ITEM_VAL === ''? 'style="color:lightgrey;"':''),
                            alertIcon : item.ITEM_CRITICAL,
                            RowMeasure: (BTIPhysiological[item.ITEM_ID] === ''? item.ITEM_ID:BTIPhysiological[item.ITEM_ID]) ,
                            RowRange  : strRng,
                            RowLast   : strWrk,
                            Dttm      : arrWrk.join(':'),
                            AltInd    : (item.ITEM_VAL !==''?processAlertStatusPhys(parseInt(strWrk),item.ITEM_ID,aPtAge):'s.gif'),
                            RowUnits  : (item.ITEM_VAL !==''? strLbl:''),
                            RowTrend  : strList,
                            MTrend    : item.ITEM_ID,
                            MeasureCss: strCssMeaure,
                            CircleStatus: ''
                        }));
                    }
                );
                strFormattedValue = aObjNSbase.gFuncs.parseTemplate(arrWrk.join(''), {
                    TblBody: arrWrkTmpl.join('')
                });
                sectionObj.initValues({
                    idLabel      : sectionData.SectionID,
                    TLabel1      : sectionData.TLabel1,
                    SectionClosed: sectionData.SectionClosed,
                    SectionCnt   : '',
                    SectionCntVal: '',
                    ContentBody  : strFormattedValue,
                    TemplateType : sectionData.TemplateType,
                    CustIcon     : 'None'
                });
                strRetValue              = sectionObj.generateHTML();
                sectionData.SectionDivID = sectionObj.SectionDivID;
            return strRetValue;
        }
        /**
         *
         * @param aLastVal
         * @param aItem
         * @param aPtAge
         * @returns {object} Range list
         */
        function processAlertStatusPhys(aLastVal, aItem,aPtAge){
            var AlertRanges = {
                    "HOUR" : {
                        Lval: [
                            {RNG: '-', OP: 'NU', aVal: {HR: 160, LSBP: 60, LDBP: 40, LMAPSBP: 73, LMAPDBP: 52}}
                        ]
                    },
                    "DAY"  : {
                        Lval: [
                            {RNG: '-', OP: 'NU', aVal: {HR: 160, LSBP: 60, LDBP: 40, LMAPSBP: 73, LMAPDBP: 52}}
                        ]
                    },
                    "WEEK" : {
                        Lval: [
                            {RNG: '3', OP: 'LE', aVal: {HR: 160, LSBP: 60, LDBP: 40, LMAPSBP: 73, LMAPDBP: 52}},
                            {RNG: '4', OP: 'EQ', aVal: {HR: 160, LSBP: 60, LDBP: 40, LMAPSBP: 90, LMAPDBP: 53}}
                        ]
                    },
                    "MONTH": {
                        Lval: [
                            {RNG: '3', OP: 'LE', aVal: {HR: 160, LSBP: 60, LDBP: 40, LMAPSBP: 90, LMAPDBP: 53}},
                            {RNG: '4', OP: 'EQ', aVal: {HR: 150, LSBP: 70, LDBP: 50, LMAPSBP: 90, LMAPDBP: 53}},
                            {RNG: '11',OP: 'LE', aVal: {HR: 150, LSBP: 70, LDBP: 50, LMAPSBP: 90, LMAPDBP: 53}},
                            {RNG: '23',OP: 'LE', aVal: {HR: 130, LSBP: 85, LDBP: 55, LMAPSBP: 95, LMAPDBP: 56}}
                        ]
                    },
                    "YEAR" : {
                        Lval: [
                            {RNG: '2', OP: 'EQ', aVal: {HR: 130, LSBP: 85, LDBP: 55, LMAPSBP: 95,  LMAPDBP: 56}},
                            {RNG: '4', OP: 'LE', aVal: {HR: 130, LSBP: 85, LDBP: 40, LMAPSBP: 99,  LMAPDBP: 55}},
                            {RNG: '5', OP: 'EQ', aVal: {HR: 110, LSBP: 90, LDBP: 60, LMAPSBP: 99,  LMAPDBP: 55}},
                            {RNG: '11',OP: 'LE', aVal: {HR: 110, LSBP: 90, LDBP: 60, LMAPSBP: 97,  LMAPDBP: 60}},
                            {RNG: '17',OP: 'LE', aVal: {HR: 100, LSBP: 95, LDBP: 65, LMAPSBP: 110, LMAPDBP: 63}},
                            {RNG: '18',OP: 'GE', aVal: {HR: 100, LSBP: 95, LDBP: 65, LMAPSBP: 113, LMAPDBP: 65}}
                        ]
                    }
                },
                ageComponents = aPtAge.trim().split(' '),
                LvalEntry =  '',
                ageValue,
                FullLvalEntry,
                ageRange,
                arrValues,
                retVal = 0,
                retOK = 's.gif" style="width:16px;height:22px; background: url(' + chla.global.imgPath +   'BtIndLabsHist_icons_OK_16.jpg) 0  -2px;',
                retCaution = 's.gif" style="width:16px;height:22px; background: url(' + chla.global.imgPath +'BtIndLabsHist_icons_Caution_16.jpg) 0  -2px;';

            ageRange = ageComponents[1].toUpperCase().replace('S','');
            ageValue = parseInt(ageComponents[0]);
            arrValues = AlertRanges[ageRange].Lval;

            arrValues.forEach(
                function (item) {
                    /*
                    ageRangeType
                       HOUR
                       DAY
                       WEEK
                       MONTH
                       YEAR
                   item.RNG   : #
                   item.OP    :
                      -       RETURN aVal
                      EQ      RETURN aVal
                      LE      test ageValue <= #
                                  NO   Return { RESULT: false}
                      YES  Return aVal
                      GE      test >=
                      NO   Return { RESULT: false}
                      YES  Return aVal
                      */
                    if (LvalEntry === '') {
                       FullLvalEntry = item;
                        switch (item.OP) {
                            case 'NU':
                                LvalEntry = item.aVal;
                                break;
                            case 'EQ':
                                if (ageValue === item.RNG) {
                                    LvalEntry = item.aVal;
                                }
                                break;
                            case 'LE':
                                if (ageValue <= item.RNG ) {
                                    LvalEntry = item.aVal;
                                }
                                break;
                            case 'GE':
                                if (ageValue <= item.RNG ) {
                                    LvalEntry = item.aVal;
                                }
                                break;
                        }
                    }
                }
            );
            chla.eAppsUtil.Logger.LogInfo(
                'aVal: ' +
                [
                    ' aItem: ', aItem,
                    ', value: ', aLastVal,
                    ', typeof: ', typeof(aLastVal),
                    ', AGE: ', aPtAge,
                    ', RNG: ', FullLvalEntry.RNG,
                    ', OP: ' , FullLvalEntry.OP,
                    ', HR: ', LvalEntry.HR,
                    ', LSBP: : ',LvalEntry.LSBP,
                    ', LDBP: : ',LvalEntry.LDBP,
                    ', LMAPDBP: ',LvalEntry.LMAPDBP ].join('')
            );
            // aVal: {HR: 100, LSBP: 95, LDBP: 65, LMAPSBP: 113, LMAPDBP: 65}
            switch (aItem){
                case 'PULSE':   //HR
                    if (aLastVal > LvalEntry.HR   ){
//                        chla.eAppsUtil.Logger.LogInfo("HR outofrange");
                        retVal = 1;
                        }
                    break;
                case 'SBP':     //LSBP
                    if (  aLastVal < LvalEntry.LSBP  ){
//                         chla.eAppsUtil.Logger.LogInfo("SBP outofrange");
                        retVal = 1;
                        }
                    break;
                case 'DBP':     //LDBP
                    if ( aLastVal < LvalEntry.LDBP  ) {
//                         chla.eAppsUtil.Logger.LogInfo("DBP outofrange");
                        retVal = 1;
                        }
                    break;
                case 'MEANAP':  //LMAPDBP
                    if ( aLastVal < LvalEntry.LMAPDBP   ){
//                        chla.eAppsUtil.Logger.LogInfo("MAP outofrange");
                        retVal = 1;
                        }
                    break;

            }
            if (retVal === 1 ){        // 1 indicate value out of range
                statusAlertInd += 1;
            }
//             chla.eAppsUtil.Logger.LogInfo((retVal === 0 ? "retCaution": "retOK"));
            return (retVal === 0 ? retCaution: retOK);
        }
        strWrk = processH5_BTIphysio(aObjNSbase, aObjCcBase, DtoDataUI.BTIphysio_SectionData,DtoDataUI.PERSON_AGE);
        if (btIndPhy_Items_Present > 0) {
            arrWrk.push('<div style="text-align: center;"><img src="');
            arrWrk.push(chla.global.imgPath);
            arrWrk.push('s.gif" style="width:32px;height:42px; background: url(', chla.global.imgPath);
            if (statusAlertInd > 0) {
                arrWrk.push('BtIndLabsHist_icons_OK.jpg) 0  -2px;');
            } else {
                arrWrk.push('BtIndLabsHist_icons_Caution.jpg) 0  -2px;');
            }
            arrWrk.push('"/>RBC</div>');

        }
         arrWrk.push('<div style="text-align: left;font-size: 10px;">See Legend for Overrides where Alerts/MPage may incorrectly indicate transfusion not indicated</div>');
        sectionObj.initValues({
            idLabel      : 'btIndLabsIcon',
            TLabel1      : 'The blood drop below indicates if transfusion is indicated based on meeting any of the physiological parameters',
            SectionClosed: 'OPEN',
            SectionCnt   : '',
            SectionCntVal: '',
            ContentBody  : arrWrk.join(''),
            TemplateType : 'H5',
            CustIcon     : 'None'
        });

        arrRetValue.push(sectionObj.generateHTML());
        arrRetValue.push(strWrk);
        return arrRetValue.join('');
    };
    /**
     * Parent function for processing functions after the UI has been render to the DOM
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    btIndPhysHist.ccnsp.processPostCcInstance  = function (aObjNSbase, aObjCcBase) {
        function renderSparkline(strWrk) {
            $(strWrk).sparkline('html',{width:'100px',height:'20px', defaultPixelsPerValue:'5px',linewidth:'2px'});
        }
        renderSparkline('#SBPTrend');
        renderSparkline('#DBPTrend');
        renderSparkline('#PULSETrend');
        renderSparkline('#MEANAPTrend');
    };

    /**
     *  Call to build CC and to render to CC framework
     */
    btIndPhysHist.ccnsp.ProcessCtl(btIndPhysHist.ccnsp,component);

};
/*======   REQUIRED FILE TERMINATOR INDICATOR ======*/
chla['btreact'].prototype.render = function () {
    'use strict';
    var  component = this,
         btreact;
    btreact  = chla.eAppsClass.gCcModule.createCcModuleCls.neo();
    btreact.ccnsp.processUI   = function (aObjNSbase, aObjCcBase) {
    //aObjCcBase.eApps.mainSectionStyle = 'height:230px;';
     //   return( '<div style="text-align:center;"><br/><br/><br/><h2>Transfusion Reactions: NA </h2><br/></div>');
	 return( '<div style="text-align:center;"><br/><br/>This module will display transfusion reaction data elements including: dates, signs, symptoms, and associated pre-medication <br/></div>');
    };
    btreact.ccnsp.ProcessCtl(btreact.ccnsp,component);
};
chla['BTlegend'].prototype.render = function () {
    'use strict';
    var  component = this,
         BtLegend;
    BtLegend  = chla.eAppsClass.gCcModule.createCcModuleCls.neo();
    BtLegend.ccnsp.processUI   = function (aObjNSbase, aObjCcBase) {
        var arrWrk =[],
            strHtml   = [];
        arrWrk.push('<div style="text-align:center;width:100%;"><br/><span style="font-size: large;font-weight: 800;">Transfusion Icon Legend</span><br/></div>',
            '<div style="width:100%;"><br/><span style="font-size: 16px;font-weight: 800;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Blood Consent Icons </span><br/>',
            '<table style="width:100%;"><tr><td style="width: 200px;border:0;">&nbsp;</td>',
            '<td style="border:0;width:50px;"><img height="40px" width="40px" src="');
        arrWrk.push(chla.global.imgPath);
        arrWrk.push('green_circle-256.png" alt="consent_present_state"style="padding-left:5px;"/></td>',
            '<td style="border:0;vertical-align: middle;"><span style="font-size:16px;"> = Blood Consent on file</span></td></tr>',
            '<tr style="border:0;font-size: 7px;line-height: 7px;"><td style="border:0;">&nbsp;</td><td style="border:0;">&nbsp;</td></tr>',
            '<tr style="border:0;"><td style="width: 200px;border:0;">&nbsp;</td>',
            '<td style="border:0;width: 50px;"><img height="40px" width="40px" src="');
        arrWrk.push(chla.global.imgPath);
        arrWrk.push('Yellow_circle-256.jpg" alt="consent_present_state" style="padding-left:5px;"/></td>',
            '<td style="border:0;vertical-align: middle;"><span style="font-size:16px;"> = No Blood Consent on file</span></td></tr></table><br/></div>',
            '<div style="width:95%;margin-left:20px;margin-right:20px;">',
            '<span style="font-size: 16px;font-weight: 800;"><br/>Blood Product Icons Indicating Laboratory or Physiological Parameters are Consistent with Transfusion: </span><br/><br/>',
            '<table style="width:100%;"><tr><td style="width: 200px;border:0;">&nbsp;</td><td style="border:0;">',
            '<table><tr style="text-align:center;height:40px;"><td style="border:0;width:120px;">&nbsp;</td>',
            '<td style="border:0;width:160px;font-size:16px;">Consistent<br/>With Transfusion</td><td style="border:0;width:20px;" >&nbsp;</td>',
            '<td style="border:0;width:160px;font-size:16px;">Not Consistent<br/>With Transfusion</td><td style="border:0;" >&nbsp;</td></tr></table>',
            '<div ><img height="300px" width="450px" src="');
        arrWrk.push(chla.global.imgPath);
        arrWrk.push('BtIndLabsHist_iconsV2.jpg" alt="consent_present_state" style="padding-left:5px;"/></div>',
            '</td></tr></table><br/><br/></div>',
            '<div style="width:95%;margin-left:20px;margin-right:20px;"> <br/><span style="font-size: 16px;font-weight: 800;">Scenarios Where Transfusion May Not Be Indicated </span><br/>',
            '<table style="border: 1px solid black;"><tr>',
            '<td style="text-align: center;border-right: 1px solid lightgrey;">PRBC Tx Not Indicated = <br/><img src="');
        arrWrk.push(chla.global.imgPath);
        arrWrk.push('s.gif" style="width:32px;height:42px; background: url(');
        arrWrk.push(chla.global.imgPath);
        arrWrk.push('BtIndLabsHist_icons_Caution.jpg) 0  -2px;"/></td>',
            '<td style="text-align: center;border-right: 1px solid lightgrey;">Platelet Tx Not Indicated = <br/><img src="');
        arrWrk.push(chla.global.imgPath);
        arrWrk.push('s.gif" style="width:32px;height:42px; background: url(');
        arrWrk.push(chla.global.imgPath);
        arrWrk.push('BtIndLabsHist_icons_Caution.jpg) 0 -45px;"/></td>',
            '<td style="text-align: center;border-right: 1px solid lightgrey;">FFP Tx Not Indicated = <br/><img src="');
        arrWrk.push(chla.global.imgPath);
        arrWrk.push('s.gif" style="width:32px;height:42px; background: url(');
        arrWrk.push(chla.global.imgPath);
        arrWrk.push('BtIndLabsHist_icons_Caution.jpg) 0 -90px;"/></td>',
            '<td style="text-align: center;">Cryo Tx Not Indicated = <br/><img src="');
        arrWrk.push(chla.global.imgPath);
        arrWrk.push('s.gif" style="width:32px;height:42px; background: url(');
        arrWrk.push(chla.global.imgPath);
        arrWrk.push('BtIndLabsHist_icons_Caution.jpg) 0 -132px;"/></td>',
            '</tr><tr><td style="border-top: 1px solid grey;border-right: 1px solid lightgrey;">&nbsp;Hb &#8805; 7g/dl</td>',
            '<td style="border-top: 1px solid grey;border-right: 1px solid lightgrey;">&nbsp;Plt &#8805; 10k/ul</td>',
            '<td style="border-top: 1px solid grey;border-right: 1px solid lightgrey;">&nbsp;PTT &#8804; 39 seconds;</td>',
            '<td style="border-top: 1px solid grey;">Fibrinogen &gt; 100mg/dl</td>',
            '</tr><tr><td style="border-top: 1px solid grey;border-right: 1px solid lightgrey;">&nbsp;HR &lt; Age Adjusted High Normal</td>',
            '<td style="border-top: 1px solid grey;border-right: 1px solid lightgrey;">&nbsp;</td>',
            '<td style="border-top: 1px solid grey;border-right: 1px solid lightgrey;">&nbsp;PT &#8804; 12.5 seconds (0-6 mo old)<br/>&nbsp;PT &#8804; 14.7 seconds (&gt; 6 mo old)</td>',
            '<td style="border-top: 1px solid grey;">&nbsp;</td>',
            '</tr><tr><td style="border-top: 1px solid grey;border-right: 1px solid lightgrey;">&nbsp;SBP &gt; Age Adjusted Low Normal</td>',
            '<td style="border-top: 1px solid grey;border-right: 1px solid lightgrey;">&nbsp;</td>',
            '<td style="border-top: 1px solid grey;border-right: 1px solid lightgrey;">&nbsp;INR &#8804; 1.5</td>',
            '<td style="border-top: 1px solid grey;">&nbsp;</td></tr><tr>',
            '<td style="border-top: 1px solid grey;border-right: 1px solid lightgrey;">&nbsp;DBP &gt; Age Adjusted Low Normal</td>',
            '<td style="border-top: 1px solid grey;border-right: 1px solid lightgrey;">&nbsp;</td>',
            '<td style="border-top: 1px solid grey;border-right: 1px solid lightgrey;">&nbsp;</td>',
            '<td style="border-top: 1px solid grey;">&nbsp;</td></tr><tr>',
            '<td style="border-top: 1px solid grey;border-bottom-color: black;border-right: 1px solid lightgrey;">&nbsp;MAP &gt; Age Adjusted Low Normal</td>',
            '<td style="border-top: 1px solid grey;border-bottom-color: black;border-right: 1px solid lightgrey;">&nbsp;</td>',
            '<td style="border-top: 1px solid grey;border-bottom-color: black;border-right: 1px solid lightgrey;">&nbsp;</td>',
            '<td style="border-top: 1px solid grey;border-bottom-color: black;">&nbsp;</td></tr></table><br/><br/></div>',
            '<div style="width:95%;margin-left:20px;margin-right:20px;"> <br/><span style="font-size: 16px;font-weight: 800;">Overrides for Patients where Alerts/MPage may incorrectly indicate transfusion not indicated based on patient complexity</span><br/>',
            '<table style="border: 1px solid black;">',
            '<tr style="border-bottom: 1px solid black;">',
            '<td style="text-align: center;border-right: 1px solid lightgrey;">PRBC Tx Not Indicated =<br/><img src="');
        arrWrk.push(chla.global.imgPath);
        arrWrk.push('s.gif" style="width:32px;height:42px; background: url(');
        arrWrk.push(chla.global.imgPath);
        arrWrk.push('BtIndLabsHist_icons_Caution.jpg) 0  -2px;"/><br/>Alert Overrides </td>',
            '<td style="text-align: center;border-right: 1px solid lightgrey;">Platelet Tx Not Indicated =<br/><img src="');
        arrWrk.push(chla.global.imgPath);
        arrWrk.push('s.gif" style="width:32px;height:42px; background: url(');
        arrWrk.push(chla.global.imgPath);
        arrWrk.push('BtIndLabsHist_icons_Caution.jpg) 0 -45px;"/><br/>Alert Overrides </td>',
            '<td style="text-align: center;border-right: 1px solid lightgrey;">FFP Tx Not Indicated = <br/><img src="');
        arrWrk.push(chla.global.imgPath);
        arrWrk.push('s.gif" style="width:32px;height:42px; background: url(');
        arrWrk.push(chla.global.imgPath);
        arrWrk.push('BtIndLabsHist_icons_Caution.jpg) 0 -90px;"/><br/>Alert Overrides</td>',
            '<td style="text-align: center;">Cryo Tx Not Indicated =<br/><img src="');
        arrWrk.push(chla.global.imgPath);
        arrWrk.push('s.gif" style="width:32px;height:42px; background: url(');
        arrWrk.push(chla.global.imgPath);
        arrWrk.push('BtIndLabsHist_icons_Caution.jpg) 0 -132px;"/><br/>Alert Overrides </td>',
            '</tr><tr><td style="border-top: 1px solid grey;border-right: 1px solid lightgrey;">&nbsp;</td><td style="border-top: 1px solid grey;border-right: 1px solid lightgrey;">&nbsp;</td>',
            '<td style="border-top: 1px solid grey;border-right: 1px solid lightgrey;">&nbsp;</td><td style="border-top: 1px solid grey;">&nbsp;</td></tr><tr>',
            '<td style="border-top: 1px solid grey;border-bottom-color: black;border-right: 1px solid lightgrey;">&nbsp;</td>',
            '<td style="border-top: 1px solid grey;border-bottom-color: black;border-right: 1px solid lightgrey;">&nbsp;</td>',
            '<td style="border-top: 1px solid grey;border-bottom-color: black;border-right: 1px solid lightgrey;">&nbsp;</td>',
            '<td style="border-top: 1px solid grey;border-bottom-color: black;">&nbsp;</td></tr></table><br/><br/></div>',
            '<div style="width:95%;margin-left:20px;margin-right:20px;"> <br/><span style="font-size: 16px;font-weight: 800;">Common Transfusion Dosing and Transfusion Response</span><br/>',
            '<table style="border: 1px solid black;"><tr><td style="text-align: center;border-right: 1px solid lightgrey;"> Transfusion Type </td>',
            '<td style="text-align: center;border-right: 1px solid lightgrey;"> Transfusion Dose </td><td style="text-align: center;"> &nbsp;1 Hour Delta Response</td>',
            '<td style="text-align: center;"> 24 Hour Delta Response</td></tr><tr><td style="border-top: 1px solid grey;border-right: 1px solid lightgrey;">&nbsp;PRBC</td>',
            '<td style="border-top: 1px solid grey;border-right: 1px solid lightgrey;">&nbsp;10ml/kg</td>',
            '<td style="border-top: 1px solid grey;border-right: 1px solid lightgrey;">&nbsp;HGB: 2 g/dl</td>',
            '<td style="border-top: 1px solid grey;">&nbsp;HGB: 1.5 g/dl</td></tr><tr><td style="border-top: 1px solid grey;border-right: 1px solid lightgrey;">&nbsp;Platelet</td>',
            '<td style="border-top: 1px solid grey;border-right: 1px solid lightgrey;">&nbsp;10ml/kg</td>',
            '<td style="border-top: 1px solid grey;border-right: 1px solid lightgrey;">&nbsp;PLT:  25k/ul</td>',
            '<td style="border-top: 1px solid grey;">&nbsp;PLT: 15k/ul</td></tr><tr><td style="border-top: 1px solid grey;border-right: 1px solid lightgrey;">&nbsp;FFP</td>',
            '<td style="border-top: 1px solid grey;border-right: 1px solid lightgrey;">&nbsp;10-20ml/kg</td>',
            '<td style="border-top: 1px solid grey;border-right: 1px solid lightgrey;">&nbsp;PTT/PT/INR: Etiology Dependent</td>',
            '<td style="border-top: 1px solid grey;">&nbsp;PTT/PT/INR: Etiology Dependent</td></tr><tr>',
            '<td style="border-top: 1px solid grey;border-bottom-color: black;border-right: 1px solid lightgrey;">&nbsp;Cryo</td>',
            '<td style="border-top: 1px solid grey;border-bottom-color: black;border-right: 1px solid lightgrey;">&nbsp;1 unit per 10 kg of patient weight</td>',
            '<td style="border-top: 1px solid grey;border-bottom-color: black;border-right: 1px solid lightgrey;">&nbsp;Fibrinogen: 50mg/dl</td>',
            '<td style="border-top: 1px solid grey;border-bottom-color: black;">&nbsp;Fibrinogen: Etiology Dependent</td></tr></table><br/>',
            'Transfusion refractory states can be immune or non-immune (bleeding/consumption/sequestration).  Consider immune etiology with inadequate 1 hour response.  Consider restrictive transfusion in a non-bleeding patient refractory to transfusion. <br/></div>');
        strHtml.push(arrWrk.join(''));
        return strHtml.join('');
    };
    BtLegend.ccnsp.ProcessCtl(BtLegend.ccnsp,component);
} ;
/*======   REQUIRED FILE TERMINATOR INDICATOR ======*/

chla['POAnesthHist'].prototype.render = function() {
    var  component = this,
        /**
         * variable to contain working object for cc rendering
         */
        POAnesthHist;
    /**
     *  initialize the variable with the CC Module base class
     */
    POAnesthHist  = chla.eAppsClass.gCcModule.createCcModuleCls.neo();
    /*----------------------------------------------------*/
    /* Replace these functions with this CC specific code.*/
    /*----------------------------------------------------*/
    /**
     * Parent function for processing initialization specifically for the CC
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    POAnesthHist.ccnsp.postInit  = function (aObjNSbase, aObjCcBase) { };
    /**
     * Parent function for processing the JSON data received for display
     * Output of this function will be an object tha contains data items to be used in the presentation construction process.
     *  All data validation and transformations are done in this function
     *
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @param aDtoData {object} Dto object specifically defined by RPTDATA response from CCL request
     * @returns {*} {object} retVal is a CC specifically defined DTO for transferring data to presentation processing
     */
    POAnesthHist.ccnsp.processData = function (aObjNSbase, aObjCcBase,aDtoData) {
        var retVal = {},
			DtoData;
		retVal.data = [];
		//chla.eAppsUtil.Logger.LogError(JSON.stringify(aObjCcBase.data));
		if(aObjCcBase.data && aObjCcBase.data.ANESTHESIA_RECORD && aObjCcBase.data.ANESTHESIA_RECORD.FORMDATA) {
			DtoData = aObjCcBase.data.ANESTHESIA_RECORD.FORMDATA;
			DtoData.forEach(
				function (result) {
					var PRE_MED = '',
						med_cnt = result.PRE_MED.length;
					result.PRE_MED.forEach(
						function (med, index) {
							PRE_MED += '<span class="med-name-dose-noclick">' + med.MED_NAME + '</span><span class="med-route-freq-noclick">' + 
								med.CUSTOM_DISPLAY_LINE + (med_cnt - index > 1 ? '</span></br>': '</span>');
						}
					);
					var INDUC_CONDUCT = '<span ' + (result.INDUC_CONDUCT.toUpperCase().indexOf('UNCOOPERATIVE (SEVERE)') !== -1 ? 'class="encounter-error" ' : '') + 
						'data-qtip="' + result.INDUC_CONDUCT.replace(',<b>Comment: <\/b>', '</br><b>Comment: </b>') + '">' + result.INDUC_CONDUCT + '</span>';
					var AW_OBSTRUCT = '<span ' + (result.AW_OBSTRUCT.toUpperCase().indexOf('SEVERE OBSTRUCTION') !== -1 ? 
						'class="encounter-error" ' : (result.AW_OBSTRUCT.toUpperCase().indexOf('MODERATE OBSTRUCTION') !== -1 ? 'class="orange-warn" ' : '')) + 
						'data-qtip="' + result.AW_OBSTRUCT + '">' + result.AW_OBSTRUCT + '</span>';
					var INDUC_TYPE = '<span data-qtip="' + result.INDUC_TYPE.replace(/;/g, '</br>') + '">' + result.INDUC_TYPE.replace(';','; ') + '</span>';
					var ORAL_AW = '<span data-qtip="' + result.ORAL_AW.replace(/;/g, '</br>') + '">' + result.ORAL_AW.replace(';','; ') + '</span>';
					var VASC_ACCESS = '<span data-qtip="' + result.VASC_ACCESS.replace(/;/g, '</br>') + '">' + result.VASC_ACCESS.replace(';','; ') + '</span>';
					var REGIONAL = '<span data-qtip="' + result.REGIONAL.replace(/;/g, '</br>') + '">' + result.REGIONAL.replace(';','; ') + '</span>';
					var combinedComplications = result.COMPLICATIONS_COMMENTS !== "" ? result.COMPLICATIONS + ', ' + result.COMPLICATIONS_COMMENTS : result.COMPLICATIONS;
					var COMPLICATIONS = '<span data-qtip="' + combinedComplications.replace(/;<b>/g, '</br><b>') + '">' + combinedComplications + '</span>';
					var combinedNote = result.FREETEXT_COMMENTS !== "" ? result.NOTE + ', ' + result.FREETEXT_COMMENTS : result.NOTE;
					var NOTE = '<span data-qtip="' + combinedNote.replace(/;<b>Freetext/g, '</br><b>Freetext') + '">' + combinedNote + '</span>';
					var combinedNoteAndComplications = (combinedComplications ? combinedComplications + ' <br/> ' : '') + combinedNote;
					var truncatedNoteAndComplications = combinedNoteAndComplications.length > 180 ? combinedNoteAndComplications.substring(0,180) + '...' : combinedNoteAndComplications;
					var displayCombinedNoteComp = '<span data-qtip="' + combinedNoteAndComplications.replace(/;<b>Freetext/g, '</br><b>Freetext').replace(/;<b>/g, '</br><b>') + '">' + truncatedNoteAndComplications + '</span>';
					retVal.data.push({
						"A": result.ANESTHESIA_START_DT_TM_STR,
						"B": result.SURG_PROCEDURE,
						"C": PRE_MED,
						//"D": result.PARENT_AT_IND,
						"E": (result.PARENT_AT_IND ? result.PARENT_AT_IND + "; " : "") + INDUC_TYPE,
						"F": INDUC_CONDUCT,
						"G": AW_OBSTRUCT,
						"H": ORAL_AW,
						"I": VASC_ACCESS,
						"J": REGIONAL,
						"K": displayCombinedNoteComp, //COMPLICATIONS + ' <br/> ' + NOTE,
						"L": NOTE,
						"M": result.INTRAOP_DOCUMENT_ENCNTR_ID,
						"N": result.INTRAOP_DOCUMENT_ID,
						"O": result.INTRAOP_DOCUMENT_NAME,
						"P": result.INTRAOP_DOCUMENT_DT_TM,
						"Q": result.INTRAOP_DOCUMENT_PRSNL,
						"R": result.INTRAOP_DOCUMENT_STATUS,
						"S": result.NOTE_ID
					});
				}
			);
		}
        return retVal;
    };

    /**
     * Parent function for construction of the UI
     * Output of the function will be an object contain a string of the total html to be render for this component
     *   All necessary presentation formation and transformation are done in this function.
     *
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @param aDtoUI {object} aDtoData object
     * @returns {object} retVal is a CC specifically defined DTO for transferring data to presentation rendering processing
     */
    POAnesthHist.ccnsp.processUI   = function (aObjNSbase, aObjCcBase,aDtoUI) {
		var objData = aObjCcBase.eApps.getDataDto(aObjCcBase);	
        var retVal = [];
		retVal.push(
			'<table id="chla_poanesthhist" style="table-layout:fixed;">'+
			'<thead><tr><th style="width:60px;">Date'+
			'</th><th style="width:15%;">Procedure'+
			'</th><th style="width:15%;">Meds Prior To Induction'+
			'</th><th style="width:10%;">Induction Details'+
			//'</th><th style="width:5%;">Induction Response'+
			'</th><th style="width:5%;">Mask Airway'+
			'</th><th style="width:15%;">Airway Management'+
			'</th><th style="width:10%;">Vascular Access'+
			'</th><th style="width:10%;">Regional / Block'+
			'</th><th style="width:20%;">Complications / Notes'+
			//'</th><th style="width:10%;">Notes'+
			'</th></tr></thead><tbody>'
        );
		var row = [
			'<tr class="<#=ODD#>"><td><#=A#>',
			'<td><a href="#" class="chla-anes-history-proc" data-docstat="<#=R#>" data-docprsnl="<#=Q#>" data-docdt="<#=P#>"' +
				'data-docname="<#=O#>" data-docid="<#=N#>" data-encntrid="<#=M#>" data-noteid="<#=S#>" style="text-decoration:underline;"><#=B#></a></td>',
			'</td><td class="chla_PreMeds_Render"><#=C#>',
			//'</td><td><#=D#>',
			'</td><td style="word-wrap:break-word;"><#=E#>',
			//'</td><td><#=F#>',
			'</td><td><#=G#>',
			'</td><td><#=H#>',
			'</td><td><#=I#>',
			'</td><td><#=J#>',
			'</td><td><#=K#>',
			//'</td><td><#=L#>',
			'</td></tr>',
		];
        objData.data.forEach(
            function (value,index) {
                value.ODD = (index % 2 ===0? 'odd':'');
                retVal.push(aObjNSbase.gFuncs.parseTemplate(row.join(''), value));
            }
        );
        retVal.push('</tbody></table>');
        return retVal.join('');

    };
    /**
     * Parent function for processing functions after the UI has been render to the DOM
     *   All css,dom behaviors to be associated with UI components is handled in this function.
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    POAnesthHist.ccnsp.processPostCcInstance  = function (aObjNSbase, aObjCcBase) {		
		var DtoData = aObjCcBase.data.ANESTHESIA_RECORD;
		
		$(".chla-anes-history-proc").on('click', function(e){
			e.stopPropagation();
			var paramArr = [];
			var key = $(this).data('docid') || $(this).data('noteid');
			if(key) {
				paramArr.push(aObjCcBase.getProperty('personId'));
				paramArr.push($(this).data('encntrid'));
				paramArr.push("[" + key + "]");
				paramArr.push("");
				paramArr.push("7");
				paramArr.push("");
				paramArr.push("");
				paramArr.push("");
				paramArr.push("");			
				var sendstr = paramArr.join("|");
				MPAGES_EVENT('CLINICALNOTE', sendstr);
			} else {
				chla.eApps.gFuncs.createFloatingPopupWindow('temp_POAnesthHist_popup', 'Message', 'This Anesthesia Record is in progress; <br/>it can be viewed after it is finalized.');
			}
		}).hover(
			function(e) {
				var name = $(this).data('docname');
				var dt = $(this).data('docdt');
				var auth = $(this).data('docprsnl');
				var stat = $(this).data('docstat');
				var parentOffset = $('#chla_POAnesthHist').offset(); 
				var relX = e.pageX - parentOffset.left + 15;
				var relY = e.pageY - parentOffset.top;
				var htmlDiv = [];
				htmlDiv.push('<div id="AnesHist-hover">');
				if(name) {
					htmlDiv.push('<b>' + name + '</b><br/>')
				}
				if(dt) {
					htmlDiv.push('<b>' + dt + '</b><br/>')
				}
				if(auth) {
					htmlDiv.push('Author: ' + auth + '<br/>')
				}
				if(stat) {
					htmlDiv.push('Status: ' + stat + '<br/>')
				}
				htmlDiv.push('<b>Click to view note</b><div>');
				$(this).append(htmlDiv.join(''));
				$("#AnesHist-hover").css('position', 'absolute').css('top', relY).css('left', relX)
				.css('padding', '3px 3px 3px 3px').css('border', '1px solid black').css('background-color', 'lightyellow').css('z-index', '36');
			},
			function(e) {
				$('#AnesHist-hover').remove();
			}
		);
		
		chla.eApps.gFuncs.createFloatingFixedTableHeader('#' + aObjCcBase.eApps.cc_id, '#chla_poanesthhist');
		
		chla.eApps.gFuncs.bindFloatingHover('#' + aObjCcBase.eApps.cc_id + ' [data-qtip]', 'body', '', true, '$(this).data("qtip")', '');
		
		$('#' + aObjCcBase.eApps.cc_id).append('<div style="position: absolute;margin-left:100px;width:80%;top:5px;z-index: 30;background-color:rgba(0,0,0,0);">' +
			'<div id="launchpreanesevalnote" style="color:blue;font-size:14:px; font-weight: 800;width:99%;text-align: center; display: inline-block;background-color:inherit;cursor:pointer;">' +
			'Launch Pre Anesthesia Eval Note</div></div>'
		);
		
		$("#launchpreanesevalnote").on('click', function(e) {
			if(DtoData.PERSON_ID && DtoData.ENCNTR_ID) {
				var CKI_array = DtoData.SURGCNTR_PRE_ANESTHESIA_EVALUALTION_CKI.split('!');
				if(CKI_array.length > 1) {
					var bstrEPCKISource = CKI_array[0];
					var bstrEPCKIIdentifier = CKI_array[1];				
					var PowerNoteMPageUtils = window.external.DiscernObjectFactory("POWERNOTE");
					PowerNoteMPageUtils.BeginNoteFromEncounterPathway(patientId, encounterId, bstrEPCKISource, bstrEPCKIIdentifier);
				} else {
					alert('SURGCNTR_PRE_ANESTHESIA_EVALUALTION_CKI values are missing');
				}
			}
		});
	};

    /**
     *  Call to build CC and to render to CC framework
     */
    POAnesthHist.ccnsp.ProcessCtl(POAnesthHist.ccnsp,component);

}
chla['POIntubationHist'].prototype.render = function() {
    var  component = this,
        /**
         * variable to contain working object for cc rendering
         */
        POIntubationHist;
    /**
     *  initialize the variable with the CC Module base class
     */
    POIntubationHist  = chla.eAppsClass.gCcModule.createCcModuleCls.neo();
    /*----------------------------------------------------*/
    /* Replace these functions with this CC specific code.*/
    /*----------------------------------------------------*/
    /**
     * Parent function for processing initialization specifically for the CC
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    POIntubationHist.ccnsp.postInit  = function (aObjNSbase, aObjCcBase) { };
    /**
     * Parent function for processing the JSON data received for display
     * Output of this function will be an object tha contains data items to be used in the presentation construction process.
     *  All data validation and transformations are done in this function
     *
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @param aDtoData {object} Dto object specifically defined by RPTDATA response from CCL request
     * @returns {*} {object} retVal is a CC specifically defined DTO for transferring data to presentation processing
     */
    POIntubationHist.ccnsp.processData = function (aObjNSbase, aObjCcBase,aDtoData) {
        var retVal = {},
			DtoData;
		retVal.data = [];
		
		if(aObjCcBase.data && aObjCcBase.data.INTUBATION_HISTORY && aObjCcBase.data.INTUBATION_HISTORY.FORMDATA) {
			DtoData = aObjCcBase.data.INTUBATION_HISTORY.FORMDATA;
			DtoData.forEach(
				function (result) {
					var combinedNoteAndComplications = (result.COMPLICATIONS ? result.COMPLICATIONS + ' <br/> ' : '') + result.NOTE;
					var truncatedNoteAndComplications = combinedNoteAndComplications.length > 180 ? combinedNoteAndComplications.substring(0,180) + '...' : combinedNoteAndComplications;
					var displayCombinedNoteComp = '<span data-qtip="' + combinedNoteAndComplications.replace(/;<b>Freetext/g, '</br><b>Freetext').replace(/;<b>/g, '</br><b>') + '">' + truncatedNoteAndComplications + '</span>';
					retVal.data.push({
						"A": result.INTUBATION_DT_TM,
						"B": result.SURG_PROCEDURE,
						"C": result.PREP_TECHNIQUE,
						"D": result.DEVICE,
						"E": result.TUBE_ID,
						"F": result.GR_VIEW,
						"G": result.ATTEMPTS,
						"H": (result.DIFFICULT ? result.DIFFICULT : 'No'),
						"I": displayCombinedNoteComp, //result.COMPLICATIONS,
						"J": result.NOTE,
						"K": result.INTRAOP_DOCUMENT_ENCNTR_ID,
						"L": result.INTRAOP_DOCUMENT_ID,
						"M": result.INTRAOP_DOCUMENT_NAME,
						"N": result.INTRAOP_DOCUMENT_DT_TM,
						"O": result.INTRAOP_DOCUMENT_PRSNL,
						"P": result.INTRAOP_DOCUMENT_STATUS
					});
				}
			);
		}		
        return retVal;
    };

    /**
     * Parent function for construction of the UI
     * Output of the function will be an object contain a string of the total html to be render for this component
     *   All necessary presentation formation and transformation are done in this function.
     *
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @param aDtoUI {object} aDtoData object
     * @returns {object} retVal is a CC specifically defined DTO for transferring data to presentation rendering processing
     */
    POIntubationHist.ccnsp.processUI   = function (aObjNSbase, aObjCcBase,aDtoUI) {
		var objData = aObjCcBase.eApps.getDataDto(aObjCcBase);	
        var retVal = [
            '<table id="chla_pointubationhist" style="table-layout:fixed;">',
                '<thead><tr><th style="width:40px;">Date',
                '</th><th style="width:180px;">Procedure',
				'</th><th style="width:130px;">Prep/Technique',
                '</th><th style="width:80px;">Device/Equipment',
                '</th><th style="width:140px;">Tube Size',
                '</th><th style="width:60px;">View Grade',
                '</th><th style="width:60px;">Ease/ # Attempts',
                '</th><th style="width:120px;">Difficult Airway',
                '</th><th style="width:150px;">Complications / Notes',
                //'</th><th style="width:90px;">Notes',
                '</th></tr></thead><tbody>'
            ],
            row = [
                '<tr class="<#=ODD#>">',
				'<td><#=A#></td>',
				'<td><a href="#" class="chla-intub-history-proc" data-docstat="<#=P#>" data-docprsnl="<#=O#>" data-docdt="<#=N#>" data-docname="<#=M#>" data-docid="<#=L#>" data-encntrid="<#=K#>" style="text-decoration:underline;"><#=B#></a></td>',
				'<td><#=C#></td>',
				'<td><#=D#></td>',
				'<td><#=E#></td>',
				'<td class="chla_POIH_Grades"><#=F#></td>',
				'<td class="chla_POIH_Attempts"><#=G#></td>',
				'<td class="chla_POIH_Difficulty"><#=H#></td>',
				'<td><#=I#></td>',
				//'<td><#=J#></td>',
				'</tr>'
            ];
        objData.data.forEach(
            function (value,index) {
                value.ODD = (index % 2 === 0? 'odd':'');
                retVal.push(aObjNSbase.gFuncs.parseTemplate( row.join(''), value));
            }
        );
        retVal.push('</tbody></table>');
        return retVal.join('');
    };
    /**
     * Parent function for processing functions after the UI has been render to the DOM
     *   All css,dom behaviors to be associated with UI components is handled in this function.
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    POIntubationHist.ccnsp.processPostCcInstance  = function (aObjNSbase, aObjCcBase) {
		$(".chla-intub-history-proc").on('click', function(e){
			e.stopPropagation();
			var paramArr = [];
			paramArr.push(aObjCcBase.getProperty('personId'));
			paramArr.push($(this).data('encntrid'));
			paramArr.push("[" + $(this).data('docid') + "]");
			paramArr.push("");
			paramArr.push("7");
			paramArr.push("");
			paramArr.push("");
			paramArr.push("");
			paramArr.push("");			
			var sendstr = paramArr.join("|");
			MPAGES_EVENT('CLINICALNOTE', sendstr);
		}).hover(
			function(e) {
				var name = $(this).data('docname');
				var dt = $(this).data('docdt');
				var auth = $(this).data('docprsnl');
				var stat = $(this).data('docstat');
				var parentOffset = $('#chla_POIntubationHist').offset(); 
				var relX = e.pageX - parentOffset.left + 15;
				var relY = e.pageY - parentOffset.top;
				var htmlDiv = [];
				htmlDiv.push('<div id="IntubHist-hover">');
				if(name) {
					htmlDiv.push('<b>' + name + '</b><br/>')
				}
				if(dt) {
					htmlDiv.push('<b>' + dt + '</b><br/>')
				}
				if(auth) {
					htmlDiv.push('Author: ' + auth + '<br/>')
				}
				if(stat) {
					htmlDiv.push('Status: ' + stat + '<br/>')
				}
				htmlDiv.push('<b>Click to view note</b><div>');
				$(this).append(htmlDiv.join(''));
				$("#IntubHist-hover").css('position', 'absolute').css('top', relY).css('left', relX)
				.css('padding', '3px 3px 3px 3px').css('border', '1px solid black').css('background-color', 'lightyellow').css('z-index', '6');
			},
			function(e) {
				$('#IntubHist-hover').remove();
			}
		);		
		
		chla.eApps.gFuncs.createFloatingFixedTableHeader('#' + aObjCcBase.eApps.cc_id, '#chla_pointubationhist');		
		
		chla.eApps.gFuncs.bindFloatingHover('#' + aObjCcBase.eApps.cc_id + ' [data-qtip]', 'body', '', true, '$(this).data("qtip")', '');
		
		$('.chla_POIH_Difficulty').each(
			function() {
				if($(this).text().toUpperCase().indexOf("YES") !== -1) {
					$(this).addClass('encounter-error');
				}
			}
		);
		
		$('.chla_POIH_Attempts').each(
			function() {
				var valueInt = parseInt($(this).text(),10);
				if(isNaN($(this).text()) === false) {
					if(valueInt >= 3) {
						$(this).addClass('orange-warn');
					}
				}
			}
		);
		
		$('.chla_POIH_Grades').each(
			function() {
				var valueInt = parseInt($(this).text(),10);
				if(isNaN($(this).text()) === false) {
					if(valueInt >= 3) {
						$(this).addClass('orange-warn');
					}
				}
			}
		);
	};

    /**
     *  Call to build CC and to render to CC framework
     */
    POIntubationHist.ccnsp.ProcessCtl(POIntubationHist.ccnsp,component);
}
chla['keyinfo'].prototype.render = function() {
    'use strict';
    var  component = this,
        /**
         * variable to contain working object for cc rendering
         */
        keyinfo;
    /**
     *  initialize the variable with the CC Module base class
     */
    keyinfo  = chla.eAppsClass.gCcModule.createCcModuleCls.neo();
    /*----------------------------------------------------*/
    /* Replace these functions with this CC specific code.*/
    /*----------------------------------------------------*/
    /**
     * Parent function for processing initialization specifically for the CC
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    keyinfo.ccnsp.postInit  = function (aObjNSbase, aObjCcBase) { 
		keyinfo.createPEWSChart = function(MPEWSHistArray, winHeight, winWidth) {
			var graphData = []; 
			var seriesName = 'PEWS  History';
			var winTitle = 'PEWS History';
			var j = 0,
				i = 0;
			for (j = MPEWSHistArray.length - 1; j >= 0 ; j--) {
				var resultDate = Date.parse(MPEWSHistArray[j]["DATE"]); // x
				var result = parseFloat(MPEWSHistArray[j]["SCORE"]); // y
				var resultColor = function() {
					var returnVal = '#000'; // default black
					if (result < 3) {
						returnVal = '#03A207';
					} else if (result < 6) {
						returnVal = '#F2FA1B';
					} else if (result < 8) {
						returnVal = '#F99C00';
					} else {
						returnVal = '#CC0005';
					}
					return returnVal;
				}();
				var resultSymbol = function() {
					var directory = chla.global.imgPath + 'img/mpews/';
					var mask = 'url({0}{1})';
					// default green
					var returnVal = 'url(' + directory + 'green_dot.gif)';
					if (result < 3) {
						returnVal = 'url(' + directory + 'green_dot.gif)';
					} else if (result < 4) {
						returnVal = 'url(' + directory + 'yellow_dot.gif)';
					} else if (result < 5) {
						returnVal = 'url(' + directory + 'orange_dot.gif)';
					} else {
						returnVal = 'url(' + directory + 'red_dot.gif)';
					}
					return returnVal;
				}();
				graphData[i] = {
					"x" : resultDate,
					"marker" : {
						symbol : resultSymbol
					},
					"y" : result
				};
				i++;
			}
			var chartSeries1 = {
				// 'type': 'column',
				'type' : 'line',
				'yAxis' : 0,
				'data' : graphData,
				'name' : seriesName
			}; 
			
			var marginRight = 15;	
			// baseline stuff - NEW  (add this to yAxis as plotBands) - kineta
			var mpewsMean = 0;
			var mpewsNewest = parseInt(MPEWSHistArray[0].SCORE, 10); 
			
			//if (dateobject.getTime() >= currentDate.getTime()){
			var mpewsSD = 0.6; // standard deviation (multiply x 3)
			mpewsSD = (mpewsSD*3);
			
			var mpewsCalc = 0;
			// start at '2' in order to skip both the newest and the penultimate result 
			for (i=2; i<7; i++){
				if (i < MPEWSHistArray.length){			
					mpewsMean = mpewsMean + parseInt(MPEWSHistArray[i].SCORE, 10);
					mpewsCalc++ ;
				}
			}						
			if (mpewsCalc >= 3) {
				// add the MPEWS total to the statistic deviation
				// divide by number of results used and round up to whole number
				// add 0.1 as per the standard deviation formula
				mpewsMean =(mpewsMean/mpewsCalc)+mpewsSD;
				// round to the nearest 1 decimal point:
				mpewsMean = Math.round(mpewsMean * 10)/10;
			}
			else {
				mpewsMean = 0;
			}
			var chart = new Highcharts.Chart({
				chart : {
					renderTo : 'MPEWS_CHARTGOESHERE',
					borderWidth : 1,
					spacingTop : 20,
					spacingLeft : 5,
					marginRight : marginRight,
					alignTicks : false,
					marginBottom : 50,
					height : winHeight,
					width : winWidth,
					// Highcharts 2.2.1 stuff
					resetZoomButton: {
						theme: {
							stroke: 'silver',
							r: 3,
							style : {
								fontSize : '9px'
							}
						},
						position: {
							align: 'right',
							verticalAlign: 'top',
							x: -(9 + marginRight),
							y: 0
						},
						relativeTo: 'chart'
					}
				},
				credits : {
					enabled : false
				},
				title : {
					text : '',
					y : 16
				},
				legend : '',
				plotOptions : {
					line : {
						marker : {
							fillColor : null,
							lineColor : null,
							lineWidth : null,
							radius : 4,
							states : {
								hover : {
									enabled : false
								}
							}
						}
					}
				},
				tooltip : {
					formatter : function() {
						var toolTipHtml = '<b>PEWS Score:</b>'
							+ this.y
							+ '<br/>'
							+ '<b>Date time: </b>'
							+ Highcharts.dateFormat('%m/%d/%y %H:%M', this.x);
						return toolTipHtml;
					}
				},
				xAxis : [{
					//type : 'datetime',
					maxPadding : 0.03,
					minPadding : 0.03,
					labels : {
						formatter : function() {
							return Highcharts.dateFormat('%m/%d/%y', this.value)
								+ '<br/> '
								+ Highcharts.dateFormat('%H:%M', this.value);
						}
					}
					
				}],
				yAxis : [{
					min : -1,
					max : 11.05,
					tickInterval : 2,
					startOnTick : false,
					endOnTick : false,
					plotBands: [{
						from: 0.0,	
						to: mpewsMean,
						color: '#CCC'
					}],
					labels : {
						align : 'right'
					},
					title : {
						text : 'PEWS'
					}
				}],
				series : [chartSeries1]
			});
		};
		keyinfo.getDomIdFromPowerForm = function(formType, formId, typeId) {
			return typeId + '_' + formType + '_' + formId + '_KEY_ID';
		};
		// setting remove to true (in any way) will add "REMOVE" to id
		keyinfo.getDomIdFromCriticalInfo = function(name, typeId, remove) {
			var cleanName = name.replace(/([ #;&,.+*~\':"!^$[\]()=>|\/@])/g, '_');
			var removeStr = remove ? 'REMOVE' : '';
			// return typeId + '_' + name.replace(' ', '_') + 'CRIT_INFO_KEY_ID';
			return typeId + '_' + cleanName + '_' + removeStr + '_' + 'CRIT_INFO_KEY_ID';
		};
		keyinfo.getDomIdFromProviderInfo = function(number, typeId) {
			return typeId + '_PROVIDER_' + number + '__KEY_ID';
		};
		keyinfo.getDomIdForMpews = function(typeId) {
			return typeId + '_MPEWS_KEY_ID';
		};
		keyinfo.getDomIdForCodeStatus = function(typeId) {
			return typeId + '_CODE_STATUS_KEY_ID';
		};
		keyinfo.getDomIdForContactTitle = function(renderLocation) {
			return renderLocation + "_CONTACT_TITLE_ID";
		};
		keyinfo.getDomIdForAttendingTitle = function(renderLocation, num) {
			return renderLocation + "_ATTENDING_" + num + "_TITLE_ID";
		};
		keyinfo.getDomIdForCareTeamTitle = function(renderLocation) {
			return renderLocation + "_CARETEAM_TITLE_ID";
		};
		keyinfo.getDomIdForAllergies = function(renderLocation) {
			return renderLocation + "_ALLERGY_TITLE_ID";
		};
		keyinfo.getDomIdForRnTitle = function(renderLocation) {
			return renderLocation + "_RN_TITLE_ID";
		};
		keyinfo.getDomIdForDischarge = function(renderLocation) {
			return renderLocation + "_DISCHARGE_ID";
		};
		keyinfo.getDomIdForProtocols = function(renderLocation) {
			return renderLocation + '_PROTOCOLS_ID';
		};
		keyinfo.getDomIdWeight = function(renderLocation) {
			return renderLocation + "_WEIGHT_ID";
		};
		keyinfo.getDomIdMedCalcWeight = function(renderLocation) {
			return renderLocation + "_MED_CALC_WEIGHT_ID";
		};
		keyinfo.getDomIdHeight = function(renderLocation) {
			return renderLocation + "_HEIGHT_ID";
		};
		keyinfo.getDomIdBMI = function(renderLocation) {
			return renderLocation + "_BMI_ID";
		};
		keyinfo.getDomIdMeasure = function(renderLocation) {
			return renderLocation + "_MEASURE_ID";
		};
		keyinfo.getDomIdRestraint = function(renderLocation, row) {
			return renderLocation + '_RESTRAINT_ID_' + row;
		};
		keyinfo.getDomIdCasper = function(renderLocation) {
			return renderLocation + "_CASPER_ID";
		};
		keyinfo.getDomIdCPPOC = function(renderLocation) {
			return renderLocation + "_CPPOCR_ID";
		};
		keyinfo.getDomIdBRAP = function(renderLocation) {
			return renderLocation + "_CPPOCR_ID";
		};
		keyinfo.getDomIdPP = function(renderLocation) {
			return renderLocation + "_PP_ID";
		};
		keyinfo.getDomIdIso = function(renderLocation) {
			return renderLocation + "_ISO_ID";
		};
		keyinfo.getDomIdRes = function(renderLocation) {
			return renderLocation + "_RES_ID";
		};
		keyinfo.getDomIdForCswPathways = function(renderLocation) {
			return renderLocation + "_PATHWAYS_ID";
		};
		keyinfo.getDomIdMAPIcon = function(renderLocation) {
			return renderLocation + "_MAP_ICON_ID";
		};
		keyinfo.getDomIdReadmissionRisk = function(renderLocation) {
			return renderLocation + "_READMISSIONRISK_ID";
		};
		keyinfo.getDomIdReadmissionRiskIcon = function(renderLocation) {
			return renderLocation + "_READMISSIONRISKICON_ID";
		};
		keyinfo.getDomIdHt = function(renderLocation) {
			return renderLocation + "_HT_ID";
		};
		keyinfo.getDomIdGuardian = function(renderLocation) {
			return renderLocation + "_GUARDIAN_ID";
		};
		keyinfo.getDomIdWt = function(renderLocation) {
			return renderLocation + "_WT_ID";
		};
		keyinfo.getDomIdOFC = function(renderLocation) {
			return renderLocation + "_OFC_ID";
		};
		keyinfo.getDomIdForPrecautions = function(renderLocation) {
			return renderLocation + "_PRECAUTIONS_ID";
		};
		keyinfo.getDomIdForNARF = function(renderLocation) {
			return renderLocation + "_NARF_ID";
		};
      keyinfo.addColumnYN = function(viewType, columnNumber) {
         return (viewType != "WF_STD" || columnNumber % 2 == 1);
      };
      
		// return a date that is 6 months in the future
		keyinfo.calcExpireDate = function(evalDateStr,evalTimeLimitStr) {
			var evalDate = new Date(evalDateStr);
			
			if (evalTimeLimitStr === "In one year"){
				evalDate.setDate(evalDate.getDate() + 365);//Ext.Date.add(evalDate, Ext.Date.MONTH, 12);
			}
			else if(evalTimeLimitStr === "In two years"){
				evalDate.setDate(evalDate.getDate() + 365*2)
			}
			else if(evalTimeLimitStr === "In three years"){
				evalDate.setDate(evalDate.getDate() + 365*3)
			}
			return evalDate.toLocaleDateString("en-US");
		};
		// returns true if the eval date has expired
		keyinfo.calcRecommendationExpired = function(expireDateStr) {
			var today = new Date();
			var compareDate = new Date(today.getFullYear(), today.getMonth(), today
							.getDate());
			return (new Date(expireDateStr).getTime() < compareDate.getTime());
		};
		keyinfo.confirmPrecautionRemove = function(renderParams) {
			//// Might need to implement
			alert('keyInfoRefresh();');
		};
		// this function processes a callback with data for discharge criteria
		keyinfo.showDischargeWin = function(renderParams) {
			//// Might need to implement
			/* var panelId = renderParams.layoutParams[0].panelID;
			var thePanel = Child.DischargeCriteriaPanelFactory(panelId,renderParams.data);
			var theWindow = new Ext.Window({
				id : Child.GlobalDomIds.KEY_INFO_DISCHARGE_POPUP_WIN,
				layout : 'fit',
				width : 400,
				autoScroll : true,
				closeAction : 'destroy',
				stateful : false,
				plain : true,
				modal : true,
				title : '',
				items : [thePanel],
				fbar : [{
					tooltip : 'Close',
					overflowText : 'Close',
					text : 'Close',
					handler : function() {
						Ext
								.getCmp(Child.GlobalDomIds.KEY_INFO_DISCHARGE_POPUP_WIN)
								.close();
					}
				}]
			});
			theWindow.show(); */
		};
	};
    /**
     * Parent function for processing the JSON data received for display
     * Output of this function will be an object tha contains data items to be used in the presentation construction process.
     *  All data validation and transformations are done in this function
     *
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @param aDtoData {object} Dto object specifically defined by RPTDATA response from CCL request
     * @returns {*} {object} retVal is a CC specifically defined DTO for transferring data to presentation processing
     */
    keyinfo.ccnsp.processData = function (aObjNSbase, aObjCcBase, aDtoData) {
        var retVal = {},
			DtoData;
			retVal.htmlRows = [];
		var i = 0,
			x = 0;
		var gFuncs = chlaNsMgr.aliasDirector('chla.eApps.gFuncs');
		var viewType = "undefined";

		if (typeof m_viewpointJSON !== 'undefined') {
         var m_viewpointSettings = JSON.parse(m_viewpointJSON);
         var activeView = m_viewpointSettings.VP_INFO.ACTIVE_VIEW_CAT_MEAN;
         var i;
         for (i = 0; i < m_viewpointSettings.VP_INFO.VIEWS.length; i++) {
            if (m_viewpointSettings.VP_INFO.VIEWS[i].VIEW_CAT_MEAN == activeView) {
               viewType = m_viewpointSettings.VP_INFO.VIEWS[i].VIEW_TYPE_MEAN;
            }            
         }
      }
      
		if(aObjCcBase.data && aObjCcBase.data.RPTDATA) {
			DtoData = aObjCcBase.data.RPTDATA;
			//chla.eAppsUtil.Logger.LogError(JSON.stringify(DtoData));
			var encType = retVal.ENCNTR_TYPE = DtoData.ENCNTR_TYPE;
			retVal.HOSPITAL_DAY = DtoData.INFO[0].HOSPITAL_DAY;
			var ed = false,
				ip = false,
				amb = false;
			if(DtoData.EMERGENCY_ENCNTR_FLAG.match(/yes/i)) {
				ed = true;
			}
			switch(retVal.ENCNTR_TYPE.toUpperCase()) {
				case 'IP': ip = true; break;
				case 'ED': ed = true; break;
				default: amb = true; break;
			}
			
			var showAdvanceDirective = false;
			var showMeasHt = false;
			var showCarePlans = false;
			var showBMI = false;
			var BMIS;	
			var showPMA = false;
			var showBrainDeath = false;
			var showRoundingTime = false;
			var iconSpace = '<img class="space-icon"  src="' + chla.global.imgPath + 'img/s.gif" />';
			// declare icons that will be loaded base on data
			var iconFlu, iconMpews, iconCodeStatus, iconIsolation1, iconIsolation2, iconDiet, iconCswPathway, iconMAP, iconDischarge, iconReadmissionRisk, iconEdAcuity, iconEdStatus, iconProviderPager;
			// declare click ids that apply to icon/label/data combination
			var restraintsClickId, mpewsClickId, cswPathwayClickId, allergiesClickId, dischargeClickId, guardiansClickId, isoClickId, resClickId, casperClickId, brapClickId, cppocClickId, 
				ppClickId, casperFormClickId, ppFormClickId, weightClickId, heightClickId, bmiClickId, measureClickId, contactProviderClickId, contactAttendingClickId, contactCareTeamClickId, rnClickId, 
				protocolsClickId, carePlanClickId, precautionClickId, brainDeathClickId, codeStatusClickId;
			// declare title that will be display when hovering on clickable items
			var titleFlu, titleRestraints, titleMpews, titleAllergies, titleCswPathway, titleDischarge, titleGuardians, titleCasper, titleCPPOC, titleBRAP, titleWeight, titleHeight, 
				titlePMA, titleBMI, titleMeasurements, titleContactProvider, titleCareTeam, titleRn, titleProtocols, titleCodeStatus, titleCarePlans, titlePrecaution, titleBrainDeath;
			var clickableClass;
			var ppIndex = -1;
			var cppocIndex = -1;
			var brapIndex = -1;
			
			var INFLUENZA = (function() {
				var fluArr = DtoData.INFO[0].INFLUENZA;
				var str = '';
				titleFlu = '';
				iconFlu = '';				
				if(fluArr.length > 0) {
					titleFlu = 'Influenza: ';	
					switch(fluArr[0].ICON) {
						case "NOT SCREENED":
							iconFlu = gFuncs.sFormatter(
								'<img title="{0}" class="key-info-icon" src="{1}img/influenza/flu_screen.png" />',
								fluArr[0].DISPLAY_TEXT,
								chla.global.imgPath);
							str = fluArr[0].DISPLAY_TEXT;
							break;						
 						case "DECLINED":
							iconFlu = gFuncs.sFormatter(
								'<img title="{0}" class="key-info-icon" src="{1}img/influenza/flu_decline.png" />',
								fluArr[0].DISPLAY_TEXT,
								chla.global.imgPath);
							str = fluArr[0].DISPLAY_TEXT;
							break;						
						case "VACCINATE":
							iconFlu = gFuncs.sFormatter(
								'<img title="{0}" class="key-info-icon" src="{1}img/influenza/flu_today.png" />',
								fluArr[0].DISPLAY_TEXT,
								chla.global.imgPath);
							str = fluArr[0].DISPLAY_TEXT;
							break;						
						case "RECEIVED":
							iconFlu = gFuncs.sFormatter(
								'<img title="{0}" class="key-info-icon" src="{1}img/influenza/flu_already.png" />',
								fluArr[0].DISPLAY_TEXT,
								chla.global.imgPath);
							str = fluArr[0].DISPLAY_TEXT;
							break; 					
						default:
							break;
					}
				} else {
					str = 'None';
				}
				return str;				
			})();
				
			var ADVANCE_DIRECTIVE = (function() {
				var str = '';
				if (DtoData.INFO[0].ADVANCE_DIRECTIVE.length > 0) {
					str = DtoData.INFO[0].ADVANCE_DIRECTIVE;
					showAdvanceDirective = true;
				}
				return str;
			})();
	
			var MPEWS = (function() {
				var mpewsArray = DtoData.INFO[0].MPEWS;
				// iconMpews = iconSpace;
				iconMpews = ''; // init to empty string, not iconSpace
				titleMpews = '';
				var mpewsStr = 'None';
				if (mpewsArray.length > 0) {
					titleMpews = 'PEWS: Click to view 72 hours';
					var score = mpewsArray[0].MPEWS_SCORE;
					var trend = mpewsArray[0].MPEWS_TREND; // not used
					var mpewsKey = score;		
					var mpewsMap = {
						'0' : '00_G_32.png',
						'1' : '01_G_32.png',
						'2' : '02_G_32.png',
						'3' : '03_Y_32.png',
						'4' : '04_O_32.png',
						'5' : '05_R_32.png',
						'6' : '06_R_32.png',
						'7' : '07_R_32.png',
						'8' : '08_R_32.png',
						'9' : '09_R_32.png',
						'10' : '10_R.png',
						'AND' : 'AND_32.png'
					};
					var mpewsLocation = 'img/mpews/';
		
					var mpewsIcon = mpewsMap[mpewsKey];
					if (!mpewsIcon) {
						mpewsIcon = 'question.gif';
						mpewsLocation = 'img/';
					}
					mpewsClickId = keyinfo.getDomIdForMpews(encType);
					iconMpews = gFuncs.sFormatter(
						'<img style="cursor:pointer;" class="key-info-icon" src="{0}{1}{2}" id="{3}" data-qtip="{4}" />',
						chla.global.imgPath, 
						mpewsLocation, mpewsIcon,
						mpewsClickId, titleMpews);		
					mpewsStr = score + ' ' + trend;
				}
				return mpewsStr;
			})();
			
			var PRECAUTIONS = (function() {
				var otherArray = DtoData.INFO[0].PRECAUTIONS;
				var str = '';
				titlePrecaution = '';
				
				for (var i = 0; i < otherArray.length; i++) {
					 if (i > 0) {
						str += ', ';
					}  
					str += otherArray[i].PRECAUTION;
				}
				
				if (str.length === 0) {
					str = 'None';
				} 
				// else {
					 // if (record.raw.PRECAUTIONS_REFS.length > 0) {
						// titlePrecaution = 'Click to view the precautions policy information';
						// precautionClickId = keyinfo.getDomIdForPrecautions(encType);
										
						// str = Ext.String.format('<span id="{0}" class="key-info-clickable" data-qtip="{1}">{2}</span>',
							// precautionClickId, 
							// titlePrecaution,
							// str);				
					// }			
				// }				
				return str;
			})();
			
			var DIETS = (function() {
				var str = '',
					dietsArr = DtoData.INFO[0].DIETS;
				// iconDiet = iconSpace;
				iconDiet = ''; // init to empty string, not iconSpace
				if (dietsArr.length > 0) {
					for (var i = 0; i < dietsArr.length; i++) {
						var theDiet = dietsArr[i].DIET;
						var theDate = dietsArr[i].ORDER_DATE;
						var theProvider = dietsArr[i].ORDER_PVDR;
						var theClinicDisplay = dietsArr[i].CLIN_DISPLAY_LINE;
						var theQtip = '<b>' + theDiet + '</b><br>' + theClinicDisplay
								+ '<br>' + '<b>Ordered by:</b>&nbsp;' + theProvider
								+ '</br><b>Order date:&nbsp;</b>' + theDate;
						if (i > 0) {
							str += ', ';
						}
						// if diet is Ketogetic make it red bold
						if (theDiet.toLowerCase().indexOf('ketogenic') != -1) {
							str += '<span data-qtip="' + theQtip + '" class="diet-alert">' + theDiet + '</span>';
						} else {
							str += '<span data-qtip="' + theQtip + '">' + theDiet + '</span>';
						}
						if (theDiet.toLowerCase().indexOf('npo') != -1) {
							iconDiet = gFuncs.sFormatter('<img title="Diet Restrictions" class="key-info-icon" src="{0}img/diet_npo.png" />', chla.global.imgPath);
						}
					}
				} else {
					str = 'None';
				}
				
		//		KETOGENIC_DIET_PREC				
				//check for ketogenic diet precaution.  If it exists display even though no diet order was found.
				if(DtoData.INFO[0].KETOGENIC_DIET_PREC === 'YES') {
					if(str === 'None') {
						str = '';
					}
					if(str.toLowerCase().indexOf('ketogenic') === -1) {
						if(str !== '') {
							str += ', ';
						}
						// no ketogenic diet order found.  add ketogenic text with special tool tip
						str += '<span data-qtip="<b>Review: No Ketogenic Diet Order</b>" class="diet-alert">Ketogenic Diet</span>';
					}

					if(iconDiet === '') {
						// No NPO icon so display ketogenic icon
						iconDiet = gFuncs.sFormatter('<img title="Diet Restrictions" class="key-info-icon" src="{0}img/diet_keto.png" />', chla.global.imgPath);
					}
				}		
				return str;
			})();
			
			var CARE_PLANS = (function() {
				var carePlanArray = DtoData.INFO[0].CARE_PLANS;
				var str = '';
				var formCodeId = '';		 
				titleCarePlans = '';
				if (carePlanArray.length > 0) {
					for (var i = 0; i < carePlanArray.length; i++) {
						titleCarePlans = '';
						if (i > 0) {
							str += ', ';
						}
						var carePlanStr = '';
						if (carePlanArray[i].EVENT_ID && carePlanArray[i].EVENT_ID.length > 0) {
							titleCarePlans = 'Date: ' + carePlanArray[i].DATE + '<br/>Click to view document';
							formCodeId = keyinfo.getDomIdFromPowerForm('carePlanEvent', parseInt(carePlanArray[i].EVENT_ID), encType);
							carePlanStr = gFuncs.sFormatter('<span data-qtip="{2}" class="key-info-clickable" id="{0}">{1}</span>',
											formCodeId, carePlanArray[i].DISPLAY, titleCarePlans);

						} else if (carePlanArray[i].FORM_ID && carePlanArray[i].FORM_ID.length > 0) {
							titleCarePlans = 'Date: ' + carePlanArray[i].DATE + '<br/>Click to view powerform';
							formCodeId = keyinfo.getDomIdFromPowerForm('carePlanForm', parseInt(carePlanArray[i].FORM_ID), encType);
							carePlanStr = gFuncs.sFormatter('<span data-qtip="{2}" class="key-info-clickable" id="{0}">{1}</span>',
								formCodeId, carePlanArray[i].DISPLAY, titleCarePlans);
						} else {
							carePlanStr += carePlanArray[i].DISPLAY;
						}
						str += carePlanStr;
					}
					showCarePlans = true;
				} else {
					str = 'No Care Plans';
				}
				return str;
			})();
			
			var OUTPATIENT_MEASURES = (function() {
				var str = '',
					measureArray = DtoData.INFO[0].OUTPATIENT_MEASURES;
				titleMeasurements = '';
				
				if (measureArray.length > 0) {
					var immu_due = '';
					var health_maint = '';
					var today = new Date().getTime();
					var vac_due_dt = '';
					var ht = ''; // height
					var wt = ''; //weight
					var bmi = ''; //BMI
					var ofc = '';
					var ofc_score = '';
					var ofc_percent = parseFloat(measureArray[0].OFC_PERCENTILE, 10);
					var sp02 = '';
					var pain_scale = '';
					var temperature = measureArray[0].TEMPERATURE;
					var pulse = measureArray[0].PULSE;
					var respiration = measureArray[0].RESPIRATION;
					var systolic = measureArray[0].BP_SYSTOLIC;
					var diastolic = measureArray[0].BP_DIASTOLIC;
					// change whitespace to non-breaking spaces to keep label & info together on one line 
					//temperature = temperature.replace(/ /g, '&nbsp;');
					//pulse = pulse.replace(/ /g, '&nbsp;');
					//respiration = respiration.replace(/ /g, '&nbsp;');
					//systolic = systolic.replace(/ /g, '&nbsp;');
					//diastolic = diastolic.replace(/ /g, '&nbsp;');
					
					if (measureArray[0].HEIGHT){
						ht += measureArray[0].HEIGHT;
						if (measureArray[0].HEIGHT_PERCENTILE) {
							ht += ' (' + measureArray[0].HEIGHT_PERCENTILE + '%)';
						}
						ht += '&nbsp;&nbsp;';
					}
					
					if (measureArray[0].WEIGHT){
						wt += measureArray[0].WEIGHT;
						if (measureArray[0].WEIGHT_PERCENTILE){
							wt += ' (' + measureArray[0].WEIGHT_PERCENTILE + '%)';
						}
						wt += '&nbsp;&nbsp;';
					}
					
					if (measureArray[0].BMI_DISPLAY) {
						bmi += measureArray[0].BMI_DISPLAY;
						bmi += '&nbsp;&nbsp;';
						if(measureArray[0].BMI_FLAG ==="yes") {
							bmi = '<span class="key-info-clickable label-text-group" style="padding-right:8px;" id="AMB_BMI"><span data-qtip="'+ titleMeasurements + '"><strong>BMI: </strong></span><span class="restraint-alert">'+ bmi + '</span></span>';
						} else {
							bmi = '<span class="key-info-clickable label-text-group" style="padding-right:8px;" id="AMB_BMI"><span data-qtip="'+ titleMeasurements + '"><strong>BMI: </strong></span>'+ bmi + '</span>';
						}						
					}
					
					// check to see if Head Circumference Percentile (OFC_PERCENTILE) is higher than 1% & less than 99%
					// if true display percentage, if false display ZScore
					if(measureArray[0].OFC){
						ofc += measureArray[0].OFC;
						
						if (measureArray[0].OFC_PERCENTILE){
							if (ofc_percent > 1 && ofc_percent < 99){					
								ofc_score = ofc_percent + '%';
							}
							else {
								ofc_score = 'Z=' + measureArray[0].OFC_ZSCORE;
							}
							ofc += ' (' + ofc_score + ')';
						}
						//ofc = ofc.replace(/ /g, '&nbsp;');
					}
					
					if (measureArray[0].SP02){
						sp02 = measureArray[0].SP02 + '%';
					} 
					
					if (measureArray[0].PAIN_SCORE){
						pain_scale += measureArray[0].PAIN_SCORE;
						if (measureArray[0].PAIN_SCALE) {
							pain_scale += ' (' + measureArray[0].PAIN_SCALE + ')';
						}
					}
					
					// create the array for immunizations due
					for (var i=0; i < measureArray[0].IMMU_DUE.length; i++){
						// set the vaccine due date to the end of the day so current date doesn't show as overdue
						vac_due_dt = new Date(measureArray[0].IMMU_DUE[i].VAC_DUE_DT).setHours(24,0,0,0);
						
						if (today > vac_due_dt){
							immu_due += '<span class="pathway_important key-info-clickable" data-qtip="Immunization Due: <br/><strong>'+ measureArray[0].IMMU_DUE[i].VAC_DUE_DT + '</strong><br/>Click to open Immunization Schedule">'+ measureArray[0].IMMU_DUE[i].VACCINATION + '</span>';
						}
						else {
							immu_due += '<span class="key-info-clickable" data-qtip="Click to open Immunization Schedule">' + measureArray[0].IMMU_DUE[i].VACCINATION + '</span>';
						}
						// add commas between the immunizations due
						if (measureArray[0].IMMU_DUE.length > 1 && i !== measureArray[0].IMMU_DUE.length-1){
							immu_due += ', ';
						}
					}
					
					for (var i=0; i < measureArray[0].HEALTH_MAINT.length; i++){
						health_maint += measureArray[0].HEALTH_MAINT[i].EXPECTATION;
						if (measureArray[0].HEALTH_MAINT.length > 1 && i !== measureArray[0].HEALTH_MAINT.length-1){
							health_maint += ', ';
						}
					}
					
					titleMeasurements = 'Click to go to growth chart';
					
					measureClickId = keyinfo.getDomIdMeasure(encType);
					
					if (!measureArray[0].HEIGHT && !measureArray[0].WEIGHT && !measureArray[0].OFC) {
						str += '';
					}
					else {
						str += '<tr><td class="key-info-data-column"><div class="hang key-info-hover"><span class="key-info-clickable label-text-group" style="padding-right:8px;" id="AMB_Ht"><span data-qtip="'+ titleMeasurements + '"><strong>Ht: </strong></span>'+ ht + '</span><span class="key-info-clickable label-text-group" style="padding-right:8px;" id="AMB_Wt"><span data-qtip="'+ titleMeasurements + '"><strong>Wt: </strong></span>'+ wt + '</span>'+ bmi +'<span id="AMB_OFC" class="key-info-clickable label-text-group"><span data-qtip="'+ titleMeasurements + '"><strong>OFC: </strong></span>' + ofc + '</span></div></td></tr>';
					}
					if (!measureArray[0].TEMPERATURE && !measureArray[0].PULSE && !measureArray[0].RESPIRATION && !measureArray[0].BP_SYSTOLIC && !measureArray[0].SP02){
						str += '';
					}
					else {
						str += '<tr style="float:clear;"><td class="key-info-data-column"><div class="hang key-info-hover"><span class="label-text-group" style="padding-right:12px;"><strong>T:&nbsp;</strong>'+ temperature +'&nbsp;&nbsp;</span><span class="label-text-group"  style="padding-right:12px;"><strong>P:&nbsp;</strong>'+ pulse +'&nbsp;&nbsp;</span><span class="label-text-group"  style="padding-right:12px;"><strong>R:&nbsp;</strong>'+ respiration +'&nbsp;&nbsp;</span><span class="label-text-group"  style="padding-right:12px;"><strong>BP:&nbsp;</strong>'+ systolic + '/' + diastolic + '&nbsp;&nbsp;</span><span class="label-text-group"><strong>SP02:&nbsp;</strong>'+ sp02 +'</span></div></td></tr>';
					}
					if (measureArray[0].PAIN_SCORE.length >= 1){
						str += '<tr style="float:clear;"><td class="key-info-data-column"><div class="hang"><strong>Pain: </strong>'+ pain_scale +'</div></td></tr>';
					}
					if (measureArray[0].IMMU_DUE.length >= 1) {
						str += '<tr><td class="key-info-data-column"><div class="hang key-info-hover" id="AMB_Immu_Due"><span data-qtip="Click to open Immunization Schedule" class="key-info-clickable"><strong>Immu Due: </strong></span>'+ immu_due +'</div></td></tr>';
					}
					if (measureArray[0].HEALTH_MAINT.length >= 1) {
						str += '<tr><td class="key-info-data-column"><div class="hang key-info-hover" id="AMB_Health_Maint"><span data-qtip="Click to open Health Maintenance" class="key-info-clickable"><strong>Health Maint: </strong></span><span class="key-info-clickable">'+ health_maint +'</span></div>';
					}			
								
				}
				return str;
			})();
			
			if (!amb) { //BMI
				BMIS = (function() {
					var str = '',
						bmiArray = DtoData.INFO[0].BMIS;
					titleBMI = '';	
					if (bmiArray.length > 0) {
						titleBMI = 'Click to go to growth chart';
						bmiClickId = keyinfo.getDomIdBMI(encType);
						showBMI = true;
						for (var i = 0; i < bmiArray.length; i++) {
							if (i > 0) {
								str += ', ';
							}
							if (bmiArray[i].BMI_FLAG === "yes") {
								str += '<span class="restraint-alert">'+ bmiArray[i].BMI_DISPLAY + '</span>';
							} else {
								str += bmiArray[i].BMI_DISPLAY;
							}					
						}
					} else {
						str = 'None';
					}
					return str;
				})();		
			}
			
 			var ALLERGIES = (function() {
				var otherArray = DtoData.ALLERGY;
				var str = '';
 				titleAllergies = '';
				if (otherArray.length > 0) {
					titleAllergies = 'Click to go to Allergies tab';
					allergiesClickId = keyinfo.getDomIdForAllergies(encType);
				}
				for (var i = 0; i < otherArray.length; i++) {
					str += otherArray[i].DESC;
					if (str.length > 140) {
						str += '....';
						break;
					}
					if (i < otherArray.length - 1) {
						str += ', ';
					}  
				}
				
				if (str.length === 0 || str.match(/No known allergies/i) || str.match(/No Known Medication Allergies/i)) {
					str = str ? str : 'None';
				} else {
					str = '<span class="allergy-alert">' + str + '</span>';
				}
				
				return str;
			})(); 
			
			var DISCHARGE_CRITERIA = (function() {
				var str = '',
					dischargeArray = DtoData.DISCHARGE_CRITERIA;
				titleDischarge = '';
				// iconDischarge = iconSpace;
				iconDischarge = ''; // init to empty string, not iconSpace
				dischargeClickId = keyinfo.getDomIdForDischarge(encType);

				// check for special icon - rule is no icon (iconSpace) if no discharge
				// order
				// otherwise red icon if 'waiting to see attending'
				var iconColor = DtoData.DISCHARGE_ORDER_ICON;
				var iconStr = '';

				if (iconColor.toLowerCase() !== 'none') {
					switch(iconColor.toLowerCase()) {
						case 'red':
							iconStr = 'home_red_24.png';
							break;
						case 'blue':
							iconStr = 'home_blue_24.png';
							break;
						case 'green':
							iconStr = 'home_green_24.png';
							break;
						default:
							break;
					}
					titleDischarge = 'Click to go to Orders tab';
					iconDischarge = gFuncs.sFormatter('<img title="Discharge Order"  class="key-info-icon" src="{0}img/{1}" />', chla.global.imgPath, iconStr);					
				}

				if (dischargeArray.length == 0) {
					str = 'None';
				} else if (dischargeArray.length == 1) {
					str = dischargeArray[0].TEXT + ' - ' + dischargeArray[0].RESULT;
				} else {
					var qtip = '&nbsp <i>Click to go to Orders</i><div style=\'padding-left:6px;\'><table><thead><tr><th>Text</th><th>&nbspResult</th><th>&nbsp Date</th></tr></thead><tbody>';
					for (var x = 1; x < dischargeArray.length; x++) {
						str += '<span data-qtip="{0}">';
						str += dischargeArray[x].TEXT;
						var result = dischargeArray[x].RESULT;
						var parsed = parseInt(result);
						qtip += '<tr><td>' + dischargeArray[x].TEXT + '&nbsp</td><td>';
						if (isNaN(parsed)) {
							qtip += ' &nbsp ' + result + ' &nbsp ';
							str += ' - ' + result;
						} else {
							qtip += ' &nbsp ' + result + ' Hrs &nbsp ';
							str += ' - ' + result + ' Hrs';
						}
						qtip += '</td><td>&nbsp ' + dischargeArray[x].DATE + '</td></tr>';
						if (dischargeArray.length - x > 1) {
							str += '<br/>';
						}						
						str += '</span>';
					}
					qtip += '</tbody></table></div>';
					str = gFuncs.sFormatter(str, qtip);
				}
				return str;
			})();
			
			var CLINICAL_PATHWAYS = (function() {
				var str = '',
				pathwayArray = DtoData.MAP_ORDERS;
				titleCswPathway = '';
				// iconCswPathway = iconSpace;
				iconCswPathway = '';
				if (pathwayArray.length > 0) {
					var iconLocation = 'img/map_32.png';
					titleCswPathway = 'Click to view Orders';
					for (var i = 0; i < pathwayArray.length; i++) {
						str += gFuncs.sFormatter(
							'<span data-qtip="{1}">{0}</span>',
							pathwayArray[i].ORDER_MNEMONIC,
							pathwayArray[i].ORDER_DETAIL_DISPLAY_LINE
						);
						if (i < pathwayArray.length - 1) {
							str += '; ';
						}
					}
					cswPathwayClickId = keyinfo.getDomIdForCswPathways(encType);
					iconMAP = keyinfo.getDomIdMAPIcon(encType);
					iconCswPathway = gFuncs.sFormatter(
						'<img style="cursor:pointer;" class="key-info-icon" src="{0}{1}" id="{2}" data-qtip="{3}" />',
						chla.global.imgPath, 
						iconLocation,
						iconMAP, 
						titleCswPathway);
				} else {
					str = "None";
				}
				return str;
			})();
			
			var ASSIGNED_RN = (function() {
				var str = '',
					rnArray = DtoData.INFO[0].ASSIGNED_RN;
				var displayString = '';
				var theTip = '';
				titleRn = '';
				rnClickId = keyinfo.getDomIdForRnTitle(encType);
				if (rnArray.length > 0) {
					//titleRn = 'Click to go to contacts tab';
					for (var i = 0; i < rnArray.length; i++) {
						if (i > 0) {
							str += ', ';
						}
						displayString += gFuncs.sFormatter('{0}, {1}', rnArray[i].RN_NAME
										.substring(0, 35), rnArray[i].RN_PHONE
										.substring(0, 5));
										
						theTip += gFuncs.sFormatter(
								'<b>Name: </b>{0}<br /><b>Phone: </b> {1}',
								rnArray[i].RN_NAME, rnArray[i].RN_PHONE);
					}
					str = gFuncs.sFormatter('<span data-qtip="{0}">{1}</span>', theTip,
							displayString);

				} else {
					str = 'Not Assigned';
				}
				return str;
			})();
			
			var PMA = (function() {
				var str = '',
					pma = DtoData.INFO[0].PMA;
				titlePMA = '';	
				if (pma.length > 0) {
					titlePMA = 'PMA';
					showPMA = true;
					str = pma;
				} else {
					str = '';
				}
				return str;
			})();		
			
			var CODE_STATUS = (function() {
				var str = DtoData.CODESTATUS;
				var formCodeId = '';
				var alertStr = '';
				titleCodeStatus = '';
				iconCodeStatus = '';
				
				if (str.length > 0) {	
					codeStatusClickId = keyinfo.getDomIdForCodeStatus(encType);
					titleCodeStatus = 'Click to see Note';
					iconCodeStatus = gFuncs.sFormatter('<img title="Code Status"  class="key-info-icon" src="{0}img/code_status_32.png" />',chla.global.imgPath);
					str = '<span class="pathway_important">' + str + '</span>';
				/* 	for (i = 0; i < codeStatusArray.length; i++) {
						titleCodeStatus = '';
						if (i > 0) {
							str += ', ';
						}
						var clinicalNoteStr = '';
						
						// 9/12/2013 Link to the powerform only if
						// the NEW form has been filled out for the current encounter
						
						//03/02/16 Display code status in red for any value other than "Full Support"
						if (codeStatusArray[i].FORM_ID
							&& codeStatusArray[i].FORM_ID.length > 0
							&& codeStatusArray[i].FORM_IND.toLowerCase().indexOf("current") !== -1) {
							// id will be used to attach listener after layout
								titleCodeStatus = 'Click to view powerform';	
								
								// formCodeId = keyinfo.getDomIdFromPowerForm(
										// codeStatusArray[i].FORM_TYPE,
										// codeStatusArray[i].FORM_ID, encType);
								
								// // check alert flag for Code Status Attending Attestation
								// if (codeStatusArray[i].ALERT === 'true') {
									 // alertStr = '<span class="pathway_important">(!)</span>';	
								// }
								// if (codeStatusArray[i].FORM_TYPE.indexOf("Full Support") !== -1) {
									// clinicalNoteStr = '<a href="#" data-qtip="'+ titleCodeStatus + '" class="powerform-opener" id="{0}">{1}{2}</a>'.format(
											// formCodeId, 
											// alertStr, 
											// codeStatusArray[i].FORM_TYPE);		
								// } else {
									// clinicalNoteStr = '<a href="#" data-qtip="'+ titleCodeStatus + '" class="powerform-opener-important" id="{0}">{1}{2}</a>'.format(
											// formCodeId, 
											// alertStr, 
											// codeStatusArray[i].FORM_TYPE);		
								// }
															
						} else {
							clinicalNoteStr = '<span class="casper-data">'+codeStatusArray[i].FORM_TYPE+'</span>';
						}
						
						// as of 11/1/2011 the definition of the icon for alerting 'DNR'
						// is not resolved
						// and the AFND gif files will not be dipslayed
						if (codeStatusArray[i].FORM_TYPE.toLowerCase().indexOf("dnr") !== -1) {
							iconCodeStatus = '<img title="Code Status"  class="key-info-icon" src="{0}img/afnd.gif" />'.format(
											chla.global.imgPath);
						}
						str += clinicalNoteStr;
					 }*/
				} else {
					// 9/12/2013 Disply "Full Support" if form has not been filled out at all
					str = 'Full Support';
				}
				return str;
			})();

			var ISOLATION_INFO = (function() {
				//for the text, comma separate
				//for icon show others by default if 1+
				var displayStr = DtoData.ISOLATION;
				var iconStr1 = DtoData.ICON_STRING_1;
				// iconIsolation1 = iconSpace;
				iconIsolation1 = ''; // init to empty string, not iconSpace
				if (iconStr1.length > 0) {
					isoClickId = keyinfo.getDomIdIso(encType);
					// set icon 1
					switch (iconStr1) {
						case 'airborne' :
							iconIsolation1 = gFuncs.sFormatter('<img title="Airborne Respirator Isolation" class="key-info-icon" src="{0}img/iso_airborne_32.png" />',chla.global.imgPath);
							break;
						case 'contact_plus' :
							iconIsolation1 = gFuncs.sFormatter('<img title="Contact Enteric Isolation" class="key-info-icon" src="{0}img/iso_contactplus_32.png" />',chla.global.imgPath);
							break;
						case 'contact' :
							iconIsolation1 = gFuncs.sFormatter('<img title="Contact Isolation" class="key-info-icon" src="{0}img/iso_contact_32.png" />',chla.global.imgPath);
							break;
						case 'droplet' :
							iconIsolation1 = gFuncs.sFormatter('<img title="Droplet Isolation"  class="key-info-icon" src="{0}img/iso_droplet_32.png" />',chla.global.imgPath);
							break;
						case 'droplet_plus' :
							iconIsolation1 = gFuncs.sFormatter('<img title="Droplet Isolation"  class="key-info-icon" src="{0}img/iso_dropletplus_32.png" />',chla.global.imgPath);
							break;
						case 'mask' :
							iconIsolation1 = gFuncs.sFormatter('<img title="Strict Isolation"  class="key-info-icon" src="{0}img/iso_mask_32.png" />',chla.global.imgPath);
							break;
						case 'protective' :
							iconIsolation1 = gFuncs.sFormatter('<img title="Viral Isolation"  class="key-info-icon" src="{0}img/iso_protective_32.png" />',chla.global.imgPath);
							break;
						case 'multiple' :
							iconIsolation1 = gFuncs.sFormatter('<img title="Isolation: See CIS for details" class="key-info-icon" src="{0}img/iso_X.png" />',chla.global.imgPath);
							break;
						default :
							// iconIsolation1 = iconSpace; don't want empty space if
							// no icon
							break;
					}
				}	
				return (displayStr ? displayStr : 'None');
			})();
 
			var RESISTANT_INFO = (function() {
				//for the text, comma separate
				//for icon show others by default if 1+
				var iconStr2 = DtoData.ICON_STRING_2;
				var displayStr = DtoData.RESISTANT;
				// iconIsolation2 = iconSpace;
				iconIsolation2 = ''; // init to empty string, not iconSpace
				// set icon 2				
				if (iconStr2.length > 0) {
					resClickId = keyinfo.getDomIdRes(encType);
					switch (iconStr2) {
						case 'mrsa' :
							iconIsolation2 = gFuncs.sFormatter('<img title="MRSA Isolation" class="key-info-icon" src="{0}img/prec_mrsa.gif" />',chla.global.imgPath);
							break;
						case 'vre' :
							iconIsolation2 = gFuncs.sFormatter('<img title="Vancomycin Resistant Isolation" class="key-info-icon" src="{0}img/prec_vre.gif" />',chla.global.imgPath);
							break;
						case 'esbl' :
							iconIsolation2 = gFuncs.sFormatter('<img  title="Extended Spectrum Beta Lactamase Isolation" class="key-info-icon" src="{0}img/prec_esbl.gif" />',chla.global.imgPath);
							break;
						case 'tb' :
							iconIsolation2 = gFuncs.sFormatter('<img  title="Tuberculosis" class="key-info-icon" src="{0}img/prec_tb.png" />',chla.global.imgPath);
							break;
						case 'cf' :
							iconIsolation2 = gFuncs.sFormatter('<img  title="Cystic Fibrosis" class="key-info-icon" src="{0}img/prec_cf.png" />',chla.global.imgPath);
							break;						
						case 'other' :
							iconIsolation2 = gFuncs.sFormatter('<img title="Other Isolation" class="key-info-icon" src="{0}img/prec_other.gif" />',chla.global.imgPath);
							break;
						default :
							// iconIsolation2 = iconSpace; don't want empty space if
							// no icon
							break;
					}
				}
				return displayStr;
			})();
 
			var WEIGHTS = (function() {
				var str = '',
					weight = DtoData.ROUTINE_WT,
					dt = (DtoData.ROUTINE_WT_DT_TM ? gFuncs.convertDate(DtoData.ROUTINE_WT_DT_TM) : '');
				titleWeight = 'Click to go to growth chart';
					weightClickId = keyinfo.getDomIdWeight(encType);
				if (weight) {
					str += weight;
					str += (dt ? ' from ' + dt : ''); 
				} else {
					str = 'None';
				}
				return str;
			})();
			
			var MED_CALC_WT = (function() {
				var str = '',
					weight = (DtoData.MED_CALC_WT ? DtoData.MED_CALC_WT + ' kg' : ''),
					dt = (DtoData.MED_CALC_WT_DT_TM ? gFuncs.convertDate(DtoData.MED_CALC_WT_DT_TM) : '');
				if (weight) {
					str += weight;
					str += (dt ? ' from ' + dt : ''); 
				} else {
					str = 'None';
				}
				return str;
			})();
			
			var HEIGHTS = (function() {
				var str = '',
					height = DtoData.HEIGHT,
					units = DtoData.HEIGHT_UNITS,
					dt = gFuncs.convertDate(DtoData.HEIGHT_DT_TM);
					
				titleHeight = '';
				if (height) {
					titleHeight = 'Click to go to growth chart';
					heightClickId = keyinfo.getDomIdHeight(encType);
					showMeasHt = true;
					str += height + ' ' + units;
					str += (dt ? ' from ' + dt : ''); 
					//<td class="eAppsLeftShade eAppsTblLbl">Measured Ht</td><td class="eAppsLeft">143.2<span class="eapps-unitsHO"> cm</span> ( &Delta; 1.1<span class="eapps-unitsHO"> cm from 04/17/2017 09:22</span>)</td></tr>',
				} else {
					str = 'None';
				}
				return str;
			})();

			var LOCATION_HISTORY = (function() {
				var str = '',
					qtip = '<div style=\'padding-left:6px;\'><table><thead><tr><th> &nbsp Date &nbsp </th><th> &nbsp Location &nbsp </th><th> &nbsp Med Service &nbsp </th></tr></thead><tbody>',
					locs = DtoData.INFO[0].LOC_HIST_REC;
					
				if (locs.length > 0) {
					for (i = 0; i < locs.length; i++) {
						qtip += '<tr><td> &nbsp ' + locs[i].DATE + ' &nbsp </td><td>';
						qtip += ' &nbsp ' + locs[i].LOCATION + ' &nbsp';
						qtip += '</td><td> &nbsp' + locs[i].MED_SERVICE + ' &nbsp </td></tr>';
					}
				} else {
					str = 'No Location History data';
				}
				qtip += '</tbody></table></div>';
				return retVal.LOCATION_HISTORY = (str ? str : qtip);
			})();
			
			var PATIENT_LANGUAGE_FOR_CARE = (function() {
				var str = DtoData.PATIENT_LANGUAGE_FOR_CARE ? DtoData.PATIENT_LANGUAGE_FOR_CARE : '';
				if(str.match(/ENGLISH/i)) {
					return '';
				} else {
					return str;
				}
			})();
			
			var PARENT_LANGUAGE_FOR_CARE = (function() {
				var str = DtoData.PARENT_LANGUAGE_FOR_CARE ? DtoData.PARENT_LANGUAGE_FOR_CARE : '';
				if(str.match(/ENGLISH/i)) {
					return '';
				} else {
					return str;
				}
			})();
			
			var GUARDIANS = (function() {
				var str = '',
					qtip = '&nbsp <i>Click to go to Pt Info</i><div style=\'padding-left:6px;\'><table><thead><tr><th> &nbsp Name &nbsp </th><th> &nbsp Relationaship &nbsp </th><th> &nbsp Contacts &nbsp </th></tr></thead><tbody>',
					parents = DtoData.GUARDIAN;
				guardiansClickId = keyinfo.getDomIdGuardian(encType);				
					
				if (parents.length > 0) {
					for (i = 0; i < parents.length; i++) {
						str += parents[i].NAME_FULL_FORMATTED;
						str += (parents[i].PERSON_RELTN ? ' (' + parents[i].PERSON_RELTN + ') ' : '');
						//str += (parents[i].PHONE.length > 0 ? parents[i].PHONE[0].PHONE_NUM : '');
						str += (i < parents.length - 1 ? '<br/>' : '');
						qtip += '<tr><td> &nbsp ' + parents[i].NAME_FULL_FORMATTED + ' &nbsp </td><td>';
						qtip += ' &nbsp ' + parents[i].PERSON_RELTN + ' &nbsp</td><td>';
						for (x = 0; x < parents[i].PHONE.length; x++) {
							qtip += ' &nbsp ' + parents[i].PHONE[x].PHONE_NUM + (x < parents[i].PHONE.length - 1 ? '<br/>' : '');
						}
						qtip += ' &nbsp </td></tr>';
					}
					qtip += '</tbody></table></div>';
					titleGuardians = qtip;
				}
				return str;
			})();
			
			var FIRSTCALL = (function() {
				var str = '';
				titleContactProvider = '';
				contactProviderClickId = keyinfo.getDomIdForContactTitle(encType);
				if (DtoData.FIRSTCALL && DtoData.FIRSTCALL.length > 0) {
					titleContactProvider = '&nbspPlease wait while we retrieve contacts for this provider...';
					str += DtoData.FIRSTCALL;
				} else {
					str += 'Not Assigned';
				}
				return str;
			})();
			
			var ATTENDINGS = (function() {
				var str = '';
				if (DtoData.ATTEND.length > 0) {
					for (i = 0; i < DtoData.ATTEND.length; i++) {
						str += '<span id="' + keyinfo.getDomIdForAttendingTitle(encType, i) + '" data-qtip=" Please wait while we retrieve contacts for this provider...">';
						str += DtoData.ATTEND[i].NAME_FULL_FORMATTED;
						if (i < DtoData.ATTEND.length - 1) {
							str += '</span><br/>';
						} else {
							str += '</span>';
						}
					}
				} else {
					str += 'Not Assigned';
				}
				return str;
			})();
			
			var CARETEAM = (function() {
				var str = '';
				titleCareTeam = '';
				contactCareTeamClickId = keyinfo.getDomIdForCareTeamTitle(encType);
				if (DtoData.CARETEAM && DtoData.CARETEAM.length > 0) {
					//titleCareTeam = 'Please wait while we retrieve contacts for these providers...';
					str += DtoData.CARETEAM;
				} else {
					str += 'Not Assigned';
				}
				return str;
			})();
			
			var ED_ACUITY = (function() {
				if(DtoData.INFO[0].ED_ACUITY.length > 0) {
					switch(DtoData.INFO[0].ED_ACUITY.substring(0,1)) {
						case '1':
							iconEdAcuity = gFuncs.sFormatter('<img title="ED Acuity Level 1"  class="key-info-icon" src="{0}img/ed_icons/{1}" />',
									chla.global.imgPath, 'esi_1_32.png'); break;
						case '2':
							iconEdAcuity = gFuncs.sFormatter('<img title="ED Acuity Level 2"  class="key-info-icon" src="{0}img/ed_icons/{1}" />',
									chla.global.imgPath, 'esi_2_32.png'); break;
						case '3':
							iconEdAcuity = gFuncs.sFormatter('<img title="ED Acuity Level 3"  class="key-info-icon" src="{0}img/ed_icons/{1}" />',
									chla.global.imgPath, 'esi_3_32.png'); break;
						case '4':
							iconEdAcuity = gFuncs.sFormatter('<img title="ED Acuity Level 4"  class="key-info-icon" src="{0}img/ed_icons/{1}" />',
									chla.global.imgPath, 'esi_4_32.png'); break;
						case '5':
							iconEdAcuity = gFuncs.sFormatter('<img title="ED Acuity Level 5"  class="key-info-icon" src="{0}img/ed_icons/{1}" />',
									chla.global.imgPath, 'esi_5_32.png'); break;
						default:
							break;
					}
				}
				return(DtoData.INFO[0].ED_ACUITY);
			})();
			
			var ED_LOS = (function() {
				return(DtoData.INFO[0].ED_LOS);
			})();

			var ED_ATTENDING = (function() {
				return(DtoData.INFO[0].ED_ATTENDING);
			})();

			var ED_RESIDENT = (function() {
				return(DtoData.INFO[0].ED_RESIDENT);
			})();

			var ED_RN = (function() {
				return(DtoData.INFO[0].ED_RN);
			})();

			var ED_NP = (function() {
				return(DtoData.INFO[0].ED_NP);
			})();

			var ED_DISPOSITION_DISPLAY = (function() {	
				return(DtoData.INFO[0].ED_DISPOSITION_DISPLAY);
			})();

			var ED_DISPOSITION_KEY = (function() {
				//iconDischarge
				var value = DtoData.INFO[0].ED_DISPOSITION_KEY;
				var iconStr = '';
				var iconTitleStr = '';
				switch(value) {
					case 'INPTBEDREQUEST':
						iconStr = 'ip_bed_req_32.png';
						iconTitleStr = 'ED: Inpt Bed Request';
						break;
					case 'INPATIENTBEDREADY':
						iconStr = 'ip_bed_ready_32.png';
						iconTitleStr = 'ED: Inpt Bed Ready';
					
						break;
					case 'ATTENDINGDISCHARGE':
						iconStr = 'attending_dc_32.png';
						iconTitleStr = 'ED: Attending DC';
					
						break;
					case 'DISCHARGE':
						iconStr = 'dc_32.png';
						iconTitleStr = 'ED: Discharge';
					
						break;
					case 'RTM':
						iconStr = 'rtm_32.png';
						iconTitleStr = 'ED: Ready To Move';
					
						break;
					case 'TRANSFER':
						iconStr = 'transfer_32.png';
						iconTitleStr = 'ED: Transfer';
						break;
					default:
						break;
				}
				if(iconStr !== '') {
					iconEdStatus = gFuncs.sFormatter(
									'<img title="{2}"  class="key-info-icon" src="{0}img/ed_icons/{1}" />',
									chla.global.imgPath, iconStr, iconTitleStr);
				} else {
					iconEdStatus = '';
				}

				return(value);
			})();
			
 			var numberOfRows, iconColumn;
			if (amb) {
				iconColumn = '<div>' + iconMpews + '</div><div>' + iconCodeStatus + '</div><div>' + iconIsolation1 + '</div><div>' + 
					iconIsolation2 + '</div><div>' + iconCswPathway + '</div><div>' + iconFlu + '</div>';
			} else {
				if (ed) {
					iconColumn = '<div>' + iconMpews + '</div><div>' + iconCodeStatus + '</div><div>' + iconIsolation1 + '</div><div>' + 
						iconIsolation2 + '</div><div>' + iconDiet + '</div><div>' + iconCswPathway + '</div><div>' + iconEdAcuity + '</div><div>' + iconEdStatus + '</div><div>' + iconFlu + '</div>';
				} else {
					iconColumn = '<div>' + iconMpews + '</div><div>' + iconCodeStatus + '</div><div>' + iconIsolation1 + '</div><div>' + 
						iconIsolation2 + '</div><div>' + iconDiet + '</div><div>' + iconCswPathway + '</div><div>' + iconDischarge + '</div><div>' + iconFlu + '</div>';
				}
			}
			//chla.eAppsUtil.Logger.LogError(iconFlu);
         
         // Setup Column Counter
         var colCnt = 0;
			
			//start building the HTML table rows for easy UI processing
 			retVal.htmlRows.push('<td class="key-info-icon-column" rowspan="100" width="40">'
				+ iconColumn
				+ '<tr></td></td><td class="key-info-data-column" ><div class="hang"><span class="key-info-label">MedCalc Wt: </span><span>'
				+ MED_CALC_WT
				+ '</span></div></td>');
         
         if (keyinfo.addColumnYN(viewType, colCnt)) {
            retVal.htmlRows.push('</tr><tr>');  
         }    
         colCnt++;  
         
			
 			clickableClass = titleWeight.length > 0 ? 'key-info-clickable' : '';
			retVal.htmlRows.push('<td  class="key-info-data-column" ><div class="hang key-info-hover" data-qtip="'
				+ titleWeight 
				+ '" id="'
				+ weightClickId
				+ '"><span class="key-info-label '
				+ clickableClass
				+ '">Wt: </span><span class="key-info-clickable" >'
				+ WEIGHTS
				+ '</span></div></td>');
			
			if(showMeasHt) {
            if (keyinfo.addColumnYN(viewType, colCnt)) {
               retVal.htmlRows.push('</tr><tr>'); 
            }
            colCnt++;
            
				clickableClass = titleHeight.length > 0 ? 'key-info-clickable' : '';
				retVal.htmlRows.push(
					'<td class="key-info-data-column">'
                  + '<div data-qtip="' + titleHeight + '" class="hang key-info-hover" id="' + heightClickId + '">'
                     + '<span class="key-info-label  ' + clickableClass + '">'
                        + 'Ht: '
                     + '</span>'
                     + '<span class="key-info-clickable">'
                     + HEIGHTS
                     + '</span>'
                  + '</div>'
               + '</td>');
			}
			
			if(showBMI) {            
            if (keyinfo.addColumnYN(viewType, colCnt)) {
               retVal.htmlRows.push('</tr><tr>'); 
            }
            colCnt++;
            
				clickableClass = titleBMI.length > 0 ? 'key-info-clickable' : '';
				retVal.htmlRows.push(
					'<td class="key-info-data-column">'
                  + '<div data-qtip="' + titleBMI + '" class="hang" id="' + bmiClickId + '">'
                     + '<span class="key-info-label  ' + clickableClass + '">'
                        + 'BMI: '
                     + '</span>'
                     + '<span class="key-info-clickable">'
                     + BMIS
                     + '</span>'
                  + '</div>'
               + '</td>');
			}
			
			if(showPMA) {
            if (keyinfo.addColumnYN(viewType, colCnt)) {
               retVal.htmlRows.push('</tr><tr>'); 
            }
            colCnt++;
            
				retVal.htmlRows.push(
					'<td class="key-info-data-column" >'
					+ '<div  class="hang key-info-hover"><span  data-qtip="'
					+ titlePMA
					+ '" class="key-info-label  '
					+ '">PMA: </span><span>'
					+ PMA 
					+ '</span></div></td>');
			}
			
         
         if (keyinfo.addColumnYN(viewType, colCnt)) {
            retVal.htmlRows.push('</tr><tr>'); 
         }
         colCnt++;
         
			clickableClass = titleCodeStatus.length > 0 ? 'key-info-clickable' : '';
			retVal.htmlRows.push('<td class="key-info-data-column" >'
				+ '<div id="'
				+ codeStatusClickId
				+ '" ' + (titleCodeStatus ? 'data-qtip="'+ titleCodeStatus + '"' : '')
				+ ' class="hang key-info-hover '
				+ clickableClass
				+ '"><span class="key-info-label">Code Status: </span><span>'
				+ CODE_STATUS 
				+ '</span></div></td>');
			
			if (showAdvanceDirective) {
            if (keyinfo.addColumnYN(viewType, colCnt)) {
               retVal.htmlRows.push('</tr><tr>'); 
            }
            colCnt++;
            
				retVal.htmlRows.push('<td class="key-info-data-column">'
						+ '<div class="hang"><span class="key-info-label">Advance Directive</span>'
						+ '<span class="advance-directive">' 
						+ ADVANCE_DIRECTIVE 
						+ '</span></div></td>');
				ADVANCE_DIRECTIVE
			}
         if (keyinfo.addColumnYN(viewType, colCnt)) {
            retVal.htmlRows.push('</tr><tr>');  
         }    
         colCnt++; 			
			if (ISOLATION_INFO.length > 0) {
				retVal.htmlRows.push('<td class="key-info-data-column">'
					+ '<div class="hang key-info-hover"><span class="key-info-label">Isolation: </span>'
					+ '<span class="key-info-clickable" id="' + isoClickId + '" data-qtip="Click to view the Isolation Precautions Policy information" >'
					+ ISOLATION_INFO
					+ '</span></div></td>');
			} else { 
				retVal.htmlRows.push('<td class="key-info-data-column">'
					+ '<div class="hang"><span class="key-info-label">Isolation: </span>'
					+ '<span>'
					+ ISOLATION_INFO
					+ '</span></div></td>');
			}
			
			if (RESISTANT_INFO.length > 0) {
            if (keyinfo.addColumnYN(viewType, colCnt)) {
               retVal.htmlRows.push('</tr><tr>');  
            }    
            colCnt++; 
				retVal.htmlRows.push('<td class="key-info-data-column">'
					+ '<div class="hang key-info-hover"><span class="key-info-label">Resistant: </span>'
					+ '<span class="key-info-clickable" id="' + resClickId + '" data-qtip="Click to view the Resistant Organisms Policy information" >'
					+ RESISTANT_INFO
					+ '</span></div></td>');
			}
         
         if (keyinfo.addColumnYN(viewType, colCnt)) {
            retVal.htmlRows.push('</tr><tr>');  
         }    
         colCnt++; 
				
			retVal.htmlRows.push('<td class="key-info-data-column">'
					+ '<div class="hang"><span class="key-info-label">Precautions: </span>'
					+ PRECAUTIONS 
					+ '</div></td>');
			
			if (showCarePlans) {            
            if (keyinfo.addColumnYN(viewType, colCnt)) {
               retVal.htmlRows.push('</tr><tr>');  
            }    
            colCnt++; 
				retVal.htmlRows.push('<td class="key-info-data-column"><div class="hang key-info-hover" ><span class="key-info-label">Care Plans: </span>'
				+ CARE_PLANS
				+ '</div></td>');
			}			
         
         if (keyinfo.addColumnYN(viewType, colCnt)) {
            retVal.htmlRows.push('</tr><tr>');  
         }    
         colCnt++; 
			clickableClass = titleAllergies.length > 0 ? 'key-info-clickable' : '';
 			retVal.htmlRows.push('<td class="key-info-data-column">'
					+ '<div id="' 
					+ allergiesClickId
					+ '" class="hang key-info-hover '
					+ clickableClass
					+ '" data-qtip="' 
					+ titleAllergies 
					+ '"><span class="key-info-label">Allergies: </span>'
					+ ALLERGIES 
					+ '</div></td>');
			
			if (!amb) { //DIETS
            if (keyinfo.addColumnYN(viewType, colCnt)) {
               retVal.htmlRows.push('</tr><tr>');  
            }    
            colCnt++; 
				retVal.htmlRows.push('<td class="key-info-data-column"><div class="hang"><span class="key-info-label">Diet: </span>'
					+ DIETS
					+ '</div></td>');
			}
			
			if (ed) { //ED_ACUITY
				var acuityClass = '',
					htmlStr = '';
				switch(ED_ACUITY.substring(0,1)) {
					case '1':
						acuityClass = 'acuity-1'; break;
					case '2':
						acuityClass = 'acuity-2'; break;
					case '3':
						acuityClass = 'acuity-3'; break;
					case '4':
						acuityClass = 'acuity-4'; break;
					case '5':
						acuityClass = 'acuity-5'; break;
					default:
						break;
				}
				
				if (ED_ACUITY) {
					htmlStr = '<span class="' + acuityClass +'">' + ED_ACUITY + '</span></div>';
				} else {
					htmlStr = '<span>None</span></div>';
				}            
            if (keyinfo.addColumnYN(viewType, colCnt)) {
               retVal.htmlRows.push('</tr><tr>');  
            }    
            colCnt++; 
				retVal.htmlRows.push('<td class="key-info-data-column">'
					+ '<div class="hang" style="float:left;"  >'
					+ '<span class="key-info-label">Acuity: </span>'
					+ htmlStr
					+ '</td>');
			}
			
			if (ed) { //ED_ATTENDING or ATTENDING
				var htmlStr = '';
				if (ED_ATTENDING) {
					htmlStr = '<span>' + ED_ATTENDING + '</span></div>';
				} else {
					htmlStr = '<span>None</span></div>';
				}
            if (keyinfo.addColumnYN(viewType, colCnt)) {
               retVal.htmlRows.push('</tr><tr>');  
            }    
            colCnt++; 
				retVal.htmlRows.push('<td class="key-info-data-column">'
					+ '<div class="hang" style="float:left;"  >'
					+ '<span class="key-info-label">Attending: </span>'
					+ htmlStr
					+ '</td>');
			} else if (!amb) {
            if (keyinfo.addColumnYN(viewType, colCnt)) {
               retVal.htmlRows.push('</tr><tr>');  
            }    
            colCnt++; 
				if (DtoData.ATTEND.length > 0) {
					retVal.htmlRows.push('<td class="key-info-data-column">'
						+ '<span class="key-info-label key-info-clickable">' 
						+ (DtoData.ATTEND.length > 1 ? 'Attendings' : 'Attending') 
						+ ': </span><span class="key-info-clickable">'
						+ ATTENDINGS
						+ '</span></td>');
				} else {
					retVal.htmlRows.push('<td class="key-info-data-column">'
						+ '<div class="hang" style="float:left;"><span class="key-info-label">Attending: </span><span>'
						+ ATTENDINGS
						+ '</span></div></td>');
				}
			}
			
			if (!amb && !ed) { //FIRSTCALL
            if (keyinfo.addColumnYN(viewType, colCnt)) {
               retVal.htmlRows.push('</tr><tr>');  
            }    
            colCnt++; 
				if (DtoData.FIRSTCALL === '') {
					retVal.htmlRows.push('<td class="key-info-data-column">'
						+ '<div class="hang" style="float:left;"><span class="key-info-label">First Call: </span><span>'
						+ FIRSTCALL
						+ '</span></div></td>');
				} else {
					retVal.htmlRows.push('<td class="key-info-data-column">'
						+ '<div class="hang key-info-hover" style="float:left;" id="'
						+ contactProviderClickId
						+ '" data-qtip="' 
						+ titleContactProvider 
						+ '"><span class="key-info-label key-info-clickable">First Call: </span><span class="key-info-clickable">'
						+ FIRSTCALL
						+ '</span></div></td>');
				}
			}
			
			if (!amb && !ed) { //CARETEAM
            if (keyinfo.addColumnYN(viewType, colCnt)) {
               retVal.htmlRows.push('</tr><tr>');  
            }    
            colCnt++; 
				if (DtoData.CARETEAM === '') {
					retVal.htmlRows.push('<td class="key-info-data-column">'
						+ '<div class="hang" style="float:left;"><span class="key-info-label">Care Team: </span><span>'
						+ CARETEAM
						+ '</span></div></td>');
				} else {
					retVal.htmlRows.push('<td class="key-info-data-column">'
						+ '<div class="hang key-info-hover" style="float:left;" id="'
						+ contactProviderClickId
						//+ '" data-qtip="' 
						//+ titleCareTeam 
						+ '"><span class="key-info-label key-info-clickable">Care Team: </span><span class="key-info-clickable">'
						+ CARETEAM
						+ '</span></div></td>');
				}
			}
			
			if (ed) { //ASSIGNED_RN or ED_RN
				var htmlStr = '';
				if (ED_RN) {
					htmlStr = '<span>' + ED_RN + '</span>';
				} else {
					htmlStr = '<span>None</span>';
				}
            if (keyinfo.addColumnYN(viewType, colCnt)) {
               retVal.htmlRows.push('</tr><tr>');  
            }    
            colCnt++; 
				retVal.htmlRows.push('<td class="key-info-data-column">'
					+ '<div class="hang" style="float:left;"  >'
					+ '<span class="key-info-label">RN: </span>'
					+ htmlStr
					+ '</div></td>');
			} else if (!amb) {
            if (keyinfo.addColumnYN(viewType, colCnt)) {
               retVal.htmlRows.push('</tr><tr>');  
            }    
            colCnt++; 
				retVal.htmlRows.push('<td class="key-info-data-column">'
					+ '<div	 * class="hang" ' + 'id="' + rnClickId + '">'
					/* - removed tooltip & link class - RN info isn't on Contacts tab
					+ '<span data-qtip="' + titleRn + '" class="key-info-label  '
					+ clickableClass + ' ">Assigned RN:</span>'
					*/
					+ '<span class="key-info-label">Assigned RN: </span>'
					+ '<span>'
					+ ASSIGNED_RN
					+ '</span>' 
					+ '</div></td>');
			}
			
			if (ed) { //ED_RESIDENT or ED_NP
				var htmlStr = '';
				if (ED_RESIDENT) {
					htmlStr = '<span>' + ED_RESIDENT + '</span>';
				} else {
					htmlStr = '<span>None</span>';
				}
            if (keyinfo.addColumnYN(viewType, colCnt)) {
               retVal.htmlRows.push('</tr><tr>');  
            }    
            colCnt++; 
				retVal.htmlRows.push('<td class="key-info-data-column">'
					+ '<div class="hang" style="float:left;"  >'
					+ '<span class="key-info-label">Resident: </span>'
					+ htmlStr
					+ '</div></td>');					
					
				if (ED_NP) {
					htmlStr = '<span>' + ED_NP + '</span>';
				} else {
					htmlStr = '<span>None</span>';
				}
            if (keyinfo.addColumnYN(viewType, colCnt)) {
               retVal.htmlRows.push('</tr><tr>');  
            }    
            colCnt++; 
				retVal.htmlRows.push('<td class="key-info-data-column">'
					+ '<div class="hang" style="float:left;"  >'
					+ '<span class="key-info-label">NP: </span>'
					+ htmlStr
					+ '</div></td>');
			}
         
         if (keyinfo.addColumnYN(viewType, colCnt)) {
            retVal.htmlRows.push('</tr><tr>');  
         }    
         colCnt++; 
			
			clickableClass = titleCswPathway.length > 0 ? 'key-info-clickable' : '';
			retVal.htmlRows.push('<td class="key-info-data-column" ><div class="hang key-info-hover '
				+ clickableClass
				+ '" id="'
				+ cswPathwayClickId
				+ '"><span data-qtip="'
				+ titleCswPathway
				+ '" class="key-info-label">MAPs: </span>'
				+ CLINICAL_PATHWAYS
				+ '</div></td>');
			
			if (ed) { //DISCHARGE_CRITERIA or ED_DISPOSITION_DISPLAY 
				var htmlStr = '';
				if (ED_DISPOSITION_DISPLAY) {
					htmlStr = '<span>' + ED_DISPOSITION_DISPLAY + '</span>';
				} else {
					htmlStr = '<span>None</span>';
				}
            if (keyinfo.addColumnYN(viewType, colCnt)) {
               retVal.htmlRows.push('</tr><tr>');  
            }    
            colCnt++; 
				retVal.htmlRows.push('<td class="key-info-data-column"><div class="hang" id="'
					+ '"><span class="key-info-label">Event: </span>'
					+ htmlStr
					+ '</div></td>');
			} else if (!amb) {
            if (keyinfo.addColumnYN(viewType, colCnt)) {
               retVal.htmlRows.push('</tr><tr>');  
            }    
            colCnt++; 
				retVal.htmlRows.push('<td class="key-info-data-column"><div class="hang key-info-hover" id="'
					+ dischargeClickId
					+ '"><span data-qtip="'
					+ titleDischarge
					+ '" class="key-info-label  key-info-clickable">Discharge Criteria: </span><span class="key-info-clickable">'
					+ DISCHARGE_CRITERIA
					+ '</span></div></td>');
			}

			if (amb) { //OUTPATIENT_MEASURES
            if (keyinfo.addColumnYN(viewType, colCnt)) {
               retVal.htmlRows.push('</tr><tr>');  
            }    
            colCnt++; 
				retVal.htmlRows.push('<td class="key-info-data-column">' + OUTPATIENT_MEASURES + '</td>');
			}

			if(titleFlu !== '') {
            if (keyinfo.addColumnYN(viewType, colCnt)) {
               retVal.htmlRows.push('</tr><tr>');  
            }    
            colCnt++; 
				retVal.htmlRows.push('<td class="key-info-data-column"><div class="hang" ><span class="key-info-label">' + titleFlu + '</span>'
					+ INFLUENZA
					+ '</div></td>');
			}
			
 			if(PATIENT_LANGUAGE_FOR_CARE || PARENT_LANGUAGE_FOR_CARE) {
				var str = (PATIENT_LANGUAGE_FOR_CARE ? PATIENT_LANGUAGE_FOR_CARE + ' (Pt) / ': '') + (PARENT_LANGUAGE_FOR_CARE ? PARENT_LANGUAGE_FOR_CARE + ' (Family)': '');
            if (keyinfo.addColumnYN(viewType, colCnt)) {
               retVal.htmlRows.push('</tr><tr>');  
            }    
            colCnt++; 
				retVal.htmlRows.push('<td class="key-info-data-column"><div class="hang" ><span class="key-info-label">Lang:</span>'
					+ str
					+ '</div></td>');
			}
				
			if (GUARDIANS.length > 0) {
            if (keyinfo.addColumnYN(viewType, colCnt)) {
               retVal.htmlRows.push('</tr><tr>');  
            }    
            colCnt++; 
				retVal.htmlRows.push('<td class="key-info-data-column">'
					+ '<div class="hang key-info-hover key-info-hover"><span class="key-info-label">Guardians: </span>'
					+ '<span class="key-info-clickable" id="' + guardiansClickId + '" data-qtip="' + titleGuardians + '" >'
					+ GUARDIANS
					+ '</span></div></td>');
			}
         
         retVal.htmlRows.push('<tr>'); 
		}
        return retVal;
    };
    /**
     * Parent function for construction of the UI
     * Output of the function will be an object contain a string of the total html to be render for this component
     *   All necessary presentation formation and transformation are done in this function.
     *
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @param aDtoUI {object} aDtoData object
     * @returns {object} retVal is a CC specifically defined DTO for transferring data to presentation rendering processing
     */
    keyinfo.ccnsp.processUI   = function (aObjNSbase, aObjCcBase,aDtoUI) {
		var objData = aObjCcBase.eApps.getDataDto(aObjCcBase);	
        var retVal = [];
 		retVal.push('<div class="key-info">');
		retVal.push( 
			'<div class="eAppsHdrToolbar" style="position: absolute;width:40%;margin-left:200px;margin-top:-30px;z-index: 30;background-color:rgba(0,0,0,0);">',
				'<span id="hospital_day_header" data-qtip="' + objData.LOCATION_HISTORY + '" style="color:blue;font-size:14:px; font-weight: 800;text-align: center; display: inline-block;background-color:inherit;cursor:pointer;">Hospital Day #',
					objData.HOSPITAL_DAY,
				'</span>',
			'</div>'
		); 
		retVal.push('<table style="width:100%;border-collapse:collapse;" border="0">');
		retVal.push('<colgroup><col class="key-info-col-1"/><col class="key-info-col-2"/> </colgroup> ');
		
        objData.htmlRows.forEach(
            function (row,index) {
				retVal.push(row);
            }
        ); 
		
		retVal.push('</table>');
		retVal.push('</div>');
        return retVal.join('');
    };
    /**
     * Parent function for processing functions after the UI has been render to the DOM
     *   All css,dom behaviors to be associated with UI components is handled in this function.
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    keyinfo.ccnsp.processPostCcInstance  = function (aObjNSbase, aObjCcBase) {
		chla.eApps.gFuncs.bindFloatingHover('#' + aObjCcBase.eApps.cc_id + ' [data-qtip]', 'body', '', true, '$(this).data("qtip")', '');
		
		var gFuncs = chlaNsMgr.aliasDirector('chla.eApps.gFuncs');
		var DtoData = aObjCcBase.data.RPTDATA;
		var pID = DtoData.PERSON_ID,
			eID = DtoData.ENCNTR_ID;
		var encType = DtoData.ENCNTR_TYPE;
		var ed = false,
			ip = false,
			amb = false;
		switch(encType) {
			case 'IP': ip = true; break;
			case 'ED': ed = true; break;
			default: amb = true; break;
		}
		
		var theEl,
			theId,
			eventId,
			formType,
			k = 0;		
		
		theId = keyinfo.getDomIdForContactTitle(encType);
		jQuery.support.cors = true;
		$.ajax({
			crossDomain: true,
			url:  chla.eApps.Vars.ServerURL + chla.eApps.Vars.RLWebserviceURL +'/mPageService.svc/getContacts2ByNameFullFormattedJson_GET',
			data: { 'namefullformatted': DtoData.FIRSTCALL },
			context: $('#'+theId),
			dataType: "json",
			success: function (result) {
				var display = '';
				for (var i = 0; i < result.length; i++) {
					var contacts = result[0].contacts;
					for (var j = 0; j < contacts.length; j++) {
						var contact = contacts[j];
						var wrkStr;
						if (contact.contact_type_code == 'PHONE' || contact.contact_type_code == 'PAGER') {
							if (contact.contact_value != null) {
								var contact_num = "";
								wrkStr = contact.contact_value.replace(/[ \-\(\)]/g,'');
								if (wrkStr.length == 10){
									contact_num += wrkStr.substring(0,3) ;
									contact_num += "-";
									contact_num += wrkStr.substring(3,6);
									contact_num += "-";
									contact_num += wrkStr.substring(6,10);

								} else {
									contact_num = wrkStr;
								};
								var contact_desc = contact.contact_type_desc;
								if (contact_desc!=null)
									wrkStr = contact_desc;
								contact_desc = wrkStr.substring(0,1).toUpperCase(); 
								contact_desc += (wrkStr.substring(1)).toLowerCase();
								contact_desc += ": ";
								display += (display ? '<br/>' : '') + ' ' + contact_desc + contact_num;
							}
						}
					}
				}
				if(!display) {
					display = 'No contact info available';
				}
				$('#' + this.prop('id')).attr('data-qtip', display);
			},
			error: function (xhr) {
				alert("An error occured: " + xhr.status + " " + xhr.statusText);
				chla.eAppsUtil.Logger.LogError("An error occured: " + xhr.status + " " + xhr.statusText);
			}
		});
	
		for (k = 0; k < DtoData.ATTEND.length; k++) {
			theId = keyinfo.getDomIdForAttendingTitle(encType, k);
			$.ajax({
				crossDomain: true,
				url:  chla.eApps.Vars.ServerURL + chla.eApps.Vars.RLWebserviceURL +'/mPageService.svc/getContacts2ByNameFullFormattedJson_GET',
				data: { 'namefullformatted': DtoData.ATTEND[k].NAME_FULL_FORMATTED },
				context: $('#'+theId),
				dataType: "json",
				success: function (result) {
					var display = '';
					for (var i = 0; i < result.length; i++) {
						var contacts = result[0].contacts;
						for (var j = 0; j < contacts.length; j++) {
							var contact = contacts[j];
							var wrkStr;
							if (contact.contact_type_code == 'PHONE' || contact.contact_type_code == 'PAGER') {
								if (contact.contact_value != null) {
									var contact_num = "";
									wrkStr = contact.contact_value.replace(/[ \-\(\)]/g,'');
									if (wrkStr.length == 10){
										contact_num += wrkStr.substring(0,3) ;
										contact_num += "-";
										contact_num += wrkStr.substring(3,6);
										contact_num += "-";
										contact_num += wrkStr.substring(6,10);

									} else {
										contact_num = wrkStr;
									};
									var contact_desc = contact.contact_type_desc;
									if (contact_desc!=null)
										wrkStr = contact_desc;
									contact_desc = wrkStr.substring(0,1).toUpperCase(); 
									contact_desc += (wrkStr.substring(1)).toLowerCase();
									contact_desc += ": ";
									display += (display ? '<br/>' : '') + ' ' + contact_desc + contact_num;
								}
							}
						}
					}
					if(!display) {
						display = 'No contact info available';
					}
					$('#' + this.prop('id')).attr('data-qtip', display);
				},
				error: function (xhr) {
					alert("An error occured: " + xhr.status + " " + xhr.statusText);
					chla.eAppsUtil.Logger.LogError("An error occured: " + xhr.status + " " + xhr.statusText);
				}
			});	
		}
	
		theId = keyinfo.getDomIdForCareTeamTitle(encType);
		/* $.ajax({
			crossDomain: true,
			url:  chla.eApps.Vars.ServerURL + chla.eApps.Vars.RLWebserviceURL +'/mPageService.svc/getContacts2ByNameFullFormattedJson_GET',
			data: { 'namefullformatted': DtoData.CARETEAM },
			context: $('#'+theId),
			dataType: "json",
			success: function (result) {
				//chla.eAppsUtil.Logger.LogError(JSON.stringify(result));
				var display = '';
				for (var i = 0; i < result.length; i++) {
					var contacts = result[0].contacts;
					for (var j = 0; j < contacts.length; j++) {
						var contact = contacts[j];
						var wrkStr;
						if (contact.contact_type_code == 'PHONE') {
							if (contact.contact_value != null) {
								var contact_num = "";
								wrkStr = contact.contact_value.replace(/[ \-\(\)]/g,'');
								if (wrkStr.length == 10){
									contact_num += wrkStr.substring(0,3) ;
									contact_num += "-";
									contact_num += wrkStr.substring(3,6);
									contact_num += "-";
									contact_num += wrkStr.substring(6,10);

								} else {
									contact_num = wrkStr;
								};
								var contact_desc = contact.contact_type_desc;
								if (contact_desc!=null)
									wrkStr = contact_desc;
								contact_desc = wrkStr.substring(0,1).toUpperCase(); 
								contact_desc += (wrkStr.substring(1)).toLowerCase();
								contact_desc += ": ";
								display += (display ? '<br/>' : '') + contact_desc + contact_num;
							}
						}
					}
				}
				$('#' + this.prop('id')).unbind("hover");
				chla.eApps.gFuncs.bindFloatingHover('#' + this.prop('id'), 'body', display, false, '');
			},
			error: function (xhr) {
				alert("An error occured: " + xhr.status + " " + xhr.statusText);
				chla.eAppsUtil.Logger.LogError("An error occured: " + xhr.status + " " + xhr.statusText);
			}
		});	 */
		
		theId = keyinfo.getDomIdWeight(encType);
		$("#" + theId).on("click", function(e) {
			gFuncs.AppLinkMpUtil(pID, eID, 'Growth Chart', '');
		});
		
		theId = keyinfo.getDomIdHeight(encType);
		$("#" + theId).on("click", function(e) {
			gFuncs.AppLinkMpUtil(pID, eID, 'Growth Chart', '');
		});
		
		theId = keyinfo.getDomIdBMI(encType);
		$("#" + theId).on("click", function(e) {
			gFuncs.AppLinkMpUtil(pID, eID, 'Growth Chart', '');
		});
		
		theId = keyinfo.getDomIdForAllergies(encType);
		$("#" + theId).on("click", function(e) {
			gFuncs.AppLinkMpUtil(pID, eID, 'Allergies', '');
		});
		
		theId = keyinfo.getDomIdForCswPathways(encType);
		$("#" + theId).on("click", function(e) {
			gFuncs.AppLinkMpUtil(pID, eID, 'Orders', '');
		});
		
		theId = keyinfo.getDomIdMAPIcon(encType);
		$("#" + theId).on("click", function(e) {
			gFuncs.AppLinkMpUtil(pID, eID, 'Orders', '');
		});
		
		theId = keyinfo.getDomIdForMpews(encType);
		$("#" + theId).on("click", DtoData, function(e) {
			if(e.data.INFO[0].MPEWS[0] && e.data.INFO[0].MPEWS[0].SCORE_HISTORY) {
				var MPEWSHistArray = e.data.INFO[0].MPEWS[0].SCORE_HISTORY;
				var winHeight = 250,
					winWidth = 450;
				var innerHTML = '<div id="MPEWS_CHARTGOESHERE">No data received. Please check the source data or contact support.</div>';
				
				chla.eApps.gFuncs.createFloatingPopupWindow('keyinfo-pews-highchart-popup', 'PEWS Score History', innerHTML); 

				chla.eApps.gFuncs.bindDragAndDrop('keyinfo-pews-highchart-popup');
					
				keyinfo.createPEWSChart(MPEWSHistArray, winHeight, winWidth);
				
				/* try{
					if (popupWindowHandle == null || popupWindowHandle.closed) {
						CCLNEWSESSIONWINDOW('',"_blank","height=960,width=1510",1,0);
						popupWindowHandle.focus();
						popupWindowHandle.document.open();
						popupWindowHandle.document.write('<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=10" ><title>HighChart Popup Standalone Window</title>');
						popupWindowHandle.document.write('<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>');
						popupWindowHandle.document.write('<script src="' + chla.eApps.gVars.baseResources + 'FrameWorks/eAppsResources/highcharts/3.0.7/js/highcharts.js" type="text/javascript"></script>');
						popupWindowHandle.document.write('</head><body><div id="CCmPageContainer_A" style="padding-left: 20px; display: table-cell; width: 1860px;"><div class="section " id="DivSection"><h2 class="sec-hd h2a-marker"><span title="icon toggle open" class="sec-hd-tgl h2b-marker"></span><span class="opts-menu menu-hide" id="mainCompMenu">&nbsp;</span><span class="sec-title " style="margin-right: 0px;"><span>PEWS Score History</span><span class="sec-total" style="padding-left: 3px; margin-top: 5px;">&nbsp;</span></span></h2><div class="sec-content" id="DivSecContent"><div class="content-body" id="SecR1C1"><div id="MPEWS_CHARTGOESHERE">No data received. Please check the source data or contact support.</div></div></div></div></div></body>');
						popupWindowHandle.document.write('<script>$(function() { try {var MPEWSHistArray = ');
						popupWindowHandle.document.write(tempStr);
						//popupWindowHandle.document.write('[{	"SCORE": "10",	"DATE": "07\/20\/2018 10:00"}, {	"SCORE": "10",	"DATE": "07\/20\/2018 08:00"}, {	"SCORE": "7",	"DATE": "07\/20\/2018 05:00"}, {	"SCORE": "7",	"DATE": "07\/20\/2018 02:00"}, {	"SCORE": "5",	"DATE": "07\/19\/2018 23:00"}, {	"SCORE": "4",	"DATE": "07\/19\/2018 21:00"}, {	"SCORE": "3",	"DATE": "07\/19\/2018 19:00"}, {	"SCORE": "1",	"DATE": "07\/19\/2018 17:00"}, {	"SCORE": "0",	"DATE": "07\/19\/2018 15:00"}, {	"SCORE": "10",	"DATE": "07\/18\/2018 14:00"}, {	"SCORE": "6",	"DATE": "07\/18\/2018 10:00"}, {	"SCORE": "5",	"DATE": "07\/18\/2018 06:00"}, {	"SCORE": "4",	"DATE": "07\/18\/2018 02:00"}, {	"SCORE": "1",	"DATE": "07\/17\/2018 22:00"}, {	"SCORE": "3",	"DATE": "07\/17\/2018 18:00"}, {	"SCORE": "4",	"DATE": "07\/17\/2018 14:00"}, {	"SCORE": "1",	"DATE": "07\/12\/2018 06:00"}]');
						popupWindowHandle.document.write('; var graphData = new Array(MPEWSHistArray.length); var seriesName = "PEWS  History";var winTitle = "PEWS History";var winHeight = 250,	winWidth = 450;var j = 0,	i = 0;for (j = MPEWSHistArray.length - 1; j >= 0 ; j--) {	var resultDate = Date.parse(MPEWSHistArray[j]["DATE"]); 	var result = parseFloat(MPEWSHistArray[j]["SCORE"]); 	var resultColor = function() {var returnVal = "#000"; if (result < 3) {	returnVal = "#03A207";} else if (result < 6) {	returnVal = "#F2FA1B";} else if (result < 8) {	returnVal = "#F99C00";} else {	returnVal = "#CC0005";}return returnVal;	}();	var resultSymbol = function() {');
						popupWindowHandle.document.write('var directory = "' + chla.eApps.gVars.baseResources + 'eAppsResources/images/img/mpews/"; var returnVal = "url(" + directory + "green_dot.gif)"; if (result < 3) {	returnVal = "url(" + directory + "green_dot.gif)";} else if (result < 4) {	returnVal = "url(" + directory + "yellow_dot.gif)";} else if (result < 5) {	returnVal = "url(" + directory + "orange_dot.gif)";} else {	returnVal = "url(" + directory + "red_dot.gif)";} return returnVal;	}();	graphData[i] = {"x" : resultDate,"marker" : {	symbol : resultSymbol},"y" : result	};	i++;}var chartSeries1 = {	"type" : "line",	"yAxis" : 0,	"data" : graphData,	"name" : seriesName}; var marginRight = 15;	var mpewsMean = 0;var mpewsNewest = parseInt(MPEWSHistArray[0].SCORE, 10); var mpewsSD = 0.6; mpewsSD = (mpewsSD*3);var mpewsCalc = 0;for (i=2; i<7; i++){	if (i < MPEWSHistArray.length){	mpewsMean = mpewsMean + parseInt(MPEWSHistArray[i].SCORE, 10);mpewsCalc++ ;	}}if (mpewsCalc >= 3) {	mpewsMean =(mpewsMean/mpewsCalc)+mpewsSD;	mpewsMean = Math.round(mpewsMean * 10)/10;}else {	mpewsMean = 0;}var chart = new Highcharts.Chart({	chart : {renderTo : "MPEWS_CHARTGOESHERE",borderWidth : 1,spacingTop : 20,spacingLeft : 5,marginRight : marginRight,alignTicks : false,marginBottom : 50,height : winHeight,width : winWidth,resetZoomButton: {	theme: {stroke: "silver",r: 3,style : {	fontSize : "9px"}	},	position: {align: "right",verticalAlign: "top",x: -(9 + marginRight),y: 0	},	relativeTo: "chart"}	},	credits : {enabled : false	},	title : {text : "",y : 16	},	legend : "",	plotOptions : {line : {	marker : {fillColor : null,lineColor : null,lineWidth : null,radius : 4,states : {	hover : {enabled : false	}}	}}	},	tooltip : {formatter : function() {	var toolTipHtml = "<b>PEWS Score:</b>"+ this.y+ "<br/>"+ "<b>Date time: </b>"+ Highcharts.dateFormat("%m/%d/%y %H:%M", this.x);	return toolTipHtml;}	},	xAxis : [{maxPadding : 0.03,minPadding : 0.03,labels : {	formatter : function() {return Highcharts.dateFormat("%m/%d/%y", this.value)	+ "<br/> "	+ Highcharts.dateFormat("%H:%M", this.value);	}}	}],	yAxis : [{min : -1,max : 11.05,tickInterval : 2,startOnTick : false,endOnTick : false,plotBands: [{	from: 0.0,		to: mpewsMean,	color: "#CCC"}],labels : {	align : "right"},title : {	text : "PEWS"}	}],	series : [chartSeries1]});	} 	catch(ex) {}	});');
						popupWindowHandle.document.write('</script></html>');
						popupWindowHandle.document.close(); 
					} else {
						popupWindowHandle.focus();
					}
				} catch (ex) { alert(ex) } */ 
			}
		});
		
		theId = keyinfo.getDomIdIso(encType);
		$("#" + theId).on("click", function(e) {
			var url = "https://sharepoint.chla.usc.edu/Docs/_layouts/15/WopiFrame2.aspx?sourcedoc=/Docs/Infection%20Control/IC%20-%20301%20Isolation%20Precautions.pdf&action=default&DefaultItemOpen=1";
			APPLINK(100,url,"");
		});
		
		theId = keyinfo.getDomIdRes(encType);
		$("#" + theId).on("click", function(e) {
			var url = "https://sharepoint.chla.usc.edu/Docs/_layouts/15/WopiFrame2.aspx?sourcedoc=/Docs/Infection%20Control/IC%20-%20825%20%20Multidrug%20Resistant%20Organisms%20(MDRO)%20Preventing%20Transmission%20(MRSA%20VRE%20ESBL%20GNB).pdf&action=default&DefaultItemOpen=1";
			APPLINK(100,url,"");
		});
	
		theId = keyinfo.getDomIdForDischarge(encType);
		$("#" + theId).on("click", function(e) {
			gFuncs.AppLinkMpUtil(pID, eID, 'Orders', '');
		});
		
		if (DtoData.INFO[0].CARE_PLANS.length > 0) {
			var carePlanArray = DtoData.INFO[0].CARE_PLANS;
			for (k = 0; k < carePlanArray.length; k++) {
				if (carePlanArray[k].EVENT_ID && carePlanArray[k].EVENT_ID.length > 0) {
					theId = keyinfo.getDomIdFromPowerForm('carePlanEvent', parseInt(carePlanArray[k].EVENT_ID), encType);
					$("#" + theId).on("click", { param: carePlanArray[k].EVENT_ID }, function(e) {
						MPAGES_EVENT("CLINICALNOTE", pID + "|" + eID + "|[" + e.data.param + "]|" + "" + "|7||||");
					});
				} else if (carePlanArray[k].FORM_ID && carePlanArray[k].FORM_ID.length > 0) {
					theId = keyinfo.getDomIdFromPowerForm('carePlanForm', parseInt(carePlanArray[k].FORM_ID), encType);
					$("#" + theId).on("click", { param: carePlanArray[k].FORM_ID }, function(e) {
						MPAGES_EVENT("POWERFORM", pID + "|" + eID + "|" + '0' + "|" + e.data.param + "|1");
					});
				}
			}
		}
		
		theId = keyinfo.getDomIdForCodeStatus(encType);
		$("#" + theId).on("click", function(e) {
			if(DtoData.ADVANCECAREPLANNOTE_EVENTID) {
				MPAGES_EVENT("CLINICALNOTE", pID + "|" + eID + "|[" + DtoData.ADVANCECAREPLANNOTE_EVENTID + "]|" + "" + "|7||||");
				//MPAGES_EVENT("POWERNOTE", pID + "|" + eID + "||3012322832")
			}
		});
		
		theId = keyinfo.getDomIdGuardian(encType);
		$("#" + theId).on("click", function(e) {
			gFuncs.AppLinkMpUtil(pID, eID, 'Pt Info', '');
		});
		
		/* $("#testpopupwindow").on("click", DtoData, function(e) {
			if(e.data.INFO[0].MPEWS[0] && e.data.INFO[0].MPEWS[0].SCORE_HISTORY) {
				var MPEWSHistArray = e.data.INFO[0].MPEWS[0].SCORE_HISTORY;
				var tempStr = JSON.stringify(MPEWSHistArray);
				var tempStr2 = encodeURI(tempStr); 
				var url = "http://10.101.136.222/CustomComponents/CC_KI_MPew.html" + "?data=" + tempStr2;
				CCLNEWSESSIONWINDOW(url,"_blank","height=333,width=510",1,0);
			}
		});	 */	
	};
    /**
     *  Call to build CC and to render to CC framework
     */
    keyinfo.ccnsp.ProcessCtl(keyinfo.ccnsp,component);
}
chla['procinfo'].prototype.render = function() {
    'use strict';
    var  component = this,
        /**
         * variable to contain working object for cc rendering
         */
        procinfo;
    /**
     *  initialize the variable with the CC Module base class
     */
    procinfo  = chla.eAppsClass.gCcModule.createCcModuleCls.neo();
    /*----------------------------------------------------*/
    /* Replace these functions with this CC specific code.*/
    /*----------------------------------------------------*/
    /**
     * Parent function for processing initialization specifically for the CC
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    procinfo.ccnsp.postInit  = function (aObjNSbase, aObjCcBase) {};
    /**
     * Parent function for processing the JSON data received for display
     * Output of this function will be an object tha contains data items to be used in the presentation construction process.
     *  All data validation and transformations are done in this function
     *
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @param aDtoData {object} Dto object specifically defined by RPTDATA response from CCL request
     * @returns {*} {object} retVal is a CC specifically defined DTO for transferring data to presentation processing
     */
    procinfo.ccnsp.processData = function (aObjNSbase, aObjCcBase,aDtoData) {
        var retVal = {},
			FormData,
			Cases = {};
		//chla.eAppsUtil.Logger.LogError(JSON.stringify(aObjCcBase.data));
		if(aObjCcBase.data && aObjCcBase.data.PROCEDURE_RECORD && aObjCcBase.data.PROCEDURE_RECORD.FORMDATA) {			
			FormData = aObjCcBase.data.PROCEDURE_RECORD.FORMDATA;
			if(FormData.length == 0) {
				return false;
			}
			FormData.forEach(
				function (result) {
					if(typeof Cases[result.SURG_CASE_NBR_FORMATTED] === "undefined") {
						Cases[result.SURG_CASE_NBR_FORMATTED] = {};
						Cases[result.SURG_CASE_NBR_FORMATTED].ANESTHESIA_START_DT_TM = result.ANESTHESIA_START_DT_TM;
						Cases[result.SURG_CASE_NBR_FORMATTED].ANESTHESIA_STOP_DT_TM = result.ANESTHESIA_STOP_DT_TM;
						Cases[result.SURG_CASE_NBR_FORMATTED].SURGERY_START_DT_TM = result.SURGERY_START_DT_TM;
						Cases[result.SURG_CASE_NBR_FORMATTED].SURGERY_STOP_DT_TM = result.SURGERY_STOP_DT_TM;
						Cases[result.SURG_CASE_NBR_FORMATTED].SCHED_SURGERY_START_DT_TM = result.SCHED_SURGERY_START_DT_TM;
					}
					if(result.SURG_PROCEDURES && result.SURG_PROCEDURES.length > 0) {
						result.SURG_PROCEDURES.forEach(
							function (item) {
								if(typeof Cases[result.SURG_CASE_NBR_FORMATTED].Procedures === "undefined") {
									Cases[result.SURG_CASE_NBR_FORMATTED].Procedures = [];
								}
								if(item.PRIMARY_IND.match(/yes/i)) {
									Cases[result.SURG_CASE_NBR_FORMATTED].Procedures.push({ primary: 1, proc: item.SURG_PROCEDURE, surg: item.PROC_PRIM_SURGEON });
									//Cases[result.SURG_CASE_NBR_FORMATTED].Procedures.push({ "Primary Surgeon": item.PROC_PRIM_SURGEON });
								} else {
									Cases[result.SURG_CASE_NBR_FORMATTED].Procedures.push({ primary: 0, proc: item.SURG_PROCEDURE, surg: item.PROC_PRIM_SURGEON });
									//Cases[result.SURG_CASE_NBR_FORMATTED].Procedures.push({ "Secondary Procedure": item.SURG_PROCEDURE });
									//Cases[result.SURG_CASE_NBR_FORMATTED].Procedures.push({ "Secondary Surgeon": item.PROC_PRIM_SURGEON });
								}
							}
						);
					}
				}
			);
			retVal.Cases = Cases;
			
		} else {
			return false;
		} 
        return retVal;
    };

    /**
     * Parent function for construction of the UI
     * Output of the function will be an object contain a string of the total html to be render for this component
     *   All necessary presentation formation and transformation are done in this function.
     *
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @param aDtoUI {object} aDtoData object
     * @returns {object} retVal is a CC specifically defined DTO for transferring data to presentation rendering processing
     */
    procinfo.ccnsp.processUI   = function (aObjNSbase, aObjCcBase,aDtoUI) {
		var first = true;
		var baseID = 'ProcInfo';
		var objData = aObjCcBase.eApps.getDataDto(aObjCcBase);	
		if(!objData) {
			return 'No results found';
		}
        var retVal = [],
			liList = [],
			contentList = [];
 		
		var arrCaseKeys = Object.keys(objData.Cases);
		arrCaseKeys.sort();
		arrCaseKeys.forEach(
			function (surgery) {
				liList.push('<li><a href="#' + baseID + 'tab_' + surgery + '" class="' + (first ? 'active' : '') + '">' + surgery + '</a></li>');
				first = false;
				contentList.push('<div id="' + baseID + 'tab_' + surgery + '" class="chla_tab">');
				contentList.push('<table><tbody>');
				objData.Cases[surgery].Procedures.sort(function(a,b) { return (a.primary < b.primary) ? 1 : ((b.primary < a.primary) ? -1 : 0);} );
				var caseCount = objData.Cases[surgery].Procedures.length;
				for(var x = 0; x < caseCount; x++) {
					var proc = objData.Cases[surgery].Procedures[x];
					if(proc.primary == 1) {
						contentList.push('<tr><td class="procinfolabels">Primary Procedure</td><td>' + proc.proc + '</td></tr>');
						contentList.push('<tr><td class="procinfolabels">Primary Surgeon</td><td>' + proc.surg + '</td></tr>');
					} else {
						contentList.push('<tr><td class="procinfolabels">Secondary Procedure</td><td>' + proc.proc + '</td></tr>');
						if(caseCount - x > 1) {
							if(proc.surg && proc.surg != objData.Cases[surgery].Procedures[x+1].surg) {
								contentList.push('<tr><td class="procinfolabels">Secondary Surgeon</td><td>' + proc.surg + '</td></tr>');
							}
						} else {
							if(proc.surg)
								contentList.push('<tr><td class="procinfolabels">Secondary Surgeon</td><td>' + proc.surg + '</td></tr>');
						}
					}
				}
				
				if(objData.Cases[surgery].ANESTHESIA_START_DT_TM || objData.Cases[surgery].SURGERY_START_DT_TM) {
					if(objData.Cases[surgery].ANESTHESIA_START_DT_TM) {
						contentList.push('<tr><td class="procinfolabels">Anesth Start</td><td>' + objData.Cases[surgery].ANESTHESIA_START_DT_TM + '</td></tr>');
					}
					if(objData.Cases[surgery].SURGERY_START_DT_TM) {
						contentList.push('<tr><td class="procinfolabels">Surgery Start</td><td>' + objData.Cases[surgery].SURGERY_START_DT_TM + '</td></tr>');
					}
					if(objData.Cases[surgery].SURGERY_STOP_DT_TM) {
						contentList.push('<tr><td class="procinfolabels">Surgery Stop</td><td>' + objData.Cases[surgery].SURGERY_STOP_DT_TM + '</td></tr>');
					}
					if(objData.Cases[surgery].ANESTHESIA_STOP_DT_TM) {
						contentList.push('<tr><td class="procinfolabels">Anesth Stop</td><td>' + objData.Cases[surgery].ANESTHESIA_STOP_DT_TM + '</td></tr>');
					}
				} else if(objData.Cases[surgery].SCHED_SURGERY_START_DT_TM) {
					contentList.push('<tr><td class="procinfolabels">Scheduled Surg Start</td><td>' + objData.Cases[surgery].SCHED_SURGERY_START_DT_TM + '</td></tr>');
				}
				
				contentList.push('</tbody></table>');
				
				contentList.push('</div>');
			}
		);  
		
 		retVal.push('<div class="chla_tab_container"><ul>');
		retVal.push(liList.join(''));
		retVal.push('</ul>');		
		retVal.push(contentList.join(''));
        retVal.push('</div>');
		return retVal.join('');
    };
    /**
     * Parent function for processing functions after the UI has been render to the DOM
     *   All css,dom behaviors to be associated with UI components is handled in this function.
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    procinfo.ccnsp.processPostCcInstance  = function (aObjNSbase, aObjCcBase) {
		var objData = aObjCcBase.eApps.getDataDto(aObjCcBase);	
		if(objData) {
			chla.eApps.gFuncs.makeHorizontalTabs('#' + aObjCcBase.eApps.cc_id);
		}
	};

    /**
     *  Call to build CC and to render to CC framework
     */
    procinfo.ccnsp.ProcessCtl(procinfo.ccnsp,component);

}
chla['PostOpProcinfo'].prototype.render = function() {
    'use strict';
    var  component = this,
        /**
         * variable to contain working object for cc rendering
         */
        procinfoPO;
    /**
     *  initialize the variable with the CC Module base class
     */
    procinfoPO  = chla.eAppsClass.gCcModule.createCcModuleCls.neo();
    /*----------------------------------------------------*/
    /* Replace these functions with this CC specific code.*/
    /*----------------------------------------------------*/
    /**
     * Parent function for processing initialization specifically for the CC
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    procinfoPO.ccnsp.postInit  = function (aObjNSbase, aObjCcBase) {};
    /**
     * Parent function for processing the JSON data received for display
     * Output of this function will be an object tha contains data items to be used in the presentation construction process.
     *  All data validation and transformations are done in this function
     *
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @param aDtoData {object} Dto object specifically defined by RPTDATA response from CCL request
     * @returns {*} {object} retVal is a CC specifically defined DTO for transferring data to presentation processing
     */
    procinfoPO.ccnsp.processData = function (aObjNSbase, aObjCcBase,aDtoData) {
        var retVal = {},
			FormData,
			Cases = {};
		//chla.eAppsUtil.Logger.LogError(JSON.stringify(aObjCcBase.data));
		if(aObjCcBase.data && aObjCcBase.data.PROCEDURE_RECORD && aObjCcBase.data.PROCEDURE_RECORD.FORMDATA) {			
			FormData = aObjCcBase.data.PROCEDURE_RECORD.FORMDATA;
			if(FormData.length == 0) {
				return false;
			}
			FormData.forEach(
				function (result) {
					if(typeof Cases[result.SURG_CASE_NBR_FORMATTED] === "undefined") {
						Cases[result.SURG_CASE_NBR_FORMATTED] = {};
						Cases[result.SURG_CASE_NBR_FORMATTED].ANESTHESIA_START_DT_TM = result.ANESTHESIA_START_DT_TM;
						Cases[result.SURG_CASE_NBR_FORMATTED].ANESTHESIA_STOP_DT_TM = result.ANESTHESIA_STOP_DT_TM;
						Cases[result.SURG_CASE_NBR_FORMATTED].SURGERY_START_DT_TM = result.SURGERY_START_DT_TM;
						Cases[result.SURG_CASE_NBR_FORMATTED].SURGERY_STOP_DT_TM = result.SURGERY_STOP_DT_TM;
						Cases[result.SURG_CASE_NBR_FORMATTED].SCHED_SURGERY_START_DT_TM = result.SCHED_SURGERY_START_DT_TM;
					}
					if(result.SURG_PROCEDURES && result.SURG_PROCEDURES.length > 0) {
						result.SURG_PROCEDURES.forEach(
							function (item) {
								if(typeof Cases[result.SURG_CASE_NBR_FORMATTED].Procedures === "undefined") {
									Cases[result.SURG_CASE_NBR_FORMATTED].Procedures = [];
								}
								if(item.PRIMARY_IND.match(/yes/i)) {
									Cases[result.SURG_CASE_NBR_FORMATTED].Procedures.push({ primary: 1, proc: item.SURG_PROCEDURE, surg: item.PROC_PRIM_SURGEON });
									//Cases[result.SURG_CASE_NBR_FORMATTED].Procedures.push({ "Primary Surgeon": item.PROC_PRIM_SURGEON });
								} else {
									Cases[result.SURG_CASE_NBR_FORMATTED].Procedures.push({ primary: 0, proc: item.SURG_PROCEDURE, surg: item.PROC_PRIM_SURGEON });
									//Cases[result.SURG_CASE_NBR_FORMATTED].Procedures.push({ "Secondary Procedure": item.SURG_PROCEDURE });
									//Cases[result.SURG_CASE_NBR_FORMATTED].Procedures.push({ "Secondary Surgeon": item.PROC_PRIM_SURGEON });
								}
							}
						);
					}
				}
			);
			retVal.Cases = Cases;
			
		} else {
			return false;
		} 
        return retVal;
    };

    /**
     * Parent function for construction of the UI
     * Output of the function will be an object contain a string of the total html to be render for this component
     *   All necessary presentation formation and transformation are done in this function.
     *
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @param aDtoUI {object} aDtoData object
     * @returns {object} retVal is a CC specifically defined DTO for transferring data to presentation rendering processing
     */
    procinfoPO.ccnsp.processUI   = function (aObjNSbase, aObjCcBase,aDtoUI) {
		var first = true,
			baseID = 'procinfoPO';
		var objData = aObjCcBase.eApps.getDataDto(aObjCcBase);	
		if(!objData) {
			return 'No results found';
		}
        var retVal = [],
			liList = [],
			contentList = [];
 		
		var arrCaseKeys = Object.keys(objData.Cases);
		arrCaseKeys.sort();
		arrCaseKeys.forEach(
			function (surgery) {
				liList.push('<li><a href="#' + baseID + 'tab_' + surgery + '" class="' + (first ? 'active' : '') + '">' + surgery + '</a></li>');
				first = false;
				contentList.push('<div id="' + baseID + 'tab_' + surgery + '" class="chla_tab">');
				contentList.push('<table><tbody>');
				objData.Cases[surgery].Procedures.sort(function(a,b) { return (a.primary < b.primary) ? 1 : ((b.primary < a.primary) ? -1 : 0);} );
				var caseCount = objData.Cases[surgery].Procedures.length;
				for(var x = 0; x < caseCount; x++) {
					var proc = objData.Cases[surgery].Procedures[x];
					if(proc.primary == 1) {
						contentList.push('<tr><td class="procinfolabels">Primary Procedure</td><td>' + proc.proc + '</td></tr>');
						contentList.push('<tr><td class="procinfolabels">Primary Surgeon</td><td>' + proc.surg + '</td></tr>');
					} else {
						contentList.push('<tr><td class="procinfolabels">Secondary Procedure</td><td>' + proc.proc + '</td></tr>');
						if(caseCount - x > 1) {
							if(proc.surg && proc.surg != objData.Cases[surgery].Procedures[x+1].surg) {
								contentList.push('<tr><td class="procinfolabels">Secondary Surgeon</td><td>' + proc.surg + '</td></tr>');
							}
						} else {
							if(proc.surg)
								contentList.push('<tr><td class="procinfolabels">Secondary Surgeon</td><td>' + proc.surg + '</td></tr>');
						}
					}
				}
				
				if(objData.Cases[surgery].ANESTHESIA_START_DT_TM || objData.Cases[surgery].SURGERY_START_DT_TM) {
					if(objData.Cases[surgery].ANESTHESIA_START_DT_TM) {
						contentList.push('<tr><td class="procinfolabels">Anesth Start</td><td>' + objData.Cases[surgery].ANESTHESIA_START_DT_TM + '</td></tr>');
					}
					if(objData.Cases[surgery].SURGERY_START_DT_TM) {
						contentList.push('<tr><td class="procinfolabels">Surgery Start</td><td>' + objData.Cases[surgery].SURGERY_START_DT_TM + '</td></tr>');
					}
					if(objData.Cases[surgery].SURGERY_STOP_DT_TM) {
						contentList.push('<tr><td class="procinfolabels">Surgery Stop</td><td>' + objData.Cases[surgery].SURGERY_STOP_DT_TM + '</td></tr>');
					}
					if(objData.Cases[surgery].ANESTHESIA_STOP_DT_TM) {
						contentList.push('<tr><td class="procinfolabels">Anesth Stop</td><td>' + objData.Cases[surgery].ANESTHESIA_STOP_DT_TM + '</td></tr>');
					}
				} else if(objData.Cases[surgery].SCHED_SURGERY_START_DT_TM) {
					contentList.push('<tr><td class="procinfolabels">Scheduled Surg Start</td><td>' + objData.Cases[surgery].SCHED_SURGERY_START_DT_TM + '</td></tr>');
				}
				
				contentList.push('</tbody></table>');
				
				contentList.push('</div>');
			}
		);  
		
 		retVal.push('<div class="chla_tab_container"><ul>');
		retVal.push(liList.join(''));
		retVal.push('</ul>');		
		retVal.push(contentList.join(''));
        retVal.push('</div>');
		return retVal.join('');
    };
    /**
     * Parent function for processing functions after the UI has been render to the DOM
     *   All css,dom behaviors to be associated with UI components is handled in this function.
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    procinfoPO.ccnsp.processPostCcInstance  = function (aObjNSbase, aObjCcBase) {
		var objData = aObjCcBase.eApps.getDataDto(aObjCcBase);	
		if(objData) {
			chla.eApps.gFuncs.makeHorizontalTabs('#' + aObjCcBase.eApps.cc_id);
		}
	};

    /**
     *  Call to build CC and to render to CC framework
     */
    procinfoPO.ccnsp.ProcessCtl(procinfoPO.ccnsp,component);

}
chla['AnesthResults'].prototype.render = function() {
    'use strict';
    var  component = this,
        /**
         * variable to contain working object for cc rendering
         */
        AnesthResults;
    /**
     *  initialize the variable with the CC Module base class
     */
    AnesthResults  = chla.eAppsClass.gCcModule.createCcModuleCls.neo();
    /*----------------------------------------------------*/
    /* Replace these functions with this CC specific code.*/
    /*----------------------------------------------------*/
    /**
     * Parent function for processing initialization specifically for the CC
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    AnesthResults.ccnsp.postInit  = function (aObjNSbase, aObjCcBase) {
		AnesthResults.LabResultsChartFactory = function (chartConfig) {
			var chartData = chartConfig.chartData;
			var uom = chartConfig.uom;
			var refLow = chartConfig.refLow;
			var refHigh = chartConfig.refHigh;
			var critLow = chartConfig.critLow;
			var critHigh = chartConfig.critHigh;
			var container = chartConfig.container;
			var theHeight = chartConfig.height;
			var theWidth = chartConfig.width;
			var ESTIMATED_GFR = 'estimated gfr';

			var hiLoResult = function(resultArray, refLow, refHigh, chartName) {
				var i, dataHi, dataLo;
				// seed the values
				dataHi = resultArray[0].y;
				dataLo = resultArray[0].y;

				if (resultArray.length > 0) {
					for (i = 0; i < resultArray.length; i++) {
						if (resultArray[i].y > dataHi) {
							dataHi = resultArray[i].y;
						}
						if (resultArray[i].y < dataLo) {
							dataLo = resultArray[i].y;
						}
					}
					if (chartName.toLowerCase().indexOf(ESTIMATED_GFR) >= 0) {
						dataHi = Math.max(dataHi, refLow, 120);
						dataLo = Math.min(dataLo, refLow, 60);
					} else if (!isNaN(refHigh) && !isNaN(refLow)) {
						dataHi = Math.max(dataHi, refHigh, refLow);
						dataLo = Math.min(dataLo, refHigh, refLow);
					} else if (isNaN(refHigh) && !isNaN(refLow)) {
						dataHi = Math.max(dataHi, refLow);
						dataLo = Math.min(dataLo, refLow);
					} else if (isNaN(refHigh) && !isNaN(refLow)) {
						dataHi = Math.max(dataHi, refHigh);
						dataLo = Math.min(dataLo, refHigh);
					}
				}
				return {
					'hi' : dataHi,
					'lo' : dataLo
				};
			};

			var hilo = hiLoResult(chartData["data"], refLow, refHigh, chartData.name);
			var tickInterval = null;

			var yDiff = hilo.hi * 0.09;
			var yMax = hilo.hi + yDiff; // add 5% to largest y val
			var yMin = hilo.lo - yDiff; // subtract 5% from smalles y val

			var yAxisTickInterval = theHeight * 0.2;
			
			// special case for Estimated GFR
			if (chartData.name.toLowerCase().indexOf('estimated gfr') >= 0) {
				tickInterval = 30;
				yAxisTickInterval = null;
				critLow = 60.0;
				refHigh = Math.max(hilo.hi, 120.0);
				refLow = 80.0;
			}

			var critHi, critLo;
			
			//only show critical vals if within range
			if (!isNaN(critHigh)) {
				if (critHigh <= yMax) {
					critHi = critHigh;
				}
			}

			if (!isNaN(critLow)) {
				if (critLow >= yMin) {
					critLo = critLow;
				}

			}
			
			var plotLineArray = function() {
				var lineArray = [];
				if (!isNaN(critHi)) {
					lineArray.push({ // Critical Hi
						color : '#FF0000', // red� �
						label : {
							text : 'Cr Hi',
							align : 'right',
							y : -2,
							x : -5
						},
						zIndex : 3,
						width : 1,
						value : critHi
					});
				}
				if (!isNaN(critLo)) {
					lineArray.push({ // Critical Lo� � � �
						color : '#FF0000', // red� � � � �
						label : {
							text : 'Cr Lo',
							align : 'right',
							y : 12,
							x : -5
						},
						zIndex : 3,
						width : 1,
						value : critLo
					});
				}
				if (!isNaN(refLow) && isNaN(refHigh)) {
					lineArray.push({
								color : '#00f',
								label : {
									text : 'Nl Lo',
									align : 'left'
									// ,
									// y : 12,
									// x : -5
								},
								zIndex : 5,
								width : 2,
								value : refLow
							});
				}
				if (isNaN(refLow) && !isNaN(refHigh)) {
					lineArray.push({
								color : '#00f',
								label : {
									text : 'Nl Hi',
									align : 'left'
									// ,
									// y : 12,
									// x : -5
								},
								zIndex : 5,
								width : 2,
								value : refHigh
							});
				}

				return lineArray;
			}();

			var imgLocation = chla.global.imgPath;
			var mask = '{0}img/{1}';
			var marginRight = 30;
			
			try {	
				var chart = new Highcharts.Chart({
					credits : {
						enabled : false
					},
					global : {
						useUTC : false
					},
					legend : {
						enabled : false
					},
					title : {
						text : ''
					},
					chart : {
						type : 'spline',
						zoomType : 'x',
						renderTo : container,
						width : theWidth,
						height : theHeight,
						marginLeft : 80,
						marginRight : marginRight,
						marginTop : 10,
						marginBottom : 50,
						// Highcharts 2.2.1 stuff
						resetZoomButton: {
							theme: {
								stroke: 'silver',
								r: 3,
								style : {
									fontSize : '9px'
								}
							},
							position: {
								align: 'right',
								verticalAlign: 'top',
								x: -(9 + marginRight),
								y: 0
							},
							relativeTo: 'chart'
						}
					},
					plotOptions : {
						series : {
							color : '#666666',
							marker : {
								lineColor : null,
								states : {
									hover : {
										fillColor : 'white',
										lineColor : 'black',
										lineWidth : 3
									}
								}
							}
						}
					},
					tooltip : {
						crosshairs : true,
						backgroundColor : "rgba(255,255,255,.90)",
						// snap:30,
						formatter : function() {
							var result = this.point.actualResult; // this.y
							var dateObj = new Date(this.x);
							var fullYear = dateObj.getFullYear();
							// Y2K fix
							// alert(fullYear);
							if (fullYear >= 100 && fullYear <= 1999) {
								fullYear += 100;
							}
							var theDate = (dateObj.getMonth() + 1) + '/' + dateObj.getDay() + '/' + fullYear;
							// alert( theDate);
							// var returnVal = Highcharts.dateFormat("<i>%m/%d/%Y",
							// this.x)
							var returnVal = '<i>' + theDate + '  '
								+ Highcharts.dateFormat("%H:%M", this.x)
								+ '</i><br />' + this.series.name + ': <b>'
								+ result + '</b>';
							return returnVal;
						}
					},
					xAxis : {
						type : 'datetime',
						maxZoom : 6 * 3600 * 1000, // 6hrs
						dateTimeLabelFormats : {
							hour : '%H:%M',
							day : '%m/%d',
							year : '%Y'
						},
						minPadding : 0.02,
						maxPadding : 0.02
					},
					yAxis : [{
						title : {
							text : uom,
							margin : 20
						},
						startOnTick : false,
						endOnTick : false,
						max : yMax,// +5%
						min : yMin,
						tickInterval : tickInterval,
						tickPixelInterval : yAxisTickInterval,
						plotLines : plotLineArray,
						// don't create plotbands if both refLow and refHigh
						// are not defined
						plotBands : function() {
							if (!isNaN(refLow) && !isNaN(refHigh)) {
								return [{
									color : '#ccccff',
									zindex : 4,
									from : refLow,
									to : refHigh
								}];
							}
						}()

					}],
					labels : {
						items : [{
							html : (function() {
								if (!isNaN(refLow) && !isNaN(refHigh)) {
									return 'Reference range: ' + refLow + '-'
											+ refHigh + ' ' + uom;
								} else {
									return '';
								}
							})(),
							style : {
								left : '10px',
								top : '120px'
							}
						}]
					},
					series : [chartData]
				});
			}
			catch(err) {
				alert('PTSUM-CHART_FAIL_LAB|' + err);
			}
		};
	
		AnesthResults.showNotifyLabGraph = function(record, index) {
			var labName = record.data.LAB_NAME;
			var labItemEventCode = record.data.EVENT_CD;
			var labHistoryData = AnesthResults.labHistoryMap[labItemEventCode];
			var refLow = labHistoryData.refLo;
			var refHigh = labHistoryData.refHi;
			var critLow = labHistoryData.criticalLo;
			var critHigh = labHistoryData.criticalHi;
			var uom = labHistoryData.uom;
			var theWidth = config.panelWidth;
			var retVal = [],
				row = [];

			var graphData = labHistoryData.labItemGraphData;
			var expandId = record.data.EXPAND_UNIQUE_ID;
			var container = expandId;
			var onbaseUrl = record.data.LAB_ONBASE_URL;
			if (onbaseUrl !== undefined && onbaseUrl.length > 0) {
				var url = onbaseUrl;
				AnesthResults.applink(100, url, null, null, null, null, null, "height=500,width=800,resizable=yes");
			} else if (labHistoryData.numericIndicator !== 'NUM') {
				// this displays a grid of history when the data not graphable				
				retVal.push('<div style="width:' + theWidth + 'px;height:100px;overflow-y:auto;" id="NOTIFY_GRID_PANEL_' + expandId + '"><table style="table-layout:fixed;">'+
					'<thead><tr><th style="width:50%;">Date'+
					'</th><th style="width:50%;">Result'+
					'</th></tr></thead><tbody>');
				
				row.push('<tr class="<#=ODD#>">'+
					//dateRenderer('m/d/y H:i')
					'<td><#=LAB_COLLECT_DT_TM#></td>'+
					'<td><#=LAB_RESULT_ACTUAL#></td>'+
					'</tr>'
				);
				if(labHistoryData.rawData.HISTORY.length > 0) {
					labHistoryData.rawData.HISTORY.forEach(
						function (value,index) {
							value.ODD = (index % 2 === 0? 'odd':'');
							retVal.push(aObjNSbase.gFuncs.parseTemplate(row.join(''), value));
						}
					);
				} else {
					retVal.push('No Lab History');
				}
				retVal.push('</tbody></table></div>');
				
				if($('#NOTIFY_GRID_PANEL_' + expandId)) {
					//panel exists, destroy it first
					$('#NOTIFY_GRID_PANEL_' + expandId).remove();
				}
				$('#' + expandId).append(retVal.join(''));
			} else {
				var chartData = {
					'data' : graphData,
					'name' : labName
				};
				AnesthResults.LabResultsChartFactory({
					chartData : chartData,
					uom : uom,
					refLow : refLow,
					refHigh : refHigh,
					critLow : critLow,
					critHigh : critHigh,
					container : container,
					height : 150,
					width : 400
				});
			}
		};

		AnesthResults._LabHistoryMap = function(notifyData) {
			var i, j;
			var labHistoryArray = notifyData.INPT_RESULTS.LAB_HISTORY;
			var LabHistoryItem = function() {
				// lab name
				this.labName = '';
				// trend for this lab item
				this.labItemTrend = '';
				// series to be plotted in chart if this is plottable
				this.labItemGraphData = [];
				// critical hi
				this.criticalHi = '';
				// critical lo
				this.criticalLo = '';
				// ref hi
				this.refHi = '';
				// ref lo
				this.refLo = '';
				// uom
				this.uom = '';
				// num indicator
				this.numericIndicator = '';
				// save raw data in case we want to use it later
				this.rawData = null;

			};
			var theMap = {};
			var labHistoryArrLen = labHistoryArray.length;
			for (i = labHistoryArrLen - 1; i >= 0; i--) {
				var labHistoryItemEventCode = labHistoryArray[i].EVENT_CD;
				var labName = labHistoryArray[i].LAB_NAME;

				var numeric_indicator = labHistoryArray[i].NUMERIC_IND;
				var lab_crit_hi = labHistoryArray[i].LAB_CRIT_HI.replace(/<|>/, '');
				var lab_crit_lo = labHistoryArray[i].LAB_CRIT_LO.replace(/<|>/, '');

				// var critHi = '', critLo = '';
				// if (lab_crit_hi.length > 0) {
				var critHi = parseFloat(lab_crit_hi);
				// }
				// if (lab_crit_lo.length > 0) {
				var critLo = parseFloat(lab_crit_lo);
				// }

				var refHi = '', refLo = '';

				refHi = parseFloat(labHistoryArray[i].LAB_RANGE_HI);
				refLo = parseFloat(labHistoryArray[i].LAB_RANGE_LO);
				var uom = labHistoryArray[i].UNIT_OF_MEASURE;
				var resultArray = labHistoryArray[i].HISTORY;
				// series
				var resultArrayLen = resultArray.length;
				var graphData = [];

				for (j = resultArrayLen - 1; j >= 0; j--) {
					var resultDate = Date.parse(resultArray[j]["LAB_COLLECT_DT_TM"]);
					var result = parseFloat(resultArray[j]["LAB_RESULT"]);
					var actualResult = resultArray[j]["LAB_RESULT_ACTUAL"];
					var theColor = resultArray[j]["NORMALCY_COLOR"];
					var markerImage = function() {
						var mask = 'url({0}img/{1})';
						var directory = chla.global.imgPath;
						var returnVal;
						if (isNaN(actualResult)) {
							if (actualResult.search('&lt;') != -1) {
								returnVal = returnVal = chla.eApps.gFuncs.sFormatter(mask, directory, 'under.gif');
							} else if (actualResult.search('&gt;') != -1) {
								returnVal = chla.eApps.gFuncs.sFormatter(mask, directory, 'over.gif');
							}
						}
						return returnVal;
					}();
					graphData[j] = {
						x : resultDate,
						y : result,
						marker : {
							symbol : markerImage
						},
						actualResult : actualResult,
						color : theColor
					};
				}
				// trend - look at 2 most recent values to determine trend
				var graphDataLength = resultArray.length;
				var imgLocation = chla.global.imgPath;
				// default to level
				var trendString = chla.eApps.gFuncs.sFormatter('<img style="vertical-align:middle" src="{0}img/gray_arrow_r.gif">', imgLocation);
				if (graphDataLength > 1) {
					if (graphData[graphDataLength - 1].y < graphData[graphDataLength - 2].y) {
						trendString = chla.eApps.gFuncs.sFormatter('<img style="vertical-align:middle" src="{0}img/gray_arrow_d.gif">', imgLocation);
					} else if (graphData[graphDataLength - 1].y > graphData[graphDataLength - 2].y) {
						trendString = chla.eApps.gFuncs.sFormatter('<img style="vertical-align:middle" src="{0}img/gray_arrow_u.gif">', imgLocation);
					}
				}
				var labHistoryItemObj = new LabHistoryItem();
				labHistoryItemObj.labName = labName;
				labHistoryItemObj.labItemTrend = trendString;
				labHistoryItemObj.labItemGraphData = graphData;
				labHistoryItemObj.rawData = labHistoryArray[i];
				labHistoryItemObj.criticalHi = critHi;
				labHistoryItemObj.criticalLo = critLo;
				labHistoryItemObj.refHi = refHi;
				labHistoryItemObj.refLo = refLo;
				labHistoryItemObj.uom = uom;
				labHistoryItemObj.numericIndicator = numeric_indicator;
				theMap[labHistoryItemEventCode] = labHistoryItemObj;
			}
			return theMap;
		};

		AnesthResults.applink = function(linkmode, launchObject, personId, encounterId, tabType, tabName, addMode, windowParms) {
		/**********************************************************************************************************************
			linkmode 		0 	Used for starting a solution by executable name
							1  	Used for starting a solution by the application object, such as DiscernAnalytics.Application
							100 Used for launching a file, link, or executable through a shell execute.  Use this to open a 
								URL or link if you have Citrix configured for server-to-client redirection.
						
			launchObject 	 if in a link DO NOT USE $APP_AppName$ - instead pass ""
							A textual string representing the executable name, application object, file, or link to start 
							based on the linkmode value.  Context variables, when supported by the solution, can be substituted 
							into the APPLINK launchobject. Using the context variable $APP_AppName$ in place of the executable 
							name is useful if you want to open a patient chart into the current solution
							
			personId 		personId or $PAT_PersonID$ - if in a link DO NOT USE $PAT_PersinID$ - instead pass 0
			encounterId		encounterId or $VIS_EncntrID$ - if in a link DO NOT USE $VIS_EncntrID$ - instead pass 0
			tabType			FIRSTTAB or ORGANIZERTAB
			tabName			organizer or chart level tab to navigate to
			addMode			'+' if this chart level tab should launch in quick add dialog mode, otherwise '' (Empty string)
		************************************************************************************************************************/
			var argString = '';
			var finalTabName = '';
			
			switch(linkmode) {
				case 0:
					if(tabType === 'FIRSTTAB') {
						finalTabName = tabName;//Child.WebServices.checkForNewChartLevelTabName(tabName);
						
						var formatString = '/PERSONID={0} /ENCNTRID={1} /{2}=^{3}{4}^';
						
						if(personId === 0) {
							personId = '$PAT_PersonID$';
						}
						
						if(encounterId === 0) {
							encounterId = '$VIS_EncntrID$';
						}
						
						if(launchObject === '') {
							launchObject = '$APP_AppName$';
						}
						
						if(addMode !== '+' && addMode !== '') {
							addMode = '';
						}
						
						argString = chla.eApps.gFuncs.sFormatter(formatString,
							personId,
							encounterId,
							tabType,
							finalTabName,
							addMode
						);

						APPLINK(linkmode, launchObject, argString);
						
					} else if(tabType === 'ORGANIZERTAB') {
						finalTabName = tabName;//Child.WebServices.checkForNewOrganizerLevelTabName(tabName);
						
						var formatString = '/{0}=^{1}^';
						
						argString =  chla.eApps.gFuncs.sFormatter(formatString, tabType, finalTabName);
						APPLINK(linkmode, launchObject, argString);
					}				
					break;					
				case 1:
					// do we use this anywhere?
					alert('APPLINK called with linkmode=1');
					break;					
				case 100:
					// web link 
					if(typeof(APPLINK) === 'undefined') {
						window.open(launchObject, '_blank', windowParms);
					} else {
						var url = launchObject;
						if(launchObject.toLowerCase().indexOf("http") === -1) {
							var slash = window.location.href.lastIndexOf('/');
							url = window.location.href.substring(0, slash);
							url = url + '/' + launchObject;
						}
						if(windowParms) {
							APPLINK(linkmode, url, windowParms);
						} else {
							APPLINK(linkmode, url, "");
						}
					}
					break;				
				default:
					break;
			}	
		};

        AnesthResults.collapseSections  = function(sectionIdentifier) {
			$('#' + sectionIdentifier + '_Header').click(
				function () {
					$(this).toggleClass('closed');
					$('#' + sectionIdentifier + '_SecContent').toggleClass('closed');
				}
			)
		};
            
        AnesthResults.displayClinicalNote = function(eventID, remappedData) {
			var sendstr = remappedData.PersonID + "|" + remappedData.EncounterID + "|[" + eventID + "]|" + "" + "|7||||";
			MPAGES_EVENT("CLINICALNOTE", sendstr);
		};
           
		AnesthResults.createResultTable = function(parsedEventID) {
			var dataTbl = '<table class="lab-results-hover-table">\
			<tr>\
				<th>Name</th>\
				<th>Result</th>\
				<th>Trend</th>\
				<th>Collect D/T</th>\
			</tr>';
			for (var i = 0; i < parsedEventID.LAB_INFO.length; i++) {
				 dataTbl += '<tr class="lab-history-record" data-event_cd="' + parsedEventID.LAB_INFO[i].EVENT_CD + '" data-lab_onbase_url="' + parsedEventID.LAB_INFO[i].LAB_ONBASE_URL + '" data-lab_name="' + parsedEventID.LAB_INFO[i].LAB_NAME + '" style="cursor:pointer;">';
				 dataTbl += '<td>' + parsedEventID.LAB_INFO[i].LAB_NAME + '</td>';
				 dataTbl += '<td style="color:'+ parsedEventID.LAB_INFO[i].NORMALCY_COLOR+'">' + parsedEventID.LAB_INFO[i].RESULT_VALUE + ' ' + parsedEventID.LAB_INFO[i].UNIT_OF_MEASURE + '</td>';
				 dataTbl += '<td>' + AnesthResults.labHistoryMap[parsedEventID.LAB_INFO[i].EVENT_CD].labItemTrend + '</td>';
				 dataTbl += '<td>' + parsedEventID.LAB_INFO[i].LAB_COLLECT_DT_TM + '</td>';
				 dataTbl += '</tr>';
			}
			dataTbl += '</table>';
			return dataTbl;
		};
		   
        AnesthResults.setLabTooltip = function  (parsedEventID, subType) {            
			var config = {
				record: parsedEventID
			}
			var record = parsedEventID;
			var labDetail;
		
			if (subType === 'cbcdiff' || subType === 'cbc') {
				labDetail = AnesthResults.Child.CBCFishBonePanelFactory.getFishBoneDetailTooltip({
					record: record
				});
				if(parsedEventID.LAB_INFO.length > 0) {
					var dataTbl = AnesthResults.createResultTable(parsedEventID);
					return { fishbone: labDetail, datatable: dataTbl };
				}
				return { fishbone: labDetail };		
			} else if (subType === 'chem') {				
				labDetail = AnesthResults.Child.ChemFishBonePanelFactory.getFishBoneDetailTooltip({
					record: record
				});
				if(parsedEventID.LAB_INFO.length > 0) {
					var dataTbl = AnesthResults.createResultTable(parsedEventID);
					return { fishbone: labDetail, datatable: dataTbl };
				}
				return { fishbone: labDetail };
			} else if (subType === 'coag') {
				labDetail = AnesthResults.Child.CoagFishBonePanelFactory.getFishBoneDetailTooltip({
					record: record
				});
				if(parsedEventID.LAB_INFO.length > 0) {
					var dataTbl = AnesthResults.createResultTable(parsedEventID);
					return { fishbone: labDetail, datatable: dataTbl };
				}
				return { fishbone: labDetail };		
			} else if (subType === 'discrete') {
				var data = config.record.LAB_INFO[0];
				var labName = data.LAB_NAME;
				var labCollectDt = data.LAB_COLLECT_DT_TM;
				var labHistoryData = AnesthResults.labHistoryMap;//AnesthResults.Child.NotificationsPanelFactory.ResultsPanel.BuildLabHistoryMap(data);
				// AnesthResults.Child.Framework.LabHistoryMap[data.EVENT_CD];
				var labResultVal = data.RESULT_VALUE;
				var displayResultVal = function () {
					var htmlcolor = "";
					if (data.NORMALCY_IND === '') {
						return labResultVal + " " + data.UNIT_OF_MEASURE;
					} else {
						if (data.NORMALCY_COLOR.substr(0, 1) === '#') {
							htmlcolor = data.NORMALCY_COLOR;
						} else {
							switch (data.NORMALCY_COLOR) {
								case 'pink':
									htmlcolor = "#FF00FF";
									break;
								case 'red':
									htmlcolor = "#FF0000";
									break;
								default:
									break;
							}
						}
						return '<SPAN STYLE="color: ' + htmlcolor + ';">' + labResultVal + ' ' + data.UNIT_OF_MEASURE + ' ' + data.NORMALCY_IND + '</SPAN>';
					}
				}();
		
				var trendString = function () {
					var trendString = '?';
					if (labHistoryData) {
						trendString = AnesthResults.labHistoryMap[parsedEventID.LAB_INFO[0].EVENT_CD].labItemTrend;//labHistoryData.labItemTrend;
					}
					return trendString;
				}();
				
				var props = 'class="lab-history-record" data-event_cd="' + data.EVENT_CD + '" data-lab_onbase_url="' + data.LAB_ONBASE_URL + 
						'" data-lab_name="' + data.LAB_NAME + '" style="cursor:pointer;"';
				var labHtml = function () {
					var mask =
						'<table width="400px" class="lab-results-hover-table">' +
						'<tr><th>Lab Name</th><th>Collect Date</th><th>Trend</th><th>Result</th></tr>' +
						'<tr {4}><td>{0}</td><td >{1}</td>' +
						'<td>{2}</td>' +
						'<td>{3}</td></tr></table>';
		
					var retstr = chla.eApps.gFuncs.sFormatter(mask, labName, labCollectDt, trendString, displayResultVal, props);
					return retstr;
				}();		
				return { datatable: labHtml };		
			} else {
				var dataTbl = AnesthResults.createResultTable(parsedEventID);
				return { tooltip: 'Click to see Lab Detail', datatable: dataTbl };		
			}		
		};
            
        AnesthResults.showData = function (subDataType, eventID, remappedData) {
			switch (subDataType) {
				case 'doc':
					AnesthResults.displayClinicalNote(eventID, remappedData);
					break;		
				case 'rad':
					AnesthResults.displayClinicalNote(eventID, remappedData);
					break;		
				case 'ap':
					AnesthResults.displayClinicalNote(eventID, remappedData);
					break;		
				case 'micro':
					AnesthResults.displayClinicalNote(eventID, remappedData);
					break;
				default:
					break;
			}
		};	
	
		AnesthResults.Child={};
		AnesthResults.Child.CoagFishBonePanelFactory=function(a,b){};
		AnesthResults.Child.CoagFishBonePanelFactory.getCoagFishBoneHtml=function(c){var b=c.labDetail;var i=c.labResultName;var f=c.parentEventId;var e="";var j=c.id;var l=[];for(var n=0;n<5;n++){l.push("")}var h=chla.global.imgPath;var d='<div id="'+j+'">';d+="<div class='ttheader'>"+e+"</div>";d+=chla.eApps.gFuncs.sFormatter('<div class="coag-fishbone-display" style="background-image:url({0}img/coag_fishbone.gif);">',h);d+="<div style='position:relative;'>";for(var g=0;g<b.length;g++){var m=b[g].NORMALCY_COLOR;var k=b[g].LAB_NAME;var o=b[g].RESULT_VALUE;switch(k){case"Prothrombin Time":l[0]=AnesthResults.Child.CoagFishBonePanelFactory.formatLabResultValue({label:AnesthResults.Child.CoagFishBonePanelFactory.CoagIdMap[k],parentEventId:f,color:m,result:o,top:25,left:127,width:50,align:"center"});break;case"APTT":l[1]=AnesthResults.Child.CoagFishBonePanelFactory.formatLabResultValue({label:AnesthResults.Child.CoagFishBonePanelFactory.CoagIdMap[k],parentEventId:f,color:m,result:o,top:57,left:127,width:50,align:"center"});break;case"International Normalized Ratio":l[2]=AnesthResults.Child.CoagFishBonePanelFactory.formatLabResultValue({label:AnesthResults.Child.CoagFishBonePanelFactory.CoagIdMap[k],parentEventId:f,color:m,result:o,top:40,left:175,width:40,align:"right"});l[3]=AnesthResults.Child.CoagFishBonePanelFactory.formatLabResultValue({label:AnesthResults.Child.CoagFishBonePanelFactory.CoagIdMap[k],parentEventId:f,color:m,result:o,top:35,left:236,width:50,align:"right"});break;case"D-Dimer":l[4]=AnesthResults.Child.CoagFishBonePanelFactory.formatLabResultValue({label:AnesthResults.Child.CoagFishBonePanelFactory.CoagIdMap[k],parentEventId:f,color:m,result:o,top:49,left:236,width:50,align:"right"});break;default:break}}d+=l[0];d+=l[1];d+=l[2];d+=l[3];d+=l[4];d+="</div>";d+="</div>";d+="</div>";return d};
		AnesthResults.Child.CoagFishBonePanelFactory.formatLabResultValue=function(b){var h=b.label;var e=b.parentEventId;var d=b.color;var i=b.result;var g=b.top;var c=b.left;var a=b.width;var f=b.align;return chla.eApps.gFuncs.sFormatter('<span id="{0}_{1}" class="values" style="position:absolute;top:{2}px;left:{3}px;width:{4}px;text-align:{5};color:{6}";>{7}</span>',h,e,g,c,a,f,d,i)};AnesthResults.Child.CoagFishBonePanelFactory.CoagIdMap={"Prothrombin Time":"pt",APTT:"aptt","International Normalized Ratio":"inr",Fibrinogen:"fib","D-Dimer":"ddim"};
		AnesthResults.Child.CoagFishBonePanelFactory.getFishBoneDetailTooltip=function(c){var b;var a=c.record.PARENT_EVENT_ID;var d=AnesthResults.Child.CoagFishBonePanelFactory.getCoagFishBoneHtml({id:"coagFishbone"+c.record.PARENT_EVENT_ID,labDetail:c.record.LAB_INFO,labResultName:c.record.RESULT_NAME,parentEventId:c.record.PARENT_EVENT_ID});return d};
		AnesthResults.Child.CoagFishBonePanelFactory.getFishBoneAndHistory=function(c,g,f){var e;var d=c.PARENT_EVENT_ID;if(g==="coag"){var h=AnesthResults.Child.CoagFishBonePanelFactory.getCoagFishBoneHtml({id:"coagFishbone"+d,labDetail:c.LAB_INFO,labResultName:c.RESULT_NAME,parentEventId:d});var a=new Ext.Panel({html:h,border:false,layout:"fit",height:100});var b=AnesthResults.Child.NotificationsPanelFactory.getLabHistDetailGrid({labResultData:c,subType:g,panelWidth:f});b.anchor="100%";b.autoScroll=false;b.setTitle("")}return e};
		AnesthResults.Child.ChemFishBonePanelFactory=function(a,b){};
		AnesthResults.Child.ChemFishBonePanelFactory.getChemFishBoneHtml=function(c){var b=c.labDetail;var i=c.labResultName;var f=c.parentEventId;var e="";var j=c.id;var l=[];for(var n=0;n<8;n++){l.push("")}var h=chla.global.imgPath;var d='<div id="'+j+'">';d+="<div class='ttheader'>"+e+"</div>";d+=chla.eApps.gFuncs.sFormatter('<div class="chem-fishbone-display" style="background-image:url({0}img/chem_fishbone_mini.gif);">',h);d+="<div style='position:relative;'>";for(var g=0;g<b.length;g++){var m=b[g].NORMALCY_COLOR;var k=b[g].LAB_NAME;var o=b[g].RESULT_VALUE;switch(k){case"Sodium":l[0]=AnesthResults.Child.ChemFishBonePanelFactory.formatLabResultValue({label:AnesthResults.Child.ChemFishBonePanelFactory.ChemIdMap[k],parentEventId:f,color:m,result:o,top:30,left:107,width:50,align:"right"});break;case"Potassium":l[1]=AnesthResults.Child.ChemFishBonePanelFactory.formatLabResultValue({label:AnesthResults.Child.ChemFishBonePanelFactory.ChemIdMap[k],parentEventId:f,color:m,result:o,top:65,left:107,width:50,align:"right"});break;case"Chloride":l[2]=AnesthResults.Child.ChemFishBonePanelFactory.formatLabResultValue({label:AnesthResults.Child.ChemFishBonePanelFactory.ChemIdMap[k],parentEventId:f,color:m,result:o,top:30,left:165,width:35,align:"center"});break;case"CO2 Total":l[3]=AnesthResults.Child.ChemFishBonePanelFactory.formatLabResultValue({label:AnesthResults.Child.ChemFishBonePanelFactory.ChemIdMap[k],parentEventId:f,color:m,result:o,top:65,left:165,width:35,align:"center"});break;case"Creatinine":l[4]=AnesthResults.Child.ChemFishBonePanelFactory.formatLabResultValue({label:AnesthResults.Child.ChemFishBonePanelFactory.ChemIdMap[k],parentEventId:f,color:m,result:o,top:65,left:205,width:35,align:"center"});break;case"BUN":l[5]=AnesthResults.Child.ChemFishBonePanelFactory.formatLabResultValue({label:AnesthResults.Child.ChemFishBonePanelFactory.ChemIdMap[k],parentEventId:f,color:m,result:o,top:30,left:205,width:35,align:"center"});break;case"Glucose Lvl":l[6]=AnesthResults.Child.ChemFishBonePanelFactory.formatLabResultValue({label:AnesthResults.Child.ChemFishBonePanelFactory.ChemIdMap[k],parentEventId:f,color:m,result:o,top:50,left:242,width:35,align:"center"});break;case"Anion Gap":l[6]=AnesthResults.Child.ChemFishBonePanelFactory.formatLabResultValue({label:AnesthResults.Child.ChemFishBonePanelFactory.ChemIdMap[k],parentEventId:f,color:m,result:o,top:100,left:165,width:35,align:"center"});break;default:break}}d+=l[0];d+=l[1];d+=l[2];d+=l[3];d+=l[4];d+=l[5];d+=l[6];d+="</div>";d+="</div>";d+="</div>";return d};
		AnesthResults.Child.ChemFishBonePanelFactory.formatLabResultValue=function(b){var h=b.label;var e=b.parentEventId;var d=b.color;var i=b.result;var g=b.top;var c=b.left;var a=b.width;var f=b.align;return chla.eApps.gFuncs.sFormatter('<span id="{0}_{1}" class="values" style="position:absolute;top:{2}px;left:{3}px;width:{4}px;text-align:{5};color:{6}";>{7}</span>',h,e,g,c,a,f,d,i)};AnesthResults.Child.ChemFishBonePanelFactory.ChemIdMap={"Sodium Level":"na","Potassium Level":"k","Chloride Level":"cl","Carbon Dioxide, Total":"co2",BUN:"bun",Creatinine:"cr","Glucose Level":"glu"};
		AnesthResults.Child.ChemFishBonePanelFactory.getFishBoneDetailTooltip=function(a){var b=AnesthResults.Child.ChemFishBonePanelFactory.getChemFishBoneHtml({id:"chemFishbone"+a.record.PARENT_EVENT_ID,labDetail:a.record.LAB_INFO,labResultName:a.record.RESULT_NAME,parentEventId:a.record.PARENT_EVENT_ID});return b};
		AnesthResults.Child.ChemFishBonePanelFactory.getFishBoneAndHistory=function(b,h,g){var d;var c=b.PARENT_EVENT_ID;if(h==="chem"){var f=AnesthResults.Child.ChemFishBonePanelFactory.getChemFishBoneHtml({id:"chemFishbone"+c,labDetail:b.LAB_INFO,labResultName:b.RESULT_NAME,parentEventId:c});var e=new Ext.Panel({html:f,border:false,layout:"fit",height:125});var a=AnesthResults.Child.NotificationsPanelFactory.getLabHistDetailGrid({labResultData:b,subType:h,panelWidth:g});a.anchor="100%";a.autoScroll=false;a.setTitle("");d=new Ext.Panel({title:b.RESULT_NAME+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+a.firstCollectDate,layout:{type:"vbox",pack:"start",align:"stretch"},items:[{height:125,items:[e]},{layout:"fit",flex:1,border:false,items:[a]}]})}return d};
		AnesthResults.Child.NotificationsPanelFactory=function(){};
		AnesthResults.Child.NotificationsPanelFactory.ishapedRender=function(f,c){if(f){var c=f.layoutParams[0].containerID;var e=f.layoutParams[0].panelID;var d=f.encounterType;AnesthResults.Child.Framework.rnssPatient.ishapedRnssResults=f.data;if(f.status=="fail"){return}}var b=Ext.getCmp(c);var a=AnesthResults.Child.NotificationsPanelFactory.ResultsPanel(e,f.data,c,d);b.removeAll();b.insert(0,a);f=null;AnesthResults.Child.AssessmentLinksPanelFactory.assessmentLinksRender({params:{containerID:AnesthResults.Child.GlobalDomIds.RNSS_LINKS_PANEL_ID,panelID:AnesthResults.Child.GlobalDomIds.RNSS_LINKS_PANEL_ID+"_child",panelPos:0,encounterType:"ISHAPED_RNSS",status:"true"}})};
		var notifyRender=function(f){if(f){var c=f.layoutParams[0].containerID;var e=f.layoutParams[0].panelID;var d=f.encounterType;if(d==="IP"){AnesthResults.Child.Framework.inPatient.notifications=f.data}else{if(d==="CICU"){AnesthResults.Child.Framework.cicu.notifications=f.data}else{if(d==="ISHAPED_RNSS"){AnesthResults.Child.Framework.rnssPatient.ishapedRnssResults=f.data}}}if(f.status=="fail"){return}}var b=Ext.getCmp(c);var a=AnesthResults.Child.NotificationsPanelFactory.ResultsPanel(e,f.data,c,d);b.removeAll();b.insert(0,a);if(d!=="ISHAPED_RNSS"){if(typeof workflowOverview==="undefined"){c=f.layoutParams[1].containerID;e=f.layoutParams[1].panelID;b=Ext.getCmp(c);var g=AnesthResults.Child.NotificationsPanelFactory.EventsPanel(e,f.data,d);b.removeAll();b.insert(0,g);f=null}}};
		AnesthResults.Child.NotificationsPanelFactory.EventsPanel=function(f,l,h){if(h==="CICU"){if(l.INPT_RESULTS.PICU_SAFETY_CHECKLIST_MISSING===1){var b=AnesthResults.Child.GlobalDomIds.CICU_NOTIFICATIONS_ID+"_saftey_icon_id";var a=Ext.get(b);if(a){a.removeAllListeners();a.on("click",function(p){var o=this.encounterId;var m=this.patientId;var r=this.formId;var n=0;var q=0;if(window.external.DiscernObjectFactory!==undefined){mpObj=window.external.DiscernObjectFactory("POWERFORM");mpObj.OpenForm(m,o,r,n,q)}else{alert("Open PICU Safety Checklist PowerForm:\npatientId : "+m+"\nencounterId : "+o+"\nactivityId : "+n+"\nformId : "+r)}p.stopEvent()},{encounterId:l.INPT_RESULTS.ENCNTR_ID,patientId:l.INPT_RESULTS.PERSON_ID,formId:l.INPT_RESULTS.PICU_SAFETY_CHECKLIST_FORM_REF_ID});a.toggle()}}}var g=function(o,q,n){var m="cursor-pointer";var p=Ext.create("Ext.Img",{src:AnesthResults.Child.Framework.WEB_ASSET_FILE_LOCATION+"img/checklist.png",autoEl:"div",renderTo:q,id:o,cls:m,style:{verticalAlign:"text-top"},listeners:{afterrender:function(r,s){iconId=o;if(Ext.fly(iconId)){Ext.fly(iconId).on("click",function(){alert("open form")})}}}});return p};Ext.define("inptResultsNotifyRecord",{extend:"Ext.data.Model",fields:[{name:"NOTIFICATION_TYPE"},{name:"PVDR_NOTIFIED"},{name:"PVDR_NOTIFY_METHOD"},{name:"EVENT_ID"},{name:"NOTIFICATION_COLOR"},{name:"PERFORMED_BY"},{name:"NOTIFICATION_TEXT"},{name:"PVDR_RESPONSE"},{name:"PROG_NOTE_TEXT"},{name:"NOTIFICATION_DT_TM",type:"date",dateFormat:"m/d/y H:i"}]});var e=new Ext.data.Store({model:"inptResultsNotifyRecord",proxy:{type:"memory",reader:{type:"json",root:""}},sorters:[{property:"NOTIFICATION_DT_TM",direction:"DESC"}],data:l.INPT_RESULTS.NOTIFICATIONS});var k=function(m,o,r){var p=m.view.panel;var q=o.data.EVENT_ID;if(q.length>0){var n=AnesthResults.Child.NotificationsPanelFactory.notifyData.INPT_RESULTS.PERSON_ID;sendstr=n+"|"+AnesthResults.Child.Framework.JSON_Info.PT_SUMMARY_INFO.ENCNTR_ID+"|["+q+"]||7||||";MPAGES_EVENT("CLINICALNOTE",sendstr)}};var c=function(o,u,r,x,p,w){var y=o;var t=o;var s="";var v="hang";var q=r.data.NOTIFICATION_COLOR;if(q==="pink"){q="#ff0099"}var n=r.data.PERFORMED_BY;var m=r.data.EVENT_ID;if(m.length>0){v="hang-clickable";if(r.data.NOTIFICATION_TYPE==="Emergency Department Pre-Arrival Info"){t=r.data.NOTIFICATION_TEXT;s+=chla.eApps.gFuncs.sFormatter("<div>{0}</div>","<b>"+r.data.NOTIFICATION_TEXT+"<br>Performed by: "+r.data.PERFORMED_BY+"<br>"+Ext.util.Format.dateRenderer("m/d/y H:i")(r.data.NOTIFICATION_DT_TM)+"</b><br>Click to see document")}else{if(r.data.NOTIFICATION_TYPE==="RISK"){t=r.data.NOTIFICATION_TEXT;s+=chla.eApps.gFuncs.sFormatter("<div>{0}</div>","<b>"+r.data.NOTIFICATION_TEXT+"<br>Performed by: "+r.data.PERFORMED_BY+"<br>"+Ext.util.Format.dateRenderer("m/d/y H:i")(r.data.NOTIFICATION_DT_TM)+"</b><br>Click to see document")}else{t=r.data.NOTIFICATION_TEXT;if(r.data.PROG_NOTE_TEXT.length>0){s+=chla.eApps.gFuncs.sFormatter("<div>{0}</div>",r.data.PROG_NOTE_TEXT+"<br><b>Click to see progress note</b>")}else{s="<b>Click to see progress note</b>"}}}}else{if(r.data.NOTIFICATION_TYPE==="Whats Next"){t=r.data.NOTIFICATION_TEXT;s="<b>ED What's Next: </b><br>"+r.data.NOTIFICATION_TEXT}else{s+=chla.eApps.gFuncs.sFormatter("<div><b>{0}</b></div>",r.data.NOTIFICATION_TYPE);if(r.data.NOTIFICATION_TYPE.toLowerCase()==="provider notified"){s+=chla.eApps.gFuncs.sFormatter("<span><b>{0}&nbsp;</b></span> ",r.data.PVDR_NOTIFIED);if(r.data.PVDR_NOTIFY_METHOD.length>0){s+=chla.eApps.gFuncs.sFormatter("<span>({0}</span>)",r.data.PVDR_NOTIFY_METHOD)}if(r.data.PVDR_RESPONSE.length>0){s+=chla.eApps.gFuncs.sFormatter("<div><b>Response:</b>&nbsp;{0}</div> ",r.data.PVDR_RESPONSE)}}s+=chla.eApps.gFuncs.sFormatter("<div><b>Performed by:</b>&nbsp;{0}</div>",n);if(r.data.NOTIFICATION_TYPE.toLowerCase()==="nursing progress note"){if(r.data.PROG_NOTE_TEXT.length>0){s+=chla.eApps.gFuncs.sFormatter("<div>{0}</div>",r.data.PROG_NOTE_TEXT)}}}}y=Ext.String.format('<div class="{3}" data-qtip="{2}" style="color:{0};">{1}</div>',q,t,s,v);return y};var i=e.data.length===0?75:110;var j=function(r,o,n,s,q,p){var m="";if(n.data.NOTIFICATION_TYPE!=="Whats Next"){m=Ext.util.Format.date(r,"m/d/y H:i")}return m};var d=new Ext.grid.GridPanel({id:f,border:false,layout:"fit",store:e,autoScroll:true,hideHeaders:true,viewConfig:{forceFit:true,trackOver:false,deferEmptyText:false,emptyText:"There are no notifications"},columns:{items:[{header:"",dataIndex:"NOTIFICATION_DT_TM",flex:0.3,renderer:j},{header:"",flex:0.7,renderer:c,dataIndex:"NOTIFICATION_TEXT"}]},listeners:{select:function(m,n,o){k(m,n,o)}}});AnesthResults.Child.Framework.debugLog("render Notification Timeline complete","info");return d};
		AnesthResults.Child.NotificationsPanelFactory.showLabDetail=function(h,l,k,i){var b=420;var j=null;var m=null;var c=new Ext.Panel({});if(l==="cbcdiff"||l==="cbc"){c=AnesthResults.Child.CBCFishBonePanelFactory.getFishBoneAndHistory(h,l,b);m=c.title;c.title=""}else{if(l==="chem"){c=AnesthResults.Child.ChemFishBonePanelFactory.getFishBoneAndHistory(h,l,b);m=c.title;c.title=""}else{if(l==="coag"){c=AnesthResults.Child.CoagFishBonePanelFactory.getFishBoneAndHistory(h,l,b);m=c.title;c.title=""}else{c=AnesthResults.Child.NotificationsPanelFactory.getLabHistDetailGrid({labResultData:h,subType:l,panelWidth:b})}}}var a;var g=100,d=100;if(i&&i.length>1){g=i[0];d=i[1]}var f=AnesthResults.Child.Framework.getHeightOfWindow()-100;var e=150+(h.LAB_INFO.length*170);if(e>f){e=f}if(!a){a=new Ext.Window({title:m,height:e,width:b,x:g,y:d,closeAction:"destroy",resizable:true,stateful:false,plain:true,autoScroll:true,layout:"fit",modal:false,items:[c]})}a.addListener("boxready",function(p){var n=p.x;var q=p.y;var o=Math.max(q-p.getHeight(),50);p.setPosition(n,o)});a.show()};AnesthResults.Child.NotificationsPanelFactory.notifyData=null;
		AnesthResults.Child.NotificationsPanelFactory.ResultsPanel=function(C,h,n,r,A){AnesthResults.Child.NotificationsPanelFactory.notifyData=h;var x=h.INPT_RESULTS.PERSON_ID;if(AnesthResults.Child.Framework.LabHistoryMap===null){AnesthResults.Child.Framework.LabHistoryMap=AnesthResults.Child.NotificationsPanelFactory.ResultsPanel.BuildLabHistoryMap(h)}var c=AnesthResults.Child.WebServices.RADIOLOGY_URL(h.INPT_RESULTS.MRN);var k=function(){var F="";var G=0;var D=h.INPT_RESULTS.RESULTS.length;for(var E=D-1;E>=0;E--){if(h.INPT_RESULTS.RESULTS[E].RESULT_SUB_TYPE==="rad"){if(h.INPT_RESULTS.RESULTS[E].RAD_INFO.length>0&&h.INPT_RESULTS.RESULTS[E].RAD_INFO[0].URL_PACS){if(c!==""){F=c}else{F=h.INPT_RESULTS.RESULTS[E].RAD_INFO[0].URL_PACS}G++}}}return{count:G,url:F}}();var a=AnesthResults.Child.Framework.WEB_ASSET_FILE_LOCATION+"img/pacs.png";var z=AnesthResults.Child.Framework.WEB_ASSET_FILE_LOCATION+"img/pacs.png";var s="PACS Image";var b=function(D,L){var E=D.getStore().data.items;var J,H;var N=E.length;for(var J=N-1;J>=0;J--){var I=E[J].data.RESULT_TYPE;if(L==="ALL"||I===L){var M=E[J].data.RESULT_SUB_TYPE;var F=D.getView();var G=F.getNode(D.store.getAt(J),true);var K=F.store.getAt(J);AnesthResults.Child.NotificationsPanelFactory.assignTooltipsToResults({rowNum:J,record:K.data,idQualifier:r,theViewRowElement:G,subType:M})}}if(cernerMPage!==true){AnesthResults.Child.mpageTimers.renderedScreens.notifications=true;AnesthResults.Child.RenderManager.fireEvent("rendercompleted",this,"from notifications")}};Ext.define("resultRecord",{extend:"Ext.data.Model",fields:[{name:"RESULT_NAME",type:"string"},{name:"RESULT_DT_TM",type:"date",dateFormat:"m/d/y H:i"},{name:"RESULT_TYPE",convert:function i(E,D){var F=E;if(r==="ISHAPED_RNSS"){if(E==="1lab"&&D.data.RESULT_SUB_TYPE==="micro"){F="4lab"}if(E==="2rad"&&D.data.RESULT_SUB_TYPE==="rad"){F="5lab"}}return F}},{name:"RESULT_SUB_TYPE"},{name:"UPDT_DT_TM"},{name:"PARENT_EVENT_ID"},{name:"ORDER_ID"},{name:"LAB_INFO"},{name:"AP_INFO"},{name:"MICRO_INFO"},{name:"RAD_INFO"},{name:"DOC_INFO"}]});var u=new Ext.data.Store({storeId:"ResultsGroupingStoreId",model:"resultRecord",proxy:{type:"memory",reader:{type:"json",root:""}},data:h.INPT_RESULTS.RESULTS,groupField:"RESULT_TYPE",sorters:{property:"RESULT_DT_TM",direction:"DESC"},remoteGroup:false,groupOnSort:false});var j=new Ext.button.Button({id:C+AnesthResults.Child.GlobalDomIds.NOTIFY_PACS_VIEW_BUTTON_ID,xtype:"button",disabled:function(){var D=false;if(k&&k.count===0){D=true}return D}(),cls:"x-btn-text-icon",icon:z,text:s,handler:function(E,F){if(k.url&&k.url.length>0){var D=k.url;AnesthResults.Child.WebServices.applink(100,D,null,null,null,null,null,"height=500,width=800,resizable=yes")}F.stopPropagation()}});if(cernerMPage===true){var m='<div class="sch-hdrExtra" id="'+C+'componentHdrDiv"><span id="'+C+'_MUSE_BTN" style="float:left; top:3px;padding-right:6px;"></span><span id="'+C+'_PACS_BTN" style="float:left; top:3px;"></span></div>';var w=Ext.get(A);w.createChild(m);j.render(C+"_PACS_BTN");var v='<div class="sch-expandIcon" id="'+C+'componentHdrDiv"><img data-qtip="Click to expand panel<br/>version='+componentVersion+'" id="'+C+'RESULTS_EXPAND_ICON" src="'+AnesthResults.Child.Framework.WEB_ASSET_FILE_LOCATION+'img/glass.png"></div>';w.createChild(v);if(Ext.fly(C+"RESULTS_EXPAND_ICON")){Ext.fly(C+"RESULTS_EXPAND_ICON").on("click",function(F){var D=Ext.getCmp(C);var E=new Array();AnesthResults.Child.Framework.clickHandler(D,{},E);window.event.cancelBubble=true})}}else{var y=Ext.getCmp(n);if(r!=="ISHAPED_RNSS"){var o=y.header.insert(2,j)}}var l;if(h.INPT_RESULTS.MRN!=undefined){var t=h.INPT_RESULTS.MRN;$.ajax({url:AnesthResults.Child.WebServices.MUSEHandler,dataType:"jsonp",data:{mrn:t},error:function(E,D,F){if(cernerMPage!==true){alert("Ajax call to Muse Web Service reported an error: "+F+" Cannot determine if there are ECG reports to show.")}},success:function(E,D,F){if(E.success){if(E.count>=0){l=new Ext.button.Button({id:C+"NOTIFY_ECG_VIEW_BUTTON_ID",xtype:"button",cls:"x-btn-text-icon",icon:a,text:"ECG Reports",handler:function(H,I){var G=chla.eApps.gFuncs.sFormatter(AnesthResults.Child.WebServices.MUSE_URL,t);AnesthResults.Child.WebServices.applink(100,G,null,null,null,null,null,"height=600,width=800,resizable=yes,location=1");I.stopPropagation()}});if(cernerMPage===true){l.render(C+"_MUSE_BTN")}else{if(r!=="ISHAPED_RNSS"){y.header.insert(2,l)}}}}else{if(cernerMPage!==true){alert("Ajax call to Muse Web Service reported an error: "+E.msg+" Cannot determine if there are ECG reports to show.")}}}})}var q=function(I,D,H,G,F,E){if(H.data.RESULT_SUB_TYPE==="ap"){D.tdCls="cursor-default"}return I};var f=function(I,D,H,G,F,E){if(H.data.RESULT_SUB_TYPE==="ap"){D.tdCls="cursor-default"}return Ext.Date.format(I,"m/d/y H:i")};var g=null;var d=true;var B=null;var p=null;if(r==="ISHAPED_RNSS"){d=false;p="Rslt. Dt/Tm";B="Result"}var e=new Ext.grid.GridPanel({id:C,border:false,autoScroll:true,layout:"fit",title:g,hideHeaders:d,disableSelection:true,enableColumnHide:false,enableColumnMove:false,emptyText:"There are no completed results",store:u,frame:false,features:[{ftype:"grouping",enableNoGroups:false,enableGroupingMenu:false,hideGroupedHeader:false,startCollapsed:false,enableGrouping:true,groupHeaderTpl:function(){return'{[values.groupValue.indexOf("2") != -1 ? "Radiology" : (values.groupValue.indexOf("1") != -1 ? "Laboratory": (values.groupValue.indexOf("4") != -1 ? "Micro": (values.groupValue.indexOf("5") != -1 ? "Radiology":(values.groupValue.indexOf("3") != -1 ? "Documents":""))))]}'}(),forceFit:true}],viewConfig:{deferEmptyText:false,stripeRows:true,trackOver:true,listeners:{groupexpand:function(D,F,G,E){b(D.ownerCt,G)}}},columns:{defaults:{menuDisabled:true,enableColumnResize:false},items:[{header:p,dataIndex:"RESULT_DT_TM",flex:0.3,renderer:f},{flex:0.7,header:B,dataIndex:"RESULT_NAME",renderer:q},{dataIndex:"RESULT_TYPE",hidden:true}]},listeners:{viewready:function(G){b(G,"ALL");if(AnesthResults.Child.NavigationPanelFactory.currentLocation===AnesthResults.Child.NavigationPanelFactory.LOCATIONS.CICU_PROBLEMS_AND_TREATMENTS){var D;var F=G.view;for(var E=0;E<F.features.length;E++){if(F.features[E].ftype==="grouping"){D=F.features[E].getGroup("1lab");if(D.name==="1lab"){F.features[E].collapse(D.name,false);E=F.features.length}}}}},itemclick:function(G,D,H,E,I,F){AnesthResults.Child.NotificationsPanelFactory.onResultsGridSelect(G,G.selModel,D,D.index,H,E)}}});return e};
		AnesthResults.Child.NotificationsPanelFactory.getLabHistDetailGrid=function(w){var e=function(G,i,F,E,B,A){var C="?";var D=AnesthResults.Child.Framework.LabHistoryMap[G];if(D){C=D.labItemTrend}return C};var t=function(C,H){var L=C.data.LAB_NAME;var M=C.data.EVENT_CD;var P=AnesthResults.Child.Framework.LabHistoryMap[M];var N=P.refLo;var B=P.refHi;var J=P.criticalLo;var D=P.criticalHi;var F=P.uom;var R=w.panelWidth;var O=P.labItemGraphData;var E=C.data.EXPAND_UNIQUE_ID;var K=E;var Q=C.data.LAB_ONBASE_URL;if(Q!==undefined&&Q.length>0){var G=(DOMAIN_NAME==="TEST"||DOMAIN_NAME==="TEST_FILE")?"http://www.google.com":Q;AnesthResults.Child.WebServices.applink(100,G,null,null,null,null,null,"height=500,width=800,resizable=yes")}else{if(P.numericIndicator!=="NUM"){Ext.define("labHistoryRecord",{extend:"Ext.data.Model",fields:[{name:"LAB_COLLECT_DT_TM",type:"date",dateFormat:"m/d/y H:i"},{name:"LAB_RESULT_ACTUAL"}]});var I=new Ext.data.Store({model:"labHistoryRecord",proxy:{type:"memory",reader:{type:"json",root:""}},data:P.rawData.HISTORY});if(Ext.fly("NOTIFY_GRID_PANEL_"+E)){Ext.getCmp("NOTIFY_GRID_PANEL_"+E).close()}var i=new Ext.grid.GridPanel({store:I,id:"NOTIFY_GRID_PANEL_"+E,renderTo:E,autoScroll:true,trackMouseOver:false,height:100,width:R,frame:false,disableSelection:true,collapsible:false,enableColumnHide:false,enableColumnMove:false,enableColumnResize:false,viewConfig:{forceFit:true,deferEmptyText:false,stripeRows:true,trackOver:false,emptyText:"No Lab History",listeners:{mouseup:{element:"el",fn:function(S){S.stopEvent()},options:{single:true}},mousedown:{element:"el",fn:function(S){S.stopEvent()},options:{single:true}},click:{element:"el",fn:function(S){S.stopEvent()},options:{single:true}},dblclick:{element:"el",fn:function(S){S.stopEvent()},options:{single:true}},contextmenu:{element:"el",fn:function(S){S.stopEvent()},options:{single:true}},mouseover:{element:"el",fn:function(S){S.stopEvent()},options:{single:true}}}},columns:{items:[{header:"Date",dataIndex:"LAB_COLLECT_DT_TM",flex:1,renderer:Ext.util.Format.dateRenderer("m/d/y H:i")},{header:"Result",flex:1,dataIndex:"LAB_RESULT_ACTUAL"}],defaults:{sortable:false,menuDisabled:true}}})}else{var A={data:O,name:L};AnesthResults.Child.LabResultsChartFactory({chartData:A,uom:F,refLow:N,refHigh:B,critLow:J,critHigh:D,container:K,height:150,width:400})}}};Ext.define("labResultDataRecord",{extend:"Ext.data.Model",fields:[{name:"LAB_NAME"},{name:"EVENT_CD"},{name:"RESULT_VALUE"},{name:"NORMALCY_IND"},{name:"UNIT_OF_MEASURE"},{name:"LAB_RANGE_HI"},{name:"LAB_RANGE_LO"},{name:"LAB_CRIT_HI"},{name:"LAB_CRIT_LO"},{name:"NORMALCY_COLOR"},{name:"LAB_ONBASE_URL"},{name:"NUMERIC_IND"},{name:"TREND",mapping:"LAB_NAME"},{name:"LAB_COLLECT_DT_TM",type:"date",dateFormat:"m/d/y H:i"},{name:"EXPAND_UNIQUE_ID",convert:function(i,A){return"remData2"+A.id}}]});var j=new Ext.data.Store({model:"labResultDataRecord",proxy:{type:"memory",reader:{type:"json",root:""}},remoteGroup:false,remoteSort:false,data:w.labResultData.LAB_INFO});var o=w.labResultData.LAB_INFO[0].LAB_COLLECT_DT_TM;var m=w.labResultData.LAB_INFO[0].LAB_NAME;var a=w.labResultData.RESULT_NAME;var p=true;var b=null;var q=false;if(w.labResultData.LAB_INFO.length>4){p=false;q=true;b=250}var d=false;var c;if(w.subType==="discrete"){c=m+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+o;d=false}else{c=a}var n=function(F,i,E,D,C,B){var A="";if(E.data.NORMALCY_IND===""){return F+" "+E.data.UNIT_OF_MEASURE}else{if(E.data.NORMALCY_COLOR.substr(0,1)==="#"){A=E.data.NORMALCY_COLOR}else{switch(E.data.NORMALCY_COLOR){case"pink":A="#FF00FF";break;case"red":A="#FF0000";break;default:break}}return"<SPAN STYLE='color: "+A+"'>"+F+" "+E.data.UNIT_OF_MEASURE+" "+E.data.NORMALCY_IND+"</SPAN>"}};var x=new Ext.XTemplate('<div style="text-align:center" id="{EXPAND_UNIQUE_ID}" class="rem-data-expand"><\div>');var l=new Ext.grid.GridPanel({store:j,title:c,firstCollectDate:o,disableSelection:true,trackMouseOver:false,collapsible:false,enableColumnHide:false,enableColumnMove:false,enableColumnResize:false,viewConfig:{forceFit:true,autoScroll:false,stripeRows:true,trackOver:false},plugins:[{ptype:"child_rowexpander",remoteDataMethod:t,hideExpandClickColumn:true,expandOnClick:true,expandOnDblClick:false,rowBodyTpl:x}],columns:{items:[{id:"lab_name",header:"Name",width:160,fixed:true,dataIndex:"LAB_NAME"},{header:"Result",dataIndex:"RESULT_VALUE",width:90,fixed:true,renderer:n},{header:"Trend",dataIndex:"EVENT_CD",css:"text-align:center;",width:50,fixed:true,renderer:e},{header:"Collect D/T",dataIndex:"LAB_COLLECT_DT_TM",flex:1,renderer:Ext.util.Format.dateRenderer("m/d/y H:i"),hidden:d}],defaults:{sortable:false,menuDisabled:true}}});if(w.subType==="discrete"){l.addListener("viewready",function(i){i.plugins[0].expandAll()})}var g=0,y=false;var k=j.data.items;for(var s=0;s<k.length;s++){var u=k[s];var z=u.data.LAB_NAME;var h=u.data.RESULT_VALUE;var r=u.data.UNIT_OF_MEASURE;if(z==="Bilirubin Sum"){y=true;g=h;break}}if(y){var f=AnesthResults.Child.BiliToolButtonFactory("bilitoolButton",g);var v=new Ext.toolbar.Toolbar({dock:"bottom",items:[f]});l.addDocked(v)}return l};AnesthResults.Child.NotificationsPanelFactory.onResultsGridSelect=function(k,c,f,j,n,h){var a=AnesthResults.Child.NotificationsPanelFactory.notifyData.INPT_RESULTS.PERSON_ID;var m=f.data.RESULT_SUB_TYPE;var l=f.data.RESULT_NAME;var i=Ext.get(k.getNodes(1,53)[j]);var b=10;var d=10;if(i){b=i.getRight()-50;d=i.getTop()}var g=[b,d];switch(m){case"discrete":AnesthResults.Child.NotificationsPanelFactory.showLabDetail(f.data,m,l,g);break;case"group":AnesthResults.Child.NotificationsPanelFactory.showLabDetail(f.data,m,l,g);break;case"cbc":AnesthResults.Child.NotificationsPanelFactory.showLabDetail(f.data,m,l,g);break;case"cbcdiff":AnesthResults.Child.NotificationsPanelFactory.showLabDetail(f.data,m,l,g);break;case"chem":AnesthResults.Child.NotificationsPanelFactory.showLabDetail(f.data,m,l,g);break;case"coag":AnesthResults.Child.NotificationsPanelFactory.showLabDetail(f.data,m,l,g);break;case"doc":if(f.data.DOC_INFO[0].DOC_ONBASE_URL!==""){var e=(DOMAIN_NAME==="TEST"||DOMAIN_NAME==="TEST_FILE")?"http://www.google.com":f.data.DOC_INFO[0].DOC_ONBASE_URL;AnesthResults.Child.WebServices.applink(100,e,null,null,null,null,null,"height=500,width=800,resizable=yes")}else{if(f.data.DOC_INFO[0].DOC_ENCNTR_ID==="0"){sendstr="^MINE^,^"+f.data.DOC_INFO[0].EVENT_ID+"^,^4^";CCLLINK("1mp_pe_clin_smry_clinicaldocs",sendstr,0)}else{sendstr=a+"|"+f.data.DOC_INFO[0].DOC_ENCNTR_ID+"|["+f.data.DOC_INFO[0].EVENT_ID+"]||7||||";MPAGES_EVENT("CLINICALNOTE",sendstr)}}break;case"rad":sendstr=a+"|"+f.data.RAD_INFO[0].ENCNTR_ID+"|["+f.data.RAD_INFO[0].EVENT_ID+"]||31||||";MPAGES_EVENT("CLINICALNOTE",sendstr,0);break;case"ap":break;case"micro":if(f.data.MICRO_INFO[0].DOCUMENT_EXISTS=="YES"){sendstr="^MINE^,^"+f.data.MICRO_INFO[0].EVENT_ID+"^,^3^";CCLLINK("1mp_pe_clin_smry_clinicaldocs",sendstr,0)}else{Ext.Msg.show({msg:"This test does not have a report."})}break;default:break}};
		AnesthResults.Child.NotificationsPanelFactory.setLabTooltip=function(e){idQualifier=(typeof e.idQualifier=="undefined")?"IP":e.idQualifier;var a=e.theViewRowElement;var o=e.subType;var k=e.record;a.id="EZPZ_LAB_TARGET_"+idQualifier+e.rowNum;var b="EZPZ_LAB_CONTENT_"+idQualifier+e.rowNum;if(Ext.fly(b)){Ext.getCmp(b).destroy()}var p=$("#"+a.id);var d=new Ext.Panel({});if(o==="cbcdiff"||o==="cbc"){d=AnesthResults.Child.CBCFishBonePanelFactory.getFishBoneDetailTooltip({panelId:b,record:k});p.ezpz_tooltip({contentId:b,contentPosition:"aboveFollow",stayOnContent:false})}else{if(o==="chem"){d=AnesthResults.Child.ChemFishBonePanelFactory.getFishBoneDetailTooltip({panelId:b,record:k});p.ezpz_tooltip({contentId:b,contentPosition:"aboveFollow",stayOnContent:false})}else{if(o==="coag"){d=AnesthResults.Child.CoagFishBonePanelFactory.getFishBoneDetailTooltip({panelId:b,record:k});p.ezpz_tooltip({contentId:b,contentPosition:"aboveFollow",stayOnContent:false})}else{if(o==="discrete"){var j=e.record.LAB_INFO[0];var c=j.LAB_NAME;var f=j.LAB_COLLECT_DT_TM;var g=AnesthResults.Child.Framework.LabHistoryMap[j.EVENT_CD];var m=j.RESULT_VALUE;var n=function(){var q="";if(j.NORMALCY_IND===""){return m+" "+j.UNIT_OF_MEASURE}else{if(j.NORMALCY_COLOR.substr(0,1)==="#"){q=j.NORMALCY_COLOR}else{switch(j.NORMALCY_COLOR){case"pink":q="#FF00FF";break;case"red":q="#FF0000";break;default:break}}return"<SPAN STYLE='color: "+q+"'>"+m+" "+j.UNIT_OF_MEASURE+" "+j.NORMALCY_IND+"</SPAN>"}}();var i=function(){var q="?";if(g){q=g.labItemTrend}return q}();var l=function(){var r='<table width="400px" class="lab-results-hover-table"><tr><th>Lab Name</th><th>Collect Date</th><th>Trend</th><th>Result</th></tr><tr><td>{0}</td><td >{1}</td><td>{2}</td><td >{3}</td></tr></table>';var q=chla.eApps.gFuncs.sFormatter(r,c,f,i,n);return q}();var h=Ext.create("Ext.Panel",{id:b,renderTo:Ext.getBody(),width:400,floating:true,autoRender:true,hideMode:"display",hidden:false,layout:"fit",title:c+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+f,html:l,listeners:{boxready:function(s,t,q,r){s.addCls("tooltip-content");s.hide()}}});p.ezpz_tooltip({contentId:b,contentPosition:"aboveFollow",stayOnContent:false})}else{h=new Ext.Panel({id:b,renderTo:Ext.getBody(),width:150,html:'<div class="tooltip-content_labresults">Click to see Lab Detail</div>',listeners:{boxready:function(s,t,q,r){s.addCls("tooltip-content");s.hide()}}});p.ezpz_tooltip({contentId:b,contentPosition:"aboveFollow",stayOnContent:false})}}}}};AnesthResults.Child.NotificationsPanelFactory.assignTooltipsToResults=function(z){var B;var c;var w;var d;var f;var v;var n;switch(z.subType){case"discrete":AnesthResults.Child.NotificationsPanelFactory.setLabTooltip(z);break;case"group":AnesthResults.Child.NotificationsPanelFactory.setLabTooltip(z);break;case"cbc":AnesthResults.Child.NotificationsPanelFactory.setLabTooltip(z);break;case"cbcdiff":AnesthResults.Child.NotificationsPanelFactory.setLabTooltip(z);break;case"coag":AnesthResults.Child.NotificationsPanelFactory.setLabTooltip(z);break;case"chem":AnesthResults.Child.NotificationsPanelFactory.setLabTooltip(z);break;case"ap":B=(typeof z.idQualifier=="undefined")?"IP":z.idQualifier;c=z.theViewRowElement;w=z.subType;d=z.record;c.id="EZPZ_LAB_TARGET_"+B+z.rowNum;v="EZPZ_LAB_CONTENT_"+B+z.rowNum;if(Ext.fly(v)){Ext.getCmp(v).destroy()}n=$("#"+c.id);var r=z.record.AP_INFO[0].DOC_TITLE;var l=z.record.AP_INFO[0].RESULT_STATUS;var A=z.record.AP_INFO[0].PERFORMED_DT_TM;var u='<table width="400px"><tr><td>{0}</td><td style="text-align:right;"> {1}</td></tr><tr><td>{2}</td><td style="text-align:right;">See Flowsheet for Results</td></tr></table>';var o=chla.eApps.gFuncs.sFormatter(u,r,A,l);var h=new Ext.Panel({title:r+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+A,id:v,renderTo:Ext.getBody(),width:400,layout:"fit",html:o,listeners:{boxready:function(F,G,D,E){F.addCls("tooltip-content");F.hide()}}});n.ezpz_tooltip({contentId:v,contentPosition:"aboveFollow",stayOnContent:false});break;case"micro":B=(typeof z.idQualifier=="undefined")?"IP":z.idQualifier;c=z.theViewRowElement;w=z.subType;d=z.record;c.id="EZPZ_LAB_TARGET_"+B+z.rowNum;v="EZPZ_LAB_CONTENT_"+B+z.rowNum;if(Ext.fly(v)){Ext.getCmp(v).destroy()}n=$("#"+c.id);var s=function(){htmlcolor="#000000";switch(z.record.MICRO_INFO[0].NORMALCY_COLOR){case"red":htmlcolor="#FF0000";break;default:break}var H=z.record.MICRO_INFO[0].DOC_TITLE;var G=z.record.MICRO_INFO[0].PERFORMED_DT_TM;var F=z.record.MICRO_INFO[0].RESULT_VAL;var E='<table width="400px" ><tr><td>{0}</td><td width=80px style="text-align:right;"> {1}</td></tr><tr><td style="color:{2}" colspan=2>{3}</td></tr></table>';var D=chla.eApps.gFuncs.sFormatter(E,H,G,htmlcolor,F);return D}();var k=z.record.MICRO_INFO[0].DOC_TITLE+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+z.record.MICRO_INFO[0].PERFORMED_DT_TM;var a=new Ext.Panel({id:v,title:k,html:s,width:410,renderTo:Ext.getBody(),listeners:{boxready:function(F,G,D,E){F.addCls("tooltip-content");F.hide()}}});n.ezpz_tooltip({contentId:v,contentPosition:"aboveFollow",stayOnContent:false});break;case"rad":B=(typeof z.idQualifier=="undefined")?"IP":z.idQualifier;c=z.theViewRowElement;c.id="EZPZ_RAD_TARGET_"+B+z.rowNum;v="EZPZ_RAD_CONTENT_"+B+z.rowNum;if(Ext.fly(v)){Ext.getCmp(v).destroy()}n=$("#"+c.id);var e=z.record.RAD_INFO[0].DOC_TITLE;var C=z.record.RAD_INFO[0].DOC_TITLE;var t=z.record.RAD_INFO[0].RESULT_STATUS;var q=z.record.RAD_INFO[0].PERFORMED_DT_TM;var i=Ext.String.format('<table width="400px" border=0><tr><TD width="60%">{2}</td><td style="text-align:right"> {1}</td></tr><tr><td style="font-style:italic">{0}</td><td style="text-align:right">{3}</td></tr></table>',C,q,t);var p=new Ext.Panel({id:v,title:C+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+q,html:i,width:410,renderTo:Ext.getBody(),height:40,listeners:{boxready:function(F,G,D,E){F.addCls("tooltip-content");F.hide()}}});n.ezpz_tooltip({contentId:v,contentPosition:"aboveFollow",stayOnContent:false});break;case"doc":B=(typeof z.idQualifier=="undefined")?"IP":z.idQualifier;c=z.theViewRowElement;c.id="EZPZ_DOC_TARGET_"+B+z.rowNum;v="EZPZ_DOC_CONTENT_"+B+z.rowNum;if(Ext.fly(v)){Ext.getCmp(v).destroy()}n=$("#"+c.id);var m=z.record.DOC_INFO[0].DOC_TITLE;var y=z.record.DOC_INFO[0].PERFORMED_DT_TM;var g=z.record.DOC_INFO[0].DOC_TYPE;var x=z.record.DOC_INFO[0].PERFORMED_BY;var j=Ext.String.format('<table width="400px" border=0><tr><TD width="60%">{2}</td><td style="text-align:right"> {1}</td></tr><tr><td style="font-style:italic">{0}</td><td style="text-align:right">{3}</td></tr></table>',m,y,g,x);var b=new Ext.Panel({id:v,title:m+"&nbsp;&nbsp;&nbsp;&nbsp"+x,html:j,width:410,renderTo:Ext.getBody(),listeners:{boxready:function(F,G,D,E){F.addCls("tooltip-content");F.hide()}}});n.ezpz_tooltip({contentId:v,contentPosition:"aboveFollow",stayOnContent:false});break;default:break}};
		AnesthResults.Child.NotificationsPanelFactory.ResultsPanel.BuildLabHistoryMap=function(o){var y,w;var r=o.INPT_RESULTS.LAB_HISTORY;var f=function(){this.labName="";this.labItemTrend="";this.labItemGraphData=[];this.criticalHi="";this.criticalLo="";this.refHi="";this.refLo="";this.uom="";this.numericIndicator="";this.rawData=null};var v={};var C=r.length;for(var y=C-1;y>=0;y--){var D=r[y].EVENT_CD;var t=r[y].LAB_NAME;var n=r[y].NUMERIC_IND;var E=r[y].LAB_CRIT_HI.replace(/<|>/,"");var d=r[y].LAB_CRIT_LO.replace(/<|>/,"");var s=parseFloat(E);var x=parseFloat(d);var c="",k="";c=parseFloat(r[y].LAB_RANGE_HI);k=parseFloat(r[y].LAB_RANGE_LO);var g=r[y].UNIT_OF_MEASURE;var z=r[y].HISTORY;var h=z.length;var A=new Array(h);for(var w=h-1;w>=0;w--){var b=Date.parse(z[w]["LAB_COLLECT_DT_TM"]);var q=parseFloat(z[w]["LAB_RESULT"]);var B=z[w]["LAB_RESULT_ACTUAL"];var a=z[w]["NORMALCY_COLOR"];var u=function(){var j="url({0}img/{1})";var i="";var F;if(isNaN(B)){if(B.search("&lt;")!=-1){F="img/under.gif"}else{if(B.search("&gt;")!=-1){F="img/over.gif"}}}return F}();A[w]={x:b,y:q,marker:{symbol:u},actualResult:B,color:a}}var p=z.length;var m=chla.global.imgPath;var l=chla.eApps.gFuncs.sFormatter('<img style="vertical-align:middle" src="{0}img/gray_arrow_r.gif">',m);if(p>1){if(A[p-1].y<A[p-2].y){l=chla.eApps.gFuncs.sFormatter('<img style="vertical-align:middle" src="{0}img/gray_arrow_d.gif">',m)}else{if(A[p-1].y>A[p-2].y){l=chla.eApps.gFuncs.sFormatter('<img style="vertical-align:middle" src="{0}img/gray_arrow_u.gif">',m)}}}var e=new f();e.labName=t;e.labItemTrend=l;e.labItemGraphData=A;e.rawData=r[y];e.criticalHi=s;e.criticalLo=x;e.refHi=c;e.refLo=k;e.uom=g;e.numericIndicator=n;v[D]=e}return v};
		AnesthResults.Child.CBCFishBonePanelFactory=function(b,a,c){};
		AnesthResults.Child.CBCFishBonePanelFactory.getCBCFishBoneHtml=function(c){var b=c.labDetail;var j=c.labResultName;var f=c.parentEventId;var e="";var d="";var k=c.id;var m=[];for(var o=0;o<13;o++){m.push("")}var h=chla.global.imgPath;var d='<div id="'+k+'">';d+="<div class='ttheader'>"+e+"</div>";d+='<div class="cbc-fishbone-display" style="background-image:url('+h+'img/cbc_fishbone.gif);">';d+="<div style='position:relative;'>";for(var g=0;g<b.length;g++){var n=b[g].NORMALCY_COLOR;var l=b[g].LAB_NAME;var p=b[g].RESULT_VALUE;var i=b[g].EVENT_CD;switch(l){case"RBC":m[0]=AnesthResults.Child.CBCFishBonePanelFactory.formatLabResultValue({label:AnesthResults.Child.CBCFishBonePanelFactory.CbcIdMap[l],parentEventId:f,eventCode:i,color:n,result:p,top:20,left:102,width:100,align:"center"});break;case"MCV":m[1]=AnesthResults.Child.CBCFishBonePanelFactory.formatLabResultValue({label:AnesthResults.Child.CBCFishBonePanelFactory.CbcIdMap[l],parentEventId:f,eventCode:i,color:n,result:p,top:20,left:207,width:70,align:"center"});break;case"HGB":m[3]=AnesthResults.Child.CBCFishBonePanelFactory.formatLabResultValue({label:AnesthResults.Child.CBCFishBonePanelFactory.CbcIdMap[l],parentEventId:f,eventCode:i,color:n,result:p,top:45,left:160,width:50,align:"right"});break;case"WBC":m[5]=AnesthResults.Child.CBCFishBonePanelFactory.formatLabResultValue({label:AnesthResults.Child.CBCFishBonePanelFactory.CbcIdMap[l],parentEventId:f,eventCode:i,color:n,result:p,top:63,left:83,width:66,align:"right"});break;case"PLTE":m[6]=AnesthResults.Child.CBCFishBonePanelFactory.formatLabResultValue({label:AnesthResults.Child.CBCFishBonePanelFactory.CbcIdMap[l],parentEventId:f,eventCode:i,color:n,result:p,top:63,left:227,width:50,align:"left"});break;case"HCT":m[8]=AnesthResults.Child.CBCFishBonePanelFactory.formatLabResultValue({label:AnesthResults.Child.CBCFishBonePanelFactory.CbcIdMap[l],parentEventId:f,eventCode:i,color:n,result:p,top:81,left:160,width:50,align:"right"});break;case"RDW-CV":m[11]=AnesthResults.Child.CBCFishBonePanelFactory.formatLabResultValue({label:AnesthResults.Child.CBCFishBonePanelFactory.CbcIdMap[l],parentEventId:f,eventCode:i,color:n,result:p,top:105,left:133,width:200,align:"center"});break;default:break}}d+=m[0];d+=m[1];d+=m[2];d+=m[3];d+=m[4];d+=m[5];d+=m[6];d+=m[7];d+=m[8];d+=m[9];d+=m[10];d+=m[11];d+=m[12];d+="</div>";d+="</div>";d+="</div>";return d};
		AnesthResults.Child.CBCFishBonePanelFactory.formatLabResultValue=function(b){var i=b.label;var e=b.parentEventId;var f=b.eventCd;var d=b.color;var j=b.result;var h=b.top;var c=b.left;var a=b.width;var g=b.align;return chla.eApps.gFuncs.sFormatter('<span id="{0}_{1}" class="values" style="position:absolute;top:{2}px;left:{3}px;width:{4}px;text-align:{5};color:{6}";>{7}</span>',i,e,h,c,a,g,d,j)};
		AnesthResults.Child.CBCFishBonePanelFactory.getFishBoneDetailTooltip=function(a){var b=AnesthResults.Child.CBCFishBonePanelFactory.getCBCFishBoneHtml({id:"cbcFishbone"+a.record.PARENT_EVENT_ID,labDetail:a.record.LAB_INFO,labResultName:a.record.RESULT_NAME,parentEventId:a.record.PARENT_EVENT_ID});return b};
		AnesthResults.Child.CBCFishBonePanelFactory.getFishBoneAndHistory=function(c,h,g){var e;var d=c.PARENT_EVENT_ID;var f=AnesthResults.Child.CBCFishBonePanelFactory.getCBCFishBoneHtml({id:"cbcFishbone"+d,labDetail:c.LAB_INFO,labResultName:c.RESULT_NAME,parentEventId:d});console.log("cbcFishBoneHtml: ",f);var b=new Ext.Panel({html:f,border:false,layout:"fit",height:125});var a=AnesthResults.Child.NotificationsPanelFactory.getLabHistDetailGrid({labResultData:c,subType:h,panelWidth:g});a.anchor="100%";a.autoScroll=false;a.setTitle("");return e};AnesthResults.Child.CBCFishBonePanelFactory.CbcIdMap={RBC:"rbc",MCV:"mcv","Neutrophils, %":"seg",HGB:"hgb","Lymphocytes, %":"lymph",WBC:"wbc",PLTE:"plt","Monocytes, %":"mono",HCT:"hct","Eosinophils, %":"eos","Basophils, %":"baso","RDW-CV":"rdw","Polys, %":"seg"};
		function bindDragAndDrop(b){var d=[0,0];var c=document.getElementById(b);var a=false;c.addEventListener("mousedown",function(f){a=true;d=[c.offsetLeft-f.clientX,c.offsetTop-f.clientY]},true);document.addEventListener("mouseup",function(){a=false},true);c.addEventListener("mousemove",function(f){f.preventDefault();if(a){c.style.left=(f.clientX+d[0])+"px";c.style.top=(f.clientY+d[1])+"px"}},true)};

	};
    /**
     * Parent function for processing the JSON data received for display
     * Output of this function will be an object tha contains data items to be used in the presentation construction process.
     *  All data validation and transformations are done in this function
     *
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @param aDtoData {object} Dto object specifically defined by RPTDATA response from CCL request
     * @returns {*} {object} retVal is a CC specifically defined DTO for transferring data to presentation processing
     */
    AnesthResults.ccnsp.processData = function (aObjNSbase, aObjCcBase,aDtoData) {
        var retVal = {},
			DtoData;
		//chla.eAppsUtil.Logger.LogError(JSON.stringify(aObjCcBase.data));
		if(aObjCcBase.data && aObjCcBase.data.INPT_RESULTS && aObjCcBase.data.INPT_RESULTS.RESULTS) {
		
			var data = aObjCcBase.data;			

			var remappedData;
            AnesthResults.remappedData = remappedData = {
                "PersonID": data.INPT_RESULTS.PERSON_ID,
                "EncounterID": data.INPT_RESULTS.ENCNTR_ID,
                "UserID": data.INPT_RESULTS.USER_ID,
                "MRN": data.INPT_RESULTS.MRN,
                "Radiology": [],
				"Laboratory": [],
				"LabHistoryMap": data.INPT_RESULTS.LAB_HISTORY,
                "Micro": [],
                "Documents": []
            }

            data.INPT_RESULTS.RESULTS.forEach(function (currentValue, index, array) {

                switch (currentValue.RESULT_SUB_TYPE) {
                    case 'doc':
                        remappedData.Documents.push(currentValue)
                        break;
                    case 'micro':
                        remappedData.Micro.push(currentValue)
                        break;
                    case 'rad':
                        remappedData.Radiology.push(currentValue)
                        break;
                    default:
                        remappedData.Laboratory.push(currentValue)
                        break;
                }

            })

			// Lab history map for trends
			AnesthResults.labHistoryMap = AnesthResults.Child.NotificationsPanelFactory.ResultsPanel.BuildLabHistoryMap(data)

			retVal = AnesthResults.remappedData;

		} else {
			return false;
		}
		return retVal;

		// return remappedData;

    };
    /**
     * Parent function for construction of the UI
     * Output of the function will be an object contain a string of the total html to be render for this component
     *   All necessary presentation formation and transformation are done in this function.
     *
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @param aDtoUI {object} aDtoData object
     * @returns {object} retVal is a CC specifically defined DTO for transferring data to presentation rendering processing
     */
    AnesthResults.ccnsp.processUI   = function (aObjNSbase, aObjCcBase,aDtoUI) {
		var data = aObjCcBase.eApps.getDataDto(aObjCcBase);
		if(!data) {
			return 'No results found';
		}
	
		var template =
			'<div id="AnesthResults">\
			<h3 id="AnesthResultsRadiology_Header" style="border-bottom:1px solid blue;margin-bottom:2px;" class="">\
				<span>Radiology</span>\
			</h3>\
			<div id="AnesthResultsRadiology_SecContent" class="sub-sec-content">\
				<table>\
					{{#Radiology}}\
					<tr data-subdatatype="{{RESULT_SUB_TYPE}}" data-eventid="{{#RAD_INFO}}{{EVENT_ID}}{{/RAD_INFO}}">\
						<td>{{RESULT_DT_TM}}</td>\
						<td class="resultName">{{RESULT_NAME}}</td>\
					</tr>\
					{{/Radiology}}\
				</table>\
			</div>\
			<h3 id="AnesthResultsLaboratory_Header" style="border-bottom:1px solid blue;margin-bottom:2px;" class="">\
				<span>Laboratory</span>\
			</h3>\
			<div id="AnesthResultsLaboratory_SecContent" class="sub-sec-content">\
				<table>\
					{{#Laboratory}}\
					<tr data-subdatatype="{{RESULT_SUB_TYPE}}" data-eventid=\'{"RESULT_NAME": "{{RESULT_NAME}}","RESULT_DT_TM": "{{RESULT_DT_TM}}","RESULT_TYPE": "{{RESULT_TYPE}}","RESULT_SUB_TYPE": "{{RESULT_SUB_TYPE}}","UPDT_DT_TM": "{{UPDT_DT_TM}}","SORT_DT_TM_DQ8": "{{SORT_DT_TM_DQ8}}","PARENT_EVENT_ID": "{{PARENT_EVENT_ID}}","ORDER_ID": "{{ORDER_ID}}", "LAB_INFO": [{{#LAB_INFO}}{"LAB_NAME": "{{LAB_NAME}}","LAB_SEQUENCE": "{{LAB_SEQUENCE}}","EVENT_CD": "{{EVENT_CD}}","NUMERIC_IND": "{{NUMERIC_IND}}","RESULT_VALUE": "{{RESULT_VALUE}}","UNIT_OF_MEASURE": "{{UNIT_OF_MEASURE}}","NORMALCY_COLOR": "{{NORMALCY_COLOR}}","NORMALCY_IND": "{{NORMALCY_IND}}","LAB_COLLECT_DT_TM": "{{LAB_COLLECT_DT_TM}}","LAB_RANGE_HI": "{{LAB_RANGE_HI}}","LAB_RANGE_LO": "{{LAB_RANGE_LO}}","LAB_CRIT_HI": "{{LAB_CRIT_HI}}","LAB_CRIT_LO": "{{LAB_CRIT_LO}}","LAB_ONBASE_URL": "{{LAB_ONBASE_URL}}"}{{#RESULT_NAME}},{{/RESULT_NAME}}{{/LAB_INFO}}]}\'  data-resultname=\'{{RESULT_NAME}}\' data-result_dt_tm=\'{{RESULT_DT_TM}}\' data-resultinfo=\'{}\'>\
						<td>{{RESULT_DT_TM}}</td>\
						<td class="resultName">{{RESULT_NAME}}</td>\
					</tr>\
					{{/Laboratory}}\
				</table>\
			</div>\
			<h3 id="AnesthResultsMicro_Header" style="border-bottom:1px solid blue;margin-bottom:2px;" class="">\
				<span>Micro</span>\
			</h3>\
			<div id="AnesthResultsMicro_SecContent" class="sub-sec-content">\
				<table>\
					{{#Micro}}\
					<tr data-subdatatype="{{RESULT_SUB_TYPE}}" data-eventid="{{#MICRO_INFO}}{{EVENT_ID}}{{/MICRO_INFO}}" >\
						<td>{{RESULT_DT_TM}}</td>\
						<td class="resultName">{{RESULT_NAME}}</td>\
					</tr>\
					{{/Micro}}\
				</table>\
			</div>\
			<h3 id="AnesthResultsDocuments_Header" style="border-bottom:1px solid blue;margin-bottom:2px;" class="closed">\
				<span>Documents</span>\
			</h3>\
			<div id="AnesthResultsDocuments_SecContent" class="sub-sec-content closed">\
				<table>\
					{{#Documents}}\
					<tr data-subdatatype="{{RESULT_SUB_TYPE}}" data-eventid="{{#DOC_INFO}}{{EVENT_ID}}{{/DOC_INFO}}" data-tooltip=\'{{#DOC_INFO}}<table style="background-color:#fff;font-family:arial;font-size:11px;border:1px solid black;"><tr><TD>{{DOC_TYPE}}</td><td> {{PERFORMED_DT_TM}}</td></tr><tr><td>{{DOC_TITLE}}</td><td>{{PERFORMED_BY}}</td></tr></table>{{/DOC_INFO}}\' >\
						<td>{{RESULT_DT_TM}}</td>\
						<td class="resultName">{{RESULT_NAME}}</td>\
					</tr>\
					{{/Documents}}\
				</table>\
			</div>\
		</div>';
		var output = Mustache.render(template, data)
        return output;
    };
    /**
     * Parent function for processing functions after the UI has been render to the DOM
     *   All css,dom behaviors to be associated with UI components is handled in this function.
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    AnesthResults.ccnsp.processPostCcInstance  = function (aObjNSbase, aObjCcBase) {
		var remappedData = aObjCcBase.eApps.getDataDto(aObjCcBase);
		var popupWindowName = 'myWin';
		
		// Added section show/hide click listeners
        ['AnesthResultsRadiology', 'AnesthResultsLaboratory', 'AnesthResultsMicro', 'AnesthResultsDocuments'].forEach(function (sectionIdentifier) {
            AnesthResults.collapseSections(sectionIdentifier);
        })

        // Click listener for Clinical Note Display of rad, micro, docs
        $('#' + aObjCcBase.eApps.cc_id + ' #AnesthResultsRadiology_SecContent tr, ' + 
			'#' + aObjCcBase.eApps.cc_id + ' #AnesthResultsMicro_SecContent tr, ' +
			'#' + aObjCcBase.eApps.cc_id + ' #AnesthResultsDocuments_SecContent tr').click(
			function () {
				var subDataType = $(this).data('subdatatype')
				if (subDataType == "doc" || subDataType == "micro" || subDataType == "rad") {
					var eventID = $(this).data('eventid');
				}
				AnesthResults.showData(subDataType, eventID, remappedData);
			}
		);
		 
        $('#' + aObjCcBase.eApps.cc_id + ' #AnesthResultsLaboratory_SecContent tr').each(function(index, item){
			var labRecord = {};
			labRecord.eventID = $(this).data('eventid').slice(0, -3) + ']}';
			labRecord.parsedEventID = JSON.parse(labRecord.eventID);
			labRecord.subType = $(this).data('subdatatype');
			labRecord.popName = $(this).data('resultname');
			labRecord.popDate = $(this).data('result_dt_tm');
			labRecord.hoverDisplayParsing = AnesthResults.setLabTooltip(labRecord.parsedEventID, labRecord.subType);
			var tooltip = labRecord.hoverDisplayParsing.tooltip ? labRecord.hoverDisplayParsing.tooltip : (labRecord.hoverDisplayParsing.fishbone? labRecord.hoverDisplayParsing.fishbone : labRecord.hoverDisplayParsing.datatable);
			chla.eApps.gFuncs.bindFloatingHover(this, 'body', tooltip, false, '', '');
			$(this).on('click', labRecord, function (e) {
				var results,
					fishbone = e.data.hoverDisplayParsing.fishbone,
					datatable = e.data.hoverDisplayParsing.datatable;
				if(fishbone && datatable) {
					results = fishbone + '<br/>' + datatable;
				} else if(fishbone) {
					results = fishbone;
				} else if(datatable) {
					results = datatable;
				}				
				chla.eApps.gFuncs.createFloatingPopupWindow(popupWindowName, e.data.popName + ' ' + e.data.popDate + '<i style="margin-right:30px"/>', results);
				chla.eApps.gFuncs.bindDragAndDrop(popupWindowName);
			});
		});
		
		$('body').on('click', 'tr.lab-history-record', null, function(e) {
			var EVENT_CD = $(this).data('event_cd');
			var LAB_ONBASE_URL = $(this).data('lab_onbase_url');
			var LAB_NAME = $(this).data('lab_name');
			var labHistoryData = AnesthResults.labHistoryMap[EVENT_CD];
			var graphData = labHistoryData.labItemGraphData;
			var refLow = labHistoryData.refLo;
			var refHigh = labHistoryData.refHi;
			var critLow = labHistoryData.criticalLo;
			var critHigh = labHistoryData.criticalHi;
			var uom = labHistoryData.uom;
			var container = 'temp-lab-history-callout';
			var winHeight = 150,
				winWidth = 350;
			
			$(this).css('cursor', 'wait');
			$('#' + container).remove();
			
			if (LAB_ONBASE_URL && LAB_ONBASE_URL.length > 0) {
				AnesthResults.applink(100, LAB_ONBASE_URL, null, null, null, null, null, "height=500,width=800,resizable=yes");
			} else if (labHistoryData.numericIndicator !== 'NUM') {
				var data = labHistoryData.rawData.HISTORY;
				var theWidth = 200;
				var retVal = [],
					row = [];
				retVal.push('<div style="width:' + theWidth + 'px;max-width:300px;max-height:300px;overflow-y:auto;"><table style="table-layout:fixed;">'+
					'<thead><tr><th style="width:50%;">Date'+
					'</th><th style="width:50%;">Result'+
					'</th></tr></thead><tbody>');
				
				row.push('<tr class="<#=ODD#>">'+
					'<td><#=LAB_COLLECT_DT_TM#></td>'+
					'<td><#=LAB_RESULT_ACTUAL#></td>'+
					'</tr>'
				);
				if(data.length > 0) {
					data.forEach(
						function (value,index) {
							value.ODD = (index % 2 === 0? 'odd':'');
							retVal.push(aObjNSbase.gFuncs.parseTemplate(row.join(''), value));
						}
					);
				} else {
					retVal.push('No Lab History');
				}
				retVal.push('</tbody></table></div>');	
				chla.eApps.gFuncs.createFloatingCallout(container, retVal.join(''), $(this), 'right');		
				
				$('#' + popupWindowName).on('remove', function(e) {
					$('#' + container).remove();
				}); 
				
			} else {
				var innerHTML = '<div id="chart_' + container + '" style="min-height:' + winHeight + ';min-width:' + winWidth + ';"></div>';
			
				chla.eApps.gFuncs.createFloatingCallout(container, innerHTML, $(this), 'right');
				
				var chartData = {
					'data' : graphData,
					'name' : LAB_NAME
				};
				AnesthResults.LabResultsChartFactory({
					chartData : chartData,
					uom : uom,
					refLow : refLow,
					refHigh : refHigh,
					critLow : critLow,
					critHigh : critHigh,
					container : "chart_" + container,
					height : winHeight,
					width : winWidth
				});
				
				$('#' + popupWindowName).on('remove', function(e) {
					$('#' + container).remove();
				}); 
			}
			$(this).css('cursor', 'default');
		});
	};
    /**
     *  Call to build CC and to render to CC framework
     */
    AnesthResults.ccnsp.ProcessCtl(AnesthResults.ccnsp,component);
}
chla['PreOPAnProcs'].prototype.render = function() {
    'use strict';
    var  component = this,
        /**
         * variable to contain working object for cc rendering
         */
        PreOPAnProcs;
    /**
     *  initialize the variable with the CC Module base class
     */
    PreOPAnProcs  = chla.eAppsClass.gCcModule.createCcModuleCls.neo();
    /*----------------------------------------------------*/
    /* Replace these functions with this CC specific code.*/
    /*----------------------------------------------------*/
    /**
     * Parent function for processing initialization specifically for the CC
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    PreOPAnProcs.ccnsp.postInit  = function (aObjNSbase, aObjCcBase) {
    };
    /**
     * Parent function for processing the JSON data received for display
     * Output of this function will be an object tha contains data items to be used in the presentation construction process.
     *  All data validation and transformations are done in this function
     *
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @param aDtoData {object} Dto object specifically defined by RPTDATA response from CCL request
     * @returns {*} {object} retVal is a CC specifically defined DTO for transferring data to presentation processing
     */
    PreOPAnProcs.ccnsp.processData = function (aObjNSbase, aObjCcBase,aDtoData) {
        var retVal = {};
        return retVal;
    };

    /**
     * Parent function for construction of the UI
     * Output of the function will be an object contain a string of the total html to be render for this component
     *   All necessary presentation formation and transformation are done in this function.
     *
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @param aDtoUI {object} aDtoData object
     * @returns {object} retVal is a CC specifically defined DTO for transferring data to presentation rendering processing
     */
    PreOPAnProcs.ccnsp.processUI   = function (aObjNSbase, aObjCcBase,aDtoUI) {
        var retVal = [
            '<div id="chlaPreOPAnProcs1H3Sec" class="" style="text-align:left"><h3>Current Encounter ( 1 Procedure)</h3>',
            '<div style="border-top:1px solid blue;padding-top:2px;"><table >',
            '<tr style="text-align:left;"><td style="font-weight:800;width:200px;">Repair Ear Microtia Stage 1 </td><td>(Post-Op Day 0)</td></tr>',
            '</table></div></div><br/>',
            '<div id="this.m_id" class="" style="text-align:left"><h3>Previous Encounters  (1 Procedure)</h3>',
            '<div style="border-top:1px solid blue;padding-top:2px;"><table >',
            '<tr style="text-align:left;"><td style="font-weight:800;">Tonsillectomy & Adenoidectomy </td></tr>',
            '</table></div></div>'
        ];
        return retVal.join('');
    };
    /**
     * Parent function for processing functions after the UI has been render to the DOM
     *   All css,dom behaviors to be associated with UI components is handled in this function.
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    PreOPAnProcs.ccnsp.processPostCcInstance  = function (aObjNSbase, aObjCcBase) {};

    /**
     *  Call to build CC and to render to CC framework
     */
    PreOPAnProcs.ccnsp.ProcessCtl(PreOPAnProcs.ccnsp,component);

}
chla['PreOPAnAssess'].prototype.render = function() {
    'use strict';
    var  component = this,
        /**
         * variable to contain working object for cc rendering
         */
        PreOPAnAssess;
    /**
     *  initialize the variable with the CC Module base class
     */
    PreOPAnAssess  = chla.eAppsClass.gCcModule.createCcModuleCls.neo();
    /*----------------------------------------------------*/
    /* Replace these functions with this CC specific code.*/
    /*----------------------------------------------------*/
    /**
     * Parent function for processing initialization specifically for the CC
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    PreOPAnAssess.ccnsp.postInit  = function (aObjNSbase, aObjCcBase) { 
		PreOPAnAssess.panelId = 'PreOPAnAssess_';
	};
    /**
     * Parent function for processing the JSON data received for display
     * Output of this function will be an object tha contains data items to be used in the presentation construction process.
     *  All data validation and transformations are done in this function
     *
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @param aDtoData {object} Dto object specifically defined by RPTDATA response from CCL request
     * @returns {*} {object} retVal is a CC specifically defined DTO for transferring data to presentation processing
     */
    PreOPAnAssess.ccnsp.processData = function (aObjNSbase, aObjCcBase,aDtoData) {
        var retVal = {},
			theData,
			i = 0;
		//chla.eAppsUtil.Logger.LogError(JSON.stringify(aObjCcBase.data));
		if(aObjCcBase.data && aObjCcBase.data.PREOP) {
			theData = aObjCcBase.data.PREOP;
			if(theData.length == 0) {
				return false;
			}
			var skinGrid, 
				tubesGrid, 
				devicesGrid,
				ID_EXPOSURE='',
				HISTORY_OF_PRESSURE_ULCER='',
				PRESENT_ON_ADMISSION='',
				SICK_RECENT='',
				SICK_RECENT_DESC='',
				LOC_RECENT_TRAVEL='',
				INFECTIOUS_DISEASE='',
				CONCERNS_GROWTH_DEV='',
				COGNITIVE_MILESTONES='',
				COGNITIVE_IMPAIRMENT='',
				SOCIAL_COMM_MILESTONES='',
				SOCIAL_COMM_IMPAIRMENT='',
				HEARING_VISION_MILESTONES='',
				HEARING_VISION_IMPAIRMENT='',
				MOTOR_SKILLS_MILESTONES='',
				MOTOR_SKILLS_IMPAIRMENT='',
				MOBILITY_ASSISTANCE='',
				SENSORY_DEFICITS='',
				DEMONSTRATES_PAIN_BY='',
				SPECIAL_ELIMIN_NEEDS='',
				SPECIAL_ELIMIN_NEEDS_DETAILS='',
				SELF_CATH='',
				SELF_CATH_FREQUENCY='',
				SELF_CATH_TYPE_SIZE='',
				SELF_CATH_LAST_TIME='',
				SURG_PRESCRIPTIONS_PLAN='',
				PARENTAL_CONCERNS='',
				PREFERRED_NAME='',
				OTHER_INFO_DAY_OF_SURG='',
				NUTRITION_INFO='',
				USES_PACIFIER='',
				THICKENED_FEEDS_CONSISTENCY='',
				SWALLOWS_WITHOUT_CHOKING='',
				DEVICES_EQUIPMENT_TREATMENTS='', 
				noData;

			if (theData.FORMDATA.length > 0 ){
				for(i=0; i<theData.FORMDATA.length; i++){
					switch(theData.FORMDATA[i].FIELDKEY){
						case 'SICK_RECENT' :
							SICK_RECENT = theData.FORMDATA[i].VALUE;
							break;
						case 'SICK_RECENT_DESC' :
							SICK_RECENT_DESC = theData.FORMDATA[i].VALUE;
							break;
						case 'LOC_RECENT_TRAVEL' :
							LOC_RECENT_TRAVEL = theData.FORMDATA[i].VALUE;
							break;
						case 'INFECTIOUS_DISEASE' :
							INFECTIOUS_DISEASE = theData.FORMDATA[i].VALUE;
							break;
						case 'ID_EXPOSURE' :
							ID_EXPOSURE = theData.FORMDATA[i].VALUE;
							break;
						case 'HISTORY_OF_PRESSURE_ULCER' :
							HISTORY_OF_PRESSURE_ULCER = theData.FORMDATA[i].VALUE;
							if (HISTORY_OF_PRESSURE_ULCER.substr(0,2) === 'No'){
								HISTORY_OF_PRESSURE_ULCER = '';
							}
							break;
						case 'PRESENT_ON_ADMISSION' :
							PRESENT_ON_ADMISSION = theData.FORMDATA[i].VALUE;
							if (PRESENT_ON_ADMISSION.substr(0,2) === 'NO'){
								PRESENT_ON_ADMISSION = 'no';
							}
							break;
						case 'DEMONSTRATES_PAIN_BY' :
							DEMONSTRATES_PAIN_BY = theData.FORMDATA[i].VALUE;
							break;
						case 'SURG_PRESCRIPTIONS_PLAN' :
							SURG_PRESCRIPTIONS_PLAN = theData.FORMDATA[i].VALUE; 
							break;
						case 'OTHER_INFO_DAY_OF_SURG' :
							OTHER_INFO_DAY_OF_SURG = theData.FORMDATA[i].VALUE; 
							break;
						case 'DEVICES_EQUIPMENT_TREATMENTS':
							DEVICES_EQUIPMENT_TREATMENTS = theData.FORMDATA[i].VALUE;
							break;
						case 'PARENTAL_CONCERNS' :
							PARENTAL_CONCERNS = theData.FORMDATA[i].VALUE; 
							break;
						case 'PREFERRED_NAME' :
							PREFERRED_NAME = theData.FORMDATA[i].VALUE;
							break;
						case 'COGNITIVE_MILESTONES' :
							COGNITIVE_MILESTONES = theData.FORMDATA[i].VALUE;
							break;
						case 'COGNITIVE_IMPAIRMENT' :
							COGNITIVE_IMPAIRMENT = theData.FORMDATA[i].VALUE;
							break;
						case 'SOCIAL_COMM_MILESTONES' :
							SOCIAL_COMM_MILESTONES = theData.FORMDATA[i].VALUE;
							break;
						case 'SOCIAL_COMM_IMPAIRMENT' :
							SOCIAL_COMM_IMPAIRMENT = theData.FORMDATA[i].VALUE;
							break;			
						case 'HEARING_VISION_MILESTONES' :
							HEARING_VISION_MILESTONES = theData.FORMDATA[i].VALUE;
							break;
						case 'HEARING_VISION_IMPAIRMENT' :
							HEARING_VISION_IMPAIRMENT = theData.FORMDATA[i].VALUE;
							break;
						case 'MOTOR_SKILLS_MILESTONES' :
							MOTOR_SKILLS_MILESTONES = theData.FORMDATA[i].VALUE;
							break;
						case 'MOTOR_SKILLS_IMPAIRMENT' :
							MOTOR_SKILLS_IMPAIRMENT = theData.FORMDATA[i].VALUE;
							break;
						case 'MOBILITY_ASSISTANCE' :
							MOBILITY_ASSISTANCE = theData.FORMDATA[i].VALUE;
							break;			
						case 'SENSORY_DEFICITS' :
							SENSORY_DEFICITS = theData.FORMDATA[i].VALUE;
							break;
						case 'SPECIAL_ELIMIN_NEEDS' :
							SPECIAL_ELIMIN_NEEDS = theData.FORMDATA[i].VALUE;
							break;
						case 'SPECIAL_ELIMIN_NEEDS_DETAILS' :
							SPECIAL_ELIMIN_NEEDS_DETAILS = theData.FORMDATA[i].VALUE;
							break;
						case 'SELF_CATH' :
							SELF_CATH = theData.FORMDATA[i].VALUE;
							break;
						case 'SELF_CATH_FREQUENCY' :
							SELF_CATH_FREQUENCY = theData.FORMDATA[i].VALUE;
							break;
						case 'SELF_CATH_TYPE_SIZE' :
							SELF_CATH_TYPE_SIZE = theData.FORMDATA[i].VALUE;
							break;
						case 'SELF_CATH_LAST_TIME' :
							SELF_CATH_LAST_TIME = theData.FORMDATA[i].VALUE;
							break;
						case 'NUTRITION_INFO' :
							NUTRITION_INFO = theData.FORMDATA[i].VALUE;
							break;
						case 'USES_PACIFIER' :
							USES_PACIFIER = theData.FORMDATA[i].VALUE;
							break;					
						case 'THICKENED_FEEDS_CONSISTENCY' :
							THICKENED_FEEDS_CONSISTENCY = theData.FORMDATA[i].VALUE;
							break;
						case 'SWALLOWS_WITHOUT_CHOKING' :
							SWALLOWS_WITHOUT_CHOKING = theData.FORMDATA[i].VALUE;
							break;
						default :
							break;
					}
				}
			} else {
				noData = true;
				return false;
			}
			 
			var formData = '';
			if (SICK_RECENT === '' && ID_EXPOSURE	===	'' && PRESENT_ON_ADMISSION	===	'' && DEMONSTRATES_PAIN_BY === '' && SURG_PRESCRIPTIONS_PLAN === '' && PARENTAL_CONCERNS === '' && PREFERRED_NAME === '' && OTHER_INFO_DAY_OF_SURG === '')
			{
				formData = [];
			} else {
				formData = [
				{
					"FIELDKEY": "SICK_RECENT",
					"LABEL" : "In Usual State Of Health?",
					"VALUE" : SICK_RECENT, 
					"DESCRIPTION" : SICK_RECENT_DESC
				},{
					"FIELDKEY": "ID_EXPOSURE",
					"LABEL" : "Infectious Disease Exposure",
					"VALUE" : ID_EXPOSURE, 
					"DESCRIPTION" : (LOC_RECENT_TRAVEL ? LOC_RECENT_TRAVEL + (INFECTIOUS_DISEASE ? '; ' + INFECTIOUS_DISEASE : '') : (INFECTIOUS_DISEASE ? INFECTIOUS_DISEASE : ''))
				},{
					"FIELDKEY": "HISTORY_OF_PRESSURE_ULCER",
					"LABEL" : "History of Pressure Ulcer",
					"VALUE" : HISTORY_OF_PRESSURE_ULCER, 
					"DESCRIPTION" : '' 
				},{
					"FIELDKEY": "PRESENT_ON_ADMISSION",
					"LABEL" : "Present on arrival",
					"VALUE" : PRESENT_ON_ADMISSION, 
					"DESCRIPTION" : '' 
				},{
					"FIELDKEY": "DEMONSTRATES_PAIN_BY",
					"LABEL" : "Patient shows pain by",
					"VALUE" : DEMONSTRATES_PAIN_BY, 
					"DESCRIPTION" : '' 
				},{
					"FIELDKEY": "SURG_PRESCRIPTIONS_PLAN",
					"LABEL" : "Prescriptions",
					"VALUE" : SURG_PRESCRIPTIONS_PLAN, 
					"DESCRIPTION" : '' 
				},{
					"FIELDKEY": "PARENTAL_CONCERNS",
					"LABEL" : "Parental Concerns for Day of Surgery",
					"VALUE" : PARENTAL_CONCERNS, 
					"DESCRIPTION" : '' 
				},{
					"FIELDKEY": "OTHER_INFO_DAY_OF_SURG",
					"LABEL" : "Other Info for Day of Surgery",
					"VALUE" : OTHER_INFO_DAY_OF_SURG, 
					"DESCRIPTION" : '' 
				},{
					"FIELDKEY": "PREFERRED_NAME",
					"LABEL" : "Preferred Name",
					"VALUE" : PREFERRED_NAME, 
					"DESCRIPTION" : '' 
				}];
			}
			
			var developmentalGrid = '';
			if (COGNITIVE_MILESTONES === '' && SOCIAL_COMM_MILESTONES === '' && HEARING_VISION_MILESTONES === '' && MOTOR_SKILLS_MILESTONES === '' && MOBILITY_ASSISTANCE === '' && SENSORY_DEFICITS === '')
			{
				developmentalGrid = [];
			} else {
				developmentalGrid = [		
				{
					"LABEL" : "Cognitive",
					"VALUE" : COGNITIVE_MILESTONES,
					"DESCRIPTION" : COGNITIVE_IMPAIRMENT
				},{
					"LABEL" : "Social",
					"VALUE" : SOCIAL_COMM_MILESTONES,
					"DESCRIPTION" : SOCIAL_COMM_IMPAIRMENT
				},{
					"LABEL" : "Hearing/vision",
					"VALUE" : HEARING_VISION_MILESTONES,
					"DESCRIPTION" : HEARING_VISION_IMPAIRMENT
				},{
					"LABEL" : "Motor skills",
					"VALUE" : MOTOR_SKILLS_MILESTONES,
					"DESCRIPTION" : MOTOR_SKILLS_IMPAIRMENT
				},{
					"LABEL" : "Mobility assistance",
					"VALUE" : MOBILITY_ASSISTANCE,
					"DESCRIPTION" : ''
				},{
					"LABEL" : "Sensory deficits",
					"VALUE" : SENSORY_DEFICITS,
					"DESCRIPTION" : ''
				}];
			}
			
			var nutritionalGrid = '';
			if (THICKENED_FEEDS_CONSISTENCY === ''&& SWALLOWS_WITHOUT_CHOKING === '' && USES_PACIFIER === '' && NUTRITION_INFO === '')
			{
				nutritionalGrid = [];
			} else {
				nutritionalGrid = [
				{
					"LABEL" : "Feeding method",
					"VALUE" : NUTRITION_INFO,
					"DESCRIPTION" : ''
				},{
					"LABEL" : "Pacifier use okay",
					"VALUE" : USES_PACIFIER,
					"DESCRIPTION" : ''
				},{
					"LABEL" : "Thickened feeds consistency",
					"VALUE" : THICKENED_FEEDS_CONSISTENCY,
					"DESCRIPTION" : ''
				},{
					"LABEL" : "Swallows w/o choking",
					"VALUE" : SWALLOWS_WITHOUT_CHOKING,
					"DESCRIPTION" : ''
				}];
			}			
			
			var eliminationGrid = '';			
			if (SPECIAL_ELIMIN_NEEDS === '' && SELF_CATH === '' && SELF_CATH_FREQUENCY === '' && SELF_CATH_TYPE_SIZE === '' && SELF_CATH_LAST_TIME === '')
			{
				eliminationGrid = [];
			} else{
				eliminationGrid = [		
				{		
					"LABEL" : "Elimination needs",
					"VALUE" : SPECIAL_ELIMIN_NEEDS + ' - ' + SPECIAL_ELIMIN_NEEDS_DETAILS,
					"DESCRIPTION" : SPECIAL_ELIMIN_NEEDS_DETAILS
				},{
					"LABEL" : "Self-cath",
					"VALUE" : SELF_CATH,
					"DESCRIPTION" : ''
				},{
					"LABEL" : "Self-cath frequency",
					"VALUE" : SELF_CATH_FREQUENCY,
					"DESCRIPTION" : ''
				},{
					"LABEL" : "Self-cath type/size",
					"VALUE" : SELF_CATH_TYPE_SIZE,
					"DESCRIPTION" : ''
				},{
					"LABEL" : "Self-cath last time",
					"VALUE" : SELF_CATH_LAST_TIME,
					"DESCRIPTION" : ''
				}];
			}
			
			if(theData.SKINGRID){
				skinGrid = [];
				for(i=0; i<theData.SKINGRID.length; i++){
					skinGrid.push({
						"LOCATION": theData.SKINGRID[i].LOCATION,
						"TYPE" : theData.SKINGRID[i].TYPE,
						"DESCRIPTION" : theData.SKINGRID[i].DESCRIPTION
					});
				}
			}

			if(theData.TUBESGRID){
				tubesGrid = [];
				for(i=0; i<theData.TUBESGRID.length; i++){
					tubesGrid.push({
						"TYPE": theData.TUBESGRID[i].TYPE,
						"SIZE" : theData.TUBESGRID[i].SIZE,
						"DETAILS" : theData.TUBESGRID[i].DETAILS
					});
				}
			}

			if(theData.FORMDATA){
				devicesGrid = [];
				for(i=0; i<theData.FORMDATA.length; i++){
					if(theData.FORMDATA[i].FIELDKEY === "DEVICES_EQUIPMENT_TREATMENTS") {
						devicesGrid.push({
							"TYPE": 'Home Equipment and Supplies',
							"DETAILS" : theData.FORMDATA[i].VALUE
						});
					}
				}
			}
			
			retVal = {
				"FORMDATA" : formData,
				"SKINGRID" : skinGrid,
				"DEVELOPMENTAL" : developmentalGrid,
				"NUTRITIONAL" : nutritionalGrid,
				"ELIMINATION" : eliminationGrid,
				"TUBESGRID" : tubesGrid,
				"DEVICESGRID" : devicesGrid
			};
		} else {
			return false;
		}
        return retVal;
    };

    /**
     * Parent function for construction of the UI
     * Output of the function will be an object contain a string of the total html to be render for this component
     *   All necessary presentation formation and transformation are done in this function.
     *
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @param aDtoUI {object} aDtoData object
     * @returns {object} retVal is a CC specifically defined DTO for transferring data to presentation rendering processing
     */
    PreOPAnAssess.ccnsp.processUI   = function (aObjNSbase, aObjCcBase,aDtoUI) {
		var objData = aObjCcBase.eApps.getDataDto(aObjCcBase);	
		//chla.eAppsUtil.Logger.LogError(JSON.stringify(objData));
        var retVal = [];
		retVal.push('<div class="eAppsHdrToolbar" style="position: absolute;width:30%;margin-left:250px;margin-top:-30px;z-index: 30;background-color:rgba(0,0,0,0);">',
			'<div id="' + PreOPAnAssess.panelId + '_launch_form_header" style="color:blue;font-size:14:px; font-weight: 800;text-align: center; display: inline-block;background-color:inherit;cursor:pointer;">',
			'Launch Form</div>',
		'</div>');
		if(!objData) {
			retVal.push('No results found');
			return retVal.join('');
		}
		retVal.push('<div class="sch-preopAssessmentGrid">');
		objData.FORMDATA.forEach(
			function(item) {
				if(item.VALUE && (item.FIELDKEY != 'PRESENT_ON_ADMISSION' && item.VALUE != 'no')) {
					retVal.push('<div><b>' + item.LABEL + ': </b>' + item.VALUE + (item.DESCRIPTION ? '. ' + item.DESCRIPTION : '') + '</div>');
				}
			}
		);
		retVal.push('</div>');
		if(objData.FORMDATA.length > 0) {
			retVal.push('<p style="min-height:10px;"></p>');
		}
		
		if (objData.SKINGRID && objData.SKINGRID.length > 0){
			retVal.push('<h3 id="' + PreOPAnAssess.panelId + 'skinAbnormalitiesHdr" class="h3a-marker">Skin abnormalities</h3>'+
				'<table class="sch-dataTable" id="' + PreOPAnAssess.panelId + 'skinAbnormalitiesTable">' +
				'<tr>' + 
					'<th>Location</th>' +
					'<th>Type</th>' +
					'<th>Description</th>' +
				'</tr>'
			);
			objData.SKINGRID.forEach(
				function(item) {
					retVal.push('<tr><td>' + item.LOCATION + '</td>' +
						'<td>' + item.TYPE + '</td>' +
						'<td>' + item.DESCRIPTION + '</td></tr>'
					);
				}
			);
			retVal.push('</table>');
			retVal.push('<p style="min-height:10px;"></p>');
		}
		
		if (objData.DEVELOPMENTAL && objData.DEVELOPMENTAL.length > 0){
			retVal.push('<h3 id="' + PreOPAnAssess.panelId + 'developmentalHdr" class="h3a-marker">Developmental</h3>'+
				'<div id="' + PreOPAnAssess.panelId + 'developmentalSection" class="sch-section" style="border-top:1px solid blue;padding-top:2px;padding-left: 20px;">'
			);
			objData.DEVELOPMENTAL.forEach(
				function(item) {
					if(item.VALUE || (item.LABEL != 'Mobility assistance' && item.VALUE != 'Independent')) {
						retVal.push('<div><b>' + item.LABEL + ': </b>' + (item.VALUE == 'Evidence of impairment' && item.DESCRIPTION != '' ? item.DESCRIPTION : item.VALUE) + '</div>');
					}
				}
			);
			retVal.push('</div>');
			retVal.push('<p style="min-height:10px;"></p>');
		}
		
		if (objData.NUTRITIONAL && objData.NUTRITIONAL.length > 0){
			retVal.push('<h3 id="' + PreOPAnAssess.panelId + 'nutritionalHdr" class="h3a-marker">Nutrition Screen</h3>'+
				'<div id="' + PreOPAnAssess.panelId + 'nutritionalSection" class="sch-section" style="border-top:1px solid blue;padding-top:2px;padding-left: 20px;">'
			);
			objData.NUTRITIONAL.forEach(
				function(item) {
					if(item.VALUE) {
						retVal.push('<div><b>' + item.LABEL + ': </b>' + item.VALUE + '</div>');
					}
				}
			);
			retVal.push('</div>');
			retVal.push('<p style="min-height:10px;"></p>');
		}
		
		if (objData.ELIMINATION && objData.ELIMINATION.length > 0){
			retVal.push('<h3 id="' + PreOPAnAssess.panelId + 'eliminationHdr" class="h3a-marker">Special Elimination</h3>'+
				'<div id="' + PreOPAnAssess.panelId + 'eliminationSection" class="sch-section" style="border-top:1px solid blue;padding-top:2px;padding-left: 20px;">'
			);
			objData.ELIMINATION.forEach(
				function(item) {
					if(item.VALUE) {
						retVal.push('<div><b>' + item.LABEL + ': </b>' + item.VALUE + '</div>');
					}
				}
			);
			retVal.push('</div>');
			retVal.push('<p style="min-height:10px;"></p>');
		}
		
		if ((objData.TUBESGRID && objData.TUBESGRID.length > 0) || (objData.DEVICESGRID && objData.DEVICESGRID.length > 0)){
			retVal.push('<h3 id="' + PreOPAnAssess.panelId + 'tubeGridHdr" class="h3a-marker">Functional</h3>'+
				'<table class="sch-dataTable" id="' + PreOPAnAssess.panelId + 'tubeGridTable"  class="sch-section" style="border-top:1px solid blue;">');
			
			if (objData.TUBESGRID && objData.TUBESGRID.length > 0)  {
				retVal.push('<tr><th>Tube type</th><th>Tube size</th><th>Details</th></tr>');
				objData.TUBESGRID.forEach(
					function(item) {
						retVal.push('<tr><td>' + item.TYPE + '</td>' +
							'<td>' + item.SIZE + '</td>' +
							'<td>' + item.DETAILS + '</td></tr>'
						);
					}
				);
			}
			
			if(objData.DEVICESGRID && objData.DEVICESGRID.length > 0) {
				objData.DEVICESGRID.forEach(
					function(item) {
						retVal.push('<tr><td>' + item.TYPE + '</td>' +
							'<td colspan=2>' + item.DETAILS + '</td></tr>'
						);
					}
				);
			}
			retVal.push('</table>');
		}
        return retVal.join('');
    };
    /**
     * Parent function for processing functions after the UI has been render to the DOM
     *   All css,dom behaviors to be associated with UI components is handled in this function.
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    PreOPAnAssess.ccnsp.processPostCcInstance  = function (aObjNSbase, aObjCcBase) {
		var theData = aObjCcBase.data.PREOP;
		
		//Function to expand/contract future/completed sections
		$('#chla_PreOPAnAssess .h3a-marker').click(function () {
			$(this).toggleClass('collapsed');
			$(this).next().toggle();
			return false;
		});
		
		$("#" + PreOPAnAssess.panelId + "_launch_form_header").click(function(e) {
			//Launch Powerform - variables...
			var chartMode = 0;  //0 = edit 1 = readOnly
			var dPersonId = theData.PERSON_ID;
			var dEncounterId = theData.ENCNTR_ID;
			var formId = 0;
			var activityId = theData.PREOP_DCP_FORMS_ACTIVITY_ID;
			
			var mpObj = window.external.DiscernObjectFactory("POWERFORM");
			mpObj.OpenForm(dPersonId, dEncounterId, formId, activityId, chartMode);
		});
	};

    /**
     *  Call to build CC and to render to CC framework
     */
    PreOPAnAssess.ccnsp.ProcessCtl(PreOPAnAssess.ccnsp,component);
}
chla['PreOPAnSurReady'].prototype.render = function() {
    'use strict';
    var  component = this,
        /**
         * variable to contain working object for cc rendering
         */
        PreOPAnSurReady;
    /**
     *  initialize the variable with the CC Module base class
     */
    PreOPAnSurReady  = chla.eAppsClass.gCcModule.createCcModuleCls.neo();
    /*----------------------------------------------------*/
    /* Replace these functions with this CC specific code.*/
    /*----------------------------------------------------*/
    /**
     * Parent function for processing initialization specifically for the CC
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    PreOPAnSurReady.ccnsp.postInit  = function (aObjNSbase, aObjCcBase) {
		PreOPAnSurReady.valueRendererOther = function (item) {
			var theDisplayLabel = '',
				theDisplayValue = '';
			if(item.FIELDKEY === 'IMPLANTED_DEVICES') {
				if(item.VALUE.toUpperCase() === 'NO IMPLANTED DEVICES') {
					theDisplayLabel = item.LABEL;
				} else {
					theDisplayLabel = '<font color="red">' + item.LABEL + '</font>';
				}
			} else {
				theDisplayLabel = item.LABEL;			
			}
			
			if(item.FIELDKEY === 'POSSESSIONS') {
				theDisplayValue = item.VALUE;
			} else {
				var displayValue = item.VALUE;				
				if(item.FIELDKEY === 'IMPLANTED_DEVICES') {
					if(item.VALUE.toUpperCase() === 'NO IMPLANTED DEVICES') {
						theDisplayValue = item.VALUE;
					} else {
						displayValue = '<font color="red">' + item.VALUE + '</font>';
					}
				}
				theDisplayValue = displayValue;
			}			
			return {
				'FIELDKEY': item.FIELDKEY, 
				'LABEL': theDisplayLabel, 
				'VALUE': theDisplayValue, 
				'FORMSECTION': item.FORMSECTION
			};
		}
		PreOPAnSurReady.valueRendererProc = function (item) {
			var theDisplayValue = '';			
			if(item.VALUE.match(/Yes/i)) {				
				theDisplayValue = '<img class="surg-checklist" src="' + chla.global.imgPath + 'img/green_check_32.png" width="24" style="vertical-align:text-top;">';
			} else if(item.VALUE.match(/No/i)) {
				theDisplayValue = '<img class="surg-checklist" src="' + chla.global.imgPath + 'img/red_x_32.png" width="24" style="vertical-align:text-top;">';
			} else {
				theDisplayValue = item.VALUE;
			}			
			return {
				'FIELDKEY': item.FIELDKEY, 
				'LABEL': item.LABEL, 
				'VALUE': theDisplayValue, 
				'FORMSECTION': item.FORMSECTION
			};
		}
    };
    /**
     * Parent function for processing the JSON data received for display
     * Output of this function will be an object tha contains data items to be used in the presentation construction process.
     *  All data validation and transformations are done in this function
     *
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @param aDtoData {object} Dto object specifically defined by RPTDATA response from CCL request
     * @returns {*} {object} retVal is a CC specifically defined DTO for transferring data to presentation processing
     */
    PreOPAnSurReady.ccnsp.processData = function (aObjNSbase, aObjCcBase,aDtoData) {
        var retVal = {},
			DtoData;
		retVal.encntrPanel = {};
		retVal.npoPanel = {};
		retVal.otherPanelData = [];
		retVal.proceduralPrepData = [];
		//chla.eAppsUtil.Logger.LogError(JSON.stringify(aObjCcBase.data));
		if(aObjCcBase.data && aObjCcBase.data.PREOP_CHECKLIST) {
			DtoData = aObjCcBase.data.PREOP_CHECKLIST;			
			if(DtoData.PREOP_ENCNTR_ERROR === 'TRUE') {
				var theToolTip = '<b>The case number found may not be correct for this encounter - Please review</b> </br>';
				theToolTip += '<b>Case Number:</b> ' + DtoData.PREOP_CASE_NBR + '</br></br>';
				theToolTip += '<b>Current Encounter Account Number:</b> ' + DtoData.CURR_ENCNTR_FIN + '</br>';
				theToolTip += '<b>Surgery Case Account Number:</b> ' + DtoData.SURG_CASE_ENCNTR_FIN + '</br></br>';
				theToolTip += '<b>Primary Procedure:</b> ' + DtoData.PREOP_PRIMARY_PROCEDURE + '</br>';
				theToolTip += '<b>Surgeon:</b> ' + DtoData.PREOP_PROVIDER + '</br>';
				
				retVal.encntrPanel.theHtml = '<span data-qtip="' + theToolTip + '" class="encounter-error">ENCOUNTER REVIEW NEEDED</span><span class="encntr-warn">&nbsp;&nbsp;(This encounter check valid <b>ONLY</b> through day of procedure)</span>';
				retVal.encntrPanel.hidePanel = false;
			} else {
				if(DtoData.PREOP_CASE_NBR !== undefined && DtoData.PREOP_CASE_NBR !== '') {
					retVal.encntrPanel.hidePanel = false;
					retVal.encntrPanel.theHtml = '<span>Case Number:&nbsp;&nbsp;&nbsp;&nbsp;' + DtoData.PREOP_CASE_NBR + '</span>';
				}
			}
			
			if(DtoData.NPO_DATA.length > 0) {
				var theToolTip = '',
					food = false,
					fluid = false,
					milk = false,
					none = false;		
				if(DtoData.NPO_DATA[0].LAST_FOOD_VALUE && DtoData.NPO_DATA[0].LAST_FOOD_VALUE !== '') {
					food = true;
					theToolTip += '<div class="hang30"><span>' + DtoData.NPO_DATA[0].LAST_FOOD_LABEL + (DtoData.NPO_DATA[0].LAST_FOOD_DATE ? " @ " + DtoData.NPO_DATA[0].LAST_FOOD_DATE : '') + ' - ' + DtoData.NPO_DATA[0].LAST_FOOD_VALUE + '</span>';
				}				
				if(DtoData.NPO_DATA[0].LAST_FLUID_VALUE && DtoData.NPO_DATA[0].LAST_FLUID_VALUE !== '') {
					fluid = true;
					if(theToolTip === '') {
						theToolTip = '<div class="hang30"><span>';
					}
					else {
						theToolTip += '</br><span>';
					}
					theToolTip += DtoData.NPO_DATA[0].LAST_FLUID_LABEL + (DtoData.NPO_DATA[0].LAST_FLUID_DATE ? " @ " + DtoData.NPO_DATA[0].LAST_FLUID_DATE : '') + ' - ' + DtoData.NPO_DATA[0].LAST_FLUID_VALUE + '</span>';
				}				
				if(DtoData.NPO_DATA[0].LAST_BREASTMILK_VALUE && DtoData.NPO_DATA[0].LAST_BREASTMILK_VALUE !== '') {
					milk = true;
					if(theToolTip === '') {
						theToolTip = '<div class="hang30"><span>';
					}
					else {
						theToolTip += '</br><span>';
					}
					theToolTip += DtoData.NPO_DATA[0].LAST_BREASTMILK_LABEL + ' - ' + DtoData.NPO_DATA[0].LAST_BREASTMILK_VALUE + '</span>';
				}				
				if(DtoData.NPO_DATA[0].NO_INTAKE_LAST24_VALUE && DtoData.NPO_DATA[0].NO_INTAKE_LAST24_VALUE !== '') {
					none = true;
					if(theToolTip === '') {
						theToolTip = '<div class="hang30"><span>';
					}
					else {
						theToolTip += '</br><span>';
					}
					theToolTip += DtoData.NPO_DATA[0].NO_INTAKE_LAST24_LABEL + ' - ' + DtoData.NPO_DATA[0].NO_INTAKE_LAST24_VALUE + '</span>';
				}
				if(theToolTip !== '') {
					theToolTip = theToolTip + '</div>';
				} else {
					theToolTip = 'NPO';
				}
				retVal.npoPanel.theHtml = theToolTip;
				if((food & fluid) || milk || none) {
					retVal.npoPanel.indicator = '<img class="surg-checklist" src="' + chla.global.imgPath + 'img/green_check_32.png" width="24" style="vertical-align:text-top;">';
				} else {
					retVal.npoPanel.indicator = '<img class="surg-checklist" src="' + chla.global.imgPath + 'img/red_x_32.png" width="24" style="vertical-align:text-top;">';
				}
			} else {
				retVal.npoPanel.theHtml = 'NPO';
				retVal.npoPanel.empty = true;
				retVal.npoPanel.indicator = '<img class="surg-checklist" src="' + chla.global.imgPath + 'img/red_x_32.png" width="24" style="vertical-align:text-top;">';
			}
		
			//combine 3 other data arrays into one
			var thePossessionsValue = '';
			var theSeparator = '';	
			var i = 0;
			for(i = 0; i < DtoData.FORMDATA.length; i++) {
				retVal.otherPanelData.push(PreOPAnSurReady.valueRendererOther(DtoData.FORMDATA[i]));
			}			
			for(i = 0; i < DtoData.PATIENT_PREP_GRID.length; i++) {
				retVal.otherPanelData.push(PreOPAnSurReady.valueRendererOther(DtoData.PATIENT_PREP_GRID[i]));
			}				
			if(DtoData.POSSESSIONS_GRID.length > 0) {
				for(i = 0; i < DtoData.POSSESSIONS_GRID.length; i++) {
					if( i > 0) {
						theSeparator = ', ';
					}
					thePossessionsValue += theSeparator + '<span>' + DtoData.POSSESSIONS_GRID[i].LABEL + '</span>';
				}
				retVal.otherPanelData.push(PreOPAnSurReady.valueRendererOther({
					'FIELDKEY': 'POSSESSIONS', 
					'LABEL': 'Possessions (With Patient)', 
					'VALUE': thePossessionsValue, 
					'FORMSECTION': 'Possessions Grid'
				}));
			}
			
			for(i = 0; i < DtoData.PROCEDURAL_PREP_GRID.length; i++) {//alert(JSON.stringify(DtoData.PROCEDURAL_PREP_GRID));
				retVal.proceduralPrepData.push(PreOPAnSurReady.valueRendererProc(DtoData.PROCEDURAL_PREP_GRID[i]));
			}
		} else {
			return false;
		}
        return retVal;
    };

    /**
     * Parent function for construction of the UI
     * Output of the function will be an object contain a string of the total html to be render for this component
     *   All necessary presentation formation and transformation are done in this function.
     *
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @param aDtoUI {object} aDtoData object
     * @returns {object} retVal is a CC specifically defined DTO for transferring data to presentation rendering processing
     */
    PreOPAnSurReady.ccnsp.processUI   = function (aObjNSbase, aObjCcBase,aDtoUI) {
		var objData = aObjCcBase.eApps.getDataDto(aObjCcBase);	
		if(!objData || (objData.npoPanel.empty && (!objData.encntrPanel || !objData.encntrPanel.theHtml) && objData.otherPanelData.length == 0 && objData.proceduralPrepData.length == 0)) {
			return 'No results found';
		}
        var retVal = [];
		if (objData.encntrPanel && objData.encntrPanel.theHtml) {
			retVal.push('<table style="border-bottom: 2px solid grey;"><tr style="text-align:left;"><td>')
			retVal.push(objData.encntrPanel.theHtml);
			retVal.push('</td></tr></table>');
		}
		if (objData.npoPanel) {
			retVal.push('<table style="width:100%;border-bottom: 2px solid grey;"><tr style="text-align:left;">')
			if(objData.npoPanel.theHtml == 'NPO') {
				retVal.push('<td>' + objData.npoPanel.theHtml);
			} else {
				retVal.push('<td style="width:35px;">' + 'NPO - </td><td>');
				retVal.push(objData.npoPanel.theHtml);
			}
			retVal.push('</td><td style="width:28px;">');
			retVal.push(objData.npoPanel.indicator);
			retVal.push('</td></tr></table>');
		}
		if(objData.otherPanelData && objData.otherPanelData.length > 0) {
			retVal.push('<table style="width:100%;border-bottom: 2px solid grey;">');
			var row = '<tr class="<#=ODD#>" style="text-align:left;">' +
				'<td style="width:50%;"><#=LABEL#></td>' +
				'<td><#=VALUE#></td></tr>';
			objData.otherPanelData.forEach(
				function (value,index) {
					value.ODD = (index % 2 === 1? 'odd':'');
					retVal.push(aObjNSbase.gFuncs.parseTemplate(row, value));
				}
			);
			retVal.push('</table>');
		}
		if(objData.proceduralPrepData && objData.proceduralPrepData.length > 0) { 
			retVal.push('<p style="background-color:grey;color:white;font-weight:800;text-align:center;">Procedural Prep</p>');
			retVal.push('<table style="width:100%;">');
			var row = '<tr class="<#=ODD#>" style="text-align:left;">' +
				'<td style="width:44%;"><#=LABEL1#></td>' +
				'<td style="width:6%;max-width:55px;"><#=VALUE1#></td>' +
				'<td style="width:44%;"><#=LABEL2#></td>' +
				'<td style="width:6%;max-width:55px;"><#=VALUE2#></td></tr>';			
			for(var i = 0; i < objData.proceduralPrepData.length; i++) {
				if(i % 2 === 1 || objData.proceduralPrepData.length == 1) {
					var _value = {};
					_value.LABEL1 = objData.proceduralPrepData[i].LABEL;
					_value.VALUE1 = objData.proceduralPrepData[i].VALUE;
					_value.LABEL2 = (objData.proceduralPrepData[i+1] ? objData.proceduralPrepData[i+1].LABEL : '');
					_value.VALUE2 = (objData.proceduralPrepData[i+1] ? objData.proceduralPrepData[i+1].VALUE : '');
					_value.ODD = (i % 4 === 1 ? 'odd' : '');
					retVal.push(aObjNSbase.gFuncs.parseTemplate(row, _value)); 
				} else {
					continue;
				}
			}
			retVal.push('</table>');
		}
        return retVal.join('');
    };
    /**
     * Parent function for processing functions after the UI has been render to the DOM
     *   All css,dom behaviors to be associated with UI components is handled in this function.
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    PreOPAnSurReady.ccnsp.processPostCcInstance  = function (aObjNSbase, aObjCcBase) {
		chla.eApps.gFuncs.bindFloatingHover('#' + aObjCcBase.eApps.cc_id + ' [data-qtip]', 'body', '', true, '$(this).data("qtip")', '');
	};

    /**
     *  Call to build CC and to render to CC framework
     */
    PreOPAnSurReady.ccnsp.ProcessCtl(PreOPAnSurReady.ccnsp,component);
}
chla['PreOPAnVitals'].prototype.render = function() {
    'use strict';
    var  component = this,
        /**
         * variable to contain working object for cc rendering
         */
        PreOPAnVitals;
    /**
     *  initialize the variable with the CC Module base class
     */
    PreOPAnVitals  = chla.eAppsClass.gCcModule.createCcModuleCls.neo();
    /*----------------------------------------------------*/
    /* Replace these functions with this CC specific code.*/
    /*----------------------------------------------------*/
    /**
     * Parent function for processing initialization specifically for the CC
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    PreOPAnVitals.ccnsp.postInit  = function (aObjNSbase, aObjCcBase) {
 		PreOPAnVitals.panelId = "PreOPAnVitals";
		PreOPAnVitals.TemperatureChart = function() {
			this.inpatientVitals = null;
			this.vitalsPopupWindowPanel = null;
		};
		PreOPAnVitals.HeartChart = function() {
			this.inpatientVitals = null;
			this.hemodynamicsPopupWin = null;
			this.vitalsPopupWindowPanel = null;
		};
		PreOPAnVitals.VitalsChart = function() {
			this.heartChartData = null;
			this.heartCuffChartData = null;
			this.heartArtChartData = null;
			this.heartChart = null;
			this.temperatureChart = null;
		};
		PreOPAnVitals.vitalsChart = new PreOPAnVitals.VitalsChart();
		PreOPAnVitals.vitalsChart.temperatureChart = new PreOPAnVitals.TemperatureChart();
		PreOPAnVitals.vitalsChart.heartChart = new PreOPAnVitals.HeartChart();

		PreOPAnVitals.VitalsPanel = {};
		PreOPAnVitals.VitalsPanel.marginRightDefault = 95;
		PreOPAnVitals.VitalsPanel.marginRight_CICU_HeartRate = 170;
		PreOPAnVitals.VitalsPanel.marginRight_CICU_HeartBP = 100;
		PreOPAnVitals.VitalsPanel.marginRight_CICU_Temp = 170;
		PreOPAnVitals.VitalsPanel.marginRight_CICU_HemoDynamics = 200;
		PreOPAnVitals.VitalsPanel.hemoChartDataExists = false;
		PreOPAnVitals.VitalsPanel.spacingRightDefault = 20;
		PreOPAnVitals.VitalsPanel.spacingRight_CICU_HeartBP = 5;
		PreOPAnVitals.VitalsPanel.spacingRight_CICU_Temp = 95;
		PreOPAnVitals.VitalsPanel.spacingRight_CICU_HemoDynamics = 5;
		PreOPAnVitals.VitalsPanel.spacingRight_CICU_HeartRate = 75;
		PreOPAnVitals.VitalsPanel.marginLeft = 25;
		PreOPAnVitals.VitalsPanel.marginLeftDefault = 25;
		PreOPAnVitals.VitalsPanel.legendWidth = 75;
		PreOPAnVitals.VitalsPanel.sparkCellWidth = 104;
		PreOPAnVitals.VitalsPanel.dispMeasureWidth = 0.42;
		PreOPAnVitals.VitalsPanel.lastValueWidth = 0.21;
		PreOPAnVitals.VitalsPanel.rangeWidth = 0.37;
		PreOPAnVitals.VitalsPanel.showDetailFirst = false;		
		
		PreOPAnVitals.HeartChart = {};		
		
		PreOPAnVitals.ChartSummaryGrid = {};
		
		PreOPAnVitals.VitalsSummaryGrid = {};
		PreOPAnVitals.VitalsSummaryGrid.sparkLineCalled = false;
		
		PreOPAnVitals.HeartPopUpPanel = {};
		
		PreOPAnVitals.LungPopUpPanel = {};
		
		PreOPAnVitals.HemodynamicsChart = {};
		
		PreOPAnVitals.VentCharts = {};
		
		PreOPAnVitals.VentCharts.CreateVentChart = function(chartConfig) {
			var maskYaxisScale = false;
			if (chartConfig.maskYaxisScale !== undefined) {
				maskYaxisScale = chartConfig.maskYaxisScale;
			}
			var leftYaxis_color = '#000000';
			var rightYaxis_color = '#0011ff';
			var yaxis2SeriesCount = 0;
			var yaxis1SeriesCount = 0;
			var renderId = chartConfig.renderId;
			var chartSeries = chartConfig.chartSeries;
			var theSpacingBottom = chartConfig.spacingBottom;
			if (theSpacingBottom === undefined) {
				theSpacingBottom = 15;
			}
			var theChartTitle = chartConfig.chartTitle;
			if (theChartTitle === undefined) {
				theChartTitle = '';
			}
			var yMin0 = chartConfig.yMin0;
			var yMax0 = chartConfig.yMax0;
			var yFixed0 = false;
			if (yMin0 !== null && yMax0 !== null) {
				yFixed0 = true;
			}
			var yAxis0Adjust = chartConfig.yAxis0Adjust;
			var yTickInterval0 = chartConfig.yTickInterval0;
			var yMin1 = chartConfig.yMin1;
			var yMax1 = chartConfig.yMax1;
			var yFixed1 = false;
			if (yMin1 !== null && yMax1 !== null) {
				yFixed1 = true;
			}
			var yAxis1Adjust = chartConfig.yAxis1Adjust;
			var yTickInterval1 = chartConfig.yTickInterval1;
			var yGridLineWidth1 = chartConfig.yGridLineWidth1;
			var yAxisTitle = chartConfig.yAxisTitle;
			var alignTicks = chartConfig.alignTicks;
			var seriesData = [];
			var resultDate;
			var actualResult;
			var result;
			var valueLessMin = false;
			var valueGreaterMax = false;
			var hasLeftYaxis = false;
			var hasRightYaxis = false;
			var leftY_max = 0;
			var rightY_max = 0;
			var today = new Date();
			var firstDate = new Date(today.setDate(today.getDate() - 1));
			var lastDate = 0;

			for (var i = 0; i < chartSeries.length; i++) {
				seriesData.push('');
				var dataArray = [];
				var dataArrayIdx = 0;
				for (var j = 0; j < chartSeries[i].DATA.length; j++) {
					dataArray.push('');
					resultDate = Date.parse(chartSeries[i].DATA[j].X);
					result = parseFloat(chartSeries[i].DATA[j].Y);
					valueLessMin = false;
					valueGreaterMax = false;
					// FOR FIXED AXIS ONLY
					// If value is outside the y axis min or max - reset it to the min
					// or max
					// Chart will display the up or down arrow and the Tooltip will
					// display the actual value

					if (chartSeries[i].YAXIS === 0) {
						if (yFixed0) {
							if (yMin0 !== null) {
								if (result <= yMin0) {
									if (result < yMin0) {
										valueLessMin = true;
									}
									result = yMin0 + (yMin0 * yAxis0Adjust);
								}
							}
							if (yMax0 !== null) {
								if (result >= yMax0) {
									if (result > yMax0) {
										valueGreaterMax = true;
									}
									result = yMax0 - (yMax0 * yAxis0Adjust);
								}
							}
						}
					} else if (chartSeries[i].YAXIS === 1) {
						if (yFixed1) {
							if (yMin1 !== null) {
								if (result <= yMin1) {
									if (result < yMin1) {
										valueLessMin = true;
									}
									result = yMin1 + (yMin1 * yAxis1Adjust);
								}
							}
							if (yMax1 !== null) {
								if (result >= yMax1) {
									if (result > yMax1) {
										valueGreaterMax = true;
									}
									result = yMax1 - (yMax1 * yAxis1Adjust);
								}
							}
						}
					}

					actualResult = chartSeries[i].DATA[j].ACTUAL_Y;

					var legendColor = function() {
						if (chartSeries[i].YAXIS === 1) {
							return rightYaxis_color;
						} else {
							return leftYaxis_color;
						}
					}();

					var markerImage = function() {
						var mask = 'url({0}img/{1})';
						var directory = chla.global.imgPath;
						var returnVal;
						if (isNaN(actualResult)) {
							if (actualResult.search('&lt;') != -1) {
								returnVal = returnVal = chla.eApps.gFuncs.sFormatter(mask, directory, 'under.gif');
							} else if (actualResult.search('&gt;') != -1) {
								returnVal = chla.eApps.gFuncs.sFormatter(mask, directory, 'over.gif');
							}
						} else if (valueGreaterMax) {
							returnVal = chla.eApps.gFuncs.sFormatter(mask, directory, 'over.gif');
						} else if (valueLessMin) {
							returnVal = returnVal = chla.eApps.gFuncs.sFormatter(mask, directory, 'under.gif');
						}
						return returnVal;
					}();

					// save max value for each yaxis on chart (across all series) for
					// axis scale ajustment later
					if (chartSeries[i].YAXIS === 0) {
						if (result > leftY_max) {
							leftY_max = result;
						}
					} else {
						if (result > rightY_max) {
							rightY_max = result;
						}
					}

					dataArray[dataArrayIdx] = {
						x : resultDate,
						y : result,
						actualResult : actualResult,
						unit : chartSeries[i].UNIT,
						marker : {
							symbol : markerImage
						}
					};
					dataArrayIdx = dataArrayIdx + 1;
				}

				var seriesLineWidth = 2;
				var seriesMarker = null;

				if (chartSeries[i].YAXIS === 1) {
					hasRightYaxis = true;
					seriesLineWidth = 3;
					seriesMarker = 'circle';
				} else {
					hasLeftYaxis = true;
					seriesLineWidth = 2;
				}

				seriesData[i] = {
					'type' : chartSeries[i].TYPE,
					'data' : dataArray,
					'yAxis' : chartSeries[i].YAXIS,
					'name' : chartSeries[i].NAME,
					'color' : chartSeries[i].COLOR,
					'legendColor' : legendColor,
					'marker' : {
						'symbol' : seriesMarker
					},
					lineWidth : seriesLineWidth
				};

			}

			if(seriesData.length > 0) {
				var tempDate;
				var tempEndDate;
				var today = new Date();
				tempDate = new Date(today.setDate(today.getDate() -1));
				tempEndDate = new Date();

				var dummySeries = PreOPAnVitals.VitalsPanel.buildDummySeries(0, tempDate, tempEndDate);
				seriesData.push(dummySeries);
			}
			
			var tempPanelHeight = 200; 

			// This is to insure that there is always a left y axis so that charts will
			// line up.
			if (yMax0 === null) {
				if (leftY_max === 0) {
					if (chartConfig.yMaxDefault0 !== undefined) {
						yMax0 = chartConfig.yMaxDefault0;
					}
				} else {
					// Set yMax0 based on max value, to make sure the axis sticks around
					if (yTickInterval0 !== null) {
						yMax0 = (((leftY_max - (leftY_max % yTickInterval0)) / yTickInterval0) + 1)
								* yTickInterval0;
					} else {
						yMax0 = (((leftY_max - (leftY_max % 10)) / 10) + 1) * 10;
					}
				}
			}

			var calculateTickInterval = function(yMax) {
				var tempInterval = 20;
				if(yMax <= 50 ) {
					tempInterval = 10;
				}
				else if (yMax <= 100) {
					tempInterval = 20;
				}
				else if (yMax <= 200) {
					tempInterval = 40;
				}
				else if (yMax <= 400) {
					tempInterval = 50;
				} else {
					tempInterval = 100;
				}
				return tempInterval;
			};
			
			if(yTickInterval0 === null) {
				//highcharts 2.2.1 does not like this, so calculate a tickInterval based on data
				if(yMax0 === null) {
					yMax0 = (((lefyY_max - (leftY_max % 10)) / 10) + 1) * 10;
					yTickInterval0 = calculateTickInterval(yMax0);
				}
				else {
					yTickInterval0 = calculateTickInterval(yMax0);
					
				}
			}
			
			if(yTickInterval1 === null) {
				//highcharts 2.2.1 does not like this, so calculate a tickInterval based on data
				if(yMax1 === null) {
					yMax1 = (((rightY_max - (rightY_max % 10)) / 10) + 1) * 10;
					yTickInterval1 = calculateTickInterval(yMax1);
				}
			}

			var marginRight = 130;
			
			try {
				var ventChart = new Highcharts.Chart({
					chart : {
						alignTicks : alignTicks,
						renderTo : renderId,
						zoomType : 'x',
						borderWidth : 0,
						spacingTop : 22,
						spacingRight : 0,
						spacingLeft : 0,
						height : tempPanelHeight,
						marginRight : marginRight,
						marginLeft : 50,
						spacingBottom : theSpacingBottom,
						// Highcharts 2.2.1 stuff
						resetZoomButton: {
							theme: {
								stroke: 'silver',
								r: 3,
								style : {
									fontSize : '9px'
								}
							},
							position: {
								align: 'right',
								verticalAlign: 'top',
								x: -(9 + marginRight),
								y: 0
							},
							relativeTo: 'chart'
						},
						events : {
							selection : function(event) {

								// must show the button since we hid it when last zoom was off
								if(event.currentTarget.resetZoomButton !== undefined) {
									event.currentTarget.resetZoomButton.show();
								}

								if (event.xAxis === undefined) {
									// user click the Reset Zoom label
									if (VentCharts.ventChart1 !== null && VentCharts.ventChart1 !== undefined) {
										VentCharts.ventChart1.xAxis[0].setExtremes(null, null, true, true);
										try {
											VentCharts.ventChart1.resetZoomButton.hide();
										} catch (e) { }
									}
									if (VentCharts.ventChart2 !== null && VentCharts.ventChart2 !== undefined) {
										VentCharts.ventChart2.xAxis[0].setExtremes(null, null, true, true);
										try {
											VentCharts.ventChart2.resetZoomButton.hide();
										} catch (e) { }
									}
									if (VentCharts.ventChart3 !== null && VentCharts.ventChart3 !== undefined) {
										VentCharts.ventChart3.xAxis[0].setExtremes(null, null, true, true);
										try {
											VentCharts.ventChart3.resetZoomButton.hide();
										} catch (e) { }
									}
									if (VentCharts.ventChart4 !== null && VentCharts.ventChart4 !== undefined) {
										VentCharts.ventChart4.xAxis[0].setExtremes(null, null, true, true);
										try {
											VentCharts.ventChart4.resetZoomButton.hide();
										} catch (e) { }
									}
								} else {
									if (VentCharts.ventChart1 !== null && VentCharts.ventChart1 !== undefined) { VentCharts.ventChart1.xAxis[0].setExtremes( event.xAxis[0].min, event.xAxis[0].max, true, true);
									}
									if (VentCharts.ventChart2 !== null && VentCharts.ventChart2 !== undefined) {
										VentCharts.ventChart2.xAxis[0].setExtremes( event.xAxis[0].min, event.xAxis[0].max, true, true);
									}
									if (VentCharts.ventChart3 !== null && VentCharts.ventChart3 !== undefined) {
										VentCharts.ventChart3.xAxis[0].setExtremes( event.xAxis[0].min, event.xAxis[0].max, true, true);
									}
									if (VentCharts.ventChart4 !== null && VentCharts.ventChart4 !== undefined) {
										VentCharts.ventChart4.xAxis[0].setExtremes( event.xAxis[0].min, event.xAxis[0].max, true, true);
									}
								}
							}
						}
					},
					title : {
						align : 'center',
						text : theChartTitle,
						x : 0,
						verticalAlign : 'bottom',
						y : 20,
						style : {
							fontWeight : 'bold'
						}
					},
					credits : {
						enabled : false
					},
					legend : {
						align : 'right',
						verticalAlign : 'top',
						width : 105,
						symbolWidth : 7,
						symbolPadding : 1,
						x : 5,
						y : 1,
						margin : 3,
						layout : 'vertical',
						floating : false,
						itemStyle : {
							font : '9px tahoma,arial,verdana,sans-serif'
						},
						labelFormatter : function() {
							if (this.yAxis.options.opposite === true) {
								// this is on the right axis
								this.yAxis.options.labels.style.color = this.options.legendColor;
								this.yAxis.options.labels.style.fontWeight = 'bold';
								return '<p style="color:' + rightYaxis_color + ';font-weight:bold;">' + this.name + '</p>';
							} else {
								this.yAxis.options.labels.style.color = this.options.legendColor;
								return '<p style="color:' + leftYaxis_color + '">' + this.name + '</p>';
							}
						},
						borderWidth : 0,
						shadow : false
					},
					plotOptions : {
						line : {
							dataLabels : {
								enabled : false
							},
							enableMouseTracking : true
						},
						series : {
							borderWidth : 0,
							animation : false,
							shadow : false,
							stickyTracking : false,
							lineWidth : 1.5,
							marker : {
								lineColor : null,
								states : {
									hover : {
										fillColor : 'white',
										lineColor : 'black',
										lineWidth : 3
									}
								}
							}
						}
					},
					tooltip : {
						crosshairs : true,
						backgroundColor : "rgba(255,255,255,.90)",
						formatter : function() {
							if(this.series.name === 'dummy') {
								return false;
							} else {
								var toolTipHtml = '<b>' + this.series.name + ':</b>'
									+ this.point.actualResult + ' ' + this.point.unit
									+ '<br/>' + '<b>Date time: </b>'
									+ Highcharts.dateFormat('%m/%d/%y %H:%M', this.x);
								return toolTipHtml;
							}
						}
					},
					xAxis : {
						endOnTick : false,
						startOnTick : false,
						tickInterval : 6 * 3600 * 1000, // 6 hours
						minRange : 3600 * 1000,
						type : 'datetime',
						dateTimeLabelFormats : {
							day : '%H:%M'
						},
						gridLineWidth : 1,
						plotLines : [{
									color : '#aaaaaa',
									width : 2,
									zIndex : 3,
									value : PreOPAnVitals.VitalsPanel.GetPlotLineDate('00:00')
								}],
						labels : {
							style : {
								font : '9px arial, tahoma, helvetica, sans-serif'
							},
							formatter : function() {
								return Highcharts.dateFormat('%m/%d<br/>%H:%M', this.value);
							}
						}
					},
					yAxis : [{
						title : {
							text : yAxisTitle
						},
						lineColor : '#aaaaaa',
						lineWidth : 2,
						opposite : false,
						endOnTick : false,
						startOnTick : true,
						showFirstLabel : true,
						tickInterval : yTickInterval0,
						min : yMin0,
						max : yMax0
					}, {
						title : {
							text : ''
						},
						lineWidth : 2,
						lineColor : '#aaaaaa',
						labels : {
							formatter : function() {
								if (maskYaxisScale) {
									var strValue = this.value.toString();
									if (strValue.indexOf('.') !== -1) {
										if (strValue.indexOf('.') === (strValue.length - 2)) {
											strValue = strValue + '0';
										}
									} else {
										strValue = strValue + '.00';
									}
									return strValue;
								} else {
									return this.value;
								}
							}
						},
						endOnTick : false,
						startOnTick : true,
						showFirstLabel : true,
						tickInterval : yTickInterval1,
						min : yMin1,
						max : yMax1,
						gridLineWidth : yGridLineWidth1,
						opposite : true,
						margin : 5
					}],
					series : seriesData
				});
			}
			catch(err) {
				alert('PTSUM-CHART_FAIL_VENT|' + err);
			}

			$(ventChart.container).dblclick(function(event) {
				if (VentCharts.ventChart1 !== null && VentCharts.ventChart1 !== undefined) {
					VentCharts.ventChart1.xAxis[0].setExtremes(null, null, true, true);
					try {
						VentCharts.ventChart1.resetZoomButton.hide();
					} catch (e) { }
				}

				if (VentCharts.ventChart2 !== null && VentCharts.ventChart2 !== undefined) {
					VentCharts.ventChart2.xAxis[0].setExtremes(null, null, true, true);
					try {
						VentCharts.ventChart2.resetZoomButton.hide();
					} catch (e) { }
				}

				if (VentCharts.ventChart3 !== null && VentCharts.ventChart3 !== undefined) {
					VentCharts.ventChart3.xAxis[0].setExtremes(null, null, true, true);
					try {
						VentCharts.ventChart3.resetZoomButton.hide();
					} catch (e) { }
				}

				if (VentCharts.ventChart4 !== null && VentCharts.ventChart4 !== undefined) {
					VentCharts.ventChart4.xAxis[0].setExtremes(null, null, true, true);
					try {
						VentCharts.ventChart4.resetZoomButton.hide();
					} catch (e) { }
				}

			});

			return ventChart;
		};
		
		PreOPAnVitals.HemodynamicsChart.DrawHemodynamicsChart = function(data) {	
			var combinedHemoData = [];
			var newIdx = 0;
			var theDataRecord,
				theVitalsData = data;
			for(var i = 0; i < theVitalsData.HEMO_HIST_CHART1_SERIES.length; i++) {
				combinedHemoData.push(JSON.parse(JSON.stringify(theVitalsData.HEMO_HIST_CHART1_SERIES[i])));
				newIdx++;
			}
			
			for(var i = 0; i < theVitalsData.HEMO_HIST_CHART2_SERIES.length; i++) {
				combinedHemoData.push(JSON.parse(JSON.stringify(theVitalsData.HEMO_HIST_CHART2_SERIES[i])));
				combinedHemoData[newIdx].YAXIS = combinedHemoData[newIdx].YAXIS + 2;
				newIdx++;
			}

			var hemoChart_CICU = PreOPAnVitals.HemodynamicsChart.CreateChart({
				renderId : PreOPAnVitals.panelId + '_Hemodynamics_CICU_CHARTGOESHERE',
				chartSeries : combinedHemoData,
				maskYaxisScale : true,
				theLegendFont : "10px tahoma,arial,verdana,sans-serif",
				theLabelFont : "9px tahoma,arial,verdana,sans-serif",
				yAxisTitle : '',
				alignTicks : false,
				
				yMin0 : 0.00,
				yMax0 : 1,
				yTickInterval0 : 0.2,
				yAxis0Adjust : 0.05,
				
				yMin1 : 0,
				yMax1 : 100,
				yTickInterval1 : 20,
				yAxis1Adjust : 1,
				yGridLineWidth1 : 1, // set to false if yAxis do not line up
				
				yMin2 : 0.00,
				yMax2 : 10,
				yTickInterval2 : 2,
				yAxis2Adjust : 0.05,
				yGridLineWidth2 : false, // set to false if yAxis do not line up
				
				yMin3 : 0,
				yMax3 : 500,
				yTickInterval3 : 100,
				yAxis3Adjust : 5,
				yGridLineWidth3 : false, // set to false if yAxis do not line up

				//alignTicks : true, // set to false if yAxis do not line up
				chartTitle : ''
			});			
			//return hemoChart_CICU;
		};
		
		PreOPAnVitals.HemodynamicsChart.CreateChart = function(chartConfig) {
			var renderId = chartConfig.renderId;
			var temp = $('#' + renderId);
			var colorYaxis_0 = '#000000';
			var colorYaxis_1 = '#0011ff';
			var colorYaxis_2 = '#006600';
			var colorYaxis_3 = '#cc6600';
			var theLegendFont = '10px tahoma,arial,verdana,sans-serif';
			if (chartConfig.theLegendFont !== undefined) {
				theLegendFont = chartConfig.theLegendFont;
			}
			var theLabelFont = chartConfig.theLabelFont;
			if (theLabelFont === undefined) {
				theLabelFont = '9px arial, tahoma, helvetica, sans-serif';
			}						
			var yAxisTitle = chartConfig.yAxisTitle;
			if (yAxisTitle === undefined) {
				yAxisTitle = '';
			}
			var alignTicks = chartConfig.alignTicks;
			if (alignTicks === undefined) {
				alignTicks = true;
			}
			var yMin0 = chartConfig.yMin0;
			if (yMin0 === undefined) {
				yMin0 = null;
			}
			var yMax0 = chartConfig.yMax0;
			if (yMax0 === undefined) {
				yMax0 = null;
			}
			var yTickInterval0 = chartConfig.yTickInterval0;
			if (yTickInterval0 === undefined) {
				yTickInterval0 = null;
			}
			var yAxis0Adjust = chartConfig.yAxis0Adjust;
			var yMin1 = chartConfig.yMin1;
			if (yMin1 === undefined) {
				yMin1 = null;
			}
			var yMax1 = chartConfig.yMax1;
			if (yMax1 === undefined) {
				yMax1 = null;
			}
			var yTickInterval1 = chartConfig.yTickInterval1;
			if (yTickInterval1 === undefined) {
				yTickInterval1 = null;
			}
			var yAxis1Adjust = chartConfig.yAxis1Adjust;
			var yGridLineWidth1 = chartConfig.yGridLineWidth1;
			if (yGridLineWidth1 === undefined) {
				yGridLineWidth1 = 1;
			}
			var yMin2 = chartConfig.yMin2;
			if (yMin2 === undefined) {
				yMin2 = null;
			}
			var yMax2 = chartConfig.yMax2;
			if (yMax2 === undefined) {
				yMax2 = null;
			}
			var yTickInterval2 = chartConfig.yTickInterval2;
			if (yTickInterval2 === undefined) {
				yTickInterval2 = null;
			}
			var yAxis2Adjust = chartConfig.yAxis2Adjust;
			var yGridLineWidth2 = chartConfig.yGridLineWidth2;
			if (yGridLineWidth2 === undefined) {
				yGridLineWidth2 = 1;
			}
			var yMin3 = chartConfig.yMin3;
			if (yMin3 === undefined) {
				yMin3 = null;
			}
			var yMax3 = chartConfig.yMax3;
			if (yMax3 === undefined) {
				yMax3 = null;
			}
			var yTickInterval3 = chartConfig.yTickInterval3;
			if (yTickInterval3 === undefined) {
				yTickInterval3 = null;
			}
			var yAxis3Adjust = chartConfig.yAxis3Adjust;
			var yGridLineWidth3 = chartConfig.yGridLineWidth3;
			if (yGridLineWidth3 === undefined) {
				yGridLineWidth3 = 1;
			}				
			var chartTitle = chartConfig.chartTitle;
			if (chartTitle === undefined) {
				chartTitle = '';
			}
			var plotBorderWidth = 2;
			if (chartConfig.plotBorderWidth) {
				plotBorderWidth = chartConfig.plotBorderWidth;
			}
			var plotBorderColor = "#000000";
			if (chartConfig.plotBorderColor) {
				plotBorderColor = chartConfig.plotBorderColor;
			}				
			var chartSeries = chartConfig.chartSeries;
			var seriesData = [];
			var resultDate;
			var actualResult;
			var result;
			var valueLessMin = false;
			var valueGreaterMax = false;
			var hasLeftYaxis = false;
			var yAxisCt0 = 0;
			var yAxisCt1 = 0;
			var yAxisCt2 = 0;
			var yAxisCt3 = 0;
			var hasRightYaxis = false;
			
			var today = new Date();
			var firstDate = new Date(today.setDate(today.getDate() - 1));
			var lastDate = 0;

			for (var i = 0; i < chartSeries.length; i++) {
				seriesData.push('');
				var dataArray = [],
					dataArrayIdx = 0;
				for (var j = 0; j < chartSeries[i].DATA.length; j++) {
					dataArray.push('');
					
					resultDate = new Date(chartSeries[i].DATA[j].X);
					result = parseFloat(chartSeries[i].DATA[j].Y);

					valueLessMin = false;
					valueGreaterMax = false;
					// FOR FIXED AXIS ONLY
					// If value is outside the y axis min or max - reset it to the
					// min or max
					// Chart will display the up or down arrow and the Tooltip will
					// display the actual value

					switch(chartSeries[i].YAXIS) {
						case 0:
							if (yMin0 !== null) {
								if (result <= yMin0) {
									if (result < yMin0) {
										valueLessMin = true;
									}
									result = yMin0 + (yMin0 * yAxis0Adjust);
								}
							}
							if (yMax0 !== null) {
								if (result >= yMax0) {
									if (result > yMax0) {
										valueGreaterMax = true;
									}
									result = yMax0 - (yMax0 * yAxis0Adjust);
								}
							}
							break;							
						case 1:
							if (yMin1 !== null) {
								if (result <= yMin1) {
									if (result < yMin1) {
										valueLessMin = true;
									}
									result = yMin1 + (yMin1 * yAxis1Adjust);
								}
							}
							if (yMax1 !== null) {
								if (result >= yMax1) {
									if (result > yMax1) {
										valueGreaterMax = true;
									}
									result = yMax1 - (yMax1 * yAxis1Adjust);
								}
							}
							break;							
						case 2:
							if (yMin2 !== null) {
								if (result <= yMin2) {
									if (result < yMin2) {
										valueLessMin = true;
									}
									result = yMin2 + (yMin2 * yAxis2Adjust);
								}
							}
							if (yMax2 !== null) {
								if (result >= yMax2) {
									if (result > yMax2) {
										valueGreaterMax = true;
									}
									result = yMax2 - (yMax2 * yAxis2Adjust);
								}
							}
							break;							
						case 3:
							if (yMin3 !== null) {
								if (result <= yMin3) {
									if (result < yMin3) {
										valueLessMin = true;
									}
									result = yMin3 + (yMin3 * yAxis3Adjust);
								}
							}
							if (yMax3 !== null) {
								if (result >= yMax3) {
									if (result > yMax3) {
										valueGreaterMax = true;
									}
									result = yMax3 - (yMax3 * yAxis3Adjust);
								}
							}
							break;							
						default:
							break;							
					}

					actualResult = chartSeries[i].DATA[j].ACTUAL_Y;

					var markerImage = function() {
						var mask = 'url({0}img/{1})';
						var directory = chla.global.imgPath;
						var returnVal;
						if (isNaN(actualResult)) {
							if (actualResult.search('&lt;') != -1) {
								returnVal = returnVal = chla.eApps.gFuncs.sFormatter(mask, directory, 'under.gif');
							} else if (actualResult.search('&gt;') != -1) {
								returnVal = chla.eApps.gFuncs.sFormatter(mask, directory, 'over.gif');
							}
						} else if (valueGreaterMax) {
							returnVal = chla.eApps.gFuncs.sFormatter(mask, directory, 'over.gif');
						} else if (valueLessMin) {
							returnVal = returnVal = chla.eApps.gFuncs.sFormatter(mask, directory, 'under.gif');
						}
						return returnVal;
					}();

					dataArray[dataArrayIdx] = {
						x : resultDate,
						y : result,
						unit : chartSeries[i].DATA[j].UNIT,
						orderStatus : chartSeries[i].DATA[j].ORDER_STATUS,
						actualResult : actualResult,
						marker : {
							radius : 3,
							symbol : markerImage
						}
					};
					dataArrayIdx = dataArrayIdx + 1;
				}

				var seriesLineWidth = 2;
				var seriesMarker = null;

				switch(chartSeries[i].YAXIS) {
					case 0:
						hasLeftYaxis = true;
						yAxisCt0++;
						seriesLineWidth = 2;
						break;
					case 1:
						seriesLineWidth = 3;
						yAxisCt1++;
						break;
					case 2:
						hasLeftYaxis = true;
						yAxisCt2++;
						seriesLineWidth = 2;
						break;
					case 3:
						seriesLineWidth = 3;
						yAxisCt3++;
						break;
					default:
						break;
				}

				var seriesColor = function() {
					var yAxis_0_Colors = ['#0011ff', '#0066FF', '#99C2FF', '#95B3D7', '#B8CCE4', '#DBE5F1'];
					var yAxis_1_Colors = ['#336699', '#254061', '#A5A5A5', '#7C8CA0', '#808080'];
					var yAxis_2_Colors = ['#663366', '#993399', '#9966CC', '#CC33FF', '#CC00FF', '#CC66FF', '#CC99FF'];
					var yAxis_3_Colors = ['#003D00', '#009900', '#1F9900', '#33FF00', '#5C993D', '#99FF66'];
					
					var returnVal;
					var prevAxisCt = 0;

					switch(chartSeries[i].YAXIS) {
						case 0:
							returnVal = yAxis_0_Colors[i % yAxis_0_Colors.length];						
							break;						
						case 1:
							prevAxisCt = yAxisCt0;
							returnVal = yAxis_1_Colors[(i - prevAxisCt) % yAxis_1_Colors.length];						
							break;						
						case 2:
							prevAxisCt = yAxisCt0 + yAxisCt1;
							returnVal = yAxis_2_Colors[(i - prevAxisCt) % yAxis_2_Colors.length];						
							break;						
						case 3:
							prevAxisCt = yAxisCt0 + yAxisCt2 + yAxisCt3;
							returnVal = yAxis_3_Colors[(i - prevAxisCt) % yAxis_3_Colors.length];
							break;
						default:
							break;
					}
					return returnVal;
				}();

				seriesData[i] = {
					'type' : chartSeries[i].TYPE,
					'data' : dataArray,
					'yAxis' : chartSeries[i].YAXIS,
					'name' : chartSeries[i].NAME,
					'curVal' : chartSeries[i].DATA[chartSeries[i].DATA.length - 1].ACTUAL_Y,
					'color' : seriesColor,
					'marker' : {
						radius : 3,
						'symbol' : seriesMarker
					},
					lineWidth : seriesLineWidth
				};
			}

			var legendYOffset = 1;
			if(seriesData.length > 5) {
				legendYOffset = -15;
			}
			
			if(seriesData.length > 0) {
				var tempDate;
				var tempEndDate;
				var today = new Date();
				tempDate = new Date(today.setDate(today.getDate() - 1));
				tempEndDate = new Date();

				var dummySeries = PreOPAnVitals.VitalsPanel.buildDummySeries(0, tempDate, tempEndDate);
				seriesData.push(dummySeries);
			}
		
			var fontType = 'normal';
			var marginRight = 250;
			
			// Get the height & width from the containing panel
			var chartHeight = 420;
			var chartWidth = 750;

			var seriesIdx = 0;
			var yAxis_0_exists = false;
			var yAxis_1_exists = false;
			var yAxis_2_exists = false;
			var yAxis_3_exists = false;
			for(var i = 0; i < seriesData.length; i++) {
				if(seriesData[i].showInLegend === false) {
					// set this to skip past any initial hidden series so legend clicks will work
					seriesIdx++;
				} else {
					seriesData[i].seriesIdx = seriesIdx;
					seriesIdx++;
					switch(seriesData[i].yAxis) {
						case 0:
							yAxis_0_exists = true;
							break;
						case 1:
							yAxis_1_exists = true;
							break;						
						case 2:
							yAxis_2_exists = true;
							break;						
						case 3:
							yAxis_3_exists = true;
							break;						
						default:
							yAxis_0_exists = true;
							break;
					}
				}
			}
			var _yAxis = [];
			_yAxis.push({
				lineWidth : 1,
				endOnTick : false,
				startOnTick : true,
				showFirstLabel : true,
				min : yMin0,
				max : yMax0,
				tickInterval : yTickInterval0,
				labels : {
					enabled : true,
					style : {
						font : theLabelFont,
						color : colorYaxis_0,
						fontWeight : 'normal'
					}
				},
				opposite : false,
				title : {
					enabled : false
				}
			});
			if(yAxis_1_exists || yAxis_2_exists || yAxis_3_exists) {
				_yAxis.push({
					lineWidth : 1,
					endOnTick : true,
					startOnTick : false,
					showFirstLabel : true,
					min : yMin1,
					max : yMax1,
					tickInterval : yTickInterval1,
					gridLineWidth : yGridLineWidth1,
					labels : {
						enabled : yAxis_1_exists,
						style : {
							font : theLabelFont,
							color : colorYaxis_1,
							fontWeight : 'bold'
						}
					},
					opposite : true,
					title : {
						text : ''
					}
				});
			}
			if(yAxis_2_exists || yAxis_3_exists) {
				_yAxis.push({
					lineWidth : 1,
					endOnTick : false,
					startOnTick : true,
					showFirstLabel : true,
					min : yMin2,
					max : yMax2,
					tickInterval : yTickInterval2,
					gridLineWidth : yGridLineWidth2,
					labels : {
						enabled : yAxis_2_exists,
						style : {
							font : theLabelFont,
							color : colorYaxis_2,
							fontWeight : 'bold'
						}
					},
					opposite : false,
					title : {
						enabled : false
					}
				});
			}
			if(yAxis_3_exists) {
				_yAxis.push({
					lineWidth : 1,
					endOnTick : false,
					startOnTick : true,
					showFirstLabel : true,
					min : yMin3,
					max : yMax3,
					tickInterval : yTickInterval3,
					gridLineWidth : yGridLineWidth3,
					labels : {
						enabled : yAxis_3_exists,
						style : {
							font : theLabelFont,
							color : colorYaxis_3,
							fontWeight : 'bold'
						}
					},
					opposite : true,
					title : {
						enabled : false
					}
				});
			}
			try {	
				var hemoChart = new Highcharts.Chart({
					chart : {
						alignTicks : alignTicks,
						renderTo : renderId,
						zoomType : 'x',
						borderWidth : 0,
						spacingTop : 10,
						spacingRight : PreOPAnVitals.VitalsPanel.spacingRight_CICU_HemoDynamics,
						spacingBottom : 8,
						spacingLeft : 20,
						height : chartHeight,
						width : chartWidth,
						marginRight : PreOPAnVitals.VitalsPanel.marginRight_CICU_HemoDynamics,
						marginLeft : PreOPAnVitals.VitalsPanel.marginLeft + (yAxis_2_exists ? 15 : 0),
						plotBorderWidth : plotBorderWidth,
						plotBackgroundColor : '#fff',
						plotBorderColor : plotBorderColor,
						// Highcharts 2.2.1 stuff
						resetZoomButton: {
							theme: {
								stroke: 'silver',
								r: 3,
								style : {
									fontSize : '8px'
								}
							},
							position: {
								align: 'right',
								verticalAlign: 'top',
								x: -(9 + PreOPAnVitals.VitalsPanel.marginRight_CICU_HemoDynamics),
								y: 0
							},
							relativeTo: 'chart'
						},
						events : {
							selection : function(event) {
								//PreOPAnVitals.VitalsPanel.shared_select_eventHandler(event, 'child_' + Child.GlobalDomIds.CICU_VITALS_ID);
							}
						}
					},
					credits : {
						enabled : false
					},
					title : {
						text : '',
						y : 16
					},
					legend : {
						align : 'right',
						verticalAlign : 'top',
						width : 170,
						symbolWidth : 7,
						symbolPadding : 1,
						x : 5,
						y : legendYOffset,
						margin : 3,
						layout : 'vertical',
						floating : false,
						itemHiddenStyle : {
							color : '#DDDDDD'
						},
						itemStyle : {
							font : theLegendFont,
							fontWeight : 'normal'
						},
						useHTML : true,
						labelFormatter : function() {
							var theLegend = '';
							var legendIdx = this.userOptions.seriesIdx;

							if(this.options.data[0].orderStatus === "DC'd") {
								theLegend = '<span id="' + renderId + '_legend_id_' + legendIdx + '" class="' + 'legend_class_' + this.yAxis.options.index + '">' + this.name + ' (' + this.options.data[0].orderStatus + ')</span>';
							} else {
								theLegend = '<span id="' + renderId + '_legend_id_' + legendIdx + '" class="' + 'legend_class_' + this.yAxis.options.index + '">' + this.name + ' (' + this.options.curVal + ' ' + this.options.data[0].unit + ')</span>';
							}
							legendIdx++;							
							return theLegend;
						},
						borderWidth : 0,
						shadow : false
					},
					plotOptions : {
						line : {
							dataLabels : {
								enabled : false
							},
							enableMouseTracking : true,
							step : 'left'
						},
						series : {
							borderWidth : 0,
							animation : false,
							shadow : false,
							stickyTracking : false,
							lineWidth : 1.5,
							events : {
								legendItemClick : function(event) {
									var theId = renderId + '_legend_id_' + event.target.index;
									var legendEl = $('#' + theId);
									var aSeriesIsVisible = false;
									
									if(legendEl) {
										var theLegendLabel = legendEl.html();								
										var theLegendClass = 'legend_class_' + this.yAxis.options.index;
								
										if(event.target.visible) {
											event.currentTarget.hide();
											for(i = 0; i < event.currentTarget.yAxis.series.length; i++) {
												if(event.currentTarget.yAxis.series[i].visible) {
													if(event.currentTarget.yAxis.series[i].name !== 'dummy') {
														// ignore dummy series used to force xAxis (datetime)
														aSeriesIsVisible = true;
													}
												}
											}
											if(aSeriesIsVisible === false) {
												event.currentTarget.yAxis.labelGroup.hide();
											}
											//legendEl.dom.className = 'legend-hidden-class';
										} else {
											event.currentTarget.show();
											event.currentTarget.yAxis.labelGroup.show();
											//legendEl.dom.className = theLegendClass;
										}
									}
									return false;							
								}
							},
							marker : {
								radius : 3,
								lineColor : null,
								states : {
									hover : {
										fillColor : 'white',
										lineColor : 'black',
										lineWidth : 3
									}
								}
							}
						}
					},
					tooltip : {
						crosshairs : true,
						backgroundColor : "rgba(255,255,255,.90)",
						formatter : function() {
							if(this.series.name === 'dummy') {
								return false;
							} else {
								var toolTipHtml = '<b>' + this.series.name + ':</b>'
									+ this.point.actualResult + ' ' + this.point.unit
									+ '<br/>'
									+ '<b>Date time: </b>'
									+ Highcharts.dateFormat('%m/%d/%y %H:%M', this.x);			
								return toolTipHtml;
							}
						}
					},
					xAxis : [{
						endOnTick : false,
						startOnTick : false,
						maxPadding : 0.05,
						minPadding : 0.05,
						tickInterval : 6 * 3600 * 1000, // 6 hours
						minRange : 3600 * 1000,
		//				maxZoom : 3600 * 1000,
						type : 'datetime',
						dateTimeLabelFormats : {
							day : '%H:%M'
						},
						gridLineWidth : 1,
						plotLines : [{
									color : '#aaaaaa',
									width : 2,
									zIndex : 3,
									value : PreOPAnVitals.VitalsPanel.GetPlotLineDate('00:00')
								}],
						labels : {
							enabled : true,
							style : {
								font : theLabelFont
							},
							formatter : function() {
		//						return Highcharts.dateFormat('%H:%M', this.value);
								return Highcharts.dateFormat('%m/%d<br/>%H:%M', this.value);
							}
						}
					}],
					yAxis : _yAxis,
					series : seriesData
				});
			}
			catch(err) {
	  			alert('PTSUM-CHART_FAIL_HEMO_ICU|' + err);
				//Child.LoadData.LogCcl('PTSUM-CHART_FAIL_HEMO_ICU|' + err);
			}
		};
		
 		PreOPAnVitals.LungPopUpPanel.buildPanel = function(vitalsData) {
			var ventPopupTitle = '',	
				hdrCol1 = '30%',
				hdrCol2 = '65%',
				hdrCol3 = '5%',
				detCol1 = '43%',
				detCol2 = '18%',
				detCol3 = '1%',
				detCol4 = '31%',
				detCol4a = '12%',
				detCol4b = '21%',
				detCol5 = '5%',
				trClass = '';
			
			var getRowClass = function() {
				if(trClass === '') {
					trClass = 'rNorm';
				} else if(trClass === 'rAlt') {
					trClass = 'rNorm';
				} else {
					trClass = 'rAlt';
				}
				return trClass;
			};
	
			var BuildBloodGasDisplay = function(ventTemplate, ventObj) {	
				ventTemplate.push('<TR><TD class="lite-blue-row" style="text-align:right;width:30%">Last Blood Gas&nbsp;</TD><TD style="text-align:left;width:auto">&nbsp;' + ventObj.LASTBLOODGAS + '</TD><TD>&nbsp;</TD><TD style="text-align:left;width:1%">&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:5%">&nbsp;&nbsp;</TD></TR>');
				ventTemplate.push('<TR><TD class="lite-blue-row" style="text-align:right;width:30%">&nbsp;</TD><TD style="text-align:left;width:auto">&nbsp;' + ventObj.LASTBLOODGAS_DATE + '</TD><TD>&nbsp;</TD><TD style="text-align:left;width:30%">&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:5%">&nbsp;&nbsp;</TD></TR>');
				ventTemplate.push('<TR class="lite-blue-row" style="width:100%"><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD></TR>');	
				return ventTemplate;	
			};
			
			var ventTemplate = [];
			if (vitalsData.VITALS_VENT_DATA.length > 0) {
				switch(vitalsData.VITALS_VENT_DATA[0].MODE) {
					case 'highfrequecy':
						vitalsData.VITALS_VENT_DATA.forEach(function(item) {
							ventTemplate.push('<DIV id="TESTTHIS">');
							item.VENT_DETAILS.forEach(function(vent) {
								ventTemplate.push('<TABLE cellspacing="0" cellpadding="0" border="0" style="border-spacing:0px;width:100%">');
								ventTemplate.push('<TR class="lite-blue-row" style="width:100%"><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD></TR>');
								if(vent.VENTILATORMODEL) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + hdrCol1 + '">Ventilator&nbsp;</TD><TD style="text-align:left;width:auto"><B>&nbsp;' + vent.VENTILATORMODEL + '</B></TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:' + hdrCol3 + '">&nbsp;&nbsp;</TD></TR>');
								}
								if(vent.VENTILATORMODE) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + hdrCol1 + '">Mode&nbsp;</TD><TD style="text-align:left;width:auto"><B>&nbsp;' + vent.VENTILATORMODE + '</B></TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:' + hdrCol3 + '">&nbsp;&nbsp;</TD></TR>');
								}
								if(vent.BREATHTYPE) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + hdrCol1 + '">Breath Type&nbsp;</TD><TD style="text-align:left;width:auto"><B>&nbsp;' + vent.BREATHTYPE + '</B></TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:' + hdrCol3 + '">&nbsp;&nbsp;</TD></TR>');
								}
								ventTemplate.push('<TR class="lite-blue-row" style="width:100%"><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD></TR>');
								ventTemplate.push('</TABLE>');
											
								ventTemplate.push('<TABLE cellspacing="0" cellpadding="0" border="0" style="border-spacing:0px;width:100%">');
								if(vent.MAPMEANAIRWAYPRESSURE) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">MAP&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.MAPMEANAIRWAYPRESSURE + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4 + '">' + vent.MAPMEANAIRWAYPRESSURE_UNIT + '</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
								}
								if(vent.OSCILLATORYAMP) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">Amplitude&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.OSCILLATORYAMP + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4 + '">' + vent.OSCILLATORYAMP_UNIT + '</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
								}
								if(vent.OSCILLATORYFREQ) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">Hz&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.OSCILLATORYFREQ + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4 + '">' + vent.OSCILLATORYFREQ_UNIT + '</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
								}
								if(vent.FIO2) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">FiO2&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.FIO2 + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4 + '">' + vent.FIO2_UNIT + '</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
								}
								if(vent.SUPPOXYGENFIO2) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">FiO2&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.SUPPOXYGENFIO2 + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4 + '">%</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
								}
								if(vent.INSPIRATORYTIMEPERCENT) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">Inspiratory Time&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.INSPIRATORYTIMEPERCENT + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4 + '">' + vent.INSPIRATORYTIMEPERCENT_UNIT + '</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
								}
								if(vent.NITRICOXIDE) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">iNO&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.NITRICOXIDE + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4 + '">' + vent.NITRICOXIDE_UNIT + '</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
								}
								if(vent.SPO2 && vent.SPO2 !== undefined) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">SPO2&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.SPO2 + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4 + '">' + vent.SPO2_UNIT + '</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
								}
								if(vent.ETCO2 && vent.ETCO2 !== undefined) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">ETCO2&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.ETCO2 + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4 + '">' + vent.ETCO2_UNIT + '</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
								}
								ventTemplate.push('</TABLE>');
					
								ventTemplate.push('<TABLE cellspacing="0" cellpadding="0" border="0" style="border-spacing:0px;width:100%">');
								ventTemplate.push('<TR class="lite-blue-row" style="width:100%"><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD></TR>');
					
								if(vent.LASTBLOODGAS) {
									ventTemplate = BuildBloodGasDisplay(ventTemplate, vent);
								}
					
								ventTemplate.push('</TABLE>');
								ventTemplate.push('</DIV>');
							});
							ventTemplate.push('</DIV>');
						});
						break;
					case 'conventional':
						vitalsData.VITALS_VENT_DATA.forEach(function(item) {
							ventTemplate.push('');	
							ventTemplate.push('<DIV id="TESTTHIS">');
							
							item.VENT_DETAILS.forEach(function(vent) {
								ventTemplate.push('<TABLE cellspacing="0" cellpadding="0" border="0" style="border-spacing:0px;width:100%;">');
								ventTemplate.push('<TR class="lite-blue-row" style="width:100%;"><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD></TR>');
								if(vent.VENTILATORMODEL) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD class="lite-blue-row" style="text-align:right;width:' + hdrCol1 + '">Ventilator&nbsp;</TD><TD style="text-align:left;width:auto"><B>&nbsp;' + vent.VENTILATORMODEL + '</B></TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:' + hdrCol3 + '">&nbsp;&nbsp;</TD></TR>');
								}
								if(vent.VENTILATORMODE) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD class="lite-blue-row" style="text-align:right;width:' + hdrCol1 + '">Mode&nbsp;</TD><TD style="text-align:left;width:auto"><B>&nbsp;' + vent.VENTILATORMODE + '</B></TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:' + hdrCol3 + '">&nbsp;&nbsp;</TD></TR>');
								}
								if(vent.BREATHTYPE) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD class="lite-blue-row" style="text-align:right;width:' + hdrCol1 + '">Breath Type&nbsp;</TD><TD style="text-align:left;width:auto"><B>&nbsp;' + vent.BREATHTYPE + '</B></TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:' + hdrCol3 + '">&nbsp;&nbsp;</TD></TR>');
								}
								ventTemplate.push('<TR class="lite-blue-row" style="width:100%"><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD></TR>');
								ventTemplate.push('</TABLE>');
											
								ventTemplate.push('<TABLE cellspacing="0" cellpadding="0" border="0" style="border-spacing:0px;width:100%">');
								if(vent.RATESETTINGMANDITORY) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">Rate&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.RATESETTINGMANDITORY + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4a + '">' + vent.RATESETTINGMANDITORY_UNIT + '</TD><TD style="text-align:left;width:' + detCol4b + '">&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
								}
								var addColor = '';
								if(vent.TIDALVOLUMEPERKG) {
									var tidalVol = vent.TIDALVOLUMEPERKG;
									tidalVol = tidalVol.replace(" mL/kg", '');
									tidalVol = tidalVol.replace("(","");
									tidalVol = tidalVol.replace(")","");
									var tidalVolNum = Number(tidalVol);
									if(tidalVolNum > 10) {
										addColor = ';color:red';
									}
								}
								if(vent.TIDALVOLUMEEXHALED || vent.TIDALVOLUMEPERKG) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">Tidal Volume, Exhaled&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.TIDALVOLUMEEXHALED + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4a + '">' + vent.TIDALVOLUMEEXHALED_UNIT + '</TD><TD style="text-align:left;width:' + detCol4b + addColor + '">&nbsp;' + vent.TIDALVOLUMEPERKG + (vent.TIDALVOLUMEPERKG ? ' mL/kg' : '') + '</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
								}
								if(vent.INSPIRATORYPRESSURE) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">Insp Pressure(SET)&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.INSPIRATORYPRESSURE + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4a + '">' + vent.PEEP_UNIT + '</TD><TD style="text-align:left;width:' + detCol4b + '">&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
								}
								if(vent.PIPPEAKINSPIRATORYPRESSURE) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">Insp Pressure(Measured)&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.PIPPEAKINSPIRATORYPRESSURE + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4a + '">' + vent.PEEP_UNIT + '</TD><TD style="text-align:left;width:' + detCol4b + '">&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
								}
								if(vent.PEEP) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">PEEP&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.PEEP + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4a + '">' + vent.PEEP_UNIT + '</TD><TD style="text-align:left;width:' + detCol4b + '">&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
								}
								if(vent.CPAPCONTAIRWAYPRESSURE) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">CPAP&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.CPAPCONTAIRWAYPRESSURE + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4a + '">' + vent.CPAPCONTAIRWAYPRESSURE_UNIT + '</TD><TD style="text-align:left;width:' + detCol4b + '">&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
								}
								if(vent.PRESSURESUPPORT) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">Pressure Support&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.PRESSURESUPPORT + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4a + '">' + vent.PRESSURESUPPORT_UNIT + '</TD><TD style="text-align:left;width:' + detCol4b + '">&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
								}
								if(vent.FIO2) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">FiO2&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.FIO2 + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4a + '">' + vent.FIO2_UNIT + '</TD><TD style="text-align:left;width:' + detCol4b + '">&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
								}
								if(vent.SUPPOXYGENFIO2) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">FiO2&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.SUPPOXYGENFIO2 + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4a + '">%</TD><TD style="text-align:left;width:' + detCol4b + '">&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
								}
								if(vent.IEINSPIRATORYRATION) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">I/E ratio&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.IEINSPIRATORYRATION + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4a + '">' + vent.IEINSPIRATORYRATION_UNIT + '</TD><TD style="text-align:left;width:' + detCol4b + '">&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
								}
								if(vent.NITRICOXIDE) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">iNO&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.NITRICOXIDE + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4a + '">' + vent.NITRICOXIDE_UNIT + '</TD><TD style="text-align:left;width:' + detCol4b + '">&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
								}
								if(vent.SPO2 && vent.SPO2 !== undefined) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">SPO2&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.SPO2 + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4a + '">' + vent.SPO2_UNIT + '</TD><TD style="text-align:left;width:' + detCol4b + '">&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
								}
								if(vent.ETCO2 && vent.ETCO2 !== undefined) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">ETCO2&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.ETCO2 + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4a + '">' + vent.ETCO2_UNIT + '</TD><TD style="text-align:left;width:' + detCol4b + '">&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
								}
								ventTemplate.push('</TABLE>');
					
								ventTemplate.push('<TABLE cellspacing="0" cellpadding="0" border="0" style="border-spacing:0px;width:100%">');
								ventTemplate.push('<TR class="lite-blue-row" style="width:100%"><TD style="width:1%"><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD></TR>');
					
								if(vent.LASTBLOODGAS) {
									ventTemplate = BuildBloodGasDisplay(ventTemplate, vent);
								}
								ventTemplate.push('</TABLE>');
								
								//Ventilator Model- Start
								ventTemplate.push('<TABLE cellspacing="0" cellpadding="0" border="0" style="border-spacing:0px;width:100%">');
								if(vent.JETVENTILATORMODEL) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + hdrCol1 + '">Ventilator&nbsp;</TD><TD style="text-align:left;width:' + hdrCol2 + '"><B>&nbsp;' + vent.JETVENTILATORMODEL + '</B></TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:' + hdrCol3 + '">&nbsp;&nbsp;</TD></TR>');
								}
								ventTemplate.push('<TR class="lite-blue-row" style="width:100%"><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD></TR>');
								ventTemplate.push('</TABLE>');
								//Ventilator Model- End
								
								//High Frequency Jet Ventilator Settings - Start
								ventTemplate.push('<TABLE cellspacing="0" cellpadding="0" border="0" style="border-spacing:0px;width:100%">');
								if(vent.JETINSPIRATORYPRESSURE) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">Jet Insp Pressure&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.JETINSPIRATORYPRESSURE + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4a + '">' + vent.JETINSPIRATORYPRESSURE_UNIT + '</TD><TD style="text-align:left;width:' + detCol4b + '">&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
								}
								if(vent.JETRATESETTING) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">Jet Rate Setting&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.JETRATESETTING + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4a + '">' + vent.JETRATESETTING_UNIT + '</TD><TD style="text-align:left;width:' + detCol4b + '">&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
								}
								if(vent.JETINSPIRATORYTIME) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">Jet Insp Time&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.JETINSPIRATORYTIME + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4a + '">' + vent.JETINSPIRATORYTIME_UNIT + '</TD><TD style="text-align:left;width:' + detCol4b + '">&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
								}
								if(vent.JETPEEP) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">Jet PEEP&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.JETPEEP + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4a + '">' + vent.JETPEEP_UNIT + '</TD><TD style="text-align:left;width:' + detCol4b + '">&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
								}
								if(vent.JETIE) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">Jet I:E&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.JETIE + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4a + '"></TD><TD style="text-align:left;width:' + detCol4b + '">&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
								}
								if(vent.JETPIP) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">Jet PIP&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.JETPIP + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4a + '">' + vent.JETPIP_UNIT + '</TD><TD style="text-align:left;width:' + detCol4b + '">&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
								}
								if(vent.JETDELTAP) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">Jet Delta P&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.JETDELTAP + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4a + '">' + vent.JETDELTAP_UNIT + '</TD><TD style="text-align:left;width:' + detCol4b + '">&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
								}
								if(vent.JETSERVOPRESSURE) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">Jet Servo Pressure&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.JETSERVOPRESSURE + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4a + '">' + vent.JETSERVOPRESSURE_UNIT + '</TD><TD style="text-align:left;width:' + detCol4b + '">&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
								}
								ventTemplate.push('</TABLE>');
								//High Frequency Jet Ventilator Settings - End
							});
							ventTemplate.push('</DIV>');
						});
						break;
					case 'noninvasive':
						vitalsData.VITALS_VENT_DATA.forEach(function(item) {
							ventTemplate.push('');	
							ventTemplate.push('<DIV id="TESTTHIS">');
							
							item.VENT_DETAILS.forEach(function(vent) {
								ventTemplate.push('<TABLE cellspacing="0" cellpadding="0" border="0" style="border-spacing:0px;width:100%">');
								ventTemplate.push('<TR class="lite-blue-row" style="width:100%"><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD></TR>');
								if(vent.EXTUBATION_STATUS !== 'EXTUBATED') {
									if(vent.VENTILATORMODE === 'BiPAP (Bilevel Positive Airway Pressure Ventilation)' || vent.VENTILATORMODE === 'CPAP (Continuous Positive Airway Pressure)') {
										if (vent.VENTILATORMODEL) {
											ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + hdrCol1 + '">Ventilator&nbsp;</TD><TD style="text-align:left;width: auto"><B>&nbsp;' + vent.VENTILATORMODEL + '</B></TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:' + hdrCol3 + '">&nbsp;&nbsp;</TD></TR>');
										}
										if(vent.VENTILATORMODE) {
											ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + hdrCol1 + '">Mode&nbsp;</TD><TD style="text-align:left;width:auto"><B>&nbsp;' + vent.VENTILATORMODE + '</B></TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:' + hdrCol3 + '">&nbsp;&nbsp;</TD></TR>');
										}
									}
									else {
										if (vent.BIPAP_CPAPMACHINEMODEL) {
											ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + hdrCol1 + '">Ventilator&nbsp;</TD><TD style="text-align:left;width: auto"><B>&nbsp;' + vent.BIPAP_CPAPMACHINEMODEL + '</B></TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:' + hdrCol3 + '">&nbsp;&nbsp;</TD></TR>');
										}
										if(vent.BIPAP_CPAPMODE) {
											ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + hdrCol1 + '">Mode&nbsp;</TD><TD style="text-align:left;width:auto"><B>&nbsp;' + vent.BIPAP_CPAPMODE + '</B></TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:' + hdrCol3 + '">&nbsp;&nbsp;</TD></TR>');
										}
									}
								}
								if(vent.MASKDELIVERYTYPE) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + hdrCol1 + '">Mask/Delivery Type&nbsp;</TD><TD style="text-align:left;width:auto"><B>&nbsp;' + vent.MASKDELIVERYTYPE + '</B></TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:' + hdrCol3 + '">&nbsp;&nbsp;</TD></TR>');
								}
								ventTemplate.push('<TR class="lite-blue-row" style="width:100%"><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD></TR>');
								ventTemplate.push('</TABLE>');
											
								ventTemplate.push('<TABLE cellspacing="0" cellpadding="0" border="0" style="border-spacing:0px;width:100%">');
								if(vent.EXTUBATION_STATUS !== 'EXTUBATED') {
									if(vent.RATESETTINGMANDITORY) {
										ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">Rate&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.RATESETTINGMANDITORY + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4 + '">' + vent.RATESETTINGMANDITORY_UNIT + '</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
									}
									//IPAP(SET) is read as Inspiratory Pressure(SET)	
									if(vent.PIP_SET)  {
										ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">Insp Pressure(SET)&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.PIP_SET + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4 + '">' + vent.PIPPEAKINSPIRATORYPRESSURE_UNIT + '</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
									}
									//IPAP(Measured) is read as Inspiratory Pressure(Meassured)
									if(vent.IPAPINSPIRATORYPRESSURE) {
										ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">Insp Pressure(Measured)&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.IPAPINSPIRATORYPRESSURE + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4 + '">' + vent.IPAPINSPIRATORYPRESSURE_UNIT + '</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
									}
									//Staff are charting the IPAP as Inspiratory Pressure
									if(vent.IPAPINSPIRATORYPRESSURE === '' && vent.INSPIRATORYPRESSURE) {
										ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">Insp Pressure(Measured)&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.INSPIRATORYPRESSURE + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4 + '">' + vent.INSPIRATORYPRESSURE_UNIT + '</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
									}								
									if(vent.EPAPEXPIRATORYPRESSURE) {
										ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">EPAP&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.EPAPEXPIRATORYPRESSURE + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4 + '">' + vent.EPAPEXPIRATORYPRESSURE_UNIT + '</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
									}
									if(vent.EPAPEXPIRATORYPRESSURE === '' && vent.PEEP) {
										ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">EPAP&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.PEEP + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4 + '">' + vent.PEEP_UNIT + '</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
									}
									if(vent.CPAPCONTAIRWAYPRESSURE) {
										ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">CPAP&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.CPAPCONTAIRWAYPRESSURE + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4 + '">' + vent.CPAPCONTAIRWAYPRESSURE_UNIT + '</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
									}
									if(vent.FIO2) {
										ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">FiO2&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.FIO2 + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4 + '">' + vent.FIO2_UNIT + '</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
									}
									if(vent.SUPPOXYGENFIO2) {
										ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">FiO2&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.SUPPOXYGENFIO2 + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4 + '">%</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
									}
								}
								if(vent.NITRICOXIDE) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">iNO&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.NITRICOXIDE + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4 + '">' + vent.NITRICOXIDE_UNIT + '</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
								}
								//if(Child.NavigationPanelFactory.currentLocation !== Child.NavigationPanelFactory.LOCATIONS.CICU_PROBLEMS_AND_TREATMENTS) {
									if(vent.SPO2 && vent.SPO2 !== undefined) {
										ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">SPO2&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.SPO2 + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4 + '">' + vent.SPO2_UNIT + '</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
									}
									if(vent.ETCO2 && vent.ETCO2 !== undefined) {
										ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">ETCO2&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.ETCO2 + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4 + '">' + vent.ETCO2_UNIT + '</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
									}
								//
								ventTemplate.push('</TABLE>');
					
								ventTemplate.push('<TABLE cellspacing="0" cellpadding="0" border="0" style="border-spacing:0px;width:100%">');
								ventTemplate.push('<TR class="lite-blue-row" style="width:100%"><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD></TR>');
					
								if(vent.LASTBLOODGAS) {
									ventTemplate = BuildBloodGasDisplay(ventTemplate, vent);
								}
								if(vent.ENDOTRACHEALTUBEACTIVITY_DATE) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD  class="lite-blue-row" style="text-align:right;width:30%">Extubated&nbsp;</TD><TD style="text-align:left;width:40%">&nbsp;' + vent.ENDOTRACHEALTUBEACTIVITY_DATE + '</TD><TD style="width:1%">&nbsp;</TD><TD style="text-align:left;width:30%">&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:5%">&nbsp;&nbsp;</TD></TR>');
								}
								
								ventTemplate.push('<TR class="lite-blue-row" style="width:100%"><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD></TR>');
								ventTemplate.push('</TABLE>');
							});	
							ventTemplate.push('</DIV>');
						});
						break;
					case 'supplementaloxygen':
						vitalsData.VITALS_VENT_DATA.forEach(function(item) {
							ventTemplate.push('');	
							ventTemplate.push('<DIV id="TESTTHIS">');
							item.VENT_DETAILS.forEach(function(vent) {
								ventTemplate.push('<TABLE cellspacing="0" cellpadding="0" border="0" style="border-spacing:0px;width:100%">');
								ventTemplate.push('<TR class="lite-blue-row" style="width:100%"><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD></TR>');
								if(vent.OXYGENTHERAPY) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD class="lite-blue-row" style="text-align:right;width:' + hdrCol1 + '">Device&nbsp;</TD><TD style="text-align:left;width:auto"><B>&nbsp;' + vent.OXYGENTHERAPY + '</B></TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:' + hdrCol3 + '">&nbsp;&nbsp;</TD></TR>');
								}
								ventTemplate.push('<TR class="lite-blue-row" style="width:100%"><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD></TR>');
								ventTemplate.push('</TABLE>');											
								ventTemplate.push('<TABLE cellspacing="0" cellpadding="0" border="0" style="border-spacing:0px;width:100%">');
								if(vent.OXYGENFLOWRATE) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">Flow&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.OXYGENFLOWRATE + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4 + '">' + vent.OXYGENFLOWRATE_UNIT + '</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
								}
								if(vent.FIO2) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">FiO2&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.FIO2 + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4 + '">' + vent.FIO2_UNIT + '</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
								}
								if(vent.SUPPOXYGENFIO2) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">FiO2&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.SUPPOXYGENFIO2 + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4 + '">%</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
								}
								if(vent.NITRICOXIDE) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">iNO&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.NITRICOXIDE + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4 + '">' + vent.NITRICOXIDE_UNIT + '</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
								}
								//if(Child.NavigationPanelFactory.currentLocation !== Child.NavigationPanelFactory.LOCATIONS.CICU_PROBLEMS_AND_TREATMENTS) {
								if(vent.SPO2 && vent.SPO2 !== undefined) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">SPO2&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.SPO2 + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4 + '">' + vent.SPO2_UNIT + '</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
								}
								if(vent.ETCO2 && vent.ETCO2 !== undefined) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD class="lite-blue-row" style="text-align:right;width:' + detCol1 + '">ETCO2&nbsp;</TD><TD style="text-align:right;width:' + detCol2 + '"><B>' + vent.ETCO2 + '</B></TD><TD style="width:' + detCol3 + '">&nbsp;</TD><TD style="text-align:left;width:' + detCol4 + '">' + vent.ETCO2_UNIT + '</TD><TD class="lite-blue-row" style="text-align:right;width:' + detCol5 + '">&nbsp;&nbsp;</TD></TR>');
								}
								//
								ventTemplate.push('</TABLE>');					
								ventTemplate.push('<TABLE cellspacing="0" cellpadding="0" border="0" style="border-spacing:0px;width:100%">');
								ventTemplate.push('<TR class="lite-blue-row" style="width:100%"><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD></TR>');
								if(vent.LASTBLOODGAS) {
									ventTemplate = BuildBloodGasDisplay(ventTemplate, vent);
								}
								if(vent.ENDOTRACHEALTUBEACTIVITY_DATE) {
									ventTemplate.push('<TR class="' + getRowClass() + '"><TD class="lite-blue-row" style="text-align:right;width:30%">Extubated&nbsp;</TD><TD style="text-align:left;width:40%">&nbsp;' + vent.ENDOTRACHEALTUBEACTIVITY_DATE + '</TD><TD>&nbsp;</TD><TD style="text-align:left;width:30%">&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:5%">&nbsp;&nbsp;</TD></TR>');
								}
								ventTemplate.push('<TR class="lite-blue-row" style="width:100%"><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD></TR>');
								ventTemplate.push('</TABLE>');
							});
							ventTemplate.push('</DIV>');
						});
						break;
					default:
						vitalsData.VITALS_VENT_DATA.forEach(function(item) {
							ventTemplate.push('<DIV id="TESTTHIS"><TABLE>');
							ventTemplate.push('<TR class="' + getRowClass() + '"><TD style="width:40%"><B>Ventilator</B></TD><TD>' + item.VENTILATOR + '</TD><TD class="lite-blue-row" style="text-align:right;width:5%">&nbsp;&nbsp;</TD></TR>');
							ventTemplate.push('<TR class="' + getRowClass() + '"><TD style="width:40%"><B>Mode</B></TD><TD>' + item.MODE + '</TD><TD class="lite-blue-row" style="text-align:right;width:5%">&nbsp;&nbsp;</TD></TR>');
							item.VENT_DETAILS.forEach(function(vent) {
								ventTemplate.push('<TR class="' + getRowClass() + '"><TD style="width:40%"><B>' + vent.LABEL + '</B></TD><TD><B>' + vent.VALUE + '</B> ' + vent.UNIT + '</TD><TD class="lite-blue-row" style="text-align:right;width:5%">&nbsp;&nbsp;</TD></TR>');
							});
							ventTemplate.push('</TABLE></DIV>');
						});
					break;
				}
			} else {
				ventTemplate.push('No Vent Settings available');
			}
			return ventTemplate.join('');
		};
		
		PreOPAnVitals.HeartPopUpPanel.buildPanel = function(vitalsData) {
			var heartHtml = 'No Hemodynamics Measures available';
			if (vitalsData.VITALS_HEART_DATA.length > 0) {
				var tempArray = [];
				vitalsData.VITALS_HEART_DATA.forEach(function(item) {
					tempArray.push('<DIV><TABLE cellspacing="0" cellpadding="4" border="0" style="border-spacing:0px;width:100%"><TR class="lite-blue-row" style="width:100%"><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD></TR>');
					
					item.HEART_BP_DETAILS.forEach(function(bp) {
						tempArray.push('<TR><TD class="lite-blue-row" style="text-align:right;width:25%">' + bp.LABEL + '&nbsp;&nbsp;</TD><TD style="text-align:right;width:40%"><B>' + bp.VALUE + '</B></TD><TD style="text-align:right;width:30%">' + bp.DATE + '&nbsp;&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:5%">&nbsp;&nbsp;</TD></TR>');
					});
					
					item.HEART_INFUSION_DETAILS.forEach(function(inf,idx) {
						if(idx == 0) {
							tempArray.push('<TR class="lite-blue-row"><TD style="width:25%">&nbsp;</TD><TD style="text-align:right;width:40%">Infusion Dose</TD><TD style="text-align:right;width:30%">Last Change&nbsp;&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:5%">&nbsp;&nbsp;</TD></TR>');
						}
						tempArray.push('<TR><TD id="HemoInfustionDrug' + idx + '" class="lite-blue-row" style="text-align:right;width:25%" title="' + inf.LABEL + ': ' + inf.CLINICAL_DISPLAY + '">' + inf.LABEL + '&nbsp;&nbsp;</TD><TD style="text-align:right;width:40%"><B>' + inf.VALUE + '</B></TD><TD style="text-align:right;width:30%">' + inf.DATE + '&nbsp;&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:5%">&nbsp;&nbsp;</TD></TR>');
					});
					
					item.HEART_DOSE_DETAILS.forEach(function(dose,idx) {
						if(idx == 0) {
							tempArray.push('<TR class="lite-blue-row"><TD style="width:25%">&nbsp;</TD><TD style="text-align:right;width:40%">Dose</TD><TD style="text-align:right;width:30%">Last Given&nbsp;&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:5%">&nbsp;&nbsp;</TD></TR>');
						}
						tempArray.push('<TR><TD id="HemoDoseDrug' + idx + '" class="lite-blue-row" style="text-align:right;width:25%" title="' + dose.LABEL + ': ' + dose.CLINICAL_DISPLAY + '">' + dose.LABEL + '&nbsp;&nbsp;</TD><TD style="text-align:right;width:40%"><B>' + dose.VALUE + '</B></TD><TD style="text-align:right;width:30%">' + dose.DATE + '&nbsp;&nbsp;</TD><TD class="lite-blue-row" style="text-align:right;width:5%">&nbsp;&nbsp;</TD></TR>');
					});

					tempArray.push('<TR class="lite-blue-row" style="width:100%"><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD><TD>&nbsp;</TD></TR></TABLE></DIV>');
				});
				heartHtml = tempArray.join('');
			}
			return heartHtml;
		};
	
		PreOPAnVitals.VitalsSummaryGrid.vitalsSummarySparkline = function(trendData, TREND_TYPE, DISP_MEASURE, TREND_NORM_MIN, TREND_NORM_MAX, spid) {
			if (trendData.length > 1) {
				// If only 1 data point don't call sparkline it will not work
				PreOPAnVitals.VitalsSummaryGrid.sparkLineCalled = true;
				var valueArray = [];
				var negResultFound = false;
				var posResultFound = false;
				var theSparkWidth = '100px';
				var theSparkHeight = 'auto';
				var theSpotRadius = '2.0';
				var theZeroAxis = false;
				var negativeBarColor = 'black';
				var positiveBarColor = 'blue';
				for (var j = 0; j < trendData.length; j++) {
					var result = parseFloat(trendData[j].VALUE);
					if (isNaN(result)) {
						valueArray[j] = '';
					} else {
						if (TREND_TYPE === 'SPARK') {
							valueArray[j] = parseInt(trendData[j].SPARK_X, 10) + ':' + result;
						} else {
							if (result < 0) {
								negResultFound = true;
							} else {
								posResultFound = true;
							}
							valueArray[j] = result;
						}
					}
				}

				if (DISP_MEASURE === 'OB Stool' || DISP_MEASURE === 'OB Gastric') {
					positiveBarColor = 'red';
					negativeBarColor = 'blue';
					if (!negResultFound) {
						// For these 2 if there is not a negative value set
						// negative color to white and force
						// one -1 value. This will cause correct sizing of the
						// positive value
						negativeBarColor = 'white';
						for (var ti = 0; ti < valueArray.length; ti++) {
							if (valueArray[ti] === '') {
								valueArray[ti] = -1;
								ti = valueArray.length;
							}
						}
					}

					if (!posResultFound) {
						// For these 2 if there is not a negative value set
						// negative color to white and force
						// one -1 value. This will cause correct sizing of the
						// positive value
						positiveBarColor = 'white';
						for (var ti = 0; ti < valueArray.length; ti++) {
							if (valueArray[ti] === '') {
								valueArray[ti] = 1;
								ti = valueArray.length;
							}
						}
					}
				}

				if (TREND_TYPE === 'SPARK') {
					if (TREND_NORM_MIN === "" || TREND_NORM_MAX === "") {
						$(spid).sparkline(valueArray, {
							type : 'line',
							disableTooltips : true,
							width : theSparkWidth,
							height : theSparkHeight,
							spotRadius : theSpotRadius,
							normalRangeColor : '#ffee33',
							chartRangeMinX : 1,
							chartRangeMaxX : 96,
							fillColor : false,
							enableTagOptions : false
						});
					} else {
						$(spid).sparkline(valueArray, {
							type : 'line',
							disableTooltips : true,
							width : theSparkWidth,
							height : theSparkHeight,
							spotRadius : theSpotRadius,
							normalRangeColor : '#ffee33',
							chartRangeMinX : 1,
							chartRangeMaxX : 96,
							normalRangeMin : TREND_NORM_MIN,
							normalRangeMax : TREND_NORM_MAX,
							drawNormalOnTop : true,
							fillColor : false,
							enableTagOptions : false
						});
					}
				} else {
					$(spid).sparkline(valueArray, {
						type : 'bar',
						disableTooltips : true,
						barWidth : 1,
						barSpacing : 0,
						barColor : positiveBarColor,
						negBarColor : negativeBarColor,
						height : theSparkHeight,
						// zeroAxis : theZeroAxis,
						chartRangeMinX : '1',
						chartRangeMaxX : '96',
						width : '100px'
					});
				}
			}			
		};
		
		PreOPAnVitals.VitalsSummaryGrid.displayVitalsSummarySparklines = function(vitalsData, panelId) {	
			var data = vitalsData.VITALS_SUMMARY;
			// Do sparklines in the vitals summary section
			for (var i = 0; i < data.length; i++) {			
				var spid = '#' + panelId + '_vitalsSummarySparkline' + i;
				var spid2 = '#' + panelId + '_vitalsSummarySparkline2' + i;
		
				//call stuff here
				PreOPAnVitals.VitalsSummaryGrid.vitalsSummarySparkline(
					data[i].TREND_DATA, 
					data[i].TREND_TYPE,
					data[i].DISP_MEASURE,
					data[i].TREND_NORM_MIN,
					data[i].TREND_NORM_MAX,
					spid);
				if(data[i].TREND_TYPE2 !== undefined) {
					PreOPAnVitals.VitalsSummaryGrid.vitalsSummarySparkline(
						data[i].TREND_DATA2, 
						data[i].TREND_TYPE2,
						data[i].DISP_MEASURE2,
						data[i].TREND_NORM_MIN2,
						data[i].TREND_NORM_MAX2,
						spid2);
				}
			}
			if (PreOPAnVitals.VitalsSummaryGrid.sparkLineCalled === false) {
				// ISSUE WITH SPARKLINES THAT MESSED UP HOVERS ON OTHER CHARTS ONLY
				// SEEMS TO GO AWAY
				// IF WE ACTUALLY CALL THE SPARKLINE CODE. SO LEAVE THIS HERE!!!		
				$('#dummysparkline').sparkline([1, 2, 3], {
					type : 'line',
					disableTooltips : true,
					width : '100px',
					spotRadius : '2.0',
					normalRangeColor : '#ffee33',
					chartRangeMinX : 1,
					chartRangeMaxX : 96,
					fillColor : false,
					enableTagOptions : false
				});		
			}		
			/* switch(panelId) {
				case 'child_INPATIENT_VITALS_ID':
				case 'child_CICU_VITALS_ID':
					Child.mpageTimers.renderedScreens.vitals = true;
					break;
				case 'child_rnss_vitals':
					Child.mpageTimers.renderedScreens.rnssVitals = true;
					Child.mpageTimers.renderedScreens.ishapedRnssAssessmentVitals = true;
					break;
				default:
					break;
			}
			Child.RenderManager.fireEvent('rendercompleted', this, 'from vitals' + panelId); */
		};	
		
		PreOPAnVitals.ChartSummaryGrid.displayChartSummarySparklines = function(vitalsData, panelId) {			
			// Do sparklines in the Vitals Chart summary section
			for (var i = 0; i < vitalsData.VITALS_SUMMARY_CHART.length; i++) {
				var spid = '#' + panelId + '_chartSummarySparkline' + i;
		
				var valueArray = [];
				for (var j = 0; j < vitalsData.VITALS_SUMMARY_CHART[i].TREND_DATA.length; j++) {
					var result = parseFloat(vitalsData.VITALS_SUMMARY_CHART[i].TREND_DATA[j].VALUE);
					if (isNaN(result)) {
						valueArray[j] = '';
					} else {
						if (vitalsData.VITALS_SUMMARY_CHART[i].TREND_TYPE === 'SPARK') {
							valueArray[j] = parseInt(vitalsData.VITALS_SUMMARY_CHART[i].TREND_DATA[j].SPARK_X, 10) + ':' + result;
						} else {
							valueArray[j] = result;
						}
					}
				}
		
				var theSparkWidth = '100px';
				var theSparkHeight = 'auto';
				var theSpotRadius = '2.0';
				var negativeBarColor = 'black';
				var positiveBarColor = 'blue';
				if (vitalsData.VITALS_SUMMARY_CHART[i].DISP_MEASURE === 'OB Stool' || vitalsData.VITALS_SUMMARY_CHART[i].DISP_MEASURE === 'OB Gastric') {
					positiveBarColor = 'red';
					negativeBarColor = 'blue';
				}
		
				if (vitalsData.VITALS_SUMMARY_CHART[i].TREND_TYPE === 'SPARK') {
					if (vitalsData.VITALS_SUMMARY_CHART[i].TREND_NORM_MIN === "" || vitalsData.VITALS_SUMMARY_CHART[i].TREND_NORM_MAX === "") {
						$(spid).sparkline(valueArray, {
							type : 'line',
							disableTooltips : true,
							width : theSparkWidth,
							height : theSparkHeight,
							spotRadius : theSpotRadius,
							normalRangeColor : '#ffee33',
							chartRangeMinX : 1,
							chartRangeMaxX : 96,
							fillColor : false,
							enableTagOptions : false
						});
					} else {
						$(spid).sparkline(valueArray, {
							type : 'line',
							disableTooltips : true,
							width : theSparkWidth,
							height : theSparkHeight,
							spotRadius : theSpotRadius,
							normalRangeColor : '#ffee33',
							chartRangeMinX : 1,
							chartRangeMaxX : 96,
							normalRangeMin : vitalsData.VITALS_SUMMARY_CHART[i].TREND_NORM_MIN,
							normalRangeMax : vitalsData.VITALS_SUMMARY_CHART[i].TREND_NORM_MAX,
							drawNormalOnTop : true,
							fillColor : false,
							enableTagOptions : false
						});
					}
				} else {
					$(spid).sparkline(valueArray, {
						type : 'bar',
						disableTooltips : true,
						barWidth : 1,
						barSpacing : 0,
						barColor : positiveBarColor,
						negBarColor : negativeBarColor,
						width : '100px'
					});
				}
			}			
		};

		PreOPAnVitals.HeartChart.buildHeartChart = function(chartConfig) {
			var seriesCombinedData = chartConfig.seriesData;
			var panelId = chartConfig.panelId;
			var chartTargetDivId = chartConfig.chartTargetDivId;

			if ($("#" + chartTargetDivId).length === 0) {
				alert(chartTargetDivId + ' Does not exist yet');
			} else {
				var yMin = 0;
				var yMax = 200;

				if (seriesCombinedData.lowResultOutOfBounds) {
					yMin = -0.20;
				}
				if (seriesCombinedData.hiResultOutOfBounds) {
					yMax = 199.80;
				}
				var yAxis2Enabled = chartConfig.yAxis2Enabled;
				if (yAxis2Enabled === undefined) {
					yAxis2Enabled = false;
				}
				var theLabelFont = chartConfig.labelFont;
				if (theLabelFont === undefined) {
					theLabelFont = '9px arial, tahoma, helvetica, sans-serif';
				}
				var theLegendFont = chartConfig.theLegendFont;
				if (theLegendFont === undefined) {
					theLegendFont = '10px tahoma,arial,verdana,sans-serif';
				}
				var theSpacingTop = chartConfig.spacingTop;
				if (theSpacingTop === undefined) {
					theSpacingTop = 10;
				}
				var theSpacingLeft = chartConfig.theSpacingLeft;
				if (theSpacingLeft === undefined) {
					theSpacingLeft = 0;
				}
				var theSpacingRight = chartConfig.theSpacingRight;
				if (theSpacingRight === undefined) {
					theSpacingRight = 1;
				}
				var marginRight = PreOPAnVitals.VitalsPanel.marginRightDefault;
				if (chartConfig.marginRight) {
					marginRight = chartConfig.marginRight;
				}				
				var spacingRight = PreOPAnVitals.VitalsPanel.spacingRightDefault;
				if (chartConfig.spacingRight) {
					spacingRight = chartConfig.spacingRight;
				}
				var marginLeft = PreOPAnVitals.VitalsPanel.marginLeftDefault;
				if (chartConfig.marginLeft) {
					marginLeft = chartConfig.marginLeft;
				}
				var legendWidth = PreOPAnVitals.VitalsPanel.legendWidth;
				if (chartConfig.legendWidth) {
					legendWidth = chartConfig.legendWidth;
				}
				var plotBorderWidth = 2;
				if (chartConfig.plotBorderWidth) {
					plotBorderWidth = chartConfig.plotBorderWidth;
				}
				var plotBorderColor = "#000000";
				if (chartConfig.plotBorderColor) {
					plotBorderColor = chartConfig.plotBorderColor;
				}				
				var legendX = 1;
				if (chartConfig.legendX) {
					legendX = chartConfig.legendX;
				}				
				var xAxisLabels = true;
				if(chartConfig.xAxisLabels === false) {
					xAxisLabels = chartConfig.xAxisLabels;
				}				
				var secondYtext = '';
				if (chartConfig.secondYtext) {
					secondYtext = chartConfig.secondYtext;
				}
				var heartChart = null;
				var legendMaxDt = null;
				var legendMinDt = null;
				var today = new Date();
				legendMaxDt = new Date(); // .add(Date.DAY, -1);
				legendMinDt = new Date(today.setDate(today.getDate() - 1));

				// Get the height & width from the containing panel
				var chartHeight = 240;
				var chartWidth = 250;
				if (chartConfig.panelWidth) {
					chartWidth = chartConfig.panelWidth;
				}				

				if (seriesCombinedData.length > 0) {
					Highcharts.setOptions({
						colors : ['#dddddd', '#77ddff', '#55aaff', '#3377ff', '#ffee33', '#000000']
					});

					var endOnTick = true;
					var startOnTick = true;
					var theMin = 0;
					var theMax = 200;

					if (seriesCombinedData.hiResultOutOfBounds || seriesCombinedData.lowResultOutOfBounds) {
						endOnTick = true;
						startOnTick = true;
						theMin = null;
						theMax = null;
					}

					var endOnTick2 = true;
					var startOnTick2 = true;
					var theMin2 = 0;
					var theMax2 = 100;

					if (seriesCombinedData.hiResultOutOfBounds || seriesCombinedData.lowResultOutOfBounds) {
						endOnTick2 = true;
						startOnTick2 = true;
						theMin2 = null;
						theMax2 = null;
					}
					
					var seriesIdx = 0;
					var yAxis_0_exists = false;
					var yAxis_1_exists = false;
					for(var i = 0; i < seriesCombinedData.length; i++) {
						if(seriesCombinedData[i].showInLegend === false) {
							seriesIdx++;
						} else {
							seriesCombinedData[i].seriesIdx = seriesIdx;
							seriesIdx++;
							if(seriesCombinedData[i].yAxis === 1) {
								yAxis_1_exists = true;
							} else {
								yAxis_0_exists = true;
							}
						}
					}
					
					var _yAxis = [];
					_yAxis.push({
						title : {
							text : ''
						},
						opposite : false,
						endOnTick : endOnTick,
						startOnTick : startOnTick,
						showFirstLabel : true,
						tickPixelInterval: 25,
						min : theMin,
						max : theMax,
						labels : {
							enabled : yAxis_0_exists,
							style : {
								font : theLabelFont,
								color : '#000000'
							}
						}
					});
					if(yAxis_1_exists) {
						_yAxis.push({
							title : {
								text : secondYtext,
								enabled : yAxis_1_exists,
								offset : 20,
								align: 'low',
								rotation : 0,
								style : {
									color : '#60497B'
								}
							},
							opposite : true,
							offset : -5,
							startOnTick : startOnTick2,
							endOnTick : endOnTick2,
							showFirstLabel : true,
							tickPixelInterval: 25,
							min : theMin2,
							max : theMax2,
							labels : {
								enabled : yAxis_1_exists,
								style : {
									font : theLabelFont,
									color : '#0011ff',
									fontWeight: 'bold'
								}
							}
						});
					}

					try {
						heartChart = new Highcharts.Chart({
							chart : {
								renderTo : chartTargetDivId,
								animation : false,
								zoomType : 'x',
								height : chartHeight,
								width : chartWidth,
								spacingBottom : 8,
								spacingTop : theSpacingTop,
								spacingLeft : theSpacingLeft,
								spacingRight : spacingRight - (yAxis_1_exists ? 12 : 0),
								marginRight : marginRight,
								marginLeft : marginLeft,
								plotBorderWidth : plotBorderWidth,
								plotBackgroundColor : '#fff',
								plotBorderColor : plotBorderColor,
								defaultSeriesType : 'line',
								// Highcharts 2.2.1 stuff
								resetZoomButton: {
									theme: {
										stroke: 'silver',
										r: 3,
										style : {
											fontSize : '9px'
										}
									},
									position: {
										align: 'right',
										verticalAlign: 'top',
										x: -(9 + marginRight),
										y: 0
									},
									relativeTo: 'chart'
								},
								/*
								 * ,events: { click: function(event) { alert ('x: '+
								 * event.xAxis[0].value +', y: '+ event.yAxis[0].value); } }
								 */
								events : {
									selection : function(event) {
										//PreOPAnVitals.VitalsPanel.shared_select_eventHandler(event, panelId);
									}
								}
							},
							credits : {
								enabled : false
							},
							title : {
								text : ''
							},
							xAxis : [
								{
								endOnTick : false,
								startOnTick : false,
								maxPadding : 0.05,
								minPadding : 0.05,
								minRange : 3600 * 1000,
								type : 'datetime',
								dateTimeLabelFormats : {
									day : '%H:%M'
								},
								gridLineWidth : 1,
								plotLines : [{
									color : '#C0C0C0',
									width : 2,
									zIndex : 3,
									value : PreOPAnVitals.VitalsPanel.GetPlotLineDate('00:00')
								}],
								labels : {
									enabled : xAxisLabels,
									style : {
										font : theLabelFont,
										color : '#000000'
									},
									formatter : function() {
										return Highcharts.dateFormat('%m/%d<br/>%H:%M', this.value);
									}
								}
							}],
							yAxis : _yAxis,
							legend : {
								align : 'right',
								verticalAlign : 'top',
								width : legendWidth,
								useHTML : true,
								symbolWidth : 7,
								symbolPadding : 1,
								x : legendX,
								y : 1,
								margin : 1,
								layout : 'vertical',
								floating : false,
								itemStyle : {
									font : theLegendFont,
									color : '#000000'
								},
								borderWidth : 0,
								shadow : false,
								labelFormatter : function() {
									var theLegend = '';
									var theClass = '';
									var legendIdx = this.userOptions.seriesIdx;
									
									if (this.yAxis.options.opposite === true) {
										// this is on the right axis
										if(this.visible) {
											theClass = 'legend-right-class';
										} else {
											theClass = 'legend-hidden-class';
										}
										theLegend = '<span id="' + chartTargetDivId + legendIdx + '" class="' + theClass + '">' + this.name + '</span>';
									} else {
										if(this.visible) {
											theClass = 'legend-left-class';
										} else {
											theClass = 'legend-hidden-class';
										}
										theLegend = '<span id="' + chartTargetDivId + legendIdx + '" class="' + theClass + '">' + this.name + '</span>';
									}								
									return theLegend;
								}
							},
							tooltip : {
								crosshairs : true,
								backgroundColor : "rgba(255,255,255,.90)",
								shared : false,
								formatter : function() {
									if(this.series.name === 'dummy') {
										return false;
									}
									else {
										var tip = '';
										var tName = this.series.name;
										if (tName.indexOf('Area') !== -1) {
											tName = tName.substring(0, tName.indexOf('Area'));
										}
										if(tName.indexOf('CICU_DATA_') !== -1) {
											tip = '<b>' + Highcharts.dateFormat('%m/%d/%y %H:%M', this.x) + '</b><br/>';
											for(var i=0; i<this.series.points.length; i++) {
												tip  += '<b>' + this.series.points[i].pointType + '</b> - ' + this.series.points[i].y + '<br/>';
											}
										} else {
											tip = Highcharts.dateFormat('%m/%d/%y %H:%M', this.x)
												+ '<br/>' + tName + ': '
												+ this.point.actualResult;
										}
										return tip;
									}
								}
							},
							plotOptions : {
								areaspline : {
									fillOpacity : 35
								},
								series : {
									borderWidth : 0,
									animation : false,
									stickyTracking : false,
									shadow : false,
									lineWidth : 1.5,
									events : {
										legendItemClick : function(event) {
											var theId;
											var theLegendClass;
											var aSeriesIsVisible = false;
										
											if(event.target.yAxis.opposite) {
												theId = chartTargetDivId + event.target.index;
												theLegendClass = 'legend-right-class';
											} else {
												theId = chartTargetDivId + event.target.index;
												theLegendClass = 'legend-left-class';
											}
											
											if (event.target.name.indexOf('Syst') !== -1 || event.target.name.indexOf('SBP') !== -1) {
												if (event.currentTarget.chart.series[0].visible === true) {
													if (event.currentTarget.chart.series[0].name.indexOf('SystArea') !== -1 || event.currentTarget.chart.series[0].name.indexOf('SBPArea') !== -1) {
														event.currentTarget.chart.series[0].setVisible(false);
													}
													if (event.currentTarget.chart.series[1].name.indexOf('DiastArea') !== -1 || event.currentTarget.chart.series[1].name.indexOf('DBPArea') !== -1) {
														event.currentTarget.chart.series[1].setVisible(false);
													}
												} else {
													if (event.currentTarget.chart.series[0].name.indexOf('SystArea') !== -1 || event.currentTarget.chart.series[0].name.indexOf('SBPArea') !== -1) {
														event.currentTarget.chart.series[0].setVisible(true);
													}
													if (event.currentTarget.chart.series[1].name.indexOf('DiastArea') !== -1 || event.currentTarget.chart.series[1].name.indexOf('DBPArea') !== -1) {
														event.currentTarget.chart.series[1].setVisible(true);
													}
												}
											}
											
											var legendEl = $('#' + theId);
											
											if(legendEl.length > 0) {
												var theLegendLabel = legendEl.html();
												
												if(event.target.visible) {
														event.currentTarget.hide();
														
														for(var i = 0; i < event.currentTarget.yAxis.series.length; i++) {
															if(event.currentTarget.yAxis.series[i].visible) {
																if(event.currentTarget.yAxis.series[i].name !== 'dummy') {
																	// ignore dummy series used to force xAxis (datetime)
																	aSeriesIsVisible = true;
																}
															}
														}
														if(aSeriesIsVisible === false) {
															event.currentTarget.yAxis.labelGroup.hide();
														}
													//legendEl.dom.className = 'legend-hidden-class';
												} else {
													event.currentTarget.show();
													event.currentTarget.yAxis.labelGroup.show();
													//legendEl.dom.className = theLegendClass;
												}
											}		
											return false;
										}
									},
									marker : {
										enabled : true,
										radius : 3,
										states : {
											hover : {
												fillColor : 'white',
												lineColor : 'black',
												lineWidth : 3
											}
										}
									}
								},
								column : {
									dataLabels : {
										enabled : false
									}
								}
							},
							series : seriesCombinedData
						});
					}
					catch(err) {
							alert('PTSUM-CHART_FAIL_HEART|' + err);
							//Child.LoadData.LogCcl('PTSUM-CHART_FAIL_HEART|' + err);
					}
				}
			}
			return heartChart;
		};

		PreOPAnVitals.HeartChart.BuildHeartChartData = function(data, skip_RR_HR) {
			var hiResultOutOfBounds = false;
			var lowResultOutOfBounds = false;
			var today = new Date();
			var firstDate = new Date(today.setDate(today.getDate() - 1));
			var lastDate = 0;
			
			var getMinValue = function(data) {				
				var min = 999;
				if(!PreOPAnVitals.HeartChart.minHeartOrTempDate) {
					PreOPAnVitals.HeartChart.minHeartOrTempDate = new Date(data[0].COLLECTED_DT);
				}
				for(var x=0; x < data.length; x++) {
					if(data[x].IGNORE !== 1) {
						var result = parseFloat(data[x].VALUE);
						if(min > result) {
							min = result;
						}
						var newDate = new Date(data[x].COLLECTED_DT);
						if(newDate != NaN && PreOPAnVitals.HeartChart.minHeartOrTempDate > newDate) {
							PreOPAnVitals.HeartChart.minHeartOrTempDate = newDate;
						}
					}
				}
				return min;				
			};
			var getMaxValue = function(data) {				
				var max = 0;
				if(!PreOPAnVitals.HeartChart.maxHeartOrTempDate) {
					PreOPAnVitals.HeartChart.maxHeartOrTempDate = new Date(data[0].COLLECTED_DT);
				}
				for(var x=0; x < data.length; x++) {
					if(data[x].IGNORE !== 1) {
						var result = parseFloat(data[x].VALUE);
						if(max < result) {
							max = result;
						}
						var newDate = new Date(data[x].COLLECTED_DT);
						if(newDate != NaN && PreOPAnVitals.HeartChart.maxHeartOrTempDate < newDate) {
							PreOPAnVitals.HeartChart.maxHeartOrTempDate = newDate;
						}
					}
				}
				return max;
			};
			
			var heartArrayIdx = 0;
			var graphData = [];
			for (var i = 0; i < data.length; i++) {
				var heartArray = [];
				heartArrayIdx = 0;
				var minValue = getMinValue(data[i].GRAPH_DATA);
				var maxValue = getMaxValue(data[i].GRAPH_DATA);

				for (var j = 0; j < data[i].GRAPH_DATA.length; j++) {
					if (data[i].GRAPH_DATA[j].IGNORE === 1) {
						var ignore = true;
					} else {
						heartArray.push('');
						var resultDate;
						resultDate = Date.parse(data[i].GRAPH_DATA[j].COLLECTED_DT);
						var result = parseFloat(data[i].GRAPH_DATA[j].VALUE);
						var actualResult = result;

						if (result > 200) {
							hiResultOutOfBounds = true;
						} else if (result < 0) {
							lowResultOutOfBounds = true;
						}

						var markerImage = function() {
							var mask = 'url({0}img/{1})';
							var directory = chla.global.imgPath;
							var returnVal;
							if (actualResult !== 0) { // don't want to show a graphic
														// when heart rate is 0
								if (actualResult < result) {
									returnVal = returnVal = chla.eApps.gFuncs.sFormatter(mask, directory, 'under.gif');
								} else if (actualResult > result) {
									returnVal = chla.eApps.gFuncs.sFormatter(mask, directory, 'over.gif');
								} else {
									switch(data[i].NAME) {
										case 'SBP':
										case 'Syst':
											returnVal = 'triangle-down';
											break;
											
										case 'DBP':
										case 'Diast':
											returnVal = 'triangle';
											break;
											
										case 'MBP':
										case 'Mean':
											returnVal = 'circle';
											break;
											
										default:
											break;
									}
								}
							}
							return returnVal;
						}();

						heartArray[heartArrayIdx] = {
							x : resultDate,
							y : result,
							actualResult : actualResult,
							minValue : minValue,
							maxValue : maxValue,
							marker : {
								symbol : markerImage
							}
						};
						heartArrayIdx = heartArrayIdx + 1;
					}
				}
				graphData[i] = heartArray;
			}

			// Check for any empty arrays and remove them.  This happens if the data for a series is all marked to be skipped
			for(var i = 0; i < graphData.length; i++) {
				if(graphData[i].length === 0) {
					graphData.splice(i,1);
					//decriment i since we just removed one entry
					i = i - 1;
				}
			}
				
			var areaSeriesData = [];
			var hasSBP = false;
			var hasDBP = false;
			var seriesData = [];
			var seriesDataIdx = 0;
			for (var i = 0; i < graphData.length; i++) {
				var lineColor = '';
				switch (data[i].NAME) {
					case 'SBP' :
					case 'Syst' :
						lineColor = '#0022AA';
						break;
					case 'DBP' :
					case 'Diast' :
						lineColor = '#0033EE';
						break;
					case 'MBP' :
					case 'Mean' :
						lineColor = '#7799FF';
						break;
					case 'HR' :
						lineColor = '#aa0011';
						break;
					case 'HR Monitor' :
						lineColor = '#ff1122';
						break;
					case 'RR' :
						lineColor = '#005522';
						break;
					case 'CVP' :
						lineColor = '#60497B';
						break;
					default :
						lineColor = '';
						break;
				}
				switch(data[i].NAME) {
					case 'CVP':
						seriesData.push('');
						seriesData[seriesDataIdx] = {
							'type' : 'line',
							'xAxis' : 0,
							'yAxis' : 1,
							'dataLabels' : {
								'enabled' : false
							},
							'zIndex' : i + 10,
							'data' : graphData[i],
							'name' : data[i].NAME + ' (' + graphData[i][0].minValue + ' - ' + graphData[i][0].maxValue + ')',
							'color' : lineColor
						};
						seriesDataIdx++;
						break;
						
					case 'SBP':
					case 'Syst':
					case 'DBP':
					case 'Diast':
					case 'MBP':
					case 'Mean':
						seriesData.push('');
						seriesData[seriesDataIdx] = {
							'type' : 'line',
							'xAxis' : 0,
							'dataLabels' : {
								'enabled' : false
							},
							'zIndex' : i + 10,
							'data' : graphData[i],
							'name' : data[i].NAME + ' (' + graphData[i][0].minValue + ' - ' + graphData[i][0].maxValue + ')',
							'color' : lineColor
						};
						seriesDataIdx++;
						break;
					case 'HR':
					case 'HR Monitor':
					case 'RR':
						if(!skip_RR_HR) {
							seriesData.push('');
							seriesData[seriesDataIdx] = {
								'type' : 'line',
								'xAxis' : 0,
								'dataLabels' : {
									'enabled' : false
								},
								'zIndex' : i + 10,
								'data' : graphData[i],
								'name' : data[i].NAME + ' (' + graphData[i][0].minValue + ' - ' + graphData[i][0].maxValue + ')',
								'color' : lineColor
							};
							seriesDataIdx++;
						}
						break;					
					default:
						// skip the other data series in this version of the graph
						break;
				}

				// Bug fix (LLU 1/6/2016)
				var ignoreFlag = false;
				for (var k = 0; k < data[i].GRAPH_DATA.length; k++) {
					if (data[i].GRAPH_DATA[k].IGNORE === 1) {
						ignoreFlag = true;
					}
				}
				

				if (!ignoreFlag){			
					if (data[i].NAME === 'SBP' || data[i].NAME === 'Syst') {
						hasSBP = true;
						areaSeriesData[0] = {
							'type' : 'area',
							'xAxis' : 0,
							'showInLegend' : false,
							'stacking' : 'normal',
							'fillOpacity' : 0.6,
							'data' : function fn() {
								var newGraphData = new Array(graphData[i].length);
								for (var x = 0; x < newGraphData.length; x++) {
									newGraphData[x] = {
										x : graphData[i][x].x,
										y : graphData[i][x].y - graphData[i + 1][x].y,
										actualResult : graphData[i][x].actualResult
									};
								}
								return newGraphData;
							}(),
							'name' : data[i].NAME + 'Area',
							'color' : '#ccddff'
						};
					}

					if (data[i].NAME === 'DBP' || data[i].NAME === 'Diast') {
						hasDBP = true;
						areaSeriesData[1] = {
							'type' : 'area',
							'xAxis' : 0,
							'showInLegend' : false,
							'fillColor' : 'rgba(255, 255, 255, 0)',
							'stacking' : 'normal',
							'fillOpacity' : 0.99,
							'data' : graphData[i],
							'name' : data[i].NAME + 'Area'
						};
					}
				}
			}
			
			if(seriesData.length > 0) {
				var today = new Date();
				var tempDate = new Date(today.setDate(today.getDate() - 1)),
					tempEndDate = new Date();
				var dummySeries = PreOPAnVitals.VitalsPanel.buildDummySeries(0, tempDate, tempEndDate);
				seriesData.push(dummySeries);
			}
			
			var seriesCombinedData;
			if (hasSBP && hasDBP) {
				// combine the two arrays
				seriesCombinedData = [];
				for (var i = 0; i < areaSeriesData.length; i++) {
					seriesCombinedData[i] = areaSeriesData[i];
				}
				for (var i = areaSeriesData.length; i < seriesData.length + areaSeriesData.length; i++) {
					seriesCombinedData[i] = seriesData[i - areaSeriesData.length];
				}
			} else {
				seriesCombinedData = [];
				for (var i = 0; i < seriesData.length; i++) {
					seriesCombinedData[i] = seriesData[i];
				}
			}

			seriesCombinedData.lowResultOutOfBounds = lowResultOutOfBounds;
			seriesCombinedData.hiResultOutOfBounds = hiResultOutOfBounds;

			return seriesCombinedData;
		};
		
		PreOPAnVitals.VitalsPanel.buildTempChart = function(chartConfig) {
			var seriesData = chartConfig.seriesData;
			var panelId = chartConfig.panelId;

			if ($('#' + panelId + '_TEMP_CHARTGOESHERE').length == 0) {
				alert(panelId + '_TEMP_CHARTGOESHERE' + ' Does not exist yet');
			} else {				
				var chartTargetDivId = panelId + '_TEMP_CHARTGOESHERE';
				var theLabelFont = chartConfig.labelFont;
				if (theLabelFont === undefined) {
					theLabelFont = '9px arial, tahoma, helvetica, sans-serif';
				}				
				var legendX = chartConfig.legendX;
				if(legendX === undefined) {
					legendX = 1;
				}
				var theLegendFont = chartConfig.theLegendFont;
				if (theLegendFont === undefined) {
					theLegendFont = '10px tahoma,arial,verdana,sans-serif';
				}
				var marginRight = PreOPAnVitals.VitalsPanel.marginRightDefault;
				if (chartConfig.marginRight) {
					marginRight = chartConfig.marginRight;
				}
				var marginLeft =  PreOPAnVitals.VitalsPanel.marginLeftDefault;
				if (chartConfig.marginLeft) {
					marginLeft = chartConfig.marginLeft;
				}
				var legendWidth = PreOPAnVitals.VitalsPanel.legendWidth;
				if (chartConfig.legendWidth) {
					legendWidth = chartConfig.legendWidth;
				}
				var spacingRight = PreOPAnVitals.VitalsPanel.spacingRightDefault;
				if (chartConfig.spacingRight) {
					spacingRight = chartConfig.spacingRight;
				}				
				var xAxisLabels = false;
				if(chartConfig.xAxisLabels) {
					xAxisLabels = chartConfig.xAxisLabels;
				}
				// Get the height & width from the containing panel
				var theContainer = $('#' + panelId);
				var chartHeight = 120;
				var chartWidth = 250;
				if (chartConfig.panelWidth) {
					chartWidth = chartConfig.panelWidth;
				} 
				var temperatureChart = null;
				var legendMaxDt = null;
				var legendMinDt = null;
 
				// Start date for legend is always 24 hours ago
				var today = new Date();
				legendMaxDt = new Date(); 
				legendMinDt = new Date(today.setDate(today.getDate() - 1));

				if (seriesData.length > 0) {
					Highcharts.setOptions({
						colors : ['#AA0011', '#CC0033', '#FF7777', '#CC2200', '#FF8899', '#FF1122', 'FF9900', 'FF0000']
					});

					var endOnTick = false;
					var startOnTick = false;
					var theMin = 36;
					var theMax = 40;
					var calculatedMax = 39;
					var calculatedMin = 36;
					if (seriesData.hiResultOutOfBounds || seriesData.lowResultOutOfBounds) {
						if (seriesData.hiResultOutOfBounds) {
							calculatedMax = (seriesData.hiResult - (seriesData.hiResult % 1)) + 1;
						} else if (seriesData.hiResult >= 39) {
							calculatedMax = 40;
						}
						if (seriesData.lowResultOutOfBounds) {
							calculatedMin = (seriesData.lowResult - (seriesData.lowResult % 1));
							if (seriesData.lowResult % 1 === 0) {
								calculatedMin = calculatedMin - 1;
							}
						}
						endOnTick = true;
						startOnTick = true;
						theMin = calculatedMin;
						theMax = calculatedMax;
					}

					var seriesIdx = 0;
					for(var i = 0; i < seriesData.length; i++) {
						if(seriesData[i].showInLegend === false) {
							// set this to skip past any initial hidden series so legend clicks will work
							seriesIdx++;
						} else {
							seriesData[i].seriesIdx = seriesIdx;
							seriesIdx++;
						}
					}

					try {
						temperatureChart = new Highcharts.Chart({
							chart : {
								renderTo : chartTargetDivId,
								animation : false,
								zoomType : 'x',
								height : chartHeight,
								width : chartWidth,
								spacingBottom : 5,
								// spacingTop: 1,
								spacingLeft : 7,
								spacingRight : spacingRight,
								marginRight : marginRight,
								marginLeft : marginLeft,
								plotBorderWidth : 2,
								plotBorderColor : "#000000",
								defaultSeriesType : 'line',
								// Highcharts 2.2.1 stuff
								resetZoomButton : {
									theme : {
										stroke : 'silver',
										r : 3,
										style : {
											fontSize : '9px'
										}
									},
									position : {
										align : 'right',
										verticalAlign : 'top',
										x : -(9 + marginRight),
										y : 0
									},
									relativeTo : 'chart'
								},
								events : {
									selection : function(event) {									
										//PreOPAnVitals.VitalsPanel.shared_select_eventHandler(event, panelId);									
									}
								}
							},
							credits : {
								enabled : false
							},
							title : {
								text : ''
							},
							xAxis : [{
								endOnTick : false,
								startOnTick : false,
								maxPadding : 0.05,
								minPadding : 0.05,
								tickLength : 0,
								tickInterval : 6 * 3600 * 1000, // 6 hours
								minRange : 3600 * 1000,
			//					maxZoom : 3600 * 1000,
								labels : {
									enabled : xAxisLabels,
									style : {
										font : theLabelFont,
										color : '#000000'
									},
									formatter : function() {
										return Highcharts.dateFormat('%m/%d<br/>%H:%M', this.value);
									}
								},
								gridLineWidth : 1,
								plotLines : [{
									color : '#C0C0C0',
									width : 2,
									zIndex : 3,
									value : PreOPAnVitals.VitalsPanel.GetPlotLineDate('00:00')
								}],
								type : 'datetime'
							}],
							yAxis : {
								title : {
									text : null
								},
								opposite : false,
								endOnTick : endOnTick,
								startOnTick : startOnTick,
								showFirstLabel : true,
								tickInterval : 1,
								min : theMin,
								max : theMax,
								labels : {
									y : 1,
									style : {
										font : theLabelFont,
										color : '#000000'
									}
								},
								plotLines : [{
									color : '#000099',
									width : 3,
									zIndex : 3,
									value : 38
								}]
							},
							legend : {
								align : 'right',
								verticalAlign : 'top',
								width : legendWidth,
								useHTML : true,
								symbolWidth : 7,
								symbolPadding : 1,
								x : legendX,
								y : 1,
								margin : 1,
								layout : 'vertical',
								floating : false,
								itemStyle : {
									font : theLegendFont
								},
								borderWidth : 0,
								shadow : false,
								labelFormatter : function() {
									var theLegend = '';
									var theClass = '';
									var legendIdx = this.userOptions.seriesIdx;
									
									if (this.yAxis.options.opposite === true) {
										// this is on the right axis
										if(this.visible) {
											theClass = 'legend-right-class';
										} else {
											theClass = 'legend-hidden-class';
										}
										theLegend = '<span id="' + chartTargetDivId + legendIdx + '" class="' + theClass + '">' + this.name + '</span>';
									} else {
										if(this.visible) {
											theClass = 'legend-left-class';
										} else {
											theClass = 'legend-hidden-class';
										}
										theLegend = '<span id="' + chartTargetDivId + legendIdx + '" class="' + theClass + '">' + this.name + '</span>';
									}
									
									legendIdx++;
									
									return theLegend;
								}
							},
							tooltip : {
								crosshairs : true,
								backgroundColor : "rgba(255,255,255,.90)",
								shared : false,
								formatter : function() {
									if(this.series.name === 'dummy') {
										return false;
									} else {
										return Highcharts.dateFormat('%m/%d/%y %H:%M', this.x)
											+ '<br/>' + this.series.name + ': '
											+ this.point.actualResult;
									}
								}
							},
							plotOptions : {
								series : {
									borderWidth : 0,
									animation : false,
									shadow : false,
									stickyTracking : false,
									lineWidth : 1.5,
									events : {
										legendItemClick : function(event) {
											var theId;
											var theLegendClass;
											var aSeriesIsVisible = false;
										
											if(event.target.yAxis.opposite) {
												theId = chartTargetDivId + event.target.index;
												theLegendClass = 'legend-right-class';
											} else {
												theId = chartTargetDivId + event.target.index;
												theLegendClass = 'legend-left-class';
											}
											
											var legendEl = $('#' + theId);
											
											if(legendEl.length > 0) {
												var theLegendLabel = legendEl.html();
												
												if(event.target.visible) {
														event.currentTarget.hide();
														
														for(var i = 0; i < event.currentTarget.yAxis.series.length; i++) {
															if(event.currentTarget.yAxis.series[i].visible) {
																if(event.currentTarget.yAxis.series[i].name !== 'dummy') {
																	// ignore dummy series used to force xAxis (datetime)
																	aSeriesIsVisible = true;
																}
															}
														}
														if(aSeriesIsVisible === false) {
															event.currentTarget.yAxis.labelGroup.hide();
														}
													//legendEl.dom.className = 'legend-hidden-class';
												} else {
													event.currentTarget.show();
													event.currentTarget.yAxis.labelGroup.show();
													//legendEl.dom.className = theLegendClass;
												}
											}											
											return false;
										}
									},
									marker : {
										radius : 3,
										enabled : true,
										states : {
											hover : {
												fillColor : 'white',
												lineColor : 'black',
												lineWidth : 3
											}
										}
									}
								},
								column : {
									stacking : 'normal',
									dataLabels : {
										enabled : false
									}
								}
							},
							series : seriesData
						});
					} catch(err) {
						alert('PTSUM-CHART_FAIL_TEMP|' + err);
						//Child.LoadData.LogCcl('PTSUM-CHART_FAIL_TEMP|' + err);
					}
				} 			
			}			
			return temperatureChart;
		};
	
		PreOPAnVitals.VitalsPanel.BuildTempChartData = function(data) {
			var graphData = [];
			var hiResultOutOfBounds = false;
			var lowResultOutOfBounds = false;
			var hiResult = 0;
			var lowResult = 99;
			var today = new Date();
			var firstDate = new Date(today.setDate(today.getDate() - 1));
			var lastDate = 0;
			
			var getMinValue = function(data) {				
				var min = 999;
				if(!PreOPAnVitals.HeartChart.minHeartOrTempDate) {
					PreOPAnVitals.HeartChart.minHeartOrTempDate = new Date(data[0].COLLECTED_DT);
				}
				for(var x=0; x < data.length; x++) {
					if(data[x].IGNORE !== 1) {
						var result = parseFloat(data[x].VALUE);
						if(min > result) {
							min = result;
						}
						var newDate = new Date(data[x].COLLECTED_DT);
						if(newDate != NaN && PreOPAnVitals.HeartChart.minHeartOrTempDate > newDate) {
							PreOPAnVitals.HeartChart.minHeartOrTempDate = newDate;
						}
					}
				}
				return min;				
			};
			var getMaxValue = function(data) {				
				var max = 0;
				if(!PreOPAnVitals.HeartChart.maxHeartOrTempDate) {
					PreOPAnVitals.HeartChart.maxHeartOrTempDate = new Date(data[0].COLLECTED_DT);
				}
				for(var x=0; x < data.length; x++) {
					if(data[x].IGNORE !== 1) {
						var result = parseFloat(data[x].VALUE);
						if(max < result) {
							max = result;
						}
						var newDate = new Date(data[x].COLLECTED_DT);
						if(newDate != NaN && PreOPAnVitals.HeartChart.maxHeartOrTempDate < newDate) {
							PreOPAnVitals.HeartChart.maxHeartOrTempDate = newDate;
						}
					}
				}
				return max;
			};
			
			for (var i = 0; i < data.length; i++) {
				data[i].GRAPH_DATA = data[i].GRAPH_DATA.filter(function(item, index, arr) {
					var result = parseFloat(item.VALUE);
					return result > 30;
				});
				var tempArray = [];
				for (var j = 0; j < data[i].GRAPH_DATA.length; j++) {
					var resultDate;
					
					var minValue = getMinValue(data[i].GRAPH_DATA);
					var maxValue = getMaxValue(data[i].GRAPH_DATA);
					
					resultDate = Date.parse(data[i].GRAPH_DATA[j].COLLECTED_DT);

					var result = parseFloat(data[i].GRAPH_DATA[j].VALUE);
					var actualResult = result;
					
					if (result > hiResult) {
						hiResult = result;
					}
					if (result < lowResult) {
						lowResult = result;
					}

					if (result >= 40) {
						hiResultOutOfBounds = true;
					} else if (result <= 36) {
						lowResultOutOfBounds = true;
					}

					var markerImage = function() {
						var mask = 'url({0}img/{1})';
						var directory;
						directory = chla.global.imgPath + 'img';
						var returnVal;
						if (actualResult < result) {
							returnVal = returnVal = chla.eApps.gFuncs.sFormatter(mask, directory, 'under.gif');
						} 
						else if (actualResult > result) {
							returnVal = chla.eApps.gFuncs.sFormatter(mask, directory, 'over.gif');
						}
						return returnVal;
					}();
					
					tempArray[j] = {
						x : resultDate,
						y : result,
						minValue : minValue,
						maxValue : maxValue,
						actualResult : actualResult,
						marker : {
							symbol : markerImage
						}
					};
				}
				
				graphData[i] = tempArray;
			}
			
			var seriesData = [];
			for (var i = 0; i < graphData.length; i++) {
				var lineColor = '';
				switch (data[i].NAME) {
					case 'Axillary' :
						lineColor = '#660000';
						break;
					case 'Vascular' :
						lineColor = '#880022';
						break;
					case 'Oral' :
						lineColor = '#AA0022';
						break;
					case 'Rectal' :
						lineColor = '#CC0022';
						break;
					case 'Skin' :
						lineColor = '#EE0022';
						break;
					case 'Temp' :
						lineColor = '#FF4444';
						break;
					case 'Temporal' :
						lineColor = '#FF6666';
						break;
					case 'Toe' :
						lineColor = '#FFAAAA';
						break;
					default :
						lineColor = '';
						break;
				}
				seriesData[i] = {
					'data' : graphData[i],
					'name' : data[i].NAME + ' (' + graphData[i][0].minValue + ' - ' + graphData[i][0].maxValue + ')',
					'color' : lineColor
				};
			}
						
			if(seriesData.length > 0) {
				var today = new Date();
				var tempDate = new Date(today.setDate(today.getDate() - 1)),
					tempEndDate = new Date();
				var dummySeries = PreOPAnVitals.VitalsPanel.buildDummySeries(36, tempDate, tempEndDate);
				seriesData.push(dummySeries);
			} 
			
			seriesData.lowResultOutOfBounds = lowResultOutOfBounds;
			seriesData.hiResultOutOfBounds = hiResultOutOfBounds;
			seriesData.hiResult = hiResult;
			seriesData.lowResult = lowResult;

			return seriesData;
		};

		PreOPAnVitals.VitalsPanel.buildDummySeries = function(dummyX, startDate, endDate) {	
			var theHour = startDate.getHours();
			if(theHour >= 0 && theHour < 6) {
				theHour = 0;
			} else {
				if(theHour >= 6 && theHour < 12) {
					theHour = 6;
				} else {
					if(theHour >= 12 && theHour < 18) {
						theHour = 12;
					} else {
						theHour = 18;
					}
				}
			}
			
			var testTxt = 'drug 1 (comments stuff) more info<br>drug 2 (comments stuff) more info<br>drug 3 (comments stuff) more info<br>drug 4 (comments stuff) more info<br>drug 5 (comments stuff) more info<br>';

			var legendMinDate = new Date(startDate.getFullYear().toString() 
				+ '/' + (startDate.getMonth() + 1).toString()
				+ '/' + startDate.getDate().toString()
				+ ' ' + theHour.toString() + ':00:00'
			);

			var nowHr = endDate.getHours();
			
			var legendMaxDate = new Date(endDate.getFullYear().toString() 
					+ '/' + (endDate.getMonth() + 1).toString()
					+ '/' + endDate.getDate().toString()
					+ ' ' + (nowHr + 1).toString() + ':00:00'
			);
			
			var date = new Date(legendMinDate);
			if(new Date(date.setDate(date.getDate() + 1)) >= legendMaxDate) {
				date = new Date(legendMinDate);
				legendMaxDate = new Date(date.setTime(date.getTime() + 25*60*60*1000));
			}
 			var span = 6;
 			var dateDiff = chla.eApps.gFuncs.dateDiff(PreOPAnVitals.HeartChart.minHeartOrTempDate, PreOPAnVitals.HeartChart.maxHeartOrTempDate, "hours");
			date = new Date(legendMinDate);
			if(dateDiff < 4){
				span = 1;
				date = new Date(PreOPAnVitals.HeartChart.minHeartOrTempDate);
				legendMinDate = new Date(date.setTime(date.getTime() - (1*60*60*1000)));
				legendMaxDate = new Date(date.setTime(date.getTime() + (span*5*60*60*1000)));
			} else if(dateDiff < 8){
				span = 2;
				date = new Date(PreOPAnVitals.HeartChart.minHeartOrTempDate);
				legendMinDate = new Date(date.setTime(date.getTime() - (1*60*60*1000)));
				legendMaxDate = new Date(date.setTime(date.getTime() + (span*5*60*60*1000)));
			} else if(dateDiff < 12){
				span = 3;
				date = new Date(PreOPAnVitals.HeartChart.minHeartOrTempDate);
				legendMinDate = new Date(date.setTime(date.getTime() - (1*60*60*1000)));
				legendMaxDate = new Date(date.setTime(date.getTime() + (span*5*60*60*1000)));
			} else if(dateDiff < 16){
				span = 4;
				date = new Date(PreOPAnVitals.HeartChart.minHeartOrTempDate);
				legendMinDate = new Date(date.setTime(date.getTime() - (1*60*60*1000)));
				legendMaxDate = new Date(date.setTime(date.getTime() + (span*5*60*60*1000)));
			} 
			date = new Date(legendMinDate);
			var t1 = new Date(date.setTime(date.getTime() + (span*60*60*1000)));
			date = new Date(legendMinDate);
			var t2 = new Date(date.setTime(date.getTime() + (span*2*60*60*1000)));
			date = new Date(legendMinDate);
			var t3 = new Date(date.setTime(date.getTime() + (span*3*60*60*1000)));
			date = new Date(legendMinDate);
			var t4 = new Date(date.setTime(date.getTime() + (span*4*60*60*1000)));

			var seriesData = 
			{
				'type' : 'line',
				'xAxis' : 0,
				'dataLabels' : {
					'enabled' : false
				},
				'data' : [
					{
						x : legendMinDate,
						y : dummyX,
						actualResult : dummyX,
						unit : ''
					}, {
						x : t1,
						y : dummyX,
						actualResult : dummyX,
						unit : ''
					}, {
						x : t2,
						y : dummyX,
						actualResult : dummyX,
						unit : ''
					}, {
						x : t3,
						y : dummyX,
						actualResult : dummyX,
						unit : ''
					}, {
						x : t4,
						y : dummyX,
						actualResult : dummyX,
						unit : ''
					}, { // now one for one hour in the future to even out graph ends
						x : legendMaxDate,
						y : dummyX,
						actualResult : dummyX,
						unit : ''
					}], 
				'name' : 'dummy',
				'showInLegend' : false,
				'states' : {
					'hover' : {
						'enabled' : false
					}
				},
				'color' : 'rgba(255, 255, 255, 0)'
			};				
			return seriesData;
		};

		PreOPAnVitals.VitalsPanel.GetPlotLineDate = function(hrStr) {
			var currentDate = new Date();
			var todayDt = chla.eApps.gFuncs.sFormatShortDate(currentDate, "/");
			var todayStr = todayDt + ' ' + hrStr;
			return new Date(todayStr);
		};
	
		PreOPAnVitals.VitalsPanel.summaryDataProcessing = function(dataArray, elIdComponent, process_DATA_RANGE, panelId) {
			var returnArray = [];
			dataArray.forEach(function(item,index) {
				var rangeText = item.DATA_RANGE;
				var trendData = item.TREND_DATA_FAKE;
				if(process_DATA_RANGE) {
					if (item.TREND_TYPE === 'SPARK') {
						rangeText = "(" + "<SPAN STYLE='color: "
							+ item.MIN_NORMALCY_COLOR + "'>"
							+ item.DATA_RANGE_MIN + "</SPAN>" + " - "
							+ "<SPAN STYLE='color: "
							+ item.MAX_NORMALCY_COLOR + "'>"
							+ item.DATA_RANGE_MAX + "</SPAN>" + ")";
					}
				}
				if (item.TREND_TYPE === 'SPARK') {
					trendData = '<div id="' + panelId + elIdComponent + index + '"></div>';
				} else if (item.TREND_TYPE === 'BARCODE') {
					trendData = '<div id="' + panelId + elIdComponent + index + '"></div>';
				}
				var displayLine = item.DISP_MEASURE.match(/NIRS/i) ? item.DISP_MEASURE.replace('NIRS', 'NIRS (') + ')' : item.DISP_MEASURE;
				var temp = {
					DISP_MEASURE: displayLine,
					LAST_VALUE: "<SPAN STYLE='color: " + item.NORMALCY_COLOR + "'>" + item.LAST_VALUE + " " + item.NORMALCY_IND + "</SPAN>",
					DATA_RANGE: rangeText,
					TREND_DATA_FAKE: trendData
				};
				returnArray.push(temp);
			});
			return returnArray;
		};
	
		PreOPAnVitals.VitalsSummaryGrid.showDetail = function(DtoData, panelId) {
			$('#' + panelId + '_Details_Btn').text('Hide Detail');
			$('#' + panelId + '_TEMP_CHARTGOESHERE').hide();
			$('#' + panelId + '_HEART_CHARTGOESHERE').hide();
			$('#' + panelId + '_HEART_CHART_RADIO_BTNS').hide();
			$('#' + panelId + '_CHARTSUMMARYGOESHERE').show();
			$('#' + panelId + '_CHARTSUMMARYHEADER').css("opacity","0.01");
			$('#' + panelId + '_CHARTSUMMARY_LINEBREAK').css("display","none");
			setTimeout(function() { PreOPAnVitals.ChartSummaryGrid.displayChartSummarySparklines(DtoData.vitalsData, panelId); }, PreOPAnVitals.ChartSummaryGrid.DataObject.displayChartSummarySparklinesDelay);
		};
		
		PreOPAnVitals.VitalsSummaryGrid.hideDetail = function(panelId) {
			$('#' + panelId + '_Details_Btn').text('Show Detail');
			$('#' + panelId + '_TEMP_CHARTGOESHERE').show();
			$('#' + panelId + '_HEART_CHARTGOESHERE').show();
			$('#' + panelId + '_HEART_CHART_RADIO_BTNS').show();
			$('#' + panelId + '_CHARTSUMMARYGOESHERE').hide();
			$('#' + panelId + '_CHARTSUMMARYHEADER').css("opacity","1");
			$('#' + panelId + '_CHARTSUMMARY_LINEBREAK').css("display","block");
		};
	};
    /**
     * Parent function for processing the JSON data received for display
     * Output of this function will be an object tha contains data items to be used in the presentation construction process.
     *  All data validation and transformations are done in this function
     *
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @param aDtoData {object} Dto object specifically defined by RPTDATA response from CCL request
     * @returns {*} {object} retVal is a CC specifically defined DTO for transferring data to presentation processing
     */
    PreOPAnVitals.ccnsp.processData = function (aObjNSbase, aObjCcBase,aDtoData) {
        var retVal = {},
			headerElementArray = [],
			panelId = PreOPAnVitals.panelId,
			vitalsData;
		//chla.eAppsUtil.Logger.LogError(JSON.stringify(aObjCcBase.data));
		if(aObjCcBase.data && aObjCcBase.data.VITALS) {
			vitalsData = aObjCcBase.data.VITALS;
			//VITALS_SUMMARY_CHART data processing			
			PreOPAnVitals.VitalsPanel.showDetailFirst = false;
			if (vitalsData.GRAPH_HAS_DETAILS === 'NO') {
				if (vitalsData.VITALS_ART_HEART_GRAPH_DATA.length !== 0 || vitalsData.VITALS_HEART_GRAPH_DATA.length !== 0 || vitalsData.VITALS_TEMP_GRAPH_DATA.length !== 0) {
					PreOPAnVitals.VitalsPanel.showDetailFirst = true;
				}
			}
			var hideHeaders = false;
			if (vitalsData.VITALS_ART_HEART_GRAPH_DATA.length === 0 && vitalsData.VITALS_HEART_GRAPH_DATA.length === 0 && vitalsData.VITALS_TEMP_GRAPH_DATA.length === 0) {
				hideHeaders = true;
			}
			var ChartSummaryData = PreOPAnVitals.VitalsPanel.summaryDataProcessing(vitalsData.VITALS_SUMMARY_CHART, '_chartSummarySparkline', true, panelId);
			PreOPAnVitals.ChartSummaryGrid.DataObject = {
				displayChartSummarySparklinesDelay: 50,
				hideHeaders: hideHeaders,
				data: ChartSummaryData
			};	
			//VITALS_SUMMARY data processing
			var SummaryData = PreOPAnVitals.VitalsPanel.summaryDataProcessing(vitalsData.VITALS_SUMMARY, '_vitalsSummarySparkline', false, panelId);
			PreOPAnVitals.VitalsSummaryGrid.DataObject = {
				displaySummarySparklinesDelay: 50,
				data: SummaryData
			};	
			
			if (vitalsData.HEMO_EXISTS.match(/true/i)) {
				var newHeartIcon = '<img id="' + panelId + '_heart_icon_id2"' + ' src="' + chla.global.imgPath + 'img/heart.png"' +
				'style="margin-left: 5px; margin-right: 5px; cursor:pointer;width: 15px;vertical-align: text-bottom;"' +
				'data-qtip="' + PreOPAnVitals.HeartPopUpPanel.buildPanel(vitalsData).replace(/"/g,"\'") + '">';
				headerElementArray.push(newHeartIcon);
			}
			
			if (vitalsData.VENT_EXISTS.match(/true/i)) {
				var newLungIcon = '<img id="' + panelId + '_lung_icon_id2"' + ' src="' + chla.global.imgPath + 'img/lung.gif"' +
				'style="margin-left: 5px; margin-right: 5px; cursor:pointer;width: 15px;vertical-align: text-bottom;"' +
				'data-qtip="' + PreOPAnVitals.LungPopUpPanel.buildPanel(vitalsData).replace(/"/g,"\'") + '">';
				headerElementArray.push(newLungIcon);
				
				try {
					var CCLreqObj = new XMLCclRequest();
					CCLreqObj.onreadystatechange = function() {
						if (this.status == 200) {
							if (this.responseText != null) {
								PreOPAnVitals.VitalsPanel.VentHistory = JSON.parse(this.responseText);
							}
						}
					};
					CCLreqObj.open('GET', 'chla_ca_cc_anes_venthist_json');
					CCLreqObj.send('"MINE",' + vitalsData.PERSONID + '.00,' + vitalsData.ENCNTRID + '.00,0');
				}
				catch(err) {
					chla.eAppsUtil.Logger.LogError(err.message + ' Params: ' + CCLparms );
				}
			}
			
			if(vitalsData.VITALS_ECLS_DATA) {
				if(vitalsData.VITALS_ECLS_DATA.length > 0) {
					if(vitalsData.VITALS_ECLS_DATA[0].ON_ECLS !== 'NO') {
						var patientId = vitalsData.PERSONID;
						var encounterId = vitalsData.ENCNTRID;
						var tempImage = '',
							eclsImage = '';						
						switch(vitalsData.VITALS_ECLS_DATA[0].ON_ECLS) {
							case 'ON':
								eclsImage = 'img/ecls_on.png';
								break;
							case 'OFF':
								eclsImage = ''; //'img/ecls_off.png';
								break;
							default:
								eclsImage = '';
								break;
						}						
						if(eclsImage !== '') {
							tempImage = '<img id="' + panelId + '_ecls_icon_id2"' + ' src="' + chla.global.imgPath + eclsImage + '"' +
							'style="margin-left: 5px; margin-right: 5px; cursor:pointer;width: 32px;vertical-align: text-bottom;" title="Show IView Details">';
						}
						headerElementArray.push(tempImage);
					}
				}
			}
			
			headerElementArray.push('<div id="' + panelId + '_Details_Btn" style="padding-left: 5px; padding-right: 5px;color:blue;font-size:14:px; font-weight: 800;text-align: center; display: 	inline-block;background-color:inherit;cursor:pointer;">',
				(PreOPAnVitals.VitalsPanel.showDetailFirst ? 'Hide Details' : 'Show Detail'),
			'</div>');
			retVal.headerElementArray = headerElementArray;
		}
        return retVal;
    };
    /**
     * Parent function for construction of the UI
     * Output of the function will be an object contain a string of the total html to be render for this component
     *   All necessary presentation formation and transformation are done in this function.
     *
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @param aDtoUI {object} aDtoData object
     * @returns {object} retVal is a CC specifically defined DTO for transferring data to presentation rendering processing
     */
    PreOPAnVitals.ccnsp.processUI   = function (aObjNSbase, aObjCcBase,aDtoUI) {
		var retVal = [],
			showDetailFirst = PreOPAnVitals.VitalsPanel.showDetailFirst,
			objData = aObjCcBase.eApps.getDataDto(aObjCcBase),
			vitalsData = aObjCcBase.data.VITALS;
		var row = [
			'<tr class="<#=ODD#>">',
			'<td style="width:' + (PreOPAnVitals.VitalsPanel.dispMeasureWidth*100) + '%;"><#=DISP_MEASURE#></td>',
			'<td style="width:' + (PreOPAnVitals.VitalsPanel.lastValueWidth*100) + '%;"><#=LAST_VALUE#></td>',
			'<td style="width:' + (PreOPAnVitals.VitalsPanel.rangeWidth*100) + '%;"><#=DATA_RANGE#></td>',
			'<td style="width:' + (PreOPAnVitals.VitalsPanel.sparkCellWidth) + 'px;"><#=TREND_DATA_FAKE#></td>',
			'</tr>'
		];
		var panelId = PreOPAnVitals.panelId;
		retVal.push('<div class="eAppsHdrToolbar" style="position: absolute;right:60px;margin-left: auto; margin-top:-30px;z-index: 30;background-color:rgba(0,0,0,0);">');
		objData.headerElementArray.forEach(function(item,index){
			retVal.push(item);
		});
		retVal.push('</div>');
		retVal.push('<div id="' + panelId + '" class="eapps_CC">');
		retVal.push('<div id="' + panelId + '_TEMP_CHARTGOESHERE"></div>');
		retVal.push('<div><div id="' + panelId + '_HEART_CHARTGOESHERE"></div>');
		
		//Heart Chart Radio Buttons
		if(vitalsData.VITALS_HEART_GRAPH_DATA.length > 0 || vitalsData.VITALS_ART_HEART_GRAPH_DATA.length > 0) {
			retVal.push('<div id="' + panelId + '_HEART_CHART_RADIO_BTNS" class="centerContents" style=""><input type="radio" name="' + panelId + 'rb_heart" id="' + panelId + 'rb_heartCuff" value="cuff"><label for="' + panelId + 'rb_heartCuff">&nbsp;Cuff &nbsp;</label>&nbsp;&nbsp;&nbsp;');
			retVal.push('<input type="radio" name="' + panelId + 'rb_heart" id="' + panelId + 'rb_heart" value="art"><label for="' + panelId + 'rb_heart">&nbsp;Art Line &nbsp;</label></div></div>');
		}
		
		//Vitals Chart Summary Grid
		var headerStyle = PreOPAnVitals.ChartSummaryGrid.DataObject.hideHeaders ? 'style="display: none;"' : '';
		retVal.push('<div id="' + panelId + '_CHARTSUMMARYGOESHERE"><table><thead><tr ' + headerStyle + '>');
		retVal.push('<th style="width:' + (PreOPAnVitals.VitalsPanel.dispMeasureWidth*100) + '%;"><b>Measure</b></th>');
		retVal.push('<th style="width:' + (PreOPAnVitals.VitalsPanel.lastValueWidth*100) + '%;"><b>Last</b></th>');
		retVal.push('<th style="width:' + (PreOPAnVitals.VitalsPanel.rangeWidth*100) + '%;"><b>24hr Range</b></th>');
		retVal.push('<th style="width:' + (PreOPAnVitals.VitalsPanel.sparkCellWidth) + 'px;"><b>Trend</b></th></tr></thead><tbody>');
		PreOPAnVitals.ChartSummaryGrid.DataObject.data.forEach(
			function (value,index) {
				value.ODD = (index % 2 === 0? 'odd':'');
				retVal.push(aObjNSbase.gFuncs.parseTemplate( row.join(''), value));
			}
		);		
		retVal.push('</tbody></table></div>');
		
		//Vitals Summary Grid		
		if(!PreOPAnVitals.VitalsSummaryGrid.DataObject.data || PreOPAnVitals.VitalsSummaryGrid.DataObject.data.length == 0) {
			retVal.push('<p>No Vitals Measures Data</p>');
		} else {
			retVal.push('<br id="' + panelId + '_CHARTSUMMARY_LINEBREAK"/>');
			retVal.push('<div><table><thead style="height:1px;"><tr id="' + panelId + '_CHARTSUMMARYHEADER">');
			retVal.push('<th style="width:' + (PreOPAnVitals.VitalsPanel.dispMeasureWidth*100) + '%;"><b>Measure</b></th>');
			retVal.push('<th style="width:' + (PreOPAnVitals.VitalsPanel.lastValueWidth*100) + '%;"><b>Last</b></th>');
			retVal.push('<th style="width:' + (PreOPAnVitals.VitalsPanel.rangeWidth*100) + '%;"><b>24hr Range</b></th>');
			retVal.push('<th style="width:' + (PreOPAnVitals.VitalsPanel.sparkCellWidth) + 'px;"><b>Trend</b></th></tr></thead><tbody>');	
			if(PreOPAnVitals.VitalsSummaryGrid.DataObject.data.length > 0) {
				PreOPAnVitals.VitalsSummaryGrid.DataObject.data.forEach(
					function (value,index) {
						value.ODD = (index % 2 === 0? 'odd':'');
						retVal.push(aObjNSbase.gFuncs.parseTemplate( row.join(''), value));
					}
				);	
			} else {
				retVal.push('<tr><td colspan="4">No Vitals Measures Data</td></tr>');
			}
			retVal.push('</tbody></table></div>');
		}
			
		retVal.push('</div>');
        return retVal.join('');
    };
    /**
     * Parent function for processing functions after the UI has been render to the DOM
     *   All css,dom behaviors to be associated with UI components is handled in this function.
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    PreOPAnVitals.ccnsp.processPostCcInstance  = function (aObjNSbase, aObjCcBase) {
		var DtoData = {},
			panelId = PreOPAnVitals.panelId,
			panelWidth = $('#' + panelId).width();
		if(aObjCcBase.data && aObjCcBase.data.VITALS) {
			DtoData.vitalsData = aObjCcBase.data.VITALS;
			
			chla.eApps.gFuncs.bindFloatingHover('#' + aObjCcBase.eApps.cc_id + ' [data-qtip]', 'body', '', true, '$(this).data("qtip")', 'white');
			
			//Run this function just to set the heart & temp collected datetime min & max values
			PreOPAnVitals.VitalsPanel.BuildTempChartData(DtoData.vitalsData.VITALS_TEMP_GRAPH_DATA);
			
			//HeartChart
			(function() {
				var data = DtoData.vitalsData;
				var rd_heart = $('#' + panelId + 'rb_heart'),
					rd_cuff = $('#' + panelId + 'rb_heartCuff');
				var displayCuff = data.CUFF_EXISTS === 'YES';
				if(!displayCuff) {
					rd_cuff.attr('disabled', 'disabled');
				}
				var displayArtLine = data.ART_LINE_EXISTS === 'YES';
				if(displayArtLine) {
					PreOPAnVitals.HeartChart.buildHeartChart({
						seriesData : PreOPAnVitals.HeartChart.BuildHeartChartData(DtoData.vitalsData.VITALS_ART_HEART_GRAPH_DATA, false),
						chartTargetDivId : panelId  + '_HEART_CHARTGOESHERE',
						panelId : panelId,
						panelWidth : panelWidth
					});
					$('label[for="' + panelId + 'rb_heart"]').css('color','black').attr('title', '');
					rd_heart.attr('checked', 'checked');
					rd_heart.attr('title', '');
				} else {
					$('label[for="' + panelId + 'rb_heart"]').css('color','grey').attr('title', 'No results found');
					rd_heart.attr('title', 'No results found');
					rd_heart.attr('disabled', 'disabled');
					rd_cuff.attr('checked', 'checked');
					PreOPAnVitals.HeartChart.buildHeartChart({
						seriesData : PreOPAnVitals.HeartChart.BuildHeartChartData(DtoData.vitalsData.VITALS_HEART_GRAPH_DATA, false),
						chartTargetDivId : panelId  + '_HEART_CHARTGOESHERE',
						panelId : panelId,
						panelWidth : panelWidth
					});
				}
				rd_heart.on('click', function(e) {
					if($(this).is(':checked') ) {
						$("#" + panelId + '_HEART_CHARTGOESHERE').empty();
						PreOPAnVitals.HeartChart.buildHeartChart({
							seriesData : PreOPAnVitals.HeartChart.BuildHeartChartData(DtoData.vitalsData.VITALS_ART_HEART_GRAPH_DATA, false),
							chartTargetDivId : panelId  + '_HEART_CHARTGOESHERE',
							panelId : panelId,
							panelWidth : panelWidth
						});
					}
				});
				rd_cuff.on('click', function(e) {
					if($(this).is(':checked') ) {
						$("#" + panelId + '_HEART_CHARTGOESHERE').empty();
						PreOPAnVitals.HeartChart.buildHeartChart({
							seriesData : PreOPAnVitals.HeartChart.BuildHeartChartData(DtoData.vitalsData.VITALS_HEART_GRAPH_DATA, false),
							chartTargetDivId : panelId  + '_HEART_CHARTGOESHERE',
							panelId : panelId,
							panelWidth : panelWidth
						});
					}
				});
			})();
			setTimeout(function() { PreOPAnVitals.VitalsSummaryGrid.displayVitalsSummarySparklines(DtoData.vitalsData, panelId); }, PreOPAnVitals.ChartSummaryGrid.DataObject.displaySummarySparklinesDelay);

			PreOPAnVitals.vitalsChart.temperatureChart.inpatientVitals = PreOPAnVitals.VitalsPanel.buildTempChart({
				seriesData : PreOPAnVitals.VitalsPanel.BuildTempChartData(DtoData.vitalsData.VITALS_TEMP_GRAPH_DATA),
				panelId : panelId,
				panelWidth : panelWidth
			});
			
			if(PreOPAnVitals.VitalsPanel.showDetailFirst) {
				PreOPAnVitals.VitalsSummaryGrid.showDetail(DtoData, panelId);
			} else {
				PreOPAnVitals.VitalsSummaryGrid.hideDetail(panelId);
			}
			
			$('#' + panelId + '_Details_Btn').on('click', function(e) {
				if(this.innerText == 'Show Detail') {
					PreOPAnVitals.VitalsSummaryGrid.showDetail(DtoData, panelId);
				} else {
					PreOPAnVitals.VitalsSummaryGrid.hideDetail(panelId);
				}
			});
			
			$('#' + panelId + '_heart_icon_id2').on('click', function(e) {			
				var winHeight = 250,
					winWidth = 450;			
				var innerHTML = PreOPAnVitals.HeartPopUpPanel.buildPanel(DtoData.vitalsData);
				PreOPAnVitals.VitalsPanel.vitalsData = DtoData.vitalsData;
				if(PreOPAnVitals.VitalsPanel.vitalsData.HEMO_HIST_CHART1_SERIES.length > 0 || PreOPAnVitals.VitalsPanel.vitalsData.HEMO_HIST_CHART2_SERIES.length > 0) {
					innerHTML += '<input id="HemodynamicsChart_viewTrendsBtn" value="View Trends" type="button" style="position:absolute;top:11px;right:40px;" >';
				}
				chla.eApps.gFuncs.createFloatingPopupWindow('vitals-heart-popup', '<span style="padding-right:150px;">Hemodynamic Support</span>', innerHTML); 
				chla.eApps.gFuncs.bindDragAndDrop('vitals-heart-popup');
			});		
			
			$('#' + panelId + '_lung_icon_id2').on('click', function(e) {
				var winHeight = 250,
					winWidth = 490;			
				var innerHTML = PreOPAnVitals.LungPopUpPanel.buildPanel(DtoData.vitalsData);
				PreOPAnVitals.VitalsPanel.vitalsData = DtoData.vitalsData;
				if(PreOPAnVitals.VitalsPanel.VentHistory && PreOPAnVitals.VitalsPanel.VentHistory.VENT_HIST) {
					var vent_hist = PreOPAnVitals.VitalsPanel.VentHistory.VENT_HIST;
					if (vent_hist.VENT_HIST_CHART1_SERIES.length > 0 || 
					vent_hist.VENT_HIST_CHART2_SERIES.length > 0 || 
					vent_hist.VENT_HIST_CHART3_SERIES.length > 0 || 
					vent_hist.VENT_HIST_CHART4_SERIES.length > 0) {
						innerHTML += '<input id="VentChart_viewTrendsBtn" value="View Trends" type="button" style="position:absolute;top:11px;right:40px;" >';
					}
				}
				chla.eApps.gFuncs.createFloatingPopupWindow('vitals-lung-popup', 'Respiratory Support', innerHTML); 
				chla.eApps.gFuncs.bindDragAndDrop('vitals-lung-popup');
			});
			
			$('body').on('click', '#VentChart_viewTrendsBtn', null, function(e) {
				var winHeight = 500,
					winWidth = 900,
					data = PreOPAnVitals.VitalsPanel.VentHistory.VENT_HIST;
				if(data){
					$('#vitals-lung-popup').remove();
					$('#vent_hist_popup').remove();
					
					var innerHTML = [];
					innerHTML.push('<div id="' + panelId + '_VENT_CHART_POPUP_WIN">');
					innerHTML.push('<table><thead><tr>');
					innerHTML.push('<th width="450px"><div class="VentChartTitleClass">Oxygenation</div></th>');
					innerHTML.push('<th width="450px"><div class="VentChartTitleClass">Ventilation</div></th>');
					innerHTML.push('</tr></thead><tbody><tr>');
					innerHTML.push('<td><div id="PANEL_Vent1_CHARTGOESHERE"><div id="Vent1_CHARTGOESHERE">Vent1_CHARTGOESHERE</div></div></td>');
					innerHTML.push('<td><div id="PANEL_Vent3_CHARTGOESHERE"><div id="Vent3_CHARTGOESHERE">Vent3_CHARTGOESHERE</div></div></td>');
					innerHTML.push('</tr><tr>');
					innerHTML.push('<td><div id="PANEL_Vent2_CHARTGOESHERE"><div id="Vent2_CHARTGOESHERE">Vent2_CHARTGOESHERE</div></div></td>');
					innerHTML.push('<td><div id="PANEL_Vent4_CHARTGOESHERE"><div id="Vent4_CHARTGOESHERE">Vent4_CHARTGOESHERE</div></div></td>');
					innerHTML.push('</tr></tbody></table>');
					innerHTML.push('</div>');				
					
					chla.eApps.gFuncs.createFloatingPopupWindow('vent_hist_popup', 'Vent Trends', innerHTML.join('')); 
					chla.eApps.gFuncs.bindDragAndDrop('vent_hist_popup');
					
					if(data.VENT_HIST_CHART1_SERIES.length > 0) {
						PreOPAnVitals.VentCharts.CreateVentChart({
							renderId : 'Vent1_CHARTGOESHERE',
							chartSeries : data.VENT_HIST_CHART1_SERIES,
							maskYaxisScale : false,
							yAxisTitle : 'Settings',
							yMin0 : 0.00,
							yMax0 : null,
							yMaxDefault0 : 50,
							yTickInterval0 : 5,
							yAxis0Adjust : 0,
							yMin1 : 0,
							yMax1 : 100,
							yTickInterval1 : 20,
							yAxis1Adjust : 0.005,
							alignTicks : false, // set to false if yAxis do not line up
							yGridLineWidth1 : 0, // set to false if yAxis do not line up
							chartTitle : '',
							spacingBottom : 15
						});
					} else {
						$('#Vent1_CHARTGOESHERE').html("<br/>No results found");
					}
					
					if(data.VENT_HIST_CHART2_SERIES.length > 0) {
						PreOPAnVitals.VentCharts.CreateVentChart({
							renderId : 'Vent2_CHARTGOESHERE',
							chartSeries : data.VENT_HIST_CHART2_SERIES,
							maskYaxisScale : false,
							yAxisTitle : 'Measures',
							yMin0 : 0,
							yMax0 : 100,
							yMaxDefault0 : 50,
							yTickInterval0 : 20,
							yAxis0Adjust : 0.020,
							yMin1 : 0,
							yMax1 : null,
							yTickInterval1 : null, //50?
							yAxis1Adjust : 0,
							alignTicks : false, // set to false if yAxis do not line up
							yGridLineWidth1 : 0, // set to 0 if yAxis do not line up
							chartTitle : '',
							spacingBottom : 15
						});
					} else {
						$('#Vent2_CHARTGOESHERE').html("<br/>No results found");
					}	
					
					if(data.VENT_HIST_CHART3_SERIES.length > 0) {
						PreOPAnVitals.VentCharts.CreateVentChart({
							renderId : 'Vent3_CHARTGOESHERE',
							chartSeries : data.VENT_HIST_CHART3_SERIES,
							maskYaxisScale : false,
							yAxisTitle : 'Settings',
							yMin0 : 0,
							yMax0 : null,
							yMaxDefault0 : 20,
							yTickInterval0 : null,
							yAxis0Adjust : 0,
							yMin1 : 0,
							yMax1 : null,
							yTickInterval1 : null,
							yAxis1Adjust : 0,
							alignTicks : false, // set to false if yAxis do not line up
							yGridLineWidth1 : 0, // set to 0 if yAxis do not line up
							chartTitle : '',
							spacingBottom : 15
						});
					} else {
						$('#Vent3_CHARTGOESHERE').html("<br/>No results found");
					}	
					
					if(data.VENT_HIST_CHART4_SERIES.length > 0) {
						PreOPAnVitals.VentCharts.CreateVentChart({
							renderId : 'Vent4_CHARTGOESHERE',
							chartSeries : data.VENT_HIST_CHART4_SERIES,
							maskYaxisScale : true,
							yAxisTitle : 'Measures',
							yMin0 : 0,
							yMax0 : null,
							yMaxDefault0 : 50,
							yTickInterval0 : null,
							yAxis0Adjust : 0,
							yMin1 : 6.7,
							yMax1 : 7.7,
							yTickInterval1 : 0.1,
							yAxis1Adjust : 0.004,
							alignTicks : false, // set to false if yAxis do not line up
							yGridLineWidth1 : 0, // set to 0 if yAxis do not line up
							chartTitle : '',
							spacingBottom : 15
						});
					} else {
						$('#Vent4_CHARTGOESHERE').html("<br/>No results found");
					}
				}
			});
		
			$('body').on('click', '#HemodynamicsChart_viewTrendsBtn', null, function(e) {
				var winHeight = 550,
					winWidth = 700,
					data = PreOPAnVitals.VitalsPanel.vitalsData;
				var paramData = data.VITALS_HEART_GRAPH_DATA;
				var skip_RR_HR = true;
				$('#vitals-heart-popup').remove();
				$('#hemodynamics_popup').remove();
				var displayCuff = data.CUFF_EXISTS === 'YES';
				var displayArtLine = data.ART_LINE_EXISTS === 'YES';
				if(displayArtLine) {
					paramData = data.VITALS_ART_HEART_GRAPH_DATA
				}
				
				var innerHTML = '<div id="' + panelId + '_Hemodynamics_CICU_CHARTGOESHERE"></div><br/><div id="' + panelId + '_HEART_POPUP_CHARTGOESHERE"></div>';
				if(data.VITALS_HEART_GRAPH_DATA.length > 0 || data.VITALS_ART_HEART_GRAPH_DATA.length > 0) {
					innerHTML += '<div id="' + panelId + '_HEMO_HEART_CHART_RADIO_BTNS" class="centerContents" style=""><input type="radio" ' + (displayCuff ? '' : 'disabled="disabled"') + (displayArtLine ? '' : 'checked="checked"') + ' name="' + panelId + 'rb_heart_hemo" id="' + panelId + 'rb_heartCuff_hemo" value="cuff"><label for="' + panelId + 'rb_heartCuff_hemo">&nbsp;Cuff &nbsp;</label>&nbsp;&nbsp;&nbsp;';
					innerHTML += '<input type="radio"' + (displayArtLine ? 'checked="checked"' : 'disabled="disabled"') + ' name="' + panelId + 'rb_heart_hemo" id="' + panelId + 'rb_heart_hemo" value="art"><label for="' + panelId + 'rb_heart_hemo">&nbsp;Art Line &nbsp;</label></div></div>';
				}
				
				chla.eApps.gFuncs.createFloatingPopupWindow('hemodynamics_popup', 'Hemodynamics Trends', innerHTML); 
				chla.eApps.gFuncs.bindDragAndDrop('hemodynamics_popup');
				PreOPAnVitals.HemodynamicsChart.DrawHemodynamicsChart(data);
				PreOPAnVitals.HeartChart.buildHeartChart({
					seriesData : PreOPAnVitals.HeartChart.BuildHeartChartData(paramData, skip_RR_HR),
					chartTargetDivId : panelId  + '_HEART_POPUP_CHARTGOESHERE',
					panelId : panelId,
					panelWidth : winWidth - 50,
					marginLeft : 40
				});
			});
			
			$('body').on('click', '#' + panelId + 'rb_heartCuff_hemo', null, function(e) {
				var winHeight = 550,
					winWidth = 700,
					skip_RR_HR = true;
				$('#' + panelId  + '_HEART_POPUP_CHARTGOESHERE').empty();
				PreOPAnVitals.HeartChart.buildHeartChart({
					seriesData : PreOPAnVitals.HeartChart.BuildHeartChartData(PreOPAnVitals.VitalsPanel.vitalsData.VITALS_HEART_GRAPH_DATA, skip_RR_HR),
					chartTargetDivId : panelId  + '_HEART_POPUP_CHARTGOESHERE',
					panelId : panelId,
					panelWidth : winWidth - 50,
					marginLeft : 40
				});
			});
			
			$('body').on('click', '#' + panelId + 'rb_heart_hemo', null, function(e) {
				var winHeight = 550,
					winWidth = 700,
					skip_RR_HR = true;
				$('#' + panelId  + '_HEART_POPUP_CHARTGOESHERE').empty();
				PreOPAnVitals.HeartChart.buildHeartChart({
					seriesData : PreOPAnVitals.HeartChart.BuildHeartChartData(PreOPAnVitals.VitalsPanel.vitalsData.VITALS_ART_HEART_GRAPH_DATA, skip_RR_HR),
					chartTargetDivId : panelId  + '_HEART_POPUP_CHARTGOESHERE',
					panelId : panelId,
					panelWidth : winWidth - 50,
					marginLeft : 40
				});
			});
			
			$('#' + panelId + '_ecls_icon_id2').on('click', function(e) {
				var taskObject = window.external.DiscernObjectFactory("TASKDOC"); //creates task documentation object
				taskObject.LaunchIView("cardiac device management", "Cardiac Device Management", "Provider Notified", aObjCcBase.eApps.personId, aObjCcBase.eApps.encounterId); 
			});
		}
	};    
	/**
     *  Call to build CC and to render to CC framework
     */
    PreOPAnVitals.ccnsp.ProcessCtl(PreOPAnVitals.ccnsp,component);
}
chla['PreOPAnLineTubeDrain'].prototype.render = function() {
    'use strict';
    var  component = this,
        /**
         * variable to contain working object for cc rendering
         */
        PreOPAnLineTubeDrain;
    /**
     *  initialize the variable with the CC Module base class
     */
    PreOPAnLineTubeDrain  = chla.eAppsClass.gCcModule.createCcModuleCls.neo();
    /*----------------------------------------------------*/
    /* Replace these functions with this CC specific code.*/
    /*----------------------------------------------------*/
    /**
     * Parent function for processing initialization specifically for the CC
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    PreOPAnLineTubeDrain.ccnsp.postInit  = function (aObjNSbase, aObjCcBase) { };
    /**
     * Parent function for processing the JSON data received for display
     * Output of this function will be an object tha contains data items to be used in the presentation construction process.
     *  All data validation and transformations are done in this function
     *
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @param aDtoData {object} Dto object specifically defined by RPTDATA response from CCL request
     * @returns {*} {object} retVal is a CC specifically defined DTO for transferring data to presentation processing
     */
    PreOPAnLineTubeDrain.ccnsp.processData = function (aObjNSbase, aObjCcBase,aDtoData) {
        var retVal = {},
			VTDGroups = {},
			DtoData;
		retVal.VTDGroups = [];
		if(aObjCcBase.data && aObjCcBase.data.VTD && aObjCcBase.data.VTD.DATA) {
			DtoData = aObjCcBase.data.VTD.DATA;
			if(DtoData.length == 0) {
				return false;
			}
			DtoData.forEach(
				function (result) {
					if(typeof VTDGroups[result.VTD_SORT] === "undefined") {
						VTDGroups[result.VTD_SORT] = [];
					}
					VTDGroups[result.VTD_SORT].push(result);
				}
			);
		} else {
			return false;
		}
		var arrWrkKeys = Object.keys(VTDGroups);
		arrWrkKeys.sort();
		arrWrkKeys.forEach(
			function (value) {
				retVal.VTDGroups.push({
					"Section": VTDGroups[value][0].VTD_LABEL,
					"SortOrder": VTDGroups[value][0].VTD_SORT,
					"VTD": VTDGroups[value]
				});
			}
		);
        return retVal;
    };

    /**
     * Parent function for construction of the UI
     * Output of the function will be an object contain a string of the total html to be render for this component
     *   All necessary presentation formation and transformation are done in this function.
     *
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @param aDtoUI {object} aDtoData object
     * @returns {object} retVal is a CC specifically defined DTO for transferring data to presentation rendering processing
     */
    PreOPAnLineTubeDrain.ccnsp.processUI   = function (aObjNSbase, aObjCcBase,aDtoUI) {		
		var objData = aObjCcBase.eApps.getDataDto(aObjCcBase);	
		if(!objData) {
			return 'No results found';
		}
        var retVal = [];
		retVal.push('<div class="sub-sec" id="chla-LTD">');
		if(objData && objData.VTDGroups) {
			objData.VTDGroups.forEach(
				function(group) {
					var stateClasss = group.Section.match(/Discontinued/i) ? 'collapsed greyed' : '';
					var html = '<h3 class="h3a-marker ' + stateClasss + '">' + group.Section + '</h3>'+
						'<div style="border-top:1px solid blue;padding-top:2px;">';
        //chla.eAppsUtil.Logger.LogError(JSON.stringify(group.VTD));
					group.VTD.forEach(
						function(item) {
							html += '<div class="sub-sec"><h4 class="h4a-marker collapsed" style="font-weight:800;cursor:pointer;">' + item.GROUP_NAME + '</h4>';
							html += '<div class="sub-sec-content">'+
							'<div class="content-body">'+
								'<table><tbody>'+								
									(item.INSERTED_DT_TM ? '<tr style="text-align:left;"><td style="padding-left:20px;width:190px;">Inserted:</td><td>' + item.INSERTED_DT_TM + '</td></tr>' : '') + 
									(item.LAST_EVENT_END_DT_TM ? '<tr style="text-align:left;"><td style="padding-left:20px;width:190px;">Last Charted Details:</td><td>' + item.LAST_EVENT_END_DT_TM + '</td></tr>' : '');
										
							item.GROUPER_DETAIL.forEach(
								function(detail) {
									if(!detail.LABEL.match(/Present on Admission/i) || !detail.RESULT.match(/No/i)) {
										html += '<tr style="text-align:left;">'+
											'<td style="padding-left:20px;width:190px;">' + detail.LABEL + '</td><td>' + detail.RESULT + '</td>'+
										'</tr>';
									}
								}
							);
							html += '</tbody></table>'+
								'</div>'+
							'</div>';
							html += '</div>';
						}
					);
					html += '</div>';
					retVal.push(html);
				}	
			);
		}
		retVal.push('</div>'+
			'</div>'
		);
        return retVal.join('');
    };
    /**
     * Parent function for processing functions after the UI has been render to the DOM
     *   All css,dom behaviors to be associated with UI components is handled in this function.
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    PreOPAnLineTubeDrain.ccnsp.processPostCcInstance  = function (aObjNSbase, aObjCcBase) {
		$('#chla-LTD .collapsed').next().toggle();
		//Function to expand/contract future/completed sections
		$('#chla-LTD .h3a-marker,.h4a-marker').click(function () {
			$(this).toggleClass('collapsed');
			$(this).next().toggle();
			return false;
		});
		
		chla.eApps.gFuncs.bindFloatingHover('#' + aObjCcBase.eApps.cc_id + ' h4.h4a-marker', 'body', '', true, '$(this).next().clone().show()', 'white');
	};

    /**
     *  Call to build CC and to render to CC framework
     */
    PreOPAnLineTubeDrain.ccnsp.ProcessCtl(PreOPAnLineTubeDrain.ccnsp,component);

}
chla['PreOPAnAssessPO'].prototype.render = function() {
    'use strict';
    var  component = this,
        /**
         * variable to contain working object for cc rendering
         */
        PreOPAnAssessPO;
    /**
     *  initialize the variable with the CC Module base class
     */
    PreOPAnAssessPO  = chla.eAppsClass.gCcModule.createCcModuleCls.neo();
    /*----------------------------------------------------*/
    /* Replace these functions with this CC specific code.*/
    /*----------------------------------------------------*/
    /**
     * Parent function for processing initialization specifically for the CC
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    PreOPAnAssessPO.ccnsp.postInit  = function (aObjNSbase, aObjCcBase) {
		PreOPAnAssessPO.panelId = 'PreOPAnAssessPO_';
    };
    /**
     * Parent function for processing the JSON data received for display
     * Output of this function will be an object tha contains data items to be used in the presentation construction process.
     *  All data validation and transformations are done in this function
     *
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @param aDtoData {object} Dto object specifically defined by RPTDATA response from CCL request
     * @returns {*} {object} retVal is a CC specifically defined DTO for transferring data to presentation processing
     */
    PreOPAnAssessPO.ccnsp.processData = function (aObjNSbase, aObjCcBase,aDtoData) {
		var retVal = {},
			theData,
			i = 0;
		//chla.eAppsUtil.Logger.LogError(JSON.stringify(aObjCcBase.data));
		if(aObjCcBase.data && aObjCcBase.data.PREOP) {
			theData = aObjCcBase.data.PREOP;
			if(theData.length == 0) {
				return false;
			}
			var skinGrid, 
				tubesGrid, 
				devicesGrid,
				ID_EXPOSURE='',
				HISTORY_OF_PRESSURE_ULCER='',
				PRESENT_ON_ADMISSION='',
				SICK_RECENT='',
				SICK_RECENT_DESC='',
				LOC_RECENT_TRAVEL='',
				INFECTIOUS_DISEASE='',
				CONCERNS_GROWTH_DEV='',
				COGNITIVE_MILESTONES='',
				COGNITIVE_IMPAIRMENT='',
				SOCIAL_COMM_MILESTONES='',
				SOCIAL_COMM_IMPAIRMENT='',
				HEARING_VISION_MILESTONES='',
				HEARING_VISION_IMPAIRMENT='',
				MOTOR_SKILLS_MILESTONES='',
				MOTOR_SKILLS_IMPAIRMENT='',
				MOBILITY_ASSISTANCE='',
				SENSORY_DEFICITS='',
				DEMONSTRATES_PAIN_BY='',
				SPECIAL_ELIMIN_NEEDS='',
				SPECIAL_ELIMIN_NEEDS_DETAILS='',
				SELF_CATH='',
				SELF_CATH_FREQUENCY='',
				SELF_CATH_TYPE_SIZE='',
				SELF_CATH_LAST_TIME='',
				SURG_PRESCRIPTIONS_PLAN='',
				PARENTAL_CONCERNS='',
				PREFERRED_NAME='',
				OTHER_INFO_DAY_OF_SURG='',
				NUTRITION_INFO='',
				USES_PACIFIER='',
				THICKENED_FEEDS_CONSISTENCY='',
				SWALLOWS_WITHOUT_CHOKING='',
				DEVICES_EQUIPMENT_TREATMENTS='', 
				noData;

			if (theData.FORMDATA.length > 0 ){
				for(i=0; i<theData.FORMDATA.length; i++){
					switch(theData.FORMDATA[i].FIELDKEY){
						case 'SICK_RECENT' :
							SICK_RECENT = theData.FORMDATA[i].VALUE;
							break;
						case 'SICK_RECENT_DESC' :
							SICK_RECENT_DESC = theData.FORMDATA[i].VALUE;
							break;
						case 'LOC_RECENT_TRAVEL' :
							LOC_RECENT_TRAVEL = theData.FORMDATA[i].VALUE;
							break;
						case 'INFECTIOUS_DISEASE' :
							INFECTIOUS_DISEASE = theData.FORMDATA[i].VALUE;
							break;
						case 'ID_EXPOSURE' :
							ID_EXPOSURE = theData.FORMDATA[i].VALUE;
							break;
						case 'HISTORY_OF_PRESSURE_ULCER' :
							HISTORY_OF_PRESSURE_ULCER = theData.FORMDATA[i].VALUE;
							if (HISTORY_OF_PRESSURE_ULCER.substr(0,2) === 'No'){
								HISTORY_OF_PRESSURE_ULCER = '';
							}
							break;
						case 'PRESENT_ON_ADMISSION' :
							PRESENT_ON_ADMISSION = theData.FORMDATA[i].VALUE;
							if (PRESENT_ON_ADMISSION.substr(0,2) === 'NO'){
								PRESENT_ON_ADMISSION = 'no';
							}
							break;
						case 'DEMONSTRATES_PAIN_BY' :
							DEMONSTRATES_PAIN_BY = theData.FORMDATA[i].VALUE;
							break;
						case 'SURG_PRESCRIPTIONS_PLAN' :
							SURG_PRESCRIPTIONS_PLAN = theData.FORMDATA[i].VALUE; 
							break;
						case 'OTHER_INFO_DAY_OF_SURG' :
							OTHER_INFO_DAY_OF_SURG = theData.FORMDATA[i].VALUE; 
							break;
						case 'DEVICES_EQUIPMENT_TREATMENTS':
							DEVICES_EQUIPMENT_TREATMENTS = theData.FORMDATA[i].VALUE;
							break;
						case 'PARENTAL_CONCERNS' :
							PARENTAL_CONCERNS = theData.FORMDATA[i].VALUE; 
							break;
						case 'PREFERRED_NAME' :
							PREFERRED_NAME = theData.FORMDATA[i].VALUE;
							break;
						case 'COGNITIVE_MILESTONES' :
							COGNITIVE_MILESTONES = theData.FORMDATA[i].VALUE;
							break;
						case 'COGNITIVE_IMPAIRMENT' :
							COGNITIVE_IMPAIRMENT = theData.FORMDATA[i].VALUE;
							break;
						case 'SOCIAL_COMM_MILESTONES' :
							SOCIAL_COMM_MILESTONES = theData.FORMDATA[i].VALUE;
							break;
						case 'SOCIAL_COMM_IMPAIRMENT' :
							SOCIAL_COMM_IMPAIRMENT = theData.FORMDATA[i].VALUE;
							break;			
						case 'HEARING_VISION_MILESTONES' :
							HEARING_VISION_MILESTONES = theData.FORMDATA[i].VALUE;
							break;
						case 'HEARING_VISION_IMPAIRMENT' :
							HEARING_VISION_IMPAIRMENT = theData.FORMDATA[i].VALUE;
							break;
						case 'MOTOR_SKILLS_MILESTONES' :
							MOTOR_SKILLS_MILESTONES = theData.FORMDATA[i].VALUE;
							break;
						case 'MOTOR_SKILLS_IMPAIRMENT' :
							MOTOR_SKILLS_IMPAIRMENT = theData.FORMDATA[i].VALUE;
							break;
						case 'MOBILITY_ASSISTANCE' :
							MOBILITY_ASSISTANCE = theData.FORMDATA[i].VALUE;
							break;			
						case 'SENSORY_DEFICITS' :
							SENSORY_DEFICITS = theData.FORMDATA[i].VALUE;
							break;
						case 'SPECIAL_ELIMIN_NEEDS' :
							SPECIAL_ELIMIN_NEEDS = theData.FORMDATA[i].VALUE;
							break;
						case 'SPECIAL_ELIMIN_NEEDS_DETAILS' :
							SPECIAL_ELIMIN_NEEDS_DETAILS = theData.FORMDATA[i].VALUE;
							break;
						case 'SELF_CATH' :
							SELF_CATH = theData.FORMDATA[i].VALUE;
							break;
						case 'SELF_CATH_FREQUENCY' :
							SELF_CATH_FREQUENCY = theData.FORMDATA[i].VALUE;
							break;
						case 'SELF_CATH_TYPE_SIZE' :
							SELF_CATH_TYPE_SIZE = theData.FORMDATA[i].VALUE;
							break;
						case 'SELF_CATH_LAST_TIME' :
							SELF_CATH_LAST_TIME = theData.FORMDATA[i].VALUE;
							break;
						case 'NUTRITION_INFO' :
							NUTRITION_INFO = theData.FORMDATA[i].VALUE;
							break;
						case 'USES_PACIFIER' :
							USES_PACIFIER = theData.FORMDATA[i].VALUE;
							break;					
						case 'THICKENED_FEEDS_CONSISTENCY' :
							THICKENED_FEEDS_CONSISTENCY = theData.FORMDATA[i].VALUE;
							break;
						case 'SWALLOWS_WITHOUT_CHOKING' :
							SWALLOWS_WITHOUT_CHOKING = theData.FORMDATA[i].VALUE;
							break;
						default :
							break;
					}
				}
			} else {
				noData = true;
				return false;
			}
			 
			var formData = '';
			if (SICK_RECENT === '' && ID_EXPOSURE	===	'' && PRESENT_ON_ADMISSION	===	'' && DEMONSTRATES_PAIN_BY === '' && SURG_PRESCRIPTIONS_PLAN === '' && PARENTAL_CONCERNS === '' && PREFERRED_NAME === '' && OTHER_INFO_DAY_OF_SURG === '')
			{
				formData = [];
			} else {
				formData = [
				{
					"FIELDKEY": "SICK_RECENT",
					"LABEL" : "In Usual State Of Health?",
					"VALUE" : SICK_RECENT, 
					"DESCRIPTION" : SICK_RECENT_DESC
				},{
					"FIELDKEY": "ID_EXPOSURE",
					"LABEL" : "Infectious Disease Exposure",
					"VALUE" : ID_EXPOSURE, 
					"DESCRIPTION" : (LOC_RECENT_TRAVEL ? LOC_RECENT_TRAVEL + (INFECTIOUS_DISEASE ? '; ' + INFECTIOUS_DISEASE : '') : (INFECTIOUS_DISEASE ? INFECTIOUS_DISEASE : ''))
				},{
					"FIELDKEY": "HISTORY_OF_PRESSURE_ULCER",
					"LABEL" : "History of Pressure Ulcer",
					"VALUE" : HISTORY_OF_PRESSURE_ULCER, 
					"DESCRIPTION" : '' 
				},{
					"FIELDKEY": "PRESENT_ON_ADMISSION",
					"LABEL" : "Present on arrival",
					"VALUE" : PRESENT_ON_ADMISSION, 
					"DESCRIPTION" : '' 
				},{
					"FIELDKEY": "DEMONSTRATES_PAIN_BY",
					"LABEL" : "Patient shows pain by",
					"VALUE" : DEMONSTRATES_PAIN_BY, 
					"DESCRIPTION" : '' 
				},{
					"FIELDKEY": "SURG_PRESCRIPTIONS_PLAN",
					"LABEL" : "Prescriptions",
					"VALUE" : SURG_PRESCRIPTIONS_PLAN, 
					"DESCRIPTION" : '' 
				},{
					"FIELDKEY": "PARENTAL_CONCERNS",
					"LABEL" : "Parental Concerns for Day of Surgery",
					"VALUE" : PARENTAL_CONCERNS, 
					"DESCRIPTION" : '' 
				},{
					"FIELDKEY": "OTHER_INFO_DAY_OF_SURG",
					"LABEL" : "Other Info for Day of Surgery",
					"VALUE" : OTHER_INFO_DAY_OF_SURG, 
					"DESCRIPTION" : '' 
				},{
					"FIELDKEY": "PREFERRED_NAME",
					"LABEL" : "Preferred Name",
					"VALUE" : PREFERRED_NAME, 
					"DESCRIPTION" : '' 
				}];
			}
			
			var developmentalGrid = '';
			if (COGNITIVE_MILESTONES === '' && SOCIAL_COMM_MILESTONES === '' && HEARING_VISION_MILESTONES === '' && MOTOR_SKILLS_MILESTONES === '' && MOBILITY_ASSISTANCE === '' && SENSORY_DEFICITS === '')
			{
				developmentalGrid = [];
			} else {
				developmentalGrid = [		
				{
					"LABEL" : "Cognitive",
					"VALUE" : COGNITIVE_MILESTONES,
					"DESCRIPTION" : COGNITIVE_IMPAIRMENT
				},{
					"LABEL" : "Social",
					"VALUE" : SOCIAL_COMM_MILESTONES,
					"DESCRIPTION" : SOCIAL_COMM_IMPAIRMENT
				},{
					"LABEL" : "Hearing/vision",
					"VALUE" : HEARING_VISION_MILESTONES,
					"DESCRIPTION" : HEARING_VISION_IMPAIRMENT
				},{
					"LABEL" : "Motor skills",
					"VALUE" : MOTOR_SKILLS_MILESTONES,
					"DESCRIPTION" : MOTOR_SKILLS_IMPAIRMENT
				},{
					"LABEL" : "Mobility assistance",
					"VALUE" : MOBILITY_ASSISTANCE,
					"DESCRIPTION" : ''
				},{
					"LABEL" : "Sensory deficits",
					"VALUE" : SENSORY_DEFICITS,
					"DESCRIPTION" : ''
				}];
			}
			
			var nutritionalGrid = '';
			if (THICKENED_FEEDS_CONSISTENCY === ''&& SWALLOWS_WITHOUT_CHOKING === '' && USES_PACIFIER === '' && NUTRITION_INFO === '')
			{
				nutritionalGrid = [];
			} else {
				nutritionalGrid = [
				{
					"LABEL" : "Feeding method",
					"VALUE" : NUTRITION_INFO,
					"DESCRIPTION" : ''
				},{
					"LABEL" : "Pacifier use okay",
					"VALUE" : USES_PACIFIER,
					"DESCRIPTION" : ''
				},{
					"LABEL" : "Thickened feeds consistency",
					"VALUE" : THICKENED_FEEDS_CONSISTENCY,
					"DESCRIPTION" : ''
				},{
					"LABEL" : "Swallows w/o choking",
					"VALUE" : SWALLOWS_WITHOUT_CHOKING,
					"DESCRIPTION" : ''
				}];
			}			
			
			var eliminationGrid = '';			
			if (SPECIAL_ELIMIN_NEEDS === '' && SELF_CATH === '' && SELF_CATH_FREQUENCY === '' && SELF_CATH_TYPE_SIZE === '' && SELF_CATH_LAST_TIME === '')
			{
				eliminationGrid = [];
			} else{
				eliminationGrid = [		
				{		
					"LABEL" : "Elimination needs",
					"VALUE" : SPECIAL_ELIMIN_NEEDS + ' - ' + SPECIAL_ELIMIN_NEEDS_DETAILS,
					"DESCRIPTION" : SPECIAL_ELIMIN_NEEDS_DETAILS
				},{
					"LABEL" : "Self-cath",
					"VALUE" : SELF_CATH,
					"DESCRIPTION" : ''
				},{
					"LABEL" : "Self-cath frequency",
					"VALUE" : SELF_CATH_FREQUENCY,
					"DESCRIPTION" : ''
				},{
					"LABEL" : "Self-cath type/size",
					"VALUE" : SELF_CATH_TYPE_SIZE,
					"DESCRIPTION" : ''
				},{
					"LABEL" : "Self-cath last time",
					"VALUE" : SELF_CATH_LAST_TIME,
					"DESCRIPTION" : ''
				}];
			}
			
			if(theData.SKINGRID){
				skinGrid = [];
				for(i=0; i<theData.SKINGRID.length; i++){
					skinGrid.push({
						"LOCATION": theData.SKINGRID[i].LOCATION,
						"TYPE" : theData.SKINGRID[i].TYPE,
						"DESCRIPTION" : theData.SKINGRID[i].DESCRIPTION
					});
				}
			}

			if(theData.TUBESGRID){
				tubesGrid = [];
				for(i=0; i<theData.TUBESGRID.length; i++){
					tubesGrid.push({
						"TYPE": theData.TUBESGRID[i].TYPE,
						"SIZE" : theData.TUBESGRID[i].SIZE,
						"DETAILS" : theData.TUBESGRID[i].DETAILS
					});
				}
			}

			if(theData.FORMDATA){
				devicesGrid = [];
				for(i=0; i<theData.FORMDATA.length; i++){
					if(theData.FORMDATA[i].FIELDKEY === "DEVICES_EQUIPMENT_TREATMENTS") {
						devicesGrid.push({
							"TYPE": 'Home Equipment and Supplies',
							"DETAILS" : theData.FORMDATA[i].VALUE
						});
					}
				}
			}
			
			retVal = {
				"FORMDATA" : formData,
				"SKINGRID" : skinGrid,
				"DEVELOPMENTAL" : developmentalGrid,
				"NUTRITIONAL" : nutritionalGrid,
				"ELIMINATION" : eliminationGrid,
				"TUBESGRID" : tubesGrid,
				"DEVICESGRID" : devicesGrid
			};
		} else {
			return false;
		}
        return retVal;
    };

    /**
     * Parent function for construction of the UI
     * Output of the function will be an object contain a string of the total html to be render for this component
     *   All necessary presentation formation and transformation are done in this function.
     *
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @param aDtoUI {object} aDtoData object
     * @returns {object} retVal is a CC specifically defined DTO for transferring data to presentation rendering processing
     */
    PreOPAnAssessPO.ccnsp.processUI   = function (aObjNSbase, aObjCcBase,aDtoUI) {
       var objData = aObjCcBase.eApps.getDataDto(aObjCcBase);	
		//chla.eAppsUtil.Logger.LogError(JSON.stringify(objData));
        var retVal = [];
		/* retVal.push('<div class="eAppsHdrToolbar" style="position: absolute;width:40%;margin-left:280px;margin-top:-30px;z-index: 30;background-color:rgba(0,0,0,0);">',
			'<div id="' + PreOPAnAssessPO.panelId + '_launch_form_header" style="color:blue;font-size:14:px; font-weight: 800;text-align: center; display: inline-block;background-color:inherit;cursor:pointer;">',
			'Launch Form</div>',
		'</div>'); */
		if(!objData) {
			retVal.push('No results found');
			return retVal.join('');
		}
		retVal.push('<div class="sch-preopAssessmentGrid">');
		objData.FORMDATA.forEach(
			function(item) {
				if(item.VALUE && (item.FIELDKEY != 'PRESENT_ON_ADMISSION' && item.VALUE != 'no')) {
					retVal.push('<div><b>' + item.LABEL + ': </b>' + item.VALUE + (item.DESCRIPTION ? '. ' + item.DESCRIPTION : '') + '</div>');
				}
			}
		);
		retVal.push('</div>');
		if(objData.FORMDATA.length > 0) {
			retVal.push('<p style="min-height:10px;"></p>');
		}
		
		if (objData.SKINGRID && objData.SKINGRID.length > 0){
			retVal.push('<h3 id="' + PreOPAnAssessPO.panelId + 'skinAbnormalitiesHdr" class="h3a-marker">Skin abnormalities</h3>'+
				'<table class="sch-dataTable" id="' + PreOPAnAssessPO.panelId + 'skinAbnormalitiesTable">' +
				'<tr>' + 
					'<th>Location</th>' +
					'<th>Type</th>' +
					'<th>Description</th>' +
				'</tr>'
			);
			objData.SKINGRID.forEach(
				function(item) {
					retVal.push('<tr><td>' + item.LOCATION + '</td>' +
						'<td>' + item.TYPE + '</td>' +
						'<td>' + item.DESCRIPTION + '</td></tr>'
					);
				}
			);
			retVal.push('</table>');
			retVal.push('<p style="min-height:10px;"></p>');
		}
		
		if (objData.DEVELOPMENTAL && objData.DEVELOPMENTAL.length > 0){
			retVal.push('<h3 id="' + PreOPAnAssessPO.panelId + 'developmentalHdr" class="h3a-marker">Developmental</h3>'+
				'<div id="' + PreOPAnAssessPO.panelId + 'developmentalSection" class="sch-section" style="border-top:1px solid blue;padding-top:2px;padding-left: 20px;">'
			);
			objData.DEVELOPMENTAL.forEach(
				function(item) {
					if(item.VALUE || (item.LABEL != 'Mobility assistance' && item.VALUE != 'Independent')) {
						retVal.push('<div><b>' + item.LABEL + ': </b>' + (item.VALUE == 'Evidence of impairment' && item.DESCRIPTION != '' ? item.DESCRIPTION : item.VALUE) + '</div>');
					}
				}
			);
			retVal.push('</div>');
			retVal.push('<p style="min-height:10px;"></p>');
		}
		
		if (objData.NUTRITIONAL && objData.NUTRITIONAL.length > 0){
			retVal.push('<h3 id="' + PreOPAnAssessPO.panelId + 'nutritionalHdr" class="h3a-marker">Nutrition Screen</h3>'+
				'<div id="' + PreOPAnAssessPO.panelId + 'nutritionalSection" class="sch-section" style="border-top:1px solid blue;padding-top:2px;padding-left: 20px;">'
			);
			objData.NUTRITIONAL.forEach(
				function(item) {
					if(item.VALUE) {
						retVal.push('<div><b>' + item.LABEL + ': </b>' + item.VALUE + '</div>');
					}
				}
			);
			retVal.push('</div>');
			retVal.push('<p style="min-height:10px;"></p>');
		}
		
		if (objData.ELIMINATION && objData.ELIMINATION.length > 0){
			retVal.push('<h3 id="' + PreOPAnAssessPO.panelId + 'eliminationHdr" class="h3a-marker">Special Elimination</h3>'+
				'<div id="' + PreOPAnAssessPO.panelId + 'eliminationSection" class="sch-section" style="border-top:1px solid blue;padding-top:2px;padding-left: 20px;">'
			);
			objData.ELIMINATION.forEach(
				function(item) {
					if(item.VALUE) {
						retVal.push('<div><b>' + item.LABEL + ': </b>' + item.VALUE + '</div>');
					}
				}
			);
			retVal.push('</div>');
			retVal.push('<p style="min-height:10px;"></p>');
		}
		
		if ((objData.TUBESGRID && objData.TUBESGRID.length > 0) || (objData.DEVICESGRID && objData.DEVICESGRID.length > 0)){
			retVal.push('<h3 id="' + PreOPAnAssessPO.panelId + 'tubeGridHdr" class="h3a-marker">Functional</h3>'+
				'<table class="sch-dataTable" id="' + PreOPAnAssessPO.panelId + 'tubeGridTable"  class="sch-section" style="border-top:1px solid blue;">');
			
			if (objData.TUBESGRID && objData.TUBESGRID.length > 0)  {
				retVal.push('<tr><th>Tube type</th><th>Tube size</th><th>Details</th></tr>');
				objData.TUBESGRID.forEach(
					function(item) {
						retVal.push('<tr><td>' + item.TYPE + '</td>' +
							'<td>' + item.SIZE + '</td>' +
							'<td>' + item.DETAILS + '</td></tr>'
						);
					}
				);
			}
			
			if(objData.DEVICESGRID && objData.DEVICESGRID.length > 0) {
				objData.DEVICESGRID.forEach(
					function(item) {
						retVal.push('<tr><td>' + item.TYPE + '</td>' +
							'<td colspan=2>' + item.DETAILS + '</td></tr>'
						);
					}
				);
			}
			retVal.push('</table>');
		}
        return retVal.join('');
    };
    /**
     * Parent function for processing functions after the UI has been render to the DOM
     *   All css,dom behaviors to be associated with UI components is handled in this function.
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    PreOPAnAssessPO.ccnsp.processPostCcInstance  = function (aObjNSbase, aObjCcBase) {
		var theData = aObjCcBase.data.PREOP;
		
		//Function to expand/contract future/completed sections
		$('#chla_PreOPAnAssess .h3a-marker').click(function () {
			$(this).toggleClass('collapsed');
			$(this).next().toggle();
			return false;
		});
		
		$("#" + PreOPAnAssessPO.panelId + "_launch_form_header").click(function(e) {
			//Launch Powerform - variables...
			var chartMode = 0;  //0 = edit 1 = readOnly
			var dPersonId = theData.PERSON_ID;
			var dEncounterId = theData.ENCNTR_ID;
			var formId = 0;
			var activityId = theData.PREOP_DCP_FORMS_ACTIVITY_ID;
			
			var mpObj = window.external.DiscernObjectFactory("POWERFORM");
			mpObj.OpenForm(dPersonId, dEncounterId, formId, activityId, chartMode);
		});
	};

    /**
     *  Call to build CC and to render to CC framework
     */
    PreOPAnAssessPO.ccnsp.ProcessCtl(PreOPAnAssessPO.ccnsp,component);

}

chla['PostOpAnesth'].prototype.render = function() {
    'use strict';
    var  component = this,
        /**
         * variable to contain working object for cc rendering
         */
        PostOpAnesth;
    /**
     *  initialize the variable with the CC Module base class
     */
    PostOpAnesth  = chla.eAppsClass.gCcModule.createCcModuleCls.neo();
    /*----------------------------------------------------*/
    /* Replace these functions with this CC specific code.*/
    /*----------------------------------------------------*/
    /**
     * Parent function for processing initialization specifically for the CC
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    PostOpAnesth.ccnsp.postInit  = function (aObjNSbase, aObjCcBase) { 
		PostOpAnesth.labelRender = function (item) {
			var rc = item.LABEL;			
			if(item.LABEL === 'Anesthesia Type') {
				rc = item.VALUE;
			}			
			return '<b>' + rc + '</b>';
		};
		PostOpAnesth.valueRender = function (item) {
			var rc = item.VALUE;		
			if(item.LABEL === 'Anesthesia Type') {
				rc = '';
			}			
			return rc;
		};
	};
    /**
     * Parent function for processing the JSON data received for display
     * Output of this function will be an object tha contains data items to be used in the presentation construction process.
     *  All data validation and transformations are done in this function
     *
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @param aDtoData {object} Dto object specifically defined by RPTDATA response from CCL request
     * @returns {*} {object} retVal is a CC specifically defined DTO for transferring data to presentation processing
     */
    PostOpAnesth.ccnsp.processData = function (aObjNSbase, aObjCcBase,aDtoData) {
        var retVal = {},
		DtoData;
		
		//chla.eAppsUtil.Logger.LogError(JSON.stringify(aObjCcBase.data));
		if(aObjCcBase.data && aObjCcBase.data.POSTOP_ANESTHESIA) {
			DtoData = aObjCcBase.data.POSTOP_ANESTHESIA;	
			if(DtoData.FORMDATA.length == 0) {
				return false;
			}
			
			var newData = [];
			var curSection = '';
			var newValue = '';
			var newLabel = '';
			var newCategory = '';
			var newFormSection = '';
			var tempData;
	
			for(var i = 0; i < DtoData.FORMDATA.length; i++) {
				tempData = DtoData.FORMDATA[i];
				if(tempData.FORMSECTION === curSection) {
					newValue = newValue + '<TR style="width:100%"><TD style="width:49%">' + tempData.LABEL + 
						'</TD><TD style="width:1%">&nbsp;</TD><TD style="width:50%">' + tempData.VALUE + '</TD></TR>';
				} else {
					if(curSection !== '') {
						if(newFormSection === "Anesthesia Type") {
							newData.push(
								{
									ANES_CATEGORY : newCategory,
									FORMSECTION : newFormSection,
									LABEL : newLabel,
									VALUE : newValue
								}
							);
						} else {
							newData.push(
								{
									ANES_CATEGORY : newCategory,
									FORMSECTION : newFormSection,
									LABEL : newLabel,
									VALUE : newValue + '</TABLE>'
								}
							);
						}
					}
					curSection = tempData.FORMSECTION;
					newCategory = tempData.ANES_CATEGORY;
					newFormSection = tempData.FORMSECTION;
					if(tempData.FORMSECTION === 'Anesthesia Type') {
						newLabel = tempData.FORMSECTION;
					} else {
						newLabel = tempData.FORMSECTION.substring(0,newFormSection.lastIndexOf('-'));
					}
					if(tempData.LABEL === 'Anesthesia Type') {
						newValue = tempData.VALUE;
					} else {
						newValue = '<TABLE style="width:100%"><TR style="width:100%"><TD style="width:49%">' + tempData.LABEL + 
							'</TD><TD style="width:1%">&nbsp;</TD><TD style="width:50%">' + tempData.VALUE + '</TD></TR>';
					}
				}
			}

			if(curSection !== '') {
				newData.push(
					{
						ANES_CATEGORY : newCategory,
						FORMSECTION : newFormSection,
						LABEL : newLabel,
						VALUE : newValue + '</TABLE>'
					}
				);
			}
			//chla.eAppsUtil.Logger.LogError(JSON.stringify(newData));
			retVal.newData = newData;
		} else { 
			return false;
		}		
        return retVal;
    };
    /**
     * Parent function for construction of the UI
     * Output of the function will be an object contain a string of the total html to be render for this component
     *   All necessary presentation formation and transformation are done in this function.
     *
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @param aDtoUI {object} aDtoData object
     * @returns {object} retVal is a CC specifically defined DTO for transferring data to presentation rendering processing
     */
    PostOpAnesth.ccnsp.processUI   = function (aObjNSbase, aObjCcBase,aDtoUI) {	
		var objData = aObjCcBase.eApps.getDataDto(aObjCcBase);	
		if(!objData) {
			return 'No results found';
		}
        var retVal = [];
		objData.newData.sort(function(a,b) { return (a.ANES_CATEGORY > b.ANES_CATEGORY) ? 1 : ((b.ANES_CATEGORY > a.ANES_CATEGORY) ? -1 : 0);} );
		objData.newData.forEach(function(item, index) {
			if(index > 0) {
				var newindex = index - 1;
				if(item.ANES_CATEGORY === objData.newData[newindex].ANES_CATEGORY) {
				   //DON’T INSERT H3
					retVal.push('<div style="padding-top: 2px; border-top-color: blue; border-top-width: 1px; border-top-style: solid;">' +
						'<table><tr><td width="125">' + PostOpAnesth.labelRender(item) + '</td><td>' + PostOpAnesth.valueRender(item) + '</td></tr></table></div>');
				} else {
					//INSERT H3
					retVal.push('<h3>' + item.ANES_CATEGORY.substring(1) + '</h3><div style="padding-top: 2px; border-top-color: blue; border-top-width: 1px; border-top-style: solid;">' +
						'<table><tr><td width="125">' + PostOpAnesth.labelRender(item) + '</td><td>' + PostOpAnesth.valueRender(item) + '</td></tr></table></div>');
				}
			} else {
				retVal.push('<h3>' + item.ANES_CATEGORY.substring(1) + '</h3><div style="padding-top: 2px; border-top-color: blue; border-top-width: 1px; border-top-style: solid;">' +
					'<table><tr><td width="125">' + PostOpAnesth.labelRender(item) + '</td><td>' + PostOpAnesth.valueRender(item) + '</td></tr></table></div>');
			}
		});
        return retVal.join('');
    };
    /**
     * Parent function for processing functions after the UI has been render to the DOM
     *   All css,dom behaviors to be associated with UI components is handled in this function.
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    PostOpAnesth.ccnsp.processPostCcInstance  = function (aObjNSbase, aObjCcBase) {};

    /**
     *  Call to build CC and to render to CC framework
     */
    PostOpAnesth.ccnsp.ProcessCtl(PostOpAnesth.ccnsp,component);
}
chla['IntraOpNurse'].prototype.render = function() {
    'use strict';
    var  component = this,
        /**
         * variable to contain working object for cc rendering
         */
        IntraOpNurse;
    /**
     *  initialize the variable with the CC Module base class
     */
    IntraOpNurse  = chla.eAppsClass.gCcModule.createCcModuleCls.neo();
    /*----------------------------------------------------*/
    /* Replace these functions with this CC specific code.*/
    /*----------------------------------------------------*/
    /**
     * Parent function for processing initialization specifically for the CC
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    IntraOpNurse.ccnsp.postInit  = function (aObjNSbase, aObjCcBase) {
		IntraOpNurse.SectionHeaderRenderer = function(v, record) {					
			if(v.indexOf("Circulatory Assessment") != -1) {
				v = v + " " + record.SORTKEY2 + " @ " + record.EVENTTIME;
			}			
			if(v.indexOf("IV Start") != -1) {
				v = v + " " + record.SORTKEY2 + " @ " + record.EVENTTIME;
			}			
			if(v.indexOf("Dressing\/Packing") != -1) {
				v = v + " " + record.SORTKEY2 + " @ " + record.EVENTTIME;
			}			
			return v;			
		}
    };
    /**
     * Parent function for processing the JSON data received for display
     * Output of this function will be an object tha contains data items to be used in the presentation construction process.
     *  All data validation and transformations are done in this function
     *
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @param aDtoData {object} Dto object specifically defined by RPTDATA response from CCL request
     * @returns {*} {object} retVal is a CC specifically defined DTO for transferring data to presentation processing
     */
    IntraOpNurse.ccnsp.processData = function (aObjNSbase, aObjCcBase,aDtoData) {
        var retVal = {},
			tabs = {},
			DtoData;
		
		//chla.eAppsUtil.Logger.LogError(JSON.stringify(DtoData));
		if(aObjCcBase.data && aObjCcBase.data.INTRAOP_NURSING) {
			DtoData = aObjCcBase.data.INTRAOP_NURSING;
			if(DtoData.FORMDATA.length == 0) {
				return false;
			}
			DtoData.FORMDATA.forEach(
				function(item) {
					if(typeof tabs[item.SURG_CASE_NBR_FORMATTED] === "undefined") {
						tabs[item.SURG_CASE_NBR_FORMATTED] = {};
					}
					var formHeader = IntraOpNurse.SectionHeaderRenderer(item.FORMSECTION, item);
					if(typeof tabs[item.SURG_CASE_NBR_FORMATTED][formHeader] === "undefined") {
						tabs[item.SURG_CASE_NBR_FORMATTED][formHeader] = {};
					}
					var sortKey = item.SORTKEY2 + '' + item.SORTKEY3;
					if(typeof tabs[item.SURG_CASE_NBR_FORMATTED][formHeader][sortKey] === "undefined") {
						tabs[item.SURG_CASE_NBR_FORMATTED][formHeader][sortKey] = [];
					}
					tabs[item.SURG_CASE_NBR_FORMATTED][formHeader][sortKey].push({ 
						SURG_CASE_NBR_FORMATTED: item.SURG_CASE_NBR_FORMATTED,
						FORMSECTION: item.FORMSECTION,
						SECTIONHEADER: formHeader,
						LABEL: item.LABEL,
						VALUE: item.VALUE
					});
				}
			);
			retVal.Tabs = tabs;
			chla.eAppsUtil.Logger.LogError(JSON.stringify(tabs));
			
			/* var arrWrkKeys = Object.keys(Tabs);
			arrWrkKeys.sort();
			arrWrkKeys.forEach(
				function (value) {
					retVal.tabs.push({
						"Section": Tabs[value][0].VTD_LABEL,
						"SortOrder": Tabs[value][0].VTD_SORT,
						"VTD": Tabs[value]
					});
				}
			); */
		} else {
			return false;
		}
        return retVal;
    };

    /**
     * Parent function for construction of the UI
     * Output of the function will be an object contain a string of the total html to be render for this component
     *   All necessary presentation formation and transformation are done in this function.
     *
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @param aDtoUI {object} aDtoData object
     * @returns {object} retVal is a CC specifically defined DTO for transferring data to presentation rendering processing
     */
    IntraOpNurse.ccnsp.processUI   = function (aObjNSbase, aObjCcBase,aDtoUI) {	
		var retVal = [],
			DtoData;
		var first = true;
		var baseID = 'IntraOpNurse';
		if(aObjCcBase.data && aObjCcBase.data.INTRAOP_NURSING) { 
			DtoData = aObjCcBase.data.INTRAOP_NURSING;
			if(DtoData.SEDATION_NOTE_ID && DtoData.SEDATION_NOTE) {
				retVal.push('<a href="#" id="IntraOpNurse_launch_note_header" title="Click to view: ' + DtoData.SEDATION_NOTE + '" onclick="return false;">' + DtoData.SEDATION_NOTE + '</a>');
			}
		}
		var objData = aObjCcBase.eApps.getDataDto(aObjCcBase);	
		if(!objData) {
			if(retVal.length == 0) 
				retVal.push('No results found');
			return retVal.join('');
		}
        var liList = [],
			contentList = [];
 		
		var arrCaseKeys = Object.keys(objData.Tabs);
		arrCaseKeys.sort();
		arrCaseKeys.forEach(
			function (surgery) {
				liList.push('<li><a href="#tab_' + surgery + '" class="' + (first ? 'active' : '') + '">' + surgery + '</a></li>');
				first = false;
				contentList.push('<div id="tab_' + surgery + '" class="chla_tab">');
				
				var arrSectionKeys = Object.keys(objData.Tabs[surgery]);
				arrSectionKeys.sort();
				arrSectionKeys.forEach(
					function (section) {
						contentList.push('<h3>' + section + '</h3><p style="padding-top: 2px; border-top-color: blue; border-top-width: 1px; border-top-style: solid;">');
						contentList.push('<table><tbody>');
						
						var arrGroupKeys = Object.keys(objData.Tabs[surgery][section]);
						arrGroupKeys.sort();
						arrGroupKeys.forEach(
							function (group) {
								objData.Tabs[surgery][section][group].forEach(
									function (item) {
										contentList.push('<tr><td>' + item.LABEL + '</td><td>' + item.VALUE + '</td></tr>');
									}
								);								
							}
						);
						
						contentList.push('</tbody></table>');
						contentList.push('</p>');
					}
				);
				
				contentList.push('</div>');
			}
		);  
		
 		retVal.push('<div class="chla_tab_container"><ul>');
		retVal.push(liList.join(''));
		retVal.push('</ul>');		
		retVal.push(contentList.join(''));
        retVal.push('</div>');
		return retVal.join('');
    };
    /**
     * Parent function for processing functions after the UI has been render to the DOM
     *   All css,dom behaviors to be associated with UI components is handled in this function.
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    IntraOpNurse.ccnsp.processPostCcInstance  = function (aObjNSbase, aObjCcBase) {		
		var objData = aObjCcBase.eApps.getDataDto(aObjCcBase);	
		if(objData) {
			chla.eApps.gFuncs.makeHorizontalTabs('#' + aObjCcBase.eApps.cc_id);
		}
		$("#IntraOpNurse_launch_note_header").on('click', function(e) {
			if(aObjCcBase.data && aObjCcBase.data.INTRAOP_NURSING) {
				var theData = aObjCcBase.data.INTRAOP_NURSING;
				var paramArr = [];
				paramArr.push(theData.PERSON_ID);
				paramArr.push(theData.ENCNTR_ID);
				paramArr.push("[" + theData.SEDATION_NOTE_ID + "]");
				paramArr.push("");
				paramArr.push("7");
				paramArr.push("");
				paramArr.push("");
				paramArr.push("");
				paramArr.push("");			
				var sendstr = paramArr.join("|");
				MPAGES_EVENT('CLINICALNOTE', sendstr);
			}
		});
	};

    /**
     *  Call to build CC and to render to CC framework
     */
    IntraOpNurse.ccnsp.ProcessCtl(IntraOpNurse.ccnsp,component);

}
chla['AnesthMeds'].prototype.render = function() {
    'use strict';
    var  component = this,
        /**
         * variable to contain working object for cc rendering
         */
        AnesthMeds;
    /**
     *  initialize the variable with the CC Module base class
     */
    AnesthMeds  = chla.eAppsClass.gCcModule.createCcModuleCls.neo();
    /*----------------------------------------------------*/
    /* Replace these functions with this CC specific code.*/
    /*----------------------------------------------------*/
    /**
     * Parent function for processing initialization specifically for the CC
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    AnesthMeds.ccnsp.postInit  = function (aObjNSbase, aObjCcBase) { };
    /**
     * Parent function for processing the JSON data received for display
     * Output of this function will be an object tha contains data items to be used in the presentation construction process.
     *  All data validation and transformations are done in this function
     *
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @param aDtoData {object} Dto object specifically defined by RPTDATA response from CCL request
     * @returns {*} {object} retVal is a CC specifically defined DTO for transferring data to presentation processing
     */
    AnesthMeds.ccnsp.processData = function (aObjNSbase, aObjCcBase,aDtoData) {
        var retVal = {},
			MedGroups = {},
			DtoData;
		retVal.MedGroups = [];
		//chla.eAppsUtil.Logger.LogError(JSON.stringify(aObjCcBase.data));
		if(aObjCcBase.data && aObjCcBase.data.MEDICATIONS && aObjCcBase.data.MEDICATIONS.CURRENT_MEDS) {
			DtoData = aObjCcBase.data.MEDICATIONS.CURRENT_MEDS;
			if(DtoData.length == 0) {
				return false;
			}
			DtoData.forEach(
				function (result) {
					if(typeof MedGroups[result.ANE_SECTION_SORT_ORDER] === "undefined") {
						MedGroups[result.ANE_SECTION_SORT_ORDER] = [];
					}
					MedGroups[result.ANE_SECTION_SORT_ORDER].push(result);
				}
			);
		} else {
			return false;
		}
		var arrWrkKeys = Object.keys(MedGroups);
		arrWrkKeys.sort();
		arrWrkKeys.forEach(
			function (value) {
				retVal.MedGroups.push({
					"Section": MedGroups[value][0].ANE_MED_SECTION,
					"SortOrder": MedGroups[value][0].ANE_SECTION_SORT_ORDER,
					"Color": MedGroups[value][0].ANE_MED_COLOR,
					"Meds": MedGroups[value]
				});
			}
		);
		//chla.eAppsUtil.Logger.LogError(JSON.stringify(retVal));
        return retVal;
    };

    /**
     * Parent function for construction of the UI
     * Output of the function will be an object contain a string of the total html to be render for this component
     *   All necessary presentation formation and transformation are done in this function.
     *
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @param aDtoUI {object} aDtoData object
     * @returns {object} retVal is a CC specifically defined DTO for transferring data to presentation rendering processing
     */
    AnesthMeds.ccnsp.processUI   = function (aObjNSbase, aObjCcBase,aDtoUI) {
		var objData = aObjCcBase.eApps.getDataDto(aObjCcBase);		
		if(!objData) {
			return 'No results found';
		}
		//chla.eAppsUtil.Logger.LogError(JSON.stringify(objData));
        var retVal = [];
		retVal.push('<div class="sub-sec" id="chla-anesthmeds">'+
			'<h2 class="fo-sub-sec-hd fo-cat-type h5a-marker expanded">Medications</h2>'+
			'<div class="sub-sec-content ">'+
				'<div class="content-body">'
		);
		if(objData && objData.MedGroups) {
			objData.MedGroups.forEach(
				function(item) {
					var html = '<div class="sub-sec" id="H6Sec_DivSubSec1' + item.SortOrder + '"><h2 class="fo-sub-sec-hd h6a-marker expanded">' + item.Section + '</h2>';
					//var rgb = item.Color, a = '0.5', matches = rgb.match(/#([\da-f]{2})([\da-f]{2})([\da-f]{2})/i), rgba = 'rgba(' + matches.slice(1).map(function(m) { return parseInt(m, 16); }).concat(a) + ')';
					html += '<div class="sub-sec-content ">';
					
					item.Meds.forEach(
						function(med) {		
							html += '<div class="content-body ' + (med.POPUP_DISPLAY_LINE ? 'h7a-marker-collapsed collapsed"' : '"') + ' style="background-color:' + item.Color + ';">'+
								'<table style="border-bottom: 2px solid ' + item.Color + ';">' +
									'<tr style="text-align: left;"><td style="width: 190px;padding-left: 31px;">' + med.MED_NAME + '</td><td>' + med.CUSTOM_DISPLAY_LINE + '</td></tr>'+
								'</table>'+
							'</div>';
							if(med.POPUP_DISPLAY_LINE) {
								html += '<div class="content-body" style="display:none; padding-left: 40px;">' +
									med.POPUP_DISPLAY_LINE.replace(med.MED_NAME, '').replace("<br/>",'').replace("<br />",'').replace("<\/br>",'') + 
								'</div>';
							}
						}
					);
					html += '</div>';
					html += '</div>';
					retVal.push(html);
				}
			);
		}
		retVal.push('</div>'+
				'</div>'+
			'</div>'
		);
            /* '<div class="sub-sec" id="H5Sec_DivSubSec">'+
				'<h2 class="fo-sub-sec-hd fo-cat-type h5a-marker"> '+
					'<span title="icon toggle open" class="sub-sec-hd-tgl h5b-marker" style="background-image: none;">-</span> '+
					'<span class="sub-sec-title" style="background-image: none;">Continuous Infusion</span>'+
				'</h2>'+
				'<div class="sub-sec-content " id="H5Sec_DivSubSecContent">'+
					'<div class="content-body" id="H5Sec">'+
						'<div class="sub-sec" id="H6Sec_DivSubSec1">'+
							'<h2 class="fo-sub-sec-hd h6a-marker"> '+
								'<span title="icon toggle open" class="sub-sec-hd-tgl h6b-marker " style="margin-left: 15px; background-image: none;">-</span> '+
								'<span class="sub-sec-title " style="background-image: none;">Crystalloids</span>'+
							'</h2>'+
							'<div class="sub-sec-content " id="H6Sec_DivSubSecContent">'+
								'<div class="content-body" id="H6Sec">'+
									'<table>'+
										'<tbody>'+
											'<tr>'+
												'<td>Lactated ringers 1,000 mL IV, Given from OS/17/2017 06:43, to o5/?? </td>'+
											'</tr>'+
										'</tbody>'+
									'</table>'+
								'</div>'+
							'</div>'+
						'</div>'+
					'</div>'+
				'</div>'+
			'</div>',
            '<div class="sub-sec" id="H5Sec_DivSubSec1">'+
				'<h2 class="fo-sub-sec-hd fo-cat-type h5a-marker"> '+
					'<span title="icon toggle open" class="sub-sec-hd-tgl h5b-marker" style="background-image: none;">-</span> '+
					'<span class="sub-sec-title   " style="background-image: none;">Medications</span>'+
				'</h2>'+
				'<div class="sub-sec-content " id="H5Sec_DivSubSecContent1">'+
					'<div class="content-body" id="H5Sec1">'+
						'<div class="sub-sec" id="H6Sec_DivSubSec1a">'+
							'<h2 class="fo-sub-sec-hd h6a-marker"> '+
								'<span title="icon toggle open" class="sub-sec-hd-tgl h6b-marker" style="margin-left: 15px; background-image: none;">-</span> '+
								'<span class="sub-sec-title " style="background-image: none;">Analgesics</span>'+
							'</h2>'+
							'<div class="sub-sec-content " id="H6Sec_DivSubSecContent">'+
								'<div class="content-body" id="H6Sec">'+
									'<table><tbody>'+
										'<tr style="text-align: left;">'+
											'<td style="width: 130px;">ALfentanil</td><td>800 mcg = 1.6 mL IV (In Multiple Doses)</td>'+
										'</tr>'+
										'<tr>'+
											'<td>morphine</td><td>3 mg = 3 mL IV (In Multiple Doses)</td>'+
										'</tr>'+
										'<tr>'+
											'<td>acetaminophen IV</td><td>400 mg = 40 mL IV, 05/17/2017 14:04</td>'+
										'</tr>'+
										'<tr>'+
											'<td>ketorolac</td><td>16.35 mg = 0.55 mL IV, 05/17/2017 14:18</td>'+
										'</tr>'+
									'</tbody></table>'+
								'</div>'+
							'</div>'+
						'</div>'+
						'<div class="sub-sec" id="H6Sec_DivSubSec1">'+
							'<h2 class="fo-sub-sec-hd h6a-marker"> '+
								'<span title="icon toggle open" class="sub-sec-hd-tgl h6b-marker " style="margin-left: 15px; background-image: none;">-</span> '+
								'<span class="sub-sec-title " style="background-image: none;">Antiemetics/Adjuvants</span>'+
							'</h2>'+
							'<div class="sub-sec-content " id="H6Sec_DivSubSecContent">'+
								'<div class="content-body" id="H6Sec">'+
									'<table><tbody>'+
										'<tr style="text-align: left;">'+
											'<td style="width: 130px;">Dexamethasone</td><td>4 mg = 1 mL IV, 05/17/2017 06:45</td>'+
										'</tr>'+
										'<tr>'+
											'<td>Ondansetron</td><td>4 mg = 2 mL IV, 05/17/2017 14:18</td>'+
										'</tr>'+
									'</tbody></table>'+
								'</div>'+
							'</div>'+
						'</div>'+
						'<div class="sub-sec" id="H6Sec_DivSubSec1">'+
							'<h2 class="fo-sub-sec-hd h6a-marker">'+
								'<span title="icon toggle open" class="sub-sec-hd-tgl h6b-marker " style="margin-left: 15px; background-image: none;">-</span> '+
								'<span class="sub-sec-title " style="background-image: none;">Antimicrobials</span>'+
							'</h2>'+
							'<div class="sub-sec-content " id="H6Sec_DivSubSecContent">'+
								'<div class="content-body" id="H6Sec">'+
									'<table><tbody>'+
										'<tr style="text-align: left;">'+
											'<td style="width: 130px;">ceFAZolin</td><td>2,000 mg = 2 mL IV, 05/17/2017 06:45</td>'+
										'</tr>'+
									'</tbody></table>'+
								'</div>'+
							'</div>'+
						'</div>'+
						'<div class="sub-sec" id="H6Sec_DivSubSec1"><h2 class="fo-sub-sec-hd h6a-marker"> <span title="icon toggle open" class="sub-sec-hd-tgl h6b-marker " style="margin-left: 15px; background-image: none;">-</span> <span class="sub-sec-title " style="background-image: none;">Muscle Relaxants</span></h2><div class="sub-sec-content " id="H6Sec_DivSubSecContent"><div class="content-body" id="H6Sec"><table><tbody><tr style="text-align: left;"><td style="width: 130px;">rocuronium</td><td>20 mg = 2 ml IV, 05/17/2017 06:45</td></tr></tbody></table></div>',
            '</div></div><div class="sub-sec" id="H6Sec_DivSubSec1"><h2 class="fo-sub-sec-hd h6a-marker"> <span title="icon toggle open" class="sub-sec-hd-tgl h6b-marker " style="margin-left: 15px; background-image: none;">-</span> <span class="sub-sec-title " style="background-image: none;">Other</span></h2><div class="sub-sec-content " id="H6Sec_DivSubSecContent"><div class="content-body" id="H6Sec"><table><tbody><tr style="text-align: left;"><td style="width: 130px;">albuterol</td><td>5 puff(s), inhaled 05/17/2017, 05/17/2017 14:24</td></tr></tbody></table></div></div></div></div></div></div>']; */
        //retVal.push(JSON.stringify(objData));
		return retVal.join('');
    };
    /**
     * Parent function for processing functions after the UI has been render to the DOM
     *   All css,dom behaviors to be associated with UI components is handled in this function.
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    AnesthMeds.ccnsp.processPostCcInstance  = function (aObjNSbase, aObjCcBase) {
		//Function to expand/contract future/completed sections
		$('#chla-anesthmeds .expanded').click(function () {
			$(this).toggleClass('chla-anesthmeds-marker-collapsed');
			$(this).next().toggle();
			return false;
		});
		$('#chla-anesthmeds .collapsed').click(function () {
			$(this).toggleClass('chla-anesthmeds-marker-expanded');
			$(this).next().toggle();
			return false;
		});
	};

    /**
     *  Call to build CC and to render to CC framework
     */
    AnesthMeds.ccnsp.ProcessCtl(AnesthMeds.ccnsp,component);

}
chla['AnesthIO'].prototype.render = function() {
    'use strict';
    var component = this,
        /**
         * variable to contain working object for cc rendering
         */
        AnesthIO;
    /**
     *  initialize the variable with the CC Module base class
     */
    AnesthIO = chla.eAppsClass.gCcModule.createCcModuleCls.neo();
    /*----------------------------------------------------*/
    /* Replace these functions with this CC specific code.*/
    /*----------------------------------------------------*/
    /**
     * Parent function for processing initialization specifically for the CC
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    AnesthIO.ccnsp.postInit = function (aObjNSbase, aObjCcBase) {};

    /**
     * Parent function for processing the JSON data received for display
     * Output of this function will be an object tha contains data items to be used in the presentation construction process.
     *  All data validation and transformations are done in this function
     *
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @param aDtoData {object} Dto object specifically defined by RPTDATA response from CCL request
     * @returns {*} {object} retVal is a CC specifically defined DTO for transferring data to presentation processing
     */
    AnesthIO.ccnsp.processData = function (aObjNSbase, aObjCcBase, aDtoData) {
        var retVal = {};
        //chla.eAppsUtil.Logger.LogError(JSON.stringify(aObjCcBase.Data));
        return retVal;
    };

    /**
     * Parent function for construction of the UI
     * Output of the function will be an object contain a string of the total html to be render for this component
     *   All necessary presentation formation and transformation are done in this function.
     *
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @param aDtoUI {object} aDtoData object
     * @returns {object} retVal is a CC specifically defined DTO for transferring data to presentation rendering processing
     */
    AnesthIO.ccnsp.processUI = function (aObjNSbase, aObjCcBase, aDtoUI) {
        var data = aObjCcBase.data;

        // Transform object from numbered array to associative array

        var dataTransformed = {};
        for (var i = 0; i < data.IO_DETAILS.IO_DAY_DETAILS.length; i++) {
            dataTransformed[data.IO_DETAILS.IO_DAY_DETAILS[i].LABEL] = {
                "total": data.IO_DETAILS.IO_DAY_DETAILS[i].TOTAL,
                "dataType": data.IO_DETAILS.IO_DAY_DETAILS[i].DATA_TYPE_IND,
                "day": data.IO_DETAILS.IO_DAY_DETAILS[i].DAY,
            }
            if (dataTransformed[data.IO_DETAILS.IO_DAY_DETAILS[i].LABEL].dataType == "HD") {
                dataTransformed[data.IO_DETAILS.IO_DAY_DETAILS[i].LABEL].ioDetailsItem = []
            }
        }

        // push Intake and Output details into respective keys and delete them as standalone keys

        for (var key in dataTransformed) {
            if (dataTransformed[key].dataType == "ID") {
                dataTransformed[key].name = key;
                dataTransformed["Intake Details"].ioDetailsItem.push(dataTransformed[key])
                delete(dataTransformed[key])
            } else if (dataTransformed[key].dataType == "OD") {
                dataTransformed[key].name = key;
                dataTransformed["Output Details"].ioDetailsItem.push(dataTransformed[key])
                delete(dataTransformed[key])
            }
        }

        //chla.eAppsUtil.Logger.LogInfo(JSON.stringify(dataTransformed));
        var template =
            '<div id="anesio">\
			<div>\
				<table>\
					<tr>\
						<td class="label">Intake Total (mL)</td>\
						<td>{{Intake Total(mL).total}}</td>\
					</tr>\
					<tr>\
						<td class="label">Output Total (mL)</td>\
						<td>{{Output Total(mL).total}}</td>\
					</tr>\
					<tr>\
						<td class="balance">Balance (mL)</td>\
						<td>{{Balance(mL).total}}</td>\
					</tr>\
				</table>\
			</div>\
			<div class="level1">\
				<table>\
					<tr>\
						<td colspan="2" class="label">Intake Details</td>\
					</tr>\
				</table>\
				{{#Intake Details}}\
					{{#ioDetailsItem}}\
					<div class="level2">\
						<table>\
							<tr>\
								<td class="label2">{{name}}</td>\
								<td>{{total}}</td>\
							</tr>\
						</table>\
						{{#day}}\
						{{#DET}}\
						<div class="level3">\
							<table>\
								<div>\
									<tr>\
										<td class="label3">{{LABEL}}</td>\
										<td>{{VALUE}}</td>\
									</tr>\
								</div>\
							</table>\
						</div>\
						{{/DET}}\
						{{/day}}\
					</div>\
					{{/ioDetailsItem}}\
				{{/Intake Details}}\
			</div>\
			<div class="level1">\
				<table>\
					<tr>\
						<td colspan="2" class="label">Output Details</td>\
					</tr>\
				</table>\
				{{#Output Details}}\
					{{#ioDetailsItem}}\
					<div class="level2">\
						<table>\
							<tr>\
								<td class="outputDetails">{{name}}</td>\
								<td>{{total}}</td>\
							</tr>\
						</table>\
						{{#day}}\
						{{#DET}}\
						<div class="level3">\
							<table>\
								<div>\
									<tr>\
										<td class="label3">{{LABEL}}</td>\
										<td>{{VALUE}}</td>\
									</tr>\
								</div>\
							</table>\
						</div>\
						{{/DET}}\
						{{/day}}\
					</div>\
					{{/ioDetailsItem}}\
				{{/Output Details}}\
			</div>\
		</div>';
        var output = Mustache.render(template, dataTransformed);
        return output;
    };
    /**
     * Parent function for processing functions after the UI has been render to the DOM
     *   All css,dom behaviors to be associated with UI components is handled in this function.
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    AnesthIO.ccnsp.processPostCcInstance = function (aObjNSbase, aObjCcBase) {
        //Function to expand/contract future/completed sections
        $('#anesio .level1').click(function () {
            $(this).toggleClass('anesioOpen');
            $(this).find('.level2').toggle();
            return false;
        });
        $('#anesio .level2').click(function () {
            $(this).toggleClass('anesioOpen');
            $(this).find('.level3').toggle();
            return false;
        });
    };

    /**
     *  Call to build CC and to render to CC framework
     */
    AnesthIO.ccnsp.ProcessCtl(AnesthIO.ccnsp, component);

}
chla['AnesthQA'].prototype.render = function() {
    var  component = this,
        AnesthQA;
    AnesthQA  = chla.eAppsClass.gCcModule.createCcModuleCls.neo();
    AnesthQA.ccnsp.postInit  = function (aObjNSbase, aObjCcBase) {
        var DtoData;


        aObjCcBase.eApps.app = {
            model:{},
            view: {},
            utl: {},
            sectGrpLabels:{
                //'S00':'Section',
                //'S00Q00':'QA Indicator',
                'S01':'Preoperative Indicators',
                'S01Q00':'No Event to Report',
                'S01Q01':'Inadequate Medical Evaluation',
                'S01Q02':'Inadequate Surgical Evaluation',
                'S01Q03':'Laboratory Abnormalities',
                'S01Q04':'Acute Illness: [COMMENT MANDATORY]',
                'S01Q05':'Pre-op Screening Omissions : [COMMENT MANDATORY]',
                'S01Q06':'Medication violations: [COMMENT MANDATORY]',
                'S01Q07':'NPO violations',
                'S01Q08':'Preoperative Sedation Issues',
                'S01Q09':'Surgeon Unavailable',
                'S01Q10':'Consent issues',
                'S01Q11':'Case Cancelled',
                'S01Q12':'Other: [COMMENT MANDATORY]',
                'S02':'Intraoperative',
                'S02Q00':'No Event to Report',
                'S03':'Intraoperative Respiratory Indicators',
                'S03Q00':'Unanticipated Difficult Airway',
                'S03Q01':'Anticipated Difficult Intubation',
                'S03Q02':'Incorrect ETT Positioning (mainstem, esophageal)',
                'S03Q03':'Laryngospasm requiring treatment',
                'S03Q04':'Bronchospasm requiring treatment',
                'S03Q05':'Aspiration (confirmed by symptoms or Xray)',
                'S03Q06':'Prolonged Hypoxia (<90%, >5 minutes)',
                'S03Q07':'Prolonged Hypercarbia (>60 torr, >10 minutes)',
                'S03Q08':'Pulmonary Edema: [COMMENT MANDATORY]',
                'S03Q09':'Pneumothorax: [COMMENT MANDATORY]',
                'S03Q10':'Accidental Extubation',
                'S03Q11':'Post-Extubation Croup or Stridor',
                'S03Q12':'Respiratory Arrest: [COMMENT MANDATORY]',
                'S03Q13':'Other: [COMMENT MANDATORY]',
                'S04':'Intraoperative Cardiovascular Indicators',
                'S04Q00':'Cardiac Arrest (chest compressions): [COMMENT MANDATORY]',
                'S04Q01':'Arterial Hypotension (30% < baseline for > 5 minutes)',
                'S04Q02':'Arterial Hypertension (30% > baseline for > 5 minutes)',
                'S04Q03':'Bradycardia requiring treatment',
                'S04Q04':'Tachycardia requiring treatment',
                'S04Q05':'Arrhythmia requiring treatment',
                'S04Q06':'Air Embolism: [COMMENT MANDATORY]',
                'S04Q07':'Acute Pulmonary Hypertension: [COMMENT MANDATORY]',
                'S04Q08':'Other: [COMMENT MANDATORY]',
                'S05':'Cardiac Anesthesia',
                'S05Q00':'No Event to Report',
                'S05Q01':'Unexpected Difficult Intubation',
                'S05Q02':'Accidental Extubation',
                'S05Q03':'Complication of Arterial Line Insertion',
                'S05Q04':'Complication of CVP Insertion',
                'S05Q05':'Arrhythmia with CVP Insertion requiring treatment',
                'S05Q06':'Cardiac Arrest (chest compressions)',
                'S05Q07':'Multiple CPB periods',
                'S05Q08':'Cerebral Oximetry <40% or < 20% of baseline',
                'S05Q09':'Severe Coagulopathy',
                'S05Q10':'Reopening of chest',
                'S05Q11':'Hematocrit (<20 %)',
                'S05Q12':'Unintended Hypothermia (< 36 C)',
                'S05Q13':'Pulmonary hemorrhage',
                'S05Q14':'Post-CPB Arrhythmia requiring treatment',
                'S05Q15':'Unexpected need for Nitric Oxide',
                'S05Q16':'Lactate (> 100)',
                'S05Q17':'ECMO Cannulation',
                'S05Q18':'Return to OR for Bleeding',
                'S05Q19':'Emergent transfer from Cath Lab to OR',
                'S05Q20':'Intraoperative Death: [COMMENT MANDATORY]',
                'S05Q21':'Other : [COMMENT MANDATORY]',
                'S06':'Intraoperative Pharmacolologic Indicators',
                'S06Q00':'Major Allergic Reaction: [COMMENT MANDATORY]',
                'S06Q01':'Anaphylactic/ Anaphylactoid Reaction: [COMMENT MANDATORY]',
                'S06Q02':'Wrong Medication: [COMMENT MANDATORY]',
                'S06Q03':'Wrong Dose: [COMMENT MANDATORY]',
                'S06Q04':'Wrong Route: [COMMENT MANDATORY]',
                'S06Q05':'Omission of Medication: [COMMENT MANDATORY]',
                'S06Q06':'Other: [COMMENT MANDATORY]',
                'S07':'Intraoperative Metabolic Indicators',
                'S07Q00':'Hypoglycemia ( Neonate < 40 mg/dl; Child < 60mg/dl)',
                'S07Q01':'Hyperglycemia ( > 200mg/dl)',
                'S07Q02':'Hypothermia ( < 35 degrees)',
                'S07Q03':'Hyperthermia ( > 38.5 degrees)',
                'S07Q04':'Acidosis (ph < 7.2, with normal CO2)',
                'S07Q05':'Bicarbonate  (< 18mEq/L)',
                'S07Q06':'Hypokalemia (< 3.0 mEq/L)',
                'S07Q07':'Hyperkalemia (>5.5 mEq/L)',
                'S07Q08':'Other Electrolyte Abnormalities: [COMMENT MANDATORY]',
                'S07Q09':'Urinary Output Abnormalities',
                'S07Q10':'Symptomatic Adrenocorticoid Insufficiency',
                'S07Q11':'Malignant Hyperthermia: [COMMENT MANDATORY]',
                'S07Q12':'Other: [COMMENT MANDATORY]',
                'S08':'Intraoperative Hematologic Indicators',
                'S08Q00':'Wrong Blood Product: [COMMENT MANDATORY]',
                'S08Q01':'Major Hemorrhage (> 30 ml/kg): [COMMENT MANDATORY]',
                'S08Q02':'Transfusion Reaction',
                'S08Q03':'Acquired Clotting Abnormality: [COMMENT MANDATORY]',
                'S08Q04':'New Thrombocytopenia',
                'S08Q05':'Thrombotic Event: [COMMENT MANDATORY]',
                'S08Q06':'Other: [COMMENT MANDATORY]',
                'S09':'Intraoperative Regional Anesthesia Indicators',
                'S09Q00':'Medication Error: [COMMENT MANDATORY]',
                'S09Q01':'Intravascular Injection',
                'S09Q02':'Failed Regional Technique: [COMMENT MANDATORY]',
                'S09Q03':'Local Anesthesia Toxicity: [COMMENT MANDATORY]',
                'S09Q04':'Wrong Side/Site',
                'S09Q05':'Unintended Dural Puncture',
                'S09Q06':'High Spinal or Epidural',
                'S09Q07':'Neurologic Complication: [COMMENT MANDATORY]',
                'S09Q08':'Other Injury: [COMMENT MANDATORY]',
                'S09Q09':'Infusion Errors: [COMMENT MANDATORY]',
                'S09Q10':'Other: [COMMENT MANDATORY]',
                'S10':'Intraoperative Neurologic Indicators',
                'S10Q00':'Seizures',
                'S10Q01':'New Neurologic Sign/Symptom: [COMMENT MANDATORY]',
                'S10Q02':'Surgery-related Injury: [COMMENT MANDATORY]',
                'S10Q03':'Persistent Change in Neurophysiological Signal',
                'S10Q04':'Peripheral Nerve Injury: [COMMENT MANDATORY]',
                'S10Q05':'Delayed Awakening ( > 30 minutes)',
                'S10Q06':'Other: [COMMENT MANDATORY]',
                'S11':'Intraoperative Trauma/Injury Indicators',
                'S11Q00':'Dental Injury',
                'S11Q01':'Eye Injury: [COMMENT MANDATORY]',
                'S11Q02':'Skin Injury',
                'S11Q03':'Position-related Injury: [COMMENT MANDATORY]',
                'S11Q04':'Burn Injury: [COMMENT MANDATORY]',
                'S11Q05':'Procedure-related Hematoma',
                'S11Q06':'Procedure-related Pneumothorax/Hemothorax: [COMMENT MANDATORY]',
                'S11Q07':'Procedure-related Cardiac Tamponade: [COMMENT MANDATORY]',
                'S11Q08':'Ischemia (procedure- or infusion-related)',
                'S11Q09':'Gas Ignition/Explosion: [COMMENT MANDATORY]',
                'S11Q10':'Other: [COMMENT MANDATORY]',
                'S12':'Intraoperative Surgery Service Indicators',
                'S12Q00':'Consent issues',
                'S12Q01':'Surgeon Unavailable',
                'S12Q02':'Surgery on Wrong Side/Site',
                'S12Q03':'Case Cancelled after Induction',
                'S12Q04':'Unanticipated Hemorrhage',
                'S12Q05':'Surgical Fire',
                'S12Q06':'Injury (pneumothorax, organ perforation, etc.): [COMMENT MANDATORY]',
                'S12Q07':'Positioning Injury: [COMMENT MANDATORY]',
                'S12Q08':'Prolonged Surgical Time',
                'S12Q09':'Other : [COMMENT MANDATORY]',
                'S13':'Intraoperative Miscellaneous Indicators',
                'S13Q00':'Anesthesia Equipment Problems: [COMMENT MANDATORY]',
                'S13Q01':'IV Pump Problems',
                'S13Q02':'Computer Problems',
                'S13Q03':'Other: [COMMENT MANDATORY]',
                'S14':'Sentinal Events ',
                'S14Q00':'Death',
                'S14Q01':'Cardiac Arrest',
                'S14Q02':'Acute Organ System Failure',
                'S14Q03':'Acute Lung Injury',
                'S14Q04':'Acute Cardiovascular Decompensation',
                'S14Q05':'Anaphylaxsis',
                'S14Q06':'Malignant Hyperthermia',
                'S14Q07':'Central Nervous System Injury',
                'S14Q08':'Peripheral Nerve Injury',
                'S14Q09':'Tissue Injury',
                'S14Q10':'Surgical Fire',
                'S14Q11':'Surgery on Wrong Patient',
                'S14Q12':'Surgery on Wrong Side/Site',
                'S14Q13':'Unexpected ICU Admission',
                'S14Q14':'Urgent/Emergent Same Day Return to OR',
                'S15':'Postoperative Care Indicators',
                'S15Q00':'NO EVENT TO REPORT',
                'S15Q01':'Emergence Delirium',
                'S15Q02':'Airway Instability requiring intervention',
                'S15Q03':'Emergent Re-intubation: [COMMENT MANDATORY]',
                'S15Q04':'Hypotension requiring treatment',
                'S15Q05':'Hypertension requiring treatment',
                'S15Q06':'Arrhythmia requiring treatment: [COMMENT MANDATORY]',
                'S15Q07':'Medication Error',
                'S15Q08':'Hand-off or Charting Omissions',
                'S15Q09':'Seizures',
                'S15Q10':'Persistent Hypoxia ( SA Oxygen < 90%)',
                'S15Q11':'Hypothermia (< 35 degrees)',
                'S15Q12':'Hyperthermia (> 39 degrees)',
                'S15Q13':'Shivering requiring treatment',
                'S15Q14':'Severe Pain',
                'S15Q15':'Opiate Complications ( requiring medication or intervention )',
                'S15Q16':'Vomiting not responsive to treatment',
                'S15Q17':'Premature loss of IV',
                'S15Q18':'Scheduled Medication Omitted',
                'S15Q19':'Unanticipated Anemia',
                'S15Q20':'Metabolic Complications: [COMMENT MANDATORY]',
                'S15Q21':'Hematologic Complications: [COMMENT MANDATORY]',
                'S15Q22':'Neurologic Complications: [COMMENT MANDATORY]',
                'S15Q23':'Injury ( corneal abrasion, skin etc.)',
                'S15Q24':'Delayed awakening( > 2 hours after arrival)',
                'S15Q25':'Complaint of Awareness Under Anesthesia',
                'S15Q26':'Prolonged PACU Stay: [COMMENT MANDATORY]',
                'S15Q27':'Unexpected Hospital Admission: [COMMENT MANDATORY]',
                'S15Q28':'Unexpected ICU Admission: [COMMENT MANDATORY]',
                'S15Q29':'Other: [COMMENT MANDATORY]'
            },
            sectGrpLayout:{
                //'S00Q00':'L00_S00Q00' ,
                'S01Q00':'L00_S01Q00' ,
                'S01Q01':'L01_S01Q01' ,
                'S01Q02':'L02_S01Q02' ,
                'S01Q03':'L03_S01Q03' ,
                'S01Q04':'L04_S01Q04' ,
                'S01Q05':'L05_S01Q05' ,
                'S01Q06':'L06_S01Q06' ,
                'S01Q07':'L07_S01Q07' ,
                'S01Q08':'L08_S01Q08' ,
                'S01Q09':'L09_S01Q09' ,
                'S01Q10':'L10_S01Q10' ,
                'S01Q11':'L11_S01Q11' ,
                'S01Q12':'L12_S01Q12' ,
                'S02Q00':'L00_S02Q00' ,
                'S03Q00':'L00_S03Q00' ,
                'S03Q01':'L01_S03Q01' ,
                'S03Q02':'L02_S03Q02' ,
                'S03Q03':'L03_S03Q03' ,
                'S03Q04':'L04_S03Q04' ,
                'S03Q05':'L05_S03Q05' ,
                'S03Q06':'L06_S03Q06' ,
                'S03Q07':'L07_S03Q07' ,
                'S03Q08':'L08_S03Q08' ,
                'S03Q09':'L09_S03Q09' ,
                'S03Q10':'L10_S03Q10' ,
                'S03Q11':'L11_S03Q11' ,
                'S03Q12':'L12_S03Q12' ,
                'S03Q13':'L13_S03Q13' ,
                'S04Q00':'L00_S04Q00' ,
                'S04Q01':'L01_S04Q01' ,
                'S04Q02':'L02_S04Q02' ,
                'S04Q03':'L03_S04Q03' ,
                'S04Q04':'L04_S04Q04' ,
                'S04Q05':'L05_S04Q05' ,
                'S04Q06':'L06_S04Q06' ,
                'S04Q07':'L07_S04Q07' ,
                'S04Q08':'L08_S04Q08' ,
                'S05Q00':'L00_S05Q00' ,
                'S05Q01':'L01_S05Q01' ,
                'S05Q02':'L02_S05Q02' ,
                'S05Q03':'L03_S05Q03' ,
                'S05Q04':'L04_S05Q04' ,
                'S05Q05':'L05_S05Q05' ,
                'S05Q06':'L06_S05Q06' ,
                'S05Q07':'L07_S05Q07' ,
                'S05Q08':'L08_S05Q08' ,
                'S05Q09':'L09_S05Q09' ,
                'S05Q10':'L10_S05Q10' ,
                'S05Q11':'L11_S05Q11' ,
                'S05Q12':'L12_S05Q12' ,
                'S05Q13':'L13_S05Q13' ,
                'S05Q14':'L14_S05Q14' ,
                'S05Q15':'L15_S05Q15' ,
                'S05Q16':'L16_S05Q16' ,
                'S05Q17':'L17_S05Q17' ,
                'S05Q18':'L18_S05Q18' ,
                'S05Q19':'L19_S05Q19' ,
                'S05Q20':'L20_S05Q20' ,
                'S05Q21':'L21_S05Q21' ,
                'S06Q00':'L00_S06Q00' ,
                'S06Q01':'L01_S06Q01' ,
                'S06Q02':'L02_S06Q02' ,
                'S06Q03':'L03_S06Q03' ,
                'S06Q04':'L04_S06Q04' ,
                'S06Q05':'L05_S06Q05' ,
                'S06Q06':'L06_S06Q06' ,
                'S07Q00':'L00_S07Q00' ,
                'S07Q01':'L01_S07Q01' ,
                'S07Q02':'L02_S07Q02' ,
                'S07Q03':'L03_S07Q03' ,
                'S07Q04':'L04_S07Q04' ,
                'S07Q05':'L05_S07Q05' ,
                'S07Q06':'L06_S07Q06' ,
                'S07Q07':'L07_S07Q07' ,
                'S07Q08':'L08_S07Q08' ,
                'S07Q09':'L09_S07Q09' ,
                'S07Q10':'L10_S07Q10' ,
                'S07Q11':'L11_S07Q11' ,
                'S07Q12':'L12_S07Q12' ,
                'S08Q00':'L00_S08Q00' ,
                'S08Q01':'L01_S08Q01' ,
                'S08Q02':'L02_S08Q02' ,
                'S08Q03':'L03_S08Q03' ,
                'S08Q04':'L04_S08Q04' ,
                'S08Q05':'L05_S08Q05' ,
                'S08Q06':'L06_S08Q06' ,
                'S09Q00':'L00_S09Q00' ,
                'S09Q01':'L01_S09Q01' ,
                'S09Q02':'L02_S09Q02' ,
                'S09Q03':'L03_S09Q03' ,
                'S09Q04':'L04_S09Q04' ,
                'S09Q05':'L05_S09Q05' ,
                'S09Q06':'L06_S09Q06' ,
                'S09Q07':'L07_S09Q07' ,
                'S09Q08':'L08_S09Q08' ,
                'S09Q09':'L09_S09Q09' ,
                'S09Q10':'L10_S09Q10' ,
                'S10Q00':'L00_S10Q00' ,
                'S10Q01':'L01_S10Q01' ,
                'S10Q02':'L02_S10Q02' ,
                'S10Q03':'L03_S10Q03' ,
                'S10Q04':'L04_S10Q04' ,
                'S10Q05':'L05_S10Q05' ,
                'S10Q06':'L06_S10Q06' ,
                'S11Q00':'L00_S11Q00' ,
                'S11Q01':'L01_S11Q01' ,
                'S11Q02':'L02_S11Q02' ,
                'S11Q03':'L03_S11Q03' ,
                'S11Q04':'L04_S11Q04' ,
                'S11Q05':'L05_S11Q05' ,
                'S11Q06':'L06_S11Q06' ,
                'S11Q07':'L07_S11Q07' ,
                'S11Q08':'L08_S11Q08' ,
                'S11Q09':'L09_S11Q09' ,
                'S11Q10':'L10_S11Q10' ,
                'S12Q00':'L00_S12Q00' ,
                'S12Q01':'L01_S12Q01' ,
                'S12Q02':'L02_S12Q02' ,
                'S12Q03':'L03_S12Q03' ,
                'S12Q04':'L04_S12Q04' ,
                'S12Q05':'L05_S12Q05' ,
                'S12Q06':'L06_S12Q06' ,
                'S12Q07':'L07_S12Q07' ,
                'S12Q08':'L08_S12Q08' ,
                'S12Q09':'L09_S12Q09' ,
                'S13Q00':'L00_S13Q00' ,
                'S13Q01':'L01_S13Q01' ,
                'S13Q02':'L02_S13Q02' ,
                'S13Q03':'L03_S13Q03' ,
                'S14Q00':'L00_S14Q00' ,
                'S14Q01':'L01_S14Q01' ,
                'S14Q02':'L02_S14Q02' ,
                'S14Q03':'L03_S14Q03' ,
                'S14Q04':'L04_S14Q04' ,
                'S14Q05':'L05_S14Q05' ,
                'S14Q06':'L06_S14Q06' ,
                'S14Q07':'L07_S14Q07' ,
                'S14Q08':'L08_S14Q08' ,
                'S14Q09':'L09_S14Q09' ,
                'S14Q10':'L10_S14Q10' ,
                'S14Q11':'L11_S14Q11' ,
                'S14Q12':'L12_S14Q12' ,
                'S14Q13':'L13_S14Q13' ,
                'S14Q14':'L14_S14Q14' ,
                'S15Q00':'L00_S15Q00' ,
                'S15Q01':'L01_S15Q01' ,
                'S15Q02':'L02_S15Q02' ,
                'S15Q03':'L03_S15Q03' ,
                'S15Q04':'L04_S15Q04' ,
                'S15Q05':'L05_S15Q05' ,
                'S15Q06':'L06_S15Q06' ,
                'S15Q07':'L07_S15Q07' ,
                'S15Q08':'L08_S15Q08' ,
                'S15Q09':'L09_S15Q09' ,
                'S15Q10':'L10_S15Q10' ,
                'S15Q11':'L11_S15Q11' ,
                'S15Q12':'L12_S15Q12' ,
                'S15Q13':'L13_S15Q13' ,
                'S15Q14':'L14_S15Q14' ,
                'S15Q15':'L15_S15Q15' ,
                'S15Q16':'L16_S15Q16' ,
                'S15Q17':'L17_S15Q17' ,
                'S15Q18':'L18_S15Q18' ,
                'S15Q19':'L19_S15Q19' ,
                'S15Q20':'L20_S15Q20' ,
                'S15Q21':'L21_S15Q21' ,
                'S15Q22':'L22_S15Q22' ,
                'S15Q23':'L23_S15Q23' ,
                'S15Q24':'L24_S15Q24' ,
                'S15Q25':'L25_S15Q25' ,
                'S15Q26':'L26_S15Q26' ,
                'S15Q27':'L27_S15Q27' ,
                'S15Q28':'L28_S15Q28' ,
                'S15Q29':'L29_S15Q29'
            }
        };
        /**
         *
         * @param tabid
         * @param tabbody
         */
        aObjCcBase.eApps.app.view.openTab = function (tabid,tabbody) {
            // Get all elements with class="tabcontent" and hide them
            $("div#chla_AnesthQA div.vtabcontent").css("display",'none');
            $("div#chla_AnesthQA button.vtablinks").removeClass("active");
            // Show the current tab, and add an "active" class to the link that opened the tab
            $("div#chla_AnesthQA div#" + tabbody).css('display','block');
            $("div#chla_AnesthQA button#" + tabid).addClass('active');
        };

        /**
         *
         * @param aFunc
         * @param aParam
         * @param aObjCcBase
         */
        aObjCcBase.eApps.app.utl.handleSQLRequest = function (aFunc,aParam,aObjCcBase) {
            var WebServiceHost =
                  'http://chlampageservice.cernerasp.com',
                //  'http://10.101.136.222',
                //  'http://tchlaeappsdev01',
                //  'http://chlaiisapppvip',
                WebServiceEndPoint =   // '/AnesQAAPI/api/',
                    // '/AnesQuestAPI/api/QaQuest',
                    '/AnesQuestAPI/api',
                strWrk,
                ajaxOps = {
                    TOKEN: {
                        URL:  WebServiceHost +   '/AnesQuestAPI/api' + '/Token',
                        OPER: 'POST',
                        DATAPARAM:  aParam,
                        success:
                            /**
                             *
                             * @param data
                             * @param textStatus
                             * @param jqXHR
                             */
                            function (data, textStatus, jqXHR) {
                                var objCcBase = chla.eApps['evntHndlrObjCcBase'],
                                    DtoData;
                                objCcBase.eApps.app.Token = data; //jqXHR.getResponseHeader('Authorization');
                                DtoData = objCcBase.eApps.getDataDto(objCcBase);
                                objCcBase.eApps.app.utl.handleSQLRequest('FIN',[DtoData.fin],aObjCcBase);

                            },
                        error: function (jqXHR, textStatus, errorThrown) {
                            chla.eAppsUtil.Logger.LogError('Ajax - Failed: Get Token');
                        }
                    },
                    FIN: {
                        URL:  WebServiceHost + WebServiceEndPoint + '/QaQuest/FIN/' + aParam[0],  // '/QaQuest', //
                        OPER: 'GET',
                        DATAPARAM: '',
                        success:
                            /**
                             *
                             * @param data
                             * @param textStatus
                             * @param jqXHR
                             */
                            function (data, textStatus, jqXHR) {
                                var objCcBase = chla.eApps['evntHndlrObjCcBase'];
                                chla.eAppsUtil.Logger.LogInfo('Data' + JSON.stringify(data));
                                objCcBase.eApps.app.ProcessCtlFin.call(objCcBase,data);
                            },
                        error: function (jqXHR, textStatus, errorThrown) {
                            chla.eAppsUtil.Logger.LogError('Ajax - Failed: Load SQL-Fin');
                        }
                    },
                    PERSONID: {
                        URL:  WebServiceHost + WebServiceEndPoint + '/QaQuest/PERSONID/' + aParam[0],
                        OPER: 'GET',
                        DATAPARAM: '',
                        success:
                            /**
                             *
                             * @param data
                             * @param textStatus
                             * @param jqXHR
                             */
                            function (data, textStatus, jqXHR) {
                                var objCcBase = chla.eApps['evntHndlrObjCcBase'];
                                objCcBase.eApps.app.ProcessCtlPersonId.call(objCcBase,data);
                            },
                        error: function (jqXHR, textStatus, errorThrown) {
                            chla.eAppsUtil.Logger.LogError('Ajax - Failed: Load SQL-PersonId');
                        }
                    },
                    CASENUM:  {
                        URL:  WebServiceHost + WebServiceEndPoint + '/QaQuest/CASENUM/' + aParam[0],
                        OPER: 'GET',
                        DATAPARAM: '',
                        success:
                            /**
                             *
                             * @param data
                             * @param textStatus
                             * @param jqXHR
                             */
                            function (data, textStatus, jqXHR) {
                                var objCcBase = chla.eApps['evntHndlrObjCcBase'],
                                    ajaxData = data;
                                chla.eAppsUtil.Logger.LogInfo('Ajax - CaseNum: GET' + JSON.stringify(ajaxData));
                                objCcBase.eApps.app.ProcessCtlCaseNum.call(objCcBase,ajaxData);   //data
                            },
                        error: function (jqXHR, textStatus, errorThrown) {
                            chla.eAppsUtil.Logger.LogError('Ajax - Failed: Load SQL-CaseNumbers');
                        }
                    },
                    SAVEIT:{
                        URL:  WebServiceHost + WebServiceEndPoint + '/QaQuest',
                        OPER: 'POST',
                        DATAPARAM:  JSON.stringify( aParam),
                        success:
                            /**
                             *
                             * @param data
                             * @param textStatus
                             * @param jqXHR
                             */
                            function (data, textStatus, jqXHR) {
                                var objCcBase = chla.eApps['evntHndlrObjCcBase'],
                                    DtoData;
                                chla.eAppsUtil.Logger.LogInfo('Ajax - Successful: POST' + JSON.stringify(data));
                                DtoData = objCcBase.eApps.getDataDto(objCcBase);
                                chla.eApps.SaveButtonBehavior.enable_disable_status_reset( 'button#QABTNSave','OK');
                                objCcBase.eApps.app.utl.handleSQLRequest('FIN',[DtoData.fin],objCcBase);
                            },
                        error: function (jqXHR, textStatus, errorThrown) {
                            chla.eAppsUtil.Logger.LogError('Ajax - Failed: POST');
                        }
                    },
                    CNCLEAR: {
                        URL:  WebServiceHost + WebServiceEndPoint + '/QaQuest/CNCLEAR/' + aParam[0],
                        OPER: 'POST',
                        DATAPARAM: '',
                        success:
                            /**
                             *
                             * @param data
                             * @param textStatus
                             * @param jqXHR
                             */
                            function (data, textStatus, jqXHR) {
                                var objCcBase = chla.eApps['evntHndlrObjCcBase'],
                                    DtoData,
                                    arrItems,
                                    ajaxData = data;
                                chla.eAppsUtil.Logger.LogInfo('Ajax - CNCLEAR: GET' + JSON.stringify(ajaxData));
                                DtoData = objCcBase.eApps.getDataDto(objCcBase);
                                arrItems = Object.keys(DtoData.CaseNums);
                                arrItems.forEach(
                                    function(caseNum){
                                        DtoData.CaseNums[caseNum].IsPreOp =  'No';
                                        DtoData.CaseNums[caseNum].IsIntraOp = 'No';
                                        DtoData.CaseNums[caseNum].IsPostOp = 'No';
                                    });
                                chla.eApps.SaveButtonBehavior.enable_disable_status_reset( 'button#QABTNSave','OK');
                                objCcBase.eApps.app.utl.handleSQLRequest('FIN',[DtoData.fin],objCcBase);
                            },
                        error: function () { //jqXHR, textStatus, errorThrown) {
                            chla.eAppsUtil.Logger.LogError('Ajax - Failed: Load SQL-CNCLEAR');
                        }
                    }
                },
                objCfg = {
                    crossDomain: true,
                    url             : ajaxOps[aFunc].URL,
                    type            : ajaxOps[aFunc].OPER,
                    contentType     : 'application/json; charset=UTF-8',
                    'Cache-Control' : 'no-cache',
                    data            : ajaxOps[aFunc].DATAPARAM,
                    success         : ajaxOps[aFunc].success,
                    dataType        : "json"
                };
            chla.eApps['evntHndlrObjCcBase'] = aObjCcBase;
            strWrk = ajaxOps[aFunc].DATAPARAM;
            if ( aFunc !== 'TOKEN'){
                objCfg.beforeSend =  function (xhr) {
                    var objCcBase =  chla.eApps['evntHndlrObjCcBase'];
                    xhr.setRequestHeader( "Access-Control-Allow-Methods", "GET, POST, PUT, DELETE, OPTIONS");
                    xhr.setRequestHeader( 'Authorization', objCcBase.eApps.app.Token);
                    xhr.setRequestHeader('zumo-api-version', "2.0.0");
                };
            } else {
                strWrk = 'userid/password';
            }
            chla.eAppsUtil.Logger.LogInfo('WebService:' + ajaxOps[aFunc].URL + ' :: ' + strWrk );
            jQuery.support.cors = true;
            if ( aFunc !== 'SAVEIT' &&  aFunc !== 'TOKEN' &&  aFunc !== 'CNCLEAR'){
                objCfg.context = aObjCcBase;
            }
            $.ajax(objCfg);

        };

        /**
         *
         * @param aObjCcBase
         */
        aObjCcBase.eApps.app.processSQLDataFin = function ( aObjCcBase) {
            var DtoSqlData,
                DtoData = aObjCcBase.eApps.getDataDto(aObjCcBase);
            DtoSqlData = DtoData.SqlData;
            DtoSqlData.forEach(
                function(item){
                    var strWrk;
                    if (typeof item.CASE_NUM === 'undefined'){
                        strWrk = item.replace(/-/g,'');
                        if (typeof DtoData.CaseNums[strWrk] !== 'undefined'){
                            DtoData.CaseNums[strWrk].SqlData = 'Yes';
                        }
                    } else {
                        strWrk = item.CASE_NUM.replace(/-/g, '');
                        if (typeof DtoData.CaseNums[strWrk] !== 'undefined') {
                            DtoData.CaseNums[strWrk].IsPreOp = (item.IsPreOp === '0' ? 'No' : 'Yes');
                            DtoData.CaseNums[strWrk].IsIntraOp = (item.IsIntraOp === '0' ? 'No' : 'Yes');
                            DtoData.CaseNums[strWrk].IsPostOp = (item.IsPostOp === '0' ? 'No' : 'Yes');
                            DtoData.CaseNums[strWrk].SqlData = 'Yes';
                        }
                    }
                }
            );
        };
        /**
         *
         * @param aObjCcBase
         */
        aObjCcBase.eApps.app.processSQLDataCaseNum = function (aObjCcBase) {
            var DtoSqlData,
                DtoData = aObjCcBase.eApps.getDataDto(aObjCcBase),
                arrQaQuest = [];
            DtoSqlData = DtoData.SqlData;
            if (typeof DtoSqlData.NoData === 'undefined') {
                DtoSqlData.forEach(
                    function (item) {
                        if (item.ACTIVE_IND === 1) {
                            arrQaQuest.push(
                                {
                                    targetSelector: item.QUEST_KEY,
                                    oper          : 'replace',
                                    cmt           : item.CMTS
                                }
                            );
                        }
                    }
                );
            }
            DtoData.ajaxProcessedCNData = arrQaQuest.slice();
            return DtoData;
        };

        aObjCcBase.eApps.app.processUI   = function (aObjNSbase, aObjCcBase) {
            var DataDto = aObjCcBase.eApps.getDataDto(aObjCcBase),
                strWrk,
                arrWrk=[],
                retVal = [],
                tabGrpTmplt = [
                    '<table ><tr><td class="vtab" style="background-color: white;border-right:1px solid lightgrey;border-bottom:1px solid lightgrey;width:380px;">',
                    '<button class="vtablinks" id="TSB"  ><span style="font-weight:800; ">Patient Case Numbers</span></button>',
                    '<#=tabGrpBody#>',
                    '</td><td id="tabGroup">'
                ],
                sectTabTmplt = '<button class="vtablinks {2} disabled" id="TS{0}"  >{1}</button>',
                SB =[
                    '<div  class="vtabcontent" id="SB" style="display: none;"><div class="SectionHdr">Patient Case Numbers</div><div>',
                    '<form><div class="inputQaRow">',
                    '<div>&nbsp;&nbsp;This is the list of Case Number associated with the patient\'s ',
                    '<span style="font-weight: 800;">Fin:</span> <#=PFIN#>&nbsp;&nbsp; <span style="font-weight: 800;">MRN: </span> <#=PMRN#></div><br/>',
                    '<table style="table-layout: fixed">',
                    //'<tr><th>&nbsp;&nbsp;Case Number</th><th>Anesthesia Start Date Time</th><th>Data Present</th><th>&nbsp;</th></tr>',
                    '<tr><th>&nbsp;&nbsp;Case Number</th><th>Anesthesia Start Date Time</th><th>PreOp</th><th>IntraOp</th><th>PostOp</th><th>&nbsp;</th></tr>',
                    '<#=SBBODY#>',
                    '</table>',
                    '</div></form></div></div>'
                ],
                arrCaseNumGrp,
                arrSectGrp,
                arrSBWrk = [];
            arrSectGrp = Object.keys(DataDto.sectGrp);

            arrSectGrp.forEach(
                function (value, index ) {
                    var sectGrp = DataDto.sectGrp;
                    var tempStr,
                        lblClass = '';
                    tempStr = sectGrp[value].SectionLbl.replace('[COMMENT MANDATORY]','').replace('For All','');
                    if (index === 0 ) {
                        lblClass = "eApps_red_bold_font";
                    }
                    if (index === 1 ) {
                        lblClass = "eApps_red_bold_font";
                    }
                    if (index === 14 ) {
                        lblClass = "eApps_red_bold_font";
                    }
                    arrWrk.push(
                        aObjNSbase.gFuncs.sFormatter(sectTabTmplt,value.replace('S',''),tempStr,lblClass));
                }
            );
            arrWrk.push(
                '<button id="QABTNLbl"  type="button" style="height: 50px;background-color: white;border:0;" ></button>',
                '<button id="QABTNSave" type="button" class="eappsBtnGrey" ' ,
                'style="width:80px; text-align: center ;visibility: hidden"',
                '> Save  </button>'
            );
            retVal.push(aObjNSbase.gFuncs.parseTemplate(tabGrpTmplt.join(''),{tabGrpBody:arrWrk.join('')}));
            arrCaseNumGrp = Object.keys(DataDto.CaseNums);
            arrCaseNumGrp.forEach(
                function (value,index) {
                    var item = DataDto.CaseNums[value];
                    arrSBWrk.push(
                        aObjNSbase.gFuncs.sFormatter(
                            [
                                '<tr class="{3}"><td>&nbsp;&nbsp;{0}</td><td>{1}</td><td>',
                                '<img style="width: 24px; height: 24px;" src="',
                                 chla.global.imgPath,
                                '{2}">',
                                '</td><td>',
                                '<img style="width: 24px; height: 24px;"src="',
                                chla.global.imgPath,
                                '{3}">',
                                '</td><td>',
                                '<img style="width: 24px; height: 24px;"src="',
                                chla.global.imgPath,
                                '{4}">',
                                '</td><td><button type="button" class="casenumBtn" data-casenum-id="{0}">Open</button></td></tr>'
                            ].join(''),
                            //'<tr class="{3}"><td>&nbsp;&nbsp;{0}</td><td>{1}</td><td>{2}</td><td><button type="button" class="casenumBtn eappsBtnGrey" data-casenum-id="{0}">Open</button></td></tr>',
                            item.CaseNum,
                            item.STOP_DTTM,
                            //item.SqlData,
                            (item.IsPreOp === 'No'? 'No.jpg': 'Yes.jpg'),
                            (item.IsIntraOp === 'No'? 'No.jpg': 'Yes.jpg'),
                            (item.IsPostOp === 'No'? 'No.jpg': 'Yes.jpg'),
                            (index % 2 === 0? '': 'odd')
                        ))
                }
            );
            retVal.push(aObjNSbase.gFuncs.parseTemplate(SB.join(''), {
                PFIN: DataDto.fin,
                PMRN: DataDto.mrn,
                SBBODY: arrSBWrk.join('')
            }));

            strWrk = aObjCcBase.eApps.app.view.createSection('initial',DataDto);
            aObjCcBase.eApps.app.view.cleanQuestions = strWrk;
            DataDto.QuestBase = strWrk;
            retVal.push(strWrk);
            return retVal.join('');
        };
        aObjCcBase.eApps.app.view.createSection = function (funcOper,DataDto){
            var retVal,
                arrWrk = [],
                sectionTmplt = [
                    '<div class="vtabcontent" id="Q',
                    '<#=SectId#>',
                    '" style="display: none;"><div class="SectionHdr">',
                    '<#=SectionLbl#>',
                    '</div><div><form id="Frm',
                    '<#=SectId#>',
                    '">',
                    '<div style="max-height:780px;overflow-y:auto;">',
                    '<#=sectBody#>',
                    '</div>',
                    '</form></div></div>'
                ],
                questTmplt = [
                    '<div id="',
                    '<#=questId#>',
                    '" class="inputQaRow"><div class="inputQaCell1">',
                    '<input id="',
                    '<#=questId#>',
                    '" type="checkbox"><label style="color:blue;font-weight:500;">&nbsp;',
                    '<#=questLblValue#>',
                    '</label></div>',
                    '<div class="inputQaCell2 <#=questCmt#>"><label style="color: blue; font-size: 10px;">&nbsp;Comment:&nbsp;</label>',
                    '<input class="inputFormControl" style="background-color:#f2f2f2;" id="',
                    '<#=questCmtId#>',
                    '" type="text" value="',
                    '<#=questCmtValue#>',
                    '" disabled ></div></div>'
                ],
                arrWrkItems,
                sectGrp;
            sectGrp = DataDto.sectGrp;
            arrWrkItems = Object.keys(sectGrp);
            if (funcOper === 'initial'){
                arrWrkItems.forEach(
                    function (SectItem) {
                        var arrSectBody =[],
                            idxSectGrp = sectGrp[SectItem],
                            questGrp = sectGrp[SectItem].questGrp,
                            arrQuestGrp = Object.keys(questGrp);
                        arrQuestGrp.sort();
                        arrQuestGrp.forEach(
                            function (grpItem) {
                                var questItem = questGrp[grpItem],
                                    strWrk;
                                strWrk = questItem.questLblValue.replace('COMMENT MANDATORY','')
                                    .replace('[','<span style="color:red;">COMMENT MANDATORY')
                                    .replace(']','</span>');
                                arrSectBody.push( aObjNSbase.gFuncs.parseTemplate(questTmplt.join(''),{
                                    questId: questItem.questId,
                                    questLblValue: strWrk,
                                    questCmtId:questItem.questCmtId,
                                    questCmtValue: questItem.questCmtValue,
                                    questCmt: (strWrk.toUpperCase() === 'NO EVENT TO REPORT'? 'eApps_hidden':'' )
                                }));
                            }
                        );
                        arrWrk.push(aObjNSbase.gFuncs.parseTemplate(sectionTmplt.join(''), {
                            SectId:   idxSectGrp.SectId,
                            SectionLbl:  idxSectGrp.SectionLbl.replace('COMMENT MANDATORY','').replace('[','<span style="color:red;">COMMENT MANDATORY').replace(']','</span>'),
                            sectBody: arrSectBody.join('')
                        }));
                    });
                retVal = arrWrk.join('');
            }else if (funcOper === 'loadData'){

            }
            return retVal;
        };
        aObjCcBase.eApps.app.processSQLUI  = function (aObjNSbase, aObjCcBase) {
            var DtoData = aObjCcBase.eApps.getDataDto(aObjCcBase),
                retVal = [],
                DtoDataSql;
            DtoDataSql = DtoData.ajaxProcessedCNData;
            if (typeof DtoDataSql.NoData === 'undefined' ){
                retVal.push({targetSelector: 'data',oper:'add/replace'})
            }
            return retVal;

        };
        aObjCcBase.eApps.app.processCcInstanceUpdate = function (aObjAppNS, aObjCcBase, aFuncOper, aHtmlData) {
            var strHtml;
            strHtml = aObjCcBase.eApps.app.view.cleanQuestions;
            $('div [id^="QS"]').remove();
            $('td#tabGroup').append(strHtml);
            // aHtmlData = testData;
            if (aHtmlData.length > 0) {
                aHtmlData.forEach(
                    function (item){
                        var $input_cmt = $("input#cmt" + item.targetSelector),
                            strwrk,
                            $button,
                            arrTargetSelector = item.targetSelector.split('Q');
                        $("div#" + item.targetSelector).addClass('container_question_dataPresent');
                        $("input#" + item.targetSelector).prop('checked',true);
                        $input_cmt.val(item.cmt);
                        $input_cmt.prop('disabled',false);
                        $button = $('button#T' + arrTargetSelector[0]);
                        $button.removeClass('container_question_dataPresent');
                        $button.addClass('container_question_dataPresent');
                    }
                );
            }
        };
        /**
         *
         * @param aObjNSbase
         * @param aObjCcBase
         */
        aObjCcBase.eApps.app.processPostCcInstanceFin  = function (aObjNSbase, aObjCcBase) {

            $('button.casenumBtn').on('click', {
                    ObjCcBase: aObjCcBase
                },
                function (event) {
                    var html_component = this,
                        caseNum,
                        objCcBase = event.data.ObjCcBase,
                        DtoData;

                    DtoData               = objCcBase.eApps.getDataDto(objCcBase);
                    caseNum               = html_component.getAttribute('data-casenum-id');
                    DtoData.activeCaseNum = caseNum;
                    objCcBase.eApps.app.utl.handleSQLRequest('CASENUM', [caseNum], objCcBase);
                });
            $('div#SB').show();
            $("div#chla_AnesthQA button#TSB").addClass('active');
        };
        /**
         *
         * @param aObjNSbase
         * @param aObjCcBase
         */
        aObjCcBase.eApps.app.processPostCcInstanceCaseNum  = function (aObjNSbase, aObjCcBase) {
            var sectionHtmlNodes,
                tabs = [
                    'TSB',
                    'TS00',
                    'TS01',
                    'TS02',
                    'TS03',
                    'TS04',
                    'TS05',
                    'TS06',
                    'TS07',
                    'TS08',
                    'TS09',
                    'TS10',
                    'TS11',
                    'TS12',
                    'TS13',
                    'TS14',
                    'TS15'
                ],
                $buttonQABTNSave =  $('button#QABTNSave'),
                DtoData = aObjCcBase.eApps.getDataDto(aObjCcBase);

            tabs.forEach(
                function (value) {
                    $('button#' + value).on('click',{
                            tabid    : value,
                            tabbody  : value.replace("T", "Q"),
                            ObjCcBase: aObjCcBase
                        },
                        function (event) {
                            var strWrk,
                                objCcBase = event.data.ObjCcBase,
                                openTab = true;

                            if ($(this).hasClass('disabled') === false) {
                                if (event.data.tabid === 'TSB'){
                                    event.data.tabbody = 'SB';
                                    if(event.data.ObjCcBase.eApps.dataDirty){
                                        strWrk = [
                                            '<div id="eAppsAlertMessage" class="alertMessage">',
                                            '<strong>Warning!</strong> Do you want to save changed data?',
                                            '<br/><div style="float:right;">',
                                            '<button class="alertMessage-button-light"  onclick="',
                                            'chla.eApps.evtHndlrs.btnYes()',
                                            '">Yes</button>&nbsp;',
                                            '<button class="alertMessage-button-light "  onclick="',
                                            'chla.eApps.evtHndlrs.btnNo()',
                                            '">No</button>&nbsp;',
                                            '<button class="alertMessage-button-light" onclick="$(\'div#eAppsAlertMessage\').remove()">Cancel</button>',
                                            '</div></div>'
                                        ];
                                        $('body').append(strWrk.join(''));

                                        openTab = false;
                                    } else {
                                        objCcBase.eApps.app.disableTabs();
                                        $buttonQABTNSave.css({"visibility": "hidden"});
                                        $('button.container_question_dataDirty').removeClass('container_question_dataDirty');
                                        $('button.container_question_dataPresent').removeClass('container_question_dataPresent');
                                    }
                                }
                                if (openTab) {
                                    event.data.ObjCcBase.eApps.app.view.openTab(event.data.tabid, event.data.tabbody);
                                }
                            }
                        });
                }
            );
           aObjCcBase.eApps.app.disableTabs = function(){
                var sectionHtmlNodes = $('button[id^="TS"]');
                [].forEach.call(sectionHtmlNodes,
                    function(item) {
                        item.classList.add('disabled');
                    });
                $('button#TSB').removeClass('disabled');
            };
            aObjCcBase.eApps.app.evtHdlYes = function(){
                var chkArray = [],
                    objCcBase =  chla.eApps['evntHndlrObjCcBase'],
                    arrSendData = [],
                    DTTM = [];
                DTTM.push( chla.eApps.gFuncs.sFormatShortDate(new Date()));
                DTTM.push(chla.eApps.gFuncs.sFormatShortTime(new Date()));
                $("input:checked").each(function() {
                    var strWrk = $(this)[0].id;
                    if (strWrk !== '') {
                        chkArray.push(strWrk);
                    }
                });
                chkArray.forEach(
                    function (item) {
                        var strCmt = $("input#cmt" + item).val(),
                            idxGrp = item.split('Q')[0],
                            DtoData;

                        DtoData = objCcBase.eApps.getDataDto(objCcBase);

                        arrSendData.push({
                                ACTIVE_IND:1,
                                FIN: DtoData.fin,
                                CASE_NUM:DtoData.activeCaseNum,
                                PERSON_ID:  DtoData.personId.toString() ,
                                QUEST_KEY:item,
                                QUEST_GRP_LBL:objCcBase.eApps.app.sectGrpLabels[idxGrp],
                                QUEST_LBL:objCcBase.eApps.app.sectGrpLabels[item],
                                CMTS:strCmt,
                                UPDT_BY:  DtoData.userId.toString(),
                                BEG_DTTM:DTTM.join(' '),
                                END_DTTM:'12/31/2100 00:00:00',
                                MRN: DtoData.mrn.toString()
                            }

                        )
                    }
                );
                $('div#eAppsAlertMessage').remove();
                chla.eAppsUtil.Logger.LogInfo('Quest Data: ' + JSON.stringify(arrSendData));
                if (arrSendData.length === 0){
                    DtoData = objCcBase.eApps.getDataDto(objCcBase);
                    objCcBase.eApps.app.utl.handleSQLRequest('CNCLEAR', [DtoData.activeCaseNum], objCcBase);

                } else {
                    objCcBase.eApps.app.utl.handleSQLRequest('SAVEIT', arrSendData, objCcBase);
                }
                chla.eApps.SaveButtonBehavior.enable_disable_status_reset( 'button#QABTNSave','RESET');
                objCcBase.eApps.app.disableTabs();
                $buttonQABTNSave.css({"visibility": "hidden"});
            };
            aObjCcBase.eApps.app.evtHdlNo = function(){
                var objCcBase = chla.eApps['evntHndlrObjCcBase'];
                $('button.container_question_dataDirty').removeClass('container_question_dataDirty');
                $('button.container_question_dataPresent').removeClass('container_question_dataPresent');
                chla.eApps.SaveButtonBehavior.enable_disable_status_reset( 'button#QABTNSave','RESET');
                objCcBase.eApps.app.disableTabs();
                $buttonQABTNSave.css({"visibility": "hidden"});
                objCcBase.eApps.app.view.openTab('TSB', 'SB');
                $('div#eAppsAlertMessage').remove();
            };
            chla.eApps['evtHndlrs'] = {
                btnYes: aObjCcBase.eApps.app.evtHdlYes,
                btnNo: aObjCcBase.eApps.app.evtHdlNo,
                btnSave: aObjCcBase.eApps.app.evtHdlYes
            };

            $('button#TSB').html(
                [
                    '<span style="font-weight:800; ">',
                    'Patient Case Numbers</span>',
                    '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;',
                    '<span id="currentCaseNumber" style="font-size:10px;background-color: white;color: blue;font-weight: 800;">',
                    ' Selected: ',
                    DtoData.activeCaseNum,
                    '</span>'].join('')
            );
            $buttonQABTNSave.css({"visibility": "visible"});
            chla.eApps.SaveButtonBehavior.enable_disable_status_reset( 'button#QABTNSave','RESET');

            sectionHtmlNodes = $("div#chla_AnesthQA button.vtablinks.disabled");
            [].forEach.call(sectionHtmlNodes,
                function (item) {
                    item.classList.remove('disabled');
                }
            );
            $buttonQABTNSave.on('click',{
                    ObjCcBase: aObjCcBase
                },chla.eApps['evtHndlrs'].btnSave
            );
            $("[type='checkbox']").on('click',{
                    objCcBase: aObjCcBase
                },
                function(event){
                    var $button,
                        $div,
                        targetSelector = $(this)[0].id,
                        $input_cmt;
                    chla.eApps.SaveButtonBehavior.enable_disable_status_reset( 'button#QABTNSave','ENABLE');
                    $button = $('button#T' + targetSelector.split('Q')[0]);
                    $button.removeClass('container_question_dataDirty');
                    $button.addClass('container_question_dataDirty');
                    $div = $("div#"  +targetSelector);
                    $div.removeClass('container_question_dataDirty');
                    $div.addClass('container_question_dataDirty');
                    if ($("input#" + targetSelector).prop('checked')){
                        $input_cmt = $("input#cmt" + targetSelector);
                        $input_cmt.prop('disabled',false);

                    }else {
                        $input_cmt = $("input#cmt" + targetSelector);

                        $input_cmt.val('');
                        $input_cmt.prop('disabled',true);
                    }
                    event.data.objCcBase.eApps.dataDirty= true;
                }
            );

            $('button#TS01').click();
        };

        aObjCcBase.eApps.app.ProcessCtlFin  = function (DataSql) {
            var objCcBase = this,
                AnesthQA  = chla.eAppsClass.gCcModule.createCcModuleCls.neo(),
                DtoData,
                objAppNS;
            objAppNS = objCcBase.eApps.appNS;
            DtoData = objCcBase.eApps.getDataDto(objCcBase);
            DtoData.SqlData = DataSql;
            objCcBase.eApps.app.processSQLDataFin( objCcBase);
            objCcBase.eApps.setUiDto(objCcBase,objCcBase.eApps.app.processUI(objAppNS, objCcBase));
            AnesthQA.ccnsp.processCcInstance(objAppNS, objCcBase);
            objCcBase.eApps.app.processPostCcInstanceFin(objAppNS, objCcBase);
        };

        aObjCcBase.eApps.app.ProcessCtlCaseNum  = function (DataSql) {
            var objCcBase = this,
                FuncOper = 'QuestLoadData',
                DtoData,
                objAppNS;
            objAppNS = objCcBase.eApps.appNS;
            DtoData = objCcBase.eApps.getDataDto(objCcBase);
            DtoData.SqlData = DataSql;
            objCcBase.eApps.app.processSQLDataCaseNum( objCcBase);
            objCcBase.eApps.app.processCcInstanceUpdate(objAppNS, objCcBase,FuncOper, DtoData.ajaxProcessedCNData);
            objCcBase.eApps.app.processPostCcInstanceCaseNum(objAppNS, objCcBase);
        };
    };
    /**
     *
     * @param aObjNSbase
     * @param aObjCcBase
     * @returns {{fin: string, activeCaseNum: {}, CaseNums: {}, sectGrp: {}}}
     */
    AnesthQA.ccnsp.processData = function (aObjNSbase, aObjCcBase) {
        var retVal = {
                fin     : '',
                userId  : '',
                personId: '',
                SqlData: '',
                activeCaseNum: {},
                CaseNums: {
                },
                sectGrp :{}
            },
            arrWrkItems,
            DtoData = aObjCcBase.eApps.getJsonDataDto(aObjCcBase);

        retVal.fin = DtoData.FIN;
        retVal.mrn = DtoData.MRN;
        retVal.userId = DtoData.USERID;
        retVal.personId = DtoData.PERSONID;
        DtoData.SURGERIES.forEach(
            function (value) {
                retVal.CaseNums[value.SURG_CASE_NBR_FORMATTED.replace(/-/g,'')] = {
                    CaseNum:   value.SURG_CASE_NBR_FORMATTED,
                    IsPreOp: 'No',
                    IsIntraOp: 'No',
                    IsPostOp: 'No',
                    SqlData: 'No',
                    STOP_DTTM: value.ANESTHESIA_STOP_DT_TM
                };
            }
        );
        arrWrkItems = Object.keys(aObjCcBase.eApps.app.sectGrpLayout);
        arrWrkItems.sort();
        arrWrkItems.forEach (
            function(grpItem){
                var arrWrk = grpItem.split('Q'),
                    strWrk,
                    sectGrpLayout = aObjCcBase.eApps.app.sectGrpLayout,
                    sectGrp = retVal.sectGrp;
                strWrk = sectGrpLayout[grpItem];
                if (typeof sectGrp[arrWrk[0]] === 'undefined'){
                    sectGrp[arrWrk[0]] = {questGrp: {}};
                }
                sectGrp[arrWrk[0]].questGrp[strWrk] = {};
            }
        );
        arrWrkItems = Object.keys(aObjCcBase.eApps.app.sectGrpLabels);
        arrWrkItems.forEach (
            function(grpItem){
                var sectGrpLabels = aObjCcBase.eApps.app.sectGrpLabels,
                    idxQuest,
                    sectGrp = retVal.sectGrp,
                    arrWrk;
                if (grpItem.indexOf('Q')=== -1){
                    sectGrp[grpItem].SectId = grpItem;
                    sectGrp[grpItem].SectionLbl = sectGrpLabels[grpItem];

                } else {
                    idxQuest = aObjCcBase.eApps.app.sectGrpLayout[grpItem];
                    arrWrk = grpItem.split('Q');
                    sectGrp[arrWrk[0]].questGrp[idxQuest] = {
                        questLblValue: sectGrpLabels[grpItem],
                        questSectLayoutId: idxQuest,
                        questId: grpItem,
                        questCmtId:'cmt' + grpItem,
                        questCmtValue: ''
                    }
                }
            }
        );
        return retVal;
    };
    /**
     *
     * @param aObjThisCCInit
     * @param aObjCcBase
     */
    AnesthQA.ccnsp.ProcessCtl  = function (aObjThisCCInit, aObjCcBase) {
        var objAppNS = chla.eAppsClass.neo();
        aObjThisCCInit.genInit( aObjThisCCInit,objAppNS,aObjCcBase);
        if (aObjCcBase.eApps.initOnly === false) {
            aObjThisCCInit.postInit(objAppNS, aObjCcBase);
            aObjCcBase.eApps.setDataDto(aObjCcBase,aObjThisCCInit.processData(objAppNS, aObjCcBase));
            aObjCcBase.eApps.target.innerHTML = [
                '<div style="display:table;width:100%;">',
                '<div style="display:table-cell;text-align:center; vertical-align:middle;height:500px;">',
                '<h3 id="startup_label" style="text-align: center;font-family:  Tahoma,Verdana,Segoe,sans-serif ;font-size:16px;">Anesthesia QA Page Loading </h3>',
                '<img class="center" alt="Anesthesia QA Page Loading" src="',
                //chla.global.imgPath,
                'I:\\WININTEL\\static_content\\ChlaEapps\\MP6_6B\\static_content\\custom_mpage_content\\custom-components\\eAppsResources\\images\\',
                //'../eAppsResources/images/',
                'large-loading.gif" />',
                '</div></div>'
            ].join('');
            aObjCcBase.eApps.app.utl.handleSQLRequest('TOKEN','{"Username": "Mark","Password": "9mSMG6WUamqw"}',aObjCcBase);


        }
    };
    AnesthQA.ccnsp.ProcessCtl(AnesthQA.ccnsp,component);
};

chla['ccSedation'].prototype.render = function() {
    var  component = this;
    component.ccSedation  = chla.eAppsClass.gCcModule.createCcModuleCls.neo();
    /**
     *
     * @param {*} aObjNSbase
     * @param {*} aObjCcBase
     */
    component.ccSedation.ccnsp.postInit  = function (aObjNSbase, aObjCcBase) {
        var boolCustomCfgData = (typeof aObjCcBase.CCcfg.customCfg !== 'undefined'),
            eAppsData,
            strDefStartTime = '07:00:00',
            strDefEndTime = '06:59:59',
            numDefShiftLength = 12,
            DtoCclJson,
            objCustomCfgData;

        if (typeof aObjCcBase.eApps.ReRender === 'undefined'){
            /**
             *
             * @param {object} responseData
             */
            aObjCcBase.eApps.ReRender = function (responseData) {
                var objCcBase = this,
                    objThisCCInit,
                    objAppNS = chla.eAppsClass.neo();
                objCcBase.data = responseData;
                objCcBase.eApps.dataDto = null;
                objCcBase.eApps.UiDto = null;
                objCcBase.eApps.BEGDT = '';
                objCcBase.eApps.ENDDT = '';
                objCcBase.eApps.drugs = null;
                objThisCCInit = objCcBase.ccSedation.ccnsp;
                objThisCCInit.postInit(objAppNS, objCcBase);
                objCcBase.eApps.setDataDto(objCcBase, objThisCCInit.processData(objAppNS, objCcBase));
                objCcBase.eApps.setUiDto(objCcBase, objThisCCInit.processUI(objAppNS, objCcBase));
                objThisCCInit.processCcInstance(objAppNS, objCcBase);
                objThisCCInit.processPostCcInstance(objAppNS, objCcBase);
            };
        }

        eAppsData = aObjCcBase.eApps;
        if (boolCustomCfgData) {
            objCustomCfgData = aObjCcBase.CCcfg.customCfg;
            eAppsData.STTM   = (typeof objCustomCfgData.StartTime   !== 'undefined'? objCustomCfgData.StartTime   : strDefStartTime);
            eAppsData.EDTM   = (typeof objCustomCfgData.EndTime     !== 'undefined'? objCustomCfgData.EndTime     : strDefEndTime);
            eAppsData.SHIFTLEN = (typeof objCustomCfgData.ShiftLength !== 'undefined'? objCustomCfgData.ShiftLength : numDefShiftLength);
        } else {
            eAppsData.STTM   = strDefStartTime;
            eAppsData.EDTM   = strDefEndTime;
            eAppsData.SHIFTLEN = numDefShiftLength;
        }
        aObjCcBase.eApps.DataDtoCls = ChlaStdClass.extend (
            function() {
                this.ENTRY_DT = '';
                this.drugs =  '';
                this.opioidEqDataSet0     =  [];
                this.opioidEqDataSet1     =  [];
                this.opioidEqDataSet2     =  [];
                this.opioidEqDataSet3     =  [];
                this.benzEqDataSet0       =  [];
                this.benzEqDataSet1       =  [];
                this.benzEqDataSet2       =  [];
                this.benzEqDataSet3       =  [];
                this.oWPP_CMNTS =  {};
                this.bWPP_CMNTS =  {};
                this.MISC_CMNTS =  {};
                this.pastVisit = [];
                this.FIN =  0;
                this.BEGDT = '';
                this.ENDDT = '';
                this.REGDT = '';
                this.DSCHDT = ''

            });
        // .implement({})
        aObjCcBase.eApps.UiDtoCls = ChlaStdClass.extend (
            function() {
                this.mainSection = [];
            });

        DtoCclJson = aObjCcBase.eApps.getCclJsonDto(aObjCcBase);
        aObjCcBase.eApps.setCclJsonDto(aObjCcBase,DtoCclJson);
        aObjCcBase.eApps.setDataDto(aObjCcBase, aObjCcBase.eApps.DataDtoCls.neo());
        aObjCcBase.eApps.setUiDto(aObjCcBase, aObjCcBase.eApps.UiDtoCls.neo() );

    };
    /**
     *
     * @param {object} aObjNSbase Namespace object reference
     * @param {object} aObjCcBase Component object reference
     * @returns {*} DTO with CCL json processed for processUI input
     */
    component.ccSedation.ccnsp.processData = function (aObjNSbase, aObjCcBase) {
        var retDataDto = aObjCcBase.eApps.DataDtoCls.neo(),
            CclJsonDto,
            objTimePeriods = {};

        CclJsonDto = aObjCcBase.eApps.getJsonDataDto(aObjCcBase);

        aObjCcBase.eApps.BEGDT = CclJsonDto.START_DT_TM.replace(/ .*/,'').replace(/-/g,"/");
        aObjCcBase.eApps.ENDDT = CclJsonDto.END_DT_TM.replace(/ .*/,'').replace(/-/g,"/");
        retDataDto.BEGDT = CclJsonDto.START_DT_TM;
        retDataDto.ENDDT =  CclJsonDto.END_DT_TM;

        if (typeof aObjCcBase.eApps.FIN_ID === 'undefined'){
            aObjCcBase.eApps.FIN_ID = CclJsonDto.FIN;
        }
        retDataDto.FIN = CclJsonDto.FIN;
        retDataDto.pastVisit = CclJsonDto.PAST_VISITS.slice();
        retDataDto.pastVisit.forEach(
            function (value) {
                var objCurDate = new Date(),
                    objEndDate,
                    objRegDate,
                    objBegDate,
                    objDchDate;
                if (value.FIN === retDataDto.FIN ){
                    retDataDto.REGDT = value.REG_DATE;
                    aObjCcBase.eApps.REGDT = value.REG_DATE.replace(/ .*/,'').replace(/-/g,"/");

                    retDataDto.DSCHDT = ( value.DC_DATE !== ""?value.DC_DATE.replace(/ .*/,'').replace(/-/g,"/"):"") ;
                    aObjCcBase.eApps.DSCHDT = ( value.DC_DATE !== ""? retDataDto.DSCHDT: aObjCcBase.eApps.appNS.gFuncs.getStrFromDateObj(objCurDate,'/'));
                    objBegDate = new Date(aObjCcBase.eApps.BEGDT);
                    objRegDate = new Date(aObjCcBase.eApps.REGDT);
                    objEndDate = new Date(aObjCcBase.eApps.ENDDT);
                    objDchDate = new Date(aObjCcBase.eApps.DSCHDT);
                    if ( objEndDate > objDchDate) {
                        aObjCcBase.eApps.ENDDT = aObjCcBase.eApps.DSCHDT;
                    }
                    if ( objBegDate < objRegDate) {
                        aObjCcBase.eApps.BEGDT = aObjCcBase.eApps.REGDT;
                    }
                }
            }
        );

        aObjCcBase.eApps.wppUiStructure ={
            WppFldId :{},
            WppRow_CD: {
                "OPIOID": 5000,
                "BENZ": 5100
            },
            WppDec_CD_idx:{},
            WppDec_CD: [
                { label     : 'NOT Wean Day (per protocol)'                                      , cType:      'radio'    , group_id  : 1, level_id  : 1, seq:        1 , code_value: '100111' },

                { label     : 'WEAN'                                                             , cType:      'radio'    , group_id  : 2, level_id  : 1, seq:        2 , code_value: '100212' },
                { label     : 'New Dose:'                               , label2    : ''         , cType:      'checkbox' , group_id  : 2, level_id  : 2, seq:        1 , code_value: '100221' },
                //{ label     : 'New Dose:'                                                        , cType:      'inputText', group_id  : 2, level_id  : 2, seq:        1 , code_value: '100221' },
				{ label     : 'New Dose:'                                                        , cType:      'textarea', group_id   : 2, level_id  : 2, seq:        1 , code_value: '100221' },
                { label     : 'HOLD WEAN'                               , label2    : ''         , cType:      'radio'    , group_id  : 3, level_id  : 1, seq:        3 , code_value: '100313' },
                { label     : 'WAT-1 Scores High'                                                , cType:      'checkbox' , group_id  : 3, level_id  : 2, seq:        1 , code_value: '100321' },
                { label     : 'Too many PRN\'s'                                                  , cType:      'checkbox' , group_id  : 3, level_id  : 2, seq:        2 , code_value: '100322' },
                { label     : 'Patient having procedure/operation (temporary hold)'              , cType:      'checkbox' , group_id  : 3, level_id  : 2, seq:        3 , code_value: '100323' },
                { label     : 'Other:'                                  , label2    : ' '        , cType:      'checkbox' , group_id  : 3, level_id  : 2, seq:        4 , code_value: '100324' },
                //{ label     : 'Other:'                                                           , cType:      'textarea' , group_id  : 3, level_id  : 2, seq:        4 , code_value: '100324' },
				{ label     : 'Other:&nbsp;&nbsp;&nbsp;&nbsp;'                                   , cType:      'textarea' , group_id  : 3, level_id  : 2, seq:        4 , code_value: '100324' },
                { label     : 'ABORTING PROTOCOL'                     , label2    : ''         , cType:      'radio'    , group_id  : 4, level_id  : 1, seq:        4 , code_value: '100414' },
                { label     : 'Patient reintubated'                                              , cType:      'checkbox' , group_id  : 4, level_id  : 2, seq:        1 , code_value: '100421' },
                { label     : 'Patient going to OR'                                              , cType:      'checkbox' , group_id  : 4, level_id  : 2, seq:        2 , code_value: '100422' },
                { label     : 'Patient will need acute pain / sedation needs (long term hold)'   , cType:      'checkbox' , group_id  : 4, level_id  : 2, seq:        3 , code_value: '100423' },
                //{ label     : 'Withdrawal of Care / Hospice Care / Palliative Care (not weaning)', cType:      'checkbox' , group_id  : 4, level_id  : 2, seq:        4 , code_value: '100424' } ,
                { label     : 'Withdrawal of Life Sustaining Treatment / Hospice Care / Palliative Care (not weaning)', cType:      'checkbox' , group_id  : 4, level_id  : 2, seq:        4 , code_value: '100424' } ,
				{ label     : 'Other:'                                  , label2    : ' '        , cType:      'checkbox' , group_id  : 4, level_id  : 2, seq:        5 , code_value: '100425' },
                //{ label     : 'Other:'                                                           , cType:      'textarea' , group_id  : 4, level_id  : 2, seq:        6 , code_value: '100425' }
				{ label     : 'Other:&nbsp;&nbsp;&nbsp;&nbsp;'                                   , cType:      'textarea' , group_id  : 4, level_id  : 2, seq:        6 , code_value: '100425' }
            ]
        };
        aObjCcBase.eApps.wppUiStructure.WppDec_CD.forEach(
            function (item,index) {
                aObjCcBase.eApps.wppUiStructure.WppDec_CD_idx[item.code_value] = {
                    label:item.label,
                    indx: index
                };
            }
        );
        aObjCcBase.eApps.wppUiStructure.WppDec_CD_idx[0] = {
            label:'',
            indx: -1
        };
        /**
         *
         * @param aStrDate
         * @param aStrStartPeriod {string}= ' 12:00:00'
         * @param aDigitInYear
         * @returns {string}

         */
        function CalcTimePeriod(aStrDate,aStrStartPeriod,aDigitInYear) {
            var arrWrk ,
                arrWrk2=[],
                dateWrk1,
                dateWrk2,
                strTime,
                strDate,
                numMinutes;
            arrWrk = aStrDate.split(' ');
            strTime = arrWrk[1];
            arrWrk = arrWrk[0].split('/');

            if (typeof  aDigitInYear !== 'undefined'){
                arrWrk[2] = (aDigitInYear === 2? '20' + arrWrk[2]: arrWrk[2]);
            }
            strDate = arrWrk.join('-');
            arrWrk2.push(strDate);
            arrWrk2.push(' ',strTime);
            dateWrk1 = new Date(arrWrk2.join(''));
            numMinutes = dateWrk1.getHours() * 60;
            numMinutes += dateWrk1.getMinutes();
            if( numMinutes < 420){ //1440-24 1080-18 720-12 360-6 0  : 420 = 7:00AM
                arrWrk2.length =0;
                arrWrk2.push( strDate,' ',aStrStartPeriod);
                dateWrk2 = new Date(arrWrk2.join(''));
                dateWrk1.setDate(dateWrk2.getDate()-1);
            }
            dateWrk1.setMinutes(dateWrk1.getMinutes() - dateWrk1.getTimezoneOffset());
            return dateWrk1.toISOString().replace(/-/g,'').split('T')[0];
        }

        /**
         *
         * @param aStartDT
         * @param aEndDT
         */
        function genTimePeriods(aStartDT,aEndDT){
            var objRetTimePeriods={},
                arrWrk,
                currentTS = 0,
                dteStartObj,
                dteEndObj,
                numDays,
                i;
            function C8TimePeriod() {
                var objWrk = c8Dto(),
                    strLbl,
                    dateWrk = new Date(dteEndObj.toISOString()),
                    strDate,
                    arrWrk,
                    arrWrk2 = [];
                objWrk.objODrugSummary = {};
                objWrk.objBDrugSummary = {};
				objWrk.objADrugSummary = {};
                objWrk.EndTime = new Date(dteEndObj.toISOString());
                objWrk.StartTime = new Date(dteStartObj.toISOString());
                dateWrk.setMinutes(dteStartObj.getMinutes() - dteStartObj.getTimezoneOffset());
                strLbl = dateWrk.toISOString().replace(/-/g,'').split('T')[0];

                objWrk.TimePeriod = strLbl;
                objWrk.TimeSlice = currentTS;
                currentTS +=1;
                //dteEndObj.setMinutes(dteEndObj.getMinutes() - dteEndObj.getTimezoneOffset());
                arrWrk = dteStartObj.toISOString().split('T')[0].split('-');
                arrWrk2.length = 0;
                arrWrk2.push(arrWrk[1],'-',arrWrk[2],'-',arrWrk[0]);
                strDate = arrWrk2.join('');
                arrWrk2.length = 0;
                //changed by LP  arrWrk2.push(strDate, ' ',aObjCcBase.eApps.STTM.replace(/:00$/,''),'Hrs - ',aObjCcBase.eApps.STTM.replace(/\:00$/,''),'Hrs');
                arrWrk2.push(strDate, ' '); //LP ,aObjCcBase.eApps.STTM.replace(/:00$/,''),'Hrs - ',aObjCcBase.eApps.STTM.replace(/\:00$/,''),'Hrs');
                objWrk.PERIOD_DTTM = arrWrk2.join('') ;
                objRetTimePeriods[strLbl] = objWrk;
                dteStartObj.setDate(dteStartObj.getDate()-1);
                dteEndObj.setDate(dteEndObj.getDate()-1);
            }
            arrWrk = aEndDT.split(' ');
            dteEndObj   = new Date (arrWrk[0].replace(/\//g,'-')+ ' ' + aObjCcBase.eApps.EDTM);
            dteStartObj = new Date (arrWrk[0].replace(/\//g,'-')+ ' ' + aObjCcBase.eApps.STTM);

            //dteStartObj.setDate(dteStartObj.getDate()-1);
            numDays = aObjNSbase.gFuncs.dateDiff(aStartDT,aEndDT,'days');

            for(i = 0 ; i <= numDays; i++){
                C8TimePeriod();
            }

            return objRetTimePeriods;
        }
        /**
         *
         * @param aObjNSbase
         * @param aObjCcBase
         * @param aDtoJson
         * @param aDrugs
         * @returns {*}
         */
        function dtoGen(aObjNSbase, aObjCcBase,aDtoJson,aDrugs) {
            var arrRetObj = [],
                arrWrkKeys;

            aDrugs.forEach(
                /**
                 *
                 * @param item
                 */
                function (item) {
                    var objWrk,
                        strLbl,
                        CI_dose,
                        strWrk,
                        doseAmt,
                        index;
                    strLbl = CalcTimePeriod(item.ADMIN_DT_TM, aObjCcBase.eApps.STTM,2);
                    if (typeof(objTimePeriods[strLbl]) !== 'undefined' ) {  //&& item.DEPT_MISC_LINE.indexOf('One Time Only') === -1
                        objWrk = objTimePeriods[strLbl];

                        if (item.GROUP.toUpperCase().indexOf('HYDROMORPHONE') > -1 ||
                            item.GROUP.toUpperCase().indexOf('METHADONE') > -1 ||
                            item.GROUP.toUpperCase().indexOf('MORPHINE') > -1 ||
                            item.GROUP.toUpperCase().indexOf('FENTANYL') > -1) {

                            objWrk.oPRN += (item.PRN === 'No' ? 0 : 1);
							
							if (item.INV_IND === "Y") {
								objWrk.oINV = objWrk.oINV + 1;
							}
                            
							if (item.DEPT_MISC_LINE.indexOf('One Time Only') === -1) {

                                index = 'O' + (item.TMPLT_ORDER_ID === 0 ? item.ORDER_ID : item.TMPLT_ORDER_ID);
                                doseAmt = item.ADMIN;  // load Meds dose Amt

                                if (item.ROUTE === 'IV' && item.PRN === 'No') {
                                    // Process Meds and CI IV
                                    if (item.CI_IND === 1){
                                        strWrk = item.DOSE_INFO.replace('[', '|').replace(']', '|');	
										CI_dose = strWrk.split('|');
										strWrk = CI_dose[1];
                                        if (typeof(strWrk) !== 'undefined') {
										   CI_dose = strWrk.split(' ');
										   doseAmt = CI_dose[0];
										 } else {
										   doseAmt = "";										 
										 }
               
                                    } else {
                                        //uncomment if below not works  strWrk = item.DEPT_MISC_LINE.replace('[', '|').replace(']', '|');


                                        /******start**********/
                                        strWrk = item.DEPT_MISC_LINE2.replace('[', '|').replace(']', '|');
                                        CI_dose = strWrk.split(',');
                                        doseAmt = CI_dose[0];

                                        /*********end******/
                                    }


                                    /*  CI_dose = strWrk.split('|');
                                      strWrk = CI_dose[1];
                                      CI_dose = strWrk.split(' ');
                                      doseAmt = CI_dose[0]; */
                                }
                                if (typeof(objWrk.objODrugSummary[index]) === 'undefined') {

                                    objWrk.objODrugSummary[index] = {
                                        oDrug: item.GROUP,
                                        oDosage: parseFloat(item.ADMIN),
                                        oActualDose: [doseAmt],
                                        oCI_Ind: item.CI_IND,
                                        oUnits: item.ADMIN_UNITS,
                                        DEPT_MISC_LINE: item.DEPT_MISC_LINE,
                                        oPRN: (item.PRN === 'No' ? 0 : 1),
										oINV: (item.INV_IND === "Y" ? 1 : 0),
                                        oOrderId: item.ORDER_ID
                                    };
                                } else {
                                    objWrk.objODrugSummary[index].oActualDose.push(doseAmt);
                                }
                            }
                        } else if (item.GROUP.toUpperCase().indexOf('LORAZEPAM') > -1 ||
                            item.GROUP.toUpperCase().indexOf('MIDAZOLAM') > -1) {

                            objWrk.bPRN += (item.PRN === 'No' ? 0 : 1);
							if (item.INV_IND === "Y") {
								objWrk.bINV = objWrk.bINV + 1;
							}

                            if (item.DEPT_MISC_LINE.indexOf('One Time Only') === -1) {
                                index = 'B' + (item.TMPLT_ORDER_ID === 0 ? item.ORDER_ID : item.TMPLT_ORDER_ID);
                                doseAmt = item.ADMIN;
                                if (item.ROUTE === 'IV' && item.PRN === 'No') {

                                    if (item.CI_IND === 1) {
                                        strWrk = item.DOSE_INFO.replace('[', '|').replace(']', '|');
                                        CI_dose = strWrk.split('|');
										strWrk = CI_dose[1];
                                        if (typeof(strWrk) !== 'undefined') {
										   CI_dose = strWrk.split(' ');
										   doseAmt = CI_dose[0];
										} else {
										   doseAmt = "";
										}
                                    } else {
                                        strWrk = item.DEPT_MISC_LINE.replace('[', '|').replace(']', '|');

                                        /******start**********/
                                        strWrk = item.DEPT_MISC_LINE2.replace('[', '|').replace(']', '|');
                                        CI_dose = strWrk.split(',');
                                        doseAmt = CI_dose[0];

                                        /*********end******/
                                    }
                                    /*CI_dose = strWrk.split('|');
                                    strWrk = CI_dose[1];
                                    CI_dose = strWrk.split(' ');
                                    doseAmt = CI_dose[0];*/
                                }
                                if (typeof(objWrk.objBDrugSummary[index]) === 'undefined') {
                                    objWrk.objBDrugSummary[index] = {
                                        bDrug: item.GROUP,
                                        bActualDose: [doseAmt],
                                        bDosage: parseFloat(item.ADMIN),
                                        bCI_Ind: item.CI_IND,
                                        bUnits: item.ADMIN_UNITS,
                                        DEPT_MISC_LINE: item.DEPT_MISC_LINE,
                                        bPRN: (item.PRN === 'No' ? 0 : 1),
										bINV: (item.INV_IND === "Y" ? 1 : 0),
                                        bOrderId: item.ORDER_ID
                                    };
                                } else {
                                    objWrk.objBDrugSummary[index].bActualDose.push(doseAmt);
                                }
                            }
                        } else if (item.GROUP_NBR === 3) {

                            objWrk.aPRN += (item.PRN === 'No' ? 0 : 1);

                            if (item.DEPT_MISC_LINE.indexOf('One Time Only') === -1) {
                                index = 'A' + (item.TMPLT_ORDER_ID === 0 ? item.ORDER_ID : item.TMPLT_ORDER_ID);
                                doseAmt = item.ADMIN;
                                if (item.ROUTE === 'IV' && item.PRN === 'No') {
								
                                    if (item.CI_IND === 1) {
                                        strWrk = item.DOSE_INFO.replace('[', '|').replace(']', '|');
										CI_dose = strWrk.split('|');
										strWrk = CI_dose[1];
										if (typeof(strWrk) !== 'undefined') {
											CI_dose = strWrk.split(' ');
											doseAmt = CI_dose[0];
										 } else {
											doseAmt = "";
										 }
                                    } else {
                                        strWrk = item.DEPT_MISC_LINE.replace('[', '|').replace(']', '|');
								
								        /******start**********/
										 strWrk = item.DEPT_MISC_LINE2.replace('[', '|').replace(']', '|');
										 CI_dose = strWrk.split(',');
										 doseAmt = CI_dose[0];
										 
										/*********end******/
                                    }
                                    /*CI_dose = strWrk.split('|');
                                    strWrk = CI_dose[1];
                                    CI_dose = strWrk.split(' ');
                                    doseAmt = CI_dose[0];*/
                                }
                                if (typeof(objWrk.objADrugSummary[index]) === 'undefined') {
                                    objWrk.objADrugSummary[index] = {
                                        aDrug: item.GROUP,
                                        aActualDose: [doseAmt],
                                        aDosage: parseFloat(item.ADMIN),
                                        aCI_Ind: item.CI_IND,
                                        aUnits: item.ADMIN_UNITS,
                                        DEPT_MISC_LINE: item.DEPT_MISC_LINE,
                                        aPRN: (item.PRN === 'No' ? 0 : 1),
                                        aOrderId: item.ORDER_ID
                                    };
                                } else {
                                    objWrk.objADrugSummary[index].aActualDose.push(doseAmt);
                                }
                            }
                        }
						
                    } 
                }
            );
            arrWrkKeys = Object.keys(objTimePeriods);
            arrWrkKeys.forEach(
                function (value) {
                    arrRetObj.push(objTimePeriods[value]);
                });
            aDtoJson.WAT.forEach(
                function (item) {
                    var strLbl,
                        objWrk;
                    if (item.WAT_DT_TM !== '') {
                        strLbl = CalcTimePeriod(item.WAT_DT_TM, aObjCcBase.eApps.STTM);

                        if (typeof(objTimePeriods[strLbl]) !== 'undefined') {
                            objWrk = objTimePeriods[strLbl];
                            objWrk.WAT.p0.push(item.WAT_SCORE);
                        }
                    }
                }
            );
            aDtoJson.CAPD.forEach(
                function (item) {
                    var strLbl,
                        objWrk;
                    if (item.CAPD_DT_TM !== '') {
                        strLbl = CalcTimePeriod(item.CAPD_DT_TM, aObjCcBase.eApps.STTM);
                        if (typeof(objTimePeriods[strLbl]) !== 'undefined') {
                            objWrk = objTimePeriods[strLbl];
                            objWrk.CAPD.p0.push(item.CAPD_SCORE);
                        }
                    }
                }
            );

            aDtoJson.FLACC.forEach(
                function (item) {
                    var strLbl,
                        objWrk;
                    if (item.FLACC_DT_TM !== '') {
                        strLbl = CalcTimePeriod(item.FLACC_DT_TM, aObjCcBase.eApps.STTM);
                        if (typeof(objTimePeriods[strLbl]) !== 'undefined') {
                            objWrk = objTimePeriods[strLbl];
                            objWrk.FLACC.p0.push(item.FLACC_SCORE);
                        }
                    }
                }
            );

            aDtoJson.SBS.forEach(
                function (item) {
                    var strLbl,
                        objWrk;
                    if (item.SBS_DT_TM !== '') {
                        strLbl = CalcTimePeriod(item.SBS_DT_TM, aObjCcBase.eApps.STTM);
                        if (typeof(objTimePeriods[strLbl]) !== 'undefined') {
                            objWrk = objTimePeriods[strLbl];
                            objWrk.SBS.p0.push(item.SBS_SCORE);
                        }
                    }
                }
            );
            return arrRetObj;
        }
        function c8Dto() {
            return {
                TimeSlice: 1,
                TimePeriod: '',
                StartTime: '',
                EndTime: '',
                PERIOD_DTTM: '',  //ADMIN_DT_TM":
                WAT      : {
                    p0:[]
                },                    // 12-1759,18-2359,0-559,6-1159
                FLACC    : {
                    p0:[]
                },                    // 12-1759,18-2359,0-559,6-1159
                SBS      : {
                    p0:[]
                },                    // 12-1759,18-2359,0-559,6-1159
                CAPD     : {
                    p0:[]
                },                    // 12-1759,18-2359,0-559,6-1159
                oDrug    : [],
                oPRN     : 0,               // count  sum of PRN "YES"
				oINV     : 0,               // count  sum of INV 
                oWPP     : '',
                oDoseChg : [],
                oCmts    : '',
                oOrders  : {},
				aDrug    : [],
                aPRN     : 0,
                bDrug    : [],
                bPRN     : 0,
				bINV     : 0,               // count  sum of INV 
                bWPP     : '',
                bDoseChg : [],
                bOrders  : {}
            };
        }
        objTimePeriods = genTimePeriods(aObjCcBase.eApps.BEGDT,aObjCcBase.eApps.ENDDT);
        retDataDto.drugs = dtoGen(aObjNSbase, aObjCcBase,CclJsonDto,CclJsonDto.DRUGS);

        CclJsonDto.GRPH_LOR_DRUG.forEach(
            function (item) {
                var arrWrk = [],
                    objWrk=[],
                    strDate,
                    strLbl = CalcTimePeriod(item.ADMIN_DT_TM, aObjCcBase.eApps.STTM, 2);

                if (typeof(objTimePeriods[strLbl]) !== 'undefined') {
                    objWrk = objTimePeriods[strLbl];
                    arrWrk.push(strLbl.substring(4,6),strLbl.substring(6,8),strLbl.substring(0,4));
                    strDate= arrWrk.join('/') + ' 07:00:00AM';
                    retDataDto.benzEqDataSet1.push([strDate, parseFloat(item.TOT_EQUIV.toFixed(2))]);
                    retDataDto.benzEqDataSet2.push([strDate, parseFloat(item.SCH_EQUIV.toFixed(2))]);
                    retDataDto.benzEqDataSet3.push([strDate, parseFloat(item.PRN_EQUIV.toFixed(2))]);

                    objWrk.bDrug.push(
                        {
                            bDrug  : '',
                            bDosage: parseFloat(item.SCH_EQUIV).toFixed(2),
                            bUnits : 'mg/kg'
                        }
                    );
                }
            }
        );
        CclJsonDto.GRPH_MOR_DRUG.forEach(
            function (item) {
                var arrWrk = [],
                    objWrk=[],
                    strDate,
                    strLbl = CalcTimePeriod(item.ADMIN_DT_TM, aObjCcBase.eApps.STTM, 2);

                if (typeof(objTimePeriods[strLbl]) !== 'undefined') {
                    objWrk = objTimePeriods[strLbl];
                    arrWrk.push(strLbl.substring(4,6),strLbl.substring(6,8),strLbl.substring(0,4));
                    strDate= arrWrk.join('/') + ' 07:00:00AM';
                    retDataDto.opioidEqDataSet1.push([strDate, parseFloat(item.TOT_EQUIV.toFixed(2))]);
                    retDataDto.opioidEqDataSet2.push([strDate, parseFloat(item.SCH_EQUIV.toFixed(2))]);
                    retDataDto.opioidEqDataSet3.push([strDate, parseFloat(item.PRN_EQUIV.toFixed(2))]);
                    chla.eAppsUtil.Logger.LogInfo('LOGINFO: oDrug ' +  parseFloat(item.SCH_EQUIV).toFixed(2));
                    objWrk.oDrug.push(
                        {
                            oDrug  : '',
                            oDosage: parseFloat(item.SCH_EQUIV).toFixed(2),
                            oUnits : 'mg/kg'
                        }
                    );
                }
            }
        );
        /**
         *
         * @param aObjNSbase
         * @param aObjCcBase
         * @param aObjWrk
         * @returns {string}
         */
        function wpp_Cmts_labeler(aObjNSbase, aObjCcBase,aObjWrk) {
            var idx = aObjCcBase.eApps.wppUiStructure.WppDec_CD_idx,
                dec_options = [];
            if (aObjWrk.DECISION_CD > 0) {
                dec_options.push(idx[aObjWrk.DECISION_CD].label);
                if (aObjWrk.DECISION_CD !== 100111){
                    dec_options.push(',:');
                }
            }
            if (aObjWrk.OPT_A > 0)
                dec_options.push(idx[aObjWrk.OPT_A].label);
            if (aObjWrk.OPT_B > 0)
                dec_options.push(idx[aObjWrk.OPT_B].label);
            if (aObjWrk.OPT_C > 0)
                dec_options.push(idx[aObjWrk.OPT_C].label);
            if (aObjWrk.OPT_D > 0)
                dec_options.push(idx[aObjWrk.OPT_D].label);
            if (aObjWrk.OPT_E > 0)
                dec_options.push(idx[aObjWrk.OPT_E].label);
            return dec_options.join() ;
        }
        CclJsonDto.WPP_CMNTS.forEach(
            /**
             *
             * @param item
             */
            function (item) {
                var objWrk,
                    arrLabels,
                    arrKeys = Object.keys(item),
                    objWPP = {},
                    strWrkDtTm = item.ENTRY_DT + ' ' +aObjCcBase.eApps.STTM,
                    strLbl;
                strLbl = CalcTimePeriod(strWrkDtTm,aObjCcBase.eApps.STTM, 4);
                if (typeof(objTimePeriods[strLbl]) !== 'undefined') {
                    objWrk = objTimePeriods[strLbl];
                    arrLabels = wpp_Cmts_labeler(aObjNSbase, aObjCcBase,item);
                    if (item.ROWTYPE_CD === 6000) {
                        retDataDto.MISC_CMNTS[strLbl] = item.COMMENT;
                    }else if (item.ROWTYPE_CD === 5000) {
                        retDataDto.oWPP_CMNTS[strLbl] = {};
                        objWPP = retDataDto.oWPP_CMNTS[strLbl];
                        objWrk.oCmts = item.COMMENT;
                        objWrk.oWPP = arrLabels;
                        if (item.DECISION_CD === 100212) {
                            objWrk.oWPP               =  objWrk.oWPP + item.WPP_OTHER_INPUT;
                        }else{
                            objWrk.oWPP_OTHER_INPUT = item.WPP_OTHER_INPUT;
                        }
                    } else if (item.ROWTYPE_CD === 5100) {
                        retDataDto.bWPP_CMNTS[strLbl] = {};
                        objWPP = retDataDto.bWPP_CMNTS[strLbl];
                        objWrk.bWPP = arrLabels;
                        if (item.DECISION_CD === 100212) {
                            objWrk.bWPP               =  objWrk.bWPP + item.WPP_OTHER_INPUT;
                        }else{
                            objWrk.bWPP_OTHER_INPUT = item.WPP_OTHER_INPUT;
                        }
                    }
                    arrKeys.forEach(
                        /**
                         *
                         * @param arrItem
                         */
                        function (arrItem) {
                            objWPP[arrItem] = item[arrItem];
                        }
                    );

                }
            }
        );
        aObjCcBase.eApps.drugs = retDataDto;
        return retDataDto;
    };

    /**
     * Parent function for construction of the UI
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     * @returns {object} retValDto.mainSection is html formatted content body of CC
     */
    component.ccSedation.ccnsp.processUI   = function (aObjNSbase, aObjCcBase) {
        var retValDto = aObjCcBase.eApps.getUiDto(aObjCcBase),
            objData = aObjCcBase.eApps.getDataDto(aObjCcBase),
            strFin,
            strWPPContent,
            arrTimePeriod = [],
            arrDrugs,
            arrWrk = [],
            calcArr =[
                '<div style="padding:5px 10px ; text-align:center;">',
                '<div style="float:left;">',
                '<a href="javascript:APPLINK(100,&quot;https://wpp.vpicu.net/&quot;,&quot;&quot; )" style="color:blue;text-decoration: none;">',
                'Withdrawal Prevention Protocol Wean Calculator</a>',
                '</div><div style="width:200px;display:inline-block">&nbsp;FIN: <#=FINID#> </div>',
                '<div style="clear:both;display:inline-block;text-align:center;line-height: 1em;" >',
                'Encounters: Reg Dt  - Dsch Dt <br/><select id="selectEnct" title="Encounters" style="width:200px;text-align: center;">',
                '<#=EnctrOptions#>',
                '</select></div><div style="float:right; text-align:center;line-height: 1em;">14 Day Window: Start Dt  - End Dt <br/>',
                '<button id="btnPrev" style="width:75px;">Prev</button><input type="text" id="CCare_SED_datepicker1" style="text-align: center;width:200px;" ',
                'value="<#=CurDspRange#>">',
                '<button id="btnNext" style="width:75px;">Next</button></div></div>'
            ],
            tableHtml = [
                '<div style="padding-top: 20px;">',
                '<div style="display:block;overflow-x:auto;margin-left: 10px;"><table id="ccSedation"  style=";border:1px solid black;width:1425px;" >',
                '<colgroup span="1"></colgroup><colgroup span="4"></colgroup><colgroup span="4"></colgroup><colgroup span="1"></colgroup><colgroup span="4"></colgroup>',
                '<thead style="display: block;max-height: 350px; overflow-y: visible;"><tr class="hd1">',
                '<th rowspan="1" style="border:1px solid grey;border-bottom:0;text-align:center;"  scope="colgroup">Date<br>(7am-7am)</th>',
                '<th colspan="4" style="border:1px solid grey;text-align:center;"                  scope="colgroup">Pain/Sedation Scores</th>',
                '<th colspan="4" style="border:1px solid grey;border-right:0;text-align:center;"   scope="colgroup">Opioids</th>',
                '<th colspan="1" style="border:1px solid grey;border-bottom:0;text-align:center;"  scope="colgroup">Comments</th>',
				'<th colspan="1" style="border:1px solid grey;border-right:0;text-align:center;" scope="colgroup">Alpha 2 Agonists</th>',
                '<th colspan="4" style="border:1px solid grey;border-right:0;text-align:center;"   scope="colgroup">Benzodazenpines</th>',
                '</tr><tr class="hd2 colhdr">',
                '<th scope="col" style="width:75px; border:1px solid grey;border-top: 0;">&nbsp;</th>',
                '<th scope="col" style="width:50px; border:1px solid grey;text-align:center;">WAT</th>',
                '<th scope="col" style="width:50px; border:1px solid grey;text-align:center;" >FLACC /<br/>FACES /<br/>N-PASS</th>',
                '<th scope="col" style="width:50px; border:1px solid grey;text-align:center;" >SBS</th>',
                '<th scope="col" style="width:50px; border:1px solid grey;text-align:center;" >CAPD</th>',
                '<th scope="col" style="width:200px;border:1px solid grey;text-align:center;" >Drug Order</th>',
                '<th scope="col" style="width:35px; border:1px solid grey;text-align:center;">Tot<br/> Sched<br/> Equiv</th>',
                '<th scope="col" style="width:65px; border:1px solid grey;text-align:center;" >PRN</th>',
                '<th scope="col" style="width:125px;border:1px solid grey;text-align:center;">WPP Daily Decision</th>',
                '<th scope="col" style="width:100px;border:1px solid grey;border-top:0;">&nbsp;</th>',
				'<th scope="col" style="width:200px;border:1px solid grey;text-align:center;" >Drug Order</th>',
                '<th scope="col" style="width:200px;border:1px solid grey;text-align:center;" >Drug Order</th>',
                '<th scope="col" style="width:35px; border:1px solid grey;text-align:center;" >Tot<br/> Sched<br/> Equiv</th>',
                '<th scope="col" style="width:65px; border:1px solid grey;text-align:center;" >PRN</th>',
                '<th scope="col" style="width:125px;border:1px solid grey;text-align:center;">WPP Daily Decision</th></tr></thead>'
            ],
            commentsWindow = [
                '<div id="ccSedCmtsWindow" style="position: absolute;display: none;border:1px solid black;width:900px;z-index:25;background-color: white;" >',
                '<div style="text-align:center;font-size:16px;font-weight: 800;background-color:lightgrey;">Sedation Miscellaneous Comments </div><br/>',
                '<textarea tpcode="" id="ccSedationCmtsText"  rows="5" style="margin-left:10px;width:96%;margin-bottom:5px;" ><#=ccSedationCmtsText#>"</textarea><br/>',
                '<input type="hidden" id="ccSedationCmtsTpcode">',
                '<button id="ccSedationCmtsSave" class="eappsBtnGrey" style="margin-left:10px;">  Save</button>&nbsp;&nbsp;&nbsp;',
                '<button id="ccSedationCmtCanel" class="eappsBtnGrey">  Cancel</button></p><br/></div>'
            ],
            WPP_Window_comp = {
                radio: [
                    '<input id="ccSedRadio',
                    '<#=radioId#>',
                    '" style="margin-left:10px;" type="radio" name="ccSedDecCd',
                    '<#=radioName#>',
                    '" value="',
                    '<#=radioValue#>',
                    '">',
                    '&nbsp;<#=radioLabel#>',
                    '<br/>'
                ],
                checkbox :  [
                    '<input id="ccSedchkbx',
                    '<#=checkboxId#>',
                    '" style="margin-left:25px;" type="checkbox" name="ccSedDecCd',
                    '<#=checkboxName#>',
                    '" value="',
                    '<#=checkboxValue#>',
                    '">',
                    '&nbsp;<#=checkboxLabel#>',
                    '<br/>'
                ],
                inputText: [
                    '<input type="text" maxlength="12" id="ccSedationWppText',
                    '<#=inputTextName#>',
                    '" style="width:',
                    'inputTextWidth',
                    ';background-color:yellow;margin-left:5px;margin-bottom:5px;"  name="ccSedWppText"',
                    '/>',
                    '<br/>'
                ],
                textarea : [
                    '<input type="text" maxlength="120"  name="ccSedWppTxtArea" id="ccSedationWppText',
                    '<#=textareaName#>',
                    '" rows="10" style="background-color:yellow;margin-left:25px;width:',
                    '740px',
                    ';margin-bottom:5px;" value="',
                    '"/><br/>',
                    '<br/>'
                ]
            },
            WPP_Window1 = [
                '<div id="ccSedWppWindow" style="position: absolute;display: none;border:2px double black;width:900px;z-index:25;background-color: white;" >',
                '<div style="text-align:center;font-size:16px;font-weight: 800;background-color:lightgrey;"><span id="WPPTITLE">Replaceable TITLE</span> </div><br/>',
                '<#=WPPWindowContent#>',
                '<button id="ccSedationWppSave" class="eappsBtnGrey" style="margin-left:10px;">  Save</button>&nbsp;&nbsp;&nbsp;',
                '<button id="ccSedationWppCancel" class="eappsBtnGrey">  Cancel</button></p><br/></div>'
            ],
            ChartLegend = '<div style="text-align:right;display: inline-block;width: 95%;"><img src="' + chla.global.imgPath + 'SedationLegendA.png"/> </div>',
            MorphChart =  '<div class="jqplot-target" id="chartOpioid" style="width: 90%; height: 300px; position: relative;display: inline-block;"></div>',
            LorazChart = '<div class="jqplot-target" id="chartBenz" style="width: 90%; height: 300px; position: relative;display: inline-block;"></div>',
            arrTable = [
                '<tbody  id="dTable" style="display: block;max-height: 1050px;">' // overflow-y: scroll; ">'
            ],
            tblRow = [
                '<tr >',
                '<td style="border:1px solid grey;width:75px; max-width:75px; line-height: 11px;background-color:#F6F6F6;font-weight:800;font-size:11px;"><#=date1#></td>',
                '<td style="border:1px solid grey;width:50px; max-width:50px;" ><#=WAT#></td>',
                '<td style="border:1px solid grey;width:50px; max-width:50px;" ><#=FLACC#></td>',
                '<td style="border:1px solid grey;width:50px; max-width:50px;" ><#=SBS#></td>',
                '<td style="border:1px solid grey;width:50px; max-width:50px;" ><#=CAPD#></td>',
                '<td style="border:1px solid grey;width:200px;max-width:200px;"><span style="font-weight: 800; font-size:10px;"><#=DRGORD1#></span></td>',
                '<td style="border:1px solid grey;width:35px; max-width:35px;text-align: center;" ><#=DOSAGE1#></td>',
                '<td style="border:1px solid grey;width:65px; max-width:65px;text-align: center;" ><span style="font-size:10px;"><#=PRN1#></span></td>',
                '<td style="border:1px solid grey;width:125px;max-width:125px;background-color: yellow;" class="ccSedationWPP" tpcode="<#=timepd#>" wndType="OPIOD"  title="<#=WPP1MI#>"><#=WPP1#></td>',
                '<td style="border:1px solid grey;width:100px;max-width:100px;" class="ccSedationCmt" tpcode="<#=timepd#>" ><#=CMT1#></td>',
				'<td style="border:1px solid grey;width:200px;max-width:200px;"><span style="font-weight: 800; font-size:10px;"><#=DRGORD3#></span></td>',
                '<td style="border:1px solid grey;width:200px;max-width:200px;"><span style="font-weight: 800; font-size:10px;"><#=DRGORD2#></span></td>',
                '<td style="border:1px solid grey;width:35px; max-width:35px;text-align: center;" ><#=DOSAGE2#></td>',
                '<td style="border:1px solid grey;width:65px; max-width:65px;text-align: center;" ><span style="font-size:10px;"><#=PRN2#></span></td>',
                '<td style="border:1px solid grey;width:125px;max-width:125px;background-color: yellow;" class="ccSedationWPP" tpcode="<#=timepd#>" wndType="BENZ" title="<#=WPP2MI#>" ><#=WPP2#></td>',
                '</tr>'
            ],
            tblRowSpacer = [
                '<tr >',
                '<td style="border:0;width:75px; max-width:75px;" >&nbsp;</td>',
                '<td style="border:0;width:50px; max-width:50px;" >&nbsp;</td>',
                '<td style="border:0;width:50px; max-width:50px;" >&nbsp;</td>',
                '<td style="border:0;width:50px; max-width:50px;" >&nbsp;</td>',
                '<td style="border:0;width:50px; max-width:50px;" >&nbsp;</td>',
                '<td style="border:0;width:200px;max-width:200px;">&nbsp;</td>',
                '<td style="border:0;width:35px; max-width:35px;" >&nbsp;</td>',
                '<td style="border:0;width:65px; max-width:65px;" >&nbsp;</td>',
                '<td style="border:0;width:125px;max-width:125px;">&nbsp;</td>',
                '<td style="border:0;width:100px;max-width:100px;">&nbsp;</td>',
				'<td style="border:0;width:200px;max-width:200px;">&nbsp;</td>',
                '<td style="border:0;width:200px;max-width:200px;">&nbsp;</td>',
                '<td style="border:0;width:200px;max-width:200px;">&nbsp;</td>',
                '<td style="border:0;width:35px; max-width:35px;" >&nbsp;</td>',
                '<td style="border:0;width:65px; max-width:65px;" >&nbsp;</td>',
                '<td style="border:0;width:125px;max-width:125px;">&nbsp;</td>',
                '</tr>'
            ],
            tblRowCompressed = [
                '<tr><td colspan="14" style="text-align: center;border:1px solid grey; max-width:75px; line-height: 10px;background-color:#F6F6F6;font-weight:800;font-size:8px;">',
                '<br><span style="font-size:14px;color:grey">',
                '<#=msgText#>',
                'for time period: ',
                '<#=BegDate#>',         //'03-21-2018 1200Hrs - 1159Hrs',
                '<#=EndDate#>',         //'03-22-2018 1200Hrs - 1159Hrs',
                '</span><br><br></td></tr>'
            ];
        arrDrugs = objData.drugs.sort(
            function (obj1,obj2) {
                return (obj1.TimeSlice - obj2.TimeSlice);
            });

        arrDrugs.forEach(
            function (item) {
                var objNSbase     = chla.eAppsClass.neo(),
                    arrWrkDrgname = [],
                    arrWrkDrgDose = [],
                    arrWrkDrgname2 = [],
                    arrWrkDrgDose2 = [],

                    objWrk2       = {
                        date1  : '&nbsp;',
                        PERIOD : '&nbsp;',
                        timepd : 0,
                        WAT    : '&nbsp;',
                        FLACC  : '&nbsp;',
                        SBS    : '&nbsp;',
                        CAPD   : '&nbsp;',
                        DRGORD1: '&nbsp;',
                        DOSAGE1: '&nbsp;',
                        PRN1   : '&nbsp;',
                        WPP1MI : '&nbsp;',
                        WPP1   : '&nbsp;',
                        CMT1   : '&nbsp;',
                        DRGORD3: '&nbsp;',
                        DRGORD2: '&nbsp;',
                        DOSAGE2: '&nbsp;',
                        PRN2   : '&nbsp;',
                        WPP2   : '&nbsp;',
                        WPP2MI : '&nbsp;'
                    },
                    objWrk        = {
                        date1  : item.PERIOD_DTTM.replace(' ', '<br/>'),
                        PERIOD : item.TimePeriod,
                        WAT    : '&nbsp;',
                        FLACC  : '&nbsp;',
                        SBS    : '&nbsp;',
                        CAPD   : '&nbsp;',
                        DRGORD1: '&nbsp;',
                        DOSAGE1: '&nbsp;',
                        PRN1   : '&nbsp;INV/1X:'.fontcolor('green') + item.oINV.toString().fontcolor('green') + '<br> PRN:'.fontcolor('red') + (item.oPRN-item.oINV).toString().fontcolor('red'), 
                        WPP1MI : (typeof item.oWPP_OTHER_INPUT !== 'undefined' ? item.oWPP.replace(',,:,',': ') + '&nbsp;' + item.oWPP_OTHER_INPUT : ''),
						WPP1   : (typeof item.oWPP_OTHER_INPUT !== 'undefined' ? item.oWPP.replace(',,:,',': ') + '&nbsp;' + item.oWPP_OTHER_INPUT : item.oWPP.replace(',,:,',': ')),
                        CMT1   : (typeof aObjCcBase.eApps.drugs.MISC_CMNTS[item.TimePeriod] !== 'undefined' ? aObjCcBase.eApps.drugs.MISC_CMNTS[item.TimePeriod] : '&nbsp;'),
                        DRGORD3: '&nbsp;',
						DRGORD2: '&nbsp;',
                        DOSAGE2: '&nbsp;',
                        PRN2   : '&nbsp;INV/1X:'.fontcolor('green') + item.bINV.toString().fontcolor('green') + '<br> PRN:'.fontcolor('red') + (item.bPRN-item.bINV).toString().fontcolor('red'), 
                        WPP2   : (typeof item.bWPP_OTHER_INPUT !== 'undefined' ? item.bWPP.replace(',,:,',': ') + '&nbsp;' + item.bWPP_OTHER_INPUT : item.bWPP.replace(',,:,',': ')),
                        WPP2MI : (typeof item.bWPP_OTHER_INPUT !== 'undefined' ? item.bWPP.replace(',,:,',': ') + '&nbsp;' + item.bWPP_OTHER_INPUT : '')
                    },
                    arrWrk        = [],
                    arrDrug,
                    strWrk;
                arrWrk.push('&nbsp;');
                arrWrk.push(item.WAT.p0.join(' ,'));
                objWrk.WAT    = arrWrk.join('');
                arrWrk.length = 0;
                arrWrk.push('&nbsp;');
                arrWrk.push(item.FLACC.p0.join(' ,'));
                objWrk.FLACC  = arrWrk.join('');
                arrWrk.length = 0;
                arrWrk.push('&nbsp;');
                arrWrk.push(item.SBS.p0.join(' ,'));
                objWrk.SBS    = arrWrk.join('');
                arrWrk.length = 0;
                arrWrk.push('&nbsp;');
                arrWrk.push(item.CAPD.p0.join(' ,'));
                objWrk.CAPD = arrWrk.join('');
                
						if (typeof item.objODrugSummary !== 'undefined') {
                    arrDrug = Object.keys(item.objODrugSummary);
                    arrDrug.forEach(
                        function (objItem) {
                            var drgItem = item.objODrugSummary[objItem],
                                arrWrk2 =[],
                                strWrk2,
                                arrWrkTemp;
                            // meds, meds IV and CI (prn:NO) are present for the time period
                            if ( drgItem.oPRN === 0 ) {
                                arrWrkDrgname.push('&nbsp;' , drgItem.DEPT_MISC_LINE , '<br/>');
                                arrWrkDrgDose.push('&nbsp;' , (drgItem.oDosage === 0 ? '0' : parseFloat(drgItem.oDosage).toFixed(2)) + ' ' + drgItem.oUnits);

                                    arrWrkTemp =  ChlaStdClass.uniqueArray(drgItem.oActualDose);

                                    arrWrk2.length = 0;
                                    strWrk2 = '';
                                    if(arrWrkTemp.length > 1) {

                                        if (drgItem.oCI_Ind === 0) {
                                            arrWrkTemp.forEach(
                                                function(item2){
                                                    arrWrk2.push('&nbsp;', drgItem.oDrug);
                                                    arrWrk2.push(' ');
                                                    arrWrk2.push(parseFloat(item2).toFixed(3));
                                                    arrWrk2.push('&nbsp;', drgItem.oUnits); //LP 12/13
                                                    arrWrk2.push('<br/>');
                                                }
                                            );
                                            strWrk2 += arrWrk2.join('');
                                        } else {

                                            arrWrkTemp.forEach(
                                                function(item2){
                                                    arrWrk2.push('&nbsp;', drgItem.oDrug);
                                                    arrWrk2.push(' ');
                                                    arrWrk2.push(parseFloat(item2).toFixed(3));
                                                    arrWrk2.push('&nbsp;', drgItem.oUnits); //LP 12/13
													arrWrk2.push('/kg/hr'); //LP 12/13
                                                    arrWrk2.push('<br/>');
                                                }
                                            );
                                            strWrk2 += arrWrk2.join('');
                                      }
                                    }
                                    if( strWrk2 !== ''){
                                        arrWrkDrgname.push('<span style="font-weight:800;color:blue;">&nbsp;Dose Chg1:</span><br/>');
                                        arrWrkDrgname.push(strWrk2);
                                    }  

                            } else if (item.oPRN > 0) {
                                    //scheduled  (prn:YES and PRN:Cnt > 0) are present for the time period
                                    arrWrkDrgname2.push('<span style="font-weight: normal;font-style: italic;">', '&nbsp;', drgItem.DEPT_MISC_LINE, '<br/>', '</span>');
                                    arrWrkDrgDose2.push('&nbsp;', (drgItem.oDosage === 0 ? '0' : parseFloat(drgItem.oDosage).toFixed(2)));
                                    arrWrkDrgDose2.push(' ', drgItem.oUnits);
                            }
                        }
                    );
                    objWrk.DRGORD1 = (arrWrkDrgname.length === 0? arrWrkDrgname2.join(''): arrWrkDrgname.join(''));
                    if(item.oDrug.length > 0){
                        objWrk.DOSAGE1 = (item.oDrug[0].oDosage > 0? item.oDrug[0].oDosage.replace(/.00$/,''): '');
                    }
                }

                arrWrkDrgDose.length  = 0;
                arrWrkDrgname.length  = 0;
                arrWrkDrgDose2.length = 0;
                arrWrkDrgname2.length = 0;
                if (typeof item.objBDrugSummary !== 'undefined') {
                    arrDrug = Object.keys(item.objBDrugSummary);
                    arrDrug.forEach(
                        function (objItem) {
                            var drgItem = item.objBDrugSummary[objItem],
                                arrWrk2 =[],
                                strWrk2,
                                arrWrkTemp;
                            // meds, meds IV and CI (prn:NO) are present for the time period
                            if (drgItem.bPRN === 0) {
                                arrWrkDrgname.push('&nbsp;' + drgItem.DEPT_MISC_LINE + '<br/>');
                                arrWrkDrgDose.push('&nbsp;' + (drgItem.bDosage === 0 ? '0' : parseFloat(drgItem.bDosage).toFixed(2)) + ' ' + drgItem.bUnits);

                                    arrWrkTemp =  ChlaStdClass.uniqueArray(drgItem.bActualDose);
                                    arrWrk2.length = 0;
                                    strWrk2 = '';
                                    if(arrWrkTemp.length > 1) {
                                        if (drgItem.bCI_Ind === 0) {
                                            arrWrkTemp.forEach(
                                                function(item2){
                                                    arrWrk2.push('&nbsp;', drgItem.bDrug);
                                                    arrWrk2.push(' ');
                                                    arrWrk2.push(parseFloat(item2).toFixed(3));
													arrWrk2.push(' ' + drgItem.bUnits); //LP 12/13
                                                    arrWrk2.push('<br/>');
                                                }
                                            );
                                            strWrk2 += arrWrk2.join('');
                                        } else {
                                            arrWrkTemp.forEach(
                                                function(item2){
                                                    arrWrk2.push('&nbsp;', drgItem.bDrug);
                                                    arrWrk2.push(' ');
                                                    arrWrk2.push(parseFloat(item2).toFixed(3));
													arrWrk2.push(' ' + drgItem.bUnits); //LP 12/13
													arrWrk2.push('/kg/hr'); //LP 12/13
                                                    arrWrk2.push('<br/>');
                                                }
                                            );
                                            strWrk2 += arrWrk2.join('');
                                        }
                                    }
                                    if (strWrk2 !== ''){
                                        arrWrkDrgname.push('<span style="font-weight:800;color:blue;">&nbsp;Dose Chg1:</span><br/>');
                                        arrWrkDrgname.push(strWrk2);
                                    }
                               // }
                            } else if (item.bPRN > 0) {
                                //scheduled  (prn:YES and PRN:Cnt > 0) are present for the time period
                                arrWrkDrgname2.push('<span style="font-weight: normal;font-style: italic;">','&nbsp;' , drgItem.DEPT_MISC_LINE , '<br/>','</span>');
                                arrWrkDrgDose2.push('&nbsp;' , (drgItem.bDosage === 0 ? '0' : parseFloat(drgItem.bDosage).toFixed(2)) );
                                arrWrkDrgDose2.push( ' ' , drgItem.bUnits);
                            }
                        }
                    );

                    objWrk.DRGORD2 = (arrWrkDrgname.length === 0? arrWrkDrgname2.join(''): arrWrkDrgname.join(''));
                    if(item.bDrug.length > 0){
                        objWrk.DOSAGE2 = (item.bDrug[0].bDosage > 0? item.bDrug[0].bDosage.replace(/.00$/,''): '');
                    }
                }
				
                arrWrkDrgDose.length  = 0;
                arrWrkDrgname.length  = 0;
                arrWrkDrgDose2.length = 0;
                arrWrkDrgname2.length = 0;
                if (typeof item.objADrugSummary !== 'undefined') {
                    arrDrug = Object.keys(item.objADrugSummary);
                    arrDrug.forEach(
                        function (objItem) {
                            var drgItem = item.objADrugSummary[objItem],
                                arrWrk2 =[],
                                strWrk2,
                                arrWrkTemp;
                            // meds, meds IV and CI (prn:NO) are present for the time period
                            if (drgItem.aPRN === 0) {
                                arrWrkDrgname.push('&nbsp;' + drgItem.DEPT_MISC_LINE + '<br/>');
                                arrWrkDrgDose.push('&nbsp;' + (drgItem.aDosage === 0 ? '0' : parseFloat(drgItem.aDosage).toFixed(2)) + ' ' + drgItem.aUnits);

                                    arrWrkTemp = ChlaStdClass.uniqueArray(drgItem.aActualDose);
                                    arrWrk2.length = 0;
                                    strWrk2 = '';
                                    if(arrWrkTemp.length > 1) {
                                        if (drgItem.aCI_Ind === 0) {
                                            arrWrkTemp.forEach(
                                                function(item2){
                                                    arrWrk2.push('&nbsp;', drgItem.aDrug);
                                                    arrWrk2.push(' ');
                                                    arrWrk2.push(parseFloat(item2).toFixed(3));
                                                    arrWrk2.push('&nbsp;', drgItem.aUnits); //LP 12/13
                                                    arrWrk2.push('<br/>');
                                                }
                                            );
                                            strWrk2 += arrWrk2.join('');
                                        } else {
                                            arrWrkTemp.forEach(
                                                function(item2){
                                                    arrWrk2.push('&nbsp;', drgItem.aDrug);
                                                    arrWrk2.push(' ');
                                                    arrWrk2.push(parseFloat(item2).toFixed(3));
                                                    arrWrk2.push('&nbsp;', drgItem.aUnits); //LP 12/13
													arrWrk2.push('/kg/hr'); //LP 12/13
                                                    arrWrk2.push('<br/>');
                                                }
                                            );
                                            strWrk2 += arrWrk2.join('');
                                        }
                                    }
                                    if (strWrk2 !== ''){
                                        arrWrkDrgname.push('<span style="font-weight:800;color:blue;">&nbsp;Dose Chg1:</span><br/>');
                                        arrWrkDrgname.push(strWrk2);
                                    }
                               // }
                            } else if (item.aPRN > 0) {
                                //scheduled  (prn:YES and PRN:Cnt > 0) are present for the time period
                                arrWrkDrgname2.push('<span style="font-weight: normal;font-style: italic;">','&nbsp;' , drgItem.DEPT_MISC_LINE , '<br/>','</span>');
                                arrWrkDrgDose2.push('&nbsp;' , (drgItem.aDosage === 0 ? '0' : parseFloat(drgItem.aDosage).toFixed(2)) );
                                arrWrkDrgDose2.push( ' ' , drgItem.aUnits);
                            }
                        }
                    );

                    objWrk.DRGORD3 = (arrWrkDrgname.length === 0? arrWrkDrgname2.join(''): arrWrkDrgname.join(''));
                }
//mm-stop
				
                objWrk.timepd = item.TimePeriod;

                if (aObjCcBase.eApps.FIN_ID !== objData.FIN) {
                    if(objWrk.WPP1   !== '&nbsp;' ||
                        objWrk2.WPP2  !== '&nbsp;' ||
                        objWrk2.CMT1  !== '&nbsp;' ) {
                        if (arrTimePeriod.length > 0) {
                            arrTable.push(objNSbase.gFuncs.parseTemplate(tblRowCompressed.join(''), {
                                //msgText:'No Sedation Scores or Orders ',
                                msgText:'No WPP or Comments ',
                                BegDate:arrTimePeriod.pop(),
                                EndDate: (arrTimePeriod.length > 1? '&nbsp;&nbsp;&nbsp;through&nbsp;&nbsp;&nbsp;' + arrTimePeriod[0]: '&nbsp;')
                            }));
                            arrTimePeriod.length= 0;
                        }
                        arrTable.push(objNSbase.gFuncs.parseTemplate(tblRow.join(''), objWrk));
                    } else {
                        arrTimePeriod.push(item.PERIOD_DTTM);
                    }
                } else {
                    if( objWrk.DRGORD1 !== '&nbsp;' ||
                        objWrk.DRGORD2 !== '&nbsp;' ||
						objWrk.DRGORD3 !== '&nbsp;' ||
                        objWrk.WAT     !== '&nbsp;' ||
                        parseInt(objWrk.FLACC.replace(/<br.>/g,'').replace(/&nbsp;/g,'').replace(/ /g,'').replace(/,/g,''))>0 ||
                        objWrk.SBS     !== '&nbsp;' ||
                        objWrk.CAPD    !== '&nbsp;' ) {
                        if (arrTimePeriod.length > 0) {
                            arrTable.push(objNSbase.gFuncs.parseTemplate(tblRowCompressed.join(''), {
                                msgText:'No Sedation Scores or Orders ',
                                BegDate:arrTimePeriod.pop(),
                                EndDate: (arrTimePeriod.length > 1? '&nbsp;&nbsp;&nbsp;through&nbsp;&nbsp;&nbsp;' + arrTimePeriod[0]: '&nbsp;')
                            }));
                            arrTimePeriod.length= 0;
                        }
                        arrTable.push(objNSbase.gFuncs.parseTemplate(tblRow.join(''), objWrk));
                    }else {
                        arrTimePeriod.push(item.PERIOD_DTTM);

                    }
                }

            }
        );
        if (arrTimePeriod.length > 0) {
            arrTable.push(aObjNSbase.gFuncs.parseTemplate(tblRowCompressed.join(''), {
                msgText: (aObjCcBase.eApps.FIN_ID !== objData.FIN? 'No WPP or Comments ':'No Sedation Scores or Orders '),
                BegDate:arrTimePeriod.pop(),
                EndDate: (arrTimePeriod.length > 1? '&nbsp;&nbsp;&nbsp;through&nbsp;&nbsp;&nbsp;' + arrTimePeriod[0]: '&nbsp;')
            }));
            arrTimePeriod.length= 0;
            arrTable.push(tblRowSpacer.join(''));
        }
        /**
         *
         * @param aObjNSbase
         * @param aObjCcBase
         * @returns {string}
         */
        function c8WppWindowContent(aObjNSbase, aObjCcBase) {
            var retVal= [];
            aObjCcBase.eApps.wppUiStructure.WppDec_CD.forEach(
                function (item) {
                    var strWrk,
                        strWidth;
                    if(item.cType ==='radio'){
                        retVal.push(
                            aObjNSbase.gFuncs.parseTemplate(WPP_Window_comp.radio.join(''), {
                                radioName:  item.level_id,
                                radioId:    item.code_value,
                                radioValue: item.code_value,
                                radioLabel: item.label + (typeof item.label2 !== 'undefined'? item.label2 : '' )
                            })
                        );
                    }else if(item.cType ==='checkbox'){
                        strWrk = item.level_id + '_'+ item.code_value.substr(0,4);
                        retVal.push(
                            aObjNSbase.gFuncs.parseTemplate(WPP_Window_comp.checkbox.join(''), {
                                checkboxName:  strWrk,
                                checkboxId:    item.code_value,
                                checkboxValue: item.code_value,
                                checkboxLabel: item.label + (typeof item.label2 !== 'undefined'? item.label2 : '' )
                            })
                        );
                    }else if(item.cType ==='inputText'){
                        strWidth = '730px';
                        if (item.label = 'New Dose'){
                            strWrk = retVal.pop().replace('<br/>','&nbsp;&nbsp;');
                            strWidth = '85px';
                            retVal.push(strWrk)
                        }
                        retVal.push(
                            aObjNSbase.gFuncs.parseTemplate(WPP_Window_comp.inputText.join(''), {
                                inputTextName:  item.code_value,
                                inputTextWidth: strWidth,
                                textareaValueAttr: item.code_value
                            })
                        );
                    }else if(item.cType ==='textarea'){
                        if (item.label = 'Other:'){
                            strWrk = retVal.pop().replace('<br/>','&nbsp;&nbsp;');
                            retVal.push(strWrk)
                        }
                        retVal.push(
                            aObjNSbase.gFuncs.parseTemplate(WPP_Window_comp.textarea.join(''), {
                                textareaName:  item.code_value,
                                textareaValueAttr: item.code_value
                            })
                        );
                    }
                }
            );
            return retVal.join('');
        }


        strWPPContent = c8WppWindowContent(aObjNSbase, aObjCcBase);
        arrTable.push('</tbody></table>');
        tableHtml.push(arrTable.join(''));
        tableHtml.push('</div>');

        // retVal.push(calcArr.join(''));
        if (typeof aObjCcBase.eApps.FIN_ID === 'undefined'){
            aObjCcBase.eApps.FIN_ID = objData.FIN;
        }
        objData.pastVisit.forEach(
            function (value,idx) {
                arrWrk.push('<option value="');
                arrWrk.push(value.ENCNTR_ID);
                arrWrk.push('_');
                arrWrk.push(value.REG_DATE);
                arrWrk.push('_');
                arrWrk.push(value.DC_DATE);
                arrWrk.push('" label="');
                if (idx === 0 ){
                    arrWrk.push('Current Visit">');
                } else {
                    arrWrk.push(value.REG_DATE.replace(/ .*/, ''));
                    arrWrk.push(' - ');
                    arrWrk.push(value.DC_DATE.replace(/ .*/, ''));
                    arrWrk.push((objData.FIN === value.FIN ? '" selected="selected">' : '">'));
                }
                arrWrk.push('</option>');
                if (idx === 0 ) {
                    if (value.DC_DATE !== '') {
                        arrWrk.length = 0;
                    }
                }
            }
        );
        strFin =  objData.FIN;
        if ( aObjCcBase.eApps.FIN_ID === objData.FIN){
            if (objData.DSCHDT === ''){
                strFin = 'Current';
            }
        }
        retValDto.mainSection.push(aObjNSbase.gFuncs.parseTemplate(calcArr.join(''), {
                FINID:strFin,
                EnctrOptions:arrWrk.join(''),
                CurDspRange:aObjCcBase.eApps.BEGDT.replace(/ .*/,'').replace(/-/g,"/") + ' - ' + aObjCcBase.eApps.ENDDT.replace(/ .*/,'').replace(/-/g,"/")
            })
        );
        retValDto.mainSection.push(tableHtml.join(''));
        retValDto.mainSection.push(aObjNSbase.gFuncs.parseTemplate(WPP_Window1.join(''), {
                WPPWindowContent:strWPPContent
            })
        );
        retValDto.mainSection.push(commentsWindow.join(''));
        retValDto.mainSection.push('<div style="width:100%;height:20px;">&nbsp;</div>');
        retValDto.mainSection.push('<div style="width:20px;display: inline-block;">&nbsp;</div>');
        retValDto.mainSection.push(MorphChart);
        retValDto.mainSection.push('<div style="width:100%;height:20px;">&nbsp;</div>');
        retValDto.mainSection.push('<div style="width:20px;display: inline-block;">&nbsp;</div>');
        retValDto.mainSection.push(ChartLegend);
        retValDto.mainSection.push('<div style="width:100%;height:20px;">&nbsp;</div>');
        retValDto.mainSection.push('<div style="width:20px;display: inline-block;">&nbsp;</div>');
        retValDto.mainSection.push(LorazChart);
        retValDto.mainSection.push('<div style="width:100%;height:20px;">&nbsp;</div>');
        retValDto.mainSection.push('<div style="width:50px;display: inline-block;">&nbsp;</div>');
//	retValDto.mainSection.push('<p>' + tempData + '</p>');
        return retValDto.mainSection.join('');
    };
    /**
     * Parent function for processing functions after the UI has been render to the DOM
     * @param aObjNSbase {object} CHLA namespace composite object
     * @param aObjCcBase {object} CC component object
     */
    component.ccSedation.ccnsp.processPostCcInstance  = function (aObjNSbase, aObjCcBase) {
        var series = [
                {
                    // Change our line width and use a diamond shaped marker.
                    lineWidth    : 4,
                    markerOptions: {size:14, style: 'filledDiamond'},
                    color:'#0000ff'

                },
                {
                    // Use (open) circlular markers.
                    markerOptions: {style: "filledCircle"},
                    lineWidth    : 3,
                    color:'#ff0000'
                },
                {
                    // Use a thicker, 5 pixel line and 10 pixel
                    // filled square markers.
                    lineWidth    : 2,
                    markerOptions: {style: 'filledSquare'},
                    color:'#008000'
                }
            ],
            curDate = new Date();

        aObjCcBase.fncWppLoadCCL1 = function (data){      //callback.call(self, JSON.parse(responseData));
            var component = this;
            $('#' + component.eApps.cc_id).remove();
            this.data = data;
            component.render();
        };

        /**
         *
         * @param aObjCcBase
         * @param aDto
         * @param aCallBack
         */
        aObjCcBase.eApps.WPP_CMNT_SAVE = function (aObjCcBase,aDto,aCallBack) {
            var cclParms = [];//aObjCcBase.cclParams;
            cclParms.push("MINE");
            cclParms.push(aDto.FUNCOPER);          // FUNCOPER
            cclParms.push(aObjCcBase.getProperty('encounterId')- 0); // ENCNTR_ID
            cclParms.push(aObjCcBase.getProperty('personId')-0);     // PERSON_ID
            cclParms.push(aObjCcBase.getProperty('userId')-0);       // USERID
            cclParms.push(aDto.BEGDATE);                             // .BEGDATE
            cclParms.push(aDto.ENDDATE);                             // .ENDDATE
            cclParms.push(aDto.BEGTIME);                             // .BEGTIME
            cclParms.push(aDto.ENDTIME);                             // .ENDTIME
            cclParms.push(aDto.MISC_COMMENTS);                       // .MISC_COMMENTS
            cclParms.push(aDto.DECISION_CD - 0);                     // .DECISION_CD
            cclParms.push(aDto.OPT_A - 0);                           // .OPT_A
            cclParms.push(aDto.OPT_B - 0);                           // .OPT_B
            cclParms.push(aDto.OPT_C - 0);                           // .OPT_C
            cclParms.push(aDto.OPT_D - 0);                           // .OPT_D
            cclParms.push(aDto.OPT_E - 0);                           // .OPT_E
            cclParms.push(aDto.WPP_OTHER_INPUT);                     // .WPP_OTHER_INPUT
            cclParms.push(aDto.ROWTYPE_CD - 0);                      // .ROWTYPE_CD
            cclParms.push(aDto.ENTRY_DT);                            //wppEntryDt
            aObjCcBase.loadCcl('chla_ca_mp_cc_clinicalcare',
                cclParms,
                aCallBack,
                "JSON");
        };

        /**
         *
         * @param aObjCcBase
         * @param aCallTypeCd
         * @param aEntryDt
         * @returns {*}
         */
        aObjCcBase.eApps.loadWppCmtData = function (aObjCcBase,aCallTypeCd,aEntryDt) {
            var dto = {
                    FUNCOPER:3,
                    BEGDATE:'',
                    ENDDATE:'',
                    BEGTIME:'',
                    ENDTIME:'',
                    MISC_COMMENTS:  '',
                    DECISION_CD:    0,
                    ENTRY_DT:       '',
                    OPT_A:          0,
                    OPT_B:          0,
                    OPT_C:          0,
                    OPT_D:          0,
                    OPT_E:          0,
                    WPP_OTHER_INPUT: '',
                    ROWTYPE_CD:     0
                },
                allInputs,
                arrSelector,
                arrKeys,
                numDecision = '00000',
                numSelect;
            dto.ROWTYPE_CD = aCallTypeCd;
            dto.ENTRY_DT = aEntryDt;
            if(aCallTypeCd === 6000){  //Comments
                chla.eAppsUtil.Logger.LogWarn('aCallTypeCd === 6000 - Save Button click');
                dto.MISC_COMMENTS = $('textarea#ccSedationCmtsText').val();
            }else {  // 5000 OPIOID - 5100 Benzodazenpines
                chla.eAppsUtil.Logger.LogWarn('5000 OPIOID - 5100 Benzodazenpines - Save Button click');
                allInputs = $( "input[name*='ccSed']" );
                arrKeys = Object.keys(allInputs);
                arrKeys.forEach(
                    function(item) {
                        var objItem = allInputs[item];
                        if (typeof objItem.type !== 'undefined') {
                            if (objItem.type === 'radio') {
                                if (objItem.checked) {
                                    dto.DECISION_CD = objItem.value;
                                    numDecision = objItem.value.substr(0,4);
                                }
                            }
                            if (objItem.type === 'checkbox') {
                                if (objItem.checked) {
                                    arrSelector = objItem.value.split('');
                                    numSelect   = arrSelector.pop();
                                    switch (numSelect) {
                                        case '1':
                                            dto.OPT_A = objItem.value;
                                            break;
                                        case '2':
                                            dto.OPT_B = objItem.value;
                                            break;
                                        case '3':
                                            dto.OPT_C = objItem.value;
                                            break;
                                        case '4':
                                            dto.OPT_D = objItem.value;
                                            break;
                                        case '5':
                                            dto.OPT_E = objItem.value;
                                            break;
                                    }
                                }
                            }
                            if (objItem.type === 'text') {
                                if (objItem.id.indexOf(numDecision) > -1) {
                                    dto.WPP_OTHER_INPUT = objItem.value
                                }
                            }
                        }

                    })
            }


            return dto;
        };
        aObjCcBase.eApps.objCcBaseRef = {
            objCcBase :        aObjCcBase
        };

        $("td.ccSedationCmt").on('click',aObjCcBase.eApps.objCcBaseRef,
            /**
             *
             */
            function (event) {
                var tpcode,
                    offset = $('div#chla_ccSedation').position(),
                    strWrk,
                    $ccSedationCmtCanel =  $("button#ccSedationCmtCanel"),
                    $ccSedationCmtSave =  $("button#ccSedationCmtSave"),
                    $ccSedationCmtText = $("textarea#ccSedationCmtsText"),
                    objCcBase = event.data.objCcBase;

                $ccSedationCmtText.val('');
                tpcode = $(this).attr('tpcode');
                $('input#ccSedationCmtsTpcode').val(tpcode.substr(4) + tpcode.substr(0,4));
                if (typeof objCcBase.eApps.drugs.MISC_CMNTS[tpcode] !== 'undefined' ) {
                    strWrk = objCcBase.eApps.drugs.MISC_CMNTS[tpcode];
                    $ccSedationCmtText.val(strWrk.substring(0,2000));
                }
                objCcBase.cclParms = [];
                $('div#ccSedCmtsWindow').css({
                    "display": "block",
                    "top"    :  offset.top + 'px', //"5px",
                    "left"   : "200px"
                });
                $ccSedationCmtCanel.on('click',
                    /**
                     *
                     */
                    function () {
                        $ccSedationCmtCanel.off();
                        $ccSedationCmtSave.off();
                        $('div#ccSedCmtsWindow').css({
                            "display": "none"
                        });
                    }
                );
                $("button#ccSedationCmtsSave").on('click', aObjCcBase.eApps.objCcBaseRef,
                    /**
                     *
                     * @param event
                     */
                    function (event) {
                        var objCcBase = event.data.objCcBase,
                            callTypeCd = 6000,
                            entry_dt = $('input#ccSedationCmtsTpcode').val(),
                            DtoUI;
                        $("button#ccSedationCmtsSave").off();
                        $("button#ccSedationCmtCanel").off();
                        $('div#ccSedWppWindow').css({
                            "display": "none"
                        });
                        chla.eAppsUtil.Logger.LogWarn('loadWppCmtData - Save Button click: ' + callTypeCd + ' : ' + entry_dt);
                        DtoUI = aObjCcBase.eApps.loadWppCmtData(objCcBase,callTypeCd,entry_dt);
                        aObjCcBase.eApps.WPP_CMNT_SAVE(objCcBase,DtoUI,objCcBase.fncWppLoadCCL1 );
                    }
                );
            }
        );
        $("select#selectEnct").on('change',aObjCcBase.eApps.objCcBaseRef,
            function (event) {
                var objCcBase = event.data.objCcBase,
                    objCurDate = new Date(),
                    objSDate,
                    objEDate,
                    strSDate,
                    strEDate,
                    strCurDate,
                    arrSelectValue= $(this).val().split('_');

                strCurDate = objCcBase.eApps.appNS.gFuncs.sFormatShortDate(objCurDate);

                objCcBase.cclParams[1] = 5;                //1, "Functional Operator"
                objCcBase.cclParams[2] = arrSelectValue[0];//2, "Encounter_Id" = 0

                strSDate = arrSelectValue[1].replace(/ .*/,'');
                objSDate = new Date(strSDate);
                objCcBase.cclParams[5] = strSDate;          //5, "Start Date (MM/DD/YYYY)"

                strEDate = (arrSelectValue[2] !== ''? arrSelectValue[2].replace(/ .*/,''):strCurDate);
                objEDate = new Date(strEDate);

                objCcBase.cclParams[6] = strEDate;  //6, "End Date (MM/DD/YYYY)"
                if (Math.floor((objEDate - objSDate))/ (1000 * 60 * 60 * 24) > 14){
                    objSDate.setDate(objSDate.getDate() + 14);
                    strEDate = objCcBase.eApps.appNS.gFuncs.sFormatShortDate(objSDate);
                    objCcBase.cclParams[6] = strEDate; //6, "End Date (MM/DD/YYYY)"
                }
                objCcBase.cclParams[7] = objCcBase.eApps.STTM.replace(/:00$/,'').replace(/:/g,'');//7, "Begin Time (HHMM)"
                objCcBase.cclParams[8] = objCcBase.eApps.STTM.replace(/:00$/, '').replace(/:/g, '');//8, "End Time (HHMM)"
                if (strSDate !== strEDate) {
                    $('div#chla_ccSedation').remove();
                    component.loadCcl(
                        component.cclProgram,
                        component.cclParams.slice(),
                        aObjCcBase.eApps.ReRender,
                        "JSON");
                } else {
                    chla.eAppsUtil.Logger.LogError([
                        'Error: Start Date = End for function',
                        ':: calBtnHandler'
                    ].join(''));
                }
            });

        $("td.ccSedationWPP").on('click',aObjCcBase.eApps.objCcBaseRef,
            /**
             *
             * @param event
             */
            function (event) {
                var wndType,
                    wndTitle,
                    tpcode,
                    objWrk,
                    HtmlCtlId,
                    objCcBase = event.data.objCcBase;

                $('div#ccSedWppWindow').css({
                    "display": "block",
                    "top"    : "5px",
                    "left"   : "200px"
                });
                wndType = $(this).attr('wndType');
                $('div#ccSedWppWindow [type=checkbox]').prop('checked',false);
                $('div#ccSedWppWindow [type=radio]').prop('checked',false);
                $("[id^=ccSedationWppText]").val('');
                tpcode = $(this).attr('tpcode');
                if(wndType ==="BENZ"){
                    wndTitle = '<span tpcode="' + tpcode.substr(4) +tpcode.substr(0,4) + '" wndType="BENZ" id="WPPTITLE">Sedation WPP (Benzodiazepines)</span>';
                } else {
                    wndTitle = '<span tpcode="' + tpcode.substr(4) +tpcode.substr(0,4) + '" wndType="OPIOD" id="WPPTITLE">Sedation WPP (Opioids) </span>';
                }
                $("span#WPPTITLE").replaceWith(wndTitle);
                if(wndType ==="BENZ"){
                    objWrk = objCcBase.eApps.drugs.bWPP_CMNTS[tpcode];
                }else {
                    objWrk = objCcBase.eApps.drugs.oWPP_CMNTS[tpcode];
                }
                if (typeof objWrk !== 'undefined') {
                    if (objWrk.DECISION_CD > 0)
                        $('#ccSedRadio' + objWrk.DECISION_CD).prop('checked', true);

                    if (objWrk.OPT_A > 0) {
                        HtmlCtlId = objWrk.OPT_A;
                        $('#ccSedchkbx' + objWrk.OPT_A).prop('checked', true);
                    }
                    if (objWrk.OPT_B > 0) {
                        HtmlCtlId = objWrk.OPT_B;
                        $('#ccSedchkbx' + objWrk.OPT_B).prop('checked', true);
                    }
                    if (objWrk.OPT_C > 0) {
                        HtmlCtlId = objWrk.OPT_C;
                        $('#ccSedchkbx' + objWrk.OPT_C).prop('checked', true);
                    }
                    if (objWrk.OPT_D > 0) {
                        HtmlCtlId = objWrk.OPT_D;
                        $('#ccSedchkbx' + objWrk.OPT_D).prop('checked', true);
                    }
                    if (objWrk.OPT_E > 0) {
                        HtmlCtlId = objWrk.OPT_E;
                        $('#ccSedchkbx' + objWrk.OPT_E).prop('checked', true);
                    }
                    if (objWrk.WPP_OTHER_INPUT !== '') {
                        $("input#ccSedationWppText" + HtmlCtlId).val(objWrk.WPP_OTHER_INPUT.substring(0,120));
                    }
                }
                $("[id^='ccSedRadio']").on('click',
                    /**
                     *
                     * @param event
                     */
                    function (event) {
                        var arrKeys,
                            allInputs = $( "input[name*='ccSed']" );
                        arrKeys = Object.keys(allInputs);
                        arrKeys.forEach(
                            function(item) {
                                var objItem = allInputs[item];
                                if (typeof objItem.type !== 'undefined') {
                                    if (objItem.id.indexOf('ccSed') > -1) {
                                        if (objItem.type === 'checkbox') {
                                            if (objItem.checked) {
                                                objItem.checked = false;
                                            }
                                        }
                                        if (objItem.type === 'text') {
                                            objItem.value = '';
                                        }
                                    }
                                }
                            }
                        )
                    }
                );
                $('button#ccSedationWppCancel').on('click', function () {
                    $('button#ccSedationWppCancel').off();
                    $('button#ccSedationWppSave').off();
                    $('div#ccSedWppWindow').css({
                        "display": "none"
                    });
                });
                $("button#ccSedationWppSave").on('click',aObjCcBase.eApps.objCcBaseRef,
                    function (event) {
                        var objCcBase = event.data.objCcBase,
                            callTypeCd = 5000,
                            $WPPTITLE = $("span#WPPTITLE"),
                            entry_dt,
                            DtoUI;
                        entry_dt = $WPPTITLE.attr('tpcode');
                        $("button#ccSedationWppSave").off();
                        $("button#ccSedationWppCancel").off();
                        $('div#ccSedWppWindow').css({
                            "display": "none"
                        });
                        if ($WPPTITLE.attr('wndType')=== 'BENZ' ){
                            callTypeCd = 5100;
                        }
                        chla.eAppsUtil.Logger.LogWarn('loadWppCmtData - Save Button click: ' + callTypeCd + ' : ' + entry_dt);
                        DtoUI = aObjCcBase.eApps.loadWppCmtData(objCcBase,callTypeCd,entry_dt);
                        aObjCcBase.eApps.WPP_CMNT_SAVE(objCcBase,DtoUI,objCcBase.fncWppLoadCCL1);
                    }
                );
            }
        );

        /**
         *
         * @param aObjNSbase
         * @param aObjCcBase
         */
        function c8ChartOpioid(aObjNSbase, aObjCcBase) {
            if (aObjCcBase.eApps.drugs.opioidEqDataSet1.length + aObjCcBase.eApps.drugs.opioidEqDataSet2.length + aObjCcBase.eApps.drugs.opioidEqDataSet3.length > 0) {
                $.jqplot('chartOpioid', [aObjCcBase.eApps.drugs.opioidEqDataSet1, aObjCcBase.eApps.drugs.opioidEqDataSet2, aObjCcBase.eApps.drugs.opioidEqDataSet3],
                    {
                        title         : '<span style="font-size:16px;font-weight:800;">Opioid Equivalents</span>',
                        seriesDefaults: {
                            rendererOptions: {
                                smooth: false //true
                            }
                        },
                        axes          : {
                            xaxis: {
                                renderer    : $.jqplot.DateAxisRenderer,
                                tickOptions : {formatString: ' %m/%d'},
                                min         : aObjCcBase.eApps.drugs.opioidEqDataSet1[0][0],
                                tickInterval: '1 day'
                            },
                            yaxis: {
                                label        : 'Equivalents (mg/kg)',
                                tickOptions : {formatString: ' %.2f'},
                                min           : 0.0,
                                labelRenderer: $.jqplot.CanvasAxisLabelRenderer
                            }
                        },
                        series        : series,
                        cursor        : {
                            show: false
                        },
                        highlighter: {
                            show: true,
                            formatString: '%s %.2f mg',
                            tooltipLocation: 'n'
                        }
                    }
                );
            } else {
                $('div#chartOpioid').html('No Chart Opioid Equivalents Data Available');
            }
        }

        /**
         *
         * @param aObjNSbase
         * @param aObjCcBase
         */
        function c8chartBenz(aObjNSbase, aObjCcBase) {
            // var labels = [
            //     'Total Equivalents',
            //     'Sched Equivalents',
            //     'PRN Equivalents'
            // ];
            // var plot3  =
            if (aObjCcBase.eApps.drugs.benzEqDataSet1.length + aObjCcBase.eApps.drugs.benzEqDataSet2.length + aObjCcBase.eApps.drugs.benzEqDataSet3.length > 0){
                $.jqplot('chartBenz', [aObjCcBase.eApps.drugs.benzEqDataSet1, aObjCcBase.eApps.drugs.benzEqDataSet2, aObjCcBase.eApps.drugs.benzEqDataSet3],
                    {
                        title         : '<span style="font-size:16px;font-weight:800;">Benzodazenpines Equivalents</span>',
                        axes          : {
                            xaxis: {
                                renderer    : $.jqplot.DateAxisRenderer,
                                tickOptions : {
                                    formatString: ' %m/%d'
                                },
                                min         : aObjCcBase.eApps.drugs.benzEqDataSet1[0][0],
                                tickInterval: '1 day'
                            },
                            yaxis: {
                                label        : 'Equivalents (mg/kg)',
                                tickOptions : {formatString: ' %.2f'},
                                min           : 0.0,
                                labelRenderer: $.jqplot.CanvasAxisLabelRenderer
                            }
                        },
                        seriesDefaults: {
                            rendererOptions: {
                                smooth: false
                            }
                        },
                        // Series options are specified as an array of objects, one object
                        // for each series.
                        series        : series,
                        cursor        : {
                            show: false
                        },
                        highlighter: {
                            show: true,
                            formatString: '%s %.2f mg',
                            tooltipLocation: 'n'
                        }
                    }
                );
            } else {
                $('div#chartBenz').html('No Chart Benzodazenpines Equivalents Data Available');
            }
        }
        c8ChartOpioid(aObjNSbase, aObjCcBase);
        c8chartBenz(aObjNSbase, aObjCcBase);
        try {
            $('#CCare_SED_datepicker1').datepicker(
                {
                    "setDate"        : aObjCcBase.eApps.BEGDT,
                    "ObjCcBase"      : aObjCcBase,
                    minDate         : aObjCcBase.eApps.REGDT,
                    maxDate         : (aObjCcBase.eApps.DSCHDT !== ''? aObjCcBase.eApps.DSCHDT: aObjNSbase.gFuncs.getStrFromDateObj(curDate,'/') ),
                    // constrainInput: true
                    "onSelect"      : function (dateText,objDatePicker) {
                        var component =  objDatePicker.settings.ObjCcBase,
                            objDate = new Date(dateText),
                            objCurDate = new Date(),
                            strDate;

                        component.cclParams[1] = 0;                              //1, "Functional Operator"
                        component.cclParams[5] = dateText;                       //5, "Start Date (MM/DD/YYYY)"
                        strDate = component.eApps.appNS.gFuncs.sFormatShortDate(objCurDate);
                        component.cclParams[6] = strDate;                       //6, "End Date (MM/DD/YYYY)"
                        if (Math.floor((new Date(strDate) - new Date(dateText)))/ (1000 * 60 * 60 * 24) > 14){
                            objDate.setDate(objDate.getDate() + 14);
                            strDate = component.eApps.appNS.gFuncs.sFormatShortDate(objDate);
                            component.cclParams[6] = strDate;                    //6, "End Date (MM/DD/YYYY)" = ""
                        }
                        component.cclParams[7] = component.eApps.STTM.replace(/:00$/,'').replace(/:/g,'');//7, "Begin Time (HHMM)"
                        component.cclParams[8] = component.eApps.STTM.replace(/:00$/, '').replace(/:/g, '');//8, "End Time (HHMM)"
                        if (dateText !== strDate) {
                            $('div#chla_ccSedation').remove();
                            component.loadCcl(
                                component.cclProgram,
                                component.cclParams.slice(),
                                aObjCcBase.eApps.ReRender,
                                "JSON");
                        } else {
                            chla.eAppsUtil.Logger.LogError([
                                'Error: Start Date = End for function',
                                ':: calBtnHandler'
                            ].join(''));
                        }
                    }
                });
        }
        catch (err) {
            chla.eAppsUtil.Logger.LogError(err.message);
        }

        aObjCcBase.eApps.calBtnHandler = function (event) {
            var objCcBase = event.data.objCcBase,
                objNSbase = event.data.objNSbase,
                objRegDate,
                objDchDate,
                objBegDate,
                objEndDate,
                objDate,
                strNewBegDt,
                strNewEndDt,
                strRegDt  = event.data.RegDt.split(' ')[0],
                strDchDt = event.data.DschDt.split(' ')[0],
                strBegDt = event.data.BegDt.split(' ')[0],
                strEndDt = event.data.EndDt.split(' ')[0];

            objRegDate = new Date(strRegDt);
            objDchDate = new Date(strDchDt);
            objBegDate = new Date(strBegDt);
            objEndDate = new Date(strEndDt);

            if (event.data.btnID.toUpperCase() === 'PREV'){
                /*
                Prev
                    BegDt >= RegDt  ===> (EndDt = BegDt)
                    BegDt - 14 days  = new(BegDT)
                    if new(BegDT) >= RegDt
                        BegDt = new( BegDT)
                    else
                        BegDt = RegDt
                 */
                /*objBegDate = new Date(strBegDt);
                if (objBegDate >= objRegDate) {
                     strNewEndDt = objNSbase.gFuncs.getStrFromDateObj(objBegDate,'/');
                } else {
                     strNewEndDt = objNSbase.gFuncs.getStrFromDateObj(objRegDate,'/');
                }
                objDate = new Date(strBegDt);
                objDate.setDate(objDate.getDate() - 14);
                if (objDate >= objRegDate) {
                    strNewBegDt = objNSbase.gFuncs.getStrFromDateObj(objDate,'/');
                }else {
                    strNewBegDt = objNSbase.gFuncs.getStrFromDateObj(objRegDate,'/');
                } Commented by LP on 05/22, new code below */

                objBegDate = new Date(strBegDt);
                if (objBegDate >= objRegDate) {
                    strNewEndDt = objNSbase.gFuncs.getStrFromDateObj(objBegDate,'/');
                } else {
                    strNewEndDt = objNSbase.gFuncs.getStrFromDateObj(objRegDate,'/');
                }
                objDate = new Date(strBegDt);
                objDate.setDate(objDate.getDate() - 14);
                if (objDate >= objRegDate) {
                    strNewBegDt = objNSbase.gFuncs.getStrFromDateObj(objDate,'/');
                }else {
                    strNewBegDt = objNSbase.gFuncs.getStrFromDateObj(objRegDate,'/');
                }

                if (strNewBegDt === strNewEndDt) {
                    objDate = new Date(strBegDt);
                    objDate.setDate(objDate.getDate() + 1);
                    strNewEndDt = objNSbase.gFuncs.getStrFromDateObj(objDate,'/');
                }
            }else if (event.data.btnID.toUpperCase() === 'NEXT'){
                /*
                Next
                    EndDt <= CurrDate ===> (BegDt = EndDt)
                    EndDt + 14 days = new(EndDt)
                    if DchDt !== ''
                        if new(EndDt) < DchDt ==> new(EndDt) else DchDt
                    else
                        if new(EndDt) < CurrDate ==> new(EndDt) else CurrDate
                 */
                objEndDate = new Date(strEndDt);

                if (objEndDate <= objDchDate) {
                    strNewBegDt = objNSbase.gFuncs.getStrFromDateObj(objEndDate,'/');
                } else {
                    strNewBegDt = objNSbase.gFuncs.getStrFromDateObj(objDchDate,'/');
                }
                objDate = new Date(strEndDt);
                objDate.setDate(objDate.getDate() + 14);
                if (objDate >= objDchDate) {
                    strNewEndDt = objNSbase.gFuncs.getStrFromDateObj(objDchDate,'/');
                }else {
                    strNewEndDt = objNSbase.gFuncs.getStrFromDateObj(objDate,'/');
                }
            } else {
                chla.eAppsUtil.Logger.LogError([
                    'Error: invalid Date for function',
                    ':: calBtnHandler'
                ].join(''));
            }
            objCcBase.cclParams[1] = 0;                              //1, "Functional Operator"
            objCcBase.cclParams[5] = strNewBegDt;                    //5, "Start Date (MM/DD/YYYY)"
            objCcBase.cclParams[6] = strNewEndDt;                    //6, "End Date   (MM/DD/YYYY)"

            $('div#chla_ccSedation').remove();
            objCcBase.loadCcl(
                objCcBase.cclProgram,
                objCcBase.cclParams.slice(),
                aObjCcBase.eApps.ReRender,
                "JSON");
        };
        try {
            $('button#btnPrev').on('click',{
                'btnID': 'Prev',
                'objCcBase': aObjCcBase,
                'objNSbase': aObjNSbase,
                'RegDt' : aObjCcBase.eApps.REGDT,
                'DschDt': aObjCcBase.eApps.DSCHDT,
                'BegDt' :  aObjCcBase.eApps.BEGDT,
                'EndDt' :  aObjCcBase.eApps.ENDDT
            },aObjCcBase.eApps.calBtnHandler);
        }
        catch (err) {
            chla.eAppsUtil.Logger.LogError(err.message);
        }
        try {
            $('button#btnNext').on('click',{
                'btnID': 'NEXT',
                'objCcBase': aObjCcBase,
                'objNSbase': aObjNSbase,
                'RegDt' : aObjCcBase.eApps.REGDT,
                'DschDt': aObjCcBase.eApps.DSCHDT,
                'BegDt' :  aObjCcBase.eApps.BEGDT,
                'EndDt' :  aObjCcBase.eApps.ENDDT
            },aObjCcBase.eApps.calBtnHandler);
        }
        catch (err) {
            chla.eAppsUtil.Logger.LogError(err.message);
        }
    };

    /**
     *  Call to build CC and to render to CC framework
     */
    component.ccSedation.ccnsp.ProcessCtl(component.ccSedation.ccnsp,component);
};

/*====== END OF CHLA SECTION  REQUIRED FILE TERMINATOR INDICATOR ======*/

/**************************************************************************************************************************
 * CERNER CUSTOM CODE SECTION
 **************************************************************************************************************************/

MPage.namespace("cerner");

/*Initialize Sepsis Alert Status Component*/
cerner.sepsis_status = function(){};
cerner.sepsis_status.prototype = new MPage.Component();
cerner.sepsis_status.prototype.constructor = MPage.Component;
cerner.sepsis_status.prototype.base = MPage.Component.prototype;
cerner.sepsis_status.prototype.name = "cerner.sepsis_status";
cerner.sepsis_status.prototype.cclProgram = "MP_GET_SEPSIS_ALERT_STATUS";
cerner.sepsis_status.prototype.cclParams = "";
cerner.sepsis_status.prototype.cclDataType = "JSON";

/* Initialize the cclParams variable */
cerner.sepsis_status.prototype.init = function(options){
    var params = [];
    params.push("MINE");
    this.cclParams = params;
};

/* Render the basic layout of the component */
cerner.sepsis_status.prototype.render = function(){
    var component = this;
    var compId;
    var status;
    var contentArea = this.getTarget();
    var divElement = document.createElement("div");

    status = component.data.SEPSISSTATUS;
    compId = component.getComponentUid();

    if (status.STATUS === 0) {
        divElement.innerHTML = "Downtime alert: Sepsis alerts are not functioning properly at this time.";  //alerts status down
        divElement.className = 'cerner_sepsis_status_red';
    } else if (status.STATUS === 1) {
        divElement.innerHTML = "Sepsis alerts are functioning properly.";  //alerts status working
        divElement.className = 'cerner_sepsis_status_black';
    } else if (status.STATUS === 2) {
        divElement.innerHTML = "Downtime alert: Sepsis alerts are not functioning properly at this time.";  //alerts status delays
        divElement.className = 'cerner_sepsis_status_red';
    } else {
        divElement.innerHTML = "Unable to determine the status of the sepsis alerts.";  //alerts status unknown
        divElement.className = 'cerner_sepsis_status_black';
    }
    contentArea.appendChild(divElement);
};


MPage.namespace("cerner");

cerner.etreby_patientHistory=function(){};
cerner.etreby_patientHistory.prototype=new MPage.Component();
cerner.etreby_patientHistory.prototype.constructor=MPage.Component;
cerner.etreby_patientHistory.prototype.base=MPage.Component.prototype;
cerner.etreby_patientHistory.prototype.name="cerner.etreby_patientHistory";

cerner.etreby_patientHistory.prototype.init=function(options){
};

//JC022736 1/26/14: I wrapped all of the below code in an immediate anonymous function so that I could include the jqGrid and locale stuff below without conflicting with other libraries in use within MPages code, etc.
(function(){

    /* JC022736 -
     * jqGrid  4.7.1
     * Copyright (c) 2008, Tony Tomov, tony@trirand.com st
     *  License: http://guriddo.net/?page_id=103334
     */
    /*
     Guriddo jqGrid JS 4.7.0 (2014-12-08)
     Copyright (c) 2008, Tony Tomov, tony@trirand.com

     License: http://guriddo.net/?page_id=103334
     */
    (function(b){b.jgrid=b.jgrid||{};b.extend(b.jgrid,{version:"4.7.0",htmlDecode:function(b){return b&&("&nbsp;"===b||"&#160;"===b||1===b.length&&160===b.charCodeAt(0))?"":b?String(b).replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&amp;/g,"&"):b},htmlEncode:function(b){return b?String(b).replace(/&/g,"&amp;").replace(/\"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):b},format:function(g){var f=b.makeArray(arguments).slice(1);null==g&&(g="");return g.replace(/\{(\d+)\}/g,
            function(b,d){return f[d]})},msie:"Microsoft Internet Explorer"===navigator.appName,msiever:function(){var b=-1;null!=/MSIE ([0-9]{1,}[.0-9]{0,})/.exec(navigator.userAgent)&&(b=parseFloat(RegExp.$1));return b},getCellIndex:function(g){g=b(g);if(g.is("tr"))return-1;g=(g.is("td")||g.is("th")?g:g.closest("td,th"))[0];return b.jgrid.msie?b.inArray(g,g.parentNode.cells):g.cellIndex},stripHtml:function(b){b=String(b);var f=/<("[^"]*"|'[^']*'|[^'">])*>/gi;return b?(b=b.replace(f,""))&&"&nbsp;"!==b&&"&#160;"!==
        b?b.replace(/\"/g,"'"):"":b},stripPref:function(g,f){var e=b.type(g);if("string"===e||"number"===e)g=String(g),f=""!==g?String(f).replace(String(g),""):f;return f},parse:function(g){"while(1);"===g.substr(0,9)&&(g=g.substr(9));"/*"===g.substr(0,2)&&(g=g.substr(2,g.length-4));g||(g="{}");return!0===b.jgrid.useJSON&&"object"===typeof JSON&&"function"===typeof JSON.parse?JSON.parse(g):eval("("+g+")")},parseDate:function(g,f,e,d){var k=/^\/Date\((([-+])?[0-9]+)(([-+])([0-9]{2})([0-9]{2}))?\)\/$/,a="string"===
        typeof f?f.match(k):null,k=function(a,b){a=String(a);for(b=parseInt(b,10)||2;a.length<b;)a="0"+a;return a},c={m:1,d:1,y:1970,h:0,i:0,s:0,u:0},h=0,l,n,h=function(a,b){0===a?12===b&&(b=0):12!==b&&(b+=12);return b},m=0;void 0===d&&(d=b.jgrid.formatter.date);void 0===d.parseRe&&(d.parseRe=/[#%\\\/:_;.,\t\s-]/);d.masks.hasOwnProperty(g)&&(g=d.masks[g]);if(f&&null!=f)if(isNaN(f-0)||"u"!==String(g).toLowerCase())if(f.constructor===Date)h=f;else if(null!==a)h=new Date(parseInt(a[1],10)),a[3]&&(m=60*Number(a[5])+
            Number(a[6]),m*="-"===a[4]?1:-1,m-=h.getTimezoneOffset(),h.setTime(Number(Number(h)+6E4*m)));else{"ISO8601Long"===d.srcformat&&"Z"===f.charAt(f.length-1)&&(m-=(new Date).getTimezoneOffset());f=String(f).replace(/\T/g,"#").replace(/\t/,"%").split(d.parseRe);g=g.replace(/\T/g,"#").replace(/\t/,"%").split(d.parseRe);l=0;for(n=g.length;l<n;l++)"M"===g[l]&&(a=b.inArray(f[l],d.monthNames),-1!==a&&12>a&&(f[l]=a+1,c.m=f[l])),"F"===g[l]&&(a=b.inArray(f[l],d.monthNames,12),-1!==a&&11<a&&(f[l]=a+1-12,c.m=f[l])),
        "a"===g[l]&&(a=b.inArray(f[l],d.AmPm),-1!==a&&2>a&&f[l]===d.AmPm[a]&&(f[l]=a,c.h=h(f[l],c.h))),"A"===g[l]&&(a=b.inArray(f[l],d.AmPm),-1!==a&&1<a&&f[l]===d.AmPm[a]&&(f[l]=a-2,c.h=h(f[l],c.h))),"g"===g[l]&&(c.h=parseInt(f[l],10)),void 0!==f[l]&&(c[g[l].toLowerCase()]=parseInt(f[l],10));c.f&&(c.m=c.f);if(0===c.m&&0===c.y&&0===c.d)return"&#160;";c.m=parseInt(c.m,10)-1;h=c.y;70<=h&&99>=h?c.y=1900+c.y:0<=h&&69>=h&&(c.y=2E3+c.y);h=new Date(c.y,c.m,c.d,c.h,c.i,c.s,c.u);0<m&&h.setTime(Number(Number(h)+6E4*
            m))}else h=new Date(1E3*parseFloat(f));else h=new Date(c.y,c.m,c.d,c.h,c.i,c.s,c.u);d.userLocalTime&&0===m&&(m-=(new Date).getTimezoneOffset(),0<m&&h.setTime(Number(Number(h)+6E4*m)));if(void 0===e)return h;d.masks.hasOwnProperty(e)?e=d.masks[e]:e||(e="Y-m-d");g=h.getHours();f=h.getMinutes();c=h.getDate();m=h.getMonth()+1;a=h.getTimezoneOffset();l=h.getSeconds();n=h.getMilliseconds();var q=h.getDay(),p=h.getFullYear(),r=(q+6)%7+1,B=(new Date(p,m-1,c)-new Date(p,0,1))/864E5,F={d:k(c),D:d.dayNames[q],
            j:c,l:d.dayNames[q+7],N:r,S:d.S(c),w:q,z:B,W:5>r?Math.floor((B+r-1)/7)+1:Math.floor((B+r-1)/7)||(4>((new Date(p-1,0,1)).getDay()+6)%7?53:52),F:d.monthNames[m-1+12],m:k(m),M:d.monthNames[m-1],n:m,t:"?",L:"?",o:"?",Y:p,y:String(p).substring(2),a:12>g?d.AmPm[0]:d.AmPm[1],A:12>g?d.AmPm[2]:d.AmPm[3],B:"?",g:g%12||12,G:g,h:k(g%12||12),H:k(g),i:k(f),s:k(l),u:n,e:"?",I:"?",O:(0<a?"-":"+")+k(100*Math.floor(Math.abs(a)/60)+Math.abs(a)%60,4),P:"?",T:(String(h).match(/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g)||
                [""]).pop().replace(/[^-+\dA-Z]/g,""),Z:"?",c:"?",r:"?",U:Math.floor(h/1E3)};return e.replace(/\\.|[dDjlNSwzWFmMntLoYyaABgGhHisueIOPTZcrU]/g,function(a){return F.hasOwnProperty(a)?F[a]:a.substring(1)})},jqID:function(b){return String(b).replace(/[!"#$%&'()*+,.\/:; <=>?@\[\\\]\^`{|}~]/g,"\\$&")},guid:1,uidPref:"jqg",randId:function(g){return(g||b.jgrid.uidPref)+b.jgrid.guid++},getAccessor:function(b,f){var e,d,k=[],a;if("function"===typeof f)return f(b);e=b[f];if(void 0===e)try{if("string"===typeof f&&
        (k=f.split(".")),a=k.length)for(e=b;e&&a--;)d=k.shift(),e=e[d]}catch(c){}return e},getXmlData:function(g,f,e){var d="string"===typeof f?f.match(/^(.*)\[(\w+)\]$/):null;if("function"===typeof f)return f(g);if(d&&d[2])return d[1]?b(d[1],g).attr(d[2]):b(g).attr(d[2]);g=b(f,g);return e?g:0<g.length?b(g).text():void 0},cellWidth:function(){var g=b("<div class='ui-jqgrid' style='left:10000px'><table class='ui-jqgrid-btable' style='width:5px;'><tr class='jqgrow'><td style='width:5px;display:block;'></td></tr></table></div>"),
            f=g.appendTo("body").find("td").width();g.remove();return.1<Math.abs(f-5)},cell_width:!0,ajaxOptions:{},from:function(g){return new function(g,e){"string"===typeof g&&(g=b.data(g));var d=this,k=g,a=!0,c=!1,h=e,l=/[\$,%]/g,n=null,m=null,q=0,p=!1,r="",B=[],F=!0;if("object"===typeof g&&g.push)0<g.length&&(F="object"!==typeof g[0]?!1:!0);else throw"data provides is not an array";this._hasData=function(){return null===k?!1:0===k.length?!1:!0};this._getStr=function(b){var d=[];c&&d.push("jQuery.trim(");
            d.push("String("+b+")");c&&d.push(")");a||d.push(".toLowerCase()");return d.join("")};this._strComp=function(a){return"string"===typeof a?".toString()":""};this._group=function(a,b){return{field:a.toString(),unique:b,items:[]}};this._toStr=function(d){c&&(d=b.trim(d));d=d.toString().replace(/\\/g,"\\\\").replace(/\"/g,'\\"');return a?d:d.toLowerCase()};this._funcLoop=function(a){var d=[];b.each(k,function(b,c){d.push(a(c))});return d};this._append=function(a){var b;h=null===h?"":h+(""===r?" && ":
            r);for(b=0;b<q;b++)h+="(";p&&(h+="!");h+="("+a+")";p=!1;r="";q=0};this._setCommand=function(a,b){n=a;m=b};this._resetNegate=function(){p=!1};this._repeatCommand=function(a,b){return null===n?d:null!==a&&null!==b?n(a,b):null!==m&&F?n(m,a):n(a)};this._equals=function(a,b){return 0===d._compare(a,b,1)};this._compare=function(b,d,c){var g=Object.prototype.toString;void 0===c&&(c=1);void 0===b&&(b=null);void 0===d&&(d=null);if(null===b&&null===d)return 0;if(null===b&&null!==d)return 1;if(null!==b&&null===
            d)return-1;if("[object Date]"===g.call(b)&&"[object Date]"===g.call(d))return b<d?-c:b>d?c:0;a||"number"===typeof b||"number"===typeof d||(b=String(b),d=String(d));return b<d?-c:b>d?c:0};this._performSort=function(){0!==B.length&&(k=d._doSort(k,0))};this._doSort=function(a,b){var c=B[b].by,g=B[b].dir,e=B[b].type,f=B[b].datefmt,h=B[b].sfunc;if(b===B.length-1)return d._getOrder(a,c,g,e,f,h);b++;c=d._getGroup(a,c,g,e,f);g=[];for(e=0;e<c.length;e++)for(h=d._doSort(c[e].items,b),f=0;f<h.length;f++)g.push(h[f]);
            return g};this._getOrder=function(c,g,e,f,h,k){var m=[],n=[],q="a"===e?1:-1,p,B;void 0===f&&(f="text");B="float"===f||"number"===f||"currency"===f||"numeric"===f?function(a){a=parseFloat(String(a).replace(l,""));return isNaN(a)?Number.NEGATIVE_INFINITY:a}:"int"===f||"integer"===f?function(a){return a?parseFloat(String(a).replace(l,"")):Number.NEGATIVE_INFINITY}:"date"===f||"datetime"===f?function(a){return b.jgrid.parseDate(h,a).getTime()}:b.isFunction(f)?f:function(d){d=d?b.trim(String(d)):"";return a?
            d:d.toLowerCase()};b.each(c,function(a,d){p=""!==g?b.jgrid.getAccessor(d,g):d;void 0===p&&(p="");p=B(p,d);n.push({vSort:p,index:a})});b.isFunction(k)?n.sort(function(a,b){a=a.vSort;b=b.vSort;return k.call(this,a,b,q)}):n.sort(function(a,b){a=a.vSort;b=b.vSort;return d._compare(a,b,q)});f=0;for(var r=c.length;f<r;)e=n[f].index,m.push(c[e]),f++;return m};this._getGroup=function(a,c,g,f,e){var h=[],k=null,l=null,m;b.each(d._getOrder(a,c,g,f,e),function(a,g){m=b.jgrid.getAccessor(g,c);null==m&&(m="");
            d._equals(l,m)||(l=m,null!==k&&h.push(k),k=d._group(c,m));k.items.push(g)});null!==k&&h.push(k);return h};this.ignoreCase=function(){a=!1;return d};this.useCase=function(){a=!0;return d};this.trim=function(){c=!0;return d};this.noTrim=function(){c=!1;return d};this.execute=function(){var a=h,c=[];if(null===a)return d;b.each(k,function(){eval(a)&&c.push(this)});k=c;return d};this.data=function(){return k};this.select=function(a){d._performSort();if(!d._hasData())return[];d.execute();if(b.isFunction(a)){var c=
            [];b.each(k,function(b,d){c.push(a(d))});return c}return k};this.hasMatch=function(){if(!d._hasData())return!1;d.execute();return 0<k.length};this.andNot=function(a,b,c){p=!p;return d.and(a,b,c)};this.orNot=function(a,b,c){p=!p;return d.or(a,b,c)};this.not=function(a,b,c){return d.andNot(a,b,c)};this.and=function(a,b,c){r=" && ";return void 0===a?d:d._repeatCommand(a,b,c)};this.or=function(a,b,c){r=" || ";return void 0===a?d:d._repeatCommand(a,b,c)};this.orBegin=function(){q++;return d};this.orEnd=
            function(){null!==h&&(h+=")");return d};this.isNot=function(a){p=!p;return d.is(a)};this.is=function(a){d._append("this."+a);d._resetNegate();return d};this._compareValues=function(a,c,g,f,e){var h;h=F?"jQuery.jgrid.getAccessor(this,'"+c+"')":"this";void 0===g&&(g=null);var k=g,m=void 0===e.stype?"text":e.stype;if(null!==g)switch(m){case "int":case "integer":k=isNaN(Number(k))||""===k?"0":k;h="parseInt("+h+",10)";k="parseInt("+k+",10)";break;case "float":case "number":case "numeric":k=String(k).replace(l,
            "");k=isNaN(Number(k))||""===k?"0":k;h="parseFloat("+h+")";k="parseFloat("+k+")";break;case "date":case "datetime":k=String(b.jgrid.parseDate(e.newfmt||"Y-m-d",k).getTime());h='jQuery.jgrid.parseDate("'+e.srcfmt+'",'+h+").getTime()";break;default:h=d._getStr(h),k=d._getStr('"'+d._toStr(k)+'"')}d._append(h+" "+f+" "+k);d._setCommand(a,c);d._resetNegate();return d};this.equals=function(a,b,c){return d._compareValues(d.equals,a,b,"==",c)};this.notEquals=function(a,b,c){return d._compareValues(d.equals,
            a,b,"!==",c)};this.isNull=function(a,b,c){return d._compareValues(d.equals,a,null,"===",c)};this.greater=function(a,b,c){return d._compareValues(d.greater,a,b,">",c)};this.less=function(a,b,c){return d._compareValues(d.less,a,b,"<",c)};this.greaterOrEquals=function(a,b,c){return d._compareValues(d.greaterOrEquals,a,b,">=",c)};this.lessOrEquals=function(a,b,c){return d._compareValues(d.lessOrEquals,a,b,"<=",c)};this.startsWith=function(a,g){var e=null==g?a:g,e=c?b.trim(e.toString()).length:e.toString().length;
            F?d._append(d._getStr("jQuery.jgrid.getAccessor(this,'"+a+"')")+".substr(0,"+e+") == "+d._getStr('"'+d._toStr(g)+'"')):(null!=g&&(e=c?b.trim(g.toString()).length:g.toString().length),d._append(d._getStr("this")+".substr(0,"+e+") == "+d._getStr('"'+d._toStr(a)+'"')));d._setCommand(d.startsWith,a);d._resetNegate();return d};this.endsWith=function(a,g){var e=null==g?a:g,e=c?b.trim(e.toString()).length:e.toString().length;F?d._append(d._getStr("jQuery.jgrid.getAccessor(this,'"+a+"')")+".substr("+d._getStr("jQuery.jgrid.getAccessor(this,'"+
            a+"')")+".length-"+e+","+e+') == "'+d._toStr(g)+'"'):d._append(d._getStr("this")+".substr("+d._getStr("this")+'.length-"'+d._toStr(a)+'".length,"'+d._toStr(a)+'".length) == "'+d._toStr(a)+'"');d._setCommand(d.endsWith,a);d._resetNegate();return d};this.contains=function(a,b){F?d._append(d._getStr("jQuery.jgrid.getAccessor(this,'"+a+"')")+'.indexOf("'+d._toStr(b)+'",0) > -1'):d._append(d._getStr("this")+'.indexOf("'+d._toStr(a)+'",0) > -1');d._setCommand(d.contains,a);d._resetNegate();return d};this.groupBy=
            function(a,b,c,g){return d._hasData()?d._getGroup(k,a,b,c,g):null};this.orderBy=function(a,c,g,e,f){c=null==c?"a":b.trim(c.toString().toLowerCase());null==g&&(g="text");null==e&&(e="Y-m-d");null==f&&(f=!1);if("desc"===c||"descending"===c)c="d";if("asc"===c||"ascending"===c)c="a";B.push({by:a,dir:c,type:g,datefmt:e,sfunc:f});return d};return d}(g,null)},getMethod:function(g){return this.getAccessor(b.fn.jqGrid,g)},extend:function(g){b.extend(b.fn.jqGrid,g);this.no_legacy_api||b.fn.extend(g)}});b.fn.jqGrid=
        function(g){if("string"===typeof g){var f=b.jgrid.getMethod(g);if(!f)throw"jqGrid - No such method: "+g;var e=b.makeArray(arguments).slice(1);return f.apply(this,e)}return this.each(function(){if(!this.grid){var d;null!=g&&void 0!==g.data&&(d=g.data,g.data=[]);var e=b.extend(!0,{url:"",height:150,page:1,rowNum:20,rowTotal:null,records:0,pager:"",pgbuttons:!0,pginput:!0,colModel:[],rowList:[],colNames:[],sortorder:"asc",sortname:"",datatype:"xml",mtype:"GET",altRows:!1,selarrrow:[],savedRow:[],shrinkToFit:!0,
            xmlReader:{},jsonReader:{},subGrid:!1,subGridModel:[],reccount:0,lastpage:0,lastsort:0,selrow:null,beforeSelectRow:null,onSelectRow:null,onSortCol:null,ondblClickRow:null,onRightClickRow:null,onPaging:null,onSelectAll:null,onInitGrid:null,loadComplete:null,gridComplete:null,loadError:null,loadBeforeSend:null,afterInsertRow:null,beforeRequest:null,beforeProcessing:null,onHeaderClick:null,viewrecords:!1,loadonce:!1,multiselect:!1,multikey:!1,editurl:null,search:!1,caption:"",hidegrid:!0,hiddengrid:!1,
            postData:{},userData:{},treeGrid:!1,treeGridModel:"nested",treeReader:{},treeANode:-1,ExpandColumn:null,tree_root_level:0,prmNames:{page:"page",rows:"rows",sort:"sidx",order:"sord",search:"_search",nd:"nd",id:"id",oper:"oper",editoper:"edit",addoper:"add",deloper:"del",subgridid:"id",npage:null,totalrows:"totalrows"},forceFit:!1,gridstate:"visible",cellEdit:!1,cellsubmit:"remote",nv:0,loadui:"enable",toolbar:[!1,""],scroll:!1,multiboxonly:!1,deselectAfterSort:!0,scrollrows:!1,autowidth:!1,scrollOffset:18,
            cellLayout:5,subGridWidth:20,multiselectWidth:20,gridview:!1,rownumWidth:25,rownumbers:!1,pagerpos:"center",recordpos:"right",footerrow:!1,userDataOnFooter:!1,hoverrows:!0,altclass:"ui-priority-secondary",viewsortcols:[!1,"vertical",!0],resizeclass:"",autoencode:!1,remapColumns:[],ajaxGridOptions:{},direction:"ltr",toppager:!1,headertitles:!1,scrollTimeout:40,data:[],_index:{},grouping:!1,groupingView:{groupField:[],groupOrder:[],groupText:[],groupColumnShow:[],groupSummary:[],showSummaryOnHide:!1,
                sortitems:[],sortnames:[],summary:[],summaryval:[],plusicon:"ui-icon-circlesmall-plus",minusicon:"ui-icon-circlesmall-minus",displayField:[],groupSummaryPos:[],formatDisplayField:[],_locgr:!1},ignoreCase:!1,cmTemplate:{},idPrefix:"",multiSort:!1,minColWidth:33},b.jgrid.defaults,g||{});void 0!==d&&(e.data=d,g.data=d);var a=this,c={headers:[],cols:[],footers:[],dragStart:function(c,d,f){var g=b(this.bDiv).offset().left;this.resizing={idx:c,startX:d.pageX,sOL:d.pageX-g};this.hDiv.style.cursor="col-resize";
                this.curGbox=b("#rs_m"+b.jgrid.jqID(e.id),"#gbox_"+b.jgrid.jqID(e.id));this.curGbox.css({display:"block",left:d.pageX-g,top:f[1],height:f[2]});b(a).triggerHandler("jqGridResizeStart",[d,c]);b.isFunction(e.resizeStart)&&e.resizeStart.call(a,d,c);document.onselectstart=function(){return!1}},dragMove:function(a){if(this.resizing){var b=a.pageX-this.resizing.startX;a=this.headers[this.resizing.idx];var c="ltr"===e.direction?a.width+b:a.width-b,d;33<c&&(this.curGbox.css({left:this.resizing.sOL+b}),!0===
            e.forceFit?(d=this.headers[this.resizing.idx+e.nv],b="ltr"===e.direction?d.width-b:d.width+b,b>e.minColWidth&&(a.newWidth=c,d.newWidth=b)):(this.newWidth="ltr"===e.direction?e.tblwidth+b:e.tblwidth-b,a.newWidth=c))}},dragEnd:function(){this.hDiv.style.cursor="default";if(this.resizing){var c=this.resizing.idx,d=this.headers[c].newWidth||this.headers[c].width,d=parseInt(d,10);this.resizing=!1;b("#rs_m"+b.jgrid.jqID(e.id)).css("display","none");e.colModel[c].width=d;this.headers[c].width=d;this.headers[c].el.style.width=
                d+"px";this.cols[c].style.width=d+"px";0<this.footers.length&&(this.footers[c].style.width=d+"px");!0===e.forceFit?(d=this.headers[c+e.nv].newWidth||this.headers[c+e.nv].width,this.headers[c+e.nv].width=d,this.headers[c+e.nv].el.style.width=d+"px",this.cols[c+e.nv].style.width=d+"px",0<this.footers.length&&(this.footers[c+e.nv].style.width=d+"px"),e.colModel[c+e.nv].width=d):(e.tblwidth=this.newWidth||e.tblwidth,b("table:first",this.bDiv).css("width",e.tblwidth+"px"),b("table:first",this.hDiv).css("width",
                e.tblwidth+"px"),this.hDiv.scrollLeft=this.bDiv.scrollLeft,e.footerrow&&(b("table:first",this.sDiv).css("width",e.tblwidth+"px"),this.sDiv.scrollLeft=this.bDiv.scrollLeft));b(a).triggerHandler("jqGridResizeStop",[d,c]);b.isFunction(e.resizeStop)&&e.resizeStop.call(a,d,c)}this.curGbox=null;document.onselectstart=function(){return!0}},populateVisible:function(){c.timer&&clearTimeout(c.timer);c.timer=null;var a=b(c.bDiv).height();if(a){var d=b("table:first",c.bDiv),f,g;if(d[0].rows.length)try{g=(f=d[0].rows[1])?
                b(f).outerHeight()||c.prevRowHeight:c.prevRowHeight}catch(na){g=c.prevRowHeight}if(g){c.prevRowHeight=g;var h=e.rowNum;f=c.scrollTop=c.bDiv.scrollTop;var l=Math.round(d.position().top)-f,m=l+d.height();g*=h;var W,n,D;m<a&&0>=l&&(void 0===e.lastpage||(parseInt((m+f+g-1)/g,10)||0)<=e.lastpage)&&(n=parseInt((a-m+g-1)/g,10)||1,0<=m||2>n||!0===e.scroll?(W=(Math.round((m+f)/g)||0)+1,l=-1):l=1);0<l&&(W=(parseInt(f/g,10)||0)+1,n=(parseInt((f+a)/g,10)||0)+2-W,D=!0);!n||e.lastpage&&(W>e.lastpage||1===e.lastpage||
                W===e.page&&W===e.lastpage)||(c.hDiv.loading?c.timer=setTimeout(c.populateVisible,e.scrollTimeout):(e.page=W,D&&(c.selectionPreserver(d[0]),c.emptyRows.call(d[0],!1,!1)),c.populate(n)))}}},scrollGrid:function(a){if(e.scroll){var b=c.bDiv.scrollTop;void 0===c.scrollTop&&(c.scrollTop=0);b!==c.scrollTop&&(c.scrollTop=b,c.timer&&clearTimeout(c.timer),c.timer=setTimeout(c.populateVisible,e.scrollTimeout))}c.hDiv.scrollLeft=c.bDiv.scrollLeft;e.footerrow&&(c.sDiv.scrollLeft=c.bDiv.scrollLeft);a&&a.stopPropagation()},
            selectionPreserver:function(a){var c=a.p,d=c.selrow,f=c.selarrrow?b.makeArray(c.selarrrow):null,e=a.grid.bDiv.scrollLeft,g=function(){var h;c.selrow=null;c.selarrrow=[];if(c.multiselect&&f&&0<f.length)for(h=0;h<f.length;h++)f[h]!==d&&b(a).jqGrid("setSelection",f[h],!1,null);d&&b(a).jqGrid("setSelection",d,!1,null);a.grid.bDiv.scrollLeft=e;b(a).unbind(".selectionPreserver",g)};b(a).bind("jqGridGridComplete.selectionPreserver",g)}};if("TABLE"!==this.tagName.toUpperCase()||null==this.id)alert("Element is not a table or has no id!");
        else if(void 0!==document.documentMode&&5>=document.documentMode)alert("Grid can not be used in this ('quirks') mode!");else{b(this).empty().attr("tabindex","0");this.p=e;this.p.useProp=!!b.fn.prop;var f,l;if(0===this.p.colNames.length)for(f=0;f<this.p.colModel.length;f++)this.p.colNames[f]=this.p.colModel[f].label||this.p.colModel[f].name;if(this.p.colNames.length!==this.p.colModel.length)alert(b.jgrid.errors.model);else{var n=b("<div class='ui-jqgrid-view' role='grid'></div>");d=b.jgrid.msie;a.p.direction=
            b.trim(a.p.direction.toLowerCase());-1===b.inArray(a.p.direction,["ltr","rtl"])&&(a.p.direction="ltr");l=a.p.direction;b(n).insertBefore(this);b(this).removeClass("scroll").appendTo(n);var m=b("<div class='ui-jqgrid ui-widget ui-widget-content ui-corner-all'></div>");b(m).attr({id:"gbox_"+this.id,dir:l}).insertBefore(n);b(n).attr("id","gview_"+this.id).appendTo(m);b("<div class='ui-widget-overlay jqgrid-overlay' id='lui_"+this.id+"'></div>").insertBefore(n);b("<div class='loading ui-state-default ui-state-active' id='load_"+
            this.id+"'>"+this.p.loadtext+"</div>").insertBefore(n);b(this).attr({cellspacing:"0",cellpadding:"0",border:"0",role:"presentation","aria-multiselectable":!!this.p.multiselect,"aria-labelledby":"gbox_"+this.id});var q=function(a,b){a=parseInt(a,10);return isNaN(a)?b||0:a},p=function(d,f,e,g,na,h){var k=a.p.colModel[d],l=k.align,m='style="',n=k.classes,D=k.name,w=[];l&&(m+="text-align:"+l+";");!0===k.hidden&&(m+="display:none;");if(0===f)m+="width: "+c.headers[d].width+"px;";else if(b.isFunction(k.cellattr)||
            "string"===typeof k.cellattr&&null!=b.jgrid.cellattr&&b.isFunction(b.jgrid.cellattr[k.cellattr]))if(d=b.isFunction(k.cellattr)?k.cellattr:b.jgrid.cellattr[k.cellattr],(g=d.call(a,na,e,g,k,h))&&"string"===typeof g)if(g=g.replace(/style/i,"style").replace(/title/i,"title"),-1<g.indexOf("title")&&(k.title=!1),-1<g.indexOf("class")&&(n=void 0),w=g.replace(/\-style/g,"-sti").split(/style/),2===w.length){w[1]=b.trim(w[1].replace(/\-sti/g,"-style").replace("=",""));if(0===w[1].indexOf("'")||0===w[1].indexOf('"'))w[1]=
            w[1].substring(1);m+=w[1].replace(/'/gi,'"')}else m+='"';w.length||(w[0]="",m+='"');m+=(void 0!==n?' class="'+n+'"':"")+(k.title&&e?' title="'+b.jgrid.stripHtml(e)+'"':"");m+=' aria-describedby="'+a.p.id+"_"+D+'"';return m+w[0]},r=function(c){return null==c||""===c?"&#160;":a.p.autoencode?b.jgrid.htmlEncode(c):String(c)},B=function(c,d,f,e,g){var h=a.p.colModel[f];void 0!==h.formatter?(c=""!==String(a.p.idPrefix)?b.jgrid.stripPref(a.p.idPrefix,c):c,c={rowId:c,colModel:h,gid:a.p.id,pos:f},d=b.isFunction(h.formatter)?
            h.formatter.call(a,d,c,e,g):b.fmatter?b.fn.fmatter.call(a,h.formatter,d,c,e,g):r(d)):d=r(d);return d},F=function(a,b,c,d,f,e){b=B(a,b,c,f,"add");return'<td role="gridcell" '+p(c,d,b,f,a,e)+">"+b+"</td>"},T=function(b,c,d,f){f='<input role="checkbox" type="checkbox" id="jqg_'+a.p.id+"_"+b+'" class="cbox" name="jqg_'+a.p.id+"_"+b+'"'+(f?'checked="checked"':"")+"/>";return'<td role="gridcell" '+p(c,d,"",null,b,!0)+">"+f+"</td>"},K=function(a,b,c,d){c=(parseInt(c,10)-1)*parseInt(d,10)+1+b;return'<td role="gridcell" class="ui-state-default jqgrid-rownum" '+
            p(a,b,c,null,b,!0)+">"+c+"</td>"},Z=function(b){var c,d=[],f=0,e;for(e=0;e<a.p.colModel.length;e++)c=a.p.colModel[e],"cb"!==c.name&&"subgrid"!==c.name&&"rn"!==c.name&&(d[f]="local"===b?c.name:"xml"===b||"xmlstring"===b?c.xmlmap||c.name:c.jsonmap||c.name,!1!==a.p.keyName&&!0===c.key&&(a.p.keyName=d[f]),f++);return d},U=function(c){var d=a.p.remapColumns;d&&d.length||(d=b.map(a.p.colModel,function(a,b){return b}));c&&(d=b.map(d,function(a){return a<c?null:a-c}));return d},V=function(a,c){var d;this.p.deepempty?
            b(this.rows).slice(1).remove():(d=0<this.rows.length?this.rows[0]:null,b(this.firstChild).empty().append(d));a&&this.p.scroll&&(b(this.grid.bDiv.firstChild).css({height:"auto"}),b(this.grid.bDiv.firstChild.firstChild).css({height:0,display:"none"}),0!==this.grid.bDiv.scrollTop&&(this.grid.bDiv.scrollTop=0));!0===c&&this.p.treeGrid&&(this.p.data=[],this.p._index={})},S=function(){var c=a.p,d=c.data,f=d.length,e,g,h,k,l,m=c.localReader,n=c.colModel,D=m.cell,w=(!0===c.multiselect?1:0)+(!0===c.subGrid?
            1:0)+(!0===c.rownumbers?1:0),q=c.scroll?b.jgrid.randId():1,p,t,x;if("local"===c.datatype&&!0===m.repeatitems)for(p=U(w),t=Z("local"),h=!1===c.keyIndex?b.isFunction(m.id)?m.id.call(a,d):m.id:c.keyIndex,c=0;c<f;c++){g=d[c];e=b.jgrid.getAccessor(g,h);void 0===e&&("number"===typeof h&&null!=n[h+w]&&(e=b.jgrid.getAccessor(g,n[h+w].name)),void 0===e&&(e=q+c,D&&(k=b.jgrid.getAccessor(g,D)||g,e=null!=k&&void 0!==k[h]?k[h]:e)));k={};k[m.id]=e;D&&(g=b.jgrid.getAccessor(g,D)||g);x=b.isArray(g)?p:t;for(e=0;e<
        x.length;e++)l=b.jgrid.getAccessor(g,x[e]),k[n[e+w].name]=l;b.extend(!0,d[c],k)}},O=function(){var c=a.p.data.length,d,e,f;d=!1===a.p.keyName||!0===a.p.loadonce?a.p.localReader.id:a.p.keyName;a.p._index=[];for(e=0;e<c;e++)f=b.jgrid.getAccessor(a.p.data[e],d),void 0===f&&(f=String(e+1)),a.p._index[f]=e},P=function(c,d,e,f,g,h){var k="-1",l="",m;d=d?"display:none;":"";e="ui-widget-content jqgrow ui-row-"+a.p.direction+(e?" "+e:"")+(h?" ui-state-highlight":"");h=b(a).triggerHandler("jqGridRowAttr",[f,
            g,c]);"object"!==typeof h&&(h=b.isFunction(a.p.rowattr)?a.p.rowattr.call(a,f,g,c):"string"===typeof a.p.rowattr&&null!=b.jgrid.rowattr&&b.isFunction(b.jgrid.rowattr[a.p.rowattr])?b.jgrid.rowattr[a.p.rowattr].call(a,f,g,c):{});if(!b.isEmptyObject(h)){h.hasOwnProperty("id")&&(c=h.id,delete h.id);h.hasOwnProperty("tabindex")&&(k=h.tabindex,delete h.tabindex);h.hasOwnProperty("style")&&(d+=h.style,delete h.style);h.hasOwnProperty("class")&&(e+=" "+h["class"],delete h["class"]);try{delete h.role}catch(n){}for(m in h)h.hasOwnProperty(m)&&
        (l+=" "+m+"="+h[m])}return'<tr role="row" id="'+c+'" tabindex="'+k+'" class="'+e+'"'+(""===d?"":' style="'+d+'"')+l+">"},aa=function(c,d,e,f,g){var h=new Date,k="local"!==a.p.datatype&&a.p.loadonce||"xmlstring"===a.p.datatype,l=a.p.xmlReader,m="local"===a.p.datatype?"local":"xml";k&&(a.p.data=[],a.p._index={},a.p.localReader.id="_id_");a.p.reccount=0;if(b.isXMLDoc(c)){-1!==a.p.treeANode||a.p.scroll?e=1<e?e:1:(V.call(a,!1,!0),e=1);var n=b(a),D,w,p=0,Q,t=!0===a.p.multiselect?1:0,x=0,B,r=!0===a.p.rownumbers?
            1:0,u,E=[],y,v={},A,G,s=[],va=!0===a.p.altRows?a.p.altclass:"",fa;!0===a.p.subGrid&&(x=1,B=b.jgrid.getMethod("addSubGridCell"));l.repeatitems||(E=Z(m));u=!1===a.p.keyName?b.isFunction(l.id)?l.id.call(a,c):l.id:a.p.keyName;m=-1===String(u).indexOf("[")?E.length?function(a,c){return b(u,a).text()||c}:function(a,c){return b(l.cell,a).eq(u).text()||c}:function(a,b){return a.getAttribute(u.replace(/[\[\]]/g,""))||b};a.p.userData={};a.p.page=q(b.jgrid.getXmlData(c,l.page),a.p.page);a.p.lastpage=q(b.jgrid.getXmlData(c,
            l.total),1);a.p.records=q(b.jgrid.getXmlData(c,l.records));b.isFunction(l.userdata)?a.p.userData=l.userdata.call(a,c)||{}:b.jgrid.getXmlData(c,l.userdata,!0).each(function(){a.p.userData[this.getAttribute("name")]=b(this).text()});c=b.jgrid.getXmlData(c,l.root,!0);(c=b.jgrid.getXmlData(c,l.row,!0))||(c=[]);var R=c.length,H=0,C=[],z=parseInt(a.p.rowNum,10),I=a.p.scroll?b.jgrid.randId():1;0<R&&0>=a.p.page&&(a.p.page=1);if(c&&R){g&&(z*=g+1);g=b.isFunction(a.p.afterInsertRow);var ga=!1,J;a.p.grouping&&
        (ga=!0===a.p.groupingView.groupCollapse,J=b.jgrid.getMethod("groupingPrepare"));for(;H<R;){A=c[H];G=m(A,I+H);G=a.p.idPrefix+G;D=0===e?0:e+1;fa=1===(D+H)%2?va:"";var M=s.length;s.push("");r&&s.push(K(0,H,a.p.page,a.p.rowNum));t&&s.push(T(G,r,H,!1));x&&s.push(B.call(n,t+r,H+e));if(l.repeatitems){y||(y=U(t+x+r));var L=b.jgrid.getXmlData(A,l.cell,!0);b.each(y,function(b){var c=L[this];if(!c)return!1;Q=c.textContent||c.text;v[a.p.colModel[b+t+x+r].name]=Q;s.push(F(G,Q,b+t+x+r,H+e,A,v))})}else for(D=0;D<
        E.length;D++)Q=b.jgrid.getXmlData(A,E[D]),v[a.p.colModel[D+t+x+r].name]=Q,s.push(F(G,Q,D+t+x+r,H+e,A,v));s[M]=P(G,ga,fa,v,A,!1);s.push("</tr>");a.p.grouping&&(C.push(s),a.p.groupingView._locgr||J.call(n,v,H),s=[]);if(k||!0===a.p.treeGrid)v._id_=b.jgrid.stripPref(a.p.idPrefix,G),a.p.data.push(v),a.p._index[v._id_]=a.p.data.length-1;!1===a.p.gridview&&(b("tbody:first",d).append(s.join("")),n.triggerHandler("jqGridAfterInsertRow",[G,v,A]),g&&a.p.afterInsertRow.call(a,G,v,A),s=[]);v={};p++;H++;if(p===
            z)break}}!0===a.p.gridview&&(w=-1<a.p.treeANode?a.p.treeANode:0,a.p.grouping?k||(n.jqGrid("groupingRender",C,a.p.colModel.length,a.p.page,z),C=null):!0===a.p.treeGrid&&0<w?b(a.rows[w]).after(s.join("")):(a.firstElementChild.innerHTML+=s.join(""),a.grid.cols=a.rows[0].cells));if(!0===a.p.subGrid)try{n.jqGrid("addSubGrid",t+r)}catch(N){}a.p.totaltime=new Date-h;0<p&&0===a.p.records&&(a.p.records=R);s=null;if(!0===a.p.treeGrid)try{n.jqGrid("setTreeNode",w+1,p+w+1)}catch(S){}a.p.reccount=p;a.p.treeANode=
            -1;a.p.userDataOnFooter&&n.jqGrid("footerData","set",a.p.userData,!0);k&&(a.p.records=R,a.p.lastpage=Math.ceil(R/z));f||a.updatepager(!1,!0);if(k){for(;p<R;){A=c[p];G=m(A,p+I);G=a.p.idPrefix+G;if(l.repeatitems){y||(y=U(t+x+r));var O=b.jgrid.getXmlData(A,l.cell,!0);b.each(y,function(b){var c=O[this];if(!c)return!1;Q=c.textContent||c.text;v[a.p.colModel[b+t+x+r].name]=Q})}else for(D=0;D<E.length;D++)Q=b.jgrid.getXmlData(A,E[D]),v[a.p.colModel[D+t+x+r].name]=Q;v._id_=b.jgrid.stripPref(a.p.idPrefix,G);
            a.p.grouping&&J.call(n,v,p);a.p.data.push(v);a.p._index[v._id_]=a.p.data.length-1;v={};p++}a.p.grouping&&(a.p.groupingView._locgr=!0,n.jqGrid("groupingRender",C,a.p.colModel.length,a.p.page,z),C=null)}}},ba=function(c,d,e,f,g){var h=new Date;if(c){-1!==a.p.treeANode||a.p.scroll?e=1<e?e:1:(V.call(a,!1,!0),e=1);var k,l="local"!==a.p.datatype&&a.p.loadonce||"jsonstring"===a.p.datatype;l&&(a.p.data=[],a.p._index={},a.p.localReader.id="_id_");a.p.reccount=0;"local"===a.p.datatype?(d=a.p.localReader,k=
            "local"):(d=a.p.jsonReader,k="json");var m=b(a),n=0,D,w,p,r=[],t=a.p.multiselect?1:0,x=!0===a.p.subGrid?1:0,B,u=!0===a.p.rownumbers?1:0,E=U(t+x+u);k=Z(k);var y,C,v,A={},G,s,z=[],fa=!0===a.p.altRows?a.p.altclass:"",R;a.p.page=q(b.jgrid.getAccessor(c,d.page),a.p.page);a.p.lastpage=q(b.jgrid.getAccessor(c,d.total),1);a.p.records=q(b.jgrid.getAccessor(c,d.records));a.p.userData=b.jgrid.getAccessor(c,d.userdata)||{};x&&(B=b.jgrid.getMethod("addSubGridCell"));v=!1===a.p.keyName?b.isFunction(d.id)?d.id.call(a,
            c):d.id:a.p.keyName;C=b.jgrid.getAccessor(c,d.root);null==C&&b.isArray(c)&&(C=c);C||(C=[]);c=C.length;w=0;0<c&&0>=a.p.page&&(a.p.page=1);var H=parseInt(a.p.rowNum,10),I=a.p.scroll?b.jgrid.randId():1,J=!1,M;g&&(H*=g+1);"local"!==a.p.datatype||a.p.deselectAfterSort||(J=!0);var ga=b.isFunction(a.p.afterInsertRow),L=[],O=!1,N;a.p.grouping&&(O=!0===a.p.groupingView.groupCollapse,N=b.jgrid.getMethod("groupingPrepare"));for(;w<c;){g=C[w];s=b.jgrid.getAccessor(g,v);void 0===s&&("number"===typeof v&&null!=
        a.p.colModel[v+t+x+u]&&(s=b.jgrid.getAccessor(g,a.p.colModel[v+t+x+u].name)),void 0===s&&(s=I+w,0===r.length&&d.cell&&(D=b.jgrid.getAccessor(g,d.cell)||g,s=null!=D&&void 0!==D[v]?D[v]:s)));s=a.p.idPrefix+s;D=1===e?0:e;R=1===(D+w)%2?fa:"";J&&(M=a.p.multiselect?-1!==b.inArray(s,a.p.selarrrow):s===a.p.selrow);var S=z.length;z.push("");u&&z.push(K(0,w,a.p.page,a.p.rowNum));t&&z.push(T(s,u,w,M));x&&z.push(B.call(m,t+u,w+e));y=k;d.repeatitems&&(d.cell&&(g=b.jgrid.getAccessor(g,d.cell)||g),b.isArray(g)&&
        (y=E));for(p=0;p<y.length;p++)D=b.jgrid.getAccessor(g,y[p]),A[a.p.colModel[p+t+x+u].name]=D,z.push(F(s,D,p+t+x+u,w+e,g,A));z[S]=P(s,O,R,A,g,M);z.push("</tr>");a.p.grouping&&(L.push(z),a.p.groupingView._locgr||N.call(m,A,w),z=[]);if(l||!0===a.p.treeGrid)A._id_=b.jgrid.stripPref(a.p.idPrefix,s),a.p.data.push(A),a.p._index[A._id_]=a.p.data.length-1;!1===a.p.gridview&&(b("#"+b.jgrid.jqID(a.p.id)+" tbody:first").append(z.join("")),m.triggerHandler("jqGridAfterInsertRow",[s,A,g]),ga&&a.p.afterInsertRow.call(a,
            s,A,g),z=[]);A={};n++;w++;if(n===H)break}!0===a.p.gridview&&(G=-1<a.p.treeANode?a.p.treeANode:0,a.p.grouping?l||(m.jqGrid("groupingRender",L,a.p.colModel.length,a.p.page,H),L=null):!0===a.p.treeGrid&&0<G?b(a.rows[G]).after(z.join("")):(a.firstElementChild.innerHTML+=z.join(""),a.grid.cols=a.rows[0].cells));if(!0===a.p.subGrid)try{m.jqGrid("addSubGrid",t+u)}catch(X){}a.p.totaltime=new Date-h;0<n&&0===a.p.records&&(a.p.records=c);if(!0===a.p.treeGrid)try{m.jqGrid("setTreeNode",G+1,n+G+1)}catch(Y){}a.p.reccount=
            n;a.p.treeANode=-1;a.p.userDataOnFooter&&m.jqGrid("footerData","set",a.p.userData,!0);l&&(a.p.records=c,a.p.lastpage=Math.ceil(c/H));f||a.updatepager(!1,!0);if(l){for(;n<c&&C[n];){g=C[n];s=b.jgrid.getAccessor(g,v);void 0===s&&("number"===typeof v&&null!=a.p.colModel[v+t+x+u]&&(s=b.jgrid.getAccessor(g,a.p.colModel[v+t+x+u].name)),void 0===s&&(s=I+n,0===r.length&&d.cell&&(e=b.jgrid.getAccessor(g,d.cell)||g,s=null!=e&&void 0!==e[v]?e[v]:s)));if(g){s=a.p.idPrefix+s;y=k;d.repeatitems&&(d.cell&&(g=b.jgrid.getAccessor(g,
            d.cell)||g),b.isArray(g)&&(y=E));for(p=0;p<y.length;p++)A[a.p.colModel[p+t+x+u].name]=b.jgrid.getAccessor(g,y[p]);A._id_=b.jgrid.stripPref(a.p.idPrefix,s);a.p.grouping&&N.call(m,A,n);a.p.data.push(A);a.p._index[A._id_]=a.p.data.length-1;A={}}n++}a.p.grouping&&(a.p.groupingView._locgr=!0,m.jqGrid("groupingRender",L,a.p.colModel.length,a.p.page,H))}}},ua=function(){function c(a){var b=0,d,e,g,h,k;if(null!=a.groups){(e=a.groups.length&&"OR"===a.groupOp.toString().toUpperCase())&&t.orBegin();for(d=0;d<
        a.groups.length;d++){0<b&&e&&t.or();try{c(a.groups[d])}catch(l){alert(l)}b++}e&&t.orEnd()}if(null!=a.rules)try{(g=a.rules.length&&"OR"===a.groupOp.toString().toUpperCase())&&t.orBegin();for(d=0;d<a.rules.length;d++)k=a.rules[d],h=a.groupOp.toString().toUpperCase(),r[k.op]&&k.field&&(0<b&&h&&"OR"===h&&(t=t.or()),t=r[k.op](t,h)(k.field,k.data,f[k.field])),b++;g&&t.orEnd()}catch(m){alert(m)}}var d=a.p.multiSort?[]:"",e=[],g=!1,f={},h=[],k=[],l,m,n;if(b.isArray(a.p.data)){var p=a.p.grouping?a.p.groupingView:
            !1,w,q;b.each(a.p.colModel,function(){m=this.sorttype||"text";"date"===m||"datetime"===m?(this.formatter&&"string"===typeof this.formatter&&"date"===this.formatter?(l=this.formatoptions&&this.formatoptions.srcformat?this.formatoptions.srcformat:b.jgrid.formatter.date.srcformat,n=this.formatoptions&&this.formatoptions.newformat?this.formatoptions.newformat:b.jgrid.formatter.date.newformat):l=n=this.datefmt||"Y-m-d",f[this.name]={stype:m,srcfmt:l,newfmt:n,sfunc:this.sortfunc||null}):f[this.name]={stype:m,
            srcfmt:"",newfmt:"",sfunc:this.sortfunc||null};if(a.p.grouping)for(q=0,w=p.groupField.length;q<w;q++)if(this.name===p.groupField[q]){var c=this.name;this.index&&(c=this.index);h[q]=f[c];k[q]=c}a.p.multiSort?this.lso&&(d.push(this.name),c=this.lso.split("-"),e.push(c[c.length-1])):g||this.index!==a.p.sortname&&this.name!==a.p.sortname||(d=this.name,g=!0)});if(a.p.treeGrid)b(a).jqGrid("SortTree",d,a.p.sortorder,f[d].stype||"text",f[d].srcfmt||"");else{var r={eq:function(a){return a.equals},ne:function(a){return a.notEquals},
            lt:function(a){return a.less},le:function(a){return a.lessOrEquals},gt:function(a){return a.greater},ge:function(a){return a.greaterOrEquals},cn:function(a){return a.contains},nc:function(a,b){return"OR"===b?a.orNot().contains:a.andNot().contains},bw:function(a){return a.startsWith},bn:function(a,b){return"OR"===b?a.orNot().startsWith:a.andNot().startsWith},en:function(a,b){return"OR"===b?a.orNot().endsWith:a.andNot().endsWith},ew:function(a){return a.endsWith},ni:function(a,b){return"OR"===b?a.orNot().equals:
                a.andNot().equals},"in":function(a){return a.equals},nu:function(a){return a.isNull},nn:function(a,b){return"OR"===b?a.orNot().isNull:a.andNot().isNull}},t=b.jgrid.from(a.p.data);a.p.ignoreCase&&(t=t.ignoreCase());if(!0===a.p.search){var x=a.p.postData.filters;if(x)"string"===typeof x&&(x=b.jgrid.parse(x)),c(x);else try{t=r[a.p.postData.searchOper](t)(a.p.postData.searchField,a.p.postData.searchString,f[a.p.postData.searchField])}catch(u){}}if(a.p.grouping)for(q=0;q<w;q++)t.orderBy(k[q],p.groupOrder[q],
            h[q].stype,h[q].srcfmt);a.p.multiSort?b.each(d,function(a){t.orderBy(this,e[a],f[this].stype,f[this].srcfmt,f[this].sfunc)}):d&&a.p.sortorder&&g&&("DESC"===a.p.sortorder.toUpperCase()?t.orderBy(a.p.sortname,"d",f[d].stype,f[d].srcfmt,f[d].sfunc):t.orderBy(a.p.sortname,"a",f[d].stype,f[d].srcfmt,f[d].sfunc));var x=t.select(),B=parseInt(a.p.rowNum,10),y=x.length,z=parseInt(a.p.page,10),C=Math.ceil(y/B),v={};if((a.p.search||a.p.resetsearch)&&a.p.grouping&&a.p.groupingView._locgr){a.p.groupingView.groups=
            [];var A,E=b.jgrid.getMethod("groupingPrepare"),s,F;if(a.p.footerrow&&a.p.userDataOnFooter){for(s in a.p.userData)a.p.userData.hasOwnProperty(s)&&(a.p.userData[s]=0);F=!0}for(A=0;A<y;A++){if(F)for(s in a.p.userData)a.p.userData[s]+=parseFloat(x[A][s]||0);E.call(b(a),x[A],A,B)}}x=x.slice((z-1)*B,z*B);f=t=null;v[a.p.localReader.total]=C;v[a.p.localReader.page]=z;v[a.p.localReader.records]=y;v[a.p.localReader.root]=x;v[a.p.localReader.userdata]=a.p.userData;x=null;return v}}},ca=function(){a.grid.hDiv.loading=
            !0;a.p.hiddengrid||b(a).jqGrid("progressBar",{method:"show",loadtype:a.p.loadui,htmlcontent:a.p.loadtext})},L=function(){a.grid.hDiv.loading=!1;b(a).jqGrid("progressBar",{method:"hide",loadtype:a.p.loadui})},M=function(c){if(!a.grid.hDiv.loading){var d=a.p.scroll&&!1===c,e={},g,f=a.p.prmNames;0>=a.p.page&&(a.p.page=Math.min(1,a.p.lastpage));null!==f.search&&(e[f.search]=a.p.search);null!==f.nd&&(e[f.nd]=(new Date).getTime());null!==f.rows&&(e[f.rows]=a.p.rowNum);null!==f.page&&(e[f.page]=a.p.page);
            null!==f.sort&&(e[f.sort]=a.p.sortname);null!==f.order&&(e[f.order]=a.p.sortorder);null!==a.p.rowTotal&&null!==f.totalrows&&(e[f.totalrows]=a.p.rowTotal);var h=b.isFunction(a.p.loadComplete),k=h?a.p.loadComplete:null,l=0;c=c||1;1<c?null!==f.npage?(e[f.npage]=c,l=c-1,c=1):k=function(b){a.p.page++;a.grid.hDiv.loading=!1;h&&a.p.loadComplete.call(a,b);M(c-1)}:null!==f.npage&&delete a.p.postData[f.npage];if(a.p.grouping){b(a).jqGrid("groupingSetup");var m=a.p.groupingView,n,p="";for(n=0;n<m.groupField.length;n++){var q=
                m.groupField[n];b.each(a.p.colModel,function(a,b){b.name===q&&b.index&&(q=b.index)});p+=q+" "+m.groupOrder[n]+", "}e[f.sort]=p+e[f.sort]}b.extend(a.p.postData,e);var r=a.p.scroll?a.rows.length-1:1,e=b(a).triggerHandler("jqGridBeforeRequest");if(!1!==e&&"stop"!==e)if(b.isFunction(a.p.datatype))a.p.datatype.call(a,a.p.postData,"load_"+a.p.id,r,c,l);else{if(b.isFunction(a.p.beforeRequest)&&(e=a.p.beforeRequest.call(a),void 0===e&&(e=!0),!1===e))return;g=a.p.datatype.toLowerCase();switch(g){case "json":case "jsonp":case "xml":case "script":b.ajax(b.extend({url:a.p.url,
                type:a.p.mtype,dataType:g,data:b.isFunction(a.p.serializeGridData)?a.p.serializeGridData.call(a,a.p.postData):a.p.postData,success:function(e,f,h){if(b.isFunction(a.p.beforeProcessing)&&!1===a.p.beforeProcessing.call(a,e,f,h))L();else{"xml"===g?aa(e,a.grid.bDiv,r,1<c,l):ba(e,a.grid.bDiv,r,1<c,l);b(a).triggerHandler("jqGridLoadComplete",[e]);k&&k.call(a,e);b(a).triggerHandler("jqGridAfterLoadComplete",[e]);d&&a.grid.populateVisible();if(a.p.loadonce||a.p.treeGrid)a.p.datatype="local";1===c&&L()}},
                error:function(d,e,f){b.isFunction(a.p.loadError)&&a.p.loadError.call(a,d,e,f);1===c&&L()},beforeSend:function(c,d){var e=!0;b.isFunction(a.p.loadBeforeSend)&&(e=a.p.loadBeforeSend.call(a,c,d));void 0===e&&(e=!0);if(!1===e)return!1;ca()}},b.jgrid.ajaxOptions,a.p.ajaxGridOptions));break;case "xmlstring":ca();e="string"!==typeof a.p.datastr?a.p.datastr:b.parseXML(a.p.datastr);aa(e,a.grid.bDiv);b(a).triggerHandler("jqGridLoadComplete",[e]);h&&a.p.loadComplete.call(a,e);b(a).triggerHandler("jqGridAfterLoadComplete",
                [e]);a.p.datatype="local";a.p.datastr=null;L();break;case "jsonstring":ca();e="string"===typeof a.p.datastr?b.jgrid.parse(a.p.datastr):a.p.datastr;ba(e,a.grid.bDiv);b(a).triggerHandler("jqGridLoadComplete",[e]);h&&a.p.loadComplete.call(a,e);b(a).triggerHandler("jqGridAfterLoadComplete",[e]);a.p.datatype="local";a.p.datastr=null;L();break;case "local":case "clientside":ca(),a.p.datatype="local",e=ua(),ba(e,a.grid.bDiv,r,1<c,l),b(a).triggerHandler("jqGridLoadComplete",[e]),k&&k.call(a,e),b(a).triggerHandler("jqGridAfterLoadComplete",
                [e]),d&&a.grid.populateVisible(),L()}}}},ha=function(c){b("#cb_"+b.jgrid.jqID(a.p.id),a.grid.hDiv)[a.p.useProp?"prop":"attr"]("checked",c);if(a.p.frozenColumns&&a.p.id+"_frozen")b("#cb_"+b.jgrid.jqID(a.p.id),a.grid.fhDiv)[a.p.useProp?"prop":"attr"]("checked",c)},oa=function(c,d){var e="",f="<table cellspacing='0' cellpadding='0' border='0' style='table-layout:auto;' class='ui-pg-table'><tbody><tr>",g="",h,k,m,n,p=function(c){var d;b.isFunction(a.p.onPaging)&&(d=a.p.onPaging.call(a,c));if("stop"===
            d)return!1;a.p.selrow=null;a.p.multiselect&&(a.p.selarrrow=[],ha(!1));a.p.savedRow=[];return!0};c=c.substr(1);d+="_"+c;h="pg_"+c;k=c+"_left";m=c+"_center";n=c+"_right";b("#"+b.jgrid.jqID(c)).append("<div id='"+h+"' class='ui-pager-control' role='group'><table cellspacing='0' cellpadding='0' border='0' class='ui-pg-table' style='width:100%;table-layout:fixed;height:100%;' role='row'><tbody><tr><td id='"+k+"' align='left'></td><td id='"+m+"' align='center' style='white-space:pre;'></td><td id='"+n+
            "' align='right'></td></tr></tbody></table></div>").attr("dir","ltr");if(0<a.p.rowList.length){g="<td dir='"+l+"'>";g+="<select class='ui-pg-selbox' role='listbox' "+(a.p.pgrecs?"title='"+a.p.pgrecs+"'":"")+">";for(k=0;k<a.p.rowList.length;k++)m=a.p.rowList[k].toString().split(":"),1===m.length&&(m[1]=m[0]),g+='<option role="option" value="'+m[0]+'"'+(q(a.p.rowNum,0)===q(m[0],0)?' selected="selected"':"")+">"+m[1]+"</option>";g+="</select></td>"}"rtl"===l&&(f+=g);!0===a.p.pginput&&(e="<td dir='"+
            l+"'>"+b.jgrid.format(a.p.pgtext||"","<input class='ui-pg-input' type='text' size='2' maxlength='7' value='0' role='textbox'/>","<span id='sp_1_"+b.jgrid.jqID(c)+"'></span>")+"</td>");!0===a.p.pgbuttons?(k=["first"+d,"prev"+d,"next"+d,"last"+d],"rtl"===l&&k.reverse(),f+="<td id='"+k[0]+"' class='ui-pg-button ui-corner-all' "+(a.p.pgfirst?"title='"+a.p.pgfirst+"'":"")+"><span class='ui-icon ui-icon-seek-first'></span></td>",f+="<td id='"+k[1]+"' class='ui-pg-button ui-corner-all' "+(a.p.pgprev?"title='"+
            a.p.pgprev+"'":"")+"><span class='ui-icon ui-icon-seek-prev'></span></td>",f=f+(""!==e?"<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='ui-separator'></span></td>"+e+"<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='ui-separator'></span></td>":"")+("<td id='"+k[2]+"' class='ui-pg-button ui-corner-all' "+(a.p.pgnext?"title='"+a.p.pgnext+"'":"")+"><span class='ui-icon ui-icon-seek-next'></span></td>"),f+="<td id='"+k[3]+"' class='ui-pg-button ui-corner-all' "+
            (a.p.pglast?"title='"+a.p.pglast+"'":"")+"><span class='ui-icon ui-icon-seek-end'></span></td>"):""!==e&&(f+=e);"ltr"===l&&(f+=g);f+="</tr></tbody></table>";!0===a.p.viewrecords&&b("td#"+c+"_"+a.p.recordpos,"#"+h).append("<div dir='"+l+"' style='text-align:"+a.p.recordpos+"' class='ui-paging-info'></div>");b("td#"+c+"_"+a.p.pagerpos,"#"+h).append(f);g=b(".ui-jqgrid").css("font-size")||"11px";b(document.body).append("<div id='testpg' class='ui-jqgrid ui-widget ui-widget-content' style='font-size:"+
            g+";visibility:hidden;' ></div>");f=b(f).clone().appendTo("#testpg").width();b("#testpg").remove();0<f&&(""!==e&&(f+=50),b("td#"+c+"_"+a.p.pagerpos,"#"+h).width(f));a.p._nvtd=[];a.p._nvtd[0]=f?Math.floor((a.p.width-f)/2):Math.floor(a.p.width/3);a.p._nvtd[1]=0;f=null;b(".ui-pg-selbox","#"+h).bind("change",function(){if(!p("records"))return!1;a.p.page=Math.round(a.p.rowNum*(a.p.page-1)/this.value-.5)+1;a.p.rowNum=this.value;a.p.pager&&b(".ui-pg-selbox",a.p.pager).val(this.value);a.p.toppager&&b(".ui-pg-selbox",
            a.p.toppager).val(this.value);M();return!1});!0===a.p.pgbuttons&&(b(".ui-pg-button","#"+h).hover(function(){b(this).hasClass("ui-state-disabled")?this.style.cursor="default":(b(this).addClass("ui-state-hover"),this.style.cursor="pointer")},function(){b(this).hasClass("ui-state-disabled")||(b(this).removeClass("ui-state-hover"),this.style.cursor="default")}),b("#first"+b.jgrid.jqID(d)+", #prev"+b.jgrid.jqID(d)+", #next"+b.jgrid.jqID(d)+", #last"+b.jgrid.jqID(d)).click(function(){if(b(this).hasClass("ui-state-disabled"))return!1;
            var c=q(a.p.page,1),e=q(a.p.lastpage,1),f=!1,g=!0,h=!0,k=!0,l=!0;0===e||1===e?l=k=h=g=!1:1<e&&1<=c?1===c?h=g=!1:c===e&&(l=k=!1):1<e&&0===c&&(l=k=!1,c=e-1);if(!p(this.id))return!1;this.id==="first"+d&&g&&(a.p.page=1,f=!0);this.id==="prev"+d&&h&&(a.p.page=c-1,f=!0);this.id==="next"+d&&k&&(a.p.page=c+1,f=!0);this.id==="last"+d&&l&&(a.p.page=e,f=!0);f&&M();return!1}));!0===a.p.pginput&&b("input.ui-pg-input","#"+h).keypress(function(c){if(13===(c.charCode||c.keyCode||0)){if(!p("user"))return!1;b(this).val(q(b(this).val(),
            1));a.p.page=0<b(this).val()?b(this).val():a.p.page;M();return!1}return this})},wa=function(c,d){var e,f="",g=a.p.colModel,h=!1,k;k=a.p.frozenColumns?d:a.grid.headers[c].el;var l="";b("span.ui-grid-ico-sort",k).addClass("ui-state-disabled");b(k).attr("aria-selected","false");if(g[c].lso)if("asc"===g[c].lso)g[c].lso+="-desc",l="desc";else if("desc"===g[c].lso)g[c].lso+="-asc",l="asc";else{if("asc-desc"===g[c].lso||"desc-asc"===g[c].lso)g[c].lso=""}else g[c].lso=l=g[c].firstsortorder||"asc";l?(b("span.s-ico",
            k).show(),b("span.ui-icon-"+l,k).removeClass("ui-state-disabled"),b(k).attr("aria-selected","true")):a.p.viewsortcols[0]||b("span.s-ico",k).hide();a.p.sortorder="";b.each(g,function(b){this.lso&&(0<b&&h&&(f+=", "),e=this.lso.split("-"),f+=g[b].index||g[b].name,f+=" "+e[e.length-1],h=!0,a.p.sortorder=e[e.length-1])});k=f.lastIndexOf(a.p.sortorder);f=f.substring(0,k);a.p.sortname=f},pa=function(c,d,e,f,g){if(a.p.colModel[d].sortable&&!(0<a.p.savedRow.length)){e||(a.p.lastsort===d&&""!==a.p.sortname?
            "asc"===a.p.sortorder?a.p.sortorder="desc":"desc"===a.p.sortorder&&(a.p.sortorder="asc"):a.p.sortorder=a.p.colModel[d].firstsortorder||"asc",a.p.page=1);if(a.p.multiSort)wa(d,g);else{if(f){if(a.p.lastsort===d&&a.p.sortorder===f&&!e)return;a.p.sortorder=f}e=a.grid.headers[a.p.lastsort].el;g=a.p.frozenColumns?g:a.grid.headers[d].el;b("span.ui-grid-ico-sort",e).addClass("ui-state-disabled");b(e).attr("aria-selected","false");a.p.frozenColumns&&(a.grid.fhDiv.find("span.ui-grid-ico-sort").addClass("ui-state-disabled"),
            a.grid.fhDiv.find("th").attr("aria-selected","false"));b("span.ui-icon-"+a.p.sortorder,g).removeClass("ui-state-disabled");b(g).attr("aria-selected","true");a.p.viewsortcols[0]||(a.p.lastsort!==d?(a.p.frozenColumns&&a.grid.fhDiv.find("span.s-ico").hide(),b("span.s-ico",e).hide(),b("span.s-ico",g).show()):""===a.p.sortname&&b("span.s-ico",g).show());c=c.substring(5+a.p.id.length+1);a.p.sortname=a.p.colModel[d].index||c}"stop"===b(a).triggerHandler("jqGridSortCol",[a.p.sortname,d,a.p.sortorder])?a.p.lastsort=
            d:b.isFunction(a.p.onSortCol)&&"stop"===a.p.onSortCol.call(a,a.p.sortname,d,a.p.sortorder)?a.p.lastsort=d:("local"===a.p.datatype?a.p.deselectAfterSort&&b(a).jqGrid("resetSelection"):(a.p.selrow=null,a.p.multiselect&&ha(!1),a.p.selarrrow=[],a.p.savedRow=[]),a.p.scroll&&(g=a.grid.bDiv.scrollLeft,V.call(a,!0,!1),a.grid.hDiv.scrollLeft=g),a.p.subGrid&&"local"===a.p.datatype&&b("td.sgexpanded","#"+b.jgrid.jqID(a.p.id)).each(function(){b(this).trigger("click")}),M(),a.p.lastsort=d,a.p.sortname!==c&&d&&
        (a.p.lastsort=d))}},xa=function(c){c=b(a.grid.headers[c].el);c=[c.position().left+c.outerWidth()];"rtl"===a.p.direction&&(c[0]=a.p.width-c[0]);c[0]-=a.grid.bDiv.scrollLeft;c.push(b(a.grid.hDiv).position().top);c.push(b(a.grid.bDiv).offset().top-b(a.grid.hDiv).offset().top+b(a.grid.bDiv).height());return c},qa=function(c){var d,e=a.grid.headers,f=b.jgrid.getCellIndex(c);for(d=0;d<e.length;d++)if(c===e[d].el){f=d;break}return f},y;this.p.id=this.id;-1===b.inArray(a.p.multikey,["shiftKey","altKey","ctrlKey"])&&
        (a.p.multikey=!1);a.p.keyName=!1;for(f=0;f<a.p.colModel.length;f++)y="string"===typeof a.p.colModel[f].template?null!=b.jgrid.cmTemplate&&"object"===typeof b.jgrid.cmTemplate[a.p.colModel[f].template]?b.jgrid.cmTemplate[a.p.colModel[f].template]:{}:a.p.colModel[f].template,a.p.colModel[f]=b.extend(!0,{},a.p.cmTemplate,y||{},a.p.colModel[f]),!1===a.p.keyName&&!0===a.p.colModel[f].key&&(a.p.keyName=a.p.colModel[f].name);a.p.sortorder=a.p.sortorder.toLowerCase();b.jgrid.cell_width=b.jgrid.cellWidth();
            !0===a.p.grouping&&(a.p.scroll=!1,a.p.rownumbers=!1,a.p.treeGrid=!1,a.p.gridview=!0);if(!0===this.p.treeGrid){try{b(this).jqGrid("setTreeGrid")}catch(za){}"local"!==a.p.datatype&&(a.p.localReader={id:"_id_"})}if(this.p.subGrid)try{b(a).jqGrid("setSubGrid")}catch(Aa){}this.p.multiselect&&(this.p.colNames.unshift("<input role='checkbox' id='cb_"+this.p.id+"' class='cbox' type='checkbox'/>"),this.p.colModel.unshift({name:"cb",width:b.jgrid.cell_width?a.p.multiselectWidth+a.p.cellLayout:a.p.multiselectWidth,
                sortable:!1,resizable:!1,hidedlg:!0,search:!1,align:"center",fixed:!0}));this.p.rownumbers&&(this.p.colNames.unshift(""),this.p.colModel.unshift({name:"rn",width:a.p.rownumWidth,sortable:!1,resizable:!1,hidedlg:!0,search:!1,align:"center",fixed:!0}));a.p.xmlReader=b.extend(!0,{root:"rows",row:"row",page:"rows>page",total:"rows>total",records:"rows>records",repeatitems:!0,cell:"cell",id:"[id]",userdata:"userdata",subgrid:{root:"rows",row:"row",repeatitems:!0,cell:"cell"}},a.p.xmlReader);a.p.jsonReader=
                b.extend(!0,{root:"rows",page:"page",total:"total",records:"records",repeatitems:!0,cell:"cell",id:"id",userdata:"userdata",subgrid:{root:"rows",repeatitems:!0,cell:"cell"}},a.p.jsonReader);a.p.localReader=b.extend(!0,{root:"rows",page:"page",total:"total",records:"records",repeatitems:!1,cell:"cell",id:"id",userdata:"userdata",subgrid:{root:"rows",repeatitems:!0,cell:"cell"}},a.p.localReader);a.p.scroll&&(a.p.pgbuttons=!1,a.p.pginput=!1,a.p.rowList=[]);a.p.data.length&&(S(),O());y="<thead><tr class='ui-jqgrid-labels' role='row'>";
            var ra,z,ia,da,ja,E,u,X,sa=X="",ea=[],ta=[];z=[];if(!0===a.p.shrinkToFit&&!0===a.p.forceFit)for(f=a.p.colModel.length-1;0<=f;f--)if(!a.p.colModel[f].hidden){a.p.colModel[f].resizable=!1;break}"horizontal"===a.p.viewsortcols[1]&&(X=" ui-i-asc",sa=" ui-i-desc");ra=d?"class='ui-th-div-ie'":"";X="<span class='s-ico' style='display:none'><span sort='asc' class='ui-grid-ico-sort ui-icon-asc"+X+" ui-state-disabled ui-icon ui-icon-triangle-1-n ui-sort-"+l+"'></span>"+("<span sort='desc' class='ui-grid-ico-sort ui-icon-desc"+
                sa+" ui-state-disabled ui-icon ui-icon-triangle-1-s ui-sort-"+l+"'></span></span>");if(a.p.multiSort)for(ea=a.p.sortname.split(","),f=0;f<ea.length;f++)z=b.trim(ea[f]).split(" "),ea[f]=b.trim(z[0]),ta[f]=z[1]?b.trim(z[1]):a.p.sortorder||"asc";for(f=0;f<this.p.colNames.length;f++)z=a.p.headertitles?' title="'+b.jgrid.stripHtml(a.p.colNames[f])+'"':"",y+="<th id='"+a.p.id+"_"+a.p.colModel[f].name+"' role='columnheader' class='ui-state-default ui-th-column ui-th-"+l+"'"+z+">",z=a.p.colModel[f].index||
                a.p.colModel[f].name,y+="<div id='jqgh_"+a.p.id+"_"+a.p.colModel[f].name+"' "+ra+">"+a.p.colNames[f],a.p.colModel[f].width=a.p.colModel[f].width?parseInt(a.p.colModel[f].width,10):150,"boolean"!==typeof a.p.colModel[f].title&&(a.p.colModel[f].title=!0),a.p.colModel[f].lso="",z===a.p.sortname&&(a.p.lastsort=f),a.p.multiSort&&(z=b.inArray(z,ea),-1!==z&&(a.p.colModel[f].lso=ta[z])),y+=X+"</div></th>";y+="</tr></thead>";X=null;b(this).append(y);b("thead tr:first th",this).hover(function(){b(this).addClass("ui-state-hover")},
                function(){b(this).removeClass("ui-state-hover")});if(this.p.multiselect){var ka=[],Y;b("#cb_"+b.jgrid.jqID(a.p.id),this).bind("click",function(){a.p.selarrrow=[];var c=!0===a.p.frozenColumns?a.p.id+"_frozen":"";this.checked?(b(a.rows).each(function(d){0<d&&!(b(this).hasClass("ui-subgrid")||b(this).hasClass("jqgroup")||b(this).hasClass("ui-state-disabled")||b(this).hasClass("jqfoot"))&&(b("#jqg_"+b.jgrid.jqID(a.p.id)+"_"+b.jgrid.jqID(this.id))[a.p.useProp?"prop":"attr"]("checked",!0),b(this).addClass("ui-state-highlight").attr("aria-selected",
                "true"),a.p.selarrrow.push(this.id),a.p.selrow=this.id,c&&(b("#jqg_"+b.jgrid.jqID(a.p.id)+"_"+b.jgrid.jqID(this.id),a.grid.fbDiv)[a.p.useProp?"prop":"attr"]("checked",!0),b("#"+b.jgrid.jqID(this.id),a.grid.fbDiv).addClass("ui-state-highlight")))}),Y=!0,ka=[]):(b(a.rows).each(function(d){0<d&&!(b(this).hasClass("ui-subgrid")||b(this).hasClass("jqgroup")||b(this).hasClass("ui-state-disabled")||b(this).hasClass("jqfoot"))&&(b("#jqg_"+b.jgrid.jqID(a.p.id)+"_"+b.jgrid.jqID(this.id))[a.p.useProp?"prop":
                "attr"]("checked",!1),b(this).removeClass("ui-state-highlight").attr("aria-selected","false"),ka.push(this.id),c&&(b("#jqg_"+b.jgrid.jqID(a.p.id)+"_"+b.jgrid.jqID(this.id),a.grid.fbDiv)[a.p.useProp?"prop":"attr"]("checked",!1),b("#"+b.jgrid.jqID(this.id),a.grid.fbDiv).removeClass("ui-state-highlight")))}),a.p.selrow=null,Y=!1);b(a).triggerHandler("jqGridSelectAll",[Y?a.p.selarrrow:ka,Y]);b.isFunction(a.p.onSelectAll)&&a.p.onSelectAll.call(a,Y?a.p.selarrrow:ka,Y)})}!0===a.p.autowidth&&(y=b(m).innerWidth(),
                a.p.width=0<y?y:"nw");(function(){var d=0,e=b.jgrid.cell_width?0:q(a.p.cellLayout,0),f=0,g,h=q(a.p.scrollOffset,0),k,l=!1,m,n=0,p;b.each(a.p.colModel,function(){void 0===this.hidden&&(this.hidden=!1);if(a.p.grouping&&a.p.autowidth){var c=b.inArray(this.name,a.p.groupingView.groupField);0<=c&&a.p.groupingView.groupColumnShow.length>c&&(this.hidden=!a.p.groupingView.groupColumnShow[c])}this.widthOrg=k=q(this.width,0);!1===this.hidden&&(d+=k+e,this.fixed?n+=k+e:f++)});isNaN(a.p.width)&&(a.p.width=d+
                (!1!==a.p.shrinkToFit||isNaN(a.p.height)?0:h));c.width=a.p.width;a.p.tblwidth=d;!1===a.p.shrinkToFit&&!0===a.p.forceFit&&(a.p.forceFit=!1);!0===a.p.shrinkToFit&&0<f&&(m=c.width-e*f-n,isNaN(a.p.height)||(m-=h,l=!0),d=0,b.each(a.p.colModel,function(b){!1!==this.hidden||this.fixed||(this.width=k=Math.round(m*this.width/(a.p.tblwidth-e*f-n)),d+=k,g=b)}),p=0,l?c.width-n-(d+e*f)!==h&&(p=c.width-n-(d+e*f)-h):l||1===Math.abs(c.width-n-(d+e*f))||(p=c.width-n-(d+e*f)),a.p.colModel[g].width+=p,a.p.tblwidth=
                d+p+e*f+n,a.p.tblwidth>a.p.width&&(a.p.colModel[g].width-=a.p.tblwidth-parseInt(a.p.width,10),a.p.tblwidth=a.p.width))})();b(m).css("width",c.width+"px").append("<div class='ui-jqgrid-resize-mark' id='rs_m"+a.p.id+"'>&#160;</div>");b(n).css("width",c.width+"px");y=b("thead:first",a).get(0);var N="";a.p.footerrow&&(N+="<table role='presentation' style='width:"+a.p.tblwidth+"px' class='ui-jqgrid-ftable' cellspacing='0' cellpadding='0' border='0'><tbody><tr role='row' class='ui-widget-content footrow footrow-"+
                l+"'>");var n=b("tr:first",y),$="<tr class='jqgfirstrow' role='row' style='height:auto'>";a.p.disableClick=!1;b("th",n).each(function(d){ia=a.p.colModel[d].width;void 0===a.p.colModel[d].resizable&&(a.p.colModel[d].resizable=!0);a.p.colModel[d].resizable?(da=document.createElement("span"),b(da).html("&#160;").addClass("ui-jqgrid-resize ui-jqgrid-resize-"+l).css("cursor","col-resize"),b(this).addClass(a.p.resizeclass)):da="";b(this).css("width",ia+"px").prepend(da);da=null;var e="";a.p.colModel[d].hidden&&
            (b(this).css("display","none"),e="display:none;");$+="<td role='gridcell' style='height:0px;width:"+ia+"px;"+e+"'></td>";c.headers[d]={width:ia,el:this};ja=a.p.colModel[d].sortable;"boolean"!==typeof ja&&(ja=a.p.colModel[d].sortable=!0);e=a.p.colModel[d].name;"cb"!==e&&"subgrid"!==e&&"rn"!==e&&a.p.viewsortcols[2]&&b(">div",this).addClass("ui-jqgrid-sortable");ja&&(a.p.multiSort?a.p.viewsortcols[0]?(b("div span.s-ico",this).show(),a.p.colModel[d].lso&&b("div span.ui-icon-"+a.p.colModel[d].lso,this).removeClass("ui-state-disabled")):
                a.p.colModel[d].lso&&(b("div span.s-ico",this).show(),b("div span.ui-icon-"+a.p.colModel[d].lso,this).removeClass("ui-state-disabled")):a.p.viewsortcols[0]?(b("div span.s-ico",this).show(),d===a.p.lastsort&&b("div span.ui-icon-"+a.p.sortorder,this).removeClass("ui-state-disabled")):d===a.p.lastsort&&""!==a.p.sortname&&(b("div span.s-ico",this).show(),b("div span.ui-icon-"+a.p.sortorder,this).removeClass("ui-state-disabled")));a.p.footerrow&&(N+="<td role='gridcell' "+p(d,0,"",null,"",!1)+">&#160;</td>")}).mousedown(function(d){if(1===
                b(d.target).closest("th>span.ui-jqgrid-resize").length){var e=qa(this);if(!0===a.p.forceFit){var f=a.p,g=e,h;for(h=e+1;h<a.p.colModel.length;h++)if(!0!==a.p.colModel[h].hidden){g=h;break}f.nv=g-e}c.dragStart(e,d,xa(e));return!1}}).click(function(c){if(a.p.disableClick)return a.p.disableClick=!1;var d="th>div.ui-jqgrid-sortable",e,f;a.p.viewsortcols[2]||(d="th>div>span>span.ui-grid-ico-sort");c=b(c.target).closest(d);if(1===c.length){var g;if(a.p.frozenColumns){var h=b(this)[0].id.substring(a.p.id.length+
                1);b(a.p.colModel).each(function(a){if(this.name===h)return g=a,!1})}else g=qa(this);a.p.viewsortcols[2]||(e=!0,f=c.attr("sort"));null!=g&&pa(b("div",this)[0].id,g,e,f,this);return!1}});if(a.p.sortable&&b.fn.sortable)try{b(a).jqGrid("sortableColumns",n)}catch(Ba){}a.p.footerrow&&(N+="</tr></tbody></table>");$+="</tr>";n=document.createElement("tbody");this.appendChild(n);b(this).addClass("ui-jqgrid-btable").append($);var $=null,n=b("<table class='ui-jqgrid-htable' style='width:"+a.p.tblwidth+"px' role='presentation' aria-labelledby='gbox_"+
                this.id+"' cellspacing='0' cellpadding='0' border='0'></table>").append(y),I=a.p.caption&&!0===a.p.hiddengrid?!0:!1;f=b("<div class='ui-jqgrid-hbox"+("rtl"===l?"-rtl":"")+"'></div>");y=null;c.hDiv=document.createElement("div");b(c.hDiv).css({width:c.width+"px"}).addClass("ui-state-default ui-jqgrid-hdiv").append(f);b(f).append(n);n=null;I&&b(c.hDiv).hide();a.p.pager&&("string"===typeof a.p.pager?"#"!==a.p.pager.substr(0,1)&&(a.p.pager="#"+a.p.pager):a.p.pager="#"+b(a.p.pager).attr("id"),b(a.p.pager).css({width:c.width+
                    "px"}).addClass("ui-state-default ui-jqgrid-pager ui-corner-bottom").appendTo(m),I&&b(a.p.pager).hide(),oa(a.p.pager,""));!1===a.p.cellEdit&&!0===a.p.hoverrows&&b(a).bind("mouseover",function(a){u=b(a.target).closest("tr.jqgrow");"ui-subgrid"!==b(u).attr("class")&&b(u).addClass("ui-state-hover")}).bind("mouseout",function(a){u=b(a.target).closest("tr.jqgrow");b(u).removeClass("ui-state-hover")});var C,J,la;b(a).before(c.hDiv).click(function(c){E=c.target;u=b(E,a.rows).closest("tr.jqgrow");if(0===
                b(u).length||-1<u[0].className.indexOf("ui-state-disabled")||(b(E,a).closest("table.ui-jqgrid-btable").attr("id")||"").replace("_frozen","")!==a.id)return this;var d=b(E).hasClass("cbox"),e=b(a).triggerHandler("jqGridBeforeSelectRow",[u[0].id,c]),e=!1===e||"stop"===e?!1:!0;if(b.isFunction(a.p.beforeSelectRow)){var f=a.p.beforeSelectRow.call(a,u[0].id,c);if(!1===f||"stop"===f)e=!1}if("A"!==E.tagName&&("INPUT"!==E.tagName&&"TEXTAREA"!==E.tagName&&"OPTION"!==E.tagName&&"SELECT"!==E.tagName||d)){C=u[0].id;
                E=b(E).closest("tr.jqgrow>td");0<E.length&&(J=b.jgrid.getCellIndex(E),la=b(E).closest("td,th").html(),b(a).triggerHandler("jqGridCellSelect",[C,J,la,c]),b.isFunction(a.p.onCellSelect)&&a.p.onCellSelect.call(a,C,J,la,c));if(!0===a.p.cellEdit)if(a.p.multiselect&&d&&e)b(a).jqGrid("setSelection",C,!0,c);else if(0<E.length){C=u[0].rowIndex;try{b(a).jqGrid("editCell",C,J,!0)}catch(g){}}if(e)if(a.p.multikey)c[a.p.multikey]?b(a).jqGrid("setSelection",C,!0,c):a.p.multiselect&&d&&(d=b("#jqg_"+b.jgrid.jqID(a.p.id)+
                    "_"+C).is(":checked"),b("#jqg_"+b.jgrid.jqID(a.p.id)+"_"+C)[a.p.useProp?"prop":"attr"]("checked",d));else{if(a.p.multiselect&&a.p.multiboxonly&&!d){var h=a.p.frozenColumns?a.p.id+"_frozen":"";b(a.p.selarrrow).each(function(c,d){var e=b(a).jqGrid("getGridRowById",d);e&&b(e).removeClass("ui-state-highlight");b("#jqg_"+b.jgrid.jqID(a.p.id)+"_"+b.jgrid.jqID(d))[a.p.useProp?"prop":"attr"]("checked",!1);h&&(b("#"+b.jgrid.jqID(d),"#"+b.jgrid.jqID(h)).removeClass("ui-state-highlight"),b("#jqg_"+b.jgrid.jqID(a.p.id)+
                    "_"+b.jgrid.jqID(d),"#"+b.jgrid.jqID(h))[a.p.useProp?"prop":"attr"]("checked",!1))});a.p.selarrrow=[]}b(a).jqGrid("setSelection",C,!0,c)}}}).bind("reloadGrid",function(c,d){!0===a.p.treeGrid&&(a.p.datatype=a.p.treedatatype);d&&d.current&&a.grid.selectionPreserver(a);"local"===a.p.datatype?(b(a).jqGrid("resetSelection"),a.p.data.length&&(S(),O())):a.p.treeGrid||(a.p.selrow=null,a.p.multiselect&&(a.p.selarrrow=[],ha(!1)),a.p.savedRow=[]);a.p.scroll&&V.call(a,!0,!1);if(d&&d.page){var e=d.page;e>a.p.lastpage&&
            (e=a.p.lastpage);1>e&&(e=1);a.p.page=e;a.grid.bDiv.scrollTop=a.grid.prevRowHeight?(e-1)*a.grid.prevRowHeight*a.p.rowNum:0}a.grid.prevRowHeight&&a.p.scroll?(delete a.p.lastpage,a.grid.populateVisible()):a.grid.populate();!0===a.p._inlinenav&&b(a).jqGrid("showAddEditButtons");return!1}).dblclick(function(c){E=c.target;u=b(E,a.rows).closest("tr.jqgrow");if(0!==b(u).length){C=u[0].rowIndex;J=b.jgrid.getCellIndex(E);var d=b(a).triggerHandler("jqGridDblClickRow",[b(u).attr("id"),C,J,c]);if(null!=d||b.isFunction(a.p.ondblClickRow)&&
                (d=a.p.ondblClickRow.call(a,b(u).attr("id"),C,J,c),null!=d))return d}}).bind("contextmenu",function(c){E=c.target;u=b(E,a.rows).closest("tr.jqgrow");if(0!==b(u).length){a.p.multiselect||b(a).jqGrid("setSelection",u[0].id,!0,c);C=u[0].rowIndex;J=b.jgrid.getCellIndex(E);var d=b(a).triggerHandler("jqGridRightClickRow",[b(u).attr("id"),C,J,c]);if(null!=d||b.isFunction(a.p.onRightClickRow)&&(d=a.p.onRightClickRow.call(a,b(u).attr("id"),C,J,c),null!=d))return d}});c.bDiv=document.createElement("div");d&&
            "auto"===String(a.p.height).toLowerCase()&&(a.p.height="100%");b(c.bDiv).append(b('<div style="position:relative;'+(d&&8>b.jgrid.msiever()?"height:0.01%;":"")+'"></div>').append("<div></div>").append(this)).addClass("ui-jqgrid-bdiv").css({height:a.p.height+(isNaN(a.p.height)?"":"px"),width:c.width+"px"}).scroll(c.scrollGrid);b("table:first",c.bDiv).css({width:a.p.tblwidth+"px"});b.support.tbody||2===b("tbody",this).length&&b("tbody:gt(0)",this).remove();a.p.multikey&&(b.jgrid.msie?b(c.bDiv).bind("selectstart",
                function(){return!1}):b(c.bDiv).bind("mousedown",function(){return!1}));I&&b(c.bDiv).hide();c.cDiv=document.createElement("div");var ma=!0===a.p.hidegrid?b("<a role='link' class='ui-jqgrid-titlebar-close ui-corner-all HeaderButton' "+(a.p.showhide?"title='"+a.p.showhide+"'":"")+" />").hover(function(){ma.addClass("ui-state-hover")},function(){ma.removeClass("ui-state-hover")}).append("<span class='ui-icon ui-icon-circle-triangle-n'></span>").css("rtl"===l?"left":"right","0px"):"";b(c.cDiv).append(ma).append("<span class='ui-jqgrid-title'>"+
                a.p.caption+"</span>").addClass("ui-jqgrid-titlebar ui-jqgrid-caption"+("rtl"===l?"-rtl":"")+" ui-widget-header ui-corner-top ui-helper-clearfix");b(c.cDiv).insertBefore(c.hDiv);a.p.toolbar[0]&&(c.uDiv=document.createElement("div"),"top"===a.p.toolbar[1]?b(c.uDiv).insertBefore(c.hDiv):"bottom"===a.p.toolbar[1]&&b(c.uDiv).insertAfter(c.hDiv),"both"===a.p.toolbar[1]?(c.ubDiv=document.createElement("div"),b(c.uDiv).addClass("ui-userdata ui-state-default").attr("id","t_"+this.id).insertBefore(c.hDiv),
                b(c.ubDiv).addClass("ui-userdata ui-state-default").attr("id","tb_"+this.id).insertAfter(c.hDiv),I&&b(c.ubDiv).hide()):b(c.uDiv).width(c.width).addClass("ui-userdata ui-state-default").attr("id","t_"+this.id),I&&b(c.uDiv).hide());a.p.toppager&&(a.p.toppager=b.jgrid.jqID(a.p.id)+"_toppager",c.topDiv=b("<div id='"+a.p.toppager+"'></div>")[0],a.p.toppager="#"+a.p.toppager,b(c.topDiv).addClass("ui-state-default ui-jqgrid-toppager").width(c.width).insertBefore(c.hDiv),oa(a.p.toppager,"_t"));a.p.footerrow&&
            (c.sDiv=b("<div class='ui-jqgrid-sdiv'></div>")[0],f=b("<div class='ui-jqgrid-hbox"+("rtl"===l?"-rtl":"")+"'></div>"),b(c.sDiv).append(f).width(c.width).insertAfter(c.hDiv),b(f).append(N),c.footers=b(".ui-jqgrid-ftable",c.sDiv)[0].rows[0].cells,a.p.rownumbers&&(c.footers[0].className="ui-state-default jqgrid-rownum"),I&&b(c.sDiv).hide());f=null;if(a.p.caption){var ya=a.p.datatype;!0===a.p.hidegrid&&(b(".ui-jqgrid-titlebar-close",c.cDiv).click(function(d){var e=b.isFunction(a.p.onHeaderClick),f=".ui-jqgrid-bdiv, .ui-jqgrid-hdiv, .ui-jqgrid-pager, .ui-jqgrid-sdiv",
                g,h=this;!0===a.p.toolbar[0]&&("both"===a.p.toolbar[1]&&(f+=", #"+b(c.ubDiv).attr("id")),f+=", #"+b(c.uDiv).attr("id"));g=b(f,"#gview_"+b.jgrid.jqID(a.p.id)).length;"visible"===a.p.gridstate?b(f,"#gbox_"+b.jgrid.jqID(a.p.id)).slideUp("fast",function(){g--;0===g&&(b("span",h).removeClass("ui-icon-circle-triangle-n").addClass("ui-icon-circle-triangle-s"),a.p.gridstate="hidden",b("#gbox_"+b.jgrid.jqID(a.p.id)).hasClass("ui-resizable")&&b(".ui-resizable-handle","#gbox_"+b.jgrid.jqID(a.p.id)).hide(),b(a).triggerHandler("jqGridHeaderClick",
                [a.p.gridstate,d]),e&&(I||a.p.onHeaderClick.call(a,a.p.gridstate,d)))}):"hidden"===a.p.gridstate&&b(f,"#gbox_"+b.jgrid.jqID(a.p.id)).slideDown("fast",function(){g--;0===g&&(b("span",h).removeClass("ui-icon-circle-triangle-s").addClass("ui-icon-circle-triangle-n"),I&&(a.p.datatype=ya,M(),I=!1),a.p.gridstate="visible",b("#gbox_"+b.jgrid.jqID(a.p.id)).hasClass("ui-resizable")&&b(".ui-resizable-handle","#gbox_"+b.jgrid.jqID(a.p.id)).show(),b(a).triggerHandler("jqGridHeaderClick",[a.p.gridstate,d]),e&&
            (I||a.p.onHeaderClick.call(a,a.p.gridstate,d)))});return!1}),I&&(a.p.datatype="local",b(".ui-jqgrid-titlebar-close",c.cDiv).trigger("click")))}else b(c.cDiv).hide(),a.p.toppager||b(c.hDiv).addClass("ui-corner-top");b(c.hDiv).after(c.bDiv).mousemove(function(a){if(c.resizing)return c.dragMove(a),!1});b(".ui-jqgrid-labels",c.hDiv).bind("selectstart",function(){return!1});b(document).bind("mouseup.jqGrid"+a.p.id,function(){return c.resizing?(c.dragEnd(),!1):!0});a.formatCol=p;a.sortData=pa;a.updatepager=
                function(c,d){var e,f,g,h,k,l,m,n="",p=a.p.pager?"_"+b.jgrid.jqID(a.p.pager.substr(1)):"",r=a.p.toppager?"_"+a.p.toppager.substr(1):"";g=parseInt(a.p.page,10)-1;0>g&&(g=0);g*=parseInt(a.p.rowNum,10);k=g+a.p.reccount;if(a.p.scroll){e=b("tbody:first > tr:gt(0)",a.grid.bDiv);g=k-e.length;a.p.reccount=e.length;if(e=e.outerHeight()||a.grid.prevRowHeight)f=g*e,m=parseInt(a.p.records,10)*e,b(">div:first",a.grid.bDiv).css({height:m}).children("div:first").css({height:f,display:f?"":"none"}),0==a.grid.bDiv.scrollTop&&
                1<a.p.page&&(a.grid.bDiv.scrollTop=a.p.rowNum*(a.p.page-1)*e);a.grid.bDiv.scrollLeft=a.grid.hDiv.scrollLeft}n=a.p.pager||"";if(n+=a.p.toppager?n?","+a.p.toppager:a.p.toppager:"")m=b.jgrid.formatter.integer||{},e=q(a.p.page),f=q(a.p.lastpage),b(".selbox",n)[this.p.useProp?"prop":"attr"]("disabled",!1),!0===a.p.pginput&&(b(".ui-pg-input",n).val(a.p.page),h=a.p.toppager?"#sp_1"+p+",#sp_1"+r:"#sp_1"+p,b(h).html(b.fmatter?b.fmatter.util.NumberFormat(a.p.lastpage,m):a.p.lastpage)),a.p.viewrecords&&(0===
                a.p.reccount?b(".ui-paging-info",n).html(a.p.emptyrecords):(h=g+1,l=a.p.records,b.fmatter&&(h=b.fmatter.util.NumberFormat(h,m),k=b.fmatter.util.NumberFormat(k,m),l=b.fmatter.util.NumberFormat(l,m)),b(".ui-paging-info",n).html(b.jgrid.format(a.p.recordtext,h,k,l)))),!0===a.p.pgbuttons&&(0>=e&&(e=f=0),1===e||0===e?(b("#first"+p+", #prev"+p).addClass("ui-state-disabled").removeClass("ui-state-hover"),a.p.toppager&&b("#first_t"+r+", #prev_t"+r).addClass("ui-state-disabled").removeClass("ui-state-hover")):
                    (b("#first"+p+", #prev"+p).removeClass("ui-state-disabled"),a.p.toppager&&b("#first_t"+r+", #prev_t"+r).removeClass("ui-state-disabled")),e===f||0===e?(b("#next"+p+", #last"+p).addClass("ui-state-disabled").removeClass("ui-state-hover"),a.p.toppager&&b("#next_t"+r+", #last_t"+r).addClass("ui-state-disabled").removeClass("ui-state-hover")):(b("#next"+p+", #last"+p).removeClass("ui-state-disabled"),a.p.toppager&&b("#next_t"+r+", #last_t"+r).removeClass("ui-state-disabled")));!0===c&&!0===a.p.rownumbers&&
                b(">td.jqgrid-rownum",a.rows).each(function(a){b(this).html(g+1+a)});d&&a.p.jqgdnd&&b(a).jqGrid("gridDnD","updateDnD");b(a).triggerHandler("jqGridGridComplete");b.isFunction(a.p.gridComplete)&&a.p.gridComplete.call(a);b(a).triggerHandler("jqGridAfterGridComplete")};a.refreshIndex=O;a.setHeadCheckBox=ha;a.constructTr=P;a.formatter=function(a,b,c,d,e){return B(a,b,c,d,e)};b.extend(c,{populate:M,emptyRows:V,beginReq:ca,endReq:L});this.grid=c;a.addXmlData=function(b){aa(b,a.grid.bDiv)};a.addJSONData=
                function(b){ba(b,a.grid.bDiv)};this.grid.cols=this.rows[0].cells;b(a).triggerHandler("jqGridInitGrid");b.isFunction(a.p.onInitGrid)&&a.p.onInitGrid.call(a);M();a.p.hiddengrid=!1}}}})};b.jgrid.extend({getGridParam:function(b){var f=this[0];if(f&&f.grid)return b?void 0!==f.p[b]?f.p[b]:null:f.p},setGridParam:function(g,f){return this.each(function(){null==f&&(f=!1);this.grid&&"object"===typeof g&&(!0===f?this.p=b.extend({},this.p,g):b.extend(!0,this.p,g))})},getGridRowById:function(g){var f;this.each(function(){try{for(var e=
            this.rows.length;e--;)if(g.toString()===this.rows[e].id){f=this.rows[e];break}}catch(d){f=b(this.grid.bDiv).find("#"+b.jgrid.jqID(g))}});return f},getDataIDs:function(){var g=[],f=0,e,d=0;this.each(function(){if((e=this.rows.length)&&0<e)for(;f<e;)b(this.rows[f]).hasClass("jqgrow")&&(g[d]=this.rows[f].id,d++),f++});return g},setSelection:function(g,f,e){return this.each(function(){var d,k,a,c,h,l;void 0!==g&&(f=!1===f?!1:!0,!(k=b(this).jqGrid("getGridRowById",g))||!k.className||-1<k.className.indexOf("ui-state-disabled")||
        (!0===this.p.scrollrows&&(a=b(this).jqGrid("getGridRowById",g).rowIndex,0<=a&&(d=b(this.grid.bDiv)[0].clientHeight,c=b(this.grid.bDiv)[0].scrollTop,h=b(this.rows[a]).position().top,a=this.rows[a].clientHeight,h+a>=d+c?b(this.grid.bDiv)[0].scrollTop=h-(d+c)+a+c:h<d+c&&h<c&&(b(this.grid.bDiv)[0].scrollTop=h))),!0===this.p.frozenColumns&&(l=this.p.id+"_frozen"),this.p.multiselect?(this.setHeadCheckBox(!1),this.p.selrow=k.id,c=b.inArray(this.p.selrow,this.p.selarrrow),-1===c?("ui-subgrid"!==k.className&&
        b(k).addClass("ui-state-highlight").attr("aria-selected","true"),d=!0,this.p.selarrrow.push(this.p.selrow)):("ui-subgrid"!==k.className&&b(k).removeClass("ui-state-highlight").attr("aria-selected","false"),d=!1,this.p.selarrrow.splice(c,1),h=this.p.selarrrow[0],this.p.selrow=void 0===h?null:h),b("#jqg_"+b.jgrid.jqID(this.p.id)+"_"+b.jgrid.jqID(k.id))[this.p.useProp?"prop":"attr"]("checked",d),l&&(-1===c?b("#"+b.jgrid.jqID(g),"#"+b.jgrid.jqID(l)).addClass("ui-state-highlight"):b("#"+b.jgrid.jqID(g),
            "#"+b.jgrid.jqID(l)).removeClass("ui-state-highlight"),b("#jqg_"+b.jgrid.jqID(this.p.id)+"_"+b.jgrid.jqID(g),"#"+b.jgrid.jqID(l))[this.p.useProp?"prop":"attr"]("checked",d)),f&&(b(this).triggerHandler("jqGridSelectRow",[k.id,d,e]),this.p.onSelectRow&&this.p.onSelectRow.call(this,k.id,d,e))):"ui-subgrid"!==k.className&&(this.p.selrow!==k.id?((d=b(this).jqGrid("getGridRowById",this.p.selrow))&&b(d).removeClass("ui-state-highlight").attr({"aria-selected":"false",tabindex:"-1"}),b(k).addClass("ui-state-highlight").attr({"aria-selected":"true",
            tabindex:"0"}),l&&(b("#"+b.jgrid.jqID(this.p.selrow),"#"+b.jgrid.jqID(l)).removeClass("ui-state-highlight"),b("#"+b.jgrid.jqID(g),"#"+b.jgrid.jqID(l)).addClass("ui-state-highlight")),d=!0):d=!1,this.p.selrow=k.id,f&&(b(this).triggerHandler("jqGridSelectRow",[k.id,d,e]),this.p.onSelectRow&&this.p.onSelectRow.call(this,k.id,d,e)))))})},resetSelection:function(g){return this.each(function(){var f=this,e,d;!0===f.p.frozenColumns&&(d=f.p.id+"_frozen");if(void 0!==g){e=g===f.p.selrow?f.p.selrow:g;b("#"+
            b.jgrid.jqID(f.p.id)+" tbody:first tr#"+b.jgrid.jqID(e)).removeClass("ui-state-highlight").attr("aria-selected","false");d&&b("#"+b.jgrid.jqID(e),"#"+b.jgrid.jqID(d)).removeClass("ui-state-highlight");if(f.p.multiselect){b("#jqg_"+b.jgrid.jqID(f.p.id)+"_"+b.jgrid.jqID(e),"#"+b.jgrid.jqID(f.p.id))[f.p.useProp?"prop":"attr"]("checked",!1);if(d)b("#jqg_"+b.jgrid.jqID(f.p.id)+"_"+b.jgrid.jqID(e),"#"+b.jgrid.jqID(d))[f.p.useProp?"prop":"attr"]("checked",!1);f.setHeadCheckBox(!1);e=b.inArray(b.jgrid.jqID(e),
            f.p.selarrrow);-1!==e&&f.p.selarrrow.splice(e,1)}e=null}else f.p.multiselect?(b(f.p.selarrrow).each(function(e,a){b(b(f).jqGrid("getGridRowById",a)).removeClass("ui-state-highlight").attr("aria-selected","false");b("#jqg_"+b.jgrid.jqID(f.p.id)+"_"+b.jgrid.jqID(a))[f.p.useProp?"prop":"attr"]("checked",!1);d&&(b("#"+b.jgrid.jqID(a),"#"+b.jgrid.jqID(d)).removeClass("ui-state-highlight"),b("#jqg_"+b.jgrid.jqID(f.p.id)+"_"+b.jgrid.jqID(a),"#"+b.jgrid.jqID(d))[f.p.useProp?"prop":"attr"]("checked",!1))}),
            f.setHeadCheckBox(!1),f.p.selarrrow=[],f.p.selrow=null):f.p.selrow&&(b("#"+b.jgrid.jqID(f.p.id)+" tbody:first tr#"+b.jgrid.jqID(f.p.selrow)).removeClass("ui-state-highlight").attr("aria-selected","false"),d&&b("#"+b.jgrid.jqID(f.p.selrow),"#"+b.jgrid.jqID(d)).removeClass("ui-state-highlight"),f.p.selrow=null);!0===f.p.cellEdit&&0<=parseInt(f.p.iCol,10)&&0<=parseInt(f.p.iRow,10)&&(b("td:eq("+f.p.iCol+")",f.rows[f.p.iRow]).removeClass("edit-cell ui-state-highlight"),b(f.rows[f.p.iRow]).removeClass("selected-row ui-state-hover"));
            f.p.savedRow=[]})},getRowData:function(g){var f={},e,d=!1,k,a=0;this.each(function(){var c=this,h,l;if(void 0===g)d=!0,e=[],k=c.rows.length;else{l=b(c).jqGrid("getGridRowById",g);if(!l)return f;k=2}for(;a<k;)d&&(l=c.rows[a]),b(l).hasClass("jqgrow")&&(b('td[role="gridcell"]',l).each(function(a){h=c.p.colModel[a].name;if("cb"!==h&&"subgrid"!==h&&"rn"!==h)if(!0===c.p.treeGrid&&h===c.p.ExpandColumn)f[h]=b.jgrid.htmlDecode(b("span:first",this).html());else try{f[h]=b.unformat.call(c,this,{rowId:l.id,colModel:c.p.colModel[a]},
            a)}catch(d){f[h]=b.jgrid.htmlDecode(b(this).html())}}),d&&(e.push(f),f={})),a++});return e||f},delRowData:function(g){var f=!1,e,d,k;this.each(function(){e=b(this).jqGrid("getGridRowById",g);if(!e)return!1;this.p.subGrid&&(k=b(e).next(),k.hasClass("ui-subgrid")&&k.remove());b(e).remove();this.p.records--;this.p.reccount--;this.updatepager(!0,!1);f=!0;this.p.multiselect&&(d=b.inArray(g,this.p.selarrrow),-1!==d&&this.p.selarrrow.splice(d,1));this.p.selrow=this.p.multiselect&&0<this.p.selarrrow.length?
            this.p.selarrrow[this.p.selarrrow.length-1]:null;if("local"===this.p.datatype){var a=b.jgrid.stripPref(this.p.idPrefix,g),a=this.p._index[a];void 0!==a&&(this.p.data.splice(a,1),this.refreshIndex())}if(!0===this.p.altRows&&f){var c=this.p.altclass;b(this.rows).each(function(a){1===a%2?b(this).addClass(c):b(this).removeClass(c)})}});return f},setRowData:function(g,f,e){var d,k=!0,a;this.each(function(){if(!this.grid)return!1;var c=this,h,l,n=typeof e,m={};l=b(this).jqGrid("getGridRowById",g);if(!l)return!1;
            if(f)try{if(b(this.p.colModel).each(function(e){d=this.name;var k=b.jgrid.getAccessor(f,d);void 0!==k&&(m[d]=this.formatter&&"string"===typeof this.formatter&&"date"===this.formatter?b.unformat.date.call(c,k,this):k,h=c.formatter(g,m[d],e,f,"edit"),a=this.title?{title:b.jgrid.stripHtml(h)}:{},!0===c.p.treeGrid&&d===c.p.ExpandColumn?b("td[role='gridcell']:eq("+e+") > span:first",l).html(h).attr(a):b("td[role='gridcell']:eq("+e+")",l).html(h).attr(a))}),"local"===c.p.datatype){var q=b.jgrid.stripPref(c.p.idPrefix,
                g),p=c.p._index[q],r;if(c.p.treeGrid)for(r in c.p.treeReader)c.p.treeReader.hasOwnProperty(r)&&delete m[c.p.treeReader[r]];void 0!==p&&(c.p.data[p]=b.extend(!0,c.p.data[p],m));m=null}}catch(B){k=!1}k&&("string"===n?b(l).addClass(e):null!==e&&"object"===n&&b(l).css(e),b(c).triggerHandler("jqGridAfterGridComplete"))});return k},addRowData:function(g,f,e,d){-1==["first","last","before","after"].indexOf(e)&&(e="last");var k=!1,a,c,h,l,n,m,q,p,r="",B,F,T,K,Z,U;f&&(b.isArray(f)?(B=!0,F=g):(f=[f],B=!1),
            this.each(function(){var V=f.length;n=!0===this.p.rownumbers?1:0;h=!0===this.p.multiselect?1:0;l=!0===this.p.subGrid?1:0;B||(void 0!==g?g=String(g):(g=b.jgrid.randId(),!1!==this.p.keyName&&(F=this.p.keyName,void 0!==f[0][F]&&(g=f[0][F]))));T=this.p.altclass;for(var S=0,O="",P={},aa=b.isFunction(this.p.afterInsertRow)?!0:!1;S<V;){K=f[S];c=[];if(B){try{g=K[F],void 0===g&&(g=b.jgrid.randId())}catch(ba){g=b.jgrid.randId()}O=!0===this.p.altRows?0===(this.rows.length-1)%2?T:"":""}U=g;g=this.p.idPrefix+
                g;n&&(r=this.formatCol(0,1,"",null,g,!0),c[c.length]='<td role="gridcell" class="ui-state-default jqgrid-rownum" '+r+">0</td>");h&&(p='<input role="checkbox" type="checkbox" id="jqg_'+this.p.id+"_"+g+'" class="cbox"/>',r=this.formatCol(n,1,"",null,g,!0),c[c.length]='<td role="gridcell" '+r+">"+p+"</td>");l&&(c[c.length]=b(this).jqGrid("addSubGridCell",h+n,1));for(q=h+l+n;q<this.p.colModel.length;q++)Z=this.p.colModel[q],a=Z.name,P[a]=K[a],p=this.formatter(g,b.jgrid.getAccessor(K,a),q,K),r=this.formatCol(q,
                1,p,K,g,P),c[c.length]='<td role="gridcell" '+r+">"+p+"</td>";c.unshift(this.constructTr(g,!1,O,P,K,!1));c[c.length]="</tr>";if(0===this.rows.length)b("table:first",this.grid.bDiv).append(c.join(""));else switch(e){case "last":b(this.rows[this.rows.length-1]).after(c.join(""));m=this.rows.length-1;break;case "first":b(this.rows[0]).after(c.join(""));m=1;break;case "after":if(m=b(this).jqGrid("getGridRowById",d))b(this.rows[m.rowIndex+1]).hasClass("ui-subgrid")?b(this.rows[m.rowIndex+1]).after(c):
                b(m).after(c.join("")),m=m.rowIndex+1;break;case "before":if(m=b(this).jqGrid("getGridRowById",d))b(m).before(c.join("")),m=m.rowIndex-1}!0===this.p.subGrid&&b(this).jqGrid("addSubGrid",h+n,m);this.p.records++;this.p.reccount++;b(this).triggerHandler("jqGridAfterInsertRow",[g,K,K]);aa&&this.p.afterInsertRow.call(this,g,K,K);S++;"local"===this.p.datatype&&(P[this.p.localReader.id]=U,this.p._index[U]=this.p.data.length,this.p.data.push(P),P={})}!0!==this.p.altRows||B||("last"===e?1===(this.rows.length-
                1)%2&&b(this.rows[this.rows.length-1]).addClass(T):b(this.rows).each(function(a){1===a%2?b(this).addClass(T):b(this).removeClass(T)}));this.updatepager(!0,!0);k=!0}));return k},footerData:function(g,f,e){function d(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0}var k,a=!1,c={},h;void 0==g&&(g="get");"boolean"!==typeof e&&(e=!0);g=g.toLowerCase();this.each(function(){var l=this,n;if(!l.grid||!l.p.footerrow||"set"===g&&d(f))return!1;a=!0;b(this.p.colModel).each(function(d){k=this.name;"set"===
        g?void 0!==f[k]&&(n=e?l.formatter("",f[k],d,f,"edit"):f[k],h=this.title?{title:b.jgrid.stripHtml(n)}:{},b("tr.footrow td:eq("+d+")",l.grid.sDiv).html(n).attr(h),a=!0):"get"===g&&(c[k]=b("tr.footrow td:eq("+d+")",l.grid.sDiv).html())})});return"get"===g?c:a},showHideCol:function(g,f){return this.each(function(){var e=this,d=!1,k=b.jgrid.cell_width?0:e.p.cellLayout,a;if(e.grid){"string"===typeof g&&(g=[g]);f="none"!==f?"":"none";var c=""===f?!0:!1,h=e.p.groupHeader&&("object"===typeof e.p.groupHeader||
            b.isFunction(e.p.groupHeader));h&&b(e).jqGrid("destroyGroupHeader",!1);b(this.p.colModel).each(function(h){if(-1!==b.inArray(this.name,g)&&this.hidden===c){if(!0===e.p.frozenColumns&&!0===this.frozen)return!0;b("tr[role=row]",e.grid.hDiv).each(function(){b(this.cells[h]).css("display",f)});b(e.rows).each(function(){b(this).hasClass("jqgroup")||b(this.cells[h]).css("display",f)});e.p.footerrow&&b("tr.footrow td:eq("+h+")",e.grid.sDiv).css("display",f);a=parseInt(this.width,10);e.p.tblwidth="none"===
        f?e.p.tblwidth-(a+k):e.p.tblwidth+(a+k);this.hidden=!c;d=!0;b(e).triggerHandler("jqGridShowHideCol",[c,this.name,h])}});!0===d&&(!0!==e.p.shrinkToFit||isNaN(e.p.height)||(e.p.tblwidth+=parseInt(e.p.scrollOffset,10)),b(e).jqGrid("setGridWidth",!0===e.p.shrinkToFit?e.p.tblwidth:e.p.width));h&&b(e).jqGrid("setGroupHeaders",e.p.groupHeader)}})},hideCol:function(g){return this.each(function(){b(this).jqGrid("showHideCol",g,"none")})},showCol:function(g){return this.each(function(){b(this).jqGrid("showHideCol",
            g,"")})},remapColumns:function(g,f,e){function d(a){var d;d=a.length?b.makeArray(a):b.extend({},a);b.each(g,function(b){a[b]=d[this]})}function k(a,d){b(">tr"+(d||""),a).each(function(){var a=this,c=b.makeArray(a.cells);b.each(g,function(){var b=c[this];b&&a.appendChild(b)})})}var a=this.get(0);d(a.p.colModel);d(a.p.colNames);d(a.grid.headers);k(b("thead:first",a.grid.hDiv),e&&":not(.ui-jqgrid-labels)");f&&k(b("#"+b.jgrid.jqID(a.p.id)+" tbody:first"),".jqgfirstrow, tr.jqgrow, tr.jqfoot");a.p.footerrow&&
        k(b("tbody:first",a.grid.sDiv));a.p.remapColumns&&(a.p.remapColumns.length?d(a.p.remapColumns):a.p.remapColumns=b.makeArray(g));a.p.lastsort=b.inArray(a.p.lastsort,g);a.p.treeGrid&&(a.p.expColInd=b.inArray(a.p.expColInd,g));b(a).triggerHandler("jqGridRemapColumns",[g,f,e])},setGridWidth:function(g,f){return this.each(function(){if(this.grid){var e=this,d,k=0,a=b.jgrid.cell_width?0:e.p.cellLayout,c,h=0,l=!1,n=e.p.scrollOffset,m,q=0,p;"boolean"!==typeof f&&(f=e.p.shrinkToFit);if(!isNaN(g)){g=parseInt(g,
            10);e.grid.width=e.p.width=g;b("#gbox_"+b.jgrid.jqID(e.p.id)).css("width",g+"px");b("#gview_"+b.jgrid.jqID(e.p.id)).css("width",g+"px");b(e.grid.bDiv).css("width",g+"px");b(e.grid.hDiv).css("width",g+"px");e.p.pager&&b(e.p.pager).css("width",g+"px");e.p.toppager&&b(e.p.toppager).css("width",g+"px");!0===e.p.toolbar[0]&&(b(e.grid.uDiv).css("width",g+"px"),"both"===e.p.toolbar[1]&&b(e.grid.ubDiv).css("width",g+"px"));e.p.footerrow&&b(e.grid.sDiv).css("width",g+"px");!1===f&&!0===e.p.forceFit&&(e.p.forceFit=
            !1);if(!0===f){b.each(e.p.colModel,function(){!1===this.hidden&&(d=this.widthOrg,k+=d+a,this.fixed?q+=d+a:h++)});if(0===h)return;e.p.tblwidth=k;m=g-a*h-q;!isNaN(e.p.height)&&(b(e.grid.bDiv)[0].clientHeight<b(e.grid.bDiv)[0].scrollHeight||1===e.rows.length)&&(l=!0,m-=n);var k=0,r=0<e.grid.cols.length;b.each(e.p.colModel,function(b){!1!==this.hidden||this.fixed||(d=this.widthOrg,d=Math.round(m*d/(e.p.tblwidth-a*h-q)),0>d||(this.width=d,k+=d,e.grid.headers[b].width=d,e.grid.headers[b].el.style.width=
            d+"px",e.p.footerrow&&(e.grid.footers[b].style.width=d+"px"),r&&(e.grid.cols[b].style.width=d+"px"),c=b))});if(!c)return;p=0;l?g-q-(k+a*h)!==n&&(p=g-q-(k+a*h)-n):1!==Math.abs(g-q-(k+a*h))&&(p=g-q-(k+a*h));e.p.colModel[c].width+=p;e.p.tblwidth=k+p+a*h+q;e.p.tblwidth>g?(l=e.p.tblwidth-parseInt(g,10),e.p.tblwidth=g,d=e.p.colModel[c].width-=l):d=e.p.colModel[c].width;e.grid.headers[c].width=d;e.grid.headers[c].el.style.width=d+"px";r&&(e.grid.cols[c].style.width=d+"px");e.p.footerrow&&(e.grid.footers[c].style.width=
            d+"px")}e.p.tblwidth&&(b("table:first",e.grid.bDiv).css("width",e.p.tblwidth+"px"),b("table:first",e.grid.hDiv).css("width",e.p.tblwidth+"px"),e.grid.hDiv.scrollLeft=e.grid.bDiv.scrollLeft,e.p.footerrow&&b("table:first",e.grid.sDiv).css("width",e.p.tblwidth+"px"))}}})},setGridHeight:function(g){return this.each(function(){if(this.grid){var f=b(this.grid.bDiv);f.css({height:g+(isNaN(g)?"":"px")});!0===this.p.frozenColumns&&b("#"+b.jgrid.jqID(this.p.id)+"_frozen").parent().height(f.height()-16);this.p.height=
            g;this.p.scroll&&this.grid.populateVisible()}})},setCaption:function(g){return this.each(function(){this.p.caption=g;b("span.ui-jqgrid-title, span.ui-jqgrid-title-rtl",this.grid.cDiv).html(g);b(this.grid.cDiv).show();b(this.grid.hDiv).removeClass("ui-corner-top")})},setLabel:function(g,f,e,d){return this.each(function(){var k=-1;if(this.grid&&void 0!==g&&(b(this.p.colModel).each(function(a){if(this.name===g)return k=a,!1}),0<=k)){var a=b("tr.ui-jqgrid-labels th:eq("+k+")",this.grid.hDiv);if(f){var c=
            b(".s-ico",a);b("[id^=jqgh_]",a).empty().html(f).append(c);this.p.colNames[k]=f}e&&("string"===typeof e?b(a).addClass(e):b(a).css(e));"object"===typeof d&&b(a).attr(d)}})},setCell:function(g,f,e,d,k,a){return this.each(function(){var c=-1,h,l;if(this.grid&&(isNaN(f)?b(this.p.colModel).each(function(a){if(this.name===f)return c=a,!1}):c=parseInt(f,10),0<=c&&(h=b(this).jqGrid("getGridRowById",g)))){var n=b("td:eq("+c+")",h);l=0;var m=[];if(""!==e||!0===a){for(;l<h.cells.length;)m.push(h.cells[l].innerHTML),
            l++;h=this.formatter(g,e,c,m,"edit");l=this.p.colModel[c].title?{title:b.jgrid.stripHtml(h)}:{};this.p.treeGrid&&0<b(".tree-wrap",b(n)).length?b("span",b(n)).html(h).attr(l):b(n).html(h).attr(l);"local"===this.p.datatype&&(h=this.p.colModel[c],e=h.formatter&&"string"===typeof h.formatter&&"date"===h.formatter?b.unformat.date.call(this,e,h):e,l=this.p._index[b.jgrid.stripPref(this.p.idPrefix,g)],void 0!==l&&(this.p.data[l][h.name]=e))}"string"===typeof d?b(n).addClass(d):d&&b(n).css(d);"object"===
        typeof k&&b(n).attr(k)}})},getCell:function(g,f){var e=!1;this.each(function(){var d=-1;if(this.grid&&(isNaN(f)?b(this.p.colModel).each(function(a){if(this.name===f)return d=a,!1}):d=parseInt(f,10),0<=d)){var k=b(this).jqGrid("getGridRowById",g);if(k)try{e=b.unformat.call(this,b("td:eq("+d+")",k),{rowId:k.id,colModel:this.p.colModel[d]},d)}catch(a){e=b.jgrid.htmlDecode(b("td:eq("+d+")",k).html())}}});return e},getCol:function(g,f,e){var d=[],k,a=0,c,h,l;f="boolean"!==typeof f?!1:f;void 0===e&&(e=
            !1);this.each(function(){var n=-1;if(this.grid&&(isNaN(g)?b(this.p.colModel).each(function(a){if(this.name===g)return n=a,!1}):n=parseInt(g,10),0<=n)){var m=this.rows.length,q=0,p=0;if(m&&0<m){for(;q<m;){if(b(this.rows[q]).hasClass("jqgrow")){try{k=b.unformat.call(this,b(this.rows[q].cells[n]),{rowId:this.rows[q].id,colModel:this.p.colModel[n]},n)}catch(r){k=b.jgrid.htmlDecode(this.rows[q].cells[n].innerHTML)}e?(l=parseFloat(k),isNaN(l)||(a+=l,void 0===h&&(h=c=l),c=Math.min(c,l),h=Math.max(h,l),p++)):
            f?d.push({id:this.rows[q].id,value:k}):d.push(k)}q++}if(e)switch(e.toLowerCase()){case "sum":d=a;break;case "avg":d=a/p;break;case "count":d=m-1;break;case "min":d=c;break;case "max":d=h}}}});return d},clearGridData:function(g){return this.each(function(){if(this.grid){"boolean"!==typeof g&&(g=!1);if(this.p.deepempty)b("#"+b.jgrid.jqID(this.p.id)+" tbody:first tr:gt(0)").remove();else{var f=b("#"+b.jgrid.jqID(this.p.id)+" tbody:first tr:first")[0];b("#"+b.jgrid.jqID(this.p.id)+" tbody:first").empty().append(f)}this.p.footerrow&&
        g&&b(".ui-jqgrid-ftable td",this.grid.sDiv).html("&#160;");this.p.selrow=null;this.p.selarrrow=[];this.p.savedRow=[];this.p.records=0;this.p.page=1;this.p.lastpage=0;this.p.reccount=0;this.p.data=[];this.p._index={};this.updatepager(!0,!1)}})},getInd:function(g,f){var e=!1,d;this.each(function(){(d=b(this).jqGrid("getGridRowById",g))&&(e=!0===f?d:d.rowIndex)});return e},bindKeys:function(g){var f=b.extend({onEnter:null,onSpace:null,onLeftKey:null,onRightKey:null,scrollingRows:!0},g||{});return this.each(function(){var e=
            this;b("body").is("[role]")||b("body").attr("role","application");e.p.scrollrows=f.scrollingRows;b(e).keydown(function(d){var g=b(e).find("tr[tabindex=0]")[0],a,c,h,l=e.p.treeReader.expanded_field;if(g)if(h=e.p._index[b.jgrid.stripPref(e.p.idPrefix,g.id)],37===d.keyCode||38===d.keyCode||39===d.keyCode||40===d.keyCode){if(38===d.keyCode){c=g.previousSibling;a="";if(c)if(b(c).is(":hidden"))for(;c;){if(c=c.previousSibling,!b(c).is(":hidden")&&b(c).hasClass("jqgrow")){a=c.id;break}}else a=c.id;b(e).jqGrid("setSelection",
            a,!0,d);d.preventDefault()}if(40===d.keyCode){c=g.nextSibling;a="";if(c)if(b(c).is(":hidden"))for(;c;){if(c=c.nextSibling,!b(c).is(":hidden")&&b(c).hasClass("jqgrow")){a=c.id;break}}else a=c.id;b(e).jqGrid("setSelection",a,!0,d);d.preventDefault()}37===d.keyCode&&(e.p.treeGrid&&e.p.data[h][l]&&b(g).find("div.treeclick").trigger("click"),b(e).triggerHandler("jqGridKeyLeft",[e.p.selrow]),b.isFunction(f.onLeftKey)&&f.onLeftKey.call(e,e.p.selrow));39===d.keyCode&&(e.p.treeGrid&&!e.p.data[h][l]&&b(g).find("div.treeclick").trigger("click"),
            b(e).triggerHandler("jqGridKeyRight",[e.p.selrow]),b.isFunction(f.onRightKey)&&f.onRightKey.call(e,e.p.selrow))}else 13===d.keyCode?(b(e).triggerHandler("jqGridKeyEnter",[e.p.selrow]),b.isFunction(f.onEnter)&&f.onEnter.call(e,e.p.selrow)):32===d.keyCode&&(b(e).triggerHandler("jqGridKeySpace",[e.p.selrow]),b.isFunction(f.onSpace)&&f.onSpace.call(e,e.p.selrow))})})},unbindKeys:function(){return this.each(function(){b(this).unbind("keydown")})},getLocalRow:function(g){var f=!1,e;this.each(function(){void 0!==
        g&&(e=this.p._index[b.jgrid.stripPref(this.p.idPrefix,g)],0<=e&&(f=this.p.data[e]))});return f},progressBar:function(g){g=b.extend({htmlcontent:"",method:"hide",loadtype:"disable"},g||{});return this.each(function(){var f="show"===g.method?!0:!1;""!==g.htmlcontent&&b("#load_"+b.jgrid.jqID(this.p.id)).html(g.htmlcontent);switch(g.loadtype){case "enable":b("#load_"+b.jgrid.jqID(this.p.id)).toggle(f);break;case "block":b("#lui_"+b.jgrid.jqID(this.p.id)).toggle(f),b("#load_"+b.jgrid.jqID(this.p.id)).toggle(f)}})}})})(jQuery);
    (function(a){a.fmatter={};a.extend(a.fmatter,{isBoolean:function(a){return"boolean"===typeof a},isObject:function(c){return c&&("object"===typeof c||a.isFunction(c))||!1},isString:function(a){return"string"===typeof a},isNumber:function(a){return"number"===typeof a&&isFinite(a)},isValue:function(a){return this.isObject(a)||this.isString(a)||this.isNumber(a)||this.isBoolean(a)},isEmpty:function(c){if(!this.isString(c)&&this.isValue(c))return!1;if(!this.isValue(c))return!0;c=a.trim(c).replace(/\&nbsp\;/ig,
            "").replace(/\&#160\;/ig,"");return""===c}});a.fn.fmatter=function(c,b,d,e,f){var g=b;d=a.extend({},a.jgrid.formatter,d);try{g=a.fn.fmatter[c].call(this,b,d,e,f)}catch(h){}return g};a.fmatter.util={NumberFormat:function(c,b){a.fmatter.isNumber(c)||(c*=1);if(a.fmatter.isNumber(c)){var d=0>c,e=String(c),f=b.decimalSeparator||".",g;if(a.fmatter.isNumber(b.decimalPlaces)){var h=b.decimalPlaces,e=Math.pow(10,h),e=String(Math.round(c*e)/e);g=e.lastIndexOf(".");if(0<h)for(0>g?(e+=f,g=e.length-1):"."!==f&&
            (e=e.replace(".",f));e.length-1-g<h;)e+="0"}if(b.thousandsSeparator){h=b.thousandsSeparator;g=e.lastIndexOf(f);g=-1<g?g:e.length;var f=e.substring(g),l=-1,k;for(k=g;0<k;k--)l++,0===l%3&&k!==g&&(!d||1<k)&&(f=h+f),f=e.charAt(k-1)+f;e=f}e=b.prefix?b.prefix+e:e;return e=b.suffix?e+b.suffix:e}return c}};a.fn.fmatter.defaultFormat=function(c,b){return a.fmatter.isValue(c)&&""!==c?c:b.defaultValue||"&#160;"};a.fn.fmatter.email=function(c,b){return a.fmatter.isEmpty(c)?a.fn.fmatter.defaultFormat(c,b):'<a href="mailto:'+
        c+'">'+c+"</a>"};a.fn.fmatter.checkbox=function(c,b){var d=a.extend({},b.checkbox),e;void 0!==b.colModel&&void 0!==b.colModel.formatoptions&&(d=a.extend({},d,b.colModel.formatoptions));e=!0===d.disabled?'disabled="disabled"':"";if(a.fmatter.isEmpty(c)||void 0===c)c=a.fn.fmatter.defaultFormat(c,d);c=String(c);c=(c+"").toLowerCase();return'<input type="checkbox" '+(0>c.search(/(false|f|0|no|n|off|undefined)/i)?" checked='checked' ":"")+' value="'+c+'" offval="no" '+e+"/>"};a.fn.fmatter.link=function(c,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               b){var d={target:b.target},e="";void 0!==b.colModel&&void 0!==b.colModel.formatoptions&&(d=a.extend({},d,b.colModel.formatoptions));d.target&&(e="target="+d.target);return a.fmatter.isEmpty(c)?a.fn.fmatter.defaultFormat(c,b):"<a "+e+' href="'+c+'">'+c+"</a>"};a.fn.fmatter.showlink=function(c,b){var d={baseLinkUrl:b.baseLinkUrl,showAction:b.showAction,addParam:b.addParam||"",target:b.target,idName:b.idName},e="";void 0!==b.colModel&&void 0!==b.colModel.formatoptions&&(d=a.extend({},d,b.colModel.formatoptions));
        d.target&&(e="target="+d.target);d=d.baseLinkUrl+d.showAction+"?"+d.idName+"="+b.rowId+d.addParam;return a.fmatter.isString(c)||a.fmatter.isNumber(c)?"<a "+e+' href="'+d+'">'+c+"</a>":a.fn.fmatter.defaultFormat(c,b)};a.fn.fmatter.integer=function(c,b){var d=a.extend({},b.integer);void 0!==b.colModel&&void 0!==b.colModel.formatoptions&&(d=a.extend({},d,b.colModel.formatoptions));return a.fmatter.isEmpty(c)?d.defaultValue:a.fmatter.util.NumberFormat(c,d)};a.fn.fmatter.number=function(c,b){var d=a.extend({},
        b.number);void 0!==b.colModel&&void 0!==b.colModel.formatoptions&&(d=a.extend({},d,b.colModel.formatoptions));return a.fmatter.isEmpty(c)?d.defaultValue:a.fmatter.util.NumberFormat(c,d)};a.fn.fmatter.currency=function(c,b){var d=a.extend({},b.currency);void 0!==b.colModel&&void 0!==b.colModel.formatoptions&&(d=a.extend({},d,b.colModel.formatoptions));return a.fmatter.isEmpty(c)?d.defaultValue:a.fmatter.util.NumberFormat(c,d)};a.fn.fmatter.date=function(c,b,d,e){d=a.extend({},b.date);void 0!==b.colModel&&
    void 0!==b.colModel.formatoptions&&(d=a.extend({},d,b.colModel.formatoptions));return d.reformatAfterEdit||"edit"!==e?a.fmatter.isEmpty(c)?a.fn.fmatter.defaultFormat(c,b):a.jgrid.parseDate(d.srcformat,c,d.newformat,d):a.fn.fmatter.defaultFormat(c,b)};a.fn.fmatter.select=function(c,b){c=String(c);var d=!1,e=[],f,g;void 0!==b.colModel.formatoptions?(d=b.colModel.formatoptions.value,f=void 0===b.colModel.formatoptions.separator?":":b.colModel.formatoptions.separator,g=void 0===b.colModel.formatoptions.delimiter?
        ";":b.colModel.formatoptions.delimiter):void 0!==b.colModel.editoptions&&(d=b.colModel.editoptions.value,f=void 0===b.colModel.editoptions.separator?":":b.colModel.editoptions.separator,g=void 0===b.colModel.editoptions.delimiter?";":b.colModel.editoptions.delimiter);if(d){var h=!0===(null!=b.colModel.editoptions&&!0===b.colModel.editoptions.multiple)?!0:!1,l=[];h&&(l=c.split(","),l=a.map(l,function(b){return a.trim(b)}));if(a.fmatter.isString(d)){var k=d.split(g),m=0,n;for(n=0;n<k.length;n++)if(g=
        k[n].split(f),2<g.length&&(g[1]=a.map(g,function(a,b){if(0<b)return a}).join(f)),h)-1<a.inArray(g[0],l)&&(e[m]=g[1],m++);else if(a.trim(g[0])===a.trim(c)){e[0]=g[1];break}}else a.fmatter.isObject(d)&&(h?e=a.map(l,function(a){return d[a]}):e[0]=d[c]||"")}c=e.join(", ");return""===c?a.fn.fmatter.defaultFormat(c,b):c};a.fn.fmatter.rowactions=function(c){var b=a(this).closest("tr.jqgrow"),d=b.attr("id"),e=a(this).closest("table.ui-jqgrid-btable").attr("id").replace(/_frozen([^_]*)$/,"$1"),e=a("#"+e),
        f=e[0],g=f.p,h=g.colModel[a.jgrid.getCellIndex(this)],l=h.frozen?a("tr#"+d+" td:eq("+a.jgrid.getCellIndex(this)+") > div",e):a(this).parent(),k={extraparam:{}},m=function(b){a.isFunction(k.afterRestore)&&k.afterRestore.call(f,b);l.find("div.ui-inline-edit,div.ui-inline-del").show();l.find("div.ui-inline-save,div.ui-inline-cancel").hide()};void 0!==h.formatoptions&&(k=a.extend(k,h.formatoptions));void 0!==g.editOptions&&(k.editOptions=g.editOptions);void 0!==g.delOptions&&(k.delOptions=g.delOptions);
        b.hasClass("jqgrid-new-row")&&(k.extraparam[g.prmNames.oper]=g.prmNames.addoper);b={keys:k.keys,oneditfunc:k.onEdit,successfunc:k.onSuccess,url:k.url,extraparam:k.extraparam,aftersavefunc:function(b,c){a.isFunction(k.afterSave)&&k.afterSave.call(f,b,c);l.find("div.ui-inline-edit,div.ui-inline-del").show();l.find("div.ui-inline-save,div.ui-inline-cancel").hide()},errorfunc:k.onError,afterrestorefunc:m,restoreAfterError:k.restoreAfterError,mtype:k.mtype};switch(c){case "edit":e.jqGrid("editRow",d,b);
            l.find("div.ui-inline-edit,div.ui-inline-del").hide();l.find("div.ui-inline-save,div.ui-inline-cancel").show();e.triggerHandler("jqGridAfterGridComplete");break;case "save":e.jqGrid("saveRow",d,b)&&(l.find("div.ui-inline-edit,div.ui-inline-del").show(),l.find("div.ui-inline-save,div.ui-inline-cancel").hide(),e.triggerHandler("jqGridAfterGridComplete"));break;case "cancel":e.jqGrid("restoreRow",d,m);l.find("div.ui-inline-edit,div.ui-inline-del").show();l.find("div.ui-inline-save,div.ui-inline-cancel").hide();
            e.triggerHandler("jqGridAfterGridComplete");break;case "del":e.jqGrid("delGridRow",d,k.delOptions);break;case "formedit":e.jqGrid("setSelection",d),e.jqGrid("editGridRow",d,k.editOptions)}};a.fn.fmatter.actions=function(c,b){var d={keys:!1,editbutton:!0,delbutton:!0,editformbutton:!1},e=b.rowId,f="";void 0!==b.colModel.formatoptions&&(d=a.extend(d,b.colModel.formatoptions));if(void 0===e||a.fmatter.isEmpty(e))return"";d.editformbutton?f+="<div title='"+a.jgrid.nav.edittitle+"' style='float:left;cursor:pointer;' class='ui-pg-div ui-inline-edit' "+
        ("id='jEditButton_"+e+"' onclick=jQuery.fn.fmatter.rowactions.call(this,'formedit'); onmouseover=jQuery(this).addClass('ui-state-hover'); onmouseout=jQuery(this).removeClass('ui-state-hover'); ")+"><span class='ui-icon ui-icon-pencil'></span></div>":d.editbutton&&(f+="<div title='"+a.jgrid.nav.edittitle+"' style='float:left;cursor:pointer;' class='ui-pg-div ui-inline-edit' "+("id='jEditButton_"+e+"' onclick=jQuery.fn.fmatter.rowactions.call(this,'edit'); onmouseover=jQuery(this).addClass('ui-state-hover'); onmouseout=jQuery(this).removeClass('ui-state-hover') ")+
        "><span class='ui-icon ui-icon-pencil'></span></div>");d.delbutton&&(f+="<div title='"+a.jgrid.nav.deltitle+"' style='float:left;margin-left:5px;' class='ui-pg-div ui-inline-del' "+("id='jDeleteButton_"+e+"' onclick=jQuery.fn.fmatter.rowactions.call(this,'del'); onmouseover=jQuery(this).addClass('ui-state-hover'); onmouseout=jQuery(this).removeClass('ui-state-hover'); ")+"><span class='ui-icon ui-icon-trash'></span></div>");f+="<div title='"+a.jgrid.edit.bSubmit+"' style='float:left;display:none' class='ui-pg-div ui-inline-save' "+
        ("id='jSaveButton_"+e+"' onclick=jQuery.fn.fmatter.rowactions.call(this,'save'); onmouseover=jQuery(this).addClass('ui-state-hover'); onmouseout=jQuery(this).removeClass('ui-state-hover'); ")+"><span class='ui-icon ui-icon-disk'></span></div>";f+="<div title='"+a.jgrid.edit.bCancel+"' style='float:left;display:none;margin-left:5px;' class='ui-pg-div ui-inline-cancel' "+("id='jCancelButton_"+e+"' onclick=jQuery.fn.fmatter.rowactions.call(this,'cancel'); onmouseover=jQuery(this).addClass('ui-state-hover'); onmouseout=jQuery(this).removeClass('ui-state-hover'); ")+
        "><span class='ui-icon ui-icon-cancel'></span></div>";return"<div style='margin-left:8px;'>"+f+"</div>"};a.unformat=function(c,b,d,e){var f,g=b.colModel.formatter,h=b.colModel.formatoptions||{},l=/([\.\*\_\'\(\)\{\}\+\?\\])/g,k=b.colModel.unformat||a.fn.fmatter[g]&&a.fn.fmatter[g].unformat;if(void 0!==k&&a.isFunction(k))f=k.call(this,a(c).text(),b,c);else if(void 0!==g&&a.fmatter.isString(g))switch(f=a.jgrid.formatter||{},g){case "integer":h=a.extend({},f.integer,h);b=h.thousandsSeparator.replace(l,
        "\\$1");b=RegExp(b,"g");f=a(c).text().replace(b,"");break;case "number":h=a.extend({},f.number,h);b=h.thousandsSeparator.replace(l,"\\$1");b=RegExp(b,"g");f=a(c).text().replace(b,"").replace(h.decimalSeparator,".");break;case "currency":h=a.extend({},f.currency,h);b=h.thousandsSeparator.replace(l,"\\$1");b=RegExp(b,"g");f=a(c).text();h.prefix&&h.prefix.length&&(f=f.substr(h.prefix.length));h.suffix&&h.suffix.length&&(f=f.substr(0,f.length-h.suffix.length));f=f.replace(b,"").replace(h.decimalSeparator,
        ".");break;case "checkbox":h=b.colModel.editoptions?b.colModel.editoptions.value.split(":"):["Yes","No"];f=a("input",c).is(":checked")?h[0]:h[1];break;case "select":f=a.unformat.select(c,b,d,e);break;case "actions":return"";default:f=a(c).text()}return void 0!==f?f:!0===e?a(c).text():a.jgrid.htmlDecode(a(c).html())};a.unformat.select=function(c,b,d,e){d=[];c=a(c).text();if(!0===e)return c;e=a.extend({},void 0!==b.colModel.formatoptions?b.colModel.formatoptions:b.colModel.editoptions);b=void 0===e.separator?
        ":":e.separator;var f=void 0===e.delimiter?";":e.delimiter;if(e.value){var g=e.value;e=!0===e.multiple?!0:!1;var h=[];e&&(h=c.split(","),h=a.map(h,function(b){return a.trim(b)}));if(a.fmatter.isString(g)){var l=g.split(f),k=0,m;for(m=0;m<l.length;m++)if(f=l[m].split(b),2<f.length&&(f[1]=a.map(f,function(a,b){if(0<b)return a}).join(b)),e)-1<a.inArray(f[1],h)&&(d[k]=f[0],k++);else if(a.trim(f[1])===a.trim(c)){d[0]=f[0];break}}else if(a.fmatter.isObject(g)||a.isArray(g))e||(h[0]=c),d=a.map(h,function(b){var c;
        a.each(g,function(a,d){if(d===b)return c=a,!1});if(void 0!==c)return c});return d.join(", ")}return c||""};a.unformat.date=function(c,b){var d=a.jgrid.formatter.date||{};void 0!==b.formatoptions&&(d=a.extend({},d,b.formatoptions));return a.fmatter.isEmpty(c)?a.fn.fmatter.defaultFormat(c,b):a.jgrid.parseDate(d.newformat,c,d.srcformat,d)}})(jQuery);
    (function(a){a.jgrid.extend({getColProp:function(a){var c={},e=this[0];if(!e.grid)return!1;var e=e.p.colModel,k;for(k=0;k<e.length;k++)if(e[k].name===a){c=e[k];break}return c},setColProp:function(b,c){return this.each(function(){if(this.grid&&c){var e=this.p.colModel,k;for(k=0;k<e.length;k++)if(e[k].name===b){a.extend(!0,this.p.colModel[k],c);break}}})},sortGrid:function(a,c,e){return this.each(function(){var k=-1,d,h=!1;if(this.grid){a||(a=this.p.sortname);for(d=0;d<this.p.colModel.length;d++)if(this.p.colModel[d].index===
            a||this.p.colModel[d].name===a){k=d;!0===this.p.frozenColumns&&!0===this.p.colModel[d].frozen&&(h=this.grid.fhDiv.find("#"+this.p.id+"_"+a));break}-1!==k&&(d=this.p.colModel[k].sortable,h||(h=this.grid.headers[k].el),"boolean"!==typeof d&&(d=!0),"boolean"!==typeof c&&(c=!1),d&&this.sortData("jqgh_"+this.p.id+"_"+a,k,c,e,h))}})},clearBeforeUnload:function(){return this.each(function(){var b=this.grid;a.isFunction(b.emptyRows)&&b.emptyRows.call(this,!0,!0);a(document).unbind("mouseup.jqGrid"+this.p.id);
            a(b.hDiv).unbind("mousemove");a(this).unbind();b.dragEnd=null;b.dragMove=null;b.dragStart=null;b.emptyRows=null;b.populate=null;b.populateVisible=null;b.scrollGrid=null;b.selectionPreserver=null;b.bDiv=null;b.cDiv=null;b.hDiv=null;b.cols=null;var c,e=b.headers.length;for(c=0;c<e;c++)b.headers[c].el=null;this.grid=this.addJSONData=this.addXmlData=this.formatter=this.constructTr=this.setHeadCheckBox=this.refreshIndex=this.updatepager=this.sortData=this.formatCol=null})},GridDestroy:function(){return this.each(function(){if(this.grid){this.p.pager&&
        a(this.p.pager).remove();try{a(this).jqGrid("clearBeforeUnload"),a("#gbox_"+a.jgrid.jqID(this.id)).remove(),a("#alertmod_"+a.jgrid.jqID(this.id)).remove()}catch(b){}}})},GridUnload:function(){return this.each(function(){if(this.grid){var b=a(this).attr("id"),c=a(this).attr("class");this.p.pager&&a(this.p.pager).empty().removeClass("ui-state-default ui-jqgrid-pager ui-corner-bottom");var e=document.createElement("table");a(e).attr({id:b});e.className=c;b=a.jgrid.jqID(this.id);a(e).removeClass("ui-jqgrid-btable");
            1===a(this.p.pager).parents("#gbox_"+b).length?(a(e).insertBefore("#gbox_"+b).show(),a(this.p.pager).insertBefore("#gbox_"+b)):a(e).insertBefore("#gbox_"+b).show();a(this).jqGrid("clearBeforeUnload");a("#gbox_"+b).remove()}})},setGridState:function(b){return this.each(function(){this.grid&&("hidden"===b?(a(".ui-jqgrid-bdiv, .ui-jqgrid-hdiv","#gview_"+a.jgrid.jqID(this.p.id)).slideUp("fast"),this.p.pager&&a(this.p.pager).slideUp("fast"),this.p.toppager&&a(this.p.toppager).slideUp("fast"),!0===this.p.toolbar[0]&&
        ("both"===this.p.toolbar[1]&&a(this.grid.ubDiv).slideUp("fast"),a(this.grid.uDiv).slideUp("fast")),this.p.footerrow&&a(".ui-jqgrid-sdiv","#gbox_"+a.jgrid.jqID(this.p.id)).slideUp("fast"),a(".ui-jqgrid-titlebar-close span",this.grid.cDiv).removeClass("ui-icon-circle-triangle-n").addClass("ui-icon-circle-triangle-s"),this.p.gridstate="hidden"):"visible"===b&&(a(".ui-jqgrid-hdiv, .ui-jqgrid-bdiv","#gview_"+a.jgrid.jqID(this.p.id)).slideDown("fast"),this.p.pager&&a(this.p.pager).slideDown("fast"),this.p.toppager&&
        a(this.p.toppager).slideDown("fast"),!0===this.p.toolbar[0]&&("both"===this.p.toolbar[1]&&a(this.grid.ubDiv).slideDown("fast"),a(this.grid.uDiv).slideDown("fast")),this.p.footerrow&&a(".ui-jqgrid-sdiv","#gbox_"+a.jgrid.jqID(this.p.id)).slideDown("fast"),a(".ui-jqgrid-titlebar-close span",this.grid.cDiv).removeClass("ui-icon-circle-triangle-s").addClass("ui-icon-circle-triangle-n"),this.p.gridstate="visible"))})},filterToolbar:function(b){b=a.extend({autosearch:!0,autosearchDelay:500,searchOnEnter:!0,
            beforeSearch:null,afterSearch:null,beforeClear:null,afterClear:null,searchurl:"",stringResult:!1,groupOp:"AND",defaultSearch:"bw",searchOperators:!1,resetIcon:"x",operands:{eq:"==",ne:"!",lt:"<",le:"<=",gt:">",ge:">=",bw:"^",bn:"!^","in":"=",ni:"!=",ew:"|",en:"!@",cn:"~",nc:"!~",nu:"#",nn:"!#"}},a.jgrid.search,b||{});return this.each(function(){var c=this;if(!this.ftoolbar){var e=function(){var e={},f=0,g,m,k={},q;a.each(c.p.colModel,function(){var d=a("#gs_"+a.jgrid.jqID(this.name),!0===this.frozen&&
        !0===c.p.frozenColumns?c.grid.fhDiv:c.grid.hDiv);m=this.index||this.name;q=b.searchOperators?d.parent().prev().children("a").attr("soper")||b.defaultSearch:this.searchoptions&&this.searchoptions.sopt?this.searchoptions.sopt[0]:"select"===this.stype?"eq":b.defaultSearch;if((g="custom"===this.stype&&a.isFunction(this.searchoptions.custom_value)&&0<d.length&&"SPAN"===d[0].nodeName.toUpperCase()?this.searchoptions.custom_value.call(c,d.children(".customelement:first"),"get"):d.val())||"nu"===q||"nn"===
            q)e[m]=g,k[m]=q,f++;else try{delete c.p.postData[m]}catch(h){}});var h=0<f?!0:!1;if(!0===b.stringResult||"local"===c.p.datatype||!0===b.searchOperators){var l='{"groupOp":"'+b.groupOp+'","rules":[',d=0;a.each(e,function(a,b){0<d&&(l+=",");l+='{"field":"'+a+'",';l+='"op":"'+k[a]+'",';l+='"data":"'+(b+"").replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}';d++});l+="]}";a.extend(c.p.postData,{filters:l});a.each(["searchField","searchString","searchOper"],function(a,b){c.p.postData.hasOwnProperty(b)&&delete c.p.postData[b]})}else a.extend(c.p.postData,
            e);var r;c.p.searchurl&&(r=c.p.url,a(c).jqGrid("setGridParam",{url:c.p.searchurl}));var v="stop"===a(c).triggerHandler("jqGridToolbarBeforeSearch")?!0:!1;!v&&a.isFunction(b.beforeSearch)&&(v=b.beforeSearch.call(c));v||a(c).jqGrid("setGridParam",{search:h}).trigger("reloadGrid",[{page:1}]);r&&a(c).jqGrid("setGridParam",{url:r});a(c).triggerHandler("jqGridToolbarAfterSearch");a.isFunction(b.afterSearch)&&b.afterSearch.call(c)},k=function(d,f,g){a("#sopt_menu").remove();f=parseInt(f,10);g=parseInt(g,
            10)+18;f='<ul id="sopt_menu" class="ui-search-menu" role="menu" tabindex="0" style="font-size:'+(a(".ui-jqgrid-view").css("font-size")||"11px")+";left:"+f+"px;top:"+g+'px;">';g=a(d).attr("soper");var k,h=[],q,n=0,l=a(d).attr("colname");for(k=c.p.colModel.length;n<k&&c.p.colModel[n].name!==l;)n++;n=c.p.colModel[n];l=a.extend({},n.searchoptions);l.sopt||(l.sopt=[],l.sopt[0]="select"===n.stype?"eq":b.defaultSearch);a.each(b.odata,function(){h.push(this.oper)});for(n=0;n<l.sopt.length;n++)q=a.inArray(l.sopt[n],
            h),-1!==q&&(k=g===b.odata[q].oper?"ui-state-highlight":"",f+='<li class="ui-menu-item '+k+'" role="presentation"><a class="ui-corner-all g-menu-item" tabindex="0" role="menuitem" value="'+b.odata[q].oper+'" oper="'+b.operands[b.odata[q].oper]+'"><table cellspacing="0" cellpadding="0" border="0"><tr><td width="25px">'+b.operands[b.odata[q].oper]+"</td><td>"+b.odata[q].text+"</td></tr></table></a></li>");f+="</ul>";a("body").append(f);a("#sopt_menu").addClass("ui-menu ui-widget ui-widget-content ui-corner-all");
            a("#sopt_menu > li > a").hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}).click(function(f){f=a(this).attr("value");var g=a(this).attr("oper");a(c).triggerHandler("jqGridToolbarSelectOper",[f,g,d]);a("#sopt_menu").hide();a(d).text(g).attr("soper",f);!0===b.autosearch&&(g=a(d).parent().next().children()[0],(a(g).val()||"nu"===f||"nn"===f)&&e())})},d=a("<tr class='ui-search-toolbar' role='row'></tr>"),h;a.each(c.p.colModel,function(k){var f=this,
            g,m;m="";var x="=",q,n=a("<th role='columnheader' class='ui-state-default ui-th-column ui-th-"+c.p.direction+"'></th>"),l=a("<div style='position:relative;height:auto;padding-right:0.3em;padding-left:0.3em;'></div>"),p=a("<table class='ui-search-table' cellspacing='0'><tr><td class='ui-search-oper'></td><td class='ui-search-input'></td><td class='ui-search-clear'></td></tr></table>");!0===this.hidden&&a(n).css("display","none");this.search=!1===this.search?!1:!0;void 0===this.stype&&(this.stype="text");
            g=a.extend({},this.searchoptions||{});if(this.search){if(b.searchOperators){m=g.sopt?g.sopt[0]:"select"===f.stype?"eq":b.defaultSearch;for(q=0;q<b.odata.length;q++)if(b.odata[q].oper===m){x=b.operands[m]||"";break}m="<a title='"+(null!=g.searchtitle?g.searchtitle:b.operandTitle)+"' style='padding-right: 0.5em;' soper='"+m+"' class='soptclass' colname='"+this.name+"'>"+x+"</a>"}a("td:eq(0)",p).attr("colindex",k).append(m);void 0===g.clearSearch&&(g.clearSearch=!0);g.clearSearch?(m=b.resetTitle||"Clear Search Value",
                a("td:eq(2)",p).append("<a title='"+m+"' style='padding-right: 0.3em;padding-left: 0.3em;' class='clearsearchclass'>"+b.resetIcon+"</a>")):a("td:eq(2)",p).hide();switch(this.stype){case "select":if(m=this.surl||g.dataUrl)a(l).append(p),a.ajax(a.extend({url:m,dataType:"html",success:function(d){void 0!==g.buildSelect?(d=g.buildSelect(d))&&a("td:eq(1)",p).append(d):a("td:eq(1)",p).append(d);void 0!==g.defaultValue&&a("select",l).val(g.defaultValue);a("select",l).attr({name:f.index||f.name,id:"gs_"+
                        f.name});g.attr&&a("select",l).attr(g.attr);a("select",l).css({width:"100%"});a.jgrid.bindEv.call(c,a("select",l)[0],g);!0===b.autosearch&&a("select",l).change(function(){e();return!1});d=null}},a.jgrid.ajaxOptions,c.p.ajaxSelectOptions||{}));else{var r,v,u;f.searchoptions?(r=void 0===f.searchoptions.value?"":f.searchoptions.value,v=void 0===f.searchoptions.separator?":":f.searchoptions.separator,u=void 0===f.searchoptions.delimiter?";":f.searchoptions.delimiter):f.editoptions&&(r=void 0===f.editoptions.value?
                "":f.editoptions.value,v=void 0===f.editoptions.separator?":":f.editoptions.separator,u=void 0===f.editoptions.delimiter?";":f.editoptions.delimiter);if(r){var t=document.createElement("select");t.style.width="100%";a(t).attr({name:f.index||f.name,id:"gs_"+f.name});var w;if("string"===typeof r)for(m=r.split(u),w=0;w<m.length;w++)r=m[w].split(v),u=document.createElement("option"),u.value=r[0],u.innerHTML=r[1],t.appendChild(u);else if("object"===typeof r)for(w in r)r.hasOwnProperty(w)&&(u=document.createElement("option"),
                u.value=w,u.innerHTML=r[w],t.appendChild(u));void 0!==g.defaultValue&&a(t).val(g.defaultValue);g.attr&&a(t).attr(g.attr);a(l).append(p);a.jgrid.bindEv.call(c,t,g);a("td:eq(1)",p).append(t);!0===b.autosearch&&a(t).change(function(){e();return!1})}}break;case "text":v=void 0!==g.defaultValue?g.defaultValue:"";a("td:eq(1)",p).append("<input type='text' style='width:100%;padding:0px;' name='"+(f.index||f.name)+"' id='gs_"+f.name+"' value='"+v+"'/>");a(l).append(p);g.attr&&a("input",l).attr(g.attr);a.jgrid.bindEv.call(c,
                a("input",l)[0],g);!0===b.autosearch&&(b.searchOnEnter?a("input",l).keypress(function(a){return 13===(a.charCode||a.keyCode||0)?(e(),!1):this}):a("input",l).keydown(function(a){switch(a.which){case 13:return!1;case 9:case 16:case 37:case 38:case 39:case 40:case 27:break;default:h&&clearTimeout(h),h=setTimeout(function(){e()},b.autosearchDelay)}}));break;case "custom":a("td:eq(1)",p).append("<span style='width:95%;padding:0px;' name='"+(f.index||f.name)+"' id='gs_"+f.name+"'/>");a(l).append(p);try{if(a.isFunction(g.custom_element))if(t=
                g.custom_element.call(c,void 0!==g.defaultValue?g.defaultValue:"",g))t=a(t).addClass("customelement"),a(l).find("span[name='"+(f.index||f.name)+"']").append(t);else throw"e2";else throw"e1";}catch(y){"e1"===y&&a.jgrid.info_dialog(a.jgrid.errors.errcap,"function 'custom_element' "+a.jgrid.edit.msg.nodefined,a.jgrid.edit.bClose),"e2"===y?a.jgrid.info_dialog(a.jgrid.errors.errcap,"function 'custom_element' "+a.jgrid.edit.msg.novalue,a.jgrid.edit.bClose):a.jgrid.info_dialog(a.jgrid.errors.errcap,"string"===
            typeof y?y:y.message,a.jgrid.edit.bClose)}}}a(n).append(l);a(d).append(n);b.searchOperators||a("td:eq(0)",p).hide()});a("table thead",c.grid.hDiv).append(d);b.searchOperators&&(a(".soptclass",d).click(function(b){var c=a(this).offset();k(this,c.left,c.top);b.stopPropagation()}),a("body").on("click",function(b){"soptclass"!==b.target.className&&a("#sopt_menu").hide()}));a(".clearsearchclass",d).click(function(d){d=a(this).parents("tr:first");var f=parseInt(a("td.ui-search-oper",d).attr("colindex"),
            10),g=a.extend({},c.p.colModel[f].searchoptions||{}),g=g.defaultValue?g.defaultValue:"";"select"===c.p.colModel[f].stype?g?a("td.ui-search-input select",d).val(g):a("td.ui-search-input select",d)[0].selectedIndex=0:a("td.ui-search-input input",d).val(g);!0===b.autosearch&&e()});this.ftoolbar=!0;this.triggerToolbar=e;this.clearToolbar=function(d){var f={},g=0,e;d="boolean"!==typeof d?!0:d;a.each(c.p.colModel,function(){var b,d=a("#gs_"+a.jgrid.jqID(this.name),!0===this.frozen&&!0===c.p.frozenColumns?
            c.grid.fhDiv:c.grid.hDiv);this.searchoptions&&void 0!==this.searchoptions.defaultValue&&(b=this.searchoptions.defaultValue);e=this.index||this.name;switch(this.stype){case "select":d.find("option").each(function(c){0===c&&(this.selected=!0);if(a(this).val()===b)return this.selected=!0,!1});if(void 0!==b)f[e]=b,g++;else try{delete c.p.postData[e]}catch(h){}break;case "text":d.val(b||"");if(void 0!==b)f[e]=b,g++;else try{delete c.p.postData[e]}catch(k){}break;case "custom":a.isFunction(this.searchoptions.custom_value)&&
        0<d.length&&"SPAN"===d[0].nodeName.toUpperCase()&&this.searchoptions.custom_value.call(c,d.children(".customelement:first"),"set",b||"")}});var k=0<g?!0:!1;c.p.resetsearch=!0;if(!0===b.stringResult||"local"===c.p.datatype){var h='{"groupOp":"'+b.groupOp+'","rules":[',n=0;a.each(f,function(a,b){0<n&&(h+=",");h+='{"field":"'+a+'",';h+='"op":"eq",';h+='"data":"'+(b+"").replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}';n++});h+="]}";a.extend(c.p.postData,{filters:h});a.each(["searchField","searchString",
            "searchOper"],function(a,b){c.p.postData.hasOwnProperty(b)&&delete c.p.postData[b]})}else a.extend(c.p.postData,f);var l;c.p.searchurl&&(l=c.p.url,a(c).jqGrid("setGridParam",{url:c.p.searchurl}));var p="stop"===a(c).triggerHandler("jqGridToolbarBeforeClear")?!0:!1;!p&&a.isFunction(b.beforeClear)&&(p=b.beforeClear.call(c));p||d&&a(c).jqGrid("setGridParam",{search:k}).trigger("reloadGrid",[{page:1}]);l&&a(c).jqGrid("setGridParam",{url:l});a(c).triggerHandler("jqGridToolbarAfterClear");a.isFunction(b.afterClear)&&
        b.afterClear()};this.toggleToolbar=function(){var b=a("tr.ui-search-toolbar",c.grid.hDiv),d=!0===c.p.frozenColumns?a("tr.ui-search-toolbar",c.grid.fhDiv):!1;"none"===b.css("display")?(b.show(),d&&d.show()):(b.hide(),d&&d.hide())}}})},destroyFilterToolbar:function(){return this.each(function(){this.ftoolbar&&(this.toggleToolbar=this.clearToolbar=this.triggerToolbar=null,this.ftoolbar=!1,a(this.grid.hDiv).find("table thead tr.ui-search-toolbar").remove())})},destroyGroupHeader:function(b){void 0===
        b&&(b=!0);return this.each(function(){var c,e,k,d,h,s;e=this.grid;var f=a("table.ui-jqgrid-htable thead",e.hDiv),g=this.p.colModel;if(e){a(this).unbind(".setGroupHeaders");c=a("<tr>",{role:"row"}).addClass("ui-jqgrid-labels");d=e.headers;e=0;for(k=d.length;e<k;e++){h=g[e].hidden?"none":"";h=a(d[e].el).width(d[e].width).css("display",h);try{h.removeAttr("rowSpan")}catch(m){h.attr("rowSpan",1)}c.append(h);s=h.children("span.ui-jqgrid-resize");0<s.length&&(s[0].style.height="");h.children("div")[0].style.top=
            ""}a(f).children("tr.ui-jqgrid-labels").remove();a(f).prepend(c);!0===b&&a(this).jqGrid("setGridParam",{groupHeader:null})}})},setGroupHeaders:function(b){b=a.extend({useColSpanStyle:!1,groupHeaders:[]},b||{});return this.each(function(){this.p.groupHeader=b;var c,e,k=0,d,h,s,f,g,m=this.p.colModel,x=m.length,q=this.grid.headers,n=a("table.ui-jqgrid-htable",this.grid.hDiv),l=n.children("thead").children("tr.ui-jqgrid-labels:last").addClass("jqg-second-row-header");d=n.children("thead");var p=n.find(".jqg-first-row-header");
            void 0===p[0]?p=a("<tr>",{role:"row","aria-hidden":"true"}).addClass("jqg-first-row-header").css("height","auto"):p.empty();var r,v=function(a,b){var c=b.length,d;for(d=0;d<c;d++)if(b[d].startColumnName===a)return d;return-1};a(this).prepend(d);d=a("<tr>",{role:"row"}).addClass("ui-jqgrid-labels jqg-third-row-header");for(c=0;c<x;c++)if(s=q[c].el,f=a(s),e=m[c],h={height:"0px",width:q[c].width+"px",display:e.hidden?"none":""},a("<th>",{role:"gridcell"}).css(h).addClass("ui-first-th-"+this.p.direction).appendTo(p),
                s.style.width="",h=v(e.name,b.groupHeaders),0<=h){h=b.groupHeaders[h];k=h.numberOfColumns;g=h.titleText;for(h=e=0;h<k&&c+h<x;h++)m[c+h].hidden||e++;h=a("<th>").attr({role:"columnheader"}).addClass("ui-state-default ui-th-column-header ui-th-"+this.p.direction).css({height:"22px","border-top":"0 none"}).html(g);0<e&&h.attr("colspan",String(e));this.p.headertitles&&h.attr("title",h.text());0===e&&h.hide();f.before(h);d.append(s);k-=1}else 0===k?b.useColSpanStyle?f.attr("rowspan","2"):(a("<th>",{role:"columnheader"}).addClass("ui-state-default ui-th-column-header ui-th-"+
                this.p.direction).css({display:e.hidden?"none":"","border-top":"0 none"}).insertBefore(f),d.append(s)):(d.append(s),k--);m=a(this).children("thead");m.prepend(p);d.insertAfter(l);n.append(m);b.useColSpanStyle&&(n.find("span.ui-jqgrid-resize").each(function(){var b=a(this).parent();b.is(":visible")&&(this.style.cssText="height: "+b.height()+"px !important; cursor: col-resize;")}),n.find("div.ui-jqgrid-sortable").each(function(){var b=a(this),c=b.parent();c.is(":visible")&&c.is(":has(span.ui-jqgrid-resize)")&&
            b.css("top",(c.height()-b.outerHeight())/2+"px")}));r=m.find("tr.jqg-first-row-header");a(this).bind("jqGridResizeStop.setGroupHeaders",function(a,b,c){r.find("th").eq(c).width(b)})})},setFrozenColumns:function(){return this.each(function(){if(this.grid){var b=this,c=b.p.colModel,e=0,k=c.length,d=-1,h=!1;if(!0!==b.p.subGrid&&!0!==b.p.treeGrid&&!0!==b.p.cellEdit&&!b.p.sortable&&!b.p.scroll){b.p.rownumbers&&e++;for(b.p.multiselect&&e++;e<k;){if(!0===c[e].frozen)h=!0,d=e;else break;e++}if(0<=d&&h){c=
            b.p.caption?a(b.grid.cDiv).outerHeight():0;e=a(".ui-jqgrid-htable","#gview_"+a.jgrid.jqID(b.p.id)).height();b.p.toppager&&(c+=a(b.grid.topDiv).outerHeight());!0===b.p.toolbar[0]&&"bottom"!==b.p.toolbar[1]&&(c+=a(b.grid.uDiv).outerHeight());b.grid.fhDiv=a('<div style="position:absolute;left:0px;top:'+c+"px;height:"+e+'px;" class="frozen-div ui-state-default ui-jqgrid-hdiv"></div>');b.grid.fbDiv=a('<div style="position:absolute;left:0px;top:'+(parseInt(c,10)+parseInt(e,10)+1)+'px;overflow-y:hidden" class="frozen-bdiv ui-jqgrid-bdiv"></div>');
            a("#gview_"+a.jgrid.jqID(b.p.id)).append(b.grid.fhDiv);k=a(".ui-jqgrid-htable","#gview_"+a.jgrid.jqID(b.p.id)).clone(!0);if(b.p.groupHeader){a("tr.jqg-first-row-header, tr.jqg-third-row-header",k).each(function(){a("th:gt("+d+")",this).remove()});var s=-1,f=-1,g,m;a("tr.jqg-second-row-header th",k).each(function(){g=parseInt(a(this).attr("colspan"),10);if(m=parseInt(a(this).attr("rowspan"),10))s++,f++;g&&(s+=g,f++);if(s===d)return!1});s!==d&&(f=d);a("tr.jqg-second-row-header",k).each(function(){a("th:gt("+
                f+")",this).remove()})}else a("tr",k).each(function(){a("th:gt("+d+")",this).remove()});a(k).width(1);a(b.grid.fhDiv).append(k).mousemove(function(a){if(b.grid.resizing)return b.grid.dragMove(a),!1});b.p.footerrow&&(k=a(".ui-jqgrid-bdiv","#gview_"+a.jgrid.jqID(b.p.id)).height(),b.grid.fsDiv=a('<div style="position:absolute;left:0px;top:'+(parseInt(c,10)+parseInt(e,10)+parseInt(k,10)+1)+'px;" class="frozen-sdiv ui-jqgrid-sdiv"></div>'),a("#gview_"+a.jgrid.jqID(b.p.id)).append(b.grid.fsDiv),c=a(".ui-jqgrid-ftable",
                "#gview_"+a.jgrid.jqID(b.p.id)).clone(!0),a("tr",c).each(function(){a("td:gt("+d+")",this).remove()}),a(c).width(1),a(b.grid.fsDiv).append(c));a(b).bind("jqGridResizeStop.setFrozenColumns",function(c,d,e){c=a(".ui-jqgrid-htable",b.grid.fhDiv);a("th:eq("+e+")",c).width(d);c=a(".ui-jqgrid-btable",b.grid.fbDiv);a("tr:first td:eq("+e+")",c).width(d);b.p.footerrow&&(c=a(".ui-jqgrid-ftable",b.grid.fsDiv),a("tr:first td:eq("+e+")",c).width(d))});a(b).bind("jqGridSortCol.setFrozenColumns",function(c,d,e){c=
                a("tr.ui-jqgrid-labels:last th:eq("+b.p.lastsort+")",b.grid.fhDiv);d=a("tr.ui-jqgrid-labels:last th:eq("+e+")",b.grid.fhDiv);a("span.ui-grid-ico-sort",c).addClass("ui-state-disabled");a(c).attr("aria-selected","false");a("span.ui-icon-"+b.p.sortorder,d).removeClass("ui-state-disabled");a(d).attr("aria-selected","true");b.p.viewsortcols[0]||b.p.lastsort===e||(a("span.s-ico",c).hide(),a("span.s-ico",d).show())});a("#gview_"+a.jgrid.jqID(b.p.id)).append(b.grid.fbDiv);a(b.grid.bDiv).scroll(function(){a(b.grid.fbDiv).scrollTop(a(this).scrollTop())});
            !0===b.p.hoverrows&&a("#"+a.jgrid.jqID(b.p.id)).unbind("mouseover").unbind("mouseout");a(b).bind("jqGridAfterGridComplete.setFrozenColumns",function(){a("#"+a.jgrid.jqID(b.p.id)+"_frozen").remove();a(b.grid.fbDiv).height(a(b.grid.bDiv).height()-16);var c=a("#"+a.jgrid.jqID(b.p.id)).clone(!0);a("tr[role=row]",c).each(function(){a("td[role=gridcell]:gt("+d+")",this).remove()});a(c).width(1).attr("id",b.p.id+"_frozen");a(b.grid.fbDiv).append(c);!0===b.p.hoverrows&&(a("tr.jqgrow",c).hover(function(){a(this).addClass("ui-state-hover");
                a("#"+a.jgrid.jqID(this.id),"#"+a.jgrid.jqID(b.p.id)).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover");a("#"+a.jgrid.jqID(this.id),"#"+a.jgrid.jqID(b.p.id)).removeClass("ui-state-hover")}),a("tr.jqgrow","#"+a.jgrid.jqID(b.p.id)).hover(function(){a(this).addClass("ui-state-hover");a("#"+a.jgrid.jqID(this.id),"#"+a.jgrid.jqID(b.p.id)+"_frozen").addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover");a("#"+a.jgrid.jqID(this.id),"#"+a.jgrid.jqID(b.p.id)+
                "_frozen").removeClass("ui-state-hover")}));c=null});b.grid.hDiv.loading||a(b).triggerHandler("jqGridAfterGridComplete");b.p.frozenColumns=!0}}}})},destroyFrozenColumns:function(){return this.each(function(){if(this.grid&&!0===this.p.frozenColumns){a(this.grid.fhDiv).remove();a(this.grid.fbDiv).remove();this.grid.fhDiv=null;this.grid.fbDiv=null;this.p.footerrow&&(a(this.grid.fsDiv).remove(),this.grid.fsDiv=null);a(this).unbind(".setFrozenColumns");if(!0===this.p.hoverrows){var b;a("#"+a.jgrid.jqID(this.p.id)).bind("mouseover",
            function(c){b=a(c.target).closest("tr.jqgrow");"ui-subgrid"!==a(b).attr("class")&&a(b).addClass("ui-state-hover")}).bind("mouseout",function(c){b=a(c.target).closest("tr.jqgrow");a(b).removeClass("ui-state-hover")})}this.p.frozenColumns=!1}})}})})(jQuery);
    (function(a){a.extend(a.jgrid,{showModal:function(a){a.w.show()},closeModal:function(a){a.w.hide().attr("aria-hidden","true");a.o&&a.o.remove()},hideModal:function(d,b){b=a.extend({jqm:!0,gb:"",removemodal:!1,formprop:!1,form:""},b||{});var c=b.gb&&"string"===typeof b.gb&&"#gbox_"===b.gb.substr(0,6)?a("#"+b.gb.substr(6))[0]:!1;if(b.onClose){var g=c?b.onClose.call(c,d):b.onClose(d);if("boolean"===typeof g&&!g)return}if(b.formprop&&c&&b.form){g=a(d)[0].style.height;-1<g.indexOf("px")&&(g=parseFloat(g));
            var e,h;"edit"===b.form?(e="#"+a.jgrid.jqID("FrmGrid_"+b.gb.substr(6)),h="formProp"):"view"===b.form&&(e="#"+a.jgrid.jqID("ViewGrid_"+b.gb.substr(6)),h="viewProp");a(c).data(h,{top:parseFloat(a(d).css("top")),left:parseFloat(a(d).css("left")),width:a(d).width(),height:g,dataheight:a(e).height(),datawidth:a(e).width()})}if(a.fn.jqm&&!0===b.jqm)a(d).attr("aria-hidden","true").jqmHide();else{if(""!==b.gb)try{a(".jqgrid-overlay:first",b.gb).hide()}catch(f){}a(d).hide().attr("aria-hidden","true")}b.removemodal&&
        a(d).remove()},findPos:function(a){var b=0,c=0;if(a.offsetParent){do b+=a.offsetLeft,c+=a.offsetTop;while(a=a.offsetParent)}return[b,c]},createModal:function(d,b,c,g,e,h,f){c=a.extend(!0,{},a.jgrid.jqModal||{},c);var k=document.createElement("div"),m,s=this;f=a.extend({},f||{});m="rtl"===a(c.gbox).attr("dir")?!0:!1;k.className="ui-widget ui-widget-content ui-corner-all ui-jqdialog";k.id=d.themodal;var l=document.createElement("div");l.className="ui-jqdialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix";
            l.id=d.modalhead;a(l).append("<span class='ui-jqdialog-title'>"+c.caption+"</span>");var q=a("<a class='ui-jqdialog-titlebar-close ui-corner-all'></a>").hover(function(){q.addClass("ui-state-hover")},function(){q.removeClass("ui-state-hover")}).append("<span class='ui-icon ui-icon-closethick'></span>");a(l).append(q);m?(k.dir="rtl",a(".ui-jqdialog-title",l).css("float","right"),a(".ui-jqdialog-titlebar-close",l).css("left","0.3em")):(k.dir="ltr",a(".ui-jqdialog-title",l).css("float","left"),a(".ui-jqdialog-titlebar-close",
                l).css("right","0.3em"));var n=document.createElement("div");a(n).addClass("ui-jqdialog-content ui-widget-content").attr("id",d.modalcontent);a(n).append(b);k.appendChild(n);a(k).prepend(l);!0===h?a("body").append(k):"string"===typeof h?a(h).append(k):a(k).insertBefore(g);a(k).css(f);void 0===c.jqModal&&(c.jqModal=!0);b={};if(a.fn.jqm&&!0===c.jqModal)0===c.left&&0===c.top&&c.overlay&&(f=[],f=a.jgrid.findPos(e),c.left=f[0]+4,c.top=f[1]+4),b.top=c.top+"px",b.left=c.left;else if(0!==c.left||0!==c.top)b.left=
                c.left,b.top=c.top+"px";a("a.ui-jqdialog-titlebar-close",l).click(function(){var b=a("#"+a.jgrid.jqID(d.themodal)).data("onClose")||c.onClose,e=a("#"+a.jgrid.jqID(d.themodal)).data("gbox")||c.gbox;s.hideModal("#"+a.jgrid.jqID(d.themodal),{gb:e,jqm:c.jqModal,onClose:b,removemodal:c.removemodal||!1,formprop:!c.recreateForm||!1,form:c.form||""});return!1});0!==c.width&&c.width||(c.width=300);0!==c.height&&c.height||(c.height=200);c.zIndex||(g=a(g).parents("*[role=dialog]").filter(":first").css("z-index"),
                c.zIndex=g?parseInt(g,10)+2:950);g=0;m&&b.left&&!h&&(g=a(c.gbox).width()-(isNaN(c.width)?0:parseInt(c.width,10))-8,b.left=parseInt(b.left,10)+parseInt(g,10));b.left&&(b.left+="px");a(k).css(a.extend({width:isNaN(c.width)?"auto":c.width+"px",height:isNaN(c.height)?"auto":c.height+"px",zIndex:c.zIndex,overflow:"hidden"},b)).attr({tabIndex:"-1",role:"dialog","aria-labelledby":d.modalhead,"aria-hidden":"true"});void 0===c.drag&&(c.drag=!0);void 0===c.resize&&(c.resize=!0);if(c.drag)if(a(l).css("cursor",
                "move"),a.fn.jqDrag)a(k).jqDrag(l);else try{a(k).draggable({handle:a("#"+a.jgrid.jqID(l.id))})}catch(p){}if(c.resize)if(a.fn.jqResize)a(k).append("<div class='jqResize ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se'></div>"),a("#"+a.jgrid.jqID(d.themodal)).jqResize(".jqResize",d.scrollelm?"#"+a.jgrid.jqID(d.scrollelm):!1);else try{a(k).resizable({handles:"se, sw",alsoResize:d.scrollelm?"#"+a.jgrid.jqID(d.scrollelm):!1})}catch(r){}!0===c.closeOnEscape&&a(k).keydown(function(b){27===
            b.which&&(b=a("#"+a.jgrid.jqID(d.themodal)).data("onClose")||c.onClose,s.hideModal("#"+a.jgrid.jqID(d.themodal),{gb:c.gbox,jqm:c.jqModal,onClose:b,removemodal:c.removemodal||!1,formprop:!c.recreateForm||!1,form:c.form||""}))})},viewModal:function(d,b){b=a.extend({toTop:!0,overlay:10,modal:!1,overlayClass:"ui-widget-overlay",onShow:a.jgrid.showModal,onHide:a.jgrid.closeModal,gbox:"",jqm:!0,jqM:!0},b||{});if(a.fn.jqm&&!0===b.jqm)b.jqM?a(d).attr("aria-hidden","false").jqm(b).jqmShow():a(d).attr("aria-hidden",
            "false").jqmShow();else{""!==b.gbox&&(a(".jqgrid-overlay:first",b.gbox).show(),a(d).data("gbox",b.gbox));a(d).show().attr("aria-hidden","false");try{a(":input:visible",d)[0].focus()}catch(c){}}},info_dialog:function(d,b,c,g){var e={width:290,height:"auto",dataheight:"auto",drag:!0,resize:!1,left:250,top:170,zIndex:1E3,jqModal:!0,modal:!1,closeOnEscape:!0,align:"center",buttonalign:"center",buttons:[]};a.extend(!0,e,a.jgrid.jqModal||{},{caption:"<b>"+d+"</b>"},g||{});var h=e.jqModal,f=this;a.fn.jqm&&
        !h&&(h=!1);d="";if(0<e.buttons.length)for(g=0;g<e.buttons.length;g++)void 0===e.buttons[g].id&&(e.buttons[g].id="info_button_"+g),d+="<a id='"+e.buttons[g].id+"' class='fm-button ui-state-default ui-corner-all'>"+e.buttons[g].text+"</a>";g=isNaN(e.dataheight)?e.dataheight:e.dataheight+"px";b="<div id='info_id'>"+("<div id='infocnt' style='margin:0px;padding-bottom:1em;width:100%;overflow:auto;position:relative;height:"+g+";"+("text-align:"+e.align+";")+"'>"+b+"</div>");b+=c?"<div class='ui-widget-content ui-helper-clearfix' style='text-align:"+
            e.buttonalign+";padding-bottom:0.8em;padding-top:0.5em;background-image: none;border-width: 1px 0 0 0;'><a id='closedialog' class='fm-button ui-state-default ui-corner-all'>"+c+"</a>"+d+"</div>":""!==d?"<div class='ui-widget-content ui-helper-clearfix' style='text-align:"+e.buttonalign+";padding-bottom:0.8em;padding-top:0.5em;background-image: none;border-width: 1px 0 0 0;'>"+d+"</div>":"";b+="</div>";try{"false"===a("#info_dialog").attr("aria-hidden")&&a.jgrid.hideModal("#info_dialog",{jqm:h}),a("#info_dialog").remove()}catch(k){}a.jgrid.createModal({themodal:"info_dialog",
            modalhead:"info_head",modalcontent:"info_content",scrollelm:"infocnt"},b,e,"","",!0);d&&a.each(e.buttons,function(b){a("#"+a.jgrid.jqID(this.id),"#info_id").bind("click",function(){e.buttons[b].onClick.call(a("#info_dialog"));return!1})});a("#closedialog","#info_id").click(function(){f.hideModal("#info_dialog",{jqm:h,onClose:a("#info_dialog").data("onClose")||e.onClose,gb:a("#info_dialog").data("gbox")||e.gbox});return!1});a(".fm-button","#info_dialog").hover(function(){a(this).addClass("ui-state-hover")},
            function(){a(this).removeClass("ui-state-hover")});a.isFunction(e.beforeOpen)&&e.beforeOpen();a.jgrid.viewModal("#info_dialog",{onHide:function(a){a.w.hide().remove();a.o&&a.o.remove()},modal:e.modal,jqm:h});a.isFunction(e.afterOpen)&&e.afterOpen();try{a("#info_dialog").focus()}catch(m){}},bindEv:function(d,b){a.isFunction(b.dataInit)&&b.dataInit.call(this,d,b);b.dataEvents&&a.each(b.dataEvents,function(){void 0!==this.data?a(d).bind(this.type,this.data,this.fn):a(d).bind(this.type,this.fn)})},createEl:function(d,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 b,c,g,e){function h(b,d,c){var e="dataInit dataEvents dataUrl buildSelect sopt searchhidden defaultValue attr custom_element custom_value".split(" ");void 0!==c&&a.isArray(c)&&a.merge(e,c);a.each(d,function(d,c){-1===a.inArray(d,e)&&a(b).attr(d,c)});d.hasOwnProperty("id")||a(b).attr("id",a.jgrid.randId())}var f="",k=this;switch(d){case "textarea":f=document.createElement("textarea");g?b.cols||a(f).css({width:"98%"}):b.cols||(b.cols=20);b.rows||(b.rows=2);if("&nbsp;"===c||"&#160;"===c||1===c.length&&
            160===c.charCodeAt(0))c="";f.value=c;h(f,b);a(f).attr({role:"textbox",multiline:"true"});break;case "checkbox":f=document.createElement("input");f.type="checkbox";b.value?(d=b.value.split(":"),c===d[0]&&(f.checked=!0,f.defaultChecked=!0),f.value=d[0],a(f).attr("offval",d[1])):(d=(c+"").toLowerCase(),0>d.search(/(false|f|0|no|n|off|undefined)/i)&&""!==d?(f.checked=!0,f.defaultChecked=!0,f.value=c):f.value="on",a(f).attr("offval","off"));h(f,b,["value"]);a(f).attr("role","checkbox");break;case "select":f=
            document.createElement("select");f.setAttribute("role","select");g=[];!0===b.multiple?(d=!0,f.multiple="multiple",a(f).attr("aria-multiselectable","true")):d=!1;if(void 0!==b.dataUrl){d=null;var m=b.postData||e.postData;try{d=b.rowId}catch(s){}k.p&&k.p.idPrefix&&(d=a.jgrid.stripPref(k.p.idPrefix,d));a.ajax(a.extend({url:a.isFunction(b.dataUrl)?b.dataUrl.call(k,d,c,String(b.name)):b.dataUrl,type:"GET",dataType:"html",data:a.isFunction(m)?m.call(k,d,c,String(b.name)):m,context:{elem:f,options:b,vl:c},
            success:function(d){var b=[],c=this.elem,e=this.vl,f=a.extend({},this.options),g=!0===f.multiple;d=a.isFunction(f.buildSelect)?f.buildSelect.call(k,d):d;"string"===typeof d&&(d=a(a.trim(d)).html());d&&(a(c).append(d),h(c,f,m?["postData"]:void 0),void 0===f.size&&(f.size=g?3:1),g?(b=e.split(","),b=a.map(b,function(d){return a.trim(d)})):b[0]=a.trim(e),setTimeout(function(){a("option",c).each(function(d){0===d&&c.multiple&&(this.selected=!1);a(this).attr("role","option");if(-1<a.inArray(a.trim(a(this).text()),
                b)||-1<a.inArray(a.trim(a(this).val()),b))this.selected="selected"})},0))}},e||{}))}else if(b.value){var l;void 0===b.size&&(b.size=d?3:1);d&&(g=c.split(","),g=a.map(g,function(d){return a.trim(d)}));"function"===typeof b.value&&(b.value=b.value());var q,n,p=void 0===b.separator?":":b.separator;e=void 0===b.delimiter?";":b.delimiter;if("string"===typeof b.value)for(q=b.value.split(e),l=0;l<q.length;l++)n=q[l].split(p),2<n.length&&(n[1]=a.map(n,function(a,d){if(0<d)return a}).join(p)),e=document.createElement("option"),
            e.setAttribute("role","option"),e.value=n[0],e.innerHTML=n[1],f.appendChild(e),d||a.trim(n[0])!==a.trim(c)&&a.trim(n[1])!==a.trim(c)||(e.selected="selected"),d&&(-1<a.inArray(a.trim(n[1]),g)||-1<a.inArray(a.trim(n[0]),g))&&(e.selected="selected");else if("object"===typeof b.value)for(l in p=b.value,p)p.hasOwnProperty(l)&&(e=document.createElement("option"),e.setAttribute("role","option"),e.value=l,e.innerHTML=p[l],f.appendChild(e),d||a.trim(l)!==a.trim(c)&&a.trim(p[l])!==a.trim(c)||(e.selected="selected"),
        d&&(-1<a.inArray(a.trim(p[l]),g)||-1<a.inArray(a.trim(l),g))&&(e.selected="selected"));h(f,b,["value"])}break;case "text":case "password":case "button":l="button"===d?"button":"textbox";f=document.createElement("input");f.type=d;f.value=c;h(f,b);"button"!==d&&(g?b.size||a(f).css({width:"98%"}):b.size||(b.size=20));a(f).attr("role",l);break;case "image":case "file":f=document.createElement("input");f.type=d;h(f,b);break;case "custom":f=document.createElement("span");try{if(a.isFunction(b.custom_element))if(p=
            b.custom_element.call(k,c,b))p=a(p).addClass("customelement").attr({id:b.id,name:b.name}),a(f).empty().append(p);else throw"e2";else throw"e1";}catch(r){"e1"===r&&a.jgrid.info_dialog(a.jgrid.errors.errcap,"function 'custom_element' "+a.jgrid.edit.msg.nodefined,a.jgrid.edit.bClose),"e2"===r?a.jgrid.info_dialog(a.jgrid.errors.errcap,"function 'custom_element' "+a.jgrid.edit.msg.novalue,a.jgrid.edit.bClose):a.jgrid.info_dialog(a.jgrid.errors.errcap,"string"===typeof r?r:r.message,a.jgrid.edit.bClose)}}return f},
        checkDate:function(a,b){var c={},g;a=a.toLowerCase();g=-1!==a.indexOf("/")?"/":-1!==a.indexOf("-")?"-":-1!==a.indexOf(".")?".":"/";a=a.split(g);b=b.split(g);if(3!==b.length)return!1;var e=-1,h,f=g=-1,k;for(k=0;k<a.length;k++)h=isNaN(b[k])?0:parseInt(b[k],10),c[a[k]]=h,h=a[k],-1!==h.indexOf("y")&&(e=k),-1!==h.indexOf("m")&&(f=k),-1!==h.indexOf("d")&&(g=k);h="y"===a[e]||"yyyy"===a[e]?4:"yy"===a[e]?2:-1;k=[0,31,29,31,30,31,30,31,31,30,31,30,31];var m;if(-1===e)return!1;m=c[a[e]].toString();2===h&&1===
        m.length&&(h=1);if(m.length!==h||0===c[a[e]]&&"00"!==b[e]||-1===f)return!1;m=c[a[f]].toString();if(1>m.length||1>c[a[f]]||12<c[a[f]]||-1===g)return!1;m=c[a[g]].toString();!(h=1>m.length||1>c[a[g]]||31<c[a[g]])&&(h=2===c[a[f]])&&(e=c[a[e]],h=c[a[g]]>(0!==e%4||0===e%100&&0!==e%400?28:29));return h||c[a[g]]>k[c[a[f]]]?!1:!0},isEmpty:function(a){return a.match(/^\s+$/)||""===a?!0:!1},checkTime:function(d){var b=/^(\d{1,2}):(\d{2})([apAP][Mm])?$/;if(!a.jgrid.isEmpty(d))if(d=d.match(b)){if(d[3]){if(1>d[1]||
            12<d[1])return!1}else if(23<d[1])return!1;if(59<d[2])return!1}else return!1;return!0},checkValues:function(d,b,c,g){var e,h,f;f=this.p.colModel;if(void 0===c)if("string"===typeof b)for(c=0,g=f.length;c<g;c++){if(f[c].name===b){e=f[c].editrules;b=c;null!=f[c].formoptions&&(h=f[c].formoptions.label);break}}else 0<=b&&(e=f[b].editrules);else e=c,h=void 0===g?"_":g;if(e){h||(h=null!=this.p.colNames?this.p.colNames[b]:f[b].label);if(!0===e.required&&a.jgrid.isEmpty(d))return[!1,h+": "+a.jgrid.edit.msg.required,
            ""];c=!1===e.required?!1:!0;if(!0===e.number&&(!1!==c||!a.jgrid.isEmpty(d))&&isNaN(d))return[!1,h+": "+a.jgrid.edit.msg.number,""];if(void 0!==e.minValue&&!isNaN(e.minValue)&&parseFloat(d)<parseFloat(e.minValue))return[!1,h+": "+a.jgrid.edit.msg.minValue+" "+e.minValue,""];if(void 0!==e.maxValue&&!isNaN(e.maxValue)&&parseFloat(d)>parseFloat(e.maxValue))return[!1,h+": "+a.jgrid.edit.msg.maxValue+" "+e.maxValue,""];if(!(!0!==e.email||!1===c&&a.jgrid.isEmpty(d)||(g=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i,
            g.test(d))))return[!1,h+": "+a.jgrid.edit.msg.email,""];if(!(!0!==e.integer||!1===c&&a.jgrid.isEmpty(d)||!isNaN(d)&&0===d%1&&-1===d.indexOf(".")))return[!1,h+": "+a.jgrid.edit.msg.integer,""];if(!(!0!==e.date||!1===c&&a.jgrid.isEmpty(d)||(f[b].formatoptions&&f[b].formatoptions.newformat?(f=f[b].formatoptions.newformat,a.jgrid.formatter.date.masks.hasOwnProperty(f)&&(f=a.jgrid.formatter.date.masks[f])):f=f[b].datefmt||"Y-m-d",a.jgrid.checkDate(f,d))))return[!1,h+": "+a.jgrid.edit.msg.date+" - "+f,
            ""];if(!0===e.time&&!(!1===c&&a.jgrid.isEmpty(d)||a.jgrid.checkTime(d)))return[!1,h+": "+a.jgrid.edit.msg.date+" - hh:mm (am/pm)",""];if(!(!0!==e.url||!1===c&&a.jgrid.isEmpty(d)||(g=/^(((https?)|(ftp)):\/\/([\-\w]+\.)+\w{2,3}(\/[%\-\w]+(\.\w{2,})?)*(([\w\-\.\?\\\/+@&#;`~=%!]*)(\.\w{2,})?)*\/?)/i,g.test(d))))return[!1,h+": "+a.jgrid.edit.msg.url,""];if(!0===e.custom&&(!1!==c||!a.jgrid.isEmpty(d)))return a.isFunction(e.custom_func)?(d=e.custom_func.call(this,d,h,b),a.isArray(d)?d:[!1,a.jgrid.edit.msg.customarray,
            ""]):[!1,a.jgrid.edit.msg.customfcheck,""]}return[!0,"",""]}})})(jQuery);
    (function(a){a.fn.jqFilter=function(d){if("string"===typeof d){var q=a.fn.jqFilter[d];if(!q)throw"jqFilter - No such method: "+d;var x=a.makeArray(arguments).slice(1);return q.apply(this,x)}var n=a.extend(!0,{filter:null,columns:[],onChange:null,afterRedraw:null,checkValues:null,error:!1,errmsg:"",errorcheck:!0,showQuery:!0,sopt:null,ops:[],operands:null,numopts:"eq ne lt le gt ge nu nn in ni".split(" "),stropts:"eq ne bw bn ew en cn nc nu nn in ni".split(" "),strarr:["text","string","blob"],groupOps:[{op:"AND",
            text:"AND"},{op:"OR",text:"OR"}],groupButton:!0,ruleButtons:!0,direction:"ltr"},a.jgrid.filter,d||{});return this.each(function(){if(!this.filter){this.p=n;if(null===this.p.filter||void 0===this.p.filter)this.p.filter={groupOp:this.p.groupOps[0].op,rules:[],groups:[]};var d,q=this.p.columns.length,f,w=/msie/i.test(navigator.userAgent)&&!window.opera;this.p.initFilter=a.extend(!0,{},this.p.filter);if(q){for(d=0;d<q;d++)f=this.p.columns[d],f.stype?f.inputtype=f.stype:f.inputtype||(f.inputtype="text"),
        f.sorttype?f.searchtype=f.sorttype:f.searchtype||(f.searchtype="string"),void 0===f.hidden&&(f.hidden=!1),f.label||(f.label=f.name),f.index&&(f.name=f.index),f.hasOwnProperty("searchoptions")||(f.searchoptions={}),f.hasOwnProperty("searchrules")||(f.searchrules={});this.p.showQuery&&a(this).append("<table class='queryresult ui-widget ui-widget-content' style='display:block;max-width:440px;border:0px none;' dir='"+this.p.direction+"'><tbody><tr><td class='query'></td></tr></tbody></table>");var u=
        function(g,l){var b=[!0,""],c=a("#"+a.jgrid.jqID(n.id))[0]||null;if(a.isFunction(l.searchrules))b=l.searchrules.call(c,g,l);else if(a.jgrid&&a.jgrid.checkValues)try{b=a.jgrid.checkValues.call(c,g,-1,l.searchrules,l.label)}catch(m){}b&&b.length&&!1===b[0]&&(n.error=!b[0],n.errmsg=b[1])};this.onchange=function(){this.p.error=!1;this.p.errmsg="";return a.isFunction(this.p.onChange)?this.p.onChange.call(this,this.p):!1};this.reDraw=function(){a("table.group:first",this).remove();var g=this.createTableForGroup(n.filter,
        null);a(this).append(g);a.isFunction(this.p.afterRedraw)&&this.p.afterRedraw.call(this,this.p)};this.createTableForGroup=function(g,l){var b=this,c,m=a("<table class='group ui-widget ui-widget-content' style='border:0px none;'><tbody></tbody></table>"),e="left";"rtl"===this.p.direction&&(e="right",m.attr("dir","rtl"));null===l&&m.append("<tr class='error' style='display:none;'><th colspan='5' class='ui-state-error' align='"+e+"'></th></tr>");var h=a("<tr></tr>");m.append(h);e=a("<th colspan='5' align='"+
        e+"'></th>");h.append(e);if(!0===this.p.ruleButtons){var d=a("<select class='opsel'></select>");e.append(d);var h="",k;for(c=0;c<n.groupOps.length;c++)k=g.groupOp===b.p.groupOps[c].op?" selected='selected'":"",h+="<option value='"+b.p.groupOps[c].op+"'"+k+">"+b.p.groupOps[c].text+"</option>";d.append(h).bind("change",function(){g.groupOp=a(d).val();b.onchange()})}h="<span></span>";this.p.groupButton&&(h=a("<input type='button' value='+ {}' title='Add subgroup' class='add-group'/>"),h.bind("click",
        function(){void 0===g.groups&&(g.groups=[]);g.groups.push({groupOp:n.groupOps[0].op,rules:[],groups:[]});b.reDraw();b.onchange();return!1}));e.append(h);if(!0===this.p.ruleButtons){var h=a("<input type='button' value='+' title='Add rule' class='add-rule ui-add'/>"),f;h.bind("click",function(){void 0===g.rules&&(g.rules=[]);for(c=0;c<b.p.columns.length;c++){var e=void 0===b.p.columns[c].search?!0:b.p.columns[c].search,l=!0===b.p.columns[c].hidden;if(!0===b.p.columns[c].searchoptions.searchhidden&&
        e||e&&!l){f=b.p.columns[c];break}}e=f.searchoptions.sopt?f.searchoptions.sopt:b.p.sopt?b.p.sopt:-1!==a.inArray(f.searchtype,b.p.strarr)?b.p.stropts:b.p.numopts;g.rules.push({field:f.name,op:e[0],data:""});b.reDraw();return!1});e.append(h)}null!==l&&(h=a("<input type='button' value='-' title='Delete group' class='delete-group'/>"),e.append(h),h.bind("click",function(){for(c=0;c<l.groups.length;c++)if(l.groups[c]===g){l.groups.splice(c,1);break}b.reDraw();b.onchange();return!1}));if(void 0!==g.groups)for(c=
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        0;c<g.groups.length;c++)e=a("<tr></tr>"),m.append(e),h=a("<td class='first'></td>"),e.append(h),h=a("<td colspan='4'></td>"),h.append(this.createTableForGroup(g.groups[c],g)),e.append(h);void 0===g.groupOp&&(g.groupOp=b.p.groupOps[0].op);if(void 0!==g.rules)for(c=0;c<g.rules.length;c++)m.append(this.createTableRowForRule(g.rules[c],g));return m};this.createTableRowForRule=function(g,l){var b=this,c=a("#"+a.jgrid.jqID(n.id))[0]||null,m=a("<tr></tr>"),e,h,f,k,d="",s;m.append("<td class='first'></td>");
        var p=a("<td class='columns'></td>");m.append(p);var q=a("<select></select>"),r,t=[];p.append(q);q.bind("change",function(){g.field=a(q).val();f=a(this).parents("tr:first");for(e=0;e<b.p.columns.length;e++)if(b.p.columns[e].name===g.field){k=b.p.columns[e];break}if(k){k.searchoptions.id=a.jgrid.randId();w&&"text"===k.inputtype&&!k.searchoptions.size&&(k.searchoptions.size=10);var d=a.jgrid.createEl.call(c,k.inputtype,k.searchoptions,"",!0,b.p.ajaxSelectOptions||{},!0);a(d).addClass("input-elm");h=
            k.searchoptions.sopt?k.searchoptions.sopt:b.p.sopt?b.p.sopt:-1!==a.inArray(k.searchtype,b.p.strarr)?b.p.stropts:b.p.numopts;var l="",m=0;t=[];a.each(b.p.ops,function(){t.push(this.oper)});for(e=0;e<h.length;e++)r=a.inArray(h[e],t),-1!==r&&(0===m&&(g.op=b.p.ops[r].oper),l+="<option value='"+b.p.ops[r].oper+"'>"+b.p.ops[r].text+"</option>",m++);a(".selectopts",f).empty().append(l);a(".selectopts",f)[0].selectedIndex=0;a.jgrid.msie&&9>a.jgrid.msiever()&&(l=parseInt(a("select.selectopts",f)[0].offsetWidth,
            10)+1,a(".selectopts",f).width(l),a(".selectopts",f).css("width","auto"));a(".data",f).empty().append(d);a.jgrid.bindEv.call(c,d,k.searchoptions);a(".input-elm",f).bind("change",function(e){e=e.target;g.data="SPAN"===e.nodeName.toUpperCase()&&k.searchoptions&&a.isFunction(k.searchoptions.custom_value)?k.searchoptions.custom_value.call(c,a(e).children(".customelement:first"),"get"):e.value;b.onchange()});setTimeout(function(){g.data=a(d).val();b.onchange()},0)}});for(e=p=0;e<b.p.columns.length;e++){s=
            void 0===b.p.columns[e].search?!0:b.p.columns[e].search;var u=!0===b.p.columns[e].hidden;if(!0===b.p.columns[e].searchoptions.searchhidden&&s||s&&!u)s="",g.field===b.p.columns[e].name&&(s=" selected='selected'",p=e),d+="<option value='"+b.p.columns[e].name+"'"+s+">"+b.p.columns[e].label+"</option>"}q.append(d);d=a("<td class='operators'></td>");m.append(d);k=n.columns[p];k.searchoptions.id=a.jgrid.randId();w&&"text"===k.inputtype&&!k.searchoptions.size&&(k.searchoptions.size=10);p=a.jgrid.createEl.call(c,
            k.inputtype,k.searchoptions,g.data,!0,b.p.ajaxSelectOptions||{},!0);if("nu"===g.op||"nn"===g.op)a(p).attr("readonly","true"),a(p).attr("disabled","true");var v=a("<select class='selectopts'></select>");d.append(v);v.bind("change",function(){g.op=a(v).val();f=a(this).parents("tr:first");var c=a(".input-elm",f)[0];"nu"===g.op||"nn"===g.op?(g.data="","SELECT"!==c.tagName.toUpperCase()&&(c.value=""),c.setAttribute("readonly","true"),c.setAttribute("disabled","true")):("SELECT"===c.tagName.toUpperCase()&&
        (g.data=c.value),c.removeAttribute("readonly"),c.removeAttribute("disabled"));b.onchange()});h=k.searchoptions.sopt?k.searchoptions.sopt:b.p.sopt?b.p.sopt:-1!==a.inArray(k.searchtype,b.p.strarr)?b.p.stropts:b.p.numopts;d="";a.each(b.p.ops,function(){t.push(this.oper)});for(e=0;e<h.length;e++)r=a.inArray(h[e],t),-1!==r&&(s=g.op===b.p.ops[r].oper?" selected='selected'":"",d+="<option value='"+b.p.ops[r].oper+"'"+s+">"+b.p.ops[r].text+"</option>");v.append(d);d=a("<td class='data'></td>");m.append(d);
        d.append(p);a.jgrid.bindEv.call(c,p,k.searchoptions);a(p).addClass("input-elm").bind("change",function(){g.data="custom"===k.inputtype?k.searchoptions.custom_value.call(c,a(this).children(".customelement:first"),"get"):a(this).val();b.onchange()});d=a("<td></td>");m.append(d);!0===this.p.ruleButtons&&(p=a("<input type='button' value='-' title='Delete rule' class='delete-rule ui-del'/>"),d.append(p),p.bind("click",function(){for(e=0;e<l.rules.length;e++)if(l.rules[e]===g){l.rules.splice(e,1);break}b.reDraw();
            b.onchange();return!1}));return m};this.getStringForGroup=function(a){var d="(",b;if(void 0!==a.groups)for(b=0;b<a.groups.length;b++){1<d.length&&(d+=" "+a.groupOp+" ");try{d+=this.getStringForGroup(a.groups[b])}catch(c){alert(c)}}if(void 0!==a.rules)try{for(b=0;b<a.rules.length;b++)1<d.length&&(d+=" "+a.groupOp+" "),d+=this.getStringForRule(a.rules[b])}catch(f){alert(f)}d+=")";return"()"===d?"":d};this.getStringForRule=function(d){var f="",b="",c,m;for(c=0;c<this.p.ops.length;c++)if(this.p.ops[c].oper===
        d.op){f=this.p.operands.hasOwnProperty(d.op)?this.p.operands[d.op]:"";b=this.p.ops[c].oper;break}for(c=0;c<this.p.columns.length;c++)if(this.p.columns[c].name===d.field){m=this.p.columns[c];break}if(void 0==m)return"";c=d.data;if("bw"===b||"bn"===b)c+="%";if("ew"===b||"en"===b)c="%"+c;if("cn"===b||"nc"===b)c="%"+c+"%";if("in"===b||"ni"===b)c=" ("+c+")";n.errorcheck&&u(d.data,m);return-1!==a.inArray(m.searchtype,["int","integer","float","number","currency"])||"nn"===b||"nu"===b?d.field+" "+f+" "+c:
        d.field+" "+f+' "'+c+'"'};this.resetFilter=function(){this.p.filter=a.extend(!0,{},this.p.initFilter);this.reDraw();this.onchange()};this.hideError=function(){a("th.ui-state-error",this).html("");a("tr.error",this).hide()};this.showError=function(){a("th.ui-state-error",this).html(this.p.errmsg);a("tr.error",this).show()};this.toUserFriendlyString=function(){return this.getStringForGroup(n.filter)};this.toString=function(){function a(b){var c="(",f;if(void 0!==b.groups)for(f=0;f<b.groups.length;f++)1<
    c.length&&(c="OR"===b.groupOp?c+" || ":c+" && "),c+=a(b.groups[f]);if(void 0!==b.rules)for(f=0;f<b.rules.length;f++){1<c.length&&(c="OR"===b.groupOp?c+" || ":c+" && ");var e=b.rules[f];if(d.p.errorcheck){for(var h=void 0,n=void 0,h=0;h<d.p.columns.length;h++)if(d.p.columns[h].name===e.field){n=d.p.columns[h];break}n&&u(e.data,n)}c+=e.op+"(item."+e.field+",'"+e.data+"')"}c+=")";return"()"===c?"":c}var d=this;return a(this.p.filter)};this.reDraw();if(this.p.showQuery)this.onchange();this.filter=!0}}})};
        a.extend(a.fn.jqFilter,{toSQLString:function(){var a="";this.each(function(){a=this.toUserFriendlyString()});return a},filterData:function(){var a;this.each(function(){a=this.p.filter});return a},getParameter:function(a){return void 0!==a&&this.p.hasOwnProperty(a)?this.p[a]:this.p},resetFilter:function(){return this.each(function(){this.resetFilter()})},addFilter:function(d){"string"===typeof d&&(d=a.jgrid.parse(d));this.each(function(){this.p.filter=d;this.reDraw();this.onchange()})}})})(jQuery);
    function tableToGrid(l,m){jQuery(l).each(function(){if(!this.grid){jQuery(this).width("99%");var b=jQuery(this).width(),c=jQuery("tr td:first-child input[type=checkbox]:first",jQuery(this)),a=jQuery("tr td:first-child input[type=radio]:first",jQuery(this)),c=0<c.length,a=!c&&0<a.length,k=c||a,d=[],e=[];jQuery("th",jQuery(this)).each(function(){0===d.length&&k?(d.push({name:"__selection__",index:"__selection__",width:0,hidden:!0}),e.push("__selection__")):(d.push({name:jQuery(this).attr("id")||jQuery.trim(jQuery.jgrid.stripHtml(jQuery(this).html())).split(" ").join("_"),
        index:jQuery(this).attr("id")||jQuery.trim(jQuery.jgrid.stripHtml(jQuery(this).html())).split(" ").join("_"),width:jQuery(this).width()||150}),e.push(jQuery(this).html()))});var f=[],g=[],h=[];jQuery("tbody > tr",jQuery(this)).each(function(){var b={},a=0;jQuery("td",jQuery(this)).each(function(){if(0===a&&k){var c=jQuery("input",jQuery(this)),e=c.attr("value");g.push(e||f.length);c.is(":checked")&&h.push(e);b[d[a].name]=c.attr("value")}else b[d[a].name]=jQuery(this).html();a++});0<a&&f.push(b)});
        jQuery(this).empty();jQuery(this).addClass("scroll");jQuery(this).jqGrid(jQuery.extend({datatype:"local",width:b,colNames:e,colModel:d,multiselect:c},m||{}));for(b=0;b<f.length;b++)a=null,0<g.length&&(a=g[b])&&a.replace&&(a=encodeURIComponent(a).replace(/[.\-%]/g,"_")),null===a&&(a=b+1),jQuery(this).jqGrid("addRowData",a,f[b]);for(b=0;b<h.length;b++)jQuery(this).jqGrid("setSelection",h[b])}})};
    (function(b){b.jgrid.msie&&8===b.jgrid.msiever()&&(b.expr[":"].hidden=function(b){return 0===b.offsetWidth||0===b.offsetHeight||"none"===b.style.display});b.jgrid._multiselect=!1;if(b.ui&&b.ui.multiselect){if(b.ui.multiselect.prototype._setSelected){var q=b.ui.multiselect.prototype._setSelected;b.ui.multiselect.prototype._setSelected=function(a,g){var c=q.call(this,a,g);if(g&&this.selectedList){var d=this.element;this.selectedList.find("li").each(function(){b(this).data("optionLink")&&b(this).data("optionLink").remove().appendTo(d)})}return c}}b.ui.multiselect.prototype.destroy&&
    (b.ui.multiselect.prototype.destroy=function(){this.element.show();this.container.remove();void 0===b.Widget?b.widget.prototype.destroy.apply(this,arguments):b.Widget.prototype.destroy.apply(this,arguments)});b.jgrid._multiselect=!0}b.jgrid.extend({sortableColumns:function(a){return this.each(function(){function g(){c.p.disableClick=!0}var c=this,d=b.jgrid.jqID(c.p.id),d={tolerance:"pointer",axis:"x",scrollSensitivity:"1",items:">th:not(:has(#jqgh_"+d+"_cb,#jqgh_"+d+"_rn,#jqgh_"+d+"_subgrid),:hidden)",
            placeholder:{element:function(a){return b(document.createElement(a[0].nodeName)).addClass(a[0].className+" ui-sortable-placeholder ui-state-highlight").removeClass("ui-sortable-helper")[0]},update:function(b,a){a.height(b.currentItem.innerHeight()-parseInt(b.currentItem.css("paddingTop")||0,10)-parseInt(b.currentItem.css("paddingBottom")||0,10));a.width(b.currentItem.innerWidth()-parseInt(b.currentItem.css("paddingLeft")||0,10)-parseInt(b.currentItem.css("paddingRight")||0,10))}},update:function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 d){var e=b(d.item).parent(),e=b(">th",e),f={},g=c.p.id+"_";b.each(c.p.colModel,function(b){f[this.name]=b});var h=[];e.each(function(){var a=b(">div",this).get(0).id.replace(/^jqgh_/,"").replace(g,"");f.hasOwnProperty(a)&&h.push(f[a])});b(c).jqGrid("remapColumns",h,!0,!0);b.isFunction(c.p.sortable.update)&&c.p.sortable.update(h);setTimeout(function(){c.p.disableClick=!1},50)}};c.p.sortable.options?b.extend(d,c.p.sortable.options):b.isFunction(c.p.sortable)&&(c.p.sortable={update:c.p.sortable});if(d.start){var h=
            d.start;d.start=function(b,a){g();h.call(this,b,a)}}else d.start=g;c.p.sortable.exclude&&(d.items+=":not("+c.p.sortable.exclude+")");d=a.sortable(d);d=d.data("sortable")||d.data("uiSortable");null!=d&&(d.data("sortable").floating=!0)})},columnChooser:function(a){function g(a,c){a&&("string"===typeof a?b.fn[a]&&b.fn[a].apply(c,b.makeArray(arguments).slice(2)):b.isFunction(a)&&a.apply(c,b.makeArray(arguments).slice(2)))}var c=this,d,h,m={},s=[],e,f,n=c.jqGrid("getGridParam","colModel"),t=c.jqGrid("getGridParam",
            "colNames"),k=function(a){return b.ui.multiselect.prototype&&a.data(b.ui.multiselect.prototype.widgetFullName||b.ui.multiselect.prototype.widgetName)||a.data("ui-multiselect")||a.data("multiselect")};if(!b("#colchooser_"+b.jgrid.jqID(c[0].p.id)).length){d=b('<div id="colchooser_'+c[0].p.id+'" style="position:relative;overflow:hidden"><div><select multiple="multiple"></select></div></div>');h=b("select",d);a=b.extend({width:400,height:240,classname:null,done:function(b){b&&c.jqGrid("remapColumns",
                b,!0)},msel:"multiselect",dlog:"dialog",dialog_opts:{minWidth:470,dialogClass:"ui-jqdialog"},dlog_opts:function(a){var c={};c[a.bSubmit]=function(){a.apply_perm();a.cleanup(!1)};c[a.bCancel]=function(){a.cleanup(!0)};return b.extend(!0,{buttons:c,close:function(){a.cleanup(!0)},modal:a.modal||!1,resizable:a.resizable||!0,width:a.width+70,resize:function(){var b=k(h),a=b.container.closest(".ui-dialog-content");0<a.length&&"object"===typeof a[0].style?a[0].style.width="":a.css("width","");b.selectedList.height(Math.max(b.selectedContainer.height()-
                    b.selectedActions.outerHeight()-1,1));b.availableList.height(Math.max(b.availableContainer.height()-b.availableActions.outerHeight()-1,1))}},a.dialog_opts||{})},apply_perm:function(){var d=[];b("option",h).each(function(){b(this).is("[selected]")?c.jqGrid("showCol",n[this.value].name):c.jqGrid("hideCol",n[this.value].name)});b("option[selected]",h).each(function(){d.push(parseInt(this.value,10))});b.each(d,function(){delete m[n[parseInt(this,10)].name]});b.each(m,function(){var b=parseInt(this,10);
                var a=d,c=b,e,f;0<=c?(e=a.slice(),f=e.splice(c,Math.max(a.length-c,c)),c>a.length&&(c=a.length),e[c]=b,d=e.concat(f)):d=a});a.done&&a.done.call(c,d);c.jqGrid("setGridWidth",c[0].p.tblwidth,c[0].p.shrinkToFit)},cleanup:function(b){g(a.dlog,d,"destroy");g(a.msel,h,"destroy");d.remove();b&&a.done&&a.done.call(c)},msel_opts:{}},b.jgrid.col,a||{});if(b.ui&&b.ui.multiselect&&b.ui.multiselect.defaults){if(!b.jgrid._multiselect){alert("Multiselect plugin loaded after jqGrid. Please load the plugin before the jqGrid!");
            return}a.msel_opts=b.extend(b.ui.multiselect.defaults,a.msel_opts)}a.caption&&d.attr("title",a.caption);a.classname&&(d.addClass(a.classname),h.addClass(a.classname));a.width&&(b(">div",d).css({width:a.width,margin:"0 auto"}),h.css("width",a.width));a.height&&(b(">div",d).css("height",a.height),h.css("height",a.height-10));h.empty();b.each(n,function(a){m[this.name]=a;this.hidedlg?this.hidden||s.push(a):h.append("<option value='"+a+"' "+(this.hidden?"":"selected='selected'")+">"+b.jgrid.stripHtml(t[a])+
            "</option>")});e=b.isFunction(a.dlog_opts)?a.dlog_opts.call(c,a):a.dlog_opts;g(a.dlog,d,e);e=b.isFunction(a.msel_opts)?a.msel_opts.call(c,a):a.msel_opts;g(a.msel,h,e);e=b("#colchooser_"+b.jgrid.jqID(c[0].p.id));e.css({margin:"auto"});e.find(">div").css({width:"100%",height:"100%",margin:"auto"});e=k(h);e.container.css({width:"100%",height:"100%",margin:"auto"});e.selectedContainer.css({width:100*e.options.dividerLocation+"%",height:"100%",margin:"auto",boxSizing:"border-box"});e.availableContainer.css({width:100-
                100*e.options.dividerLocation+"%",height:"100%",margin:"auto",boxSizing:"border-box"});e.selectedList.css("height","auto");e.availableList.css("height","auto");f=Math.max(e.selectedList.height(),e.availableList.height());f=Math.min(f,b(window).height());e.selectedList.css("height",f);e.availableList.css("height",f)}},sortableRows:function(a){return this.each(function(){var g=this;g.grid&&!g.p.treeGrid&&b.fn.sortable&&(a=b.extend({cursor:"move",axis:"y",items:".jqgrow"},a||{}),a.start&&b.isFunction(a.start)?
            (a._start_=a.start,delete a.start):a._start_=!1,a.update&&b.isFunction(a.update)?(a._update_=a.update,delete a.update):a._update_=!1,a.start=function(c,d){b(d.item).css("border-width","0");b("td",d.item).each(function(b){this.style.width=g.grid.cols[b].style.width});if(g.p.subGrid){var h=b(d.item).attr("id");try{b(g).jqGrid("collapseSubGridRow",h)}catch(m){}}a._start_&&a._start_.apply(this,[c,d])},a.update=function(c,d){b(d.item).css("border-width","");!0===g.p.rownumbers&&b("td.jqgrid-rownum",g.rows).each(function(a){b(this).html(a+
            1+(parseInt(g.p.page,10)-1)*parseInt(g.p.rowNum,10))});a._update_&&a._update_.apply(this,[c,d])},b("tbody:first",g).sortable(a),b("tbody:first",g).disableSelection())})},gridDnD:function(a){return this.each(function(){function g(){var a=b.data(c,"dnd");b("tr.jqgrow:not(.ui-draggable)",c).draggable(b.isFunction(a.drag)?a.drag.call(b(c),a):a.drag)}var c=this,d,h;if(c.grid&&!c.p.treeGrid&&b.fn.draggable&&b.fn.droppable)if(void 0===b("#jqgrid_dnd")[0]&&b("body").append("<table id='jqgrid_dnd' class='ui-jqgrid-dnd'></table>"),
        "string"===typeof a&&"updateDnD"===a&&!0===c.p.jqgdnd)g();else if(a=b.extend({drag:function(a){return b.extend({start:function(d,e){var f;if(c.p.subGrid){f=b(e.helper).attr("id");try{b(c).jqGrid("collapseSubGridRow",f)}catch(g){}}for(f=0;f<b.data(c,"dnd").connectWith.length;f++)0===b(b.data(c,"dnd").connectWith[f]).jqGrid("getGridParam","reccount")&&b(b.data(c,"dnd").connectWith[f]).jqGrid("addRowData","jqg_empty_row",{});e.helper.addClass("ui-state-highlight");b("td",e.helper).each(function(b){this.style.width=
                    c.grid.headers[b].width+"px"});a.onstart&&b.isFunction(a.onstart)&&a.onstart.call(b(c),d,e)},stop:function(d,e){var f;e.helper.dropped&&!a.dragcopy&&(f=b(e.helper).attr("id"),void 0===f&&(f=b(this).attr("id")),b(c).jqGrid("delRowData",f));for(f=0;f<b.data(c,"dnd").connectWith.length;f++)b(b.data(c,"dnd").connectWith[f]).jqGrid("delRowData","jqg_empty_row");a.onstop&&b.isFunction(a.onstop)&&a.onstop.call(b(c),d,e)}},a.drag_opts||{})},drop:function(a){return b.extend({accept:function(a){if(!b(a).hasClass("jqgrow"))return a;
                    a=b(a).closest("table.ui-jqgrid-btable");return 0<a.length&&void 0!==b.data(a[0],"dnd")?(a=b.data(a[0],"dnd").connectWith,-1!==b.inArray("#"+b.jgrid.jqID(this.id),a)?!0:!1):!1},drop:function(d,e){if(b(e.draggable).hasClass("jqgrow")){var f=b(e.draggable).attr("id"),f=e.draggable.parent().parent().jqGrid("getRowData",f);if(!a.dropbyname){var g=0,h={},k,p,r=b("#"+b.jgrid.jqID(this.id)).jqGrid("getGridParam","colModel");try{for(p in f)f.hasOwnProperty(p)&&(k=r[g].name,"cb"!==k&&"rn"!==k&&"subgrid"!==
                k&&f.hasOwnProperty(p)&&r[g]&&(h[k]=f[p]),g++);f=h}catch(q){}}e.helper.dropped=!0;a.beforedrop&&b.isFunction(a.beforedrop)&&(k=a.beforedrop.call(this,d,e,f,b("#"+b.jgrid.jqID(c.p.id)),b(this)),void 0!==k&&null!==k&&"object"===typeof k&&(f=k));if(e.helper.dropped){var l;a.autoid&&(b.isFunction(a.autoid)?l=a.autoid.call(this,f):(l=Math.ceil(1E3*Math.random()),l=a.autoidprefix+l));b("#"+b.jgrid.jqID(this.id)).jqGrid("addRowData",l,f,a.droppos)}a.ondrop&&b.isFunction(a.ondrop)&&a.ondrop.call(this,d,e,
                    f)}}},a.drop_opts||{})},onstart:null,onstop:null,beforedrop:null,ondrop:null,drop_opts:{activeClass:"ui-state-active",hoverClass:"ui-state-hover"},drag_opts:{revert:"invalid",helper:"clone",cursor:"move",appendTo:"#jqgrid_dnd",zIndex:5E3},dragcopy:!1,dropbyname:!1,droppos:"first",autoid:!0,autoidprefix:"dnd_"},a||{}),a.connectWith)for(a.connectWith=a.connectWith.split(","),a.connectWith=b.map(a.connectWith,function(a){return b.trim(a)}),b.data(c,"dnd",a),0===c.p.reccount||c.p.jqgdnd||g(),c.p.jqgdnd=
            !0,d=0;d<a.connectWith.length;d++)h=a.connectWith[d],b(h).droppable(b.isFunction(a.drop)?a.drop.call(b(c),a):a.drop)})},gridResize:function(a){return this.each(function(){var g=this,c=b.jgrid.jqID(g.p.id);g.grid&&b.fn.resizable&&(a=b.extend({},a||{}),a.alsoResize?(a._alsoResize_=a.alsoResize,delete a.alsoResize):a._alsoResize_=!1,a.stop&&b.isFunction(a.stop)?(a._stop_=a.stop,delete a.stop):a._stop_=!1,a.stop=function(d,h){b(g).jqGrid("setGridParam",{height:b("#gview_"+c+" .ui-jqgrid-bdiv").height()});
            b(g).jqGrid("setGridWidth",h.size.width,a.shrinkToFit);a._stop_&&a._stop_.call(g,d,h)},a.alsoResize=a._alsoResize_?eval("("+("{'#gview_"+c+" .ui-jqgrid-bdiv':true,'"+a._alsoResize_+"':true}")+")"):b(".ui-jqgrid-bdiv","#gview_"+c),delete a._alsoResize_,b("#gbox_"+c).resizable(a))})}})})(jQuery);

    /*JC022736 - localization file needed for date formatting, sorting, etc. This is the locale file downloaded with the jqGrid vs 4.7.1 located in the js/i18n folder. If any other localization is needed you will need to download it from jqGrid and replace this with the one needed.   */
    (function(e){e.jgrid=e.jgrid||{};e.extend(e.jgrid,{defaults:{recordtext:"View {0} - {1} of {2}",emptyrecords:"No records to view",loadtext:"Loading...",pgtext:"Page {0} of {1}",pgfirst:"First Page",pglast:"Last Page",pgnext:"Next Page",pgprev:"Previous Page",pgrecs:"Records per Page",showhide:"Toggle Expand Collapse Grid"},search:{caption:"Search...",Find:"Find",Reset:"Reset",odata:[{oper:"eq",text:"equal"},{oper:"ne",text:"not equal"},{oper:"lt",text:"less"},{oper:"le",text:"less or equal"},{oper:"gt",text:"greater"},{oper:"ge",text:"greater or equal"},{oper:"bw",text:"begins with"},{oper:"bn",text:"does not begin with"},{oper:"in",text:"is in"},{oper:"ni",text:"is not in"},{oper:"ew",text:"ends with"},{oper:"en",text:"does not end with"},{oper:"cn",text:"contains"},{oper:"nc",text:"does not contain"},{oper:"nu",text:"is null"},{oper:"nn",text:"is not null"}],groupOps:[{op:"AND",text:"all"},{op:"OR",text:"any"}],operandTitle:"Click to select search operation.",resetTitle:"Reset Search Value"},edit:{addCaption:"Add Record",editCaption:"Edit Record",bSubmit:"Submit",bCancel:"Cancel",bClose:"Close",saveData:"Data has been changed! Save changes?",bYes:"Yes",bNo:"No",bExit:"Cancel",msg:{required:"Field is required",number:"Please, enter valid number",minValue:"value must be greater than or equal to ",maxValue:"value must be less than or equal to",email:"is not a valid e-mail",integer:"Please, enter valid integer value",date:"Please, enter valid date value",url:"is not a valid URL. Prefix required ('http://' or 'https://')",nodefined:" is not defined!",novalue:" return value is required!",customarray:"Custom function should return array!",customfcheck:"Custom function should be present in case of custom checking!"}},view:{caption:"View Record",bClose:"Close"},del:{caption:"Delete",msg:"Delete selected record(s)?",bSubmit:"Delete",bCancel:"Cancel"},nav:{edittext:"",edittitle:"Edit selected row",addtext:"",addtitle:"Add new row",deltext:"",deltitle:"Delete selected row",searchtext:"",searchtitle:"Find records",refreshtext:"",refreshtitle:"Reload Grid",alertcap:"Warning",alerttext:"Please, select row",viewtext:"",viewtitle:"View selected row"},col:{caption:"Select columns",bSubmit:"Ok",bCancel:"Cancel"},errors:{errcap:"Error",nourl:"No url is set",norecords:"No records to process",model:"Length of colNames <> colModel!"},formatter:{integer:{thousandsSeparator:",",defaultValue:"0"},number:{decimalSeparator:".",thousandsSeparator:",",decimalPlaces:2,defaultValue:"0.00"},currency:{decimalSeparator:".",thousandsSeparator:",",decimalPlaces:2,prefix:"",suffix:"",defaultValue:"0.00"},date:{dayNames:["Sun","Mon","Tue","Wed","Thr","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"],AmPm:["am","pm","AM","PM"],S:function(e){return e<11||e>13?["st","nd","rd","th"][Math.min((e-1)%10,3)]:"th"},srcformat:"Y-m-d",newformat:"n/j/Y",parseRe:/[#%\\\/:_;.,\t\s-]/,masks:{ISO8601Long:"Y-m-d H:i:s",ISO8601Short:"Y-m-d",ShortDate:"n/j/Y",LongDate:"l, F d, Y",FullDateTime:"l, F d, Y g:i:s A",MonthDay:"F d",ShortTime:"g:i A",LongTime:"g:i:s A",SortableDateTime:"Y-m-d\\TH:i:s",UniversalSortableDateTime:"Y-m-d H:i:sO",YearMonth:"F, Y"},reformatAfterEdit:false,userLocalTime:false},baseLinkUrl:"",showAction:"",target:"",checkbox:{disabled:true},idName:"id"}})})(jQuery)

    cerner.etreby_drugHistory = function(drugId, callback){
        var histcomponent = this,
            request = new XMLHttpRequest(),
            url = 'https://chlacaetb04.cernerasp.com:2048/ce-json';  //RESOURCE URL

        var url2 = drugId;

        request.open('GET', url2, true);
        request.setRequestHeader('resourcename', 'RxDetails');
        request.setRequestHeader('apikey', 'bf5488c6-5248-4104-97c5-3fd4fac92c14');

        request.onreadystatechange = function (event) {
            if (request.readyState === 4) {
                if (request.status === 200) {
                    histcomponent.data = request.responseText;
                } else {
                    alert("Request status: " + request.status + "\nReponse text: " + request.responseText);
                }

                var histobj = JSON.parse(histcomponent.data);

                var htrElement = null;
                var htableElement = document.createElement("table");
                var hthElement = document.createElement('thead');
                var htableBodyElement = document.createElement("tbody");
                var sdh = document.createElement("th");
                var puh = document.createElement("th");
                var dqh = document.createElement("th");
                var dsh = document.createElement("th");
                sdh.innerHTML = "Filled Date";
                sdh.className = 'cerner_etreby_history_header';
                puh.innerHTML = "Picked Up Date";
                puh.className = 'cerner_etreby_history_header';
                dqh.innerHTML = "Dispensed Quantity";
                dqh.className = 'cerner_etreby_history_header';
                dsh.innerHTML = "Days Supply";
                dsh.className = 'cerner_etreby_history_header';
                hthElement.appendChild(sdh);
                hthElement.appendChild(puh);
                hthElement.appendChild(dqh);
                hthElement.appendChild(dsh);

                for(var y = 0; y < histobj.ReFillDetails.length; y++){
                    hist = histobj.ReFillDetails[y];
                    var htrElement = document.createElement("tr");
                    var sd = document.createElement("td");
                    var pu = document.createElement("td");
                    var dq = document.createElement("td");
                    var ds = document.createElement("td");
                    sd.innerHTML = hist.DateFilled;
                    //JC022736 - Strip seconds off of the date time string being returned from Etreby service using regular expression.
                    pu.innerHTML = hist.PickUpDate.replace(/:\d\d /, ' ');
                    dq.innerHTML = hist.DispensedQty;
                    ds.innerHTML = hist.DaysSupply;
                    htrElement.appendChild(sd);
                    htrElement.appendChild(pu);
                    htrElement.appendChild(dq);
                    htrElement.appendChild(ds);

                    htableBodyElement.appendChild(htrElement);
                }

                htableElement.appendChild(hthElement);
                htableElement.appendChild(htableBodyElement);

                // pop up dialog box
                var drugHistoryUtil = new ModalDialog("drugHistory")
                    .setHeaderTitle('Prescription Refill History')
                    .setShowCloseIcon(true)
                    .setTopMarginPercentage(15)
                    .setRightMarginPercentage(30)
                    .setBottomMarginPercentage(15)
                    .setLeftMarginPercentage(30)
                    .setIsBodySizeFixed(false)
                    .setIsFooterAlwaysShown(true);

                drugHistoryUtil.setBodyDataFunction(
                    function(modalObj){
                        modalObj.setBodyHTML('<table>' + htableElement.innerHTML + '</table>');
                    }
                );

                MP_ModalDialog.updateModalDialogObject(drugHistoryUtil);
                MP_ModalDialog.showModalDialog(drugHistoryUtil.getId());
                callback(histcomponent);
            }
        };

        request.send(null);
    };

    cerner.etreby_patientHistory.prototype.render=function(){
        var contentArea = this.getTarget();
        var pui;
        var lastName;
        var firstName;
        var dob;
        var alias;

        //UNIQUE IDENTIFIER TYPE
        //used to get unique alias in millennium
        //populate identifierType variable below with display_key from codeset 263 for client defined alias (MRN, etc...)
        //if using person id rather than an alias, leave the variable empty (ex. var identifierType = "";)
        var identifierType = "MRNCHLA"; //"BWMCMRN";

        //ETREBY SERVICE QUERY PARAMTER
        //used to get unique identifier in etreby database
        //populate puiFieldName varaible below with etreby defined alias values (MRN, etc...)
        //if using alias other than MRN specify the puiFieldName, otherwise leave the variable empty (ex. var puiFieldName = "";)
        var puiFieldName = ""; //"MRN";

        //FLAG TO TURN ON PADDING –DEFAULT SHOULD BE FALSE
        //If client pads the value with leading zeroes when it is sent over to Etreby database then set this to true.
        //This will ensure that whatever value is being padded (MRN, person ID, etc.) will be padded with enough leading zeroes to make the total length of the value equal to the padWidth below.
        var padWithLeadingZeroes = false;

        //WIDTH OF ID USED FOR PADDING ABOVE – ONLY USED IF ABOVE IS SET TO TRUE (padWithLeadingZeroes = true)
        //Set this to whatever value needed to match up with length of value being stored in Etreby database to ensure enough leading zeroes are being added.
        //By default it will pad with however many zeroes needed to equal 8 digit value. This can be changed by changing number below to whatever needed.
        //It will not use this at all in the code unless flag above (padWithLeadingZeroes) is set to true.
        var padWidth = 8;

        //ETREBY SERVICE QUERY PARAMTER TO SET WHETHER OR NOT FILE ONLY PRESCRIPTIONS SHOULD BE RETURNED - DEFAULT SHOULD BE FALSE
        //Set this to true if you would like to include FO (File Only) prescription types in the results from Etreby service.
        var fileOnly = false;

        var cclRequest = new XMLCclRequest();
        var cclScriptName = "MP_GET_ETREBY_PATIENT";
        var params =  "^MINE^," + this.getProperty("personId") + ".0,^" + identifierType + "^";
        cclRequest.open('GET', cclScriptName, 0);
        cclRequest.send(params);
        if (cclRequest.status === 200) {
            var json = JSON.parse(cclRequest.responseText);
            lastName = json.PATIENTINFO.LAST_NAME;
            firstName = json.PATIENTINFO.FIRST_NAME;
            dob = json.PATIENTINFO.DOB;
            if (identifierType.length > 0) {
                alias = json.PATIENTINFO.ALIAS;
            } else {
                alias = this.getProperty("personId")
            }
        }

        //load patient drugs
        var dateString;
        var currentDate = new Date();
        var newDate = new Date(currentDate - (1000*60*60*24*1830)); // SET LOOKBACK DAYS HERE -- currently set to 730 days (2 years)
        var day = newDate.getDate();
        var month = newDate.getMonth()+1;
        var year = newDate.getFullYear();

        //This function will pad the number being passed over to Etreby (first parameter numberToPad) with enough leading zeroes to equal the width being passed in as second parameter.
        function addZeroes(numberToPad, width) {
            width -= numberToPad.toString().length;  //determine how many zeroes are needed to equal width.

            if (width >0) {
                return new Array( width + (/\./.test(numberToPad) ? 2 : 1) ).join( '0' ) + numberToPad;
            }
            return numberToPad + "";
        }

        //Check to see if we need to pad with leading zeroes.
        if (padWithLeadingZeroes) {
            alias = addZeroes(alias, padWidth);
        }

        dateString = (month<=9?'0'+month:month) + '/' + (day<=9?'0'+day:day) + '/' + year;
        var drugParams;
        if (identifierType.length > 0) {
            drugParams = '{"firstName":"' + firstName + '","lastName":"' + lastName + '","dob":"' + dob + '","pui":"' + alias + '","puiFieldName":"' + puiFieldName + '","startDate":"' + dateString + '","fileOnly":"' + fileOnly + '"}';
        } else {
            drugParams = '{"firstName":"' + firstName + '","lastName":"' + lastName + '","dob":"' + dob + '","pui":"' + alias + '","startDate":"' + dateString + '","fileOnly":"' + fileOnly + '"}';
        }

        var mycomponent = this,
            request = new XMLHttpRequest(),
            url = 'https://chlacaetb04.cernerasp.com:2048/ce-json'; //RESOURCE URL

        var url2 ='https://chlacaetb04.cernerasp.com:2048/ce-json';  //RESOURCE URL

        request.open('GET', url2, true);
        request.setRequestHeader('apikey', 'bf5488c6-5248-4104-97c5-3fd4fac92c14');
        request.setRequestHeader('resourcename', 'PatientDrugHistory');
        request.setRequestHeader('resourceparams', drugParams);

        var errorString;
        var ErrorMessage;
        request.onreadystatechange = function (event) {
            var successInd = false;
            if (request.readyState === 4) {
                if (request.status === 200) {
                    mycomponent.data = request.responseText;
                    var medobj = JSON.parse(mycomponent.data);
                    successInd = true;
                } else {

                    try
                    {
                        var ceMessage = request.responseText.substring(1,request.responseText.length-1);
                        ceMessage = ceMessage.replace(/\\/g, "");
                        var errObj = JSON.parse(ceMessage);
                        if (errObj !== "null" && errObj !== "undefined" && errObj.Message !== "undefined"){
                            errorMessage= errObj.Message;
                        }
                        else {
                            errorMessage = 'Fail to parse: '+ ceMessage; // request.responseText;
                        }
                    }
                    catch (err) {
                        if (request.status === 404)
                            errorMessage = 'Service or resource not found.';
                        else
                            errorMessage = 'Error Parsing Message. ' + request.responseText;
                    }


                    //errorMessage = request.responseText;
                }

                var trElement = null;
                var divElement = document.createElement("div");
                var tableElement = document.createElement("table");
                var thElement = document.createElement('thead');
                var tableBodyElement = document.createElement("tbody");
                var tableRowElement = document.createElement("tr");
                var fdh = document.createElement("th");
                var puh = document.createElement("th");
                var ddh = document.createElement("th");
                var pth = document.createElement("th");
                var sgh = document.createElement("th");
                var dqh = document.createElement("th");
                var rrh = document.createElement("th");
                var dnh = document.createElement("th");
                var dwh = document.createElement("th");
                var rxh = document.createElement("th");
                tableElement.id = 'etrebyTable';
                fdh.innerHTML = "Filled Date";
                fdh.className = 'cerner_etreby_header';
                fdh.id = 'filledDate';
                puh.innerHTML = "Picked Up Date";
                puh.className = 'cerner_etreby_header';
                puh.id = 'pickedUpDate';
                ddh.innerHTML = "Dispensed Drug";
                ddh.className = 'cerner_etreby_header';
                ddh.id = 'dispensedDrug';
                pth.innerHTML = "Prescription </br> Type";
                pth.className = 'cerner_etreby_header';
                pth.id = 'prescriptionType';
                sgh.innerHTML = "SIG";
                sgh.className = 'cerner_etreby_header';
                sgh.id = 'sig';
                dqh.innerHTML = "Dispensed </br> Quantity";
                dqh.className = 'cerner_etreby_header';
                dqh.id = 'dispensedQuantity';
                rrh.innerHTML = "Remaining </br> Refills";
                rrh.className = 'cerner_etreby_header';
                rrh.id = 'remainingRefills';
                dnh.innerHTML = "Doctor Name";
                dnh.className = 'cerner_etreby_header';
                dnh.id = 'doctorName';
                dwh.innerHTML = "Date </br> Written";
                dwh.className = 'cerner_etreby_header';
                dwh.id = 'dateWritten';
                rxh.innerHTML = "Rx </br> Number";
                rxh.className = 'cerner_etreby_header';
                rxh.id = 'rxNumber';
                tableRowElement.appendChild(fdh);
                tableRowElement.appendChild(puh);
                tableRowElement.appendChild(ddh);
                tableRowElement.appendChild(pth);
                tableRowElement.appendChild(sgh);
                tableRowElement.appendChild(dqh);
                tableRowElement.appendChild(rrh);
                tableRowElement.appendChild(dnh);
                tableRowElement.appendChild(dwh);
                tableRowElement.appendChild(rxh);
                thElement.appendChild(tableRowElement);
                if (successInd === true) {
                    for(var x = 0; x < medobj.PatientPrescriptions.length; x++){
                        //window.alert(x);
                        medication = medobj.PatientPrescriptions[x];
                        var trElement = document.createElement("tr");
                        var fd = document.createElement("td");
                        var pu = document.createElement("td");
                        var dd = document.createElement("td");
                        var pt = document.createElement("td");
                        var sg = document.createElement("td");
                        var dq = document.createElement("td");
                        var rr = document.createElement("td");
                        var dn = document.createElement("td");
                        var dw = document.createElement("td");
                        var rx = document.createElement("td");
                        fd.innerHTML = medication.LastServiceDate;
                        //JC022736 UW Issue where Picked Up Date was displaying the same as filled date. This was because medication.LastServiceDate was being used in both places for the data.
                        pu.innerHTML = medication.PickUpDate.replace(/:\d\d /, ' ');
                        dd.innerHTML = medication.DispensedDrug;
                        pt.innerHTML = medication.PrescriptionType;
                        sg.innerHTML = medication.Sig;
                        dq.innerHTML = medication.DispensedQty;
                        rr.innerHTML = medication.RemainingRefills;
                        dn.innerHTML = medication.DoctorName;
                        dw.innerHTML = medication.DateWritten;
                        rx.innerHTML = medication.RxNumber;
                        trElement.setAttribute('data-drugId', medication.RxDetailsLink);
                        trElement.appendChild(fd);
                        trElement.appendChild(pu);
                        trElement.appendChild(dd);
                        trElement.appendChild(pt);
                        trElement.appendChild(sg);
                        trElement.appendChild(dq);
                        trElement.appendChild(rr);
                        trElement.appendChild(dn);
                        trElement.appendChild(dw);
                        trElement.appendChild(rx);

                        tableBodyElement.appendChild(trElement);
                    }

                    tableElement.appendChild(thElement);
                    tableElement.appendChild(tableBodyElement);
                    divElement.appendChild(tableElement);

                    if (1 > 0){
                        contentArea.appendChild(divElement);
                    } else {
                        contentArea.innerHTML = "No prescription history data found for this person";
                    }

                    //JC022736 - This takes the existing HTML table originally created as part of this custom component and converts it to a jqGrid.
                    tableToGrid('#etrebyTable',{
                        //If you want the component to be taller/shorter, simply change this height and it will alter the height of the grid accordingly.
                        height: 400,
                        altRows: true,
                        loadonce:true,
                        sortable: true,
                        rowNum:medobj.PatientPrescriptions.length + 50,
                        altclass: 'myAltRowClass',   //this is the class defined in the custom-components.css to add color to alternate rows.
                        onSelectRow: function(rowid, stat, e){
                            //get data based on drugId
                            var drugId = medobj.PatientPrescriptions[rowid-1].RxDetailsLink;
                            cerner.etreby_drugHistory(drugId, function(){});
                            //Added this to remove the highlighting of rows after showing the refill history so that you don't end up with two highlighted rows when clicking around on grid.
                            $(this).jqGrid("resetSelection");
                        },
                        //Added this function on the double clicking of rows because it was causing multiple windows to pop open for refill history if you clicked too many times.
                        ondblClickRow: function(){
                            return false ;
                        },
                        //Since we are converting table to grid, we have to configure the properties of the columns after they are loaded into the grid. This is necessary in order to ensure it sorts correctly on dates, etc.
                        loadComplete: function(data) {
                            $('#etrebyTable').setColProp('filledDate',{sorttype:'date', datefmt: 'm/d/Y', align: 'center'});
                            $('#etrebyTable').setColProp('pickedUpDate',{sorttype:'date', datefmt: 'm/d/Y', align: 'center'});
                            $('#etrebyTable').setColProp('prescriptionType',{sorttype:'text', align: 'center'});
                            $('#etrebyTable').setColProp('dispensedDrug',{align: 'left',sorttype:function(cell,obj){
                                    return cell.toLowerCase();;
                                }});
                            $('#etrebyTable').setColProp('dispensedQuantity',{sorttype:'int', align: 'center'});
                            $('#etrebyTable').setColProp('remainingRefills',{sorttype:'int', align: 'center'});
                            $('#etrebyTable').setColProp('dateWritten',{sorttype:'date', datefmt: 'm/d/Y', align: 'center'});
                            $('#etrebyTable').setColProp('rxNumber',{sorttype:'int', align: 'center'});

                            $.jgrid.extend({
                                setColWidth: function (iCol, newWidth, adjustGridWidth) {
                                    return this.each(function () {
                                        var $self = $(this), grid = this.grid, p = this.p, colName, colModel = p.colModel, i, nCol;
                                        if (typeof iCol === "string") {
                                            // the first parameter is column name instead of index
                                            colName = iCol;
                                            for (i = 0, nCol = colModel.length; i < nCol; i++) {
                                                if (colModel[i].name === colName) {
                                                    iCol = i;
                                                    break;
                                                }
                                            }
                                            if (i >= nCol) {
                                                return; // error: non-existing column name specified as the first parameter
                                            }
                                        } else if (typeof iCol !== "number") {
                                            return; // error: wrong parameters
                                        }
                                        grid.resizing = { idx: iCol };
                                        grid.headers[iCol].newWidth = newWidth;
                                        grid.newWidth = p.tblwidth + newWidth - grid.headers[iCol].width;
                                        grid.dragEnd();   // adjust column width
                                        if (adjustGridWidth !== false) {
                                            $self.jqGrid("setGridWidth", grid.newWidth, false); // adjust grid width too
                                        }
                                    });
                                }
                            });
                            //This is to ensure the grid and SIG column is resized accordingly when window is resized.
                            $(window).bind('resize', function() {

                                if (grid = $('.ui-jqgrid-btable:visible')) {
                                    var gridId,gridParentWidth;
                                    grid.each(function(index) {
                                        gridId = $(this).attr('id');
                                        gridParentWidth = $('#gbox_' + gridId).parent().width();
                                        $('#' + gridId).setGridWidth(gridParentWidth);
                                    });
                                    //Putting this inside the resize event so that after the grid is resized the width of SIG column will take up 25% of the new grid width.
                                    var sigColumnWidth = (gridParentWidth * .25);

                                    $('#etrebyTable').setColWidth('sig', sigColumnWidth, false);
                                    $('#etrebyTable').setColProp('sig',{fixed:true});
                                    //Hack to ensure the grid is set back to the new width after the resizing of the SIG column. In some browsers/screen sizes the SIG resize was shrinking the grid too small.
                                    $('#' + gridId).setGridWidth(gridParentWidth);
                                }

                            }).trigger('resize');
                            //$("#etrebyTable").remapColumns([8,2,1,3,4,5,6,7,0,9],true,false);
                        }
                    });
                } else {
                    contentArea.innerHTML = errorMessage;
                }
            }
        };
        request.send(null);

    };
})();


/******************************************************************************************
 Client:
 File: 	custom-components.js
 Team:	Physician Innovations

 Table of Contents:
 01.)	differential_diagnosis 		Provides clinicians with the recommendations for
 diagnoses using third party medical knowledge
 databases and algorithms with patient-specific data.
 *******************************************************************************************
 CONTROL LOG
 *******************************************************************************************
 Date    	Engineer ID            	Comment
 ----------	------------------- 	---------------------------------------------
 1/15/2015 	AG030750				Initial release
 1/30/2015	VC030680				Differential Diagnoses/Note Section  Development
 3/24/2015	SV4030					Timers
 3/03/2016   AG030750                Enhancement to display multiple levels of diagnosis
 7/27/2016   AG030750                Add functionality to allow filtering by physician authored notes
 *******************************************************************************************/
/*
  Copyright 2011 Cerner Corporation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
*/
MPage.namespace("cerner");
cerner.differential_diagnosis = function(){};


cerner.differential_diagnosis.prototype = new MPage.Component();
cerner.differential_diagnosis.prototype.constructor = MPage.Component;

//Global Constants For Differential Diagnosis Component
cerner.differential_diagnosis.prototype.ROSHPIPELabel = "Review of Systems/History of Present Illness/Physical Exam";
cerner.differential_diagnosis.prototype.ProviderNotesOnlyLabel = "Provider Only";
//cerner.differential_diagnosis.prototype.ISABEL_USERNAME= "cerner_smartnote";
cerner.differential_diagnosis.prototype.ISABEL_USERNAME= "chla";
//cerner.differential_diagnosis.prototype.ISABEL_PASSWORD= "cr_i_21000";
cerner.differential_diagnosis.prototype.ISABEL_PASSWORD= "chla_i_10000";
cerner.differential_diagnosis.prototype.ISABEL_POST_SERVICE_URL = "http://service.enhancedmd.com:80/smartnoteservice-dev/service/";
cerner.differential_diagnosis.prototype.XML_SOAPENV = "http://schemas.xmlsoap.org/soap/envelope/";
cerner.differential_diagnosis.prototype.ISABEL_SCHEMA_URL = "http://service.enhancedmd.com/SmartNoteServices/schemas";
cerner.differential_diagnosis.prototype.DIFF_DX_RESULTS_LABEL = "Generated Differential Diagnosis";

//Visual Cue Handlers
//Error Messages and Information Text
cerner.differential_diagnosis.prototype.GENDER_ERROR = "GENDER_ERROR";
cerner.differential_diagnosis.prototype.GENDER_ALERT_HEADER = "Patient's sex is not documented.";
cerner.differential_diagnosis.prototype.GENDER_ALERT_MESSAGE = "Documenting the patient's sex allows for a sex-specific differential diagnosis. It is recommended to document patient's sex and resubmit.";

cerner.differential_diagnosis.prototype.AGE_ERROR = "AGE_ERROR";
cerner.differential_diagnosis.prototype.AGE_ERROR_HEADER = "Date of birth is not documented.";
cerner.differential_diagnosis.prototype.AGE_ERROR_MESSAGE = "The patient's date of birth is required to generate a differential diagnosis. Ensure the birth date is documented, then refresh the page and try again.";

cerner.differential_diagnosis.prototype.NO_WF_ERROR = "NO_WF_ERROR";
cerner.differential_diagnosis.prototype.NO_WF_INFO_MESSAGE_LINE_1 = "To generate a differential diagnosis, complete one of the following steps:";
cerner.differential_diagnosis.prototype.NO_WF_INFO_MESSAGE_LINE_2 = "Document one or more of the sections below and refresh the page.";
cerner.differential_diagnosis.prototype.NO_WF_INFO_MESSAGE_LINE_3 = "Subjective/History of Present Illness";
cerner.differential_diagnosis.prototype.NO_WF_INFO_MESSAGE_LINE_4 = "Review of Systems";
cerner.differential_diagnosis.prototype.NO_WF_INFO_MESSAGE_LINE_5 = "Objective/Physical Exam";
cerner.differential_diagnosis.prototype.NO_WF_INFO_MESSAGE_LINE_6 = "Select an item and click Review Selected Note(s) if items are listed in the Note Selection List.";

cerner.differential_diagnosis.prototype.NO_RESULTS_ERROR = "NO_RESULTS_ERROR";
cerner.differential_diagnosis.prototype.NO_RESULTS_ALERT_HEADER = "No Results";
cerner.differential_diagnosis.prototype.NO_RESULTS_ALERT_MESSAGE = "Your query produced no results. Refine your query and check your spelling and terminology.";

cerner.differential_diagnosis.prototype.ISABEL_SERVICE_DOWN_ERROR = "ISABEL_SERVICE_DOWN_ERROR";
cerner.differential_diagnosis.prototype.ISABEL_SERVICE_DOWN_ERROR_HEADER = "Service Error";
cerner.differential_diagnosis.prototype.ISABEL_SERVICE_DOWN_ERROR_MESSAGE = "The Isabel Differential Diagnosis service is unavailable. Contact your application administrator if the problem persists.";

cerner.differential_diagnosis.prototype.ISABEL_PLEASE_NOTE_INFO = "ISABEL_PLEASE_NOTE_INFO";
cerner.differential_diagnosis.prototype.ISABEL_PLEASE_NOTE_ALERT_HEADER = "Please Note";
cerner.differential_diagnosis.prototype.ISABEL_PLEASE_NOTE_ALERT_MESSAGE = "";

cerner.differential_diagnosis.prototype.CCL_MP_GET_NOTE_FOR_DIFFDIAG_RUN_ERROR = "CCL_MP_GET_NOTE_FOR_DIFFDIAG_RUN_ERROR";
cerner.differential_diagnosis.prototype.CCL_MP_GET_NOTE_FOR_DIFFDIAG_RUN_ERROR_HEADER = "Error retrieving results.";
cerner.differential_diagnosis.prototype.CCL_MP_GET_NOTE_FOR_DIFFDIAG_RUN_ERROR_MESSAGE = "The Differential Diagnosis component is not loading properly. Contact your application administrator if the problem persists.";

cerner.differential_diagnosis.prototype.CCL_MP_GET_NOTE_TEXT_WITH_ADDENDA_RUN_ERROR = "CCL_MP_GET_NOTE_TEXT_WITH_ADDENDA_RUN_ERROR";
cerner.differential_diagnosis.prototype.CCL_MP_GET_NOTE_TEXT_WITH_ADDENDA_RUN_ERROR_HEADER = "Error loading documents.";
cerner.differential_diagnosis.prototype.CCL_MP_GET_NOTE_TEXT_WITH_ADDENDA_RUN_ERROR_MESSAGE = "Documents in the Note Selection List are not loading properly. Contact your application administrator if the problem persists.";

cerner.differential_diagnosis.prototype.NO_ENCOUNTER_ERROR = "NO_ENCOUNTER_ERROR";
cerner.differential_diagnosis.prototype.NO_ENCOUNTER_ERROR_HEADER = "No Encounter";
cerner.differential_diagnosis.prototype.NO_ENCOUNTER_ERROR_MESSAGE = "A valid patient encounter is required to generate a differential diagnosis. Ensure the patient has a valid encounter and try again.";

cerner.differential_diagnosis.prototype.ACTIVE_CLASS_NAME = "active";
cerner.differential_diagnosis.prototype.DIAGNOSIS_HEADER_DIV_HEIGHT = 22;
cerner.differential_diagnosis.prototype.DIAGNONSIS_TEXT_HEIGHT = 24;
cerner.differential_diagnosis.prototype.VERTICAL_SCROLLBAR_HEIGHT = 30;
cerner.differential_diagnosis.prototype.MESSAGE_IMAGE_WIDTH = 44;
cerner.differential_diagnosis.prototype.SYMPTOM_TEXTBOX_LEFT_PADDING = 27;
//End of Global Constants

//Global Variables For Differential Diagnosis Component
cerner.differential_diagnosis.prototype.ROSHPIPEData = "";
cerner.differential_diagnosis.prototype.ROSHPIPEDataFlag = false;
cerner.differential_diagnosis.prototype.DocumentHeaderData = "";
cerner.differential_diagnosis.prototype.ROSHPIPEText = "";
cerner.differential_diagnosis.prototype.TextToSendToIsabel = "";
cerner.differential_diagnosis.prototype.NoteTextWithAddenda = "";

//Global Demographic Variables
cerner.differential_diagnosis.prototype.PRSNL_ID = "";
cerner.differential_diagnosis.prototype.PERSON_ID = "";
cerner.differential_diagnosis.prototype.ENCTR_ID = "";
cerner.differential_diagnosis.prototype.PPR_CD = "";
cerner.differential_diagnosis.prototype.AGE_CODE = "";
cerner.differential_diagnosis.prototype.AGE_DESCRIPTION = "";
cerner.differential_diagnosis.prototype.GENDER_CODE = "";
cerner.differential_diagnosis.prototype.GENDER_NAME = "";
//End Of Dempgraphic Variables

//Isabel Response Variables
cerner.differential_diagnosis.prototype.ISABEL_DiagnosisList = [];
cerner.differential_diagnosis.prototype.ISABEL_SymptomList = [];
cerner.differential_diagnosis.prototype.ISABEL_Current_Displayed_Diagnosis_List = [];
cerner.differential_diagnosis.prototype.UNIQUE_SPECIALTY_LIST = [];
//End Of Isabel Response Variables

//Error Handling
cerner.differential_diagnosis.prototype.ERROR_LIST = [];

//Dynamic Display Table Properties
cerner.differential_diagnosis.prototype.TABLE_RESULTS_PER_COLUMN = 10;
cerner.differential_diagnosis.prototype.TABLE_NUMBER_OF_COLUMNS = 0;
cerner.differential_diagnosis.prototype.DIAGNOSIS_IS_EXPANDED = 0;
cerner.differential_diagnosis.prototype.DIAGNOSIS_AVAILABLE_HEIGHT = 0;
cerner.differential_diagnosis.prototype.TOP_DIAGNOSIS_ID_LENGTH = 5;
cerner.differential_diagnosis.prototype.SUB_DIAGNOSIS_LEVEL_1_ID_LENGTH = 6;
cerner.differential_diagnosis.prototype.SUB_DIAGNOSIS_LEVEL_2_ID_LENGTH = 7;
cerner.differential_diagnosis.prototype.SUB_DIAGNOSIS_LEVEL_3_ID_LENGTH = 8;
cerner.differential_diagnosis.prototype.KNOWLEDGEPAGELEFTOFFSET = 200;
cerner.differential_diagnosis.prototype.KNOWLEDGEPAGEHEIGHTOFFSET = 100;
cerner.differential_diagnosis.prototype.KNOWLEDGEPAGEWIDTHOFFSET = 260;

//div Id variables
cerner.differential_diagnosis.prototype.CURRENT_TOP_LEVEL_COUNTER = 0;
cerner.differential_diagnosis.prototype.CURRENT_LEVEL_1_COUNTER = 0;
cerner.differential_diagnosis.prototype.CURRENT_LEVEL_2_COUNTER = 0;
cerner.differential_diagnosis.prototype.CURRENT_LEVEL_3_COUNTER = 0;


//Global Http request holder
cerner.differential_diagnosis.prototype.XMLHTTP;

//End of Global Variables

/*
Properties are defined in mp_custom_component_core within setProperty function
Displays the message that the component is still loading
*/
cerner.differential_diagnosis.prototype.init = function(options) {
    var component = this;
    var slaTimer = component.createTimer("USR:MPG_Differential_Diagnosis_Component_Load");
    component.handleDemographics();
    component.handleEncounter();
    component.setProperty("headerSubTitle","Loading...");
    component.staticContentSource = component.getProperty("staticContent");

    if((component.ERROR_LIST.indexOf(component.NO_ENCOUNTER_ERROR) == -1) && (component.ERROR_LIST.indexOf(component.AGE_ERROR) == -1)){
        component.retrieveWorkflowText();
        component.retrieveDocumentHeaderData(1, 0);
    }
    else{
        component.diffdxShowErrorsandWarnings();
    }

    if (slaTimer) {
        slaTimer.Stop();
    }
};

/* This method checks if the patient has a valid encounter or not, if not then add the no encounter error to the ERROR_LIST array */
cerner.differential_diagnosis.prototype.handleEncounter = function(){
    if(!this.getProperty("encounterId")){
        this.ERROR_LIST.push(this.NO_ENCOUNTER_ERROR);
    }
}

/*
This method is called from init() method in the component
This method sets all demographics into global values available across methods
*/
cerner.differential_diagnosis.prototype.handleDemographics = function(){
    var patientCriterion = JSON.parse(m_criterionJSON);
    var noGenderFlag = false;

    this.PERSON_ID=patientCriterion.CRITERION.PERSON_ID;
    this.PRSNL_ID=patientCriterion.CRITERION.PRSNL_ID;
    this.PPR_CD=patientCriterion.CRITERION.PPR_CD;

    //Set Gender Codes
    if(patientCriterion.CRITERION.CODES[0] && patientCriterion.CRITERION.CODES[0].MEANING){
        if(patientCriterion.CRITERION.CODES[0].MEANING.toLowerCase() == 'female'){
            this.GENDER_CODE = "f";
            this.GENDER_NAME = "female";
        }
        else if(patientCriterion.CRITERION.CODES[0].MEANING.toLowerCase() == 'male'){
            this.GENDER_CODE = "m";
            this.GENDER_NAME = "male";
        }
        else{
            noGenderFlag = true;
        }
    }
    else{
        noGenderFlag = true;
    }

    if(noGenderFlag){
        this.ERROR_LIST.push(this.GENDER_ERROR);
    }

    //set Age Codes
    if(patientCriterion.CRITERION.PERSON_INFO && patientCriterion.CRITERION.PERSON_INFO.DOB){
        var ageInfo = this.getAgeRange(patientCriterion.CRITERION.PERSON_INFO.DOB);
        this.AGE_CODE = ageInfo[0];
        this.AGE_DESCRIPTION = ageInfo[1];
    }
    else{
        this.ERROR_LIST.push(this.AGE_ERROR);
    }
}

/*
This method is called from init() method in the component
This method makes a CCL Request to get workflow text of patient and asynchronously passes control to call back method
*/
cerner.differential_diagnosis.prototype.retrieveWorkflowText = function(){
    var self = this;
    var statusCode = "";

    //Fetches the ROS / HPI / PE
    this.loadCcl("MP_GET_NOTE_FOR_DIFFDIAG", ["MINE", this.getProperty("personId"), this.getProperty("encounterId"), this.getProperty("userId"), this.getProperty("pprCd"), 0.0],
        function(data){
            self.ROSHPIPEData ="";
            self.ROSHPIPEData = data;
            statusCode = data.RECORD_DATA.STATUS_DATA.STATUS;
            if(statusCode == 'S' || statusCode == 'Z'){
                if(self.ERROR_LIST.indexOf(self.CCL_MP_GET_NOTE_FOR_DIFFDIAG_RUN_ERROR) == -1){
                    self.unpackROSHPIPE();
                    self.buildDynamicNoteElements("roshpipe", 0);
                }
            }
            else{
                self.ERROR_LIST.push(self.CCL_MP_GET_NOTE_FOR_DIFFDIAG_RUN_ERROR);
                self.diffdxShowErrorsandWarnings();
            }
        }, "JSON");
}

/*
This method is called from retrieveWorkflowText() method in the component
This method makes a CCL Request to get note list of patient and asynchronously passes control to call back method
*/
cerner.differential_diagnosis.prototype.retrieveDocumentHeaderData = function(providerNotesFlag, refreshRosHpiPeDisplay){
    var self = this;
    var statusCode = "";
    //Fetches the Notes for the current encounter
    this.loadCcl("MP_GET_NOTE_FOR_DIFFDIAG", ["MINE", this.getProperty("personId"), this.getProperty("encounterId"), this.getProperty("userId"), this.getProperty("pprCd"), 1.0, providerNotesFlag ],
        function(data){
            self.DocumentHeaderData = "";
            self.DocumentHeaderData = data;
            statusCode = data.RECORD_DATA.STATUS_DATA.STATUS;
            if(statusCode == 'S' || statusCode == 'Z'){
                if(self.ERROR_LIST.indexOf(self.CCL_MP_GET_NOTE_FOR_DIFFDIAG_RUN_ERROR) == -1){
                    self.buildDynamicNoteElements("notelist", refreshRosHpiPeDisplay);
                }
            }
            else{
                self.ERROR_LIST.push(self.CCL_MP_GET_NOTE_FOR_DIFFDIAG_RUN_ERROR);
                self.diffdxShowErrorsandWarnings();
            }

        }, "JSON");
}

/*
This method is called in  call back function of the first CCL Script Call in retrieveWorkflowText() method
This method sets ROS / HPI / PE flag to true. The flag value is used to display Note Selection div
*/
cerner.differential_diagnosis.prototype.unpackROSHPIPE=function(){
    var workflowText = this.ROSHPIPEData.RECORD_DATA.TEXTBLOB;
    var noWorkflowText = false;
    if(workflowText)
    {
        this.ROSHPIPEDataFlag = true;
        this.ROSHPIPEText = workflowText;
        this.TextToSendToIsabel = this.validateRequestData(this.ROSHPIPEText);
        if(this.TextToSendToIsabel != "error"){
            //Not allow user to select different request parameters
            this.toggleNoteListAndSymptomChanges('disable');
            this.showProcessing("diff-dx-diagnoses-list-body-div");
            this.sendIsabelRequest("notes");
        }
        else{
            noWorkflowText = true;
        }
    }
    else
    {
        noWorkflowText = true;
    }
    if(noWorkflowText){
        this.ERROR_LIST.push(this.NO_WF_ERROR);
        this.diffdxShowErrorsandWarnings();
    }
}

/* This function is used to generate and send an Isabel call, it takes a flag as parameter
	to know if full document text is being sent in or only symptom list
*/
cerner.differential_diagnosis.prototype.sendIsabelRequest = function(typeFlag){
    var self = this;
    var slaTimer = null;
    try {
        this.XMLHTTP = new XMLHttpRequest(true, true);
        this.XMLHTTP.open("POST",self.ISABEL_POST_SERVICE_URL , true);
        var requestXml ='<soapenv:Envelope xmlns:soapenv="' + self.XML_SOAPENV + '" xmlns:sch="' + self.ISABEL_SCHEMA_URL + '">'+
            self.createHeaderXml() +
            '<soapenv:Body>'+
            '<sch:SmartNoteRequest>';
        if(typeFlag == "notes"){
            requestXml += '<sch:PatientNote><![CDATA['+self.TextToSendToIsabel+']]></sch:PatientNote>'+
                '<sch:ProcessType>NLP_And_DiffDiag</sch:ProcessType>';
        }
        else if(typeFlag == "symptomList"){

            requestXml += self.createNewSymptomListXml() +
                '<sch:ExtractedSymptomList></sch:ExtractedSymptomList>'+
                '<sch:ProcessType>DiffDiag_Only</sch:ProcessType>';
        }
        requestXml +=	self.createPatientDemographicsXml()+
            '</sch:SmartNoteRequest>'+
            '</soapenv:Body>'+
            '</soapenv:Envelope>';
        this.XMLHTTP.setRequestHeader('Content-Type', "text/xml;charset=UTF-8");

        if(typeFlag == "notes"){
            self.ISABEL_SymptomList=[];
            slaTimer = self.createTimer("USR:MPG_Differential_Diagnoses_Generate_From_Note");
        }
        else if(typeFlag == "symptomList"){
            slaTimer = self.createTimer("USR:MPG_Differential_Diagnoses_Generate_From_Symptoms");
        }
        this.XMLHTTP.onreadystatechange = function(e){
            try{
                if(this.readyState == 4){
                    if(this.status == 200){
                        if (slaTimer) {
                            slaTimer.Stop();
                        }
                        self.setIsabelResponseandShowResults(this.responseXML);
                    }
                    else{
                        self.throwIsabelServiceError(slaTimer);
                    }
                    self.XMLHTTP = null;
                }
            }
            catch(e){
                self.throwIsabelServiceError(slaTimer);
                self.XMLHTTP = null;
            }
        };
        this.XMLHTTP.send(requestXml);
    }
    catch(error){
        self.throwIsabelServiceError(slaTimer);
    }
}

/* This method displays an error message if isabel call fails for any reason */
cerner.differential_diagnosis.prototype.throwIsabelServiceError = function(slaTimer) {
    $('#diff-dx-diagnoses-list-body-div').empty();
    this.toggleNoteListAndSymptomChanges('enable');
    this.ERROR_LIST.push(this.ISABEL_SERVICE_DOWN_ERROR);
    this.diffdxShowErrorsandWarnings();
    if (slaTimer) {
        slaTimer.Abort();
        slaTimer = null;
    }
};

/* This function creates the xml for the symptom list that is sent */
cerner.differential_diagnosis.prototype.createNewSymptomListXml = function(){
    var xmlSymptomList = '<sch:SymptomList>';
    for(var i=0; i<this.ISABEL_SymptomList.length; i++){
        xmlSymptomList += '<sch:Symptom><![CDATA['+this.ISABEL_SymptomList[i]+']]></sch:Symptom>';
    }
    xmlSymptomList += '</sch:SymptomList>';
    return xmlSymptomList;
}

/* This function creates the xml for the header of the isabel request with the authentication details */
cerner.differential_diagnosis.prototype.createHeaderXml = function(){
    var headerXml = '<soapenv:Header>'+
        '<sch:SmartNoteAuthentication>'+
        '<sch:User>'+this.ISABEL_USERNAME+'</sch:User>'+
        '<sch:Password>'+this.ISABEL_PASSWORD+'</sch:Password>'+
        '</sch:SmartNoteAuthentication>'+
        '</soapenv:Header>';
    return headerXml;
}

/* This function creates the xml with the patient demographics details */
cerner.differential_diagnosis.prototype.createPatientDemographicsXml = function(){
    var patientDemographicsXml = '<sch:PatientDemographicInfo>'+
        '<sch:AgeRange>'+
        '<sch:Code>'+this.AGE_CODE+'</sch:Code>'+
        '<sch:Name>'+this.AGE_DESCRIPTION+'</sch:Name>'+
        '</sch:AgeRange>'+
        '<sch:Gender>'+
        '<sch:Code>'+this.GENDER_CODE+'</sch:Code>'+
        '<sch:Name>'+this.GENDER_NAME+'</sch:Name>'+
        '</sch:Gender>'+
        '</sch:PatientDemographicInfo>';
    return patientDemographicsXml;
}

/*
This method is called when the Isabel Response comes back successfully
Make it consistent get all symptom data as well which will need changes in show symptom list mehods as well
*/
cerner.differential_diagnosis.prototype.setIsabelResponseandShowResults = function(theIsabelResponse) {
    //Check if node structure is correct before reading Diagnosis list
    if(theIsabelResponse.documentElement && theIsabelResponse.documentElement.nodeName.toLowerCase().trim() == 'soap-env:envelope'
        && theIsabelResponse.documentElement.childNodes[1] && theIsabelResponse.documentElement.childNodes[1].nodeName.toLowerCase().trim() == 'soap-env:body'
        && theIsabelResponse.documentElement.childNodes[1].childNodes[0] && theIsabelResponse.documentElement.childNodes[1].childNodes[0].nodeName.toLowerCase().trim() == 'ns2:smartnoteresult'
        && theIsabelResponse.documentElement.childNodes[1].childNodes[0].childNodes[0] && theIsabelResponse.documentElement.childNodes[1].childNodes[0].childNodes[0].nodeName.toLowerCase().trim() == 'ns2:differentialdiagnosislist'
        && theIsabelResponse.documentElement.childNodes[1].childNodes[0].childNodes[0].childNodes)
    {
        //Diagnosis list
        var diagnosesList = [];
        var diagnosisCounter = 0;
        diagnosesList = theIsabelResponse.documentElement.childNodes[1].childNodes[0].childNodes[0].childNodes;

        for(var i = 0; i < diagnosesList.length; i++)
        {
            //Call function to read all diagnosis details and store in array
            if(diagnosesList[i].nodeName.toLowerCase().trim() == 'ns2:differentialdiagnosis')
            {
                this.ISABEL_DiagnosisList[diagnosisCounter] = this.extractDiagnosis(diagnosesList[i].childNodes);
                diagnosisCounter++;
            }
        }

        document.getElementById("diff-diagnosis-header-text").innerHTML = this.DIFF_DX_RESULTS_LABEL + " (" + this.ISABEL_DiagnosisList.length + ")";

        //Check for any notes sent back by Isabel regarding the results
        var pleaseNoteNode = theIsabelResponse.documentElement.childNodes[1].childNodes[0].childNodes[0].childNodes[this.ISABEL_DiagnosisList.length];
        if(pleaseNoteNode && pleaseNoteNode.nodeName.toLowerCase().trim() == 'ns2:pleasenote')
        {
            this.ISABEL_PLEASE_NOTE_ALERT_MESSAGE = pleaseNoteNode.childNodes[0].nodeValue;
            this.ERROR_LIST.push(this.ISABEL_PLEASE_NOTE_INFO);
        }

        var nlpResultNode = theIsabelResponse.documentElement.childNodes[1].childNodes[0].childNodes[1];
        if(nlpResultNode && nlpResultNode.nodeName.toLowerCase().trim() == 'ns2:nlpresult'
            && nlpResultNode.childNodes[0] && nlpResultNode.childNodes[0].nodeName.toLowerCase().trim() == 'ns2:extractedsymptomlist')
        {
            var symptomsList = nlpResultNode.childNodes[0].childNodes;
            var symptomCounter = 0;
            for(var i = 0; i < symptomsList.length; i++)
            {
                //Call function to read all extracted symptom details and store in array
                if(symptomsList[i].nodeName.toLowerCase().trim() == 'ns2:nlpsymptom')
                {
                    var symptomDetails = symptomsList[i].childNodes;
                    if(symptomDetails[1] && symptomDetails[1].nodeName.toLowerCase().trim() == 'ns2:name')
                    {
                        this.ISABEL_SymptomList[symptomCounter] = symptomDetails[1].childNodes[0].nodeValue;
                        symptomCounter++;
                    }
                }
            }
        }

        this.toggleFilters('enable');
    }
    else{
        this.ERROR_LIST.push(this.NO_RESULTS_ERROR);
    }

    this.loadSpecialty();
    this.showDynamicSymptomList();
    $("#diff-dx-filters-top-10").click();  //Opens up Top 10 by default
    this.toggleNoteListAndSymptomChanges('enable');
    this.diffdxShowErrorsandWarnings();
};

/*
Extracts the Diagnoses and sub diagnoses details from the response and stores them in a multi dimensional array
*/
cerner.differential_diagnosis.prototype.extractDiagnosis = function(Diagnosis){
    var diagnosisDetails = [];
    //Traverse the diagnosis details/properties
    for(var j = 0; j < Diagnosis.length; j++)
    {
        var propertyName = Diagnosis[j].nodeName.toLowerCase().trim();
        switch(propertyName)
        {
            case "ns2:description":{
                diagnosisDetails["description"] = Diagnosis[j].childNodes[0].nodeValue;
                break;
            }
            case "ns2:flag":{
                diagnosisDetails["flag"] = Diagnosis[j].childNodes[0].nodeValue;
                break;
            }
            case "ns2:knowledgeurl":{
                diagnosisDetails["url"] = Diagnosis[j].childNodes[0].nodeValue;
                break;
            }
            case "ns2:subdiagnosislist":{
                var subDiagnoses = Diagnosis[j].childNodes;
                var subDiagnosesList = [];
                //traverse the sub diagnosis list
                for(var k = 0; k < subDiagnoses.length; k++)
                {
                    var subdiagnosisDetails = subDiagnoses[k].childNodes;
                    //extract the sub diagnosis properties from xml nodes
                    subDiagnosesList[k] = this.extractDiagnosis(subdiagnosisDetails);
                }
                diagnosisDetails["subdiagnosis"] = subDiagnosesList;
                break;
            }
            case "ns2:specialty":{
                diagnosisDetails["specialty"] = Diagnosis[j].childNodes[0].nodeValue.toLowerCase().trim();
                if(this.UNIQUE_SPECIALTY_LIST.indexOf(diagnosisDetails["specialty"]) == -1){
                    this.UNIQUE_SPECIALTY_LIST[this.UNIQUE_SPECIALTY_LIST.length] = diagnosisDetails["specialty"];
                }
                break;
            }
        }
    }
    return diagnosisDetails;
}

/* This method enables/disables the note selection list checkboxes, add symptom textbox and delete buttons for all symptoms based on selected toggle
*/
cerner.differential_diagnosis.prototype.toggleNoteListAndSymptomChanges = function(toggleOption){
    if(toggleOption == 'enable'){
        //Enable checkboxes for note list
        $("#diff-dx-dynamic-notes input[type='checkbox']").prop('disabled', false);
        //Enable adding new symptom
        $("#diff-dx-add-symptom-textbox").prop('disabled', false);
        //Enable deleting a symptom
        $("#diff-dx-symptom-list-body-div img").prop('disabled', false);
    }
    if(toggleOption == 'disable'){
        //Disable checkboxes for note list
        $("#diff-dx-dynamic-notes input[type='checkbox']").prop('disabled', true);
        //Disable adding new symptom
        $("#diff-dx-add-symptom-textbox").prop('disabled', true);
        //Disable deleting a symptom
        $("#diff-dx-symptom-list-body-div img").prop('disabled', true);
    }
}

/*
This function loads the specialty options into the specialty drop down box
*/
cerner.differential_diagnosis.prototype.loadSpecialty = function(){
    if(this.UNIQUE_SPECIALTY_LIST.length > 0) {
        var comboBox = document.getElementById("diff-dx-specialty-combobox");
        comboBox.options.length = 0;
        var option = document.createElement("option");
        option.text = "all";
        option.value = -1;
        option.selected = true;
        comboBox.appendChild(option);
        for(var i = 0; i < this.UNIQUE_SPECIALTY_LIST.length; i++){
            option = document.createElement("option");
            option.text = this.UNIQUE_SPECIALTY_LIST[i];
            option.value = i;
            comboBox.appendChild(option);
        }
        $('.diff-dx-specialty-combo').prop('disabled', false);
    }
}

/*
This method builds the dynamic symptom list based on the response from Isabel
*/
cerner.differential_diagnosis.prototype.showDynamicSymptomList = function(){
    var symptomList = this.ISABEL_SymptomList;
    var returnString = "";
    $('#diff-dx-symptom-list-body-div').empty();
    var symptomListHolder = document.getElementById("diff-dx-symptom-list-body-div");
    for(var i = 0; i < symptomList.length;i++){
        returnString += this.addSymptomToList(symptomList[i], i);
    }
    symptomListHolder.innerHTML = returnString;
}

/* This function creates the html for adding a new symtpom to the symptom list */
cerner.differential_diagnosis.prototype.addSymptomToList = function(symptomText, index){
    var strReturn = "";
    strReturn+= "<div id='diff-dx-symptom-list-item-div-"+index+"' class='diff-dx-symptom-list-item-div'>";
    strReturn += "<div id='diff-dx-symptom-list-item-text-div-"+index+"'class='diff-dx-symptom-list-item-text-div diff-dx-text' title='"+symptomText+"'>";
    strReturn += symptomText;
    strReturn += "</div>";
    strReturn += "<input id='diff-dx-symptom-list-item-delete-div-"+index+"' type='button' class='diff-dx-symptom-list-item-delete-div diff-dx-invisible-div' />";
    strReturn += "</div>";
    return strReturn;
}

/*
This method builds the differential diagnosis list based on the filter selected
*/
cerner.differential_diagnosis.prototype.showDynamicDiffDx = function(diagnosesList){
    $("#diff-dx-diagnoses-list-body-div").empty();
    var currentColumnCellCounter = 0;
    var htmlString = "";
    var diagnosesCounter = 0;
    this.TABLE_NUMBER_OF_COLUMNS = diagnosesList.length/this.TABLE_RESULTS_PER_COLUMN;

    if(diagnosesList.length > 0){
        htmlString += "<div class='diff-dx-diagnoses-list-wrapper-container'>";
        htmlString += "<div class='diff-dx-diagnoses-list-wrapper-container'>";
        htmlString += "<div class='diff-dx-diagnoses-list-column-wrapper'>";
        for (i = 0 ; i < this.TABLE_NUMBER_OF_COLUMNS; i++)
        {
            htmlString += "<div class='diff-dx-diagnoses-list-result-column'>";
            while(currentColumnCellCounter < this.TABLE_RESULTS_PER_COLUMN)
            {
                if(diagnosesList[diagnosesCounter]){
                    this.CURRENT_TOP_LEVEL_COUNTER = diagnosesCounter;
                    htmlString += this.createHtmlForDiagnosis(diagnosesList[this.CURRENT_TOP_LEVEL_COUNTER]);
                }
                else{
                    break;
                }
                currentColumnCellCounter++;
                diagnosesCounter++;
            }
            currentColumnCellCounter = 0;
            htmlString += "</div>";
        }
        htmlString += "</div></div></div>";
        document.getElementById("diff-dx-diagnoses-list-body-div").innerHTML = htmlString;
    }
}

/*
Creates the html for the diagnosis list divs
*/
cerner.differential_diagnosis.prototype.createHtmlForDiagnosis = function(diagnosesDetails){
    var htmlString = "";

    htmlString += "<div id='diff-dx-diagnosis-div-" + this.CURRENT_TOP_LEVEL_COUNTER + "'   class='diff-dx-diagnoses-list-result-item-main'>";

    if(diagnosesDetails["flag"] && diagnosesDetails["flag"].toLowerCase() == 'true'){
        htmlString += "<div class='diff-dx-diagnoses-list-item-flag-div'></div>";
    }
    else {
        htmlString += "<div class='diff-dx-diagnoses-list-item-flag-div diff-dx-invisible-div'></div>";
    }

    var subDiagnosisList = [];
    if(diagnosesDetails["subdiagnosis"])
    {
        subDiagnosisList = diagnosesDetails["subdiagnosis"];
        if(subDiagnosisList.length > 0){
            if(this.DIAGNOSIS_IS_EXPANDED == 1){
                htmlString += "<div id='diff-dx-diagnoses-list-item-expand-icon-div-" + this.CURRENT_TOP_LEVEL_COUNTER + "' class='diff-dx-diagnoses-list-item-expanded-icon-div'></div>";
            }
            else{
                htmlString += "<div id='diff-dx-diagnoses-list-item-collapsed-icon-div-" + this.CURRENT_TOP_LEVEL_COUNTER + "' class='diff-dx-diagnoses-list-item-collapsed-icon-div'></div>";
            }
        }
    }
    else
    {
        htmlString += "<div id='diff-dx-diagnoses-list-item-expand-icon-div-" + this.CURRENT_TOP_LEVEL_COUNTER + "' class='diff-dx-diagnoses-list-item-expanded-icon-div diff-dx-invisible-div'></div>";
    }

    htmlString += "<div class='diff-dx-diagnoses-list-item-text-div diff-dx-text'>";
    htmlString += "<a>" + diagnosesDetails["description"] + "</a>";

    htmlString += "</div>";
    //Creates divs for sub diagnosis if present
    if(subDiagnosisList.length > 0)
    {
        htmlString += this.createHtmlForSubDiagnosis(subDiagnosisList, 1);
    }
    htmlString += "</div>";
    return htmlString;
}

/*
Creates the html for the sub diadnosis list divs
*/
cerner.differential_diagnosis.prototype.createHtmlForSubDiagnosis = function(subDiagnosisList, level){
    var htmlString = "";
    var outerDivId = "";
    var innerDivId = "";
    var flagClassName = "";
    var nextLevelNumber = 0;

    if(level == 1)
    {
        outerDivId = "diff-dx-sub-diagnosis-level-1-" + this.CURRENT_TOP_LEVEL_COUNTER;
        innerDivId = "diff-dx-sub-diagnosis-" + this.CURRENT_TOP_LEVEL_COUNTER + "-";
        flagClassName = "diff-dx-gap-level-1";
        nextLevelNumber = 2;
    }
    else if(level == 2)
    {
        outerDivId = "diff-dx-sub-diagnosis-level-2-" + this.CURRENT_TOP_LEVEL_COUNTER + "-" + this.CURRENT_LEVEL_1_COUNTER;
        innerDivId = "diff-dx-sub-diagnosis-" + this.CURRENT_TOP_LEVEL_COUNTER + "-" + this.CURRENT_LEVEL_1_COUNTER + "-";
        flagClassName = "diff-dx-gap-level-2";
        nextLevelNumber = 3;
    }
    else if(level == 3)
    {
        outerDivId = "diff-dx-sub-diagnosis-level-3-" + this.CURRENT_TOP_LEVEL_COUNTER + "-" + this.CURRENT_LEVEL_1_COUNTER + "-" + this.CURRENT_LEVEL_2_COUNTER;
        innerDivId = "diff-dx-sub-diagnosis-" + this.CURRENT_TOP_LEVEL_COUNTER + "-" + this.CURRENT_LEVEL_1_COUNTER + "-" + this.CURRENT_LEVEL_2_COUNTER + "-";
        flagClassName = "diff-dx-gap-level-3";
    }
    if(this.DIAGNOSIS_IS_EXPANDED == 1)
    {
        htmlString += "<div id='" + outerDivId + "'>";
    }
    else
    {
        htmlString += "<div id='" + outerDivId + "' class='diff-dx-hide-div'>";
    }

    for(var i = 0; i < subDiagnosisList.length; i++)
    {
        htmlString += "<div id='" + innerDivId + i + "' class='diff-dx-diagnoses-list-result-item-sub'>";
        var subDiagnosisDetails = subDiagnosisList[i];
        if(subDiagnosisDetails["flag"] && subDiagnosisList[i]["flag"].toLowerCase() == 'true'){
            htmlString += "<div class='diff-dx-diagnoses-list-item-flag-div " + flagClassName + "'></div>";
        }
        else {
            htmlString += "<div class='diff-dx-diagnoses-list-item-flag-div diff-dx-invisible-div " + flagClassName + "'></div>";
        }
        var subDiagnosis = [];
        if(subDiagnosisDetails["subdiagnosis"])
        {
            subDiagnosis = subDiagnosisDetails["subdiagnosis"];
            if(subDiagnosis.length > 0){
                htmlString += "<div class='diff-dx-diagnoses-list-item-expanded-icon-div'></div>";
            }
        }
        else
        {
            htmlString += "<div class='diff-dx-diagnoses-list-item-expanded-icon-div diff-dx-invisible-div'></div>";
        }
        htmlString += "<div class='diff-dx-diagnoses-list-item-text-div diff-dx-text'>";
        htmlString += "<a>" + subDiagnosisDetails["description"] + "</a>";
        htmlString += "</div>";
        if(subDiagnosis.length > 0)
        {
            if(level == 1)
            {
                this.CURRENT_LEVEL_1_COUNTER = i;
            }
            else if(level == 2)
            {
                this.CURRENT_LEVEL_2_COUNTER = i;
            }
            else if(level == 3)
            {
                this.CURRENT_LEVEL_3_COUNTER = i;
            }
            htmlString += this.createHtmlForSubDiagnosis(subDiagnosis, nextLevelNumber);
        }
        else
        {
            this.CURRENT_LEVEL_1_COUNTER = 0;
            this.CURRENT_LEVEL_2_COUNTER = 0;
            this.CURRENT_LEVEL_3_COUNTER = 0;
        }
        htmlString += "</div>";
    }
    htmlString += "</div>";
    return htmlString;
}

/*
This method is used to display all diagnoses results returned by isabel
*/
cerner.differential_diagnosis.prototype.showAllDiffDxResults = function(){
    this.ISABEL_Current_Displayed_Diagnosis_List = [];
    this.ISABEL_Current_Displayed_Diagnosis_List = this.ISABEL_DiagnosisList;
    this.DIAGNOSIS_IS_EXPANDED = 1;
    //Call the function to create the html for displaying the list of diagnosis
    this.showDynamicDiffDx(this.ISABEL_Current_Displayed_Diagnosis_List);
}

/*
This method is used to display only top 10 diagnoses results returned by isabel
*/
cerner.differential_diagnosis.prototype.showTop10DiffDxResults = function() {
    this.ISABEL_Current_Displayed_Diagnosis_List = [];
    for(i = 0; i < 10; i++){
        this.ISABEL_Current_Displayed_Diagnosis_List[i] = this.ISABEL_DiagnosisList[i];
    }
    this.DIAGNOSIS_IS_EXPANDED = 0;
    //Call the function to create the html for displaying the list of diagnosis
    this.showDynamicDiffDx(this.ISABEL_Current_Displayed_Diagnosis_List);
}

/*
This method is used to display only the don't miss diagnoses results returned by isabel
*/
cerner.differential_diagnosis.prototype.showDontMissDiffDxResults = function() {
    this.ISABEL_Current_Displayed_Diagnosis_List = [];
    var counter = 0;
    for(var i = 0; i < this.ISABEL_DiagnosisList.length; i++){
        if(this.ISABEL_DiagnosisList[i]["flag"].toLowerCase() == 'true'){
            this.ISABEL_Current_Displayed_Diagnosis_List[counter] = this.ISABEL_DiagnosisList[i];
            counter++;
        }
    }
    this.DIAGNOSIS_IS_EXPANDED = 1;
    //Call the function to create the html for displaying the list of diagnosis
    this.showDynamicDiffDx(this.ISABEL_Current_Displayed_Diagnosis_List);
}


//This method adds/removes overlay to let the end user know that the system is processing the request
cerner.differential_diagnosis.prototype.showProcessing = function(divId) {
    document.getElementById(divId).innerHTML = "<div class='diff-dx-containerLoading'></div>"
}

/*
This method is called internally by Mpage Framework
Core purpose is to build the consolidate html which is displayed on the screen
This method calls into two html builder methods
*/
cerner.differential_diagnosis.prototype.render = function() {
    var target = this.getTarget();
    var htmlString = "";

    htmlString += "<div class='diff-dx-container-div' id='diff-dx-main'>";

    if(!(this.ERROR_LIST.indexOf(this.AGE_ERROR) > -1) || !(this.ERROR_LIST.indexOf(this.NO_ENCOUNTER_ERROR) > -1)){
        htmlString += this.diffdxBuildFilters();
        htmlString += this.diffdxBuildComponents();
        htmlString += this.diffdxBuildLogo();
    }
    htmlString += "</div>";

    target.innerHTML = htmlString;
    this.addEventHandlers();
    this.diffdxShowErrorsandWarnings();
    this.setProperty("headerSubTitle","");//Removes the loading symbol from the component header, must always be placed as last line in the render function
};

/*
This method shows all the errors on screen
*/
cerner.differential_diagnosis.prototype.diffdxShowErrorsandWarnings = function(){
    var ageError ="";
    var noEncounterError = "";
    var genderWarning ="";
    var noWorkflowTextInfo = "";
    var pleaseNoteAlert = "";
    var noResultsWarning = "";
    var isabelServiceError = "";
    var cclMpGetNoteForDiffdiagError = "";
    var cclMpGetNoteTextWithAddendaError = "";

    //If mp_get_note_for_diffdiag ccl script error occurs then display appropriate message
    if(this.ERROR_LIST.indexOf(this.CCL_MP_GET_NOTE_FOR_DIFFDIAG_RUN_ERROR) > -1) {
        $('#diff-dx-main').empty();
        cclMpGetNoteForDiffdiagError = this.createErrorBox('diff-dx-ccl-get-patient-note-list-script-error', this.CCL_MP_GET_NOTE_FOR_DIFFDIAG_RUN_ERROR_HEADER, this.CCL_MP_GET_NOTE_FOR_DIFFDIAG_RUN_ERROR_MESSAGE);
    }

    //If age error occurs then display appropriate message
    if(this.ERROR_LIST.indexOf(this.AGE_ERROR) > -1) {
        $('#diff-dx-main').empty();
        ageError = this.createErrorBox('diff-dx-no-age-error', this.AGE_ERROR_HEADER, this.AGE_ERROR_MESSAGE);
    }

    //If patient doesnt have an encounter then display appropriate message
    if(this.ERROR_LIST.indexOf(this.NO_ENCOUNTER_ERROR) > -1) {
        $('#diff-dx-main').empty();
        noEncounterError = this.createErrorBox('diff-dx-no-encounter-error', this.NO_ENCOUNTER_ERROR_HEADER, this.NO_ENCOUNTER_ERROR_MESSAGE);
    }

    //If gender error occurs then display appropriate message
    if(this.ERROR_LIST.indexOf(this.GENDER_ERROR) > -1) {
        genderWarning = this.createAlertBox('diff-dx-no-gender-alert', this.GENDER_ALERT_HEADER, this.GENDER_ALERT_MESSAGE);
    }

    //If MP_GET_NOTE_TEXT_WITH_ADDENDA ccl script error occurs then display appropriate message
    if(this.ERROR_LIST.indexOf(this.CCL_MP_GET_NOTE_TEXT_WITH_ADDENDA_RUN_ERROR) > -1) {
        cclMpGetNoteTextWithAddendaError = this.createErrorBox('diff-dx-ccl-get-note-text-script-error', this.CCL_MP_GET_NOTE_TEXT_WITH_ADDENDA_RUN_ERROR_HEADER, this.CCL_MP_GET_NOTE_TEXT_WITH_ADDENDA_RUN_ERROR_MESSAGE);
    }

    //If patient does not have workflow text documented then display appropriate message
    if(this.ERROR_LIST.indexOf(this.NO_WF_ERROR) > -1) {
        noWorkflowTextInfo = this.createNoWorkflowTextMessage();
    }

    //If Isabel sends any note in their reply then display this message
    if(this.ERROR_LIST.indexOf(this.ISABEL_PLEASE_NOTE_INFO) > -1) {
        pleaseNoteAlert = this.createAlertBox('diff-dx-isabel-please-note-alert', this.ISABEL_PLEASE_NOTE_ALERT_HEADER, this.ISABEL_PLEASE_NOTE_ALERT_MESSAGE);
    }

    //If Isabel cannot generate any results from the given input then display message
    if(this.ERROR_LIST.indexOf(this.NO_RESULTS_ERROR) > -1) {
        noResultsWarning = this.createAlertBox('diff-dx-isabel-no-results-alert', this.NO_RESULTS_ALERT_HEADER, this.NO_RESULTS_ALERT_MESSAGE);
    }

    //If Isabel service is down or request does not complete then display message
    if(this.ERROR_LIST.indexOf(this.ISABEL_SERVICE_DOWN_ERROR) > -1) {
        isabelServiceError = this.createErrorBox('diff-dx-isabel-service-error', this.ISABEL_SERVICE_DOWN_ERROR_HEADER, this.ISABEL_SERVICE_DOWN_ERROR_MESSAGE);
    }

    //If Diagnoses list box is displayed, then place the message inside it
    if($('#diff-dx-diagnoses-list-header').length)
    {
        //update the gender warning if required
        this.updateGenderWarning(genderWarning);

        //update the ccl script error if required
        this.updateGetNoteTextCclError(cclMpGetNoteTextWithAddendaError);

        //update the isabel service down error if required
        this.updateIsabelServiceError(isabelServiceError);

        //update the no workflow text documented information
        this.updateNoWorkflowInfo(noWorkflowTextInfo);

        //update the no results message
        this.updateNoResultsWarning(noResultsWarning);

        //update the please note message
        this.updatePleaseNoteMessage(pleaseNoteAlert);
    }
    else
    {
        this.updateMainErrors(cclMpGetNoteForDiffdiagError, noEncounterError, ageError, genderWarning);
    }
    //Needs to be called again since Isabel calls are asynchronous and may complete after resize is called
    this.resize();
}

/* This method clears any errors that displayed from previous isabel call */
cerner.differential_diagnosis.prototype.clearExistingErrors = function(){
    //Clear any error messages possible from previous Isabel call
    this.ERROR_LIST.splice(this.ERROR_LIST.indexOf(this.ISABEL_PLEASE_NOTE_INFO) , 1);
    this.ERROR_LIST.splice(this.ERROR_LIST.indexOf(this.NO_WF_ERROR) , 1);
    this.ERROR_LIST.splice(this.ERROR_LIST.indexOf(this.ISABEL_SERVICE_DOWN_ERROR) , 1);
    this.ERROR_LIST.splice(this.ERROR_LIST.indexOf(this.NO_RESULTS_ERROR) , 1);
    this.ERROR_LIST.splice(this.ERROR_LIST.indexOf(this.CCL_MP_GET_NOTE_TEXT_WITH_ADDENDA_RUN_ERROR) , 1);
    this.diffdxShowErrorsandWarnings();
}

/* This method updates age, gender, no encounter or ccl script error if any exists on the page */
cerner.differential_diagnosis.prototype.updateMainErrors = function(cclMpGetNoteForDiffdiagError, noEncounterError, ageError, genderWarning){
    if(!$("#diff-dx-ccl-get-patient-note-list-script-error").length && cclMpGetNoteForDiffdiagError){
        $("#diff-dx-main").append(cclMpGetNoteForDiffdiagError);
    }
    else {
        if(!$("#diff-dx-no-encounter-error").length && noEncounterError){
            $("#diff-dx-main").append(noEncounterError);
        }
        if(!$("#diff-dx-no-age-error").length && ageError){
            $("#diff-dx-main").append(ageError);
        }
        if(!$("#diff-dx-no-gender-alert").length && genderWarning){
            $("#diff-dx-main").append(genderWarning);
        }
    }
}

/* This method updates the message when note text could not be retrieved using ccl script */
cerner.differential_diagnosis.prototype.updateGetNoteTextCclError = function(cclMpGetNoteTextWithAddendaError){
    if(!$("#diff-dx-ccl-get-note-text-script-error").length){
        if(cclMpGetNoteTextWithAddendaError){
            if(!$("#diff-dx-no-gender-alert").length){
                $("#diff-dx-diagnoses-list-header").after(cclMpGetNoteTextWithAddendaError);
            }
            else{
                $("#diff-dx-no-gender-alert").after(cclMpGetNoteTextWithAddendaError);
            }
        }
    } else{
        if(this.ERROR_LIST.indexOf(this.CCL_MP_GET_NOTE_TEXT_WITH_ADDENDA_RUN_ERROR) == -1){
            $("#diff-dx-ccl-get-note-text-script-error").remove();
        }
    }
}

/* This method updates the please note message to the differential diagnosis box if Isabel sends any note back in the reply */
cerner.differential_diagnosis.prototype.updatePleaseNoteMessage = function(pleaseNoteAlert){
    if(!$("#diff-dx-isabel-please-note-alert").length){
        if(pleaseNoteAlert){
            if(!$("#diff-dx-no-gender-alert").length){
                $("#diff-dx-diagnoses-list-header").after(pleaseNoteAlert);
            }
            else{
                $("#diff-dx-no-gender-alert").after(pleaseNoteAlert);
            }
        }
    } else{
        if(this.ERROR_LIST.indexOf(this.ISABEL_PLEASE_NOTE_INFO) == -1){
            $("#diff-dx-isabel-please-note-alert").remove();
        }
    }
}

/* This method updates the no results message to the differential diagnosis box if Isabel could not extract clinically revelant information */
cerner.differential_diagnosis.prototype.updateNoResultsWarning = function(noResultsWarning){
    if(!$("#diff-dx-isabel-no-results-alert").length){
        if(noResultsWarning){
            if(!$("#diff-dx-no-gender-alert").length){
                $("#diff-dx-diagnoses-list-header").after(noResultsWarning);
            }
            else{
                $("#diff-dx-no-gender-alert").after(noResultsWarning);
            }
        }

    } else{
        if(this.ERROR_LIST.indexOf(this.NO_RESULTS_ERROR) == -1){
            $("#diff-dx-isabel-no-results-alert").remove();
        }
    }
}

/* This method updates the workflow information message to the differential diagnosis box if patient does not have any workflow text documented */
cerner.differential_diagnosis.prototype.updateNoWorkflowInfo = function(noWorkflowTextInfo){
    if(!$("#diff-dx-no-wf-text-info").length && noWorkflowTextInfo){
        if(!$("#diff-dx-no-gender-alert").length){
            $("#diff-dx-diagnoses-list-header").after(noWorkflowTextInfo);
        }
        else{
            $("#diff-dx-no-gender-alert").after(noWorkflowTextInfo);
        }
    } else{
        if(this.ERROR_LIST.indexOf(this.NO_WF_ERROR) == -1){
            $("#diff-dx-no-wf-text-info").remove();
        }
    }
}

/* This method updates the gender warning to the differential diagnosis box if patient gender is not documented */
cerner.differential_diagnosis.prototype.updateGenderWarning = function(genderWarning){
    if(!$("#diff-dx-no-gender-alert").length && genderWarning){
        $("#diff-dx-diagnoses-list-header").after(genderWarning);
    }
}

/* This method updates the error to the differential diagnosis box if isabel request throws an error */
cerner.differential_diagnosis.prototype.updateIsabelServiceError = function(isabelServiceError){
    if(!$("#diff-dx-isabel-service-error").length){
        if(isabelServiceError){
            if(!$("#diff-dx-no-gender-alert").length){
                $("#diff-dx-diagnoses-list-header").after(isabelServiceError);
            }
            else{
                $("#diff-dx-no-gender-alert").after(isabelServiceError);
            }
        }
    }
    else{
        if(this.ERROR_LIST.indexOf(this.ISABEL_SERVICE_DOWN_ERROR) == -1){
            $("#diff-dx-isabel-service-error").remove();
        }
    }
}

/* This method creates the html to display an error message on the page */
cerner.differential_diagnosis.prototype.createErrorBox = function(divId, errorHeader, errorMessage){
    var htmlString =  "<div class='diff-dx-error-div' id='"+ divId +"'>"+
        "<div class='diff-dx-error-icon'></div>"+
        "<div class='diff-dx-error-textholder'>"+
        "<div class='diff-dx-error-header'>"+errorHeader+"</div>"+
        "<div class='diff-dx-error-message'>"+errorMessage+"</div>"+
        "</div>"+
        "</div>";
    return htmlString;
}

/* This method creates the html to display an alert message on the page */
cerner.differential_diagnosis.prototype.createAlertBox = function(divId, alertHeader, alertMessage){
    var htmlString =  "<div class='diff-dx-alert-div' id='"+ divId +"'>"+
        "<div class='diff-dx-alert-icon'></div>"+
        "<div class='diff-dx-alert-textholder'>"+
        "<div class='diff-dx-alert-header'>"+alertHeader+"</div>"+
        "<div class='diff-dx-alert-message'>"+alertMessage+"</div>"+
        "</div>"+
        "</div>";
    return htmlString;
}

/* This method creates the html to display an the no workflow text present message on the page */
cerner.differential_diagnosis.prototype.createNoWorkflowTextMessage = function(){
    var htmlString = "<div class='diff-dx-info-div' id='diff-dx-no-wf-text-info'>"+
        "<div class='diff-dx-info-icon'></div>"+
        "<div class='diff-dx-info-textholder'>"+
        "<div class='diff-dx-info-message'>" + this.NO_WF_INFO_MESSAGE_LINE_1 + "</div>"+
        "<div class='diff-dx-info-header'>" + this.NO_WF_INFO_MESSAGE_LINE_2 + "</div>"+
        "<ul class='diff-dx-info-ul'>"+
        "<li class='diff-dx-info-message'>" + this.NO_WF_INFO_MESSAGE_LINE_3 + "</li>"+
        "<li class='diff-dx-info-message'>" + this.NO_WF_INFO_MESSAGE_LINE_4 + "</li>"+
        "<li class='diff-dx-info-message'>" + this.NO_WF_INFO_MESSAGE_LINE_5 + "</li>"+
        "</ul>"+
        "<div class='diff-dx-info-header'>" + this.NO_WF_INFO_MESSAGE_LINE_6 + "</div>"+
        "</div>"+
        "</div>";
    return htmlString;
}

/*
This method is called from render function in the component
This method builds the Speciality DropDown and also the filters like Top 10 / Dont Miss / Show- All
*/
cerner.differential_diagnosis.prototype.diffdxBuildFilters = function(){
    var filtersHtml = "";
    filtersHtml += "<div class='diff-dx-inner-top-div'>"+
        "<div class='diff-dx-right-controls'>"+
        "<div class='diff-dx-left-float'>"+
        "<span class='diff-dx-label diff-dx-text'>Specialty: </span>"+
        "<span class='diff-dx-specialty-combo' disabled='true'>"+
        "<select id='diff-dx-specialty-combobox'>"+
        "</select>"+
        "</span>"+
        "</div>"+
        "<div class='diff-dx-left-float'>"+
        "<div id='diff-dx-filters' class='diff-dx-segmented-control'>  "+
        "<div id='diff-dx-filters-top-10' class='diff-dx-button' title='top 10' disabled='true'>Top 10</div>"+
        "<div id='diff-dx-filters-dont-miss' class='diff-dx-button' title='dont-miss' disabled='true'>Don't Miss</div>"+
        "<div id='diff-dx-filters-show-all' class='diff-dx-button' title='show-all' disabled='true'>Show All</div>"+
        "</div>"+
        "</div>"+
        "</div>"+
        "</div>";
    return filtersHtml;
}

/*
This method is called from render function in the component
This method builds calls the following helper methods to build the html shell
1.Note Selection Builder
2.Symptom List Builder
3. Diagnoses List Builder
*/
cerner.differential_diagnosis.prototype.diffdxBuildComponents = function(){
    var componentsHtml = "";
    componentsHtml+= "<div class='diff-dx-inner-bottom-div diff-dx-left-float'>"+
        "<div class='diff-dx-left-bottom-div'>";
    componentsHtml+= this.buildNoteSelectionComponent();
    componentsHtml+= this.buildSymptomListComponent();
    componentsHtml+= "</div>";
    componentsHtml+= this.buildDiagnosesListComponent();
    componentsHtml+= "</div>";
    return componentsHtml;
}

/*
This method is called from render function in the component
This method builds the html for isabel Logo
*/
cerner.differential_diagnosis.prototype.diffdxBuildLogo = function(){
    var componentsHtml = "<div class='diff-dx-bottom-logo-div'>"+
        "<div class='diff-dx-logo-div'>"+
        "</div>"+
        "</div>";
    return componentsHtml;
}

/*
This method is called from diffdxBuildComponents function in the component
Dynamic content is handled from the script callbacks
This method just builds the static html shell
*/
cerner.differential_diagnosis.prototype.buildNoteSelectionComponent = function(){
    var noteComponent = "";
    noteComponent += "<div class='diff-dx-note-selection-div'>"+
        "<div class='diff-dx-note-selection-header-div diff-dx-header'>"+
        "<span class='diff-dx-header-text'>Note Selection</span>"+
        "<label class='diff-dx-text diff-dx-provider-notes-only'>"+
        "<input type='checkbox' name='ProviderNotesOnly' id='diff-dx-provider-only-checkbox' value='1' class='diff-dx-provider-notes-only-checkbox' checked>"+
        this.ProviderNotesOnlyLabel +
        "</label>"+
        "</div>"+
        "<div class='diff-dx-note-selection-body-div' id='diff-dx-dynamic-notes'>";
    noteComponent +=		"</div>"+
        "<div class='diff-dx-note-selection-review-note-button-div'>"+
        "<div class='diff-dx-note-selection-review-note-button-wrapper'>"+
        "<span id='diff-dx-note-selection-review-button' class='diff-dx-button diff-dx-text' disabled='true'>Review Selected Note(s)</span>"+
        "</div>"+
        "</div>"+
        "</div>";
    return noteComponent;
}

/*
This method is called from diffdxBuildComponents function in the component
Dynamic content will be handled upon the isabel httpResponse
This method just builds the static html shell
*/
cerner.differential_diagnosis.prototype.buildSymptomListComponent = function(){
    var symptomListComponent = "";

    symptomListComponent +=	"<div class='diff-dx-symptom-list-div'>"+
        "<div class='diff-dx-symptom-list-header-div diff-dx-header'>"+
        "<span class='diff-dx-header-text'>Symptom List</span>"+
        "</div>"+
        "<div id='diff-dx-symptom-list-body-div' class='diff-dx-symptom-list-body-div'>"+
        "</div>"+
        "<div class='diff-dx-add-symptom-list-div'>"+
        "<div class='diff-dx-add-symptom-list-wrapper'>"+
        "<span id='diff-dx-add-symptom-label' class='diff-dx-label diff-dx-text'>Add Symptom : </span>"+
        "<input id='diff-dx-add-symptom-textbox' class='diff-dx-textbox diff-dx-symptom-list-add-symptom-textbox' type='text' maxlength='100'></input>"+
        "</div>"+
        "</div>"+
        "<div class='diff-dx-symptom-list-regenerate-button-div'>"+
        "<div class='diff-dx-symptom-list-regenerate-button-wrapper'>"+
        "<span id='diff-dx-symptom-list-regenerate-button' class='diff-dx-button diff-dx-text' disabled='true'>Regenerate Differential Diagnosis</span>"+
        "</div>"+
        "</div>"+
        "</div>";
    return symptomListComponent;
}

/*
This method is called from diffdxBuildComponents function in the component
Dynamic content will be handled upon the isabel httpResponse
This method just builds the static html shell
*/
cerner.differential_diagnosis.prototype.buildDiagnosesListComponent = function(){
    var diagnosesListComponent = "";

    diagnosesListComponent += "<div class='diff-dx-right-bottom-div'>"+
        "<div class='diff-dx-diagnoses-list-div'>"+
        "<div class='diff-dx-diagnoses-list-header-div diff-dx-header' id='diff-dx-diagnoses-list-header'>"+
        "<span class='diff-dx-header-text' id='diff-diagnosis-header-text'>"+ this.DIFF_DX_RESULTS_LABEL +"</span>"+
        "</div>"+
        "<div id='diff-dx-diagnoses-list-body-div' class='diff-dx-diagnoses-list-body-div'>"+
        "</div>"+
        "</div>"+
        "</div>";
    return diagnosesListComponent;
}

/*
This method is called from callback functions in retrieveWorkflowText and retrieveDocumentHeaderData method
Adds Note list dynamically into the static div from the rendered component
*/
cerner.differential_diagnosis.prototype.buildDynamicNoteElements = function(cclCallType, refreshRosHpiPeDisplay){
    var noteElements = "";
    var docLabelText = "";
    var str = "";

    //If list does not exist (for first call of this function) then create the <ul> html
    if($('#diff-dx-dynamic-notes').has("#diff-dx-dynamic-note-elements").length <= 0){
        str = "<ul class='diff-dx-note-selection-ul' id='diff-dx-dynamic-note-elements'></ul>";
        document.getElementById("diff-dx-dynamic-notes").innerHTML = str;
    }

    //If documents ccl request comes back
    var documents=this.DocumentHeaderData;
    if(documents.hasOwnProperty('RECORD_DATA') && cclCallType == "notelist"){
        if (documents.RECORD_DATA.DOCUMENTS){
            noteElements = documents.RECORD_DATA.DOCUMENTS;
            for(var i = 0;i < noteElements.length; i++){
                if(noteElements[i].TYPE){
                    docLabelText = noteElements[i].TITLE+" ("+ noteElements[i].TYPE+") "+ noteElements[i].EFFECTIVE_DATE;
                    str = "<label class='diff-dx-note-selection-text diff-dx-text' title='" + docLabelText + "'>" +
                        "<input type='checkbox' name='NoteList' value=" + noteElements[i].EVENT_ID + " />" + docLabelText + "</label>";
                    $("<li/>").appendTo("#diff-dx-dynamic-note-elements").html(str);
                }
            }
        }
    }

    //if ROSHPI CCL Comes back
    if( (this.ROSHPIPEDataFlag == true) && (this.TextToSendToIsabel != 'error')  && ((cclCallType == "roshpipe") || (refreshRosHpiPeDisplay))){
        str = "<li><label class='diff-dx-note-selection-text diff-dx-text' title='"+this.ROSHPIPELabel+"'><input  type='checkbox' name='NoteList' value='ROSHPIPE' checked>"
            +this.ROSHPIPELabel+"</label></li>";
        $("#diff-dx-dynamic-note-elements").prepend(str);
    }
}

// This method adds EventHandlers to static html code
cerner.differential_diagnosis.prototype.addEventHandlers = function() {
    var self = this;

    $("#diff-dx-filters-top-10").click(function() {
        self.showTop10DiffDxResults();
        $("#diff-dx-specialty-combobox option:selected").prop("selected", false);
        $("#diff-dx-filters-top-10").addClass(self.ACTIVE_CLASS_NAME);
        $("#diff-dx-filters-dont-miss").removeClass(self.ACTIVE_CLASS_NAME);
        $("#diff-dx-filters-show-all").removeClass(self.ACTIVE_CLASS_NAME);
    });

    $("#diff-dx-filters-dont-miss").click(function() {
        self.showDontMissDiffDxResults();
        $("#diff-dx-specialty-combobox option:selected").prop("selected", false);
        $("#diff-dx-filters-dont-miss").addClass(self.ACTIVE_CLASS_NAME);
        $("#diff-dx-filters-top-10").removeClass(self.ACTIVE_CLASS_NAME);
        $("#diff-dx-filters-show-all").removeClass(self.ACTIVE_CLASS_NAME);
    });

    $("#diff-dx-filters-show-all").click(function() {
        self.showAllDiffDxResults();
        $("#diff-dx-specialty-combobox option:selected").prop("selected", false);
        $("#diff-dx-filters-show-all").addClass(self.ACTIVE_CLASS_NAME);
        $("#diff-dx-filters-top-10").removeClass(self.ACTIVE_CLASS_NAME);
        $("#diff-dx-filters-dont-miss").removeClass(self.ACTIVE_CLASS_NAME);
    });

    $("#diff-dx-symptom-list-body-div").on("mouseenter", "div.diff-dx-symptom-list-item-div", function(){
        self.symptomListOnHover(this.id, "mouseenter");
    });

    $("#diff-dx-symptom-list-body-div").on("mouseleave", "div.diff-dx-symptom-list-item-div", function(){
        self.symptomListOnHover(this.id, "mouseleave");
    });

    $("#diff-dx-symptom-list-body-div").on("click", "input.diff-dx-symptom-list-item-delete-div", function(){
        self.deleteSymptomFromList(this.id);
    });

    $("#diff-dx-add-symptom-textbox").keyup(function(e){
        if(e.keyCode == 13) //User pressed enter key
        {
            self.addNewSymptomToList(this.id);
        }
    });

    $("#diff-dx-note-selection-review-button").click(function() {
        self.reviewSelectedNotesButtonClicked();
    });

    $("#diff-dx-symptom-list-regenerate-button").click(function() {
        self.regenerateButtonClicked();
    });

    $(".diff-dx-note-selection-header-div").on("change", "input", function(){
        if($("#diff-dx-provider-only-checkbox").is(":checked")){
            self.toggleNoteFilter(1);
        }
        else {
            self.toggleNoteFilter(0);
        }
    });

    $("#diff-dx-dynamic-notes").on("change", "input", function(){
        if($("#diff-dx-dynamic-notes input[type='checkbox']").is(":checked")){
            $('#diff-dx-note-selection-review-button').prop('disabled', false);
        }
        else {
            $('#diff-dx-note-selection-review-button').prop('disabled', true);
        }
    });

    $("#diff-dx-specialty-combobox").change(function () {
        $("#diff-dx-specialty-combobox option:selected").each(function() {
            self.showDiagnosesBySpecialty(this.value);
        });
    });

    $("#diff-dx-diagnoses-list-body-div").on( "click" , "a" , function(event) {
        event.preventDefault();
        self.openKnowledgePage(this);
    });

    $("#diff-dx-diagnoses-list-body-div").on("click", ".diff-dx-diagnoses-list-item-collapsed-icon-div", function(){
        self.expandDiagnosis(this, $( this ).parent().attr('id'));
    });

    $("#diff-dx-diagnoses-list-body-div").on("click", ".diff-dx-diagnoses-list-item-expanded-icon-div", function(){
        self.collapseDiagnosis(this, $(this).parent().attr('id'));
    });
}

/*
This method is used to launch the knowledge page of the clicked diagnosis
*/
cerner.differential_diagnosis.prototype.openKnowledgePage = function(anchorObj){
    var parentId = $(anchorObj).parent().parent().attr('id');
    var splitId = parentId.split("-");
    var launchUrl = "";
    if(splitId.length == this.TOP_DIAGNOSIS_ID_LENGTH){
        launchUrl = this.ISABEL_Current_Displayed_Diagnosis_List[splitId[splitId.length-1]]["url"];
    }
    else if(splitId.length == this.SUB_DIAGNOSIS_LEVEL_1_ID_LENGTH){
        launchUrl = this.ISABEL_Current_Displayed_Diagnosis_List[splitId[splitId.length-2]]["subdiagnosis"][splitId[splitId.length-1]]["url"];
    }
    else if(splitId.length == this.SUB_DIAGNOSIS_LEVEL_2_ID_LENGTH){
        launchUrl = this.ISABEL_Current_Displayed_Diagnosis_List[splitId[splitId.length-3]]["subdiagnosis"][splitId[splitId.length-2]]["subdiagnosis"][splitId[splitId.length-1]]["url"];
    }
    else if(splitId.length == this.SUB_DIAGNOSIS_LEVEL_3_ID_LENGTH){
        launchUrl = this.ISABEL_Current_Displayed_Diagnosis_List[splitId[splitId.length-4]]["subdiagnosis"][splitId[splitId.length-3]]["subdiagnosis"][splitId[splitId.length-2]]["subdiagnosis"][splitId[splitId.length-1]]["url"];
    }

    var topValue = window.outerHeight - window.innerHeight;
    var leftValue = (window.outerWidth - window.innerWidth) + this.KNOWLEDGEPAGELEFTOFFSET;
    var widthValue = window.innerWidth - this.KNOWLEDGEPAGEWIDTHOFFSET;
    var heightValue = window.innerHeight - this.KNOWLEDGEPAGEHEIGHTOFFSET;

    launchUrl = decodeURIComponent(launchUrl);
    params = "resizable=yes,top=" + topValue + ", left=" + leftValue + ", height=" + heightValue +",width=" + widthValue + ", scrollbars=yes\",0,0";
    window.open(launchUrl,"_blank",params);
}

/*
Method to handle user checkbox selection for Provider only notes event, it clears the current list,
gets the new list by making ccl call and displayes it in the note selection box
*/
cerner.differential_diagnosis.prototype.toggleNoteFilter = function(providerNotesOnlyFlag){
    //Clear the note list
    $('#diff-dx-dynamic-notes').empty();
    //Show spinner
    this.showProcessing("diff-dx-dynamic-notes");
    //This gets the new documents list and displays it in note selection box
    this.retrieveDocumentHeaderData(providerNotesOnlyFlag, 1);
    //Enable the checkboxes for note list
    this.toggleNoteListAndSymptomChanges('enable');
}

/*
Method to handle clearing old div data, show processing icon and calling function to get
note text to send to isabel once review selected note button is clicked
*/
cerner.differential_diagnosis.prototype.reviewSelectedNotesButtonClicked = function(){
    $('#diff-dx-symptom-list-body-div').empty();
    this.clearDataAndDisableControls();
    this.retrieveNoteTextFromSpecificEvent();
}

/*
Method to handle clearing old div data, show processing icon and send new request to isabel
once regenerate diagnosis button is clicked
*/
cerner.differential_diagnosis.prototype.regenerateButtonClicked = function(){
    this.clearDataAndDisableControls();
    this.sendIsabelRequest("symptomList");
}

/*
Method to clear all data structures and div content, disabling all filters and input controls
before sending a new Isabel request
*/
cerner.differential_diagnosis.prototype.clearDataAndDisableControls = function(){
    $('#diff-dx-diagnoses-list-body-div').empty();
    document.getElementById("diff-diagnosis-header-text").innerHTML = this.DIFF_DX_RESULTS_LABEL + " (0)";

    this.clearExistingErrors();
    this.ISABEL_DiagnosisList = [];
    this.UNIQUE_SPECIALTY_LIST = [];
    this.ISABEL_Current_Displayed_Diagnosis_List = [];
    this.ISABEL_PLEASE_NOTE_ALERT_MESSAGE = "";
    this.TABLE_RESULTS_PER_COLUMN = 10;
    this.TABLE_NUMBER_OF_COLUMNS = 0;
    this.DIAGNOSIS_IS_EXPANDED = 0;
    this.CURRENT_TOP_LEVEL_COUNTER = 0;
    this.CURRENT_LEVEL_1_COUNTER = 0;
    this.CURRENT_LEVEL_2_COUNTER = 0;
    this.CURRENT_LEVEL_3_COUNTER = 0;

    $('#diff-dx-note-selection-review-button').prop('disabled', true);
    $('#diff-dx-symptom-list-regenerate-button').prop('disabled', true);
    this.toggleFilters('disable');
    this.toggleNoteListAndSymptomChanges('disable');
    $("#diff-dx-specialty-combobox option:selected").prop("selected", false);
    $('.diff-dx-specialty-combo').prop('disabled', true);

    this.showProcessing("diff-dx-diagnoses-list-body-div");
}

/*
This method expands all the sub diagnosis under the main diagnosis to display all
*/
cerner.differential_diagnosis.prototype.expandDiagnosis = function(divObj, parentId){
    //Find id of div that contains all children
    var subDiagnosisDivId = $('#' + parentId + " div:last-child").attr('id');

    //Change css to show immediate children
    $("#" + subDiagnosisDivId).removeClass("diff-dx-hide-div");
    //Change css to show any nested children
    $("#" + subDiagnosisDivId).find("div .diff-dx-hide-div").removeClass("diff-dx-hide-div");

    //Change icon from collapsed to expanded for clicked diagnosis
    $(divObj).addClass("diff-dx-diagnoses-list-item-expanded-icon-div");
    $(divObj).removeClass("diff-dx-diagnoses-list-item-collapsed-icon-div");

    //Change icon from collapsed to expanded for any nested children
    $("#" + subDiagnosisDivId).find("div .diff-dx-diagnoses-list-item-collapsed-icon-div").addClass("diff-dx-diagnoses-list-item-expanded-icon-div");
    $("#" + subDiagnosisDivId).find("div .diff-dx-diagnoses-list-item-collapsed-icon-div").removeClass("diff-dx-diagnoses-list-item-collapsed-icon-div");
}

/*
This method hides the sub diagnosis from under the main diagnosis
*/
cerner.differential_diagnosis.prototype.collapseDiagnosis = function(divObj, parentId){
    //Find id of div that contains all children
    var subDiagnosisDivId = $('#' + parentId + " div:last-child").attr('id');

    //Change css to hide children
    $("#" + subDiagnosisDivId).addClass("diff-dx-hide-div");

    //Change icon from collapsed to expanded for clicked diagnosis
    $(divObj).addClass("diff-dx-diagnoses-list-item-collapsed-icon-div");
    $(divObj).removeClass("diff-dx-diagnoses-list-item-expanded-icon-div");
}

/* This method handles the logic to change the diagnosis list based on specialty selected in the drop down box */
cerner.differential_diagnosis.prototype.showDiagnosesBySpecialty = function(selectedOption){
    var counter = 0;
    this.ISABEL_Current_Displayed_Diagnosis_List = [];
    if(selectedOption == -1){
        this.ISABEL_Current_Displayed_Diagnosis_List = this.ISABEL_DiagnosisList;
    }
    else{
        for(var i=0; i < this.ISABEL_DiagnosisList.length; i++)
        {
            if(this.ISABEL_DiagnosisList[i]["specialty"].toLowerCase().trim() == this.UNIQUE_SPECIALTY_LIST[selectedOption].toLowerCase().trim()){
                this.ISABEL_Current_Displayed_Diagnosis_List[counter] = this.ISABEL_DiagnosisList[i];
                counter++;
            }
        }
    }

    $("#diff-dx-filters-dont-miss").removeClass(this.ACTIVE_CLASS_NAME);
    $("#diff-dx-filters-top-10").removeClass(this.ACTIVE_CLASS_NAME);
    $("#diff-dx-filters-show-all").removeClass(this.ACTIVE_CLASS_NAME);
    this.DIAGNOSIS_IS_EXPANDED = 1;
    //Call the function to create the html for displaying the list of diagnosis
    this.showDynamicDiffDx(this.ISABEL_Current_Displayed_Diagnosis_List);
}

/* Based on input bollean value, the function enables/disables the filters
*/
cerner.differential_diagnosis.prototype.toggleFilters = function(flag) {
    if(flag == 'enable'){
        $('#diff-dx-filters-top-10').prop('disabled', false);
        $('#diff-dx-filters-dont-miss').prop('disabled', false);
        $('#diff-dx-filters-show-all').prop('disabled', false);
    }
    else if(flag == 'disable'){
        $('#diff-dx-filters-top-10').prop('disabled', true);
        $('#diff-dx-filters-dont-miss').prop('disabled', true);
        $('#diff-dx-filters-show-all').prop('disabled', true);
    }
}

/* This function deletes the selected symptom from the symptom list */
cerner.differential_diagnosis.prototype.deleteSymptomFromList = function(divId){
    var idElements = divId.split("-");
    var symptomIndex = idElements[idElements.length - 1];
    this.ISABEL_SymptomList.splice(symptomIndex,1);
    this.showDynamicSymptomList();
    if(this.ISABEL_SymptomList.length > 0){
        $('#diff-dx-symptom-list-regenerate-button').prop('disabled', false);
    }
    else{
        $('#diff-dx-symptom-list-regenerate-button').prop('disabled', true);
    }
}

/* This function adds the newly typed symptom to the list */
cerner.differential_diagnosis.prototype.addNewSymptomToList = function(textBoxId){
    var newSymptomText = document.getElementById(textBoxId).value;
    if(newSymptomText.trim()){
        this.ISABEL_SymptomList[this.ISABEL_SymptomList.length] = document.getElementById(textBoxId).value;
        var newSymptomIndex = this.ISABEL_SymptomList.length - 1;
        var newSymptomHtml = this.addSymptomToList(this.ISABEL_SymptomList[newSymptomIndex], newSymptomIndex);
        $("#diff-dx-symptom-list-body-div").append(newSymptomHtml);
        $('#diff-dx-symptom-list-regenerate-button').prop('disabled', false);
    }
    $("#" + textBoxId).val("");
}

/* This function changes the css for the hovered symptom */
cerner.differential_diagnosis.prototype.symptomListOnHover = function(divId, event){
    var symptomItem = document.getElementById(divId);
    var childImgs = symptomItem.getElementsByTagName("input");
    var deleteIconButton = childImgs[0];
    if(event.toLowerCase().trim() == "mouseenter") {
        $("#" + deleteIconButton.id).removeClass("diff-dx-invisible-div");
    }
    else if(event.toLowerCase().trim() == "mouseleave"){
        $("#" + deleteIconButton.id).addClass("diff-dx-invisible-div");
    }
}


/**This method collects the note text (with addenda) from the notes that are checked in the 'note
 *selection' section of the component. Event IDs should be contained in a string where each event ID
 *ends with an ampersand (as in "123456&789012&345678&")*/
cerner.differential_diagnosis.prototype.retrieveNoteTextFromSpecificEvent=function(){
    var self = this;
    var eventIDs = "";

    $('#diff-dx-dynamic-notes input:checked').each(function() {
        eventIDs += $(this).attr('value');
        eventIDs += "&";
    });
    var eventList = eventIDs.replace("ROSHPIPE&","");//ROS and HPI is already stored in this.ROSHPI so we shouldn't get it from CCL

    if(eventList == ""){//only ROS & HPI is selected. No need to send CCL request
        self.submitNoteTextAddendaToIsabel(eventIDs);
    }
    else{
        var slaTimer = self.createTimer("USR:MPG_Differential_Diagnosis_Document_Load");
        this.loadCcl("MP_GET_NOTE_TEXT_WITH_ADDENDA", ["MINE", this.getProperty("userId"), eventList],
            function(data){
                if (slaTimer) {
                    slaTimer.Stop();
                }
                self.NoteTextWithAddenda = "";
                var statusCode = data.RECORD_DATA.STATUS_DATA.STATUS;
                if(statusCode == 'S' || statusCode == 'Z'){
                    //If script is successful, then remove any existing similar error from the error list
                    self.ERROR_LIST.splice(self.ERROR_LIST.indexOf(self.CCL_MP_GET_NOTE_TEXT_WITH_ADDENDA_RUN_ERROR) , 1);
                    self.NoteTextWithAddenda = data.RECORD_DATA.TEXTBLOB;
                    self.submitNoteTextAddendaToIsabel(eventIDs);
                }
                else{
                    self.ERROR_LIST.push(self.CCL_MP_GET_NOTE_TEXT_WITH_ADDENDA_RUN_ERROR);
                    //Need to remove processing icon
                    $(".diff-dx-containerLoading").remove();
                    self.toggleNoteListAndSymptomChanges('enable');
                    self.diffdxShowErrorsandWarnings();
                }
            }
            , "JSON");
    }
}


/**This method updates the Text Blob based on the user selection and sends another request to Isabel
 */
cerner.differential_diagnosis.prototype.submitNoteTextAddendaToIsabel = function(eventIDs){
    var blob = "";
    //Only ROSHPIPE is selected
    if((eventIDs.indexOf("ROSHPIPE&") > -1) && (eventIDs.length == 9))
    {
        blob = this.ROSHPIPEText;
        this.TextToSendToIsabel = this.validateRequestData(blob);
    }

    //ROSHPIPE is still selected along with some other documents
    else if((eventIDs.indexOf("ROSHPIPE&") > -1) && (eventIDs.length > 9))
    {
        blob = this.ROSHPIPEText+". "+this.NoteTextWithAddenda;
        this.TextToSendToIsabel = this.validateRequestData(blob);
    }
    //ROSHPIPE is unselected and other documents are selected
    else if(!(eventIDs.indexOf("ROSHPIPE&") > -1) && (eventIDs.length > 0))
    {
        blob = this.NoteTextWithAddenda;
        this.TextToSendToIsabel = this.validateRequestData(blob);
    }

    if( this.TextToSendToIsabel != "error"){
        this.sendIsabelRequest("notes");
    }
    else
    {
        this.ERROR_LIST.push(this.CCL_MP_GET_NOTE_TEXT_WITH_ADDENDA_RUN_ERROR);
        //Need to remove processing icon
        $(".diff-dx-containerLoading").remove();
        this.toggleNoteListAndSymptomChanges('enable');
        this.diffdxShowErrorsandWarnings();
    }
}

/**Collects and validates the text that is being sent to ISABEL*/
cerner.differential_diagnosis.prototype.validateRequestData = function(textToIsabel){
    var hasError = false;
    //validate note text
    if(!(textToIsabel.replace(/\s+/g,'')) || !(textToIsabel.replace(/nbsp;/g,''))){
        hasError=true;
    }
    textToIsabel = textToIsabel.replace("[", "(");//replace brackets with parentheses to prevent issues with CDATA in API request.
    textToIsabel = textToIsabel.replace("]", ")");

    if(!hasError) return textToIsabel;
    else return("error");
}

/**Calculates the age of the patient and selects their age code as
 specified by isabel's API.
 *@param {String} dateOfBirth - the patient's date of birth formatted YYYY-MM-DD
 *@return {JSON} the patient's ageCode (a number), and age code
 * description (a String)*/
cerner.differential_diagnosis.prototype.getAgeRange = function(dateOfBirth){
    //Constant Values for time
    var MILLISECONDS_TO_DAYS = 1000 * 60 * 60 * 24;
    var MILLISECONDS_TO_YEARS = MILLISECONDS_TO_DAYS * 365 ;
    var BIRTH_YEAR = dateOfBirth.substring(0,4);
    var BIRTH_MONTH = dateOfBirth.substring(5,7);
    var BIRTH_DAY = dateOfBirth.substring(8,10);
    //time diff in milliseconds
    var today = new Date();
    var dob = new Date(BIRTH_MONTH+"-"+BIRTH_DAY+"-"+BIRTH_YEAR);//this is not formatted the same as dateOfBirth
    var timeDiff = (today.getTime() - dob.getTime());
    var valDays = Math.floor(timeDiff/MILLISECONDS_TO_DAYS);
    var valYears = Math.floor(timeDiff/MILLISECONDS_TO_YEARS);
    var ageCode = 0;
    var ageCodeDescription = "";
    switch(true){
        case(valDays <= 28):
            ageCode = 1;
            ageCodeDescription = "Neonate";
            break;
        case(valYears <= 1):
            ageCode = 2;
            ageCodeDescription = "Infant";
            break;
        case(valYears <= 5):
            ageCode = 3;
            ageCodeDescription = "Younger Child";
            break;
        case(valYears <= 12):
            ageCode = 10;
            ageCodeDescription = "Older Child";
            break;
        case(valYears <= 16):
            ageCode = 4;
            ageCodeDescription = "Adolescents";
            break;
        case(valYears <= 29):
            ageCode = 7;
            ageCodeDescription = "Young Adult";
            break;
        case(valYears <= 39):
            ageCode = 5;
            ageCodeDescription = "Adult";
            break;
        case(valYears <= 49):
            ageCode = 8;
            ageCodeDescription = "Adult";
            break;
        case(valYears <= 64):
            ageCode = 9;
            ageCodeDescription = "Adult";
            break;
        case(valYears > 64):
            ageCode = 6;
            ageCodeDescription = "Geriatric";
            break;
    }
    return [ageCode, ageCodeDescription];
}

/*
This method is used to resize any controls when the mpage is resized
*/
cerner.differential_diagnosis.prototype.resize = function(){
    var componentHeight = this.getProperty("maxHeight");

    $("#diff-dx-main").height(componentHeight);

    //Resize the add symptom textbox based on available space
    var addSymptomLabelWidth = $("#diff-dx-add-symptom-label").width();
    var addSymptomDivWidth = $(".diff-dx-add-symptom-list-wrapper").width();
    $("#diff-dx-add-symptom-textbox").css("width", (addSymptomDivWidth - addSymptomLabelWidth - this.SYMPTOM_TEXTBOX_LEFT_PADDING)+"px");

    //resize the error message divs if required
    if($(".diff-dx-error-div")){
        var divWidth = $(".diff-dx-error-div").width();
        $(".diff-dx-error-textholder").css("width", (divWidth - this.MESSAGE_IMAGE_WIDTH));
    }

    //resize the alert message divs if required
    if($(".diff-dx-alert-div")){
        var divWidth = $(".diff-dx-alert-div").width();
        $(".diff-dx-alert-textholder").css("width", (divWidth - this.MESSAGE_IMAGE_WIDTH));
    }
    //if any alert inside differential diagnoses box then adjust the diagnoses list height
    var diffDiagBoxHeight = $(".diff-dx-diagnoses-list-div").height();
    var genderWarningHeight = $("#diff-dx-no-gender-alert").height() ? ($("#diff-dx-no-gender-alert").height() + 8) : 0;
    var miscInfoMessageHeight = $("#diff-dx-ccl-get-note-text-script-error").height()
        + $("#diff-dx-isabel-please-note-alert").height()
        + $("#diff-dx-isabel-no-results-alert").height()
        + $("#diff-dx-no-wf-text-info").height()
        + $("#diff-dx-isabel-service-error").height();

    if(miscInfoMessageHeight > 0){
        miscInfoMessageHeight += 8; //Add margin height for the misc info box
    }

    if((genderWarningHeight > 0) || (miscInfoMessageHeight > 0)){
        this.DIAGNOSIS_AVAILABLE_HEIGHT = diffDiagBoxHeight - genderWarningHeight - miscInfoMessageHeight - this.DIAGNOSIS_HEADER_DIV_HEIGHT;
    }else{
        this.DIAGNOSIS_AVAILABLE_HEIGHT = diffDiagBoxHeight - this.DIAGNOSIS_HEADER_DIV_HEIGHT;
    }

    $(".diff-dx-diagnoses-list-body-div").css("height", this.DIAGNOSIS_AVAILABLE_HEIGHT);
}

/*
This method is used to create the SLATIMER object and start the timer. Caller is responsible to stop or abort the timer as needed.
*/
cerner.differential_diagnosis.prototype.createTimer = function (timerName, subTimerName, metaData1, metaData2, metaData3) {
    try {
        var slaTimer = window.external.DiscernObjectFactory("SLATIMER");
    } catch (error) {
        return null;
    }

    if (slaTimer) {
        slaTimer.TimerName = timerName;
        if (subTimerName)
            slaTimer.SubtimerName = subTimerName;
        if (metaData1)
            slaTimer.Metadata1 = String(metaData1);
        if (metaData2)
            slaTimer.Metadata2 = String(metaData2);
        if (metaData3)
            slaTimer.Metadata3 = String(metaData3);
        slaTimer.Start();
        return slaTimer;
    } else {
        return null;
    }
}

// Overriding the component level refresh button
// Ensure the DOM gets emptied completely
// Once DOM is empty, init and render the component to correctly refresh the component
cerner.differential_diagnosis.prototype.refresh = function() {
    //Ensure that the existing request is aborted
    if(this.XMLHTTP) {
        this.XMLHTTP.abort();
    }
    //Reset all data
    this.resetData();
    //Remove the contents of the DOM
    $("#diff-dx-main").remove();
    //Reload the component
    this.init();
    this.render();
}

/*
Resets all the data holders within the component to their initial load value
*/
cerner.differential_diagnosis.prototype.resetData = function() {
    this.XMLHTTP = null;
    this.ROSHPIPEData = "";
    this.ROSHPIPEDataFlag = false;
    this.DocumentHeaderData = "";
    this.ROSHPIPEText = "";
    this.TextToSendToIsabel = "";
    this.NoteTextWithAddenda = "";
    this.PRSNL_ID = "";
    this.PERSON_ID = "";
    this.ENCTR_ID = "";
    this.PPR_CD = "";
    this.AGE_CODE = "";
    this.AGE_DESCRIPTION = "";
    this.GENDER_CODE = "";
    this.GENDER_NAME = "";
    this.ISABEL_DiagnosisList = [];
    this.ISABEL_SymptomList = [];
    this.ISABEL_Current_Displayed_Diagnosis_List = [];
    this.UNIQUE_SPECIALTY_LIST = [];
    this.ERROR_LIST = [];
    this.TABLE_RESULTS_PER_COLUMN = 10;
    this.TABLE_NUMBER_OF_COLUMNS = 0;
    this.DIAGNOSIS_IS_EXPANDED = 0;
    this.DIAGNOSIS_AVAILABLE_HEIGHT = 0;
    this.CURRENT_TOP_LEVEL_COUNTER = 0;
    this.CURRENT_LEVEL_1_COUNTER = 0;
    this.CURRENT_LEVEL_2_COUNTER = 0;
    this.CURRENT_LEVEL_3_COUNTER = 0;
}

